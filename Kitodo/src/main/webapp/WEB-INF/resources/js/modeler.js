/**
 * (c) Kitodo. Key to digital objects e. V. <contact@kitodo.org>
 *
 * This file is part of the Kitodo project.
 *
 * It is licensed under MIT License by camunda Services GmbH
 *
 * For the full copyright and license information, please read the
 * Camunda-License.txt file that was distributed with this source code.
 */

(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c='function'==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code='MODULE_NOT_FOUND',a;}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r);},p,p.exports,r,e,n,t);}return n[i].exports;}for(var u='function'==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o;}return r;}()({1:[function(require,module,exports){module.exports = {
        name: 'Kitodo Template',
        prefix: 'template',
        uri: 'http://www.kitodo.org/template',
        xml: {tagAlias: 'lowerCase'},
        associations: [],
        types: [{
            name: 'TemplateTaskEvent',
            'extends': ['bpmn:Task'],
            properties: [{name: 'priority',
                isAttr: !0,
                type: 'Integer'
            }, {name: 'editType',
                isAttr: !0,
                type: 'Integer'
            }, {name: 'processingStatus',
                isAttr: !0,
                type: 'Integer'
            }, {name: 'permittedUserRole',
                isAttr: !0,
                type: 'Integer'
            }, {name: 'typeMetadata',
                isAttr: !0,
                type: 'Boolean'
            }, {name: 'typeAutomatic',
                isAttr: !0,
                type: 'Boolean'
            }, {name: 'typeImagesRead',
                isAttr: !0,
                type: 'Boolean'
            }, {name: 'typeImagesWrite',
                isAttr: !0,
                type: 'Boolean'
            }, {name: 'typeExportDMS', isAttr: !0, type: 'Boolean'}, {
                name: 'typeAcceptClose',
                isAttr: !0,
                type: 'Boolean'
            }, {name: 'typeCloseVerify', isAttr: !0, type: 'Boolean'}, {
                name: 'batchStep',
                isAttr: !0,
                type: 'Boolean'
            }]
        }, {
            name: 'TemplateScriptTaskEvent',
            'extends': ['bpmn:ScriptTask'],
            properties: [{name: 'scriptName', isAttr: !0, type: 'String'}, {
                name: 'scriptPath',
                isAttr: !0,
                type: 'String'
            }]
        }]
    };},{}],2:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function setDiagramXML(){placeholderForDiagram=document.getElementById('editForm:workflowTabView:xmlDiagram'),placeholderForDiagram?(diagramXML=placeholderForDiagram.value,openDiagram(diagramXML)):alert('diagram is empty!');}function createNewDiagram(){openDiagram(_newDiagram2.default);}function openDiagram(xml){var xmlParam;var svgParam;bpmnModeler.importXML(xml,function(err){err?(container.removeClass('with-diagram').addClass('with-error'),container.find('.error pre').text(err.message),console.error(err)):container.removeClass('with-error').addClass('with-diagram');});function saveDiagramAction(){bpmnModeler.saveXML({format:!0},function(err,xml){err?alert('diagram xml save failed',err):xmlParam = xml;}),bpmnModeler.saveSVG({format:!0},function(err,svg){err?alert('diagram svg save failed',err):svgParam =  svg;});xmlContent([{name: 'diagram', value: xmlParam + "kitodo-diagram-separator" + svgParam}]);};function registerFileDrop(container,callback){function handleFileSelect(e){e.stopPropagation(),e.preventDefault();var files=e.dataTransfer.files;var file=files[0];var reader=new FileReader();reader.onload=function(e){var xml=e.target.result;callback(xml);},reader.readAsText(file);}function handleDragOver(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect='copy';}container.get(0).addEventListener('dragover',handleDragOver,!1),container.get(0).addEventListener('drop',handleFileSelect,!1);}var _jquery=require('jquery');var _jquery2=_interopRequireDefault(_jquery);var _Modeler=require('bpmn-js/lib/Modeler');var _Modeler2=_interopRequireDefault(_Modeler);var _bpmnJsPropertiesPanel=require('bpmn-js-properties-panel');var _bpmnJsPropertiesPanel2=_interopRequireDefault(_bpmnJsPropertiesPanel);var _template=require('./provider/template');var _template2=_interopRequireDefault(_template);var _template3=require('./descriptors/template');var _template4=_interopRequireDefault(_template3);var _minDash=require('min-dash');var _newDiagram=require('../resources/newDiagram.bpmn');var _newDiagram2=_interopRequireDefault(_newDiagram);var container=(0,_jquery2.default)('#js-drop-zone');var placeholderForDiagram=document.getElementById('editForm:workflowTabView:xmlDiagram');var observer=new MutationObserver(function(mutations){mutations.forEach(function(mutation){console.log(mutation),setDiagramXML();});});var config={characterData:!0,subtree:!0};observer.observe(placeholderForDiagram,config);var diagramXML;var bpmnModeler=new _Modeler2.default({container:'#js-canvas',propertiesPanel:{parent:'#js-properties-panel'},additionalModules:[_bpmnJsPropertiesPanel2.default,_template2.default],moddleExtensions:{template:_template4.default}});window.FileList&&window.FileReader?registerFileDrop(container,openDiagram):window.alert('Looks like you use an older browser that does not support drag and drop. '+'Try using Chrome, Firefox or the Internet Explorer > 10.'),(0,_jquery2.default)(function(){(0,_jquery2.default)('#editForm\\:workflowTabView\\:js-create-diagram').click(function(e){e.stopPropagation(),e.preventDefault(),createNewDiagram();}),(0,_jquery2.default)('#editForm\\:workflowTabView\\:btnReadXmlDiagram').click(function(e){e.stopPropagation(),e.preventDefault(),setDiagramXML();});});},{'../resources/newDiagram.bpmn':469,'./descriptors/template':1,'./provider/template':4,'bpmn-js-properties-panel':7,'bpmn-js/lib/Modeler':59,jquery:351,'min-dash':438}],3:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function createGeneralTabGroups(element,bpmnFactory,elementRegistry,translate){var generalGroup={id:'general',label:'General Properties',entries:[]};(0,_IdProps2.default)(generalGroup,element,translate),(0,_NameProps2.default)(generalGroup,element,translate),(0,_ProcessProps2.default)(generalGroup,element,translate);var detailsGroup={id:'details',label:'Details',entries:[]};(0,_LinkProps2.default)(detailsGroup,element,translate),(0,_EventProps2.default)(detailsGroup,element,bpmnFactory,elementRegistry,translate),(0,_SequenceFlowProps2.default)(detailsGroup,element,bpmnFactory,translate);var taskGroup={id:'task',label:'Task Properties',entries:[]};(0,_TaskProperties2.default)(taskGroup,element);var scriptTaskGroup={id:'scriptTask',label:'Script Properties',entries:[]};return(0,_ScriptTaskProperties2.default)(scriptTaskGroup,element),[generalGroup,detailsGroup,taskGroup,scriptTaskGroup];}function TemplatePropertiesProvider(eventBus,bpmnFactory,elementRegistry,translate){_PropertiesActivator2.default.call(this,eventBus),this.getTabs=function(element){var generalTab={id:'general',label:'Properties',groups:createGeneralTabGroups(element,bpmnFactory,elementRegistry,translate)};return[generalTab];};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=TemplatePropertiesProvider;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _PropertiesActivator=require('bpmn-js-properties-panel/lib/PropertiesActivator');var _PropertiesActivator2=_interopRequireDefault(_PropertiesActivator);var _ProcessProps=require('bpmn-js-properties-panel/lib/provider/bpmn/parts/ProcessProps');var _ProcessProps2=_interopRequireDefault(_ProcessProps);var _EventProps=require('bpmn-js-properties-panel/lib/provider/bpmn/parts/EventProps');var _EventProps2=_interopRequireDefault(_EventProps);var _LinkProps=require('bpmn-js-properties-panel/lib/provider/bpmn/parts/LinkProps');var _LinkProps2=_interopRequireDefault(_LinkProps);var _IdProps=require('bpmn-js-properties-panel/lib/provider/bpmn/parts/IdProps');var _IdProps2=_interopRequireDefault(_IdProps);var _NameProps=require('bpmn-js-properties-panel/lib/provider/bpmn/parts/NameProps');var _NameProps2=_interopRequireDefault(_NameProps);var _SequenceFlowProps=require('bpmn-js-properties-panel/lib/provider/camunda/parts/SequenceFlowProps');var _SequenceFlowProps2=_interopRequireDefault(_SequenceFlowProps);var _ScriptTaskProperties=require('./parts/ScriptTaskProperties');var _ScriptTaskProperties2=_interopRequireDefault(_ScriptTaskProperties);var _TaskProperties=require('./parts/TaskProperties');var _TaskProperties2=_interopRequireDefault(_TaskProperties);(0,_inherits2.default)(TemplatePropertiesProvider,_PropertiesActivator2.default);},{'./parts/ScriptTaskProperties':5,'./parts/TaskProperties':6,'bpmn-js-properties-panel/lib/PropertiesActivator':8,'bpmn-js-properties-panel/lib/provider/bpmn/parts/EventProps':33,'bpmn-js-properties-panel/lib/provider/bpmn/parts/IdProps':34,'bpmn-js-properties-panel/lib/provider/bpmn/parts/LinkProps':35,'bpmn-js-properties-panel/lib/provider/bpmn/parts/NameProps':36,'bpmn-js-properties-panel/lib/provider/bpmn/parts/ProcessProps':37,'bpmn-js-properties-panel/lib/provider/camunda/parts/SequenceFlowProps':48,inherits:350}],4:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _TemplatePropertiesProvider=require('./TemplatePropertiesProvider');var _TemplatePropertiesProvider2=_interopRequireDefault(_TemplatePropertiesProvider);exports.default={__init__:['propertiesProvider'],propertiesProvider:['type',_TemplatePropertiesProvider2.default]};},{'./TemplatePropertiesProvider':3}],5:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=function(group,element){(0,_ModelUtil.is)(element,'bpmn:ScriptTask')&&(group.entries.push(_EntryFactory2.default.textField({id:'scriptName',description:'Insert script name',label:'Script name',modelProperty:'scriptName'})),group.entries.push(_EntryFactory2.default.textField({id:'scriptPath',description:'Insert script path',label:'Script path',modelProperty:'scriptPath'})));};var _EntryFactory=require('bpmn-js-properties-panel/lib/factory/EntryFactory');var _EntryFactory2=_interopRequireDefault(_EntryFactory);var _ModelUtil=require('bpmn-js/lib/util/ModelUtil');},{'bpmn-js-properties-panel/lib/factory/EntryFactory':19,'bpmn-js/lib/util/ModelUtil':159}],6:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports, '__esModule', {value: !0}), exports.default = function (group, element) {
        (0, _ModelUtil.is)(element, 'bpmn:Task') && (group.entries.push(_EntryFactory2.default.textField({
            id: 'priority',
            description: '',
            label: 'Priority',
            modelProperty: 'priority'
        })), group.entries.push(_EntryFactory2.default.selectBox({
            id: 'processingStatus',
            description: '',
            label: 'Processing status',
            selectOptions : [
                {name: 'Locked', value: 0},
                {name: 'Open', value: 1},
                {name: 'In processing', value: 2},
                {name: 'Closed', value: 3}],
            modelProperty: 'processingStatus'
        })),group.entries.push(_EntryFactory2.default.selectBox({
            id: 'permittedUserRole',
            description: '',
            label: 'Permitted User Role',
            selectOptions : availableUserRoles,
            modelProperty: 'permittedUserRole'
        })), group.entries.push(_EntryFactory2.default.checkbox({
            id: 'typeMetadata',
            description: '',
            label: 'Metadata',
            modelProperty: 'typeMetadata'
        })), group.entries.push(_EntryFactory2.default.checkbox({
            id: 'typeImagesRead',
            description: '',
            label: 'Read images',
            modelProperty: 'typeImagesRead'
        })), group.entries.push(_EntryFactory2.default.checkbox({
            id: 'typeImagesWrite',
            description: '',
            label: 'Write images',
            modelProperty: 'typeImagesWrite'
        })), group.entries.push(_EntryFactory2.default.checkbox({
            id: 'typeExportDMS',
            description: '',
            label: 'Export DMS',
            modelProperty: 'typeExportDMS'
        })), group.entries.push(_EntryFactory2.default.checkbox({
            id: 'typeCloseVerify',
            description: '',
            label: 'Validate on exit',
            modelProperty: 'typeCloseVerify'
        })), group.entries.push(_EntryFactory2.default.checkbox({
            id: 'typeAcceptClose',
            description: '',
            label: 'Finalise task after accepting',
            modelProperty: 'typeAcceptClose'
        })), group.entries.push(_EntryFactory2.default.checkbox({
            id: 'typeAutomatic',
            description: '',
            label: 'Automatic task',
            modelProperty: 'typeAutomatic'
        })), group.entries.push(_EntryFactory2.default.checkbox({
            id: 'batchStep',
            description: '',
            label: 'Batch task',
            modelProperty: 'batchStep'
        })));
    };var _EntryFactory=require('bpmn-js-properties-panel/lib/factory/EntryFactory');var _EntryFactory2=_interopRequireDefault(_EntryFactory);var _ModelUtil=require('bpmn-js/lib/util/ModelUtil');},{'bpmn-js-properties-panel/lib/factory/EntryFactory':19,'bpmn-js/lib/util/ModelUtil':159}],7:[function(require,module,exports){'use strict';module.exports=require('./lib');},{'./lib':32}],8:[function(require,module,exports){'use strict';function PropertiesActivator(eventBus,priority){var self=this;priority=priority||DEFAULT_PRIORITY,eventBus.on('propertiesPanel.isEntryVisible',priority,function(e){return self.isEntryVisible(e.entry,e.element);}),eventBus.on('propertiesPanel.isPropertyEditable',priority,function(e){return self.isPropertyEditable(e.entry,e.propertyName,e.element);});}var DEFAULT_PRIORITY=1000;PropertiesActivator.$inject=['eventBus'],module.exports=PropertiesActivator,PropertiesActivator.prototype.isEntryVisible=function(entry,element){return!0;},PropertiesActivator.prototype.isPropertyEditable=function(entry,propertyName,element){return!0;};},{}],9:[function(require,module,exports){'use strict';function isToggle(node){return node.type==='checkbox'||node.type==='radio';}function isSelect(node){return node.type==='select-one';}function isContentEditable(node){return domAttr(node,'contenteditable');}function getPropertyPlaceholders(node){var selector='input[name], textarea[name], [data-value], [contenteditable]';var placeholders=domQuery.all(selector,node);return!(placeholders&&placeholders.length)&&domMatches(node,selector)&&(placeholders=[node]),placeholders;}function getFormControls(node,all){var controls=domQuery.all('input[name], textarea[name], select[name], [contenteditable]',node);return controls&&controls.length||(controls=domMatches(node,'option')?[node]:controls),all||(controls=filter(controls,function(node){return!domClosest(node,'.'+HIDE_CLASS);})),controls;}function getFormControlValuesInScope(entryNode){var values={};var controlNodes=getFormControls(entryNode);return forEach(controlNodes,function(controlNode){var value=controlNode.value;var name=domAttr(controlNode,'name')||domAttr(controlNode,'data-name');isToggle(controlNode)?controlNode.checked?domAttr(controlNode,'value')?value=controlNode.value:value=!0:value=null:isContentEditable(controlNode)&&(value=controlNode.innerText),value!==null&&(values[name]=value);}),values;}function getFormControlValues(entryNode){var values;var listContainer=domQuery('[data-list-entry-container]',entryNode);if(listContainer){values=[];var listNodes=listContainer.children||[];forEach(listNodes,function(listNode){values.push(getFormControlValuesInScope(listNode));});}else values=getFormControlValuesInScope(entryNode);return values;}function valueEqual(value,oldValue){if(value&&!oldValue)return!1;var allKeys=keys(value).concat(keys(oldValue));return allKeys.every(function(key){return value[key]===oldValue[key];});}function valuesEqual(values,oldValues){return isArray(values)?values.length!==oldValues.length?!1:values.every(function(v,idx){return valueEqual(v,oldValues[idx]);}):valueEqual(values,oldValues);}function extractEntries(tabs){return indexBy(flattenDeep(map(flattenDeep(map(tabs,'groups')),'entries')),'id');}function extractGroups(tabs){return indexBy(flattenDeep(map(tabs,'groups')),'id');}function PropertiesPanel(config,eventBus,modeling,propertiesProvider,commandStack,canvas){this._eventBus=eventBus,this._modeling=modeling,this._commandStack=commandStack,this._canvas=canvas,this._propertiesProvider=propertiesProvider,this._init(config);}function setInputValue(node,value){var contentEditable=isContentEditable(node);var oldValue=contentEditable?node.innerText:node.value;var selection;if(value===undefined&&(value=''),oldValue===value)return;document.activeElement===node&&(selection=updateSelection(getSelection(node),oldValue,value)),contentEditable?node.innerText=value:node.value=value,selection&&setSelection(node,selection);}function setSelectValue(node,value){value!==undefined&&(node.value=value);}function setToggleValue(node,value){var nodeValue=node.value;node.checked=value===nodeValue||!domAttr(node,'value')&&value;}function setTextValue(node,value){node.textContent=value;}function getSelection(node){return isContentEditable(node)?getContentEditableSelection(node):{start:node.selectionStart,end:node.selectionEnd};}function getContentEditableSelection(node){var selection=window.getSelection();var focusNode=selection.focusNode,focusOffset=selection.focusOffset,anchorOffset=selection.anchorOffset;if(!focusNode)throw new Error('not selected');if(!node.contains(focusNode))throw new Error('not selected');return{start:Math.min(focusOffset,anchorOffset),end:Math.max(focusOffset,anchorOffset)};}function setSelection(node,selection){isContentEditable(node)?setContentEditableSelection(node,selection):(node.selectionStart=selection.start,node.selectionEnd=selection.end);}function setContentEditableSelection(node,selection){var focusNode,domRange,domSelection;focusNode=node.firstChild||node,domRange=document.createRange(),domRange.setStart(focusNode,selection.start),domRange.setEnd(focusNode,selection.end),domSelection=window.getSelection(),domSelection.removeAllRanges(),domSelection.addRange(domRange);}var domify=require('min-dom/lib/domify'),domQuery=require('min-dom/lib/query'),domRemove=require('min-dom/lib/remove'),domClasses=require('min-dom/lib/classes'),domClosest=require('min-dom/lib/closest'),domAttr=require('min-dom/lib/attr'),domDelegate=require('min-dom/lib/delegate'),domMatches=require('min-dom/lib/matches');var forEach=require('lodash/collection/forEach'),filter=require('lodash/collection/filter'),get=require('lodash/object/get'),keys=require('lodash/object/keys'),isEmpty=require('lodash/lang/isEmpty'),isArray=require('lodash/lang/isArray'),xor=require('lodash/array/xor'),debounce=require('lodash/function/debounce');var updateSelection=require('selection-update');var scrollTabs=require('scroll-tabs');var getBusinessObject=require('bpmn-js/lib/util/ModelUtil').getBusinessObject;var HIDE_CLASS='bpp-hidden';var DEBOUNCE_DELAY=300;PropertiesPanel.$inject=['config.propertiesPanel','eventBus','modeling','propertiesProvider','commandStack','canvas'],module.exports=PropertiesPanel,PropertiesPanel.prototype._init=function(config){var eventBus=this._eventBus;var self=this;eventBus.on('root.added',function(e){self.update(e.element);}),eventBus.on('selection.changed',function(e){var newElement=e.newSelection[0];self.update(newElement);}),eventBus.on(['propertiesPanel.changed','propertiesPanel.resized'],function(event){var tabBarNode=domQuery('.bpp-properties-tab-bar',self._container);if(!tabBarNode)return;var scroller=scrollTabs.get(tabBarNode);scroller||(scroller=scrollTabs(tabBarNode,{selectors:{tabsContainer:'.bpp-properties-tabs-links',tab:'.bpp-properties-tabs-links li',ignore:'.bpp-hidden',active:'.bpp-active'}}),scroller.on('scroll',function(newActiveNode,oldActiveNode,direction){var linkNode=domQuery('[data-tab-target]',newActiveNode);var tabId=domAttr(linkNode,'data-tab-target');self.activateTab(tabId);})),scroller.update();}),eventBus.on('elements.changed',function(e){var current=self._current;var element=current&&current.element;element&&e.elements.indexOf(element)!==-1&&self.update(element);}),eventBus.on('elementTemplates.changed',function(){var current=self._current;var element=current&&current.element;element&&self.update(element);}),eventBus.on('diagram.destroy',function(){self.detach();}),this._container=domify('<div class="bpp-properties-panel"></div>'),this._bindListeners(this._container),config&&config.parent&&this.attachTo(config.parent);},PropertiesPanel.prototype.attachTo=function(parentNode){if(!parentNode)throw new Error('parentNode required');this.detach(),parentNode.get&&parentNode.constructor.prototype.jquery&&(parentNode=parentNode.get(0)),typeof parentNode==='string'&&(parentNode=domQuery(parentNode));var container=this._container;parentNode.appendChild(container),this._emit('attach');},PropertiesPanel.prototype.detach=function(){var container=this._container,parentNode=container.parentNode;if(!parentNode)return;this._emit('detach'),parentNode.removeChild(container);},PropertiesPanel.prototype.activateTab=function(tab){var tabId=typeof tab==='string'?tab:tab.id;var current=this._current;var panelNode=current.panel;var allTabNodes=domQuery.all('.bpp-properties-tab',panelNode),allTabLinkNodes=domQuery.all('.bpp-properties-tab-link',panelNode);forEach(allTabNodes,function(tabNode){var currentTabId=domAttr(tabNode,'data-tab');domClasses(tabNode).toggle('bpp-active',tabId===currentTabId);}),forEach(allTabLinkNodes,function(tabLinkNode){var tabLink=domQuery('[data-tab-target]',tabLinkNode),currentTabId=domAttr(tabLink,'data-tab-target');domClasses(tabLinkNode).toggle('bpp-active',tabId===currentTabId);});},PropertiesPanel.prototype.update=function(element){var current=this._current;var needsCreate=!0;element===void 0&&(element=this._canvas.getRootElement());var newTabs=this._propertiesProvider.getTabs(element);if(current&&current.element===element&&(needsCreate=this._entriesChanged(current,newTabs)),needsCreate){if(current){var activeTabNode=domQuery('.bpp-properties-tab.bpp-active',current.panel);var activeTabId;activeTabNode&&(activeTabId=domAttr(activeTabNode,'data-tab')),domRemove(current.panel);}this._current=this._create(element,newTabs),activeTabId?this.activateTab(activeTabId):this.activateTab(this._current.tabs[0]);}this._current&&this._updateActivation(this._current),this._emit('changed');},PropertiesPanel.prototype._entriesChanged=function(current,newTabs){var oldEntryIds=keys(current.entries),newEntryIds=keys(extractEntries(newTabs));return!isEmpty(xor(oldEntryIds,newEntryIds));},PropertiesPanel.prototype._emit=function(event){this._eventBus.fire('propertiesPanel.'+event,{panel:this,current:this._current});},PropertiesPanel.prototype._bindListeners=function(container){function handleInput(event,element){var inputNode=event.delegateTarget;var entryNode=domClosest(inputNode,'[data-entry]');if(!entryNode)return;var eventHandlerId=domAttr(inputNode,'data-on-change'),entryId=domAttr(entryNode,'data-entry');var entry=self.getEntry(entryId);var isEntryDirty=self.executeAction(entry,entryNode,eventHandlerId,event);if(isEntryDirty){var values=getFormControlValues(entryNode);self.applyChanges(entry,values,entryNode);}self.updateState(entry,entryNode);}var self=this;var handleChange=function handleChange(event){var node=domClosest(event.delegateTarget,'[data-entry]'),entryId,entry;if(!node)return;entryId=domAttr(node,'data-entry'),entry=self.getEntry(entryId);var values=getFormControlValues(node);if(event.type==='change'){var onChangeAction=event.delegateTarget.getAttribute('data-on-change');if(onChangeAction){var isEntryDirty=self.executeAction(entry,node,onChangeAction,event);if(!isEntryDirty)return self.update(self._current.element);}}self.applyChanges(entry,values,node),self.updateState(entry,node);};domDelegate.bind(container,'input, textarea, [contenteditable]','input',debounce(handleChange,DEBOUNCE_DELAY)),domDelegate.bind(container,'input, textarea, select, [contenteditable]','change',handleChange),domDelegate.bind(container,'[data-action]','click',function onClick(event){var inputNode=event.delegateTarget;var entryNode=domClosest(inputNode,'[data-entry]');var actionId=domAttr(inputNode,'data-action'),entryId=domAttr(entryNode,'data-entry');var entry=self.getEntry(entryId);var isEntryDirty=self.executeAction(entry,entryNode,actionId,event);if(isEntryDirty){var values=getFormControlValues(entryNode);self.applyChanges(entry,values,entryNode);}self.updateState(entry,entryNode);}),domDelegate.bind(container,'[data-on-change]','blur',handleInput,!0),domDelegate.bind(container,'.bpp-properties-tabs-links [data-tab-target]','click',function(event){event.preventDefault();var delegateTarget=event.delegateTarget;var tabId=domAttr(delegateTarget,'data-tab-target');self.activateTab(tabId);});},PropertiesPanel.prototype.updateState=function(entry,entryNode){this.updateShow(entry,entryNode),this.updateDisable(entry,entryNode);},PropertiesPanel.prototype.updateShow=function(entry,node){var current=this._current;if(!current)return;var showNodes=domQuery.all('[data-show]',node)||[];forEach(showNodes,function(showNode){var expr=domAttr(showNode,'data-show');var fn=get(entry,expr);if(fn){var scope=domClosest(showNode,'[data-scope]')||node;var shouldShow=fn(current.element,node,showNode,scope)||!1;shouldShow?domClasses(showNode).remove(HIDE_CLASS):domClasses(showNode).add(HIDE_CLASS);}});},PropertiesPanel.prototype.updateDisable=function(entry,node){var current=this._current;if(!current)return;var nodes=domQuery.all('[data-disable]',node)||[];forEach(nodes,function(currentNode){var expr=domAttr(currentNode,'data-disable');var fn=get(entry,expr);if(fn){var scope=domClosest(currentNode,'[data-scope]')||node;var shouldDisable=fn(current.element,node,currentNode,scope)||!1;domAttr(currentNode,'disabled',shouldDisable?'':null);}});},PropertiesPanel.prototype.executeAction=function(entry,entryNode,actionId,event){var current=this._current;if(!current)return;var fn=get(entry,actionId);if(fn){var scopeNode=domClosest(event.target,'[data-scope]')||entryNode;return fn.apply(entry,[current.element,entryNode,event,scopeNode]);}},PropertiesPanel.prototype.applyChanges=function(entry,values,containerElement){var element=this._current.element;if(valuesEqual(values,entry.oldValues))return;var command=entry.set(element,values,containerElement);var commandToExecute;isArray(command)?command.length&&(commandToExecute={cmd:'properties-panel.multi-command-executor',context:flattenDeep(command)}):commandToExecute=command,commandToExecute?this._commandStack.execute(commandToExecute.cmd,commandToExecute.context||{element:element}):this.update(element);},PropertiesPanel.prototype.applyValidationErrors=function(validationErrors,entryNode){var valid=!0;var controlNodes=getFormControls(entryNode,!0);return forEach(controlNodes,function(controlNode){var name=domAttr(controlNode,'name')||domAttr(controlNode,'data-name');var error=validationErrors&&validationErrors[name];var errorMessageNode=domQuery('.bpp-error-message',controlNode.parentNode);error?(valid=!1,errorMessageNode||(errorMessageNode=domify('<div></div>'),domClasses(errorMessageNode).add('bpp-error-message'),controlNode.parentNode.insertBefore(errorMessageNode,controlNode.nextSibling)),errorMessageNode.innerHTML=error,domClasses(controlNode).add('invalid')):(domClasses(controlNode).remove('invalid'),errorMessageNode&&controlNode.parentNode.removeChild(errorMessageNode));}),valid;},PropertiesPanel.prototype.validate=function(entry,values,entryNode){var self=this;var current=this._current;var valid=!0;if(entryNode=entryNode||domQuery('[data-entry="'+entry.id+'"]',current.panel),values instanceof Array){var listContainer=domQuery('[data-list-entry-container]',entryNode),listEntryNodes=listContainer.children||[];for(var i=0;i<values.length;i++){var listValue=values[i];if(entry.validateListItem){var validationErrors=entry.validateListItem(current.element,listValue,entryNode,i),listEntryNode=listEntryNodes[i];valid=self.applyValidationErrors(validationErrors,listEntryNode)&&valid;}}}else entry.validate&&(this.validationErrors=entry.validate(current.element,values,entryNode),valid=self.applyValidationErrors(this.validationErrors,entryNode)&&valid);return valid;},PropertiesPanel.prototype.getEntry=function(id){return this._current&&this._current.entries[id];};var flattenDeep=require('lodash/array/flattenDeep'),indexBy=require('lodash/collection/indexBy'),map=require('lodash/collection/map');PropertiesPanel.prototype._create=function(element,tabs){if(!element)return null;var containerNode=this._container;var panelNode=this._createPanel(element,tabs);containerNode.appendChild(panelNode);var entries=extractEntries(tabs);var groups=extractGroups(tabs);return{tabs:tabs,groups:groups,entries:entries,element:element,panel:panelNode};},PropertiesPanel.prototype._bindTemplate=function(element,entry,values,entryNode,idx){function isPropertyEditable(entry,propertyName){return eventBus.fire('propertiesPanel.isPropertyEditable',{entry:entry,propertyName:propertyName,element:element});}var eventBus=this._eventBus;var inputNodes=getPropertyPlaceholders(entryNode);forEach(inputNodes,function(node){var name,newValue,editable;'value'in node||isContentEditable(node)==='true'?(name=domAttr(node,'name')||domAttr(node,'data-name'),newValue=values[name],editable=isPropertyEditable(entry,name),editable&&entry.editable&&(editable=entry.editable(element,entryNode,node,name,newValue,idx)),domAttr(node,'readonly',editable?null:''),domAttr(node,'disabled',editable?null:''),entry.setControlValue?entry.setControlValue(element,entryNode,node,name,newValue,idx):isToggle(node)?setToggleValue(node,newValue):isSelect(node)?setSelectValue(node,newValue):setInputValue(node,newValue)):(name=domAttr(node,'data-value'),newValue=values[name],entry.setControlValue?entry.setControlValue(element,entryNode,node,name,newValue,idx):setTextValue(node,newValue));});},PropertiesPanel.prototype._updateActivation=function(current){function isEntryVisible(entry){return eventBus.fire('propertiesPanel.isEntryVisible',{entry:entry,element:element});}function isGroupVisible(group,element,groupNode){return typeof group.enabled==='function'?group.enabled(element,groupNode):!0;}function isTabVisible(tab,element){return typeof tab.enabled==='function'?tab.enabled(element):!0;}function toggleVisible(node,visible){domClasses(node).toggle(HIDE_CLASS,!visible);}function checkActiveTabVisibility(node,visible){var isActive=domClasses(node).has('bpp-active');!visible&&isActive&&self.activateTab(current.tabs[0]);}function updateLabel(element,selector,text){var labelNode=domQuery(selector,element);if(!labelNode)return;labelNode.textContent=text;}var self=this;var eventBus=this._eventBus;var element=current.element;var panelNode=current.panel;forEach(current.tabs,function(tab){var tabNode=domQuery('[data-tab='+tab.id+']',panelNode);var tabLinkNode=domQuery('[data-tab-target='+tab.id+']',panelNode).parentNode;var tabVisible=!1;forEach(tab.groups,function(group){var groupVisible=!1;var groupNode=domQuery('[data-group='+group.id+']',tabNode);forEach(group.entries,function(entry){var entryNode=domQuery('[data-entry="'+entry.id+'"]',groupNode);var entryVisible=isEntryVisible(entry);groupVisible=groupVisible||entryVisible,toggleVisible(entryNode,entryVisible);var values='get'in entry?entry.get(element,entryNode):{};if(values instanceof Array){var listEntryContainer=domQuery('[data-list-entry-container]',entryNode);var existingElements=listEntryContainer.children||[];for(var i=0;i<values.length;i++){var listValue=values[i];var listItemNode=existingElements[i];listItemNode||(listItemNode=domify(entry.createListEntryTemplate(listValue,i,listEntryContainer)),listEntryContainer.appendChild(listItemNode)),domAttr(listItemNode,'data-index',i),self._bindTemplate(element,entry,listValue,listItemNode,i);}var entriesToRemove=existingElements.length-values.length;for(var j=0;j<entriesToRemove;j++)listEntryContainer.removeChild(listEntryContainer.lastChild);}else self._bindTemplate(element,entry,values,entryNode);self.updateState(entry,entryNode),self.validate(entry,values,entryNode),entry.oldValues=getFormControlValues(entryNode);}),typeof group.label==='function'&&updateLabel(groupNode,'.group-label',group.label(element,groupNode)),groupVisible=groupVisible&&isGroupVisible(group,element,groupNode),tabVisible=tabVisible||groupVisible,toggleVisible(groupNode,groupVisible);}),tabVisible=tabVisible&&isTabVisible(tab,element),toggleVisible(tabNode,tabVisible),toggleVisible(tabLinkNode,tabVisible),checkActiveTabVisibility(tabNode,tabVisible);}),updateLabel(panelNode,'[data-label-id]',getBusinessObject(element).id||'');},PropertiesPanel.prototype._createPanel=function(element,tabs){var self=this;var panelNode=domify('<div class="bpp-properties"></div>'),headerNode=domify('<div class="bpp-properties-header">'+'<div class="label" data-label-id></div>'+'<div class="search">'+'<input type="search" placeholder="Search for property" />'+'<button><span>Search</span></button>'+'</div>'+'</div>'),tabBarNode=domify('<div class="bpp-properties-tab-bar"></div>'),tabLinksNode=domify('<ul class="bpp-properties-tabs-links"></ul>'),tabContainerNode=domify('<div class="bpp-properties-tabs-container"></div>');return panelNode.appendChild(headerNode),forEach(tabs,function(tab,tabIndex){if(!tab.id)throw new Error('tab must have an id');var tabNode=domify('<div class="bpp-properties-tab" data-tab="'+tab.id+'"></div>'),tabLinkNode=domify('<li class="bpp-properties-tab-link">'+'<a href data-tab-target="'+tab.id+'">'+tab.label+'</a>'+'</li>');var groups=tab.groups;forEach(groups,function(group){if(!group.id)throw new Error('group must have an id');var groupNode=domify('<div class="bpp-properties-group" data-group="'+group.id+'">'+'<span class="group-toggle"></span>'+'<span class="group-label">'+group.label+'</span>'+'</div>');groupNode.querySelector('.group-toggle').addEventListener('click',function(evt){domClasses(groupNode).toggle('group-closed'),evt.preventDefault(),evt.stopPropagation();}),groupNode.addEventListener('click',function(evt){!evt.defaultPrevented&&domClasses(groupNode).has('group-closed')&&domClasses(groupNode).remove('group-closed');}),forEach(group.entries,function(entry){if(!entry.id)throw new Error('entry must have an id');var html=entry.html;typeof html==='string'&&(html=domify(html)),html.get&&html.constructor.prototype.jquery&&(html=html.get(0));var entryNode=domify('<div class="bpp-properties-entry" data-entry="'+entry.id+'"></div>');forEach(entry.cssClasses||[],function(cssClass){domClasses(entryNode).add(cssClass);}),entryNode.appendChild(html),groupNode.appendChild(entryNode),self.updateState(entry,entryNode);}),tabNode.appendChild(groupNode);}),tabLinksNode.appendChild(tabLinkNode),tabContainerNode.appendChild(tabNode);}),tabBarNode.appendChild(tabLinksNode),panelNode.appendChild(tabBarNode),panelNode.appendChild(tabContainerNode),panelNode;};},{'bpmn-js/lib/util/ModelUtil':159,'lodash/array/flattenDeep':352,'lodash/array/xor':354,'lodash/collection/filter':355,'lodash/collection/forEach':357,'lodash/collection/indexBy':358,'lodash/collection/map':359,'lodash/function/debounce':361,'lodash/lang/isArray':423,'lodash/lang/isEmpty':424,'lodash/object/get':431,'lodash/object/keys':432,'min-dom/lib/attr':50,'min-dom/lib/classes':51,'min-dom/lib/closest':53,'min-dom/lib/delegate':54,'min-dom/lib/domify':55,'min-dom/lib/matches':56,'min-dom/lib/query':57,'min-dom/lib/remove':58,'scroll-tabs':458,'selection-update':466}],10:[function(require,module,exports){'use strict';function selectedOption(selectBox){return selectBox.selectedIndex>=0?selectBox.options[selectBox.selectedIndex].value:void 0;}function selectedType(elementSyntax,inputNode){var typeSelect=domQuery(elementSyntax,inputNode);return selectedOption(typeSelect);}function getRoot(businessObject){var parent=businessObject;while(parent.$parent)parent=parent.$parent;return parent;}function filterElementsByType(objectList,type){var list=objectList||[];var result=[];return forEach(list,function(obj){is(obj,type)&&result.push(obj);}),result;}function findRootElementsByType(businessObject,referencedType){var root=getRoot(businessObject);return filterElementsByType(root.rootElements,referencedType);}function removeAllChildren(domElement){while(domElement.firstChild)domElement.removeChild(domElement.firstChild);}function addEmptyParameter(list){return list.push({label:'',value:'',name:''});}function refreshOptionsModel(businessObject,referencedType){var model=[];var referableObjects=findRootElementsByType(businessObject,referencedType);return forEach(referableObjects,function(obj){model.push({label:(obj.name||'')+' (id='+obj.id+')',value:obj.id,name:obj.name});}),model;}function updateOptionsDropDown(domSelector,businessObject,referencedType,entryNode){var options=refreshOptionsModel(businessObject,referencedType);addEmptyParameter(options);var selectBox=domQuery(domSelector,entryNode);return domClear(selectBox),forEach(options,function(option){var optionEntry=domify('<option value="'+option.value+'">'+option.label+'</option>');selectBox.appendChild(optionEntry);}),options;}function isIdValid(bo,idValue){var assigned=bo.$model.ids.assigned(idValue);var idExists=assigned&&assigned!==bo;return!idValue||idExists?'Element must have an unique id.':validateId(idValue);}function validateId(idValue){return idValue=stripPlaceholders(idValue),containsSpace(idValue)?'Id must not contain spaces.':ID_REGEX.test(idValue)?void 0:QNAME_REGEX.test(idValue)?'Id must not contain prefix.':'Id must be a valid QName.';}function containsSpace(value){return SPACE_REGEX.test(value);}function stripPlaceholders(idValue){return idValue.replace(PLACEHOLDER_REGEX,'$1');}function nextId(prefix){var ids=new Ids([32,32,1]);return ids.nextPrefixed(prefix);}function triggerClickEvent(element){var evt;var eventType='click';if(document.createEvent){try{evt=new MouseEvent(eventType,{view:window,bubbles:!0,cancelable:!0});}catch(e){evt=document.createEvent('MouseEvent');evt.initEvent(eventType,true,true);}return element.dispatchEvent(evt);}else return evt=document.createEventObject(),element.fireEvent('on'+eventType,evt);}var domQuery=require('min-dom/lib/query'),domClear=require('min-dom/lib/clear'),is=require('bpmn-js/lib/util/ModelUtil').is,forEach=require('lodash/collection/forEach'),domify=require('min-dom/lib/domify'),Ids=require('ids');var SPACE_REGEX=/\s/;var QNAME_REGEX=/^([a-z][\w-.]*:)?[a-z_][\w-.]*$/i;var ID_REGEX=/^[a-z_][\w-.]*$/i;var PLACEHOLDER_REGEX=/\$\{([^\}]*)\}/g;module.exports.selectedOption=selectedOption,module.exports.selectedType=selectedType,module.exports.getRoot=getRoot,module.exports.filterElementsByType=filterElementsByType,module.exports.findRootElementsByType=findRootElementsByType,module.exports.removeAllChildren=removeAllChildren,module.exports.addEmptyParameter=addEmptyParameter,module.exports.refreshOptionsModel=refreshOptionsModel,module.exports.updateOptionsDropDown=updateOptionsDropDown,module.exports.isIdValid=isIdValid,module.exports.validateId=validateId,module.exports.containsSpace=containsSpace,module.exports.nextId=nextId,module.exports.triggerClickEvent=triggerClickEvent;},{'bpmn-js/lib/util/ModelUtil':159,ids:349,'lodash/collection/forEach':357,'min-dom/lib/clear':52,'min-dom/lib/domify':55,'min-dom/lib/query':57}],11:[function(require,module,exports){'use strict';function CreateAndReferenceElementHandler(elementRegistry,bpmnFactory){this._elementRegistry=elementRegistry,this._bpmnFactory=bpmnFactory;}function ensureNotNull(prop,name){if(!prop)throw new Error(name+' required');return prop;}var elementHelper=require('../helper/ElementHelper');CreateAndReferenceElementHandler.$inject=['elementRegistry','bpmnFactory'],module.exports=CreateAndReferenceElementHandler,CreateAndReferenceElementHandler.prototype.execute=function(context){var referencingObject=ensureNotNull(context.referencingObject,'referencingObject'),referenceProperty=ensureNotNull(context.referenceProperty,'referenceProperty'),newObject=ensureNotNull(context.newObject,'newObject'),newObjectContainer=ensureNotNull(context.newObjectContainer,'newObjectContainer'),newObjectParent=ensureNotNull(context.newObjectParent,'newObjectParent'),changed=[context.element];var referencedObject=elementHelper.createElement(newObject.type,newObject.properties,newObjectParent,this._bpmnFactory);return context.referencedObject=referencedObject,newObjectContainer.push(referencedObject),context.previousReference=referencingObject[referenceProperty],referencingObject[referenceProperty]=referencedObject,context.changed=changed,changed;},CreateAndReferenceElementHandler.prototype.revert=function(context){var referencingObject=context.referencingObject,referenceProperty=context.referenceProperty,previousReference=context.previousReference,referencedObject=context.referencedObject,newObjectContainer=context.newObjectContainer;return referencingObject.set(referenceProperty,previousReference),newObjectContainer.splice(newObjectContainer.indexOf(referencedObject),1),context.changed;};},{'../helper/ElementHelper':29}],12:[function(require,module,exports){'use strict';function CreateBusinessObjectListHandler(elementRegistry,bpmnFactory){this._elementRegistry=elementRegistry,this._bpmnFactory=bpmnFactory;}function ensureNotNull(prop,name){if(!prop)throw new Error(name+' required');return prop;}function ensureList(prop,name){if(!prop||Object.prototype.toString.call(prop)!=='[object Array]')throw new Error(name+' needs to be a list');return prop;}var forEach=require('lodash/collection/forEach');var elementHelper=require('../helper/ElementHelper');CreateBusinessObjectListHandler.$inject=['elementRegistry','bpmnFactory'],module.exports=CreateBusinessObjectListHandler,CreateBusinessObjectListHandler.prototype.execute=function(context){var currentObject=ensureNotNull(context.currentObject,'currentObject'),propertyName=ensureNotNull(context.propertyName,'propertyName'),newObjects=ensureList(context.newObjects,'newObjects'),changed=[context.element];var childObjects=[];var self=this;return forEach(newObjects,function(obj){var element=elementHelper.createElement(obj.type,obj.properties,currentObject,self._bpmnFactory);childObjects.push(element);}),context.childObject=childObjects,context.previousChilds=currentObject[propertyName],currentObject[propertyName]=childObjects,context.changed=changed,changed;},CreateBusinessObjectListHandler.prototype.revert=function(context){var currentObject=context.currentObject,propertyName=context.propertyName,previousChilds=context.previousChilds;return currentObject.set(propertyName,previousChilds),context.changed;};},{'../helper/ElementHelper':29,'lodash/collection/forEach':357}],13:[function(require,module,exports){'use strict';function MultiCommandHandler(commandStack){this._commandStack=commandStack;}var forEach=require('lodash/collection/forEach');MultiCommandHandler.$inject=['commandStack'],module.exports=MultiCommandHandler,MultiCommandHandler.prototype.preExecute=function(context){var commandStack=this._commandStack;forEach(context,function(command){commandStack.execute(command.cmd,command.context);});};},{'lodash/collection/forEach':357}],14:[function(require,module,exports){'use strict';function UpdateBusinessObjectHandler(elementRegistry){this._elementRegistry=elementRegistry;}function getRoot(businessObject){var parent=businessObject;while(parent.$parent)parent=parent.$parent;return parent;}function getProperties(businessObject,propertyNames){return reduce(propertyNames,function(result,key){return result[key]=businessObject.get(key),result;},{});}function setProperties(businessObject,properties){forEach(properties,function(value,key){businessObject.set(key,value);});}var reduce=require('lodash/object/transform'),is=require('bpmn-js/lib/util/ModelUtil').is,keys=require('lodash/object/keys'),forEach=require('lodash/collection/forEach');UpdateBusinessObjectHandler.$inject=['elementRegistry'],module.exports=UpdateBusinessObjectHandler,UpdateBusinessObjectHandler.prototype.execute=function(context){var element=context.element,businessObject=context.businessObject,rootElements=getRoot(businessObject).rootElements,referenceType=context.referenceType,referenceProperty=context.referenceProperty,changed=[element];if(!element)throw new Error('element required');if(!businessObject)throw new Error('businessObject required');var properties=context.properties,oldProperties=context.oldProperties||getProperties(businessObject,keys(properties));return referenceType!==void 0&&referenceProperty!==void 0&&forEach(rootElements,function(rootElement){is(rootElement,referenceType)&&rootElement.id===properties[referenceProperty]&&(properties[referenceProperty]=rootElement);}),setProperties(businessObject,properties),context.oldProperties=oldProperties,context.changed=changed,changed;},UpdateBusinessObjectHandler.prototype.revert=function(context){var oldProperties=context.oldProperties,businessObject=context.businessObject;return setProperties(businessObject,oldProperties),context.changed;};},{'bpmn-js/lib/util/ModelUtil':159,'lodash/collection/forEach':357,'lodash/object/keys':432,'lodash/object/transform':435}],15:[function(require,module,exports){'use strict';function UpdateBusinessObjectListHandler(elementRegistry,bpmnFactory){this._elementRegistry=elementRegistry,this._bpmnFactory=bpmnFactory;}function ensureNotNull(prop,name){if(!prop)throw new Error(name+'required');return prop;}var forEach=require('lodash/collection/forEach');UpdateBusinessObjectListHandler.$inject=['elementRegistry','bpmnFactory'],module.exports=UpdateBusinessObjectListHandler,UpdateBusinessObjectListHandler.prototype.execute=function(context){var currentObject=ensureNotNull(context.currentObject,'currentObject'),propertyName=ensureNotNull(context.propertyName,'propertyName'),updatedObjectList=context.updatedObjectList,objectsToRemove=context.objectsToRemove||[],objectsToAdd=context.objectsToAdd||[],changed=[context.element],referencePropertyName;context.referencePropertyName&&(referencePropertyName=context.referencePropertyName);var objectList=currentObject[propertyName];if(context.previousList=currentObject[propertyName],updatedObjectList)currentObject[propertyName]=updatedObjectList;else{var listCopy=[];if(forEach(objectList,function(object){objectsToRemove.indexOf(object)==-1&&listCopy.push(object);}),listCopy=listCopy.concat(objectsToAdd),listCopy.length>0||!referencePropertyName)currentObject[propertyName]=listCopy;else if(referencePropertyName){var parentObject=currentObject.$parent;parentObject.set(referencePropertyName,undefined);}}return context.changed=changed,changed;},UpdateBusinessObjectListHandler.prototype.revert=function(context){var currentObject=context.currentObject,propertyName=context.propertyName,previousList=context.previousList,parentObject=currentObject.$parent;return context.referencePropertyName&&parentObject.set(context.referencePropertyName,currentObject),currentObject.set(propertyName,previousList),context.changed;};},{'lodash/collection/forEach':357}],16:[function(require,module,exports){'use strict';function CommandInitializer(eventBus,commandStack){eventBus.on('diagram.init',function(){forEach(HANDLERS,function(handler,id){commandStack.registerHandler(id,handler);});});}var forEach=require('lodash/collection/forEach');var HANDLERS={'properties-panel.update-businessobject':require('./UpdateBusinessObjectHandler'),'properties-panel.create-and-reference':require('./CreateAndReferenceHandler'),'properties-panel.create-businessobject-list':require('./CreateBusinessObjectListHandler'),'properties-panel.update-businessobject-list':require('./UpdateBusinessObjectListHandler'),'properties-panel.multi-command-executor':require('./MultiCommandHandler')};CommandInitializer.$inject=['eventBus','commandStack'],module.exports={__init__:[CommandInitializer]};},{'./CreateAndReferenceHandler':11,'./CreateBusinessObjectListHandler':12,'./MultiCommandHandler':13,'./UpdateBusinessObjectHandler':14,'./UpdateBusinessObjectListHandler':15,'lodash/collection/forEach':357}],17:[function(require,module,exports){'use strict';var getBusinessObject=require('bpmn-js/lib/util/ModelUtil').getBusinessObject,cmdHelper=require('../helper/CmdHelper');var entryFieldDescription=require('./EntryFieldDescription');var checkbox=function checkbox(options,defaultParameters){var resource=defaultParameters,label=options.label||resource.id,canBeDisabled=!!options.disabled&&typeof options.disabled==='function',canBeHidden=!!options.hidden&&typeof options.hidden==='function',description=options.description;return resource.html='<input id="camunda-'+resource.id+'" '+'type="checkbox" '+'name="'+options.modelProperty+'" '+(canBeDisabled?'data-disable="isDisabled"':'')+(canBeHidden?'data-show="isHidden"':'')+' />'+'<label for="camunda-'+resource.id+'" '+(canBeDisabled?'data-disable="isDisabled"':'')+(canBeHidden?'data-show="isHidden"':'')+'>'+label+'</label>',description&&(resource.html+=entryFieldDescription(description)),resource.get=function(element){var bo=getBusinessObject(element),res={};return res[options.modelProperty]=bo.get(options.modelProperty),res;},resource.set=function(element,values){var res={};return res[options.modelProperty]=!!values[options.modelProperty],cmdHelper.updateProperties(element,res);},typeof options.set==='function'&&(resource.set=options.set),typeof options.get==='function'&&(resource.get=options.get),canBeDisabled&&(resource.isDisabled=function(){return options.disabled.apply(resource,arguments);}),canBeHidden&&(resource.isHidden=function(){return!options.hidden.apply(resource,arguments);}),resource.cssClasses=['bpp-checkbox'],resource;};module.exports=checkbox;},{'../helper/CmdHelper':28,'./EntryFieldDescription':20,'bpmn-js/lib/util/ModelUtil':159}],18:[function(require,module,exports){'use strict';var assign=require('lodash/object/assign'),find=require('lodash/collection/find');var domQuery=require('min-dom/lib/query');var selectEntryFactory=require('./SelectEntryFactory'),entryFieldDescription=require('./EntryFieldDescription');var comboBox=function comboBox(options){var selectOptions=options.selectOptions,modelProperty=options.modelProperty,customValue=options.customValue||'custom',customName=options.customName||'custom '+modelProperty,description=options.description;var isCustomValue=function isCustomValue(value){if(value[modelProperty]===void 0)return!1;var isCustom=!find(selectOptions,function(option){return value[modelProperty]===option.value;});return isCustom;};var comboOptions=assign({},options);comboOptions.showCustomInput=function(element,node){var selectBox=domQuery('[data-entry="'+options.id+'"] select',node.parentNode);return selectBox?selectBox.value===customValue:!1;},comboOptions.get=function(element,node){var value=options.get(element,node);var modifiedValues={};return isCustomValue(value)?(modifiedValues[modelProperty]=customValue,modifiedValues['custom-'+modelProperty]=value[modelProperty],modifiedValues):(modifiedValues[modelProperty]=value[modelProperty]||'',modifiedValues);},comboOptions.set=function(element,values,node){var modifiedValues={};return values[modelProperty]===customValue?modifiedValues[modelProperty]=values['custom-'+modelProperty]||'':options.emptyParameter&&values[modelProperty]===''?modifiedValues[modelProperty]=undefined:modifiedValues[modelProperty]=values[modelProperty],options.set(element,modifiedValues,node);},comboOptions.selectOptions.push({name:customName,value:customValue});var comboBoxEntry=assign({},selectEntryFactory(comboOptions,comboOptions));return comboBoxEntry.html+='<div class="bpp-field-wrapper bpp-combo-input" '+'data-show="showCustomInput"'+'>'+'<input id="camunda-'+options.id+'-input" type="text" name="custom-'+modelProperty+'" '+' />'+'</div>',description&&(comboBoxEntry.html+=entryFieldDescription(description)),comboBoxEntry;};module.exports=comboBox;},{'./EntryFieldDescription':20,'./SelectEntryFactory':23,'lodash/collection/find':356,'lodash/object/assign':430,'min-dom/lib/query':57}],19:[function(require,module,exports){'use strict';function ensureNotNull(prop){if(!prop)throw new Error(prop+' must be set.');return prop;}function EntryFactory(){}var getBusinessObject=require('bpmn-js/lib/util/ModelUtil').getBusinessObject;var textInputField=require('./TextInputEntryFactory'),checkboxField=require('./CheckboxEntryFactory'),selectBoxField=require('./SelectEntryFactory'),comboBoxField=require('./ComboEntryFactory'),textBoxField=require('./TextBoxEntryFactory'),validationAwareTextInputField=require('./ValidationAwareTextInput'),tableField=require('./TableEntryFactory'),labelEntry=require('./LabelFactory'),link=require('./LinkEntryFactory');var cmdHelper=require('../helper/CmdHelper');var setDefaultParameters=function setDefaultParameters(options){var defaultGet=function defaultGet(element){var bo=getBusinessObject(element),res={},prop=ensureNotNull(options.modelProperty);return res[prop]=bo.get(prop),res;};var defaultSet=function defaultSet(element,values){var res={},prop=ensureNotNull(options.modelProperty);return values[prop]!==''?res[prop]=values[prop]:res[prop]=undefined,cmdHelper.updateProperties(element,res);};var defaultValidate=function defaultValidate(){return{};};return{id:options.id,description:options.description||'',get:options.get||defaultGet,set:options.set||defaultSet,validate:options.validate||defaultValidate,html:''};};EntryFactory.textField=function(options){return textInputField(options,setDefaultParameters(options));},EntryFactory.validationAwareTextField=function(options){return validationAwareTextInputField(options,setDefaultParameters(options));},EntryFactory.checkbox=function(options){return checkboxField(options,setDefaultParameters(options));},EntryFactory.textBox=function(options){return textBoxField(options,setDefaultParameters(options));},EntryFactory.selectBox=function(options){return selectBoxField(options,setDefaultParameters(options));},EntryFactory.comboBox=function(options){return comboBoxField(options);},EntryFactory.table=function(options){return tableField(options);},EntryFactory.label=function(options){return labelEntry(options);},EntryFactory.link=function(options){return link(options);},module.exports=EntryFactory;},{'../helper/CmdHelper':28,'./CheckboxEntryFactory':17,'./ComboEntryFactory':18,'./LabelFactory':21,'./LinkEntryFactory':22,'./SelectEntryFactory':23,'./TableEntryFactory':24,'./TextBoxEntryFactory':25,'./TextInputEntryFactory':26,'./ValidationAwareTextInput':27,'bpmn-js/lib/util/ModelUtil':159}],20:[function(require,module,exports){'use strict';function linkify(text){return text.replace(MARKDOWN_LINK_REGEX,'<a href="$2" target="_blank">$1</a>');}var MARKDOWN_LINK_REGEX=/\[([^\)]+)\]\(([^\]]+)\)/g;module.exports=function entryFieldDescription(description){return description=linkify(description),'<div class="bpp-field-description">'+description+'</div>';};},{}],21:[function(require,module,exports){'use strict';var label=function label(options){return{id:options.id,html:'<label data-value="label" '+'data-show="showLabel" '+'class="entry-label'+(options.divider?' divider':'')+'">'+'</label>',get:function get(element,node){return typeof options.get==='function'?options.get(element,node):{label:options.labelText};},showLabel:function showLabel(element,node){return typeof options.showLabel==='function'?options.showLabel(element,node):!0;}};};module.exports=label;},{}],22:[function(require,module,exports){'use strict';var utils=require('../Utils');var entryFieldDescription=require('./EntryFieldDescription');var link=function link(options,defaultParameters){var id=options.id,label=options.label||id,hideLink=options.hideLink,canBeHidden=typeof hideLink==='function',getClickableElement=options.getClickableElement,description=options.description;var resource={id:id};return resource.html='<a data-action="linkSelected" '+(canBeHidden?'data-show="hideLink" ':'')+'class="bpp-entry-link'+(options.cssClasses?' '+options.cssClasses:'')+'">'+label+'</a>',description&&(resource.html+=entryFieldDescription(description)),resource.linkSelected=function(element,node,event,scopeNode){if(typeof getClickableElement==='function'){var link=getClickableElement.apply(resource,[element,node,event,scopeNode]);link&&utils.triggerClickEvent(link);}return!1;},canBeHidden&&(resource.hideLink=function(){return!hideLink.apply(resource,arguments);}),resource;};module.exports=link;},{'../Utils':10,'./EntryFieldDescription':20}],23:[function(require,module,exports){'use strict';var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj;};var domify=require('min-dom/lib/domify');var forEach=require('lodash/collection/forEach');var entryFieldDescription=require('./EntryFieldDescription');var isList=function isList(list){return!(!list||Object.prototype.toString.call(list)!=='[object Array]');};var addEmptyParameter=function addEmptyParameter(list){return list.concat([{name:'',value:''}]);};var createOption=function createOption(option){return'<option value="'+option.value+'">'+option.name+'</option>';};var selectbox=function selectbox(options,defaultParameters){var resource=defaultParameters,label=options.label||resource.id,selectOptions=options.selectOptions||[{name:'',value:''}],modelProperty=options.modelProperty,emptyParameter=options.emptyParameter,canBeDisabled=!!options.disabled&&typeof options.disabled==='function',canBeHidden=!!options.hidden&&typeof options.hidden==='function',description=options.description;return emptyParameter&&(selectOptions=addEmptyParameter(selectOptions)),resource.html='<label for="camunda-'+resource.id+'"'+(canBeDisabled?'data-disable="isDisabled" ':'')+(canBeHidden?'data-show="isHidden" ':'')+'>'+label+'</label>'+'<select id="camunda-'+resource.id+'-select" name="'+modelProperty+'"'+(canBeDisabled?'data-disable="isDisabled" ':'')+(canBeHidden?'data-show="isHidden" ':'')+' data-value>',isList(selectOptions)&&forEach(selectOptions,function(option){resource.html+='<option value="'+option.value+'">'+(option.name||'')+'</option>';}),resource.html+='</select>',description&&!_typeof(options.showCustomInput)==='function'&&(resource.html+=entryFieldDescription(description)),resource.setControlValue=function(element,entryNode,inputNode,inputName,newValue){if(typeof selectOptions==='function'){var options=selectOptions(element,inputNode);if(options){while(inputNode.firstChild)inputNode.removeChild(inputNode.firstChild);forEach(options,function(option){var template=domify(createOption(option));inputNode.appendChild(template);});}}newValue!==undefined&&(inputNode.value=newValue);},canBeDisabled&&(resource.isDisabled=function(){return options.disabled.apply(resource,arguments);}),canBeHidden&&(resource.isHidden=function(){return!options.hidden.apply(resource,arguments);}),resource.cssClasses=['bpp-dropdown'],resource;};module.exports=selectbox;},{'./EntryFieldDescription':20,'lodash/collection/forEach':357,'min-dom/lib/domify':55}],24:[function(require,module,exports){'use strict';function createInputRowTemplate(properties,canRemove){var template=TABLE_ROW_DIV_SNIPPET;return template+=createInputTemplate(properties,canRemove),template+=canRemove?DELETE_ROW_BUTTON_SNIPPET:'',template+='</div>',template;}function createInputTemplate(properties,canRemove){var columns=properties.length;var template='';return forEach(properties,function(prop){template+='<input class="bpp-table-row-columns-'+columns+' '+(canRemove?'bpp-table-row-removable':'')+'" '+'id="camunda-table-row-cell-input-value" '+'type="text" '+'name="'+prop+'" />';}),template;}function createLabelRowTemplate(labels){var template=TABLE_ROW_DIV_SNIPPET;return template+=createLabelTemplate(labels),template+='</div>',template;}function createLabelTemplate(labels){var columns=labels.length;var template='';return forEach(labels,function(label){template+='<label class="bpp-table-row-columns-'+columns+'">'+label+'</label>';}),template;}function pick(elements,properties){return(elements||[]).map(function(elem){var newElement={};return forEach(properties,function(prop){newElement[prop]=elem[prop]||'';}),newElement;});}function diff(element,node,values,oldValues,editable){return filter(values,function(value,idx){return!valueEqual(element,node,value,oldValues[idx],editable,idx);});}function valueEqual(element,node,value,oldValue,editable,idx){if(value&&!oldValue)return!1;var allKeys=keys(value).concat(keys(oldValue));return allKeys.every(function(key){var n=value[key]||undefined;var o=oldValue[key]||undefined;return!editable(element,node,key,idx)||n===o;});}function getEntryNode(node){return domClosest(node,'[data-entry]',!0);}function getContainer(node){return domQuery('div[data-list-entry-container]',node);}function getSelection(node){return{start:node.selectionStart,end:node.selectionEnd};}function setSelection(node,selection){node.selectionStart=selection.start,node.selectionEnd=selection.end;}var cmdHelper=require('../helper/CmdHelper');var domQuery=require('min-dom/lib/query'),domAttr=require('min-dom/lib/attr'),domClosest=require('min-dom/lib/closest');var filter=require('lodash/collection/filter'),forEach=require('lodash/collection/forEach'),keys=require('lodash/object/keys');var domify=require('min-dom/lib/domify');var entryFieldDescription=require('./EntryFieldDescription');var updateSelection=require('selection-update');var TABLE_ROW_DIV_SNIPPET='<div class="bpp-field-wrapper bpp-table-row">';var DELETE_ROW_BUTTON_SNIPPET='<button class="clear" data-action="deleteElement">'+'<span>X</span>'+'</button>';module.exports=function(options){var id=options.id,modelProperties=options.modelProperties,labels=options.labels,description=options.description;var labelRow=createLabelRowTemplate(labels);var getElements=options.getElements;var removeElement=options.removeElement,canRemove=typeof removeElement==='function';var addElement=options.addElement,canAdd=typeof addElement==='function',addLabel=options.addLabel||'Add Value';var updateElement=options.updateElement,canUpdate=typeof updateElement==='function';var _editable=options.editable||function(){return!0;},setControlValue=options.setControlValue;var _show=options.show,canBeShown=typeof _show==='function';var elements=function elements(element,node){return pick(getElements(element,node),modelProperties);};var factory={id:id,html:(canAdd?'<div class="bpp-table-add-row" '+(canBeShown?'data-show="show"':'')+'>'+'<label>'+addLabel+'</label>'+'<button class="add" data-action="addElement"><span>+</span></button>'+'</div>':'')+'<div class="bpp-table" data-show="showTable">'+'<div class="bpp-field-wrapper bpp-table-row">'+labelRow+'</div>'+'<div data-list-entry-container>'+'</div>'+'</div>'+(description?entryFieldDescription(description):''),get:function get(element,node){var boElements=elements(element,node,this.__invalidValues);var invalidValues=this.__invalidValues;return delete this.__invalidValues,forEach(invalidValues,function(value,idx){var element=boElements[idx];forEach(modelProperties,function(prop){element[prop]=value[prop];});}),boElements;},set:function set(element,values,node){var action=this.__action||{};if(delete this.__action,action.id==='delete-element')return removeElement(element,node,action.idx);else if(action.id==='add-element')return addElement(element,node);else if(canUpdate){var commands=[],valuesToValidate=values;typeof options.validate!=='function'&&(valuesToValidate=diff(element,node,values,elements(element,node),_editable));var self=this;return forEach(valuesToValidate,function(value){var validationError,idx=values.indexOf(value);if(typeof options.validate==='function'&&(validationError=options.validate(element,value,node,idx)),!validationError){var cmd=updateElement(element,value,node,idx);cmd&&commands.push(cmd);}else self.__invalidValues=self.__invalidValues||{},self.__invalidValues[idx]=value,commands.push(cmdHelper.updateProperties(element,{}));}),commands;}},createListEntryTemplate:function createListEntryTemplate(value,index,selectBox){return createInputRowTemplate(modelProperties,canRemove);},addElement:function addElement(element,node,event,scopeNode){var template=domify(createInputRowTemplate(modelProperties,canRemove));var container=getContainer(node);return container.appendChild(template),this.__action={id:'add-element'},!0;},deleteElement:function deleteElement(element,node,event,scopeNode){var container=getContainer(node);var rowToDelete=event.delegateTarget.parentNode;var idx=parseInt(domAttr(rowToDelete,'data-index'),10);return container.removeChild(rowToDelete),this.__action={id:'delete-element',idx:idx},!0;},editable:function editable(element,rowNode,input,prop,value,idx){var entryNode=domClosest(rowNode,'[data-entry]');return _editable(element,entryNode,prop,idx);},show:function show(element,entryNode,node,scopeNode){return entryNode=getEntryNode(entryNode),_show(element,entryNode,node,scopeNode);},showTable:function showTable(element,entryNode,node,scopeNode){entryNode=getEntryNode(entryNode);var elems=elements(element,entryNode);return elems&&elems.length&&(!canBeShown||_show(element,entryNode,node,scopeNode));},validateListItem:function validateListItem(element,value,node,idx){return typeof options.validate==='function'?options.validate(element,value,node,idx):void 0;}};return setControlValue&&(factory.setControlValue=function(element,rowNode,input,prop,value,idx){var entryNode=getEntryNode(rowNode);var isReadOnly=domAttr(input,'readonly');var oldValue=input.value;var selection;if(value===undefined&&(value=''),isReadOnly&&oldValue===value)return;document.activeElement===input&&(selection=updateSelection(getSelection(input),oldValue,value)),setControlValue(element,entryNode,input,prop,value,idx),selection&&setSelection(input,selection);}),factory;};},{'../helper/CmdHelper':28,'./EntryFieldDescription':20,'lodash/collection/filter':355,'lodash/collection/forEach':357,'lodash/object/keys':432,'min-dom/lib/attr':50,'min-dom/lib/closest':53,'min-dom/lib/domify':55,'min-dom/lib/query':57,'selection-update':466}],25:[function(require,module,exports){'use strict';var entryFieldDescription=require('./EntryFieldDescription');var textBox=function textBox(options,defaultParameters){var resource=defaultParameters,label=options.label||resource.id,canBeShown=!!options.show&&typeof options.show==='function',description=options.description;return resource.html='<label for="camunda-'+resource.id+'" '+(canBeShown?'data-show="isShown"':'')+'>'+label+'</label>'+'<div class="bpp-field-wrapper" '+(canBeShown?'data-show="isShown"':'')+'>'+'<div contenteditable="true" id="camunda-'+resource.id+'" '+'name="'+options.modelProperty+'" />'+'</div>',description&&(resource.html+=entryFieldDescription(description)),canBeShown&&(resource.isShown=function(){return options.show.apply(resource,arguments);}),resource.cssClasses=['bpp-textbox'],resource;};module.exports=textBox;},{'./EntryFieldDescription':20}],26:[function(require,module,exports){'use strict';var domQuery=require('min-dom/lib/query');var entryFieldDescription=require('./EntryFieldDescription');var textField=function textField(options,defaultParameters){var defaultButtonAction=function defaultButtonAction(element,inputNode){var input=domQuery('input[name="'+options.modelProperty+'"]',inputNode);return input.value='',!0;};var defaultButtonShow=function defaultButtonShow(element,inputNode){var input=domQuery('input[name="'+options.modelProperty+'"]',inputNode);return input.value!=='';};var resource=defaultParameters,label=options.label||resource.id,dataValueLabel=options.dataValueLabel,buttonLabel=options.buttonLabel||'X',actionName=options.buttonAction!==void 0?options.buttonAction.name:'clear',actionMethod=options.buttonAction!==void 0?options.buttonAction.method:defaultButtonAction,showName=options.buttonShow!==void 0?options.buttonShow.name:'canClear',showMethod=options.buttonShow!==void 0?options.buttonShow.method:defaultButtonShow,canBeDisabled=!!options.disabled&&typeof options.disabled==='function',canBeHidden=!!options.hidden&&typeof options.hidden==='function',description=options.description;return resource.html='<label for="camunda-'+resource.id+'" '+(canBeDisabled?'data-disable="isDisabled" ':'')+(canBeHidden?'data-show="isHidden" ':'')+(dataValueLabel?'data-value="'+dataValueLabel+'"':'')+'>'+label+'</label>'+'<div class="bpp-field-wrapper" '+(canBeDisabled?'data-disable="isDisabled"':'')+(canBeHidden?'data-show="isHidden"':'')+'>'+'<input id="camunda-'+resource.id+'" type="text" name="'+options.modelProperty+'" '+(canBeDisabled?'data-disable="isDisabled"':'')+(canBeHidden?'data-show="isHidden"':'')+' />'+'<button class="'+actionName+'" data-action="'+actionName+'" data-show="'+showName+'" '+(canBeDisabled?'data-disable="isDisabled"':'')+(canBeHidden?' data-show="isHidden"':'')+'>'+'<span>'+buttonLabel+'</span>'+'</button>'+'</div>',description&&(resource.html+=entryFieldDescription(description)),resource[actionName]=actionMethod,resource[showName]=showMethod,canBeDisabled&&(resource.isDisabled=function(){return options.disabled.apply(resource,arguments);}),canBeHidden&&(resource.isHidden=function(){return!options.hidden.apply(resource,arguments);}),resource.cssClasses=['bpp-textfield'],resource;};module.exports=textField;},{'./EntryFieldDescription':20,'min-dom/lib/query':57}],27:[function(require,module,exports){'use strict';var textField=require('./TextInputEntryFactory');var validationAwareTextField=function validationAwareTextField(options,defaultParameters){var modelProperty=options.modelProperty;defaultParameters.get=function(element,node){var value=this.__lastInvalidValue;delete this.__lastInvalidValue;var properties={};return properties[modelProperty]=value!==undefined?value:options.getProperty(element,node),properties;},defaultParameters.set=function(element,values,node){var validationErrors=validate.apply(this,[element,values,node]),propertyValue=values[modelProperty];if(validationErrors&&validationErrors[modelProperty])return this.__lastInvalidValue=propertyValue,options.setProperty(element,{},node);else{var properties={};return properties[modelProperty]=propertyValue,options.setProperty(element,properties,node);}};var validate=defaultParameters.validate=function(element,values,node){var value=values[modelProperty]||this.__lastInvalidValue;var property={};return property[modelProperty]=value,options.validate(element,property,node);};return textField(options,defaultParameters);};module.exports=validationAwareTextField;},{'./TextInputEntryFactory':26}],28:[function(require,module,exports){'use strict';var CmdHelper={};module.exports=CmdHelper,CmdHelper.updateProperties=function(element,properties){return{cmd:'element.updateProperties',context:{element:element,properties:properties}};},CmdHelper.updateBusinessObject=function(element,businessObject,newProperties){return{cmd:'properties-panel.update-businessobject',context:{element:element,businessObject:businessObject,properties:newProperties}};},CmdHelper.addElementsTolist=function(element,businessObject,listPropertyName,objectsToAdd){return{cmd:'properties-panel.update-businessobject-list',context:{element:element,currentObject:businessObject,propertyName:listPropertyName,objectsToAdd:objectsToAdd}};},CmdHelper.removeElementsFromList=function(element,businessObject,listPropertyName,referencePropertyName,objectsToRemove){return{cmd:'properties-panel.update-businessobject-list',context:{element:element,currentObject:businessObject,propertyName:listPropertyName,referencePropertyName:referencePropertyName,objectsToRemove:objectsToRemove}};},CmdHelper.addAndRemoveElementsFromList=function(element,businessObject,listPropertyName,referencePropertyName,objectsToAdd,objectsToRemove){return{cmd:'properties-panel.update-businessobject-list',context:{element:element,currentObject:businessObject,propertyName:listPropertyName,referencePropertyName:referencePropertyName,objectsToAdd:objectsToAdd,objectsToRemove:objectsToRemove}};},CmdHelper.setList=function(element,businessObject,listPropertyName,updatedObjectList){return{cmd:'properties-panel.update-businessobject-list',context:{element:element,currentObject:businessObject,propertyName:listPropertyName,updatedObjectList:updatedObjectList}};};},{}],29:[function(require,module,exports){'use strict';var ElementHelper={};module.exports=ElementHelper,ElementHelper.createElement=function(elementType,properties,parent,factory){var element=factory.create(elementType,properties);return element.$parent=parent,element;};},{}],30:[function(require,module,exports){'use strict';var getBusinessObject=require('bpmn-js/lib/util/ModelUtil').getBusinessObject,is=require('bpmn-js/lib/util/ModelUtil').is,forEach=require('lodash/collection/forEach');var EventDefinitionHelper={};module.exports=EventDefinitionHelper,EventDefinitionHelper.getEventDefinition=function(element,eventType){var bo=getBusinessObject(element),eventDefinition=null;return bo.eventDefinitions&&forEach(bo.eventDefinitions,function(event){is(event,eventType)&&(eventDefinition=event);}),eventDefinition;},EventDefinitionHelper.getTimerEventDefinition=function(element){return this.getEventDefinition(element,'bpmn:TimerEventDefinition');},EventDefinitionHelper.getMessageEventDefinition=function(element){return this.getEventDefinition(element,'bpmn:MessageEventDefinition');},EventDefinitionHelper.getSignalEventDefinition=function(element){return this.getEventDefinition(element,'bpmn:SignalEventDefinition');},EventDefinitionHelper.getErrorEventDefinition=function(element){return this.getEventDefinition(element,'bpmn:ErrorEventDefinition');},EventDefinitionHelper.getEscalationEventDefinition=function(element){return this.getEventDefinition(element,'bpmn:EscalationEventDefinition');},EventDefinitionHelper.getCompensateEventDefinition=function(element){return this.getEventDefinition(element,'bpmn:CompensateEventDefinition');},EventDefinitionHelper.getLinkEventDefinition=function(element){return this.getEventDefinition(element,'bpmn:LinkEventDefinition');},EventDefinitionHelper.getConditionalEventDefinition=function(element){return this.getEventDefinition(element,'bpmn:ConditionalEventDefinition');};},{'bpmn-js/lib/util/ModelUtil':159,'lodash/collection/forEach':357}],31:[function(require,module,exports){'use strict';var is=require('bpmn-js/lib/util/ModelUtil').is,getBusinessObject=require('bpmn-js/lib/util/ModelUtil').getBusinessObject,cmdHelper=require('./CmdHelper');var ParticipantHelper={};module.exports=ParticipantHelper,ParticipantHelper.modifyProcessBusinessObject=function(element,property,values){if(!is(element,'bpmn:Participant'))return{};var bo=getBusinessObject(element).get('processRef'),properties={};return properties[property]=values[property],cmdHelper.updateBusinessObject(element,bo,properties);},ParticipantHelper.getProcessBusinessObject=function(element,propertyName){if(!is(element,'bpmn:Participant'))return{};var bo=getBusinessObject(element).get('processRef'),properties={};return properties[propertyName]=bo.get(propertyName),properties;};},{'./CmdHelper':28,'bpmn-js/lib/util/ModelUtil':159}],32:[function(require,module,exports){'use strict';module.exports={__depends__:[require('./cmd'),require('diagram-js/lib/i18n/translate')],__init__:['propertiesPanel'],propertiesPanel:['type',require('./PropertiesPanel')]};},{'./PropertiesPanel':9,'./cmd':16,'diagram-js/lib/i18n/translate':313}],33:[function(require,module,exports){'use strict';var is=require('bpmn-js/lib/util/ModelUtil').is,isAny=require('bpmn-js/lib/features/modeling/util/ModelingUtil').isAny,isEventSubProcess=require('bpmn-js/lib/util/DiUtil').isEventSubProcess,getBusinessObject=require('bpmn-js/lib/util/ModelUtil').getBusinessObject,eventDefinitionHelper=require('../../../helper/EventDefinitionHelper');var forEach=require('lodash/collection/forEach');var message=require('./implementation/MessageEventDefinition'),signal=require('./implementation/SignalEventDefinition'),error=require('./implementation/ErrorEventDefinition'),escalation=require('./implementation/EscalationEventDefinition'),timer=require('./implementation/TimerEventDefinition'),compensation=require('./implementation/CompensateEventDefinition'),condition=require('./implementation/ConditionalEventDefinition');module.exports=function(group,element,bpmnFactory,elementRegistry,translate){var events=['bpmn:StartEvent','bpmn:EndEvent','bpmn:IntermediateThrowEvent','bpmn:BoundaryEvent','bpmn:IntermediateCatchEvent'];forEach(events,function(event){if(is(element,event)){var messageEventDefinition=eventDefinitionHelper.getMessageEventDefinition(element),signalEventDefinition=eventDefinitionHelper.getSignalEventDefinition(element);messageEventDefinition&&message(group,element,bpmnFactory,messageEventDefinition),signalEventDefinition&&signal(group,element,bpmnFactory,signalEventDefinition);}}),is(element,'bpmn:ReceiveTask')&&message(group,element,bpmnFactory,getBusinessObject(element));var errorEvents=['bpmn:StartEvent','bpmn:BoundaryEvent','bpmn:EndEvent'];forEach(errorEvents,function(event){if(is(element,event)){var errorEventDefinition=eventDefinitionHelper.getErrorEventDefinition(element);if(errorEventDefinition){var isCatchingErrorEvent=is(element,'bpmn:StartEvent')||is(element,'bpmn:BoundaryEvent');var showErrorCodeVariable=isCatchingErrorEvent,showErrorMessageVariable=isCatchingErrorEvent;error(group,element,bpmnFactory,errorEventDefinition,showErrorCodeVariable,showErrorMessageVariable);}}});var escalationEvents=['bpmn:StartEvent','bpmn:BoundaryEvent','bpmn:IntermediateThrowEvent','bpmn:EndEvent'];forEach(escalationEvents,function(event){if(is(element,event)){var showEscalationCodeVariable=is(element,'bpmn:StartEvent')||is(element,'bpmn:BoundaryEvent');var escalationEventDefinition=eventDefinitionHelper.getEscalationEventDefinition(element);escalationEventDefinition&&escalation(group,element,bpmnFactory,escalationEventDefinition,showEscalationCodeVariable);}});var timerEvents=['bpmn:StartEvent','bpmn:BoundaryEvent','bpmn:IntermediateCatchEvent'];forEach(timerEvents,function(event){if(is(element,event)){var timerEventDefinition=eventDefinitionHelper.getTimerEventDefinition(element);timerEventDefinition&&timer(group,element,bpmnFactory,timerEventDefinition);}});var compensationEvents=['bpmn:EndEvent','bpmn:IntermediateThrowEvent'];forEach(compensationEvents,function(event){if(is(element,event)){var compensateEventDefinition=eventDefinitionHelper.getCompensateEventDefinition(element);compensateEventDefinition&&compensation(group,element,bpmnFactory,compensateEventDefinition,elementRegistry);}});var conditionalEvents=['bpmn:BoundaryEvent','bpmn:IntermediateThrowEvent','bpmn:IntermediateCatchEvent'];if(isAny(element,conditionalEvents)||is(element,'bpmn:StartEvent')&&isEventSubProcess(element.parent)){var conditionalEventDefinition=eventDefinitionHelper.getConditionalEventDefinition(element);conditionalEventDefinition&&condition(group,element,bpmnFactory,conditionalEventDefinition,elementRegistry);}};},{'../../../helper/EventDefinitionHelper':30,'./implementation/CompensateEventDefinition':38,'./implementation/ConditionalEventDefinition':39,'./implementation/ErrorEventDefinition':41,'./implementation/EscalationEventDefinition':42,'./implementation/MessageEventDefinition':44,'./implementation/SignalEventDefinition':46,'./implementation/TimerEventDefinition':47,'bpmn-js/lib/features/modeling/util/ModelingUtil':132,'bpmn-js/lib/util/DiUtil':157,'bpmn-js/lib/util/ModelUtil':159,'lodash/collection/forEach':357}],34:[function(require,module,exports){'use strict';var entryFactory=require('../../../factory/EntryFactory'),getBusinessObject=require('bpmn-js/lib/util/ModelUtil').getBusinessObject,utils=require('../../../Utils'),cmdHelper=require('../../../helper/CmdHelper');module.exports=function(group,element,translate){group.entries.push(entryFactory.validationAwareTextField({id:'id',label:translate('Id'),modelProperty:'id',getProperty:function getProperty(element){return getBusinessObject(element).id;},setProperty:function setProperty(element,properties){return element=element.labelTarget||element,cmdHelper.updateProperties(element,properties);},validate:function validate(element,values){var idValue=values.id;var bo=getBusinessObject(element);var idError=utils.isIdValid(bo,idValue);return idError?{id:idError}:{};}}));};},{'../../../Utils':10,'../../../factory/EntryFactory':19,'../../../helper/CmdHelper':28,'bpmn-js/lib/util/ModelUtil':159}],35:[function(require,module,exports){'use strict';function getLinkEventDefinition(element){var bo=getBusinessObject(element);var linkEventDefinition=null;return bo.eventDefinitions&&forEach(bo.eventDefinitions,function(eventDefinition){is(eventDefinition,'bpmn:LinkEventDefinition')&&(linkEventDefinition=eventDefinition);}),linkEventDefinition;}var is=require('bpmn-js/lib/util/ModelUtil').is,getBusinessObject=require('bpmn-js/lib/util/ModelUtil').getBusinessObject,entryFactory=require('../../../factory/EntryFactory'),cmdHelper=require('../../../helper/CmdHelper');var forEach=require('lodash/collection/forEach');module.exports=function(group,element,translate){var linkEvents=['bpmn:IntermediateThrowEvent','bpmn:IntermediateCatchEvent'];forEach(linkEvents,function(event){if(is(element,event)){var linkEventDefinition=getLinkEventDefinition(element);if(linkEventDefinition){var entry=entryFactory.textField({id:'link-event',label:translate('Link Name'),modelProperty:'link-name'});entry.get=function(){return{'link-name':linkEventDefinition.get('name')};},entry.set=function(element,values){var newProperties={name:values['link-name']};return cmdHelper.updateBusinessObject(element,linkEventDefinition,newProperties);},group.entries.push(entry);}}});};},{'../../../factory/EntryFactory':19,'../../../helper/CmdHelper':28,'bpmn-js/lib/util/ModelUtil':159,'lodash/collection/forEach':357}],36:[function(require,module,exports){'use strict';var nameEntryFactory=require('./implementation/Name'),is=require('bpmn-js/lib/util/ModelUtil').is;module.exports=function(group,element,translate){if(!is(element,'bpmn:Collaboration')){var options;is(element,'bpmn:TextAnnotation')&&(options={modelProperty:'text'}),group.entries=group.entries.concat(nameEntryFactory(element,options,translate));}};},{'./implementation/Name':45,'bpmn-js/lib/util/ModelUtil':159}],37:[function(require,module,exports){'use strict';var is=require('bpmn-js/lib/util/ModelUtil').is,entryFactory=require('../../../factory/EntryFactory'),participantHelper=require('../../../helper/ParticipantHelper'),getBusinessObject=require('bpmn-js/lib/util/ModelUtil').getBusinessObject,nameEntryFactory=require('./implementation/Name'),utils=require('../../../Utils');module.exports=function(group,element,translate){var businessObject=getBusinessObject(element);if((is(element,'bpmn:Process')||is(element,'bpmn:Participant')&&businessObject.get('processRef'))&&is(element,'bpmn:Participant')){var idEntry=entryFactory.validationAwareTextField({id:'process-id',label:translate('Process Id'),modelProperty:'processId'});idEntry.get=function(element){var properties=participantHelper.getProcessBusinessObject(element,'id');return{processId:properties.id};},idEntry.set=function(element,values){return participantHelper.modifyProcessBusinessObject(element,'id',{id:values.processId});},idEntry.validate=function(element,values){var idValue=values.processId;var bo=getBusinessObject(element);var processIdError=utils.isIdValid(bo.processRef,idValue);return processIdError?{processId:processIdError}:{};},group.entries.push(idEntry);var processNameEntry=nameEntryFactory(element,{id:'process-name',label:translate('Process Name')})[0];processNameEntry.get=function(element){return participantHelper.getProcessBusinessObject(element,'name');},processNameEntry.set=function(element,values){return participantHelper.modifyProcessBusinessObject(element,'name',values);},group.entries.push(processNameEntry);}};},{'../../../Utils':10,'../../../factory/EntryFactory':19,'../../../helper/ParticipantHelper':31,'./implementation/Name':45,'bpmn-js/lib/util/ModelUtil':159}],38:[function(require,module,exports){'use strict';function getContainedActivities(element){return getFlowElements(element,'bpmn:Activity');}function getContainedBoundaryEvents(element){return getFlowElements(element,'bpmn:BoundaryEvent');}function getFlowElements(element,type){return utils.filterElementsByType(element.flowElements,type);}function isCompensationEventAttachedToActivity(activity,boundaryEvents){var activityId=activity.id;var boundaryEvent=find(boundaryEvents,function(boundaryEvent){var compensateEventDefinition=eventDefinitionHelper.getCompensateEventDefinition(boundaryEvent);var attachedToRef=boundaryEvent.attachedToRef;return compensateEventDefinition&&attachedToRef&&attachedToRef.id===activityId;});return!!boundaryEvent;}function canActivityBeCompensated(activity,boundaryEvents){return is(activity,'bpmn:SubProcess')&&!activity.triggeredByEvent||is(activity,'bpmn:CallActivity')||isCompensationEventAttachedToActivity(activity,boundaryEvents);}function getActivitiesForCompensation(element){var boundaryEvents=getContainedBoundaryEvents(element);return filter(getContainedActivities(element),function(activity){return canActivityBeCompensated(activity,boundaryEvents);});}function getActivitiesForActivityRef(element){var bo=getBusinessObject(element);var parent=bo.$parent;var activitiesForActivityRef=getActivitiesForCompensation(parent);return is(parent,'bpmn:SubProcess')&&parent.triggeredByEvent&&(parent=parent.$parent,parent&&(activitiesForActivityRef=activitiesForActivityRef.concat(getActivitiesForCompensation(parent)))),activitiesForActivityRef;}function createActivityRefOptions(element){var options=[{value:''}];var activities=getActivitiesForActivityRef(element);return forEach(activities,function(activity){var activityId=activity.id;var name=(activity.name?activity.name+' ':'')+'(id='+activityId+')';options.push({value:activityId,name:name});}),options;}var entryFactory=require('../../../../factory/EntryFactory');var cmdHelper=require('../../../../helper/CmdHelper'),eventDefinitionHelper=require('../../../../helper/EventDefinitionHelper'),utils=require('../../../../Utils');var getBusinessObject=require('bpmn-js/lib/util/ModelUtil').getBusinessObject,is=require('bpmn-js/lib/util/ModelUtil').is;var forEach=require('lodash/collection/forEach'),find=require('lodash/collection/find'),filter=require('lodash/collection/filter');module.exports=function(group,element,bpmnFactory,compensateEventDefinition,elementRegistry){group.entries.push(entryFactory.checkbox({id:'wait-for-completion',label:'Wait for Completion',modelProperty:'waitForCompletion',get:function get(element,node){return{waitForCompletion:compensateEventDefinition.waitForCompletion};},set:function set(element,values){return values.waitForCompletion=values.waitForCompletion||!1,cmdHelper.updateBusinessObject(element,compensateEventDefinition,values);}})),group.entries.push(entryFactory.selectBox({id:'activity-ref',label:'Activity Ref',selectOptions:createActivityRefOptions(element),modelProperty:'activityRef',get:function get(element,node){var activityRef=compensateEventDefinition.activityRef;return activityRef=activityRef&&activityRef.id,{activityRef:activityRef||''};},set:function set(element,values){var activityRef=values.activityRef||undefined;return activityRef=activityRef&&getBusinessObject(elementRegistry.get(activityRef)),cmdHelper.updateBusinessObject(element,compensateEventDefinition,{activityRef:activityRef});}}));};},{'../../../../Utils':10,'../../../../factory/EntryFactory':19,'../../../../helper/CmdHelper':28,'../../../../helper/EventDefinitionHelper':30,'bpmn-js/lib/util/ModelUtil':159,'lodash/collection/filter':355,'lodash/collection/find':356,'lodash/collection/forEach':357}],39:[function(require,module,exports){'use strict';function createFormalExpression(parent,body,bpmnFactory){return body=body||undefined,elementHelper.createElement('bpmn:FormalExpression',{body:body},parent,bpmnFactory);}var entryFactory=require('../../../../factory/EntryFactory'),elementHelper=require('../../../../helper/ElementHelper'),cmdHelper=require('../../../../helper/CmdHelper');module.exports=function(group,element,bpmnFactory,conditionalEventDefinition){var getValue=function getValue(modelProperty){return function(element){var modelPropertyValue=conditionalEventDefinition.get('camunda:'+modelProperty);var value={};return value[modelProperty]=modelPropertyValue,value;};};var setValue=function setValue(modelProperty){return function(element,values){var props={};return props['camunda:'+modelProperty]=values[modelProperty]||undefined,cmdHelper.updateBusinessObject(element,conditionalEventDefinition,props);};};group.entries.push(entryFactory.textField({id:'condition',label:'Condition',modelProperty:'condition',get:function get(element){var condition=conditionalEventDefinition.get('condition'),body=condition&&condition.get('body');return{condition:body||''};},set:function set(element,values){var condition=conditionalEventDefinition.get('condition');return values.condition===''?cmdHelper.updateBusinessObject(element,conditionalEventDefinition,{condition:undefined}):condition?cmdHelper.updateBusinessObject(element,condition,{body:values.condition||undefined}):(condition=createFormalExpression(conditionalEventDefinition,values.condition,bpmnFactory),cmdHelper.updateBusinessObject(element,conditionalEventDefinition,{condition:condition}));},validate:function validate(element,values){return values.condition===''?{condition:'Must provide a value'}:void 0;}})),group.entries.push(entryFactory.textField({id:'variableName',label:'Variable Name',modelProperty:'variableName',get:getValue('variableName'),set:setValue('variableName')})),group.entries.push(entryFactory.textField({id:'variableEvent',label:'Variable Event',description:'Specify more than one variable change event as a comma separated list.',modelProperty:'variableEvent',get:getValue('variableEvent'),set:setValue('variableEvent')}));};},{'../../../../factory/EntryFactory':19,'../../../../helper/CmdHelper':28,'../../../../helper/ElementHelper':29}],40:[function(require,module,exports){'use strict';var entryFactory=require('../../../../factory/EntryFactory');var cmdHelper=require('../../../../helper/CmdHelper');module.exports=function(element,definition,bpmnFactory,options){var id=options.id||'element-property';var label=options.label;var referenceProperty=options.referenceProperty;var modelProperty=options.modelProperty||'name';var shouldValidate=options.shouldValidate||!1;var entry=entryFactory.textField({id:id,label:label,modelProperty:modelProperty,get:function get(element,node){var reference=definition.get(referenceProperty);var props={};return props[modelProperty]=reference&&reference.get(modelProperty),props;},set:function set(element,values,node){var reference=definition.get(referenceProperty);var props={};return props[modelProperty]=values[modelProperty]||undefined,cmdHelper.updateBusinessObject(element,reference,props);},hidden:function hidden(element,node){return!definition.get(referenceProperty);}});return shouldValidate&&(entry.validate=function(element,values,node){var reference=definition.get(referenceProperty);if(reference&&!values[modelProperty]){var validationErrors={};return validationErrors[modelProperty]='Must provide a value',validationErrors;}}),[entry];};},{'../../../../factory/EntryFactory':19,'../../../../helper/CmdHelper':28}],41:[function(require,module,exports){'use strict';var entryFactory=require('../../../../factory/EntryFactory'),cmdHelper=require('../../../../helper/CmdHelper');var eventDefinitionReference=require('./EventDefinitionReference'),elementReferenceProperty=require('./ElementReferenceProperty');module.exports=function(group,element,bpmnFactory,errorEventDefinition,showErrorCodeVariable,showErrorMessageVariable){var getValue=function getValue(modelProperty){return function(element){var modelPropertyValue=errorEventDefinition.get('camunda:'+modelProperty);var value={};return value[modelProperty]=modelPropertyValue,value;};};var setValue=function setValue(modelProperty){return function(element,values){var props={};return props['camunda:'+modelProperty]=values[modelProperty]||undefined,cmdHelper.updateBusinessObject(element,errorEventDefinition,props);};};group.entries=group.entries.concat(eventDefinitionReference(element,errorEventDefinition,bpmnFactory,{label:'Error',elementName:'error',elementType:'bpmn:Error',referenceProperty:'errorRef',newElementIdPrefix:'Error_'})),group.entries=group.entries.concat(elementReferenceProperty(element,errorEventDefinition,bpmnFactory,{id:'error-element-name',label:'Error Name',referenceProperty:'errorRef',modelProperty:'name',shouldValidate:!0})),group.entries=group.entries.concat(elementReferenceProperty(element,errorEventDefinition,bpmnFactory,{id:'error-element-code',label:'Error Code',referenceProperty:'errorRef',modelProperty:'errorCode'})),showErrorCodeVariable&&group.entries.push(entryFactory.textField({id:'errorCodeVariable',label:'Error Code Variable',modelProperty:'errorCodeVariable',get:getValue('errorCodeVariable'),set:setValue('errorCodeVariable')})),showErrorMessageVariable&&group.entries.push(entryFactory.textField({id:'errorMessageVariable',label:'Error Message Variable',modelProperty:'errorMessageVariable',get:getValue('errorMessageVariable'),set:setValue('errorMessageVariable')}));};},{'../../../../factory/EntryFactory':19,'../../../../helper/CmdHelper':28,'./ElementReferenceProperty':40,'./EventDefinitionReference':43}],42:[function(require,module,exports){'use strict';var entryFactory=require('../../../../factory/EntryFactory'),cmdHelper=require('../../../../helper/CmdHelper');var eventDefinitionReference=require('./EventDefinitionReference'),elementReferenceProperty=require('./ElementReferenceProperty');module.exports=function(group,element,bpmnFactory,escalationEventDefinition,showEscalationCodeVariable){group.entries=group.entries.concat(eventDefinitionReference(element,escalationEventDefinition,bpmnFactory,{label:'Escalation',elementName:'escalation',elementType:'bpmn:Escalation',referenceProperty:'escalationRef',newElementIdPrefix:'Escalation_'})),group.entries=group.entries.concat(elementReferenceProperty(element,escalationEventDefinition,bpmnFactory,{id:'escalation-element-name',label:'Escalation Name',referenceProperty:'escalationRef',modelProperty:'name',shouldValidate:!0})),group.entries=group.entries.concat(elementReferenceProperty(element,escalationEventDefinition,bpmnFactory,{id:'escalation-element-code',label:'Escalation Code',referenceProperty:'escalationRef',modelProperty:'escalationCode'})),showEscalationCodeVariable&&group.entries.push(entryFactory.textField({id:'escalationCodeVariable',label:'Escalation Code Variable',modelProperty:'escalationCodeVariable',get:function get(element){var codeVariable=escalationEventDefinition.get('camunda:escalationCodeVariable');return{escalationCodeVariable:codeVariable};},set:function set(element,values){return cmdHelper.updateBusinessObject(element,escalationEventDefinition,{'camunda:escalationCodeVariable':values.escalationCodeVariable||undefined});}}));};},{'../../../../factory/EntryFactory':19,'../../../../helper/CmdHelper':28,'./ElementReferenceProperty':40,'./EventDefinitionReference':43}],43:[function(require,module,exports){'use strict';function getSelectBox(node){return domQuery(selector,node.parentElement);}function findElementById(eventDefinition,type,id){var elements=utils.findRootElementsByType(eventDefinition,type);return find(elements,function(element){return element.id===id;});}var cmdHelper=require('../../../../helper/CmdHelper');var domQuery=require('min-dom/lib/query'),domify=require('min-dom/lib/domify'),domAttr=require('min-dom/lib/attr');var forEach=require('lodash/collection/forEach'),find=require('lodash/collection/find');var elementHelper=require('../../../../helper/ElementHelper');var utils=require('../../../../Utils');var selector='select[name=selectedElement]';module.exports=function(element,definition,bpmnFactory,options){var elementName=options.elementName||'',elementType=options.elementType,referenceProperty=options.referenceProperty;var newElementIdPrefix=options.newElementIdPrefix||'elem_';var label=options.label||'',description=options.description||'';var entries=[];return entries.push({id:'event-definitions-'+elementName,description:description,html:'<div class="bpp-row bpp-select">'+'<label for="camunda-'+elementName+'">'+label+'</label>'+'<div class="bpp-field-wrapper">'+'<select id="camunda-'+elementName+'" name="selectedElement" data-value>'+'</select>'+'<button class="add" id="addElement" data-action="addElement"><span>+</span></button>'+'</div>'+'</div>',get:function get(element,entryNode){utils.updateOptionsDropDown(selector,definition,elementType,entryNode);var reference=definition.get(referenceProperty);return{selectedElement:reference&&reference.id||''};},set:function set(element,values){var selection=values.selectedElement;var props={};if(!selection||selection===void 0)return props[referenceProperty]=undefined,cmdHelper.updateBusinessObject(element,definition,props);var commands=[];var selectedElement=findElementById(definition,elementType,selection);if(!selectedElement){var root=utils.getRoot(definition);selectedElement=elementHelper.createElement(elementType,{name:selection},root,bpmnFactory),commands.push(cmdHelper.addAndRemoveElementsFromList(element,root,'rootElements',null,[selectedElement]));}return props[referenceProperty]=selectedElement,commands.push(cmdHelper.updateBusinessObject(element,definition,props)),commands;},addElement:function addElement(element,inputNode){var id=utils.nextId(newElementIdPrefix);var optionTemplate=domify('<option value="'+id+'"> (id='+id+')'+'</option>');var selectBox=getSelectBox(inputNode);return selectBox.insertBefore(optionTemplate,selectBox.firstChild),forEach(selectBox,function(option){option.value===id?domAttr(option,'selected','selected'):domAttr(option,'selected',null);}),!0;}}),entries;};},{'../../../../Utils':10,'../../../../helper/CmdHelper':28,'../../../../helper/ElementHelper':29,'lodash/collection/find':356,'lodash/collection/forEach':357,'min-dom/lib/attr':50,'min-dom/lib/domify':55,'min-dom/lib/query':57}],44:[function(require,module,exports){'use strict';var eventDefinitionReference=require('./EventDefinitionReference'),elementReferenceProperty=require('./ElementReferenceProperty');module.exports=function(group,element,bpmnFactory,messageEventDefinition){group.entries=group.entries.concat(eventDefinitionReference(element,messageEventDefinition,bpmnFactory,{label:'Message',elementName:'message',elementType:'bpmn:Message',referenceProperty:'messageRef',newElementIdPrefix:'Message_'})),group.entries=group.entries.concat(elementReferenceProperty(element,messageEventDefinition,bpmnFactory,{id:'message-element-name',label:'Message Name',referenceProperty:'messageRef',modelProperty:'name',shouldValidate:!0}));};},{'./ElementReferenceProperty':40,'./EventDefinitionReference':43}],45:[function(require,module,exports){'use strict';var entryFactory=require('../../../../factory/EntryFactory');module.exports=function(element,options,translate){options=options||{};var id=options.id||'name',label=options.label||translate('Name'),modelProperty=options.modelProperty||'name';var nameEntry=entryFactory.textBox({id:id,label:label,modelProperty:modelProperty});return[nameEntry];};},{'../../../../factory/EntryFactory':19}],46:[function(require,module,exports){'use strict';var eventDefinitionReference=require('./EventDefinitionReference'),elementReferenceProperty=require('./ElementReferenceProperty');module.exports=function(group,element,bpmnFactory,signalEventDefinition){group.entries=group.entries.concat(eventDefinitionReference(element,signalEventDefinition,bpmnFactory,{label:'Signal',elementName:'signal',elementType:'bpmn:Signal',referenceProperty:'signalRef',newElementIdPrefix:'Signal_'})),group.entries=group.entries.concat(elementReferenceProperty(element,signalEventDefinition,bpmnFactory,{id:'signal-element-name',label:'Signal Name',referenceProperty:'signalRef',modelProperty:'name',shouldValidate:!0}));};},{'./ElementReferenceProperty':40,'./EventDefinitionReference':43}],47:[function(require,module,exports){'use strict';function getTimerDefinitionType(timer){var timeDate=timer.get('timeDate');if(timeDate!==void 0)return'timeDate';var timeCycle=timer.get('timeCycle');if(timeCycle!==void 0)return'timeCycle';var timeDuration=timer.get('timeDuration');return timeDuration!==void 0?'timeDuration':void 0;}function createFormalExpression(parent,body,bpmnFactory){return body=body||undefined,elementHelper.createElement('bpmn:FormalExpression',{body:body},parent,bpmnFactory);}function TimerEventDefinition(group,element,bpmnFactory,timerEventDefinition){var selectOptions=[{value:'timeDate',name:'Date'},{value:'timeDuration',name:'Duration'},{value:'timeCycle',name:'Cycle'}];group.entries.push(entryFactory.selectBox({id:'timer-event-definition-type',label:'Timer Definition Type',selectOptions:selectOptions,emptyParameter:!0,modelProperty:'timerDefinitionType',get:function get(element,node){return{timerDefinitionType:getTimerDefinitionType(timerEventDefinition)||''};},set:function set(element,values){var props={timeDuration:undefined,timeDate:undefined,timeCycle:undefined};var newType=values.timerDefinitionType;if(values.timerDefinitionType){var oldType=getTimerDefinitionType(timerEventDefinition);var value;if(oldType){var definition=timerEventDefinition.get(oldType);value=definition.get('body');}props[newType]=createFormalExpression(timerEventDefinition,value,bpmnFactory);}return cmdHelper.updateBusinessObject(element,timerEventDefinition,props);}})),group.entries.push(entryFactory.textField({id:'timer-event-definition',label:'Timer Definition',modelProperty:'timerDefinition',get:function get(element,node){var type=getTimerDefinitionType(timerEventDefinition);var definition=type&&timerEventDefinition.get(type);var value=definition&&definition.get('body');return{timerDefinition:value};},set:function set(element,values){var type=getTimerDefinitionType(timerEventDefinition);var definition=type&&timerEventDefinition.get(type);return definition?cmdHelper.updateBusinessObject(element,definition,{body:values.timerDefinition||undefined}):void 0;},validate:function validate(element){var type=getTimerDefinitionType(timerEventDefinition);var definition=type&&timerEventDefinition.get(type);if(definition){var value=definition.get('body');if(!value)return{timerDefinition:'Must provide a value'};}},hidden:function hidden(element){return!getTimerDefinitionType(timerEventDefinition);}}));}var elementHelper=require('../../../../helper/ElementHelper'),cmdHelper=require('../../../../helper/CmdHelper');var entryFactory=require('../../../../factory/EntryFactory');module.exports=TimerEventDefinition;},{'../../../../factory/EntryFactory':19,'../../../../helper/CmdHelper':28,'../../../../helper/ElementHelper':29}],48:[function(require,module,exports){'use strict';function isConditionalSource(element){return isAny(element,CONDITIONAL_SOURCES);}var is=require('bpmn-js/lib/util/ModelUtil').is,isAny=require('bpmn-js/lib/features/modeling/util/ModelingUtil').isAny,getBusinessObject=require('bpmn-js/lib/util/ModelUtil').getBusinessObject,domQuery=require('min-dom/lib/query'),cmdHelper=require('../../../helper/CmdHelper'),elementHelper=require('../../../helper/ElementHelper'),script=require('./implementation/Script')('language','body',!0);module.exports=function(group,element,bpmnFactory,translate){var bo;if(is(element,'bpmn:SequenceFlow')&&(bo=getBusinessObject(element)),!bo)return;if(!isConditionalSource(element.source))return;group.entries.push({id:'condition',label:translate('Condition'),html:'<div class="bpp-row">'+'<label for="cam-condition-type">'+translate('Condition Type')+'</label>'+'<div class="bpp-field-wrapper">'+'<select id="cam-condition-type" name="conditionType" data-value>'+'<option value="expression">'+translate('Expression')+'</option>'+'<option value="script">'+translate('Script')+'</option>'+'<option value="" selected></option>'+'</select>'+'</div>'+'</div>'+'<div class="bpp-row">'+'<label for="cam-condition" data-show="isExpression">'+translate('Expression')+'</label>'+'<div class="bpp-field-wrapper" data-show="isExpression">'+'<input id="cam-condition" type="text" name="condition" />'+'<button class="clear" data-action="clear" data-show="canClear">'+'<span>X</span>'+'</button>'+'</div>'+'<div data-show="isScript">'+script.template+'</div>'+'</div>',get:function get(element,propertyName){var conditionExpression=bo.conditionExpression;var values={},conditionType='';if(conditionExpression){var conditionLanguage=conditionExpression.language;conditionLanguage!==void 0?(conditionType='script',values=script.get(element,conditionExpression)):(conditionType='expression',values.condition=conditionExpression.get('body'));}return values.conditionType=conditionType,values;},set:function set(element,values,containerElement){var conditionType=values.conditionType;var commands=[];var conditionProps={body:undefined};if(conditionType==='script')conditionProps=script.set(element,values,containerElement);else{var condition=values.condition;conditionProps.body=condition;}var update={conditionExpression:undefined};if(conditionType){update.conditionExpression=elementHelper.createElement('bpmn:FormalExpression',conditionProps,bo,bpmnFactory);var source=element.source;source.businessObject.default===bo&&commands.push(cmdHelper.updateProperties(source,{'default':undefined}));}return commands.push(cmdHelper.updateBusinessObject(element,bo,update)),commands;},validate:function validate(element,values){var validationResult={};return!values.condition&&values.conditionType==='expression'?validationResult.condition='Must provide a value':values.conditionType==='script'&&(validationResult=script.validate(element,values)),validationResult;},isExpression:function isExpression(element,inputNode){var conditionType=domQuery('select[name=conditionType]',inputNode);return conditionType.selectedIndex>=0?conditionType.options[conditionType.selectedIndex].value==='expression':void 0;},isScript:function isScript(element,inputNode){var conditionType=domQuery('select[name=conditionType]',inputNode);return conditionType.selectedIndex>=0?conditionType.options[conditionType.selectedIndex].value==='script':void 0;},clear:function clear(element,inputNode){return domQuery('input[name=condition]',inputNode).value='',!0;},canClear:function canClear(element,inputNode){var input=domQuery('input[name=condition]',inputNode);return input.value!=='';},script:script,cssClasses:['bpp-textfield']});};var CONDITIONAL_SOURCES=['bpmn:Activity','bpmn:ExclusiveGateway','bpmn:InclusiveGateway','bpmn:ComplexGateway'];},{'../../../helper/CmdHelper':28,'../../../helper/ElementHelper':29,'./implementation/Script':49,'bpmn-js/lib/features/modeling/util/ModelingUtil':132,'bpmn-js/lib/util/ModelUtil':159,'min-dom/lib/query':57}],49:[function(require,module,exports){'use strict';function getScriptType(node){return utils.selectedType('select[name=scriptType]',node.parentElement);}var domQuery=require('min-dom/lib/query'),utils=require('../../../../Utils');module.exports=function(scriptLanguagePropName,scriptValuePropName,isFormatRequired){return{template:'<div class="bpp-row bpp-textfield">'+'<label for="cam-script-format">Script Format</label>'+'<div class="bpp-field-wrapper">'+'<input id="cam-script-format" type="text" name="scriptFormat" />'+'<button class="clear" data-action="script.clearScriptFormat" data-show="script.canClearScriptFormat">'+'<span>X</span>'+'</button>'+'</div>'+'</div>'+'<div class="bpp-row">'+'<label for="cam-script-type">Script Type</label>'+'<div class="bpp-field-wrapper">'+'<select id="cam-script-type" name="scriptType" data-value>'+'<option value="script" selected>Inline Script</option>'+'<option value="scriptResource">External Resource</option>'+'</select>'+'</div>'+'</div>'+'<div class="bpp-row bpp-textfield">'+'<label for="cam-script-resource-val" data-show="script.isScriptResource">Resource</label>'+'<div class="bpp-field-wrapper" data-show="script.isScriptResource">'+'<input id="cam-script-resource-val" type="text" name="scriptResourceValue" />'+'<button class="clear" data-action="script.clearScriptResource" data-show="script.canClearScriptResource">'+'<span>X</span>'+'</button>'+'</div>'+'</div>'+'<div class="bpp-row">'+'<label for="cam-script-val" data-show="script.isScript">Script</label>'+'<div class="bpp-field-wrapper" data-show="script.isScript">'+'<textarea id="cam-script-val" type="text" name="scriptValue"></textarea>'+'</div>'+'</div>',get:function get(element,bo){var values={};var boScriptResource=bo.get('camunda:resource'),boScript=bo.get(scriptValuePropName),boScriptFormat=bo.get(scriptLanguagePropName);return boScriptResource!==void 0?(values.scriptResourceValue=boScriptResource,values.scriptType='scriptResource'):(values.scriptValue=boScript,values.scriptType='script'),values.scriptFormat=boScriptFormat,values;},set:function set(element,values,containerElement){var scriptFormat=values.scriptFormat,scriptType=values.scriptType,scriptResourceValue=values.scriptResourceValue,scriptValue=values.scriptValue;var update={'camunda:resource':undefined};return update[scriptValuePropName]=undefined,update[scriptLanguagePropName]=undefined,isFormatRequired?update[scriptLanguagePropName]=scriptFormat||'':scriptFormat!==''&&(update[scriptLanguagePropName]=scriptFormat),'scriptResource'===scriptType?update['camunda:resource']=scriptResourceValue||'':update[scriptValuePropName]=scriptValue||'',update;},validate:function validate(element,values){var validationResult={};return values.scriptType==='script'&&!values.scriptValue&&(validationResult.scriptValue='Must provide a value'),values.scriptType==='scriptResource'&&!values.scriptResourceValue&&(validationResult.scriptResourceValue='Must provide a value'),isFormatRequired&&(!values.scriptFormat||values.scriptFormat.length===0)&&(validationResult.scriptFormat='Must provide a value'),validationResult;},clearScriptFormat:function clearScriptFormat(element,inputNode,btnNode,scopeNode){return domQuery('input[name=scriptFormat]',scopeNode).value='',!0;},canClearScriptFormat:function canClearScriptFormat(element,inputNode,btnNode,scopeNode){var input=domQuery('input[name=scriptFormat]',scopeNode);return input.value!=='';},clearScriptResource:function clearScriptResource(element,inputNode,btnNode,scopeNode){return domQuery('input[name=scriptResourceValue]',scopeNode).value='',!0;},canClearScriptResource:function canClearScriptResource(element,inputNode,btnNode,scopeNode){var input=domQuery('input[name=scriptResourceValue]',scopeNode);return input.value!=='';},clearScript:function clearScript(element,inputNode,btnNode,scopeNode){return domQuery('textarea[name=scriptValue]',scopeNode).value='',!0;},canClearScript:function canClearScript(element,inputNode,btnNode,scopeNode){var input=domQuery('textarea[name=scriptValue]',scopeNode);return input.value!=='';},isScriptResource:function isScriptResource(element,inputNode,btnNode,scopeNode){var scriptType=getScriptType(scopeNode);return scriptType==='scriptResource';},isScript:function isScript(element,inputNode,btnNode,scopeNode){var scriptType=getScriptType(scopeNode);return scriptType==='script';}};};},{'../../../../Utils':10,'min-dom/lib/query':57}],50:[function(require,module,exports){'use strict';module.exports=function(el,name,val){return arguments.length==2?el.getAttribute(name):val===null?el.removeAttribute(name):(el.setAttribute(name,val),el);};},{}],51:[function(require,module,exports){'use strict';module.exports=require('component-classes');},{'component-classes':172}],52:[function(require,module,exports){'use strict';module.exports=function(el){var c;while(el.childNodes.length)c=el.childNodes[0],el.removeChild(c);return el;};},{}],53:[function(require,module,exports){'use strict';module.exports=require('component-closest');},{'component-closest':173}],54:[function(require,module,exports){'use strict';module.exports=require('component-delegate');},{'component-delegate':174}],55:[function(require,module,exports){'use strict';module.exports=require('domify');},{domify:346}],56:[function(require,module,exports){'use strict';module.exports=require('component-matches-selector');},{'component-matches-selector':177}],57:[function(require,module,exports){'use strict';module.exports=require('component-query');},{'component-query':178}],58:[function(require,module,exports){'use strict';module.exports=function(el){el.parentNode&&el.parentNode.removeChild(el);};},{}],59:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function Modeler(options){_Viewer2.default.call(this,options),this.on('import.parse.complete',function(event){event.error||this._collectIds(event.definitions,event.context);},this),this.on('diagram.destroy',function(){this.get('moddle').ids.clear();},this);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=Modeler;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _ids=require('ids');var _ids2=_interopRequireDefault(_ids);var _Viewer=require('./Viewer');var _Viewer2=_interopRequireDefault(_Viewer);var _NavigatedViewer=require('./NavigatedViewer');var _NavigatedViewer2=_interopRequireDefault(_NavigatedViewer);var _movecanvas=require('diagram-js/lib/navigation/movecanvas');var _movecanvas2=_interopRequireDefault(_movecanvas);var _touch=require('diagram-js/lib/navigation/touch');var _touch2=_interopRequireDefault(_touch);var _zoomscroll=require('diagram-js/lib/navigation/zoomscroll');var _zoomscroll2=_interopRequireDefault(_zoomscroll);var _autoScroll=require('diagram-js/lib/features/auto-scroll');var _autoScroll2=_interopRequireDefault(_autoScroll);var _bendpoints=require('diagram-js/lib/features/bendpoints');var _bendpoints2=_interopRequireDefault(_bendpoints);var _move=require('diagram-js/lib/features/move');var _move2=_interopRequireDefault(_move);var _resize=require('diagram-js/lib/features/resize');var _resize2=_interopRequireDefault(_resize);var _autoResize=require('./features/auto-resize');var _autoResize2=_interopRequireDefault(_autoResize);var _autoPlace=require('./features/auto-place');var _autoPlace2=_interopRequireDefault(_autoPlace);var _editorActions=require('./features/editor-actions');var _editorActions2=_interopRequireDefault(_editorActions);var _contextPad=require('./features/context-pad');var _contextPad2=_interopRequireDefault(_contextPad);var _keyboard=require('./features/keyboard');var _keyboard2=_interopRequireDefault(_keyboard);var _labelEditing=require('./features/label-editing');var _labelEditing2=_interopRequireDefault(_labelEditing);var _modeling=require('./features/modeling');var _modeling2=_interopRequireDefault(_modeling);var _palette=require('./features/palette');var _palette2=_interopRequireDefault(_palette);var _replacePreview=require('./features/replace-preview');var _replacePreview2=_interopRequireDefault(_replacePreview);var _snapping=require('./features/snapping');var _snapping2=_interopRequireDefault(_snapping);var initialDiagram='<?xml version="1.0" encoding="UTF-8"?>'+'<bpmn:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" '+'xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" '+'xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" '+'xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" '+'targetNamespace="http://bpmn.io/schema/bpmn" '+'id="Definitions_1">'+'<bpmn:process id="Process_1" isExecutable="false">'+'<bpmn:startEvent id="StartEvent_1"/>'+'</bpmn:process>'+'<bpmndi:BPMNDiagram id="BPMNDiagram_1">'+'<bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1">'+'<bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1">'+'<dc:Bounds height="36.0" width="36.0" x="173.0" y="102.0"/>'+'</bpmndi:BPMNShape>'+'</bpmndi:BPMNPlane>'+'</bpmndi:BPMNDiagram>'+'</bpmn:definitions>';(0,_inherits2.default)(Modeler,_Viewer2.default),Modeler.Viewer=_Viewer2.default,Modeler.NavigatedViewer=_NavigatedViewer2.default,Modeler.prototype.createDiagram=function(done){return this.importXML(initialDiagram,done);},Modeler.prototype._createModdle=function(options){var moddle=_Viewer2.default.prototype._createModdle.call(this,options);return moddle.ids=new _ids2.default([32,36,1]),moddle;},Modeler.prototype._collectIds=function(definitions,context){var moddle=definitions.$model,ids=moddle.ids,id;ids.clear();for(id in context.elementsById)ids.claim(id,context.elementsById[id]);},Modeler.prototype._interactionModules=[_movecanvas2.default,_touch2.default,_zoomscroll2.default],Modeler.prototype._modelingModules=[_autoScroll2.default,_bendpoints2.default,_move2.default,_resize2.default,_autoResize2.default,_autoPlace2.default,_editorActions2.default,_contextPad2.default,_keyboard2.default,_labelEditing2.default,_modeling2.default,_palette2.default,_replacePreview2.default,_snapping2.default],Modeler.prototype._modules=[].concat(Modeler.prototype._modules,Modeler.prototype._interactionModules,Modeler.prototype._modelingModules);},{'./NavigatedViewer':60,'./Viewer':61,'./features/auto-place':70,'./features/auto-resize':73,'./features/context-pad':75,'./features/editor-actions':81,'./features/keyboard':85,'./features/label-editing':90,'./features/modeling':130,'./features/palette':136,'./features/replace-preview':141,'./features/snapping':151,'diagram-js/lib/features/auto-scroll':205,'diagram-js/lib/features/bendpoints':211,'diagram-js/lib/features/move':271,'diagram-js/lib/features/resize':289,'diagram-js/lib/navigation/movecanvas':321,'diagram-js/lib/navigation/touch':322,'diagram-js/lib/navigation/zoomscroll':325,ids:349,inherits:350}],60:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function NavigatedViewer(options){_Viewer2.default.call(this,options);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=NavigatedViewer;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _Viewer=require('./Viewer');var _Viewer2=_interopRequireDefault(_Viewer);var _movecanvas=require('diagram-js/lib/navigation/movecanvas');var _movecanvas2=_interopRequireDefault(_movecanvas);var _zoomscroll=require('diagram-js/lib/navigation/zoomscroll');var _zoomscroll2=_interopRequireDefault(_zoomscroll);(0,_inherits2.default)(NavigatedViewer,_Viewer2.default),NavigatedViewer.prototype._navigationModules=[_movecanvas2.default,_zoomscroll2.default],NavigatedViewer.prototype._modules=[].concat(NavigatedViewer.prototype._modules,NavigatedViewer.prototype._navigationModules);},{'./Viewer':61,'diagram-js/lib/navigation/movecanvas':321,'diagram-js/lib/navigation/zoomscroll':325,inherits:350}],61:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function checkValidationError(err){var pattern=/unparsable content <([^>]+)> detected([\s\S]*)$/;var match=pattern.exec(err.message);return match&&(err.message='unparsable content <'+match[1]+'> detected; '+'this may indicate an invalid BPMN 2.0 diagram file'+match[2]),err;}function ensureUnit(val){return val+((0,_minDash.isNumber)(val)?'px':'');}function Viewer(options){options=(0,_minDash.assign)({},DEFAULT_OPTIONS,options),this._moddle=this._createModdle(options),this._container=this._createContainer(options),addProjectLogo(this._container),this._init(this._container,this._moddle,options);}function addProjectLogo(container){var img=_PoweredByUtil.BPMNIO_IMG;var linkMarkup='<a href="http://bpmn.io" '+'target="_blank" '+'class="bjs-powered-by" '+'title="Powered by bpmn.io" '+'style="position: absolute; bottom: 15px; right: 15px; z-index: 100">'+img+'</a>';var linkElement=(0,_minDom.domify)(linkMarkup);container.appendChild(linkElement),_minDom.event.bind(linkElement,'click',function(event){(0,_PoweredByUtil.open)(),event.preventDefault();});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=Viewer;var _minDash=require('min-dash');var _minDom=require('min-dom');var _tinySvg=require('tiny-svg');var _diagramJs=require('diagram-js');var _diagramJs2=_interopRequireDefault(_diagramJs);var _bpmnModdle=require('bpmn-moddle');var _bpmnModdle2=_interopRequireDefault(_bpmnModdle);var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _Importer=require('./import/Importer');var _core=require('./core');var _core2=_interopRequireDefault(_core);var _translate=require('diagram-js/lib/i18n/translate');var _translate2=_interopRequireDefault(_translate);var _selection=require('diagram-js/lib/features/selection');var _selection2=_interopRequireDefault(_selection);var _overlays=require('diagram-js/lib/features/overlays');var _overlays2=_interopRequireDefault(_overlays);var _PoweredByUtil=require('./util/PoweredByUtil');var DEFAULT_OPTIONS={width:'100%',height:'100%',position:'relative'};(0,_inherits2.default)(Viewer,_diagramJs2.default),Viewer.prototype.importXML=function(xml,done){done=done||function(){};var self=this;xml=this._emit('import.parse.start',{xml:xml})||xml,this._moddle.fromXML(xml,'bpmn:Definitions',function(err,definitions,context){definitions=self._emit('import.parse.complete',{error:err,definitions:definitions,context:context})||definitions;var parseWarnings=context.warnings;if(err)return err=checkValidationError(err),self._emit('import.done',{error:err,warnings:parseWarnings}),done(err,parseWarnings);self.importDefinitions(definitions,function(err,importWarnings){var allWarnings=[].concat(parseWarnings,importWarnings||[]);self._emit('import.done',{error:err,warnings:allWarnings}),done(err,allWarnings);});});},Viewer.prototype.saveXML=function(options,done){done||(done=options,options={});var definitions=this._definitions;if(!definitions)return done(new Error('no definitions loaded'));this._moddle.toXML(definitions,options,done);},Viewer.prototype.saveSVG=function(options,done){done||(done=options,options={});var svg,err;try{var canvas=this.get('canvas');var contentNode=canvas.getDefaultLayer(),defsNode=(0,_minDom.query)('defs',canvas._svg);var contents=(0,_tinySvg.innerSVG)(contentNode),defs=defsNode?'<defs>'+(0,_tinySvg.innerSVG)(defsNode)+'</defs>':'';var bbox=contentNode.getBBox();svg='<?xml version="1.0" encoding="utf-8"?>\n'+'<!-- created with bpmn-js / http://bpmn.io -->\n'+'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n'+'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" '+'width="'+bbox.width+'" height="'+bbox.height+'" '+'viewBox="'+bbox.x+' '+bbox.y+' '+bbox.width+' '+bbox.height+'" version="1.1">'+defs+contents+'</svg>';}catch(e){err=e;}done(err,svg);},Viewer.prototype.importDefinitions=function(definitions,done){try{this._definitions&&this.clear(),this._definitions=definitions;}catch(e){return done(e);}return(0,_Importer.importBpmnDiagram)(this,definitions,done);},Viewer.prototype.getModules=function(){return this._modules;},Viewer.prototype.destroy=function(){_diagramJs2.default.prototype.destroy.call(this),(0,_minDom.remove)(this._container);},Viewer.prototype.on=function(event,priority,callback,target){return this.get('eventBus').on(event,priority,callback,target);},Viewer.prototype.off=function(event,callback){this.get('eventBus').off(event,callback);},Viewer.prototype.attachTo=function(parentNode){if(!parentNode)throw new Error('parentNode required');this.detach(),parentNode.get&&parentNode.constructor.prototype.jquery&&(parentNode=parentNode.get(0)),typeof parentNode==='string'&&(parentNode=(0,_minDom.query)(parentNode)),parentNode.appendChild(this._container),this._emit('attach',{}),this.get('canvas').resized();},Viewer.prototype.getDefinitions=function(){return this._definitions;},Viewer.prototype.detach=function(){var container=this._container,parentNode=container.parentNode;if(!parentNode)return;this._emit('detach',{}),parentNode.removeChild(container);},Viewer.prototype._init=function(container,moddle,options){var baseModules=options.modules||this.getModules(),additionalModules=options.additionalModules||[],staticModules=[{bpmnjs:['value',this],moddle:['value',moddle]}];var diagramModules=[].concat(staticModules,baseModules,additionalModules);var diagramOptions=(0,_minDash.assign)((0,_minDash.omit)(options,['additionalModules']),{canvas:(0,_minDash.assign)({},options.canvas,{container:container}),modules:diagramModules});_diagramJs2.default.call(this,diagramOptions),options&&options.container&&this.attachTo(options.container);},Viewer.prototype._emit=function(type,event){return this.get('eventBus').fire(type,event);},Viewer.prototype._createContainer=function(options){var container=(0,_minDom.domify)('<div class="bjs-container"></div>');return(0,_minDash.assign)(container.style,{width:ensureUnit(options.width),height:ensureUnit(options.height),position:options.position}),container;},Viewer.prototype._createModdle=function(options){var moddleOptions=(0,_minDash.assign)({},this._moddleExtensions,options.moddleExtensions);return new _bpmnModdle2.default(moddleOptions);},Viewer.prototype._modules=[_core2.default,_translate2.default,_selection2.default,_overlays2.default],Viewer.prototype._moddleExtensions={};},{'./core':62,'./import/Importer':154,'./util/PoweredByUtil':160,'bpmn-moddle':163,'diagram-js':183,'diagram-js/lib/features/overlays':276,'diagram-js/lib/features/selection':298,'diagram-js/lib/i18n/translate':313,inherits:350,'min-dash':438,'min-dom':439,'tiny-svg':468}],62:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _draw=require('../draw');var _draw2=_interopRequireDefault(_draw);var _import=require('../import');var _import2=_interopRequireDefault(_import);exports.default={__depends__:[_draw2.default,_import2.default]};},{'../draw':66,'../import':156}],63:[function(require,module,exports){'use strict';function isTypedEvent(event,eventDefinitionType,filter){function matches(definition,filter){return(0,_minDash.every)(filter,function(val,key){return definition[key]==val;});}return(0,_minDash.some)(event.eventDefinitions,function(definition){return definition.$type===eventDefinitionType&&matches(event,filter);});}function isThrowEvent(event){return event.$type==='bpmn:IntermediateThrowEvent'||event.$type==='bpmn:EndEvent';}function isCollection(element){var dataObject=element.dataObjectRef;return element.isCollection||dataObject&&dataObject.isCollection;}function getDi(element){return element.businessObject.di;}function getSemantic(element){return element.businessObject;}function getFillColor(element,defaultColor){return getDi(element).get('bioc:fill')||defaultColor||'white';}function getStrokeColor(element,defaultColor){return getDi(element).get('bioc:stroke')||defaultColor||'black';}function getCirclePath(shape){var cx=shape.x+shape.width/2,cy=shape.y+shape.height/2,radius=shape.width/2;var circlePath=[['M',cx,cy],['m',0,-radius],['a',radius,radius,0,1,1,0,2*radius],['a',radius,radius,0,1,1,0,-2*radius],['z']];return(0,_RenderUtil.componentsToPath)(circlePath);}function getRoundRectPath(shape,borderRadius){var x=shape.x,y=shape.y,width=shape.width,height=shape.height;var roundRectPath=[['M',x+borderRadius,y],['l',width-borderRadius*2,0],['a',borderRadius,borderRadius,0,0,1,borderRadius,borderRadius],['l',0,height-borderRadius*2],['a',borderRadius,borderRadius,0,0,1,-borderRadius,borderRadius],['l',borderRadius*2-width,0],['a',borderRadius,borderRadius,0,0,1,-borderRadius,-borderRadius],['l',0,borderRadius*2-height],['a',borderRadius,borderRadius,0,0,1,borderRadius,-borderRadius],['z']];return(0,_RenderUtil.componentsToPath)(roundRectPath);}function getDiamondPath(shape){var width=shape.width,height=shape.height,x=shape.x,y=shape.y,halfWidth=width/2,halfHeight=height/2;var diamondPath=[['M',x+halfWidth,y],['l',halfWidth,halfHeight],['l',-halfWidth,halfHeight],['l',-halfWidth,-halfHeight],['z']];return(0,_RenderUtil.componentsToPath)(diamondPath);}function getRectPath(shape){var x=shape.x,y=shape.y,width=shape.width,height=shape.height;var rectPath=[['M',x,y],['l',width,0],['l',0,height],['l',-width,0],['z']];return(0,_RenderUtil.componentsToPath)(rectPath);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.isTypedEvent=isTypedEvent,exports.isThrowEvent=isThrowEvent,exports.isCollection=isCollection,exports.getDi=getDi,exports.getSemantic=getSemantic,exports.getFillColor=getFillColor,exports.getStrokeColor=getStrokeColor,exports.getCirclePath=getCirclePath,exports.getRoundRectPath=getRoundRectPath,exports.getDiamondPath=getDiamondPath,exports.getRectPath=getRectPath;var _minDash=require('min-dash');var _RenderUtil=require('diagram-js/lib/util/RenderUtil');},{'diagram-js/lib/util/RenderUtil':342,'min-dash':438}],64:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function BpmnRenderer(eventBus,styles,pathMap,canvas,priority){function addMarker(id,options){var attrs=(0,_minDash.assign)({fill:'black',strokeWidth:1,strokeLinecap:'round',strokeDasharray:'none'},options.attrs);var ref=options.ref||{x:0,y:0};var scale=options.scale||1;attrs.strokeDasharray==='none'&&(attrs.strokeDasharray=[10000,1]);var marker=(0,_tinySvg.create)('marker');(0,_tinySvg.attr)(options.element,attrs),(0,_tinySvg.append)(marker,options.element),(0,_tinySvg.attr)(marker,{id:id,viewBox:'0 0 20 20',refX:ref.x,refY:ref.y,markerWidth:20*scale,markerHeight:20*scale,orient:'auto'});var defs=(0,_minDom.query)('defs',canvas._svg);defs||(defs=(0,_tinySvg.create)('defs'),(0,_tinySvg.append)(canvas._svg,defs)),(0,_tinySvg.append)(defs,marker),markers[id]=marker;}function marker(type,fill,stroke){var id=type+'-'+fill+'-'+stroke+'-'+rendererId;return markers[id]||createMarker(type,fill,stroke),'url(#'+id+')';}function createMarker(type,fill,stroke){var id=type+'-'+fill+'-'+stroke+'-'+rendererId;if(type==='sequenceflow-end'){var sequenceflowEnd=(0,_tinySvg.create)('path');(0,_tinySvg.attr)(sequenceflowEnd,{d:'M 1 5 L 11 10 L 1 15 Z'}),addMarker(id,{element:sequenceflowEnd,ref:{x:11,y:10},scale:0.5,attrs:{fill:stroke,stroke:stroke}});}if(type==='messageflow-start'){var messageflowStart=(0,_tinySvg.create)('circle');(0,_tinySvg.attr)(messageflowStart,{cx:6,cy:6,r:3.5}),addMarker(id,{element:messageflowStart,attrs:{fill:fill,stroke:stroke},ref:{x:6,y:6}});}if(type==='messageflow-end'){var messageflowEnd=(0,_tinySvg.create)('path');(0,_tinySvg.attr)(messageflowEnd,{d:'m 1 5 l 0 -3 l 7 3 l -7 3 z'}),addMarker(id,{element:messageflowEnd,attrs:{fill:fill,stroke:stroke,strokeLinecap:'butt'},ref:{x:8.5,y:5}});}if(type==='association-start'){var associationStart=(0,_tinySvg.create)('path');(0,_tinySvg.attr)(associationStart,{d:'M 11 5 L 1 10 L 11 15'}),addMarker(id,{element:associationStart,attrs:{fill:'none',stroke:stroke,strokeWidth:1.5},ref:{x:1,y:10},scale:0.5});}if(type==='association-end'){var associationEnd=(0,_tinySvg.create)('path');(0,_tinySvg.attr)(associationEnd,{d:'M 1 5 L 11 10 L 1 15'}),addMarker(id,{element:associationEnd,attrs:{fill:'none',stroke:stroke,strokeWidth:1.5},ref:{x:12,y:10},scale:0.5});}if(type==='conditional-flow-marker'){var conditionalflowMarker=(0,_tinySvg.create)('path');(0,_tinySvg.attr)(conditionalflowMarker,{d:'M 0 10 L 8 6 L 16 10 L 8 14 Z'}),addMarker(id,{element:conditionalflowMarker,attrs:{fill:fill,stroke:stroke},ref:{x:-1,y:10},scale:0.5});}if(type==='conditional-default-flow-marker'){var conditionaldefaultflowMarker=(0,_tinySvg.create)('path');(0,_tinySvg.attr)(conditionaldefaultflowMarker,{d:'M 6 4 L 10 16'}),addMarker(id,{element:conditionaldefaultflowMarker,attrs:{stroke:stroke},ref:{x:0,y:10},scale:0.5});}}function drawCircle(parentGfx,width,height,offset,attrs){(0,_minDash.isObject)(offset)&&(attrs=offset,offset=0),offset=offset||0,attrs=computeStyle(attrs,{stroke:'black',strokeWidth:2,fill:'white'}),attrs.fill==='none'&&delete attrs.fillOpacity;var cx=width/2,cy=height/2;var circle=(0,_tinySvg.create)('circle');return(0,_tinySvg.attr)(circle,{cx:cx,cy:cy,r:Math.round((width+height)/4-offset)}),(0,_tinySvg.attr)(circle,attrs),(0,_tinySvg.append)(parentGfx,circle),circle;}function drawRect(parentGfx,width,height,r,offset,attrs){(0,_minDash.isObject)(offset)&&(attrs=offset,offset=0),offset=offset||0,attrs=computeStyle(attrs,{stroke:'black',strokeWidth:2,fill:'white'});var rect=(0,_tinySvg.create)('rect');return(0,_tinySvg.attr)(rect,{x:offset,y:offset,width:width-offset*2,height:height-offset*2,rx:r,ry:r}),(0,_tinySvg.attr)(rect,attrs),(0,_tinySvg.append)(parentGfx,rect),rect;}function drawDiamond(parentGfx,width,height,attrs){var x_2=width/2;var y_2=height/2;var points=[{x:x_2,y:0},{x:width,y:y_2},{x:x_2,y:height},{x:0,y:y_2}];var pointsString=points.map(function(point){return point.x+','+point.y;}).join(' ');attrs=computeStyle(attrs,{stroke:'black',strokeWidth:2,fill:'white'});var polygon=(0,_tinySvg.create)('polygon');return(0,_tinySvg.attr)(polygon,{points:pointsString}),(0,_tinySvg.attr)(polygon,attrs),(0,_tinySvg.append)(parentGfx,polygon),polygon;}function drawLine(parentGfx,waypoints,attrs){attrs=computeStyle(attrs,['no-fill'],{stroke:'black',strokeWidth:2,fill:'none'});var line=(0,_RenderUtil.createLine)(waypoints,attrs);return(0,_tinySvg.append)(parentGfx,line),line;}function drawPath(parentGfx,d,attrs){attrs=computeStyle(attrs,['no-fill'],{strokeWidth:2,stroke:'black'});var path=(0,_tinySvg.create)('path');return(0,_tinySvg.attr)(path,{d:d}),(0,_tinySvg.attr)(path,attrs),(0,_tinySvg.append)(parentGfx,path),path;}function drawMarker(type,parentGfx,path,attrs){return drawPath(parentGfx,path,(0,_minDash.assign)({'data-marker':type},attrs));}function as(type){return function(parentGfx,element){return handlers[type](parentGfx,element);};}function renderer(type){return handlers[type];}function renderEventContent(element,parentGfx){var event=(0,_BpmnRenderUtil.getSemantic)(element);var isThrowing=(0,_BpmnRenderUtil.isThrowEvent)(event);return(0,_BpmnRenderUtil.isTypedEvent)(event,'bpmn:MessageEventDefinition')?renderer('bpmn:MessageEventDefinition')(parentGfx,element,isThrowing):(0,_BpmnRenderUtil.isTypedEvent)(event,'bpmn:TimerEventDefinition')?renderer('bpmn:TimerEventDefinition')(parentGfx,element,isThrowing):(0,_BpmnRenderUtil.isTypedEvent)(event,'bpmn:ConditionalEventDefinition')?renderer('bpmn:ConditionalEventDefinition')(parentGfx,element):(0,_BpmnRenderUtil.isTypedEvent)(event,'bpmn:SignalEventDefinition')?renderer('bpmn:SignalEventDefinition')(parentGfx,element,isThrowing):(0,_BpmnRenderUtil.isTypedEvent)(event,'bpmn:CancelEventDefinition')&&(0,_BpmnRenderUtil.isTypedEvent)(event,'bpmn:TerminateEventDefinition',{parallelMultiple:!1})?renderer('bpmn:MultipleEventDefinition')(parentGfx,element,isThrowing):(0,_BpmnRenderUtil.isTypedEvent)(event,'bpmn:CancelEventDefinition')&&(0,_BpmnRenderUtil.isTypedEvent)(event,'bpmn:TerminateEventDefinition',{parallelMultiple:!0})?renderer('bpmn:ParallelMultipleEventDefinition')(parentGfx,element,isThrowing):(0,_BpmnRenderUtil.isTypedEvent)(event,'bpmn:EscalationEventDefinition')?renderer('bpmn:EscalationEventDefinition')(parentGfx,element,isThrowing):(0,_BpmnRenderUtil.isTypedEvent)(event,'bpmn:LinkEventDefinition')?renderer('bpmn:LinkEventDefinition')(parentGfx,element,isThrowing):(0,_BpmnRenderUtil.isTypedEvent)(event,'bpmn:ErrorEventDefinition')?renderer('bpmn:ErrorEventDefinition')(parentGfx,element,isThrowing):(0,_BpmnRenderUtil.isTypedEvent)(event,'bpmn:CancelEventDefinition')?renderer('bpmn:CancelEventDefinition')(parentGfx,element,isThrowing):(0,_BpmnRenderUtil.isTypedEvent)(event,'bpmn:CompensateEventDefinition')?renderer('bpmn:CompensateEventDefinition')(parentGfx,element,isThrowing):(0,_BpmnRenderUtil.isTypedEvent)(event,'bpmn:TerminateEventDefinition')?renderer('bpmn:TerminateEventDefinition')(parentGfx,element,isThrowing):null;}function renderLabel(parentGfx,label,options){var text=textUtil.createText(label||'',options);return(0,_tinySvg.classes)(text).add('djs-label'),(0,_tinySvg.append)(parentGfx,text),text;}function renderEmbeddedLabel(parentGfx,element,align){var semantic=(0,_BpmnRenderUtil.getSemantic)(element);return renderLabel(parentGfx,semantic.name,{box:element,align:align,padding:5,style:{fill:(0,_BpmnRenderUtil.getStrokeColor)(element)}});}function renderExternalLabel(parentGfx,element){var semantic=(0,_BpmnRenderUtil.getSemantic)(element);var box={width:90,height:30,x:element.width/2+element.x,y:element.height/2+element.y};return renderLabel(parentGfx,semantic.name,{box:box,fitBox:!0,style:{fontSize:'11px'}});}function renderLaneLabel(parentGfx,text,element){var textBox=renderLabel(parentGfx,text,{box:{height:30,width:element.height},align:'center-middle',style:{fill:(0,_BpmnRenderUtil.getStrokeColor)(element)}});var top=-1*element.height;(0,_SvgTransformUtil.transform)(textBox,0,-top,270);}function createPathFromConnection(connection){var waypoints=connection.waypoints;var pathData='m  '+waypoints[0].x+','+waypoints[0].y;for(var i=1;i<waypoints.length;i++)pathData+='L'+waypoints[i].x+','+waypoints[i].y+' ';return pathData;}function attachTaskMarkers(parentGfx,element,taskMarkers){var obj=(0,_BpmnRenderUtil.getSemantic)(element);var subprocess=taskMarkers&&taskMarkers.indexOf('SubProcessMarker')!==-1;var position;subprocess?position={seq:-21,parallel:-22,compensation:-42,loop:-18,adhoc:10}:position={seq:-3,parallel:-6,compensation:-27,loop:0,adhoc:10},(0,_minDash.forEach)(taskMarkers,function(marker){renderer(marker)(parentGfx,element,position);}),obj.isForCompensation&&renderer('CompensationMarker')(parentGfx,element,position),obj.$type==='bpmn:AdHocSubProcess'&&renderer('AdhocMarker')(parentGfx,element,position);var loopCharacteristics=obj.loopCharacteristics,isSequential=loopCharacteristics&&loopCharacteristics.isSequential;loopCharacteristics&&(isSequential===undefined&&renderer('LoopMarker')(parentGfx,element,position),isSequential===!1&&renderer('ParallelMarker')(parentGfx,element,position),isSequential===!0&&renderer('SequentialMarker')(parentGfx,element,position));}function renderDataItemCollection(parentGfx,element){var yPosition=(element.height-16)/element.height;var pathData=pathMap.getScaledPath('DATA_OBJECT_COLLECTION_PATH',{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:0.451,my:yPosition}});drawPath(parentGfx,pathData,{strokeWidth:2});}_BaseRenderer2.default.call(this,eventBus,priority);var rendererId=RENDERER_IDS.next();var textUtil=new _Text2.default({style:LABEL_STYLE,size:{width:100}});var markers={};var computeStyle=styles.computeStyle;var handlers=this.handlers={'bpmn:Event':function bpmnEvent(parentGfx,element,attrs){return'fillOpacity'in attrs||(attrs.fillOpacity=DEFAULT_FILL_OPACITY),drawCircle(parentGfx,element.width,element.height,attrs);},'bpmn:StartEvent':function bpmnStartEvent(parentGfx,element){var attrs={fill:(0,_BpmnRenderUtil.getFillColor)(element),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)};var semantic=(0,_BpmnRenderUtil.getSemantic)(element);semantic.isInterrupting||(attrs={strokeDasharray:'6',strokeLinecap:'round'});var circle=renderer('bpmn:Event')(parentGfx,element,attrs);return renderEventContent(element,parentGfx),circle;},'bpmn:MessageEventDefinition':function bpmnMessageEventDefinition(parentGfx,element,isThrowing){var pathData=pathMap.getScaledPath('EVENT_MESSAGE',{xScaleFactor:0.9,yScaleFactor:0.9,containerWidth:element.width,containerHeight:element.height,position:{mx:0.235,my:0.315}});var fill=isThrowing?(0,_BpmnRenderUtil.getStrokeColor)(element):(0,_BpmnRenderUtil.getFillColor)(element);var stroke=isThrowing?(0,_BpmnRenderUtil.getFillColor)(element):(0,_BpmnRenderUtil.getStrokeColor)(element);var messagePath=drawPath(parentGfx,pathData,{strokeWidth:1,fill:fill,stroke:stroke});return messagePath;},'bpmn:TimerEventDefinition':function bpmnTimerEventDefinition(parentGfx,element){var circle=drawCircle(parentGfx,element.width,element.height,0.2*element.height,{strokeWidth:2,fill:(0,_BpmnRenderUtil.getFillColor)(element),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)});var pathData=pathMap.getScaledPath('EVENT_TIMER_WH',{xScaleFactor:0.75,yScaleFactor:0.75,containerWidth:element.width,containerHeight:element.height,position:{mx:0.5,my:0.5}});drawPath(parentGfx,pathData,{strokeWidth:2,strokeLinecap:'square',stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)});for(var i=0;i<12;i++){var linePathData=pathMap.getScaledPath('EVENT_TIMER_LINE',{xScaleFactor:0.75,yScaleFactor:0.75,containerWidth:element.width,containerHeight:element.height,position:{mx:0.5,my:0.5}});var width=element.width/2;var height=element.height/2;drawPath(parentGfx,linePathData,{strokeWidth:1,strokeLinecap:'square',transform:'rotate('+i*30+','+height+','+width+')',stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)});}return circle;},'bpmn:EscalationEventDefinition':function bpmnEscalationEventDefinition(parentGfx,event,isThrowing){var pathData=pathMap.getScaledPath('EVENT_ESCALATION',{xScaleFactor:1,yScaleFactor:1,containerWidth:event.width,containerHeight:event.height,position:{mx:0.5,my:0.2}});var fill=isThrowing?(0,_BpmnRenderUtil.getStrokeColor)(event):'none';return drawPath(parentGfx,pathData,{strokeWidth:1,fill:fill,stroke:(0,_BpmnRenderUtil.getStrokeColor)(event)});},'bpmn:ConditionalEventDefinition':function bpmnConditionalEventDefinition(parentGfx,event){var pathData=pathMap.getScaledPath('EVENT_CONDITIONAL',{xScaleFactor:1,yScaleFactor:1,containerWidth:event.width,containerHeight:event.height,position:{mx:0.5,my:0.222}});return drawPath(parentGfx,pathData,{strokeWidth:1,stroke:(0,_BpmnRenderUtil.getStrokeColor)(event)});},'bpmn:LinkEventDefinition':function bpmnLinkEventDefinition(parentGfx,event,isThrowing){var pathData=pathMap.getScaledPath('EVENT_LINK',{xScaleFactor:1,yScaleFactor:1,containerWidth:event.width,containerHeight:event.height,position:{mx:0.57,my:0.263}});var fill=isThrowing?(0,_BpmnRenderUtil.getStrokeColor)(event):'none';return drawPath(parentGfx,pathData,{strokeWidth:1,fill:fill,stroke:(0,_BpmnRenderUtil.getStrokeColor)(event)});},'bpmn:ErrorEventDefinition':function bpmnErrorEventDefinition(parentGfx,event,isThrowing){var pathData=pathMap.getScaledPath('EVENT_ERROR',{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:event.width,containerHeight:event.height,position:{mx:0.2,my:0.722}});var fill=isThrowing?(0,_BpmnRenderUtil.getStrokeColor)(event):'none';return drawPath(parentGfx,pathData,{strokeWidth:1,fill:fill,stroke:(0,_BpmnRenderUtil.getStrokeColor)(event)});},'bpmn:CancelEventDefinition':function bpmnCancelEventDefinition(parentGfx,event,isThrowing){var pathData=pathMap.getScaledPath('EVENT_CANCEL_45',{xScaleFactor:1,yScaleFactor:1,containerWidth:event.width,containerHeight:event.height,position:{mx:0.638,my:-0.055}});var fill=isThrowing?'black':'none';var path=drawPath(parentGfx,pathData,{strokeWidth:1,fill:fill});return(0,_SvgTransformUtil.rotate)(path,45),path;},'bpmn:CompensateEventDefinition':function bpmnCompensateEventDefinition(parentGfx,event,isThrowing){var pathData=pathMap.getScaledPath('EVENT_COMPENSATION',{xScaleFactor:1,yScaleFactor:1,containerWidth:event.width,containerHeight:event.height,position:{mx:0.22,my:0.5}});var fill=isThrowing?(0,_BpmnRenderUtil.getStrokeColor)(event):'none';return drawPath(parentGfx,pathData,{strokeWidth:1,fill:fill,stroke:(0,_BpmnRenderUtil.getStrokeColor)(event)});},'bpmn:SignalEventDefinition':function bpmnSignalEventDefinition(parentGfx,event,isThrowing){var pathData=pathMap.getScaledPath('EVENT_SIGNAL',{xScaleFactor:0.9,yScaleFactor:0.9,containerWidth:event.width,containerHeight:event.height,position:{mx:0.5,my:0.2}});var fill=isThrowing?(0,_BpmnRenderUtil.getStrokeColor)(event):'none';return drawPath(parentGfx,pathData,{strokeWidth:1,fill:fill,stroke:(0,_BpmnRenderUtil.getStrokeColor)(event)});},'bpmn:MultipleEventDefinition':function bpmnMultipleEventDefinition(parentGfx,event,isThrowing){var pathData=pathMap.getScaledPath('EVENT_MULTIPLE',{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:event.width,containerHeight:event.height,position:{mx:0.222,my:0.36}});var fill=isThrowing?'black':'none';return drawPath(parentGfx,pathData,{strokeWidth:1,fill:fill});},'bpmn:ParallelMultipleEventDefinition':function bpmnParallelMultipleEventDefinition(parentGfx,event){var pathData=pathMap.getScaledPath('EVENT_PARALLEL_MULTIPLE',{xScaleFactor:1.2,yScaleFactor:1.2,containerWidth:event.width,containerHeight:event.height,position:{mx:0.458,my:0.194}});return drawPath(parentGfx,pathData,{strokeWidth:1,fill:(0,_BpmnRenderUtil.getStrokeColor)(event),stroke:(0,_BpmnRenderUtil.getStrokeColor)(event)});},'bpmn:EndEvent':function bpmnEndEvent(parentGfx,element){var circle=renderer('bpmn:Event')(parentGfx,element,{strokeWidth:4,fill:(0,_BpmnRenderUtil.getFillColor)(element),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)});return renderEventContent(element,parentGfx,!0),circle;},'bpmn:TerminateEventDefinition':function bpmnTerminateEventDefinition(parentGfx,element){var circle=drawCircle(parentGfx,element.width,element.height,8,{strokeWidth:4,fill:(0,_BpmnRenderUtil.getStrokeColor)(element),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)});return circle;},'bpmn:IntermediateEvent':function bpmnIntermediateEvent(parentGfx,element){var outer=renderer('bpmn:Event')(parentGfx,element,{strokeWidth:1,fill:(0,_BpmnRenderUtil.getFillColor)(element),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)});return drawCircle(parentGfx,element.width,element.height,INNER_OUTER_DIST,{strokeWidth:1,fill:(0,_BpmnRenderUtil.getFillColor)(element,'none'),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)}),renderEventContent(element,parentGfx),outer;},'bpmn:IntermediateCatchEvent':as('bpmn:IntermediateEvent'),'bpmn:IntermediateThrowEvent':as('bpmn:IntermediateEvent'),'bpmn:Activity':function bpmnActivity(parentGfx,element,attrs){return attrs=attrs||{},'fillOpacity'in attrs||(attrs.fillOpacity=DEFAULT_FILL_OPACITY),drawRect(parentGfx,element.width,element.height,TASK_BORDER_RADIUS,attrs);},'bpmn:Task':function bpmnTask(parentGfx,element){var attrs={fill:(0,_BpmnRenderUtil.getFillColor)(element),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)};var rect=renderer('bpmn:Activity')(parentGfx,element,attrs);return renderEmbeddedLabel(parentGfx,element,'center-middle'),attachTaskMarkers(parentGfx,element),rect;},'bpmn:ServiceTask':function bpmnServiceTask(parentGfx,element){var task=renderer('bpmn:Task')(parentGfx,element);var pathDataBG=pathMap.getScaledPath('TASK_TYPE_SERVICE',{abspos:{x:12,y:18}});drawPath(parentGfx,pathDataBG,{strokeWidth:1,fill:(0,_BpmnRenderUtil.getFillColor)(element),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)});var fillPathData=pathMap.getScaledPath('TASK_TYPE_SERVICE_FILL',{abspos:{x:17.2,y:18}});drawPath(parentGfx,fillPathData,{strokeWidth:0,fill:(0,_BpmnRenderUtil.getFillColor)(element)});var pathData=pathMap.getScaledPath('TASK_TYPE_SERVICE',{abspos:{x:17,y:22}});return drawPath(parentGfx,pathData,{strokeWidth:1,fill:(0,_BpmnRenderUtil.getFillColor)(element),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)}),task;},'bpmn:UserTask':function bpmnUserTask(parentGfx,element){var task=renderer('bpmn:Task')(parentGfx,element);var x=15;var y=12;var pathData=pathMap.getScaledPath('TASK_TYPE_USER_1',{abspos:{x:x,y:y}});drawPath(parentGfx,pathData,{strokeWidth:0.5,fill:(0,_BpmnRenderUtil.getFillColor)(element),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)});var pathData2=pathMap.getScaledPath('TASK_TYPE_USER_2',{abspos:{x:x,y:y}});drawPath(parentGfx,pathData2,{strokeWidth:0.5,fill:(0,_BpmnRenderUtil.getFillColor)(element),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)});var pathData3=pathMap.getScaledPath('TASK_TYPE_USER_3',{abspos:{x:x,y:y}});return drawPath(parentGfx,pathData3,{strokeWidth:0.5,fill:(0,_BpmnRenderUtil.getStrokeColor)(element),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)}),task;},'bpmn:ManualTask':function bpmnManualTask(parentGfx,element){var task=renderer('bpmn:Task')(parentGfx,element);var pathData=pathMap.getScaledPath('TASK_TYPE_MANUAL',{abspos:{x:17,y:15}});return drawPath(parentGfx,pathData,{strokeWidth:0.5,fill:(0,_BpmnRenderUtil.getFillColor)(element),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)}),task;},'bpmn:SendTask':function bpmnSendTask(parentGfx,element){var task=renderer('bpmn:Task')(parentGfx,element);var pathData=pathMap.getScaledPath('TASK_TYPE_SEND',{xScaleFactor:1,yScaleFactor:1,containerWidth:21,containerHeight:14,position:{mx:0.285,my:0.357}});return drawPath(parentGfx,pathData,{strokeWidth:1,fill:(0,_BpmnRenderUtil.getStrokeColor)(element),stroke:(0,_BpmnRenderUtil.getFillColor)(element)}),task;},'bpmn:ReceiveTask':function bpmnReceiveTask(parentGfx,element){var semantic=(0,_BpmnRenderUtil.getSemantic)(element);var task=renderer('bpmn:Task')(parentGfx,element);var pathData;return semantic.instantiate?(drawCircle(parentGfx,28,28,20*0.22,{strokeWidth:1}),pathData=pathMap.getScaledPath('TASK_TYPE_INSTANTIATING_SEND',{abspos:{x:7.77,y:9.52}})):pathData=pathMap.getScaledPath('TASK_TYPE_SEND',{xScaleFactor:0.9,yScaleFactor:0.9,containerWidth:21,containerHeight:14,position:{mx:0.3,my:0.4}}),drawPath(parentGfx,pathData,{strokeWidth:1,fill:(0,_BpmnRenderUtil.getFillColor)(element),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)}),task;},'bpmn:ScriptTask':function bpmnScriptTask(parentGfx,element){var task=renderer('bpmn:Task')(parentGfx,element);var pathData=pathMap.getScaledPath('TASK_TYPE_SCRIPT',{abspos:{x:15,y:20}});return drawPath(parentGfx,pathData,{strokeWidth:1,stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)}),task;},'bpmn:BusinessRuleTask':function bpmnBusinessRuleTask(parentGfx,element){var task=renderer('bpmn:Task')(parentGfx,element);var headerPathData=pathMap.getScaledPath('TASK_TYPE_BUSINESS_RULE_HEADER',{abspos:{x:8,y:8}});var businessHeaderPath=drawPath(parentGfx,headerPathData);(0,_tinySvg.attr)(businessHeaderPath,{strokeWidth:1,fill:(0,_BpmnRenderUtil.getFillColor)(element,'#aaaaaa'),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)});var headerData=pathMap.getScaledPath('TASK_TYPE_BUSINESS_RULE_MAIN',{abspos:{x:8,y:8}});var businessPath=drawPath(parentGfx,headerData);return(0,_tinySvg.attr)(businessPath,{strokeWidth:1,stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)}),task;},'bpmn:SubProcess':function bpmnSubProcess(parentGfx,element,attrs){attrs=(0,_minDash.assign)({fill:(0,_BpmnRenderUtil.getFillColor)(element),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)},attrs);var rect=renderer('bpmn:Activity')(parentGfx,element,attrs);var expanded=(0,_DiUtil.isExpanded)(element);return(0,_DiUtil.isEventSubProcess)(element)&&(0,_tinySvg.attr)(rect,{strokeDasharray:'1,2'}),renderEmbeddedLabel(parentGfx,element,expanded?'center-top':'center-middle'),expanded?attachTaskMarkers(parentGfx,element):attachTaskMarkers(parentGfx,element,['SubProcessMarker']),rect;},'bpmn:AdHocSubProcess':function bpmnAdHocSubProcess(parentGfx,element){return renderer('bpmn:SubProcess')(parentGfx,element);},'bpmn:Transaction':function bpmnTransaction(parentGfx,element){var outer=renderer('bpmn:SubProcess')(parentGfx,element);var innerAttrs=styles.style(['no-fill','no-events'],{stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)});return drawRect(parentGfx,element.width,element.height,TASK_BORDER_RADIUS-2,INNER_OUTER_DIST,innerAttrs),outer;},'bpmn:CallActivity':function bpmnCallActivity(parentGfx,element){return renderer('bpmn:SubProcess')(parentGfx,element,{strokeWidth:5});},'bpmn:Participant':function bpmnParticipant(parentGfx,element){var attrs={fillOpacity:DEFAULT_FILL_OPACITY,fill:(0,_BpmnRenderUtil.getFillColor)(element),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)};var lane=renderer('bpmn:Lane')(parentGfx,element,attrs);var expandedPool=(0,_DiUtil.isExpanded)(element);if(expandedPool){drawLine(parentGfx,[{x:30,y:0},{x:30,y:element.height}],{stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)});var text=(0,_BpmnRenderUtil.getSemantic)(element).name;renderLaneLabel(parentGfx,text,element);}else{var text2=(0,_BpmnRenderUtil.getSemantic)(element).name;renderLabel(parentGfx,text2,{box:element,align:'center-middle',style:{fill:(0,_BpmnRenderUtil.getStrokeColor)(element)}});}var participantMultiplicity=!!(0,_BpmnRenderUtil.getSemantic)(element).participantMultiplicity;return participantMultiplicity&&renderer('ParticipantMultiplicityMarker')(parentGfx,element),lane;},'bpmn:Lane':function bpmnLane(parentGfx,element,attrs){var rect=drawRect(parentGfx,element.width,element.height,0,(0,_minDash.assign)({fill:(0,_BpmnRenderUtil.getFillColor)(element),fillOpacity:HIGH_FILL_OPACITY,stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)},attrs));var semantic=(0,_BpmnRenderUtil.getSemantic)(element);if(semantic.$type==='bpmn:Lane'){var text=semantic.name;renderLaneLabel(parentGfx,text,element);}return rect;},'bpmn:InclusiveGateway':function bpmnInclusiveGateway(parentGfx,element){var diamond=renderer('bpmn:Gateway')(parentGfx,element);return drawCircle(parentGfx,element.width,element.height,element.height*0.24,{strokeWidth:2.5,fill:(0,_BpmnRenderUtil.getFillColor)(element),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)}),diamond;},'bpmn:ExclusiveGateway':function bpmnExclusiveGateway(parentGfx,element){var diamond=renderer('bpmn:Gateway')(parentGfx,element);var pathData=pathMap.getScaledPath('GATEWAY_EXCLUSIVE',{xScaleFactor:0.4,yScaleFactor:0.4,containerWidth:element.width,containerHeight:element.height,position:{mx:0.32,my:0.3}});return(0,_BpmnRenderUtil.getDi)(element).isMarkerVisible&&drawPath(parentGfx,pathData,{strokeWidth:1,fill:(0,_BpmnRenderUtil.getStrokeColor)(element),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)}),diamond;},'bpmn:ComplexGateway':function bpmnComplexGateway(parentGfx,element){var diamond=renderer('bpmn:Gateway')(parentGfx,element);var pathData=pathMap.getScaledPath('GATEWAY_COMPLEX',{xScaleFactor:0.5,yScaleFactor:0.5,containerWidth:element.width,containerHeight:element.height,position:{mx:0.46,my:0.26}});return drawPath(parentGfx,pathData,{strokeWidth:1,fill:(0,_BpmnRenderUtil.getStrokeColor)(element),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)}),diamond;},'bpmn:ParallelGateway':function bpmnParallelGateway(parentGfx,element){var diamond=renderer('bpmn:Gateway')(parentGfx,element);var pathData=pathMap.getScaledPath('GATEWAY_PARALLEL',{xScaleFactor:0.6,yScaleFactor:0.6,containerWidth:element.width,containerHeight:element.height,position:{mx:0.46,my:0.2}});return drawPath(parentGfx,pathData,{strokeWidth:1,fill:(0,_BpmnRenderUtil.getStrokeColor)(element),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)}),diamond;},'bpmn:EventBasedGateway':function bpmnEventBasedGateway(parentGfx,element){function drawEvent(){var pathData=pathMap.getScaledPath('GATEWAY_EVENT_BASED',{xScaleFactor:0.18,yScaleFactor:0.18,containerWidth:element.width,containerHeight:element.height,position:{mx:0.36,my:0.44}});var attrs={strokeWidth:2,fill:(0,_BpmnRenderUtil.getFillColor)(element,'none'),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)};drawPath(parentGfx,pathData,attrs);}var semantic=(0,_BpmnRenderUtil.getSemantic)(element);var diamond=renderer('bpmn:Gateway')(parentGfx,element);drawCircle(parentGfx,element.width,element.height,element.height*0.2,{strokeWidth:1,fill:'none',stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)});var type=semantic.eventGatewayType;var instantiate=!!semantic.instantiate;if(type==='Parallel'){var pathData=pathMap.getScaledPath('GATEWAY_PARALLEL',{xScaleFactor:0.4,yScaleFactor:0.4,containerWidth:element.width,containerHeight:element.height,position:{mx:0.474,my:0.296}});var parallelPath=drawPath(parentGfx,pathData);(0,_tinySvg.attr)(parallelPath,{strokeWidth:1,fill:'none'});}else if(type==='Exclusive'){if(!instantiate){var innerCircle=drawCircle(parentGfx,element.width,element.height,element.height*0.26);(0,_tinySvg.attr)(innerCircle,{strokeWidth:1,fill:'none',stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)});}drawEvent();}return diamond;},'bpmn:Gateway':function bpmnGateway(parentGfx,element){var attrs={fill:(0,_BpmnRenderUtil.getFillColor)(element),fillOpacity:DEFAULT_FILL_OPACITY,stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)};return drawDiamond(parentGfx,element.width,element.height,attrs);},'bpmn:SequenceFlow':function bpmnSequenceFlow(parentGfx,element){var pathData=createPathFromConnection(element);var fill=(0,_BpmnRenderUtil.getFillColor)(element),stroke=(0,_BpmnRenderUtil.getStrokeColor)(element);var attrs={strokeLinejoin:'round',markerEnd:marker('sequenceflow-end',fill,stroke),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)};var path=drawPath(parentGfx,pathData,attrs);var sequenceFlow=(0,_BpmnRenderUtil.getSemantic)(element);var source;return element.source&&(source=element.source.businessObject,sequenceFlow.conditionExpression&&source.$instanceOf('bpmn:Activity')&&(0,_tinySvg.attr)(path,{markerStart:marker('conditional-flow-marker',fill,stroke)}),source.default&&(source.$instanceOf('bpmn:Gateway')||source.$instanceOf('bpmn:Activity'))&&source.default===sequenceFlow&&(0,_tinySvg.attr)(path,{markerStart:marker('conditional-default-flow-marker',fill,stroke)})),path;},'bpmn:Association':function bpmnAssociation(parentGfx,element,attrs){var semantic=(0,_BpmnRenderUtil.getSemantic)(element);var fill=(0,_BpmnRenderUtil.getFillColor)(element),stroke=(0,_BpmnRenderUtil.getStrokeColor)(element);return attrs=(0,_minDash.assign)({strokeDasharray:'0.5, 5',strokeLinecap:'round',strokeLinejoin:'round',stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)},attrs||{}),(semantic.associationDirection==='One'||semantic.associationDirection==='Both')&&(attrs.markerEnd=marker('association-end',fill,stroke)),semantic.associationDirection==='Both'&&(attrs.markerStart=marker('association-start',fill,stroke)),drawLine(parentGfx,element.waypoints,attrs);},'bpmn:DataInputAssociation':function bpmnDataInputAssociation(parentGfx,element){var fill=(0,_BpmnRenderUtil.getFillColor)(element),stroke=(0,_BpmnRenderUtil.getStrokeColor)(element);return renderer('bpmn:Association')(parentGfx,element,{markerEnd:marker('association-end',fill,stroke)});},'bpmn:DataOutputAssociation':function bpmnDataOutputAssociation(parentGfx,element){var fill=(0,_BpmnRenderUtil.getFillColor)(element),stroke=(0,_BpmnRenderUtil.getStrokeColor)(element);return renderer('bpmn:Association')(parentGfx,element,{markerEnd:marker('association-end',fill,stroke)});},'bpmn:MessageFlow':function bpmnMessageFlow(parentGfx,element){var semantic=(0,_BpmnRenderUtil.getSemantic)(element),di=(0,_BpmnRenderUtil.getDi)(element);var fill=(0,_BpmnRenderUtil.getFillColor)(element),stroke=(0,_BpmnRenderUtil.getStrokeColor)(element);var pathData=createPathFromConnection(element);var attrs={markerEnd:marker('messageflow-end',fill,stroke),markerStart:marker('messageflow-start',fill,stroke),strokeDasharray:'10, 12',strokeLinecap:'round',strokeLinejoin:'round',strokeWidth:'1.5px',stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)};var path=drawPath(parentGfx,pathData,attrs);if(semantic.messageRef){var midPoint=path.getPointAtLength(path.getTotalLength()/2);var markerPathData=pathMap.getScaledPath('MESSAGE_FLOW_MARKER',{abspos:{x:midPoint.x,y:midPoint.y}});var messageAttrs={strokeWidth:1};di.messageVisibleKind==='initiating'?(messageAttrs.fill='white',messageAttrs.stroke='black'):(messageAttrs.fill='#888',messageAttrs.stroke='white'),drawPath(parentGfx,markerPathData,messageAttrs);}return path;},'bpmn:DataObject':function bpmnDataObject(parentGfx,element){var pathData=pathMap.getScaledPath('DATA_OBJECT_PATH',{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:0.474,my:0.296}});var elementObject=drawPath(parentGfx,pathData,{fill:(0,_BpmnRenderUtil.getFillColor)(element),fillOpacity:DEFAULT_FILL_OPACITY,stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)});var semantic=(0,_BpmnRenderUtil.getSemantic)(element);return(0,_BpmnRenderUtil.isCollection)(semantic)&&renderDataItemCollection(parentGfx,element),elementObject;},'bpmn:DataObjectReference':as('bpmn:DataObject'),'bpmn:DataInput':function bpmnDataInput(parentGfx,element){var arrowPathData=pathMap.getRawPath('DATA_ARROW');var elementObject=renderer('bpmn:DataObject')(parentGfx,element);return drawPath(parentGfx,arrowPathData,{strokeWidth:1}),elementObject;},'bpmn:DataOutput':function bpmnDataOutput(parentGfx,element){var arrowPathData=pathMap.getRawPath('DATA_ARROW');var elementObject=renderer('bpmn:DataObject')(parentGfx,element);return drawPath(parentGfx,arrowPathData,{strokeWidth:1,fill:'black'}),elementObject;},'bpmn:DataStoreReference':function bpmnDataStoreReference(parentGfx,element){var DATA_STORE_PATH=pathMap.getScaledPath('DATA_STORE',{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:0,my:0.133}});var elementStore=drawPath(parentGfx,DATA_STORE_PATH,{strokeWidth:2,fill:(0,_BpmnRenderUtil.getFillColor)(element),fillOpacity:DEFAULT_FILL_OPACITY,stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)});return elementStore;},'bpmn:BoundaryEvent':function bpmnBoundaryEvent(parentGfx,element){var semantic=(0,_BpmnRenderUtil.getSemantic)(element),cancel=semantic.cancelActivity;var attrs={strokeWidth:1,fill:(0,_BpmnRenderUtil.getFillColor)(element),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)};cancel||(attrs.strokeDasharray='6',attrs.strokeLinecap='round');var outerAttrs=(0,_minDash.assign)({},attrs,{fillOpacity:1});var innerAttrs=(0,_minDash.assign)({},attrs,{fill:'none'});var outer=renderer('bpmn:Event')(parentGfx,element,outerAttrs);return drawCircle(parentGfx,element.width,element.height,INNER_OUTER_DIST,innerAttrs),renderEventContent(element,parentGfx),outer;},'bpmn:Group':function bpmnGroup(parentGfx,element){return drawRect(parentGfx,element.width,element.height,TASK_BORDER_RADIUS,{strokeWidth:1,strokeDasharray:'8,3,1,3',fill:'none',pointerEvents:'none'});},label:function label(parentGfx,element){return renderExternalLabel(parentGfx,element);},'bpmn:TextAnnotation':function bpmnTextAnnotation(parentGfx,element){var style={fill:'none',stroke:'none'};var textElement=drawRect(parentGfx,element.width,element.height,0,0,style);var textPathData=pathMap.getScaledPath('TEXT_ANNOTATION',{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:0,my:0}});drawPath(parentGfx,textPathData,{stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)});var text=(0,_BpmnRenderUtil.getSemantic)(element).text||'';return renderLabel(parentGfx,text,{box:element,align:'left-top',padding:5}),textElement;},ParticipantMultiplicityMarker:function ParticipantMultiplicityMarker(parentGfx,element){var markerPath=pathMap.getScaledPath('MARKER_PARALLEL',{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:element.width/2/element.width,my:(element.height-15)/element.height}});drawMarker('participant-multiplicity',parentGfx,markerPath);},SubProcessMarker:function SubProcessMarker(parentGfx,element){var markerRect=drawRect(parentGfx,14,14,0,{strokeWidth:1,fill:(0,_BpmnRenderUtil.getFillColor)(element),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)});(0,_SvgTransformUtil.translate)(markerRect,element.width/2-7.5,element.height-20);var markerPath=pathMap.getScaledPath('MARKER_SUB_PROCESS',{xScaleFactor:1.5,yScaleFactor:1.5,containerWidth:element.width,containerHeight:element.height,position:{mx:(element.width/2-7.5)/element.width,my:(element.height-20)/element.height}});drawMarker('sub-process',parentGfx,markerPath,{fill:(0,_BpmnRenderUtil.getFillColor)(element),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element)});},ParallelMarker:function ParallelMarker(parentGfx,element,position){var markerPath=pathMap.getScaledPath('MARKER_PARALLEL',{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:(element.width/2+position.parallel)/element.width,my:(element.height-20)/element.height}});drawMarker('parallel',parentGfx,markerPath);},SequentialMarker:function SequentialMarker(parentGfx,element,position){var markerPath=pathMap.getScaledPath('MARKER_SEQUENTIAL',{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:(element.width/2+position.seq)/element.width,my:(element.height-19)/element.height}});drawMarker('sequential',parentGfx,markerPath);},CompensationMarker:function CompensationMarker(parentGfx,element,position){var markerMath=pathMap.getScaledPath('MARKER_COMPENSATION',{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:(element.width/2+position.compensation)/element.width,my:(element.height-13)/element.height}});drawMarker('compensation',parentGfx,markerMath,{strokeWidth:1});},LoopMarker:function LoopMarker(parentGfx,element,position){var markerPath=pathMap.getScaledPath('MARKER_LOOP',{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:(element.width/2+position.loop)/element.width,my:(element.height-7)/element.height}});drawMarker('loop',parentGfx,markerPath,{strokeWidth:1,fill:'none',strokeLinecap:'round',strokeMiterlimit:0.5});},AdhocMarker:function AdhocMarker(parentGfx,element,position){var markerPath=pathMap.getScaledPath('MARKER_ADHOC',{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:(element.width/2+position.adhoc)/element.width,my:(element.height-15)/element.height}});drawMarker('adhoc',parentGfx,markerPath,{strokeWidth:1,fill:'black'});}};this._drawPath=drawPath;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=BpmnRenderer;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _minDash=require('min-dash');var _BaseRenderer=require('diagram-js/lib/draw/BaseRenderer');var _BaseRenderer2=_interopRequireDefault(_BaseRenderer);var _Text=require('diagram-js/lib/util/Text');var _Text2=_interopRequireDefault(_Text);var _DiUtil=require('../util/DiUtil');var _ModelUtil=require('../util/ModelUtil');var _RenderUtil=require('diagram-js/lib/util/RenderUtil');var _BpmnRenderUtil=require('./BpmnRenderUtil');var _minDom=require('min-dom');var _tinySvg=require('tiny-svg');var _SvgTransformUtil=require('diagram-js/lib/util/SvgTransformUtil');var _ids=require('ids');var _ids2=_interopRequireDefault(_ids);var RENDERER_IDS=new _ids2.default();var TASK_BORDER_RADIUS=10;var INNER_OUTER_DIST=3;var LABEL_STYLE={fontFamily:'Arial, sans-serif',fontSize:12};var DEFAULT_FILL_OPACITY=0.95,HIGH_FILL_OPACITY=0.35;(0,_inherits2.default)(BpmnRenderer,_BaseRenderer2.default),BpmnRenderer.$inject=['eventBus','styles','pathMap','canvas'],BpmnRenderer.prototype.canRender=function(element){return(0,_ModelUtil.is)(element,'bpmn:BaseElement');},BpmnRenderer.prototype.drawShape=function(parentGfx,element){var type=element.type;var h=this.handlers[type];return h(parentGfx,element);},BpmnRenderer.prototype.drawConnection=function(parentGfx,element){var type=element.type;var h=this.handlers[type];return h(parentGfx,element);},BpmnRenderer.prototype.getShapePath=function(element){return(0,_ModelUtil.is)(element,'bpmn:Event')?(0,_BpmnRenderUtil.getCirclePath)(element):(0,_ModelUtil.is)(element,'bpmn:Activity')?(0,_BpmnRenderUtil.getRoundRectPath)(element,TASK_BORDER_RADIUS):(0,_ModelUtil.is)(element,'bpmn:Gateway')?(0,_BpmnRenderUtil.getDiamondPath)(element):(0,_BpmnRenderUtil.getRectPath)(element);};},{'../util/DiUtil':157,'../util/ModelUtil':159,'./BpmnRenderUtil':63,'diagram-js/lib/draw/BaseRenderer':194,'diagram-js/lib/util/RenderUtil':342,'diagram-js/lib/util/SvgTransformUtil':343,'diagram-js/lib/util/Text':344,ids:349,inherits:350,'min-dash':438,'min-dom':439,'tiny-svg':468}],65:[function(require,module,exports){'use strict';function PathMap(){this.pathMap={EVENT_MESSAGE:{d:'m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}',height:36,width:36,heightElements:[6,14],widthElements:[10.5,21]},EVENT_SIGNAL:{d:'M {mx},{my} l {e.x0},{e.y0} l -{e.x1},0 Z',height:36,width:36,heightElements:[18],widthElements:[10,20]},EVENT_ESCALATION:{d:'M {mx},{my} l {e.x0},{e.y0} l -{e.x0},-{e.y1} l -{e.x0},{e.y1} Z',height:36,width:36,heightElements:[20,7],widthElements:[8]},EVENT_CONDITIONAL:{d:'M {e.x0},{e.y0} l {e.x1},0 l 0,{e.y2} l -{e.x1},0 Z '+'M {e.x2},{e.y3} l {e.x0},0 '+'M {e.x2},{e.y4} l {e.x0},0 '+'M {e.x2},{e.y5} l {e.x0},0 '+'M {e.x2},{e.y6} l {e.x0},0 '+'M {e.x2},{e.y7} l {e.x0},0 '+'M {e.x2},{e.y8} l {e.x0},0 ',height:36,width:36,heightElements:[8.5,14.5,18,11.5,14.5,17.5,20.5,23.5,26.5],widthElements:[10.5,14.5,12.5]},EVENT_LINK:{d:'m {mx},{my} 0,{e.y0} -{e.x1},0 0,{e.y1} {e.x1},0 0,{e.y0} {e.x0},-{e.y2} -{e.x0},-{e.y2} z',height:36,width:36,heightElements:[4.4375,6.75,7.8125],widthElements:[9.84375,13.5]},EVENT_ERROR:{d:'m {mx},{my} {e.x0},-{e.y0} {e.x1},-{e.y1} {e.x2},{e.y2} {e.x3},-{e.y3} -{e.x4},{e.y4} -{e.x5},-{e.y5} z',height:36,width:36,heightElements:[0.023,8.737,8.151,16.564,10.591,8.714],widthElements:[0.085,6.672,6.97,4.273,5.337,6.636]},EVENT_CANCEL_45:{d:'m {mx},{my} -{e.x1},0 0,{e.x0} {e.x1},0 0,{e.y1} {e.x0},0 '+'0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z',height:36,width:36,heightElements:[4.75,8.5],widthElements:[4.75,8.5]},EVENT_COMPENSATION:{d:'m {mx},{my} {e.x0},-{e.y0} 0,{e.y1} z m {e.x1},-{e.y2} {e.x2},-{e.y3} 0,{e.y1} -{e.x2},-{e.y3} z',height:36,width:36,heightElements:[6.5,13,0.4,6.1],widthElements:[9,9.3,8.7]},EVENT_TIMER_WH:{d:'M {mx},{my} l {e.x0},-{e.y0} m -{e.x0},{e.y0} l {e.x1},{e.y1} ',height:36,width:36,heightElements:[10,2],widthElements:[3,7]},EVENT_TIMER_LINE:{d:'M {mx},{my} '+'m {e.x0},{e.y0} l -{e.x1},{e.y1} ',height:36,width:36,heightElements:[10,3],widthElements:[0,0]},EVENT_MULTIPLE:{d:'m {mx},{my} {e.x1},-{e.y0} {e.x1},{e.y0} -{e.x0},{e.y1} -{e.x2},0 z',height:36,width:36,heightElements:[6.28099,12.56199],widthElements:[3.1405,9.42149,12.56198]},EVENT_PARALLEL_MULTIPLE:{d:'m {mx},{my} {e.x0},0 0,{e.y1} {e.x1},0 0,{e.y0} -{e.x1},0 0,{e.y1} '+'-{e.x0},0 0,-{e.y1} -{e.x1},0 0,-{e.y0} {e.x1},0 z',height:36,width:36,heightElements:[2.56228,7.68683],widthElements:[2.56228,7.68683]},GATEWAY_EXCLUSIVE:{d:'m {mx},{my} {e.x0},{e.y0} {e.x1},{e.y0} {e.x2},0 {e.x4},{e.y2} '+'{e.x4},{e.y1} {e.x2},0 {e.x1},{e.y3} {e.x0},{e.y3} '+'{e.x3},0 {e.x5},{e.y1} {e.x5},{e.y2} {e.x3},0 z',height:17.5,width:17.5,heightElements:[8.5,6.5312,-6.5312,-8.5],widthElements:[6.5,-6.5,3,-3,5,-5]},GATEWAY_PARALLEL:{d:'m {mx},{my} 0,{e.y1} -{e.x1},0 0,{e.y0} {e.x1},0 0,{e.y1} {e.x0},0 '+'0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z',height:30,width:30,heightElements:[5,12.5],widthElements:[5,12.5]},GATEWAY_EVENT_BASED:{d:'m {mx},{my} {e.x0},{e.y0} {e.x0},{e.y1} {e.x1},{e.y2} {e.x2},0 z',height:11,width:11,heightElements:[-6,6,12,-12],widthElements:[9,-3,-12]},GATEWAY_COMPLEX:{d:'m {mx},{my} 0,{e.y0} -{e.x0},-{e.y1} -{e.x1},{e.y2} {e.x0},{e.y1} -{e.x2},0 0,{e.y3} '+'{e.x2},0  -{e.x0},{e.y1} l {e.x1},{e.y2} {e.x0},-{e.y1} 0,{e.y0} {e.x3},0 0,-{e.y0} {e.x0},{e.y1} '+'{e.x1},-{e.y2} -{e.x0},-{e.y1} {e.x2},0 0,-{e.y3} -{e.x2},0 {e.x0},-{e.y1} -{e.x1},-{e.y2} '+'-{e.x0},{e.y1} 0,-{e.y0} -{e.x3},0 z',height:17.125,width:17.125,heightElements:[4.875,3.4375,2.125,3],widthElements:[3.4375,2.125,4.875,3]},DATA_OBJECT_PATH:{d:'m 0,0 {e.x1},0 {e.x0},{e.y0} 0,{e.y1} -{e.x2},0 0,-{e.y2} {e.x1},0 0,{e.y0} {e.x0},0',height:61,width:51,heightElements:[10,50,60],widthElements:[10,40,50,60]},DATA_OBJECT_COLLECTION_PATH:{d:'m {mx}, {my} '+'m  0 15  l 0 -15 '+'m  4 15  l 0 -15 '+'m  4 15  l 0 -15 ',height:61,width:51,heightElements:[12],widthElements:[1,6,12,15]},DATA_ARROW:{d:'m 5,9 9,0 0,-3 5,5 -5,5 0,-3 -9,0 z',height:61,width:51,heightElements:[],widthElements:[]},DATA_STORE:{d:'m  {mx},{my} '+'l  0,{e.y2} '+'c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 '+'l  0,-{e.y2} '+'c -{e.x0},-{e.y1} -{e.x1},-{e.y1} -{e.x2},0'+'c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 '+'m  -{e.x2},{e.y0}'+'c  {e.x0},{e.y1} {e.x1},{e.y1} {e.x2},0'+'m  -{e.x2},{e.y0}'+'c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0',height:61,width:61,heightElements:[7,10,45],widthElements:[2,58,60]},TEXT_ANNOTATION:{d:'m {mx}, {my} m 10,0 l -10,0 l 0,{e.y0} l 10,0',height:30,width:10,heightElements:[30],widthElements:[10]},MARKER_SUB_PROCESS:{d:'m{mx},{my} m 7,2 l 0,10 m -5,-5 l 10,0',height:10,width:10,heightElements:[],widthElements:[]},MARKER_PARALLEL:{d:'m{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10',height:10,width:10,heightElements:[],widthElements:[]},MARKER_SEQUENTIAL:{d:'m{mx},{my} m 0,3 l 10,0 m -10,3 l 10,0 m -10,3 l 10,0',height:10,width:10,heightElements:[],widthElements:[]},MARKER_COMPENSATION:{d:'m {mx},{my} 7,-5 0,10 z m 7.1,-0.3 6.9,-4.7 0,10 -6.9,-4.7 z',height:10,width:21,heightElements:[],widthElements:[]},MARKER_LOOP:{d:'m {mx},{my} c 3.526979,0 6.386161,-2.829858 6.386161,-6.320661 0,-3.490806 -2.859182,-6.320661 '+'-6.386161,-6.320661 -3.526978,0 -6.38616,2.829855 -6.38616,6.320661 0,1.745402 '+'0.714797,3.325567 1.870463,4.469381 0.577834,0.571908 1.265885,1.034728 2.029916,1.35457 '+'l -0.718163,-3.909793 m 0.718163,3.909793 -3.885211,0.802902',height:13.9,width:13.7,heightElements:[],widthElements:[]},MARKER_ADHOC:{d:'m {mx},{my} m 0.84461,2.64411 c 1.05533,-1.23780996 2.64337,-2.07882 4.29653,-1.97997996 2.05163,0.0805 '+'3.85579,1.15803 5.76082,1.79107 1.06385,0.34139996 2.24454,0.1438 3.18759,-0.43767 0.61743,-0.33642 '+'1.2775,-0.64078 1.7542,-1.17511 0,0.56023 0,1.12046 0,1.6807 -0.98706,0.96237996 -2.29792,1.62393996 '+'-3.6918,1.66181996 -1.24459,0.0927 -2.46671,-0.2491 -3.59505,-0.74812 -1.35789,-0.55965 '+'-2.75133,-1.33436996 -4.27027,-1.18121996 -1.37741,0.14601 -2.41842,1.13685996 -3.44288,1.96782996 z',height:4,width:15,heightElements:[],widthElements:[]},TASK_TYPE_SEND:{d:'m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}',height:14,width:21,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_SCRIPT:{d:'m {mx},{my} c 9.966553,-6.27276 -8.000926,-7.91932 2.968968,-14.938 l -8.802728,0 '+'c -10.969894,7.01868 6.997585,8.66524 -2.968967,14.938 z '+'m -7,-12 l 5,0 '+'m -4.5,3 l 4.5,0 '+'m -3,3 l 5,0'+'m -4,3 l 5,0',height:15,width:12.6,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_USER_1:{d:'m {mx},{my} c 0.909,-0.845 1.594,-2.049 1.594,-3.385 0,-2.554 -1.805,-4.62199999 '+'-4.357,-4.62199999 -2.55199998,0 -4.28799998,2.06799999 -4.28799998,4.62199999 0,1.348 '+'0.974,2.562 1.89599998,3.405 -0.52899998,0.187 -5.669,2.097 -5.794,4.7560005 v 6.718 '+'h 17 v -6.718 c 0,-2.2980005 -5.5279996,-4.5950005 -6.0509996,-4.7760005 z'+'m -8,6 l 0,5.5 m 11,0 l 0,-5'},TASK_TYPE_USER_2:{d:'m {mx},{my} m 2.162,1.009 c 0,2.4470005 -2.158,4.4310005 -4.821,4.4310005 '+'-2.66499998,0 -4.822,-1.981 -4.822,-4.4310005 '},TASK_TYPE_USER_3:{d:'m {mx},{my} m -6.9,-3.80 c 0,0 2.25099998,-2.358 4.27399998,-1.177 2.024,1.181 4.221,1.537 '+'4.124,0.965 -0.098,-0.57 -0.117,-3.79099999 -4.191,-4.13599999 -3.57499998,0.001 '+'-4.20799998,3.36699999 -4.20699998,4.34799999 z'},TASK_TYPE_MANUAL:{d:'m {mx},{my} c 0.234,-0.01 5.604,0.008 8.029,0.004 0.808,0 1.271,-0.172 1.417,-0.752 0.227,-0.898 '+'-0.334,-1.314 -1.338,-1.316 -2.467,-0.01 -7.886,-0.004 -8.108,-0.004 -0.014,-0.079 0.016,-0.533 0,-0.61 '+'0.195,-0.042 8.507,0.006 9.616,0.002 0.877,-0.007 1.35,-0.438 1.353,-1.208 0.003,-0.768 -0.479,-1.09 '+'-1.35,-1.091 -2.968,-0.002 -9.619,-0.013 -9.619,-0.013 v -0.591 c 0,0 5.052,-0.016 7.225,-0.016 '+'0.888,-0.002 1.354,-0.416 1.351,-1.193 -0.006,-0.761 -0.492,-1.196 -1.361,-1.196 -3.473,-0.005 '+'-10.86,-0.003 -11.0829995,-0.003 -0.022,-0.047 -0.045,-0.094 -0.069,-0.139 0.3939995,-0.319 '+'2.0409995,-1.626 2.4149995,-2.017 0.469,-0.4870005 0.519,-1.1650005 0.162,-1.6040005 -0.414,-0.511 '+'-0.973,-0.5 -1.48,-0.236 -1.4609995,0.764 -6.5999995,3.6430005 -7.7329995,4.2710005 -0.9,0.499 '+'-1.516,1.253 -1.882,2.19 -0.37000002,0.95 -0.17,2.01 -0.166,2.979 0.004,0.718 -0.27300002,1.345 '+'-0.055,2.063 0.629,2.087 2.425,3.312 4.859,3.318 4.6179995,0.014 9.2379995,-0.139 13.8569995,-0.158 '+'0.755,-0.004 1.171,-0.301 1.182,-1.033 0.012,-0.754 -0.423,-0.969 -1.183,-0.973 -1.778,-0.01 '+'-5.824,-0.004 -6.04,-0.004 10e-4,-0.084 0.003,-0.586 10e-4,-0.67 z'},TASK_TYPE_INSTANTIATING_SEND:{d:'m {mx},{my} l 0,8.4 l 12.6,0 l 0,-8.4 z l 6.3,3.6 l 6.3,-3.6'},TASK_TYPE_SERVICE:{d:'m {mx},{my} v -1.71335 c 0.352326,-0.0705 0.703932,-0.17838 1.047628,-0.32133 '+'0.344416,-0.14465 0.665822,-0.32133 0.966377,-0.52145 l 1.19431,1.18005 1.567487,-1.57688 '+'-1.195028,-1.18014 c 0.403376,-0.61394 0.683079,-1.29908 0.825447,-2.01824 l 1.622133,-0.01 '+'v -2.2196 l -1.636514,0.01 c -0.07333,-0.35153 -0.178319,-0.70024 -0.323564,-1.04372 '+'-0.145244,-0.34406 -0.321407,-0.6644 -0.522735,-0.96217 l 1.131035,-1.13631 -1.583305,-1.56293 '+'-1.129598,1.13589 c -0.614052,-0.40108 -1.302883,-0.68093 -2.022633,-0.82247 l 0.0093,-1.61852 '+'h -2.241173 l 0.0042,1.63124 c -0.353763,0.0736 -0.705369,0.17977 -1.049785,0.32371 -0.344415,0.14437 '+'-0.665102,0.32092 -0.9635006,0.52046 l -1.1698628,-1.15823 -1.5667691,1.5792 1.1684265,1.15669 '+'c -0.4026573,0.61283 -0.68308,1.29797 -0.8247287,2.01713 l -1.6588041,0.003 v 2.22174 '+'l 1.6724648,-0.006 c 0.073327,0.35077 0.1797598,0.70243 0.3242851,1.04472 0.1452428,0.34448 '+'0.3214064,0.6644 0.5227339,0.96066 l -1.1993431,1.19723 1.5840256,1.56011 1.1964668,-1.19348 '+'c 0.6140517,0.40346 1.3028827,0.68232 2.0233517,0.82331 l 7.19e-4,1.69892 h 2.226848 z '+'m 0.221462,-3.9957 c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 '+'0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 '+'0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z'},TASK_TYPE_SERVICE_FILL:{d:'m {mx},{my} c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 '+'0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 '+'0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z'},TASK_TYPE_BUSINESS_RULE_HEADER:{d:'m {mx},{my} 0,4 20,0 0,-4 z'},TASK_TYPE_BUSINESS_RULE_MAIN:{d:'m {mx},{my} 0,12 20,0 0,-12 z'+'m 0,8 l 20,0 '+'m -13,-4 l 0,8'},MESSAGE_FLOW_MARKER:{d:'m {mx},{my} m -10.5 ,-7 l 0,14 l 21,0 l 0,-14 z l 10.5,6 l 10.5,-6'}},this.getRawPath=function getRawPath(pathId){return this.pathMap[pathId].d;},this.getScaledPath=function getScaledPath(pathId,param){var rawPath=this.pathMap[pathId];var mx,my;param.abspos?(mx=param.abspos.x,my=param.abspos.y):(mx=param.containerWidth*param.position.mx,my=param.containerHeight*param.position.my);var coordinates={};if(param.position){var heightRatio=param.containerHeight/rawPath.height*param.yScaleFactor;var widthRatio=param.containerWidth/rawPath.width*param.xScaleFactor;for(var heightIndex=0;heightIndex<rawPath.heightElements.length;heightIndex++)coordinates['y'+heightIndex]=rawPath.heightElements[heightIndex]*heightRatio;for(var widthIndex=0;widthIndex<rawPath.widthElements.length;widthIndex++)coordinates['x'+widthIndex]=rawPath.widthElements[widthIndex]*widthRatio;}var path=format(rawPath.d,{mx:mx,my:my,e:coordinates});return path;};}function replacer(all,key,obj){var res=obj;return key.replace(objNotationRegex,function(all,name,quote,quotedName,isFunc){name=name||quotedName,res&&(name in res&&(res=res[name]),typeof res=='function'&&isFunc&&(res=res()));}),res=(res==null||res==obj?all:res)+'',res;}function format(str,obj){return String(str).replace(tokenRegex,function(all,key){return replacer(all,key,obj);});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=PathMap;var tokenRegex=/\{([^}]+)\}/g,objNotationRegex=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g;},{}],66:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _BpmnRenderer=require('./BpmnRenderer');var _BpmnRenderer2=_interopRequireDefault(_BpmnRenderer);var _PathMap=require('./PathMap');var _PathMap2=_interopRequireDefault(_PathMap);exports.default={__init__:['bpmnRenderer'],bpmnRenderer:['type',_BpmnRenderer2.default],pathMap:['type',_PathMap2.default]};},{'./BpmnRenderer':64,'./PathMap':65}],67:[function(require,module,exports){'use strict';function AutoPlace(eventBus,modeling){function emit(event,payload){return eventBus.fire(event,payload);}this.append=function(source,shape){var position=emit('autoPlace',{source:source,shape:shape});position||(position=getNewShapePosition(source,shape));var newShape=modeling.appendShape(source,shape,position,source.parent);return emit('autoPlace.end',{shape:newShape}),newShape;};}function getNewShapePosition(source,element){return(0,_ModelUtil.is)(element,'bpmn:TextAnnotation')?(0,_AutoPlaceUtil.getTextAnnotationPosition)(source,element):(0,_ModelingUtil.isAny)(element,['bpmn:DataObjectReference','bpmn:DataStoreReference'])?(0,_AutoPlaceUtil.getDataElementPosition)(source,element):(0,_ModelUtil.is)(element,'bpmn:FlowNode')?(0,_AutoPlaceUtil.getFlowNodePosition)(source,element):(0,_AutoPlaceUtil.getDefaultPosition)(source,element);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=AutoPlace;var _ModelUtil=require('../../util/ModelUtil');var _ModelingUtil=require('../modeling/util/ModelingUtil');var _AutoPlaceUtil=require('./AutoPlaceUtil');AutoPlace.$inject=['eventBus','modeling'];},{'../../util/ModelUtil':159,'../modeling/util/ModelingUtil':132,'./AutoPlaceUtil':69}],68:[function(require,module,exports){'use strict';function AutoPlaceSelectionBehavior(eventBus,selection){eventBus.on('autoPlace.end',500,function(e){selection.select(e.shape);});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=AutoPlaceSelectionBehavior,AutoPlaceSelectionBehavior.$inject=['eventBus','selection'];},{}],69:[function(require,module,exports){'use strict';function getFlowNodePosition(source,element){function getVerticalDistance(orient){return orient.indexOf('top')!=-1?-1*rowSize:orient.indexOf('bottom')!=-1?rowSize:0;}var sourceTrbl=(0,_LayoutUtil.asTRBL)(source);var sourceMid=(0,_LayoutUtil.getMid)(source);var horizontalDistance=getFlowNodeDistance(source,element);var orientation='left',rowSize=80,margin=30;(0,_ModelUtil.is)(source,'bpmn:BoundaryEvent')&&(orientation=(0,_LayoutUtil.getOrientation)(source,source.host,-25),orientation.indexOf('top')!==-1&&(margin*=-1));var position={x:sourceTrbl.right+horizontalDistance+element.width/2,y:sourceMid.y+getVerticalDistance(orientation)};var escapeDirection={y:{margin:margin,rowSize:rowSize}};return deconflictPosition(source,element,position,escapeDirection);}function getFlowNodeDistance(source,element){function isReference(c){return(0,_ModelUtil.is)(c,'bpmn:SequenceFlow');}function toTargetNode(weight){return function(shape){return{shape:shape,weight:weight,distanceTo:function distanceTo(shape){var shapeTrbl=(0,_LayoutUtil.asTRBL)(shape);return shapeTrbl.left-sourceTrbl.right;}};};}function toSourceNode(weight){return function(shape){return{shape:shape,weight:weight,distanceTo:function distanceTo(shape){var shapeTrbl=(0,_LayoutUtil.asTRBL)(shape);return sourceTrbl.left-shapeTrbl.right;}};};}var sourceTrbl=(0,_LayoutUtil.asTRBL)(source);var nodes=(0,_minDash.reduce)([].concat(getTargets(source,isReference).map(toTargetNode(5)),getSources(source,isReference).map(toSourceNode(1))),function(nodes,node){return nodes[node.shape.id+'__weight_'+node.weight]=node,nodes;},{});var distancesGrouped=(0,_minDash.reduce)(nodes,function(result,node){var shape=node.shape,weight=node.weight,distanceTo=node.distanceTo;var fav=result.fav,currentDistance,currentDistanceCount,currentDistanceEntry;return currentDistance=distanceTo(shape),currentDistance<0||currentDistance>MAX_HORIZONTAL_DISTANCE?result:(currentDistanceEntry=result[String(currentDistance)]=result[String(currentDistance)]||{value:currentDistance,count:0},currentDistanceCount=currentDistanceEntry.count+=1*weight,(!fav||fav.count<currentDistanceCount)&&(result.fav=currentDistanceEntry),result);},{});return distancesGrouped.fav?distancesGrouped.fav.value:DEFAULT_HORIZONTAL_DISTANCE;}function getTextAnnotationPosition(source,element){var sourceTrbl=(0,_LayoutUtil.asTRBL)(source);var position={x:sourceTrbl.right+element.width/2,y:sourceTrbl.top-50-element.height/2};var escapeDirection={y:{margin:-30,rowSize:20}};return deconflictPosition(source,element,position,escapeDirection);}function getDataElementPosition(source,element){var sourceTrbl=(0,_LayoutUtil.asTRBL)(source);var position={x:sourceTrbl.right-10+element.width/2,y:sourceTrbl.bottom+40+element.width/2};var escapeDirection={x:{margin:30,rowSize:30}};return deconflictPosition(source,element,position,escapeDirection);}function getDefaultPosition(source,element){var sourceTrbl=(0,_LayoutUtil.asTRBL)(source);var sourceMid=(0,_LayoutUtil.getMid)(source);return{x:sourceTrbl.right+DEFAULT_HORIZONTAL_DISTANCE+element.width/2,y:sourceMid.y};}function getAutoPlaceClosure(source,element){var allConnected=getConnected(source);return source.host&&(allConnected=allConnected.concat(getConnected(source.host))),source.attachers&&(allConnected=allConnected.concat(source.attachers.reduce(function(shapes,attacher){return shapes.concat(getConnected(attacher));},[]))),allConnected;}function getConnectedAtPosition(source,position,element){var bounds={x:position.x-element.width/2,y:position.y-element.height/2,width:element.width,height:element.height};var closure=getAutoPlaceClosure(source,element);return(0,_minDash.find)(closure,function(target){if(target===element)return!1;var orientation=(0,_LayoutUtil.getOrientation)(target,bounds,PLACEMENT_DETECTION_PAD);return orientation==='intersect';});}function deconflictPosition(source,element,position,escapeDelta){function nextPosition(existingElement){var newPosition={x:position.x,y:position.y};return['x','y'].forEach(function(axis){var axisDelta=escapeDelta[axis];if(!axisDelta)return;var dimension=axis==='x'?'width':'height';var margin=axisDelta.margin,rowSize=axisDelta.rowSize;margin<0?newPosition[axis]=Math.min(existingElement[axis]+margin-element[dimension]/2,position[axis]-rowSize+margin):newPosition[axis]=Math.max(existingTarget[axis]+existingTarget[dimension]+margin+element[dimension]/2,position[axis]+rowSize+margin);}),newPosition;}var existingTarget;while(existingTarget=getConnectedAtPosition(source,position,element))position=nextPosition(existingTarget);return position;}function noneFilter(){return!0;}function getConnected(element,connectionFilter){return[].concat(getTargets(element,connectionFilter),getSources(element,connectionFilter));}function getSources(shape,connectionFilter){return connectionFilter||(connectionFilter=noneFilter),shape.incoming.filter(connectionFilter).map(function(c){return c.source;});}function getTargets(shape,connectionFilter){return connectionFilter||(connectionFilter=noneFilter),shape.outgoing.filter(connectionFilter).map(function(c){return c.target;});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.getFlowNodePosition=getFlowNodePosition,exports.getFlowNodeDistance=getFlowNodeDistance,exports.getTextAnnotationPosition=getTextAnnotationPosition,exports.getDataElementPosition=getDataElementPosition,exports.getDefaultPosition=getDefaultPosition,exports.getConnectedAtPosition=getConnectedAtPosition,exports.deconflictPosition=deconflictPosition;var _ModelUtil=require('../../util/ModelUtil');var _LayoutUtil=require('diagram-js/lib/layout/LayoutUtil');var _minDash=require('min-dash');var DEFAULT_HORIZONTAL_DISTANCE=50;var MAX_HORIZONTAL_DISTANCE=250;var PLACEMENT_DETECTION_PAD=10;},{'../../util/ModelUtil':159,'diagram-js/lib/layout/LayoutUtil':317,'min-dash':438}],70:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _AutoPlace=require('./AutoPlace');var _AutoPlace2=_interopRequireDefault(_AutoPlace);var _AutoPlaceSelectionBehavior=require('./AutoPlaceSelectionBehavior');var _AutoPlaceSelectionBehavior2=_interopRequireDefault(_AutoPlaceSelectionBehavior);exports.default={__init__:['autoPlaceSelectionBehavior'],autoPlace:['type',_AutoPlace2.default],autoPlaceSelectionBehavior:['type',_AutoPlaceSelectionBehavior2.default]};},{'./AutoPlace':67,'./AutoPlaceSelectionBehavior':68}],71:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function BpmnAutoResize(injector){injector.invoke(_AutoResize2.default,this);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=BpmnAutoResize;var _AutoResize=require('diagram-js/lib/features/auto-resize/AutoResize');var _AutoResize2=_interopRequireDefault(_AutoResize);var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _ModelUtil=require('../../util/ModelUtil');BpmnAutoResize.$inject=['injector'],(0,_inherits2.default)(BpmnAutoResize,_AutoResize2.default),BpmnAutoResize.prototype.resize=function(target,newBounds){(0,_ModelUtil.is)(target,'bpmn:Participant')?this._modeling.resizeLane(target,newBounds):this._modeling.resizeShape(target,newBounds);};},{'../../util/ModelUtil':159,'diagram-js/lib/features/auto-resize/AutoResize':202,inherits:350}],72:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function BpmnAutoResizeProvider(eventBus,modeling){_AutoResizeProvider2.default.call(this,eventBus),this._modeling=modeling;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=BpmnAutoResizeProvider;var _ModelUtil=require('../../util/ModelUtil');var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _minDash=require('min-dash');var _AutoResizeProvider=require('diagram-js/lib/features/auto-resize/AutoResizeProvider');var _AutoResizeProvider2=_interopRequireDefault(_AutoResizeProvider);(0,_inherits2.default)(BpmnAutoResizeProvider,_AutoResizeProvider2.default),BpmnAutoResizeProvider.$inject=['eventBus','modeling'],BpmnAutoResizeProvider.prototype.canResize=function(elements,target){if(!((0,_ModelUtil.is)(target,'bpmn:Participant')||(0,_ModelUtil.is)(target,'bpmn:Lane')||(0,_ModelUtil.is)(target,'bpmn:SubProcess')))return!1;var canResize=!0;return(0,_minDash.forEach)(elements,function(element){if((0,_ModelUtil.is)(element,'bpmn:Lane')||element.labelTarget){canResize=!1;return;}}),canResize;};},{'../../util/ModelUtil':159,'diagram-js/lib/features/auto-resize/AutoResizeProvider':203,inherits:350,'min-dash':438}],73:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _BpmnAutoResize=require('./BpmnAutoResize');var _BpmnAutoResize2=_interopRequireDefault(_BpmnAutoResize);var _BpmnAutoResizeProvider=require('./BpmnAutoResizeProvider');var _BpmnAutoResizeProvider2=_interopRequireDefault(_BpmnAutoResizeProvider);exports.default={__init__:['bpmnAutoResize','bpmnAutoResizeProvider'],bpmnAutoResize:['type',_BpmnAutoResize2.default],bpmnAutoResizeProvider:['type',_BpmnAutoResizeProvider2.default]};},{'./BpmnAutoResize':71,'./BpmnAutoResizeProvider':72}],74:[function(require,module,exports){'use strict';function ContextPadProvider(config,injector,eventBus,contextPad,modeling,elementFactory,connect,create,popupMenu,canvas,rules,translate){config=config||{},contextPad.registerProvider(this),this._contextPad=contextPad,this._modeling=modeling,this._elementFactory=elementFactory,this._connect=connect,this._create=create,this._popupMenu=popupMenu,this._canvas=canvas,this._rules=rules,this._translate=translate,config.autoPlace!==!1&&(this._autoPlace=injector.get('autoPlace',!1)),eventBus.on('create.end',250,function(event){var shape=event.context.shape;if(!(0,_Mouse.hasPrimaryModifier)(event))return;var entries=contextPad.getEntries(shape);entries.replace&&entries.replace.action.click(event,shape);});}function isEventType(eventBo,type,definition){var isType=eventBo.$instanceOf(type);var isDefinition=!1;var definitions=eventBo.eventDefinitions||[];return(0,_minDash.forEach)(definitions,function(def){def.$type===definition&&(isDefinition=!0);}),isType&&isDefinition;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=ContextPadProvider;var _minDash=require('min-dash');var _ModelUtil=require('../../util/ModelUtil');var _DiUtil=require('../../util/DiUtil');var _ModelingUtil=require('../modeling/util/ModelingUtil');var _LaneUtil=require('../modeling/util/LaneUtil');var _Mouse=require('diagram-js/lib/util/Mouse');ContextPadProvider.$inject=['config.contextPad','injector','eventBus','contextPad','modeling','elementFactory','connect','create','popupMenu','canvas','rules','translate'],ContextPadProvider.prototype.getContextPadEntries=function(element){function startConnect(event,element){connect.start(event,element);}function removeElement(e){modeling.removeElements([element]);}function getReplaceMenuPosition(element){var Y_OFFSET=5;var diagramContainer=canvas.getContainer(),pad=contextPad.getPad(element).html;var diagramRect=diagramContainer.getBoundingClientRect(),padRect=pad.getBoundingClientRect();var top=padRect.top-diagramRect.top;var left=padRect.left-diagramRect.left;var pos={x:left,y:top+padRect.height+Y_OFFSET};return pos;}function appendAction(type,className,title,options){function appendStart(event,element){var shape=elementFactory.createShape((0,_minDash.assign)({type:type},options));create.start(event,shape,element);}typeof title!=='string'&&(options=title,title=translate('Append {type}',{type:type.replace(/^bpmn:/,'')}));var append=autoPlace?function(event,element){var shape=elementFactory.createShape((0,_minDash.assign)({type:type},options));autoPlace.append(element,shape);}:appendStart;return{group:'model',className:className,title:title,action:{dragstart:appendStart,click:append}};}function splitLaneHandler(count){return function(event,element){modeling.splitLane(element,count),contextPad.open(element,!0);};}var contextPad=this._contextPad,modeling=this._modeling,elementFactory=this._elementFactory,connect=this._connect,create=this._create,popupMenu=this._popupMenu,canvas=this._canvas,rules=this._rules,autoPlace=this._autoPlace,translate=this._translate;var actions={};if(element.type==='label')return actions;var businessObject=element.businessObject;if((0,_ModelingUtil.isAny)(businessObject,['bpmn:Lane','bpmn:Participant'])&&(0,_DiUtil.isExpanded)(businessObject)){var childLanes=(0,_LaneUtil.getChildLanes)(element);(0,_minDash.assign)(actions,{'lane-insert-above':{group:'lane-insert-above',className:'bpmn-icon-lane-insert-above',title:translate('Add Lane above'),action:{click:function click(event,element){modeling.addLane(element,'top');}}}}),childLanes.length<2&&(element.height>=120&&(0,_minDash.assign)(actions,{'lane-divide-two':{group:'lane-divide',className:'bpmn-icon-lane-divide-two',title:translate('Divide into two Lanes'),action:{click:splitLaneHandler(2)}}}),element.height>=180&&(0,_minDash.assign)(actions,{'lane-divide-three':{group:'lane-divide',className:'bpmn-icon-lane-divide-three',title:translate('Divide into three Lanes'),action:{click:splitLaneHandler(3)}}})),(0,_minDash.assign)(actions,{'lane-insert-below':{group:'lane-insert-below',className:'bpmn-icon-lane-insert-below',title:translate('Add Lane below'),action:{click:function click(event,element){modeling.addLane(element,'bottom');}}}});}(0,_ModelUtil.is)(businessObject,'bpmn:FlowNode')&&((0,_ModelUtil.is)(businessObject,'bpmn:EventBasedGateway')?(0,_minDash.assign)(actions,{'append.receive-task':appendAction('bpmn:ReceiveTask','bpmn-icon-receive-task'),'append.message-intermediate-event':appendAction('bpmn:IntermediateCatchEvent','bpmn-icon-intermediate-event-catch-message',{eventDefinitionType:'bpmn:MessageEventDefinition'}),'append.timer-intermediate-event':appendAction('bpmn:IntermediateCatchEvent','bpmn-icon-intermediate-event-catch-timer',{eventDefinitionType:'bpmn:TimerEventDefinition'}),'append.condtion-intermediate-event':appendAction('bpmn:IntermediateCatchEvent','bpmn-icon-intermediate-event-catch-condition',{eventDefinitionType:'bpmn:ConditionalEventDefinition'}),'append.signal-intermediate-event':appendAction('bpmn:IntermediateCatchEvent','bpmn-icon-intermediate-event-catch-signal',{eventDefinitionType:'bpmn:SignalEventDefinition'})}):isEventType(businessObject,'bpmn:BoundaryEvent','bpmn:CompensateEventDefinition')?(0,_minDash.assign)(actions,{'append.compensation-activity':appendAction('bpmn:Task','bpmn-icon-task',translate('Append compensation activity'),{isForCompensation:!0})}):(0,_ModelUtil.is)(businessObject,'bpmn:EndEvent')||businessObject.isForCompensation||isEventType(businessObject,'bpmn:IntermediateThrowEvent','bpmn:LinkEventDefinition')||(0,_DiUtil.isEventSubProcess)(businessObject)||(0,_minDash.assign)(actions,{'append.end-event':appendAction('bpmn:EndEvent','bpmn-icon-end-event-none'),'append.gateway':appendAction('bpmn:ExclusiveGateway','bpmn-icon-gateway-none',translate('Append Gateway')),'append.append-task':appendAction('bpmn:Task','bpmn-icon-task'),'append.intermediate-event':appendAction('bpmn:IntermediateThrowEvent','bpmn-icon-intermediate-event-none',translate('Append Intermediate/Boundary Event'))}));var replaceMenu;popupMenu._providers['bpmn-replace']&&(replaceMenu=popupMenu.create('bpmn-replace',element)),replaceMenu&&!replaceMenu.isEmpty()&&(0,_minDash.assign)(actions,{replace:{group:'edit',className:'bpmn-icon-screw-wrench',title:translate('Change type'),action:{click:function click(event,element){replaceMenu.open((0,_minDash.assign)(getReplaceMenuPosition(element),{cursor:{x:event.x,y:event.y}}),element);}}}}),(0,_ModelingUtil.isAny)(businessObject,['bpmn:FlowNode','bpmn:InteractionNode','bpmn:DataObjectReference','bpmn:DataStoreReference'])&&(0,_minDash.assign)(actions,{'append.text-annotation':appendAction('bpmn:TextAnnotation','bpmn-icon-text-annotation'),connect:{group:'connect',className:'bpmn-icon-connection-multi',title:translate('Connect using '+(businessObject.isForCompensation?'':'Sequence/MessageFlow or ')+'Association'),action:{click:startConnect,dragstart:startConnect}}}),(0,_ModelingUtil.isAny)(businessObject,['bpmn:DataObjectReference','bpmn:DataStoreReference'])&&(0,_minDash.assign)(actions,{connect:{group:'connect',className:'bpmn-icon-connection-multi',title:translate('Connect using DataInputAssociation'),action:{click:startConnect,dragstart:startConnect}}});var deleteAllowed=rules.allowed('elements.delete',{elements:[element]});return(0,_minDash.isArray)(deleteAllowed)&&(deleteAllowed=deleteAllowed[0]===element),deleteAllowed&&(0,_minDash.assign)(actions,{'delete':{group:'edit',className:'bpmn-icon-trash',title:translate('Remove'),action:{click:removeElement}}}),actions;};},{'../../util/DiUtil':157,'../../util/ModelUtil':159,'../modeling/util/LaneUtil':131,'../modeling/util/ModelingUtil':132,'diagram-js/lib/util/Mouse':338,'min-dash':438}],75:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _diagramJsDirectEditing=require('diagram-js-direct-editing');var _diagramJsDirectEditing2=_interopRequireDefault(_diagramJsDirectEditing);var _contextPad=require('diagram-js/lib/features/context-pad');var _contextPad2=_interopRequireDefault(_contextPad);var _selection=require('diagram-js/lib/features/selection');var _selection2=_interopRequireDefault(_selection);var _connect=require('diagram-js/lib/features/connect');var _connect2=_interopRequireDefault(_connect);var _create=require('diagram-js/lib/features/create');var _create2=_interopRequireDefault(_create);var _popupMenu=require('../popup-menu');var _popupMenu2=_interopRequireDefault(_popupMenu);var _ContextPadProvider=require('./ContextPadProvider');var _ContextPadProvider2=_interopRequireDefault(_ContextPadProvider);exports.default={__depends__:[_diagramJsDirectEditing2.default,_contextPad2.default,_selection2.default,_connect2.default,_create2.default,_popupMenu2.default],__init__:['contextPadProvider'],contextPadProvider:['type',_ContextPadProvider2.default]};},{'../popup-menu':138,'./ContextPadProvider':74,'diagram-js-direct-editing':180,'diagram-js/lib/features/connect':217,'diagram-js/lib/features/context-pad':219,'diagram-js/lib/features/create':223,'diagram-js/lib/features/selection':298}],76:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function setProperties(descriptor,data,properties){(0,_minDash.forEach)(properties,function(property){data[property]!==undefined&&(descriptor[property]=data[property]);});}function removeProperties(element,properties){(0,_minDash.forEach)(properties,function(prop){element[prop]&&delete element[prop];});}function BpmnCopyPaste(bpmnFactory,eventBus,copyPaste,clipboard,canvas,bpmnRules){var helper=new _ModelCloneHelper2.default(eventBus,bpmnFactory);copyPaste.registerDescriptor(function(element,descriptor){var businessObject=descriptor.oldBusinessObject=(0,_ModelUtil.getBusinessObject)(element);var colors={};return descriptor.type=element.type,setProperties(descriptor,businessObject.di,['isExpanded']),setProperties(colors,businessObject.di,['fill','stroke']),descriptor.colors=colors,element.type==='label'?descriptor:(setProperties(descriptor,businessObject,['processRef','triggeredByEvent']),businessObject.default&&(descriptor.default=businessObject.default.id),descriptor);}),eventBus.on('element.paste',function(context){var descriptor=context.descriptor,createdElements=context.createdElements,parent=descriptor.parent,rootElement=canvas.getRootElement(),oldBusinessObject=descriptor.oldBusinessObject,newBusinessObject,source,target,canConnect;newBusinessObject=bpmnFactory.create(oldBusinessObject.$type);var properties=(0,_ModelCloneUtils.getProperties)(oldBusinessObject.$descriptor);if(properties=(0,_minDash.filter)(properties,function(property){return _ModelCloneUtils.IGNORED_PROPERTIES.indexOf(property.replace(/bpmn:/,''))===-1;}),descriptor.businessObject=helper.clone(oldBusinessObject,newBusinessObject,properties),descriptor.type==='label')return;(0,_ModelUtil.is)(parent,'bpmn:Process')&&(descriptor.parent=(0,_ModelUtil.is)(rootElement,'bpmn:Collaboration')?rootElement:parent),(descriptor.type==='bpmn:DataOutputAssociation'||descriptor.type==='bpmn:DataInputAssociation'||descriptor.type==='bpmn:MessageFlow')&&(descriptor.parent=rootElement),(0,_ModelUtil.is)(parent,'bpmn:Lane')&&(descriptor.parent=parent.parent),descriptor.waypoints&&(source=createdElements[descriptor.source],target=createdElements[descriptor.target],source&&target&&(source=source.element,target=target.element),canConnect=bpmnRules.canConnect(source,target),canConnect&&(descriptor.type=canConnect.type)),delete newBusinessObject.id,bpmnFactory._ensureId(newBusinessObject),descriptor.type==='bpmn:Participant'&&descriptor.processRef&&(descriptor.processRef=newBusinessObject.processRef=bpmnFactory.create('bpmn:Process')),setProperties(newBusinessObject,descriptor,['isExpanded','triggeredByEvent']),removeProperties(descriptor,['triggeredByEvent']);});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=BpmnCopyPaste;var _ModelUtil=require('../../util/ModelUtil');var _ModelCloneHelper=require('../../util/model/ModelCloneHelper');var _ModelCloneHelper2=_interopRequireDefault(_ModelCloneHelper);var _ModelCloneUtils=require('../../util/model/ModelCloneUtils');var _minDash=require('min-dash');BpmnCopyPaste.$inject=['bpmnFactory','eventBus','copyPaste','clipboard','canvas','bpmnRules'];},{'../../util/ModelUtil':159,'../../util/model/ModelCloneHelper':161,'../../util/model/ModelCloneUtils':162,'min-dash':438}],77:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _copyPaste=require('diagram-js/lib/features/copy-paste');var _copyPaste2=_interopRequireDefault(_copyPaste);var _BpmnCopyPaste=require('./BpmnCopyPaste');var _BpmnCopyPaste2=_interopRequireDefault(_BpmnCopyPaste);exports.default={__depends__:[_copyPaste2.default],__init__:['bpmnCopyPaste'],bpmnCopyPaste:['type',_BpmnCopyPaste2.default]};},{'./BpmnCopyPaste':76,'diagram-js/lib/features/copy-paste':221}],78:[function(require,module,exports){'use strict';function BpmnDistributeElements(distributeElements){distributeElements.registerFilter(function(elements){return(0,_minDash.filter)(elements,function(element){var cannotDistribute=(0,_ModelingUtil.isAny)(element,['bpmn:Association','bpmn:BoundaryEvent','bpmn:DataInputAssociation','bpmn:DataOutputAssociation','bpmn:Lane','bpmn:MessageFlow','bpmn:Participant','bpmn:SequenceFlow','bpmn:TextAnnotation']);return!(element.labelTarget||cannotDistribute);});});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=BpmnDistributeElements;var _minDash=require('min-dash');var _ModelingUtil=require('../modeling/util/ModelingUtil');BpmnDistributeElements.$inject=['distributeElements'];},{'../modeling/util/ModelingUtil':132,'min-dash':438}],79:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _distributeElements=require('diagram-js/lib/features/distribute-elements');var _distributeElements2=_interopRequireDefault(_distributeElements);var _BpmnDistributeElements=require('./BpmnDistributeElements');var _BpmnDistributeElements2=_interopRequireDefault(_BpmnDistributeElements);exports.default={__depends__:[_distributeElements2.default],__init__:['bpmnDistributeElements'],bpmnDistributeElements:['type',_BpmnDistributeElements2.default]};},{'./BpmnDistributeElements':78,'diagram-js/lib/features/distribute-elements':225}],80:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function BpmnEditorActions(injector,canvas,elementRegistry,selection,_spaceTool,_lassoTool,_handTool,globalConnect,_distributeElements,_alignElements,_directEditing,searchPad,modeling){injector.invoke(_EditorActions2.default,this),this.register({selectElements:function selectElements(){var rootElement=canvas.getRootElement();var elements=elementRegistry.filter(function(element){return element!==rootElement;});return selection.select(elements),elements;},spaceTool:function spaceTool(){_spaceTool.toggle();},lassoTool:function lassoTool(){_lassoTool.toggle();},handTool:function handTool(){_handTool.toggle();},globalConnectTool:function globalConnectTool(){globalConnect.toggle();},distributeElements:function distributeElements(opts){var currentSelection=selection.get(),type=opts.type;currentSelection.length&&_distributeElements.trigger(currentSelection,type);},alignElements:function alignElements(opts){var currentSelection=selection.get(),aligneableElements=[],type=opts.type;currentSelection.length&&(aligneableElements=(0,_minDash.filter)(currentSelection,function(element){return!(0,_ModelUtil.is)(element,'bpmn:Lane');}),_alignElements.trigger(aligneableElements,type));},setColor:function setColor(opts){var currentSelection=selection.get();currentSelection.length&&modeling.setColor(currentSelection,opts);},directEditing:function directEditing(){var currentSelection=selection.get();currentSelection.length&&_directEditing.activate(currentSelection[0]);},find:function find(){searchPad.toggle();},moveToOrigin:function moveToOrigin(){var rootElement=canvas.getRootElement(),boundingBox,elements;(0,_ModelUtil.is)(rootElement,'bpmn:Collaboration')?elements=elementRegistry.filter(function(element){return(0,_ModelUtil.is)(element.parent,'bpmn:Collaboration');}):elements=elementRegistry.filter(function(element){return element!==rootElement&&!(0,_ModelUtil.is)(element.parent,'bpmn:SubProcess');}),boundingBox=(0,_Elements.getBBox)(elements),modeling.moveElements(elements,{x:-boundingBox.x,y:-boundingBox.y},rootElement);}});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=undefined;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _EditorActions=require('diagram-js/lib/features/editor-actions/EditorActions');var _EditorActions2=_interopRequireDefault(_EditorActions);var _minDash=require('min-dash');var _ModelUtil=require('../../util/ModelUtil');var _Elements=require('diagram-js/lib/util/Elements');exports.default=BpmnEditorActions,(0,_inherits2.default)(BpmnEditorActions,_EditorActions2.default),BpmnEditorActions.$inject=['injector','canvas','elementRegistry','selection','spaceTool','lassoTool','handTool','globalConnect','distributeElements','alignElements','directEditing','searchPad','modeling'];},{'../../util/ModelUtil':159,'diagram-js/lib/features/editor-actions/EditorActions':229,'diagram-js/lib/util/Elements':331,inherits:350,'min-dash':438}],81:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _alignElements=require('diagram-js/lib/features/align-elements');var _alignElements2=_interopRequireDefault(_alignElements);var _editorActions=require('diagram-js/lib/features/editor-actions');var _editorActions2=_interopRequireDefault(_editorActions);var _handTool=require('diagram-js/lib/features/hand-tool');var _handTool2=_interopRequireDefault(_handTool);var _lassoTool=require('diagram-js/lib/features/lasso-tool');var _lassoTool2=_interopRequireDefault(_lassoTool);var _spaceTool=require('diagram-js/lib/features/space-tool');var _spaceTool2=_interopRequireDefault(_spaceTool);var _diagramJsDirectEditing=require('diagram-js-direct-editing');var _diagramJsDirectEditing2=_interopRequireDefault(_diagramJsDirectEditing);var _globalConnect=require('../global-connect');var _globalConnect2=_interopRequireDefault(_globalConnect);var _copyPaste=require('../copy-paste');var _copyPaste2=_interopRequireDefault(_copyPaste);var _distributeElements=require('../distribute-elements');var _distributeElements2=_interopRequireDefault(_distributeElements);var _search=require('../search');var _search2=_interopRequireDefault(_search);var _BpmnEditorActions=require('./BpmnEditorActions');var _BpmnEditorActions2=_interopRequireDefault(_BpmnEditorActions);exports.default={__depends__:[_alignElements2.default,_editorActions2.default,_handTool2.default,_lassoTool2.default,_spaceTool2.default,_diagramJsDirectEditing2.default,_globalConnect2.default,_copyPaste2.default,_distributeElements2.default,_search2.default],editorActions:['type',_BpmnEditorActions2.default]};},{'../copy-paste':77,'../distribute-elements':79,'../global-connect':83,'../search':148,'./BpmnEditorActions':80,'diagram-js-direct-editing':180,'diagram-js/lib/features/align-elements':199,'diagram-js/lib/features/editor-actions':230,'diagram-js/lib/features/hand-tool':234,'diagram-js/lib/features/lasso-tool':242,'diagram-js/lib/features/space-tool':305}],82:[function(require,module,exports){'use strict';function BpmnGlobalConnect(globalConnect){globalConnect.registerProvider(this);}function nonExistantOrLabel(element){return!element||isLabel(element);}function isLabel(element){return element.labelTarget;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=BpmnGlobalConnect;var _ModelingUtil=require('../modeling/util/ModelingUtil');BpmnGlobalConnect.$inject=['globalConnect'],BpmnGlobalConnect.prototype.canStartConnect=function(source){if(nonExistantOrLabel(source))return null;var businessObject=source.businessObject;return(0,_ModelingUtil.isAny)(businessObject,['bpmn:FlowNode','bpmn:InteractionNode','bpmn:DataObjectReference','bpmn:DataStoreReference']);};},{'../modeling/util/ModelingUtil':132}],83:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _globalConnect=require('diagram-js/lib/features/global-connect');var _globalConnect2=_interopRequireDefault(_globalConnect);var _BpmnGlobalConnect=require('./BpmnGlobalConnect');var _BpmnGlobalConnect2=_interopRequireDefault(_BpmnGlobalConnect);exports.default={__depends__:[_globalConnect2.default],__init__:['bpmnGlobalConnect'],bpmnGlobalConnect:['type',_BpmnGlobalConnect2.default]};},{'./BpmnGlobalConnect':82,'diagram-js/lib/features/global-connect':232}],84:[function(require,module,exports){'use strict';function BpmnKeyBindings(keyboard,editorActions){keyboard.addListener(function(key,modifiers){return key===65&&keyboard.isCmd(modifiers)?(editorActions.trigger('selectElements'),!0):key===70&&keyboard.isCmd(modifiers)?(editorActions.trigger('find'),!0):keyboard.hasModifier(modifiers)?void 0:key===83?(editorActions.trigger('spaceTool'),!0):key===76?(editorActions.trigger('lassoTool'),!0):key===72?(editorActions.trigger('handTool'),!0):key===67?(editorActions.trigger('globalConnectTool'),!0):key===69?(editorActions.trigger('directEditing'),!0):void 0;});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=BpmnKeyBindings,BpmnKeyBindings.$inject=['keyboard','editorActions'];},{}],85:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _keyboard=require('diagram-js/lib/features/keyboard');var _keyboard2=_interopRequireDefault(_keyboard);var _BpmnKeyBindings=require('./BpmnKeyBindings');var _BpmnKeyBindings2=_interopRequireDefault(_BpmnKeyBindings);exports.default={__depends__:[_keyboard2.default],__init__:['bpmnKeyBindings'],bpmnKeyBindings:['type',_BpmnKeyBindings2.default]};},{'./BpmnKeyBindings':84,'diagram-js/lib/features/keyboard':238}],86:[function(require,module,exports){'use strict';function LabelEditingPreview(eventBus,canvas,elementRegistry,pathMap){var self=this;var defaultLayer=canvas.getDefaultLayer();var element,absoluteElementBBox,gfx;eventBus.on('directEditing.activate',function(context){var activeProvider=context.active;if(element=activeProvider.element.label||activeProvider.element,(0,_ModelUtil.is)(element,'bpmn:TextAnnotation')){absoluteElementBBox=canvas.getAbsoluteBBox(element),gfx=(0,_tinySvg.create)('g');var textPathData=pathMap.getScaledPath('TEXT_ANNOTATION',{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:0,my:0}});var path=self.path=(0,_tinySvg.create)('path');(0,_tinySvg.attr)(path,{d:textPathData,strokeWidth:2,stroke:getStrokeColor(element)}),(0,_tinySvg.append)(gfx,path),(0,_tinySvg.append)(defaultLayer,gfx),(0,_SvgTransformUtil.translate)(gfx,element.x,element.y);}(0,_ModelUtil.is)(element,'bpmn:TextAnnotation')||element.labelTarget?canvas.addMarker(element,MARKER_HIDDEN):((0,_ModelUtil.is)(element,'bpmn:Task')||(0,_ModelUtil.is)(element,'bpmn:CallActivity')||(0,_ModelUtil.is)(element,'bpmn:SubProcess')||(0,_ModelUtil.is)(element,'bpmn:Participant'))&&canvas.addMarker(element,MARKER_LABEL_HIDDEN);}),eventBus.on('directEditing.resize',function(context){if((0,_ModelUtil.is)(element,'bpmn:TextAnnotation')){var height=context.height,dy=context.dy;var newElementHeight=Math.max(element.height/absoluteElementBBox.height*(height+dy),0);var textPathData=pathMap.getScaledPath('TEXT_ANNOTATION',{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:newElementHeight,position:{mx:0,my:0}});(0,_tinySvg.attr)(self.path,{d:textPathData});}}),eventBus.on(['directEditing.complete','directEditing.cancel'],function(context){var activeProvider=context.active;activeProvider&&(canvas.removeMarker(activeProvider.element.label||activeProvider.element,MARKER_HIDDEN),canvas.removeMarker(element,MARKER_LABEL_HIDDEN)),element=undefined,absoluteElementBBox=undefined,gfx&&((0,_tinySvg.remove)(gfx),gfx=undefined);});}function getStrokeColor(element,defaultColor){var bo=(0,_ModelUtil.getBusinessObject)(element);return bo.di.get('stroke')||defaultColor||'black';}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=LabelEditingPreview;var _tinySvg=require('tiny-svg');var _ModelUtil=require('../../util/ModelUtil');var _SvgTransformUtil=require('diagram-js/lib/util/SvgTransformUtil');var MARKER_HIDDEN='djs-element-hidden',MARKER_LABEL_HIDDEN='djs-label-hidden';LabelEditingPreview.$inject=['eventBus','canvas','elementRegistry','pathMap'];},{'../../util/ModelUtil':159,'diagram-js/lib/util/SvgTransformUtil':343,'tiny-svg':468}],87:[function(require,module,exports){'use strict';function LabelEditingProvider(eventBus,canvas,directEditing,modeling,resizeHandles){function activateDirectEdit(element,force){(force||(0,_ModelingUtil.isAny)(element,['bpmn:Task','bpmn:TextAnnotation'])||isCollapsedSubProcess(element))&&directEditing.activate(element);}this._canvas=canvas,this._modeling=modeling,directEditing.registerProvider(this),eventBus.on('element.dblclick',function(event){activateDirectEdit(event.element,!0);}),eventBus.on(['element.mousedown','drag.init','canvas.viewbox.changing','autoPlace','popupMenu.open'],function(event){directEditing.isActive()&&directEditing.complete();}),eventBus.on(['commandStack.changed'],function(e){directEditing.isActive()&&directEditing.cancel();}),eventBus.on('directEditing.activate',function(event){resizeHandles.removeResizers();}),eventBus.on('create.end',500,function(event){var element=event.shape,canExecute=event.context.canExecute,isTouch=event.isTouch;if(isTouch)return;if(!canExecute)return;activateDirectEdit(element);}),eventBus.on('autoPlace.end',500,function(event){activateDirectEdit(event.shape);});}function isCollapsedSubProcess(element){return(0,_ModelUtil.is)(element,'bpmn:SubProcess')&&!(0,_DiUtil.isExpanded)(element);}function isExpandedSubProcess(element){return(0,_ModelUtil.is)(element,'bpmn:SubProcess')&&(0,_DiUtil.isExpanded)(element);}function isCollapsedPool(element){return(0,_ModelUtil.is)(element,'bpmn:Participant')&&!(0,_DiUtil.isExpanded)(element);}function isExpandedPool(element){return(0,_ModelUtil.is)(element,'bpmn:Participant')&&(0,_DiUtil.isExpanded)(element);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=LabelEditingProvider;var _minDash=require('min-dash');var _LabelUtil=require('./LabelUtil');var _ModelUtil=require('../../util/ModelUtil');var _ModelingUtil=require('../modeling/util/ModelingUtil');var _DiUtil=require('../../util/DiUtil');var SMALL_FONT_SIZE=11,SMALL_LINE_HEIGHT=13,MEDIUM_FONT_SIZE=12,MEDIUM_LINE_HEIGHT=14;LabelEditingProvider.$inject=['eventBus','canvas','directEditing','modeling','resizeHandles'],LabelEditingProvider.prototype.activate=function(element){var text=(0,_LabelUtil.getLabel)(element);if(text===undefined)return;var context={text:text};var bounds=this.getEditingBBox(element);(0,_minDash.assign)(context,bounds);var target=element.label||element;var options={};return((0,_ModelingUtil.isAny)(element,['bpmn:Task','bpmn:Participant','bpmn:Lane','bpmn:CallActivity'])||isCollapsedSubProcess(element))&&(0,_minDash.assign)(options,{centerVertically:!0}),target.labelTarget&&(0,_minDash.assign)(options,{autoResize:!0}),(0,_ModelUtil.is)(element,'bpmn:TextAnnotation')&&(0,_minDash.assign)(options,{resizable:!0,autoResize:!0}),(0,_minDash.assign)(context,{options:options}),context;},LabelEditingProvider.prototype.getEditingBBox=function(element){var canvas=this._canvas;var target=element.label||element;var bbox=canvas.getAbsoluteBBox(target);var mid={x:bbox.x+bbox.width/2,y:bbox.y+bbox.height/2};var bounds={x:bbox.x,y:bbox.y};var zoom=canvas.zoom();var smallFontSize=SMALL_FONT_SIZE*zoom,smallLineHeight=SMALL_LINE_HEIGHT*zoom,mediumFontSize=MEDIUM_FONT_SIZE*zoom,mediumLineHeight=MEDIUM_LINE_HEIGHT*zoom;var style={};if(((0,_ModelUtil.is)(element,'bpmn:Lane')||isExpandedPool(element))&&((0,_minDash.assign)(bounds,{width:bbox.height,height:30*zoom,x:bbox.x-bbox.height/2+15*zoom,y:mid.y-30*zoom/2}),(0,_minDash.assign)(style,{fontSize:mediumFontSize+'px',lineHeight:mediumLineHeight+'px',paddingTop:7*zoom+'px',paddingBottom:7*zoom+'px',paddingLeft:5*zoom+'px',paddingRight:5*zoom+'px',transform:'rotate(-90deg)'})),((0,_ModelingUtil.isAny)(element,['bpmn:Task','bpmn:CallActivity'])||isCollapsedPool(element)||isCollapsedSubProcess(element))&&((0,_minDash.assign)(bounds,{width:bbox.width,height:bbox.height}),(0,_minDash.assign)(style,{fontSize:mediumFontSize+'px',lineHeight:mediumLineHeight+'px',paddingTop:7*zoom+'px',paddingBottom:7*zoom+'px',paddingLeft:5*zoom+'px',paddingRight:5*zoom+'px'})),isExpandedSubProcess(element)&&((0,_minDash.assign)(bounds,{width:bbox.width,x:bbox.x}),(0,_minDash.assign)(style,{fontSize:mediumFontSize+'px',lineHeight:mediumLineHeight+'px',paddingTop:7*zoom+'px',paddingBottom:7*zoom+'px',paddingLeft:5*zoom+'px',paddingRight:5*zoom+'px'})),target.labelTarget){var width=90*zoom,paddingTop=7*zoom,paddingBottom=4*zoom;(0,_minDash.assign)(bounds,{width:width,height:bbox.height+paddingTop+paddingBottom,x:mid.x-width/2,y:bbox.y-paddingTop}),(0,_minDash.assign)(style,{fontSize:smallFontSize+'px',lineHeight:smallLineHeight+'px',paddingTop:paddingTop+'px',paddingBottom:paddingBottom+'px'});}return(0,_ModelUtil.is)(element,'bpmn:TextAnnotation')&&((0,_minDash.assign)(bounds,{width:bbox.width,height:bbox.height,minWidth:30*zoom,minHeight:10*zoom}),(0,_minDash.assign)(style,{textAlign:'left',paddingTop:7*zoom+'px',paddingBottom:7*zoom+'px',paddingLeft:5*zoom+'px',paddingRight:5*zoom+'px',fontSize:mediumFontSize+'px',lineHeight:mediumLineHeight+'px'})),{bounds:bounds,style:style};},LabelEditingProvider.prototype.update=function(element,newLabel,activeContextText,bounds){var newBounds,bbox;(0,_ModelUtil.is)(element,'bpmn:TextAnnotation')&&(bbox=this._canvas.getAbsoluteBBox(element),newBounds={x:element.x,y:element.y,width:element.width/bbox.width*bounds.width,height:element.height/bbox.height*bounds.height}),this._modeling.updateLabel(element,newLabel,newBounds);};},{'../../util/DiUtil':157,'../../util/ModelUtil':159,'../modeling/util/ModelingUtil':132,'./LabelUtil':88,'min-dash':438}],88:[function(require,module,exports){'use strict';function getLabelAttr(semantic){return(0,_ModelUtil.is)(semantic,'bpmn:FlowElement')||(0,_ModelUtil.is)(semantic,'bpmn:Participant')||(0,_ModelUtil.is)(semantic,'bpmn:Lane')||(0,_ModelUtil.is)(semantic,'bpmn:SequenceFlow')||(0,_ModelUtil.is)(semantic,'bpmn:MessageFlow')?'name':(0,_ModelUtil.is)(semantic,'bpmn:TextAnnotation')?'text':void 0;}function getLabel(element){var semantic=element.businessObject,attr=getLabelAttr(semantic);return attr?semantic[attr]||'':void 0;}function setLabel(element,text,isExternal){var semantic=element.businessObject,attr=getLabelAttr(semantic);return attr&&(semantic[attr]=text),isExternal&&(element.hidden=!text),element;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.getLabel=getLabel,exports.setLabel=setLabel;var _ModelUtil=require('../../util/ModelUtil');},{'../../util/ModelUtil':159}],89:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function UpdateLabelHandler(modeling){function setText(element,text){var label=element.label||element;var labelTarget=element.labelTarget||element;return(0,_LabelUtil.setLabel)(label,text,labelTarget!==label),[label,labelTarget];}function execute(ctx){return ctx.oldLabel=(0,_LabelUtil.getLabel)(ctx.element),setText(ctx.element,ctx.newLabel);}function revert(ctx){return setText(ctx.element,ctx.oldLabel);}function postExecute(ctx){var element=ctx.element,label=element.label||element,newBounds=ctx.newBounds;if(!((0,_LabelUtil2.hasExternalLabel)(element)||(0,_ModelUtil.is)(element,'bpmn:TextAnnotation')))return;var bo=(0,_ModelUtil.getBusinessObject)(label);var text=bo.name||bo.text;if(!text)return;newBounds===void 0&&(newBounds=getLayoutedBounds(label,text,textUtil)),newBounds&&modeling.resizeShape(label,newBounds,NULL_DIMENSIONS);}var textUtil=new _Text2.default();this.execute=execute,this.revert=revert,this.postExecute=postExecute;}function getLayoutedBounds(bounds,text,textUtil){var layoutedLabelDimensions=textUtil.getDimensions(text,{box:{width:90,height:30,x:bounds.width/2+bounds.x,y:bounds.height/2+bounds.y},style:EXTERNAL_LABEL_STYLE});return{x:Math.round(bounds.x+bounds.width/2-layoutedLabelDimensions.width/2),y:Math.round(bounds.y),width:Math.ceil(layoutedLabelDimensions.width),height:Math.ceil(layoutedLabelDimensions.height)};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=UpdateLabelHandler;var _LabelUtil=require('../LabelUtil');var _Text=require('diagram-js/lib/util/Text');var _Text2=_interopRequireDefault(_Text);var _LabelUtil2=require('../../../util/LabelUtil');var _ModelUtil=require('../../../util/ModelUtil');var NULL_DIMENSIONS={width:0,height:0};UpdateLabelHandler.$inject=['modeling'];var EXTERNAL_LABEL_STYLE={fontFamily:'Arial, sans-serif',fontSize:'11px'};},{'../../../util/LabelUtil':158,'../../../util/ModelUtil':159,'../LabelUtil':88,'diagram-js/lib/util/Text':344}],90:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _changeSupport=require('diagram-js/lib/features/change-support');var _changeSupport2=_interopRequireDefault(_changeSupport);var _resize=require('diagram-js/lib/features/resize');var _resize2=_interopRequireDefault(_resize);var _diagramJsDirectEditing=require('diagram-js-direct-editing');var _diagramJsDirectEditing2=_interopRequireDefault(_diagramJsDirectEditing);var _LabelEditingProvider=require('./LabelEditingProvider');var _LabelEditingProvider2=_interopRequireDefault(_LabelEditingProvider);var _LabelEditingPreview=require('./LabelEditingPreview');var _LabelEditingPreview2=_interopRequireDefault(_LabelEditingPreview);exports.default={__depends__:[_changeSupport2.default,_resize2.default,_diagramJsDirectEditing2.default],__init__:['labelEditingProvider','labelEditingPreview'],labelEditingProvider:['type',_LabelEditingProvider2.default],labelEditingPreview:['type',_LabelEditingPreview2.default]};},{'./LabelEditingPreview':86,'./LabelEditingProvider':87,'diagram-js-direct-editing':180,'diagram-js/lib/features/change-support':213,'diagram-js/lib/features/resize':289}],91:[function(require,module,exports){'use strict';function BpmnFactory(moddle){this._model=moddle;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=BpmnFactory;var _minDash=require('min-dash');BpmnFactory.$inject=['moddle'],BpmnFactory.prototype._needsId=function(element){return element.$instanceOf('bpmn:RootElement')||element.$instanceOf('bpmn:FlowElement')||element.$instanceOf('bpmn:MessageFlow')||element.$instanceOf('bpmn:DataAssociation')||element.$instanceOf('bpmn:Artifact')||element.$instanceOf('bpmn:Participant')||element.$instanceOf('bpmn:Lane')||element.$instanceOf('bpmn:Process')||element.$instanceOf('bpmn:Collaboration')||element.$instanceOf('bpmndi:BPMNShape')||element.$instanceOf('bpmndi:BPMNEdge')||element.$instanceOf('bpmndi:BPMNDiagram')||element.$instanceOf('bpmndi:BPMNPlane')||element.$instanceOf('bpmn:Property');},BpmnFactory.prototype._ensureId=function(element){var prefix=(element.$type||'').replace(/^[^:]*:/g,'')+'_';!element.id&&this._needsId(element)&&(element.id=this._model.ids.nextPrefixed(prefix,element));},BpmnFactory.prototype.create=function(type,attrs){var element=this._model.create(type,attrs||{});return this._ensureId(element),element;},BpmnFactory.prototype.createDiLabel=function(){return this.create('bpmndi:BPMNLabel',{bounds:this.createDiBounds()});},BpmnFactory.prototype.createDiShape=function(semantic,bounds,attrs){return this.create('bpmndi:BPMNShape',(0,_minDash.assign)({bpmnElement:semantic,bounds:this.createDiBounds(bounds)},attrs));},BpmnFactory.prototype.createDiBounds=function(bounds){return this.create('dc:Bounds',bounds);},BpmnFactory.prototype.createDiWaypoints=function(waypoints){var self=this;return(0,_minDash.map)(waypoints,function(pos){return self.createDiWaypoint(pos);});},BpmnFactory.prototype.createDiWaypoint=function(point){return this.create('dc:Point',(0,_minDash.pick)(point,['x','y']));},BpmnFactory.prototype.createDiEdge=function(semantic,waypoints,attrs){return this.create('bpmndi:BPMNEdge',(0,_minDash.assign)({bpmnElement:semantic},attrs));},BpmnFactory.prototype.createDiPlane=function(semantic){return this.create('bpmndi:BPMNPlane',{bpmnElement:semantic});};},{'min-dash':438}],92:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function BpmnLayouter(){}function getAttachOrientation(attachedElement){var hostElement=attachedElement.host,padding=-10;return(0,_LayoutUtil.getOrientation)((0,_LayoutUtil.getMid)(attachedElement),hostElement,padding);}function getConnectionDocking(point,shape){return point?point.original||point:(0,_LayoutUtil.getMid)(shape);}function isCompensationAssociation(connection){var source=connection.source,target=connection.target;return(0,_ModelUtil.is)(target,'bpmn:Activity')&&(0,_ModelUtil.is)(source,'bpmn:BoundaryEvent')&&target.businessObject.isForCompensation;}function isExpandedSubProcess(element){return(0,_ModelUtil.is)(element,'bpmn:SubProcess')&&(0,_DiUtil.isExpanded)(element);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=BpmnLayouter;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _minDash=require('min-dash');var _BaseLayouter=require('diagram-js/lib/layout/BaseLayouter');var _BaseLayouter2=_interopRequireDefault(_BaseLayouter);var _ManhattanLayout=require('diagram-js/lib/layout/ManhattanLayout');var _LayoutUtil=require('diagram-js/lib/layout/LayoutUtil');var _Geometry=require('diagram-js/lib/util/Geometry');var _DiUtil=require('../../util/DiUtil');var _ModelUtil=require('../../util/ModelUtil');(0,_inherits2.default)(BpmnLayouter,_BaseLayouter2.default),BpmnLayouter.prototype.layoutConnection=function(connection,hints){hints=hints||{};var source=connection.source,target=connection.target,waypoints=connection.waypoints,start=hints.connectionStart,end=hints.connectionEnd;var manhattanOptions,updatedWaypoints;if(start||(start=getConnectionDocking(waypoints&&waypoints[0],source)),end||(end=getConnectionDocking(waypoints&&waypoints[waypoints.length-1],target)),((0,_ModelUtil.is)(connection,'bpmn:Association')||(0,_ModelUtil.is)(connection,'bpmn:DataAssociation'))&&waypoints&&!isCompensationAssociation(connection))return[].concat([start],waypoints.slice(1,-1),[end]);if((0,_ModelUtil.is)(connection,'bpmn:MessageFlow'))manhattanOptions={preferredLayouts:['v:v']},(0,_ModelUtil.is)(target,'bpmn:Participant')&&(manhattanOptions={preferredLayouts:['straight','v:v']}),isExpandedSubProcess(target)&&(manhattanOptions={preferredLayouts:['straight','v:v']}),isExpandedSubProcess(source)&&(0,_ModelUtil.is)(target,'bpmn:FlowNode')&&(manhattanOptions={preferredLayouts:['straight','v:v'],preserveDocking:isExpandedSubProcess(target)?'source':'target'}),(0,_ModelUtil.is)(source,'bpmn:Participant')&&(0,_ModelUtil.is)(target,'bpmn:FlowNode')&&(manhattanOptions={preferredLayouts:['straight','v:v'],preserveDocking:'target'}),(0,_ModelUtil.is)(target,'bpmn:Event')&&(manhattanOptions={preferredLayouts:['v:v']});else if((0,_ModelUtil.is)(connection,'bpmn:SequenceFlow')||isCompensationAssociation(connection))if((0,_ModelUtil.is)(source,'bpmn:BoundaryEvent')){var orientation=getAttachOrientation(source);/left|right/.test(orientation)?manhattanOptions={preferredLayouts:['h:v']}:/top|bottom/.test(orientation)&&(manhattanOptions={preferredLayouts:['v:h']});}else(0,_ModelUtil.is)(source,'bpmn:Gateway')?manhattanOptions={preferredLayouts:['v:h']}:(0,_ModelUtil.is)(target,'bpmn:Gateway')?manhattanOptions={preferredLayouts:['h:v']}:manhattanOptions={preferredLayouts:['h:h']};return manhattanOptions&&(manhattanOptions=(0,_minDash.assign)(manhattanOptions,hints),updatedWaypoints=(0,_ManhattanLayout.repairConnection)(source,target,start,end,waypoints,manhattanOptions),updatedWaypoints=updatedWaypoints&&updatedWaypoints.reduce(function(points,p,idx){var previous=points[points.length-1],next=updatedWaypoints[idx+1];return(0,_Geometry.pointsOnLine)(previous,next,p,0)||points.push(p),points;},[])),updatedWaypoints||[start,end];};},{'../../util/DiUtil':157,'../../util/ModelUtil':159,'diagram-js/lib/layout/BaseLayouter':315,'diagram-js/lib/layout/LayoutUtil':317,'diagram-js/lib/layout/ManhattanLayout':318,'diagram-js/lib/util/Geometry':333,inherits:350,'min-dash':438}],93:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function BpmnUpdater(eventBus,bpmnFactory,connectionDocking,translate){function cropConnection(e){var context=e.context,connection;context.cropped||(connection=context.connection,connection.waypoints=connectionDocking.getCroppedWaypoints(connection),context.cropped=!0);}function updateParent(e){var context=e.context;self.updateParent(context.shape||context.connection,context.oldParent);}function reverseUpdateParent(e){var context=e.context;var element=context.shape||context.connection,oldParent=context.parent||context.newParent;self.updateParent(element,oldParent);}function updateRoot(event){var context=event.context,oldRoot=context.oldRoot,children=oldRoot.children;(0,_minDash.forEach)(children,function(child){(0,_ModelUtil.is)(child,'bpmn:BaseElement')&&self.updateParent(child);});}function updateBounds(e){var shape=e.context.shape;if(!(0,_ModelUtil.is)(shape,'bpmn:BaseElement'))return;self.updateBounds(shape);}function updateConnection(e){self.updateConnection(e.context);}function updateConnectionWaypoints(e){self.updateConnectionWaypoints(e.context.connection);}function updateAttachment(e){self.updateAttachment(e.context);}_CommandInterceptor2.default.call(this,eventBus),this._bpmnFactory=bpmnFactory,this._translate=translate;var self=this;this.executed(['connection.layout','connection.create','connection.reconnectEnd','connection.reconnectStart'],cropConnection),this.reverted(['connection.layout'],function(e){delete e.context.cropped;}),this.executed(['shape.move','shape.create','shape.delete','connection.create','connection.move','connection.delete'],ifBpmn(updateParent)),this.reverted(['shape.move','shape.create','shape.delete','connection.create','connection.move','connection.delete'],ifBpmn(reverseUpdateParent)),this.executed(['canvas.updateRoot'],updateRoot),this.reverted(['canvas.updateRoot'],updateRoot),this.executed(['shape.move','shape.create','shape.resize'],ifBpmn(function(event){if(event.context.shape.type==='label')return;updateBounds(event);})),this.reverted(['shape.move','shape.create','shape.resize'],ifBpmn(function(event){if(event.context.shape.type==='label')return;updateBounds(event);})),eventBus.on('shape.changed',function(event){event.element.type==='label'&&updateBounds({context:{shape:event.element}});}),this.executed(['connection.create','connection.move','connection.delete','connection.reconnectEnd','connection.reconnectStart'],ifBpmn(updateConnection)),this.reverted(['connection.create','connection.move','connection.delete','connection.reconnectEnd','connection.reconnectStart'],ifBpmn(updateConnection)),this.executed(['connection.layout','connection.move','connection.updateWaypoints','connection.reconnectEnd','connection.reconnectStart'],ifBpmn(updateConnectionWaypoints)),this.reverted(['connection.layout','connection.move','connection.updateWaypoints','connection.reconnectEnd','connection.reconnectStart'],ifBpmn(updateConnectionWaypoints)),this.executed(['connection.reconnectEnd','connection.reconnectStart'],ifBpmn(function(e){var context=e.context,connection=context.connection,businessObject=(0,_ModelUtil.getBusinessObject)(connection),oldSource=(0,_ModelUtil.getBusinessObject)(context.oldSource),oldTarget=(0,_ModelUtil.getBusinessObject)(context.oldTarget),newSource=(0,_ModelUtil.getBusinessObject)(connection.source),newTarget=(0,_ModelUtil.getBusinessObject)(connection.target);if(oldSource===newSource||oldTarget===newTarget)return;oldSource&&oldSource.default===businessObject&&(context.default=oldSource.default,oldSource.default=undefined),businessObject.sourceRef&&businessObject.sourceRef.default&&!((0,_ModelUtil.is)(newTarget,'bpmn:Activity')||(0,_ModelUtil.is)(newTarget,'bpmn:EndEvent')||(0,_ModelUtil.is)(newTarget,'bpmn:Gateway')||(0,_ModelUtil.is)(newTarget,'bpmn:IntermediateThrowEvent'))&&(context.default=businessObject.sourceRef.default,businessObject.sourceRef.default=undefined),oldSource&&businessObject.conditionExpression&&!((0,_ModelUtil.is)(newSource,'bpmn:Activity')||(0,_ModelUtil.is)(newSource,'bpmn:Gateway'))&&(context.conditionExpression=businessObject.conditionExpression,businessObject.conditionExpression=undefined),oldTarget&&businessObject.conditionExpression&&!((0,_ModelUtil.is)(newTarget,'bpmn:Activity')||(0,_ModelUtil.is)(newTarget,'bpmn:EndEvent')||(0,_ModelUtil.is)(newTarget,'bpmn:Gateway')||(0,_ModelUtil.is)(newTarget,'bpmn:IntermediateThrowEvent'))&&(context.conditionExpression=businessObject.conditionExpression,businessObject.conditionExpression=undefined);})),this.reverted(['connection.reconnectEnd','connection.reconnectStart'],ifBpmn(function(e){var context=e.context,connection=context.connection,businessObject=(0,_ModelUtil.getBusinessObject)(connection),newSource=(0,_ModelUtil.getBusinessObject)(connection.source);context.default&&((0,_ModelUtil.is)(newSource,'bpmn:ExclusiveGateway')||(0,_ModelUtil.is)(newSource,'bpmn:InclusiveGateway')||(0,_ModelUtil.is)(newSource,'bpmn:Activity'))&&(newSource.default=context.default),context.conditionExpression&&(0,_ModelUtil.is)(newSource,'bpmn:Activity')&&(businessObject.conditionExpression=context.conditionExpression);})),this.executed(['element.updateAttachment'],ifBpmn(updateAttachment)),this.reverted(['element.updateAttachment'],ifBpmn(updateAttachment));}function getDefinitions(element){while(element&&!(0,_ModelUtil.is)(element,'bpmn:Definitions'))element=element.$parent;return element;}function ifBpmn(fn){return function(event){var context=event.context,element=context.shape||context.connection;(0,_ModelUtil.is)(element,'bpmn:BaseElement')&&fn(event);};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=BpmnUpdater;var _minDash=require('min-dash');var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _Collections=require('diagram-js/lib/util/Collections');var _model=require('diagram-js/lib/model');var _ModelUtil=require('../../util/ModelUtil');var _CommandInterceptor=require('diagram-js/lib/command/CommandInterceptor');var _CommandInterceptor2=_interopRequireDefault(_CommandInterceptor);(0,_inherits2.default)(BpmnUpdater,_CommandInterceptor2.default),BpmnUpdater.$inject=['eventBus','bpmnFactory','connectionDocking','translate'],BpmnUpdater.prototype.updateAttachment=function(context){var shape=context.shape,businessObject=shape.businessObject,host=shape.host;businessObject.attachedToRef=host&&host.businessObject;},BpmnUpdater.prototype.updateParent=function(element,oldParent){if(element instanceof _model.Label)return;var parentShape=element.parent;var businessObject=element.businessObject,parentBusinessObject=parentShape&&parentShape.businessObject,parentDi=parentBusinessObject&&parentBusinessObject.di;(0,_ModelUtil.is)(element,'bpmn:FlowNode')&&this.updateFlowNodeRefs(businessObject,parentBusinessObject,oldParent&&oldParent.businessObject),(0,_ModelUtil.is)(element,'bpmn:DataOutputAssociation')&&(element.source?parentBusinessObject=element.source.businessObject:parentBusinessObject=null),(0,_ModelUtil.is)(element,'bpmn:DataInputAssociation')&&(element.target?parentBusinessObject=element.target.businessObject:parentBusinessObject=null),this.updateSemanticParent(businessObject,parentBusinessObject),(0,_ModelUtil.is)(element,'bpmn:DataObjectReference')&&businessObject.dataObjectRef&&this.updateSemanticParent(businessObject.dataObjectRef,parentBusinessObject),this.updateDiParent(businessObject.di,parentDi);},BpmnUpdater.prototype.updateBounds=function(shape){var di=shape.businessObject.di;var bounds=shape instanceof _model.Label?this._getLabel(di).bounds:di.bounds;(0,_minDash.assign)(bounds,{x:shape.x,y:shape.y,width:shape.width,height:shape.height});},BpmnUpdater.prototype.updateFlowNodeRefs=function(businessObject,newContainment,oldContainment){if(oldContainment===newContainment)return;var oldRefs,newRefs;(0,_ModelUtil.is)(oldContainment,'bpmn:Lane')&&(oldRefs=oldContainment.get('flowNodeRef'),(0,_Collections.remove)(oldRefs,businessObject)),(0,_ModelUtil.is)(newContainment,'bpmn:Lane')&&(newRefs=newContainment.get('flowNodeRef'),(0,_Collections.add)(newRefs,businessObject));},BpmnUpdater.prototype.updateDiConnection=function(di,newSource,newTarget){di.sourceElement&&di.sourceElement.bpmnElement!==newSource&&(di.sourceElement=newSource&&newSource.di),di.targetElement&&di.targetElement.bpmnElement!==newTarget&&(di.targetElement=newTarget&&newTarget.di);},BpmnUpdater.prototype.updateDiParent=function(di,parentDi){if(parentDi&&!(0,_ModelUtil.is)(parentDi,'bpmndi:BPMNPlane')&&(parentDi=parentDi.$parent),di.$parent===parentDi)return;var planeElements=(parentDi||di.$parent).get('planeElement');parentDi?(planeElements.push(di),di.$parent=parentDi):((0,_Collections.remove)(planeElements,di),di.$parent=null);},BpmnUpdater.prototype.getLaneSet=function(container){var laneSet,laneSets;return(0,_ModelUtil.is)(container,'bpmn:Lane')?(laneSet=container.childLaneSet,laneSet||(laneSet=this._bpmnFactory.create('bpmn:LaneSet'),container.childLaneSet=laneSet,laneSet.$parent=container),laneSet):((0,_ModelUtil.is)(container,'bpmn:Participant')&&(container=container.processRef),laneSets=container.get('laneSets'),laneSet=laneSets[0],laneSet||(laneSet=this._bpmnFactory.create('bpmn:LaneSet'),laneSet.$parent=container,laneSets.push(laneSet)),laneSet);},BpmnUpdater.prototype.updateSemanticParent=function(businessObject,newParent,visualParent){var containment,translate=this._translate;if(businessObject.$parent===newParent)return;if((0,_ModelUtil.is)(businessObject,'bpmn:Lane'))newParent&&(newParent=this.getLaneSet(newParent)),containment='lanes';else if((0,_ModelUtil.is)(businessObject,'bpmn:FlowElement')){if(newParent)if((0,_ModelUtil.is)(newParent,'bpmn:Participant'))newParent=newParent.processRef;else if((0,_ModelUtil.is)(newParent,'bpmn:Lane'))do newParent=newParent.$parent.$parent;while((0,_ModelUtil.is)(newParent,'bpmn:Lane'));containment='flowElements';}else if((0,_ModelUtil.is)(businessObject,'bpmn:Artifact')){while(newParent&&!(0,_ModelUtil.is)(newParent,'bpmn:Process')&&!(0,_ModelUtil.is)(newParent,'bpmn:SubProcess')&&!(0,_ModelUtil.is)(newParent,'bpmn:Collaboration'))if((0,_ModelUtil.is)(newParent,'bpmn:Participant')){newParent=newParent.processRef;break;}else newParent=newParent.$parent;containment='artifacts';}else if((0,_ModelUtil.is)(businessObject,'bpmn:MessageFlow'))containment='messageFlows';else if((0,_ModelUtil.is)(businessObject,'bpmn:Participant')){containment='participants';var process=businessObject.processRef,definitions;process&&(definitions=getDefinitions(businessObject.$parent||newParent),businessObject.$parent&&((0,_Collections.remove)(definitions.get('rootElements'),process),process.$parent=null),newParent&&((0,_Collections.add)(definitions.get('rootElements'),process),process.$parent=definitions));}else(0,_ModelUtil.is)(businessObject,'bpmn:DataOutputAssociation')?containment='dataOutputAssociations':(0,_ModelUtil.is)(businessObject,'bpmn:DataInputAssociation')&&(containment='dataInputAssociations');if(!containment)throw new Error(translate('no parent for {element} in {parent}',{element:businessObject.id,parent:newParent.id}));var children;if(businessObject.$parent&&(children=businessObject.$parent.get(containment),(0,_Collections.remove)(children,businessObject)),newParent?(children=newParent.get(containment),children.push(businessObject),businessObject.$parent=newParent):businessObject.$parent=null,visualParent){var diChildren=visualParent.get(containment);(0,_Collections.remove)(children,businessObject),newParent&&(diChildren||(diChildren=[],newParent.set(containment,diChildren)),diChildren.push(businessObject));}},BpmnUpdater.prototype.updateConnectionWaypoints=function(connection){connection.businessObject.di.set('waypoint',this._bpmnFactory.createDiWaypoints(connection.waypoints));},BpmnUpdater.prototype.updateConnection=function(context){var connection=context.connection,businessObject=(0,_ModelUtil.getBusinessObject)(connection),newSource=(0,_ModelUtil.getBusinessObject)(connection.source),newTarget=(0,_ModelUtil.getBusinessObject)(connection.target),visualParent;if(!(0,_ModelUtil.is)(businessObject,'bpmn:DataAssociation')){var inverseSet=(0,_ModelUtil.is)(businessObject,'bpmn:SequenceFlow');businessObject.sourceRef!==newSource&&(inverseSet&&((0,_Collections.remove)(businessObject.sourceRef&&businessObject.sourceRef.get('outgoing'),businessObject),newSource&&newSource.get('outgoing')&&newSource.get('outgoing').push(businessObject)),businessObject.sourceRef=newSource),businessObject.targetRef!==newTarget&&(inverseSet&&((0,_Collections.remove)(businessObject.targetRef&&businessObject.targetRef.get('incoming'),businessObject),newTarget&&newTarget.get('incoming')&&newTarget.get('incoming').push(businessObject)),businessObject.targetRef=newTarget);}else(0,_ModelUtil.is)(businessObject,'bpmn:DataInputAssociation')?(businessObject.get('sourceRef')[0]=newSource,visualParent=context.parent||context.newParent||newTarget,this.updateSemanticParent(businessObject,newTarget,parent.businessObject)):(0,_ModelUtil.is)(businessObject,'bpmn:DataOutputAssociation')&&(visualParent=context.parent||context.newParent||newSource,this.updateSemanticParent(businessObject,newSource,visualParent),businessObject.targetRef=newTarget);this.updateConnectionWaypoints(connection),this.updateDiConnection(businessObject.di,newSource,newTarget);},BpmnUpdater.prototype._getLabel=function(di){return di.label||(di.label=this._bpmnFactory.createDiLabel()),di.label;};},{'../../util/ModelUtil':159,'diagram-js/lib/command/CommandInterceptor':185,'diagram-js/lib/model':319,'diagram-js/lib/util/Collections':328,inherits:350,'min-dash':438}],94:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function ElementFactory(bpmnFactory,moddle,translate){_ElementFactory2.default.call(this),this._bpmnFactory=bpmnFactory,this._moddle=moddle,this._translate=translate;}function applyAttributes(element,attrs,attributeNames){(0,_minDash.forEach)(attributeNames,function(property){attrs[property]!==undefined&&applyAttribute(element,attrs,property);});}function applyAttribute(element,attrs,attributeName){element[attributeName]=attrs[attributeName],delete attrs[attributeName];}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=ElementFactory;var _minDash=require('min-dash');var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _ModelUtil=require('../../util/ModelUtil');var _DiUtil=require('../../util/DiUtil');var _ElementFactory=require('diagram-js/lib/core/ElementFactory');var _ElementFactory2=_interopRequireDefault(_ElementFactory);var _LabelUtil=require('../../util/LabelUtil');(0,_inherits2.default)(ElementFactory,_ElementFactory2.default),ElementFactory.$inject=['bpmnFactory','moddle','translate'],ElementFactory.prototype.baseCreate=_ElementFactory2.default.prototype.create,ElementFactory.prototype.create=function(elementType,attrs){return elementType==='label'?this.baseCreate(elementType,(0,_minDash.assign)({type:'label'},_LabelUtil.DEFAULT_LABEL_SIZE,attrs)):this.createBpmnElement(elementType,attrs);},ElementFactory.prototype.createBpmnElement=function(elementType,attrs){var size,translate=this._translate;attrs=attrs||{};var businessObject=attrs.businessObject;if(!businessObject){if(!attrs.type)throw new Error(translate('no shape type specified'));businessObject=this._bpmnFactory.create(attrs.type);}businessObject.di||(elementType==='root'?businessObject.di=this._bpmnFactory.createDiPlane(businessObject,[],{id:businessObject.id+'_di'}):elementType==='connection'?businessObject.di=this._bpmnFactory.createDiEdge(businessObject,[],{id:businessObject.id+'_di'}):businessObject.di=this._bpmnFactory.createDiShape(businessObject,{},{id:businessObject.id+'_di'})),attrs.colors&&((0,_minDash.assign)(businessObject.di,attrs.colors),delete attrs.colors),applyAttributes(businessObject,attrs,['processRef','isInterrupting','associationDirection','isForCompensation']),attrs.isExpanded&&applyAttribute(businessObject.di,attrs,'isExpanded'),(0,_ModelUtil.is)(businessObject,'bpmn:ExclusiveGateway')&&(businessObject.di.isMarkerVisible=!0);var eventDefinitions,newEventDefinition;return attrs.eventDefinitionType&&(eventDefinitions=businessObject.get('eventDefinitions')||[],newEventDefinition=this._moddle.create(attrs.eventDefinitionType),attrs.eventDefinitionType==='bpmn:ConditionalEventDefinition'&&(newEventDefinition.condition=this._moddle.create('bpmn:FormalExpression')),eventDefinitions.push(newEventDefinition),newEventDefinition.$parent=businessObject,businessObject.eventDefinitions=eventDefinitions,delete attrs.eventDefinitionType),size=this._getDefaultSize(businessObject),attrs=(0,_minDash.assign)({businessObject:businessObject,id:businessObject.id},size,attrs),this.baseCreate(elementType,attrs);},ElementFactory.prototype._getDefaultSize=function(semantic){return(0,_ModelUtil.is)(semantic,'bpmn:SubProcess')?(0,_DiUtil.isExpanded)(semantic)?{width:350,height:200}:{width:100,height:80}:(0,_ModelUtil.is)(semantic,'bpmn:Task')?{width:100,height:80}:(0,_ModelUtil.is)(semantic,'bpmn:Gateway')?{width:50,height:50}:(0,_ModelUtil.is)(semantic,'bpmn:Event')?{width:36,height:36}:(0,_ModelUtil.is)(semantic,'bpmn:Participant')?(0,_DiUtil.isExpanded)(semantic)?{width:600,height:250}:{width:400,height:100}:(0,_ModelUtil.is)(semantic,'bpmn:Lane')?{width:400,height:100}:(0,_ModelUtil.is)(semantic,'bpmn:DataObjectReference')?{width:36,height:50}:(0,_ModelUtil.is)(semantic,'bpmn:DataStoreReference')?{width:50,height:50}:(0,_ModelUtil.is)(semantic,'bpmn:TextAnnotation')?{width:100,height:30}:{width:100,height:80};},ElementFactory.prototype.createParticipantShape=function(collapsed){var attrs={type:'bpmn:Participant'};return collapsed||(attrs.processRef=this._bpmnFactory.create('bpmn:Process')),this.createShape(attrs);};},{'../../util/DiUtil':157,'../../util/LabelUtil':158,'../../util/ModelUtil':159,'diagram-js/lib/core/ElementFactory':189,inherits:350,'min-dash':438}],95:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function Modeling(eventBus,elementFactory,commandStack,bpmnRules){_Modeling2.default.call(this,eventBus,elementFactory,commandStack),this._bpmnRules=bpmnRules;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=Modeling;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _Modeling=require('diagram-js/lib/features/modeling/Modeling');var _Modeling2=_interopRequireDefault(_Modeling);var _UpdatePropertiesHandler=require('./cmd/UpdatePropertiesHandler');var _UpdatePropertiesHandler2=_interopRequireDefault(_UpdatePropertiesHandler);var _UpdateCanvasRootHandler=require('./cmd/UpdateCanvasRootHandler');var _UpdateCanvasRootHandler2=_interopRequireDefault(_UpdateCanvasRootHandler);var _AddLaneHandler=require('./cmd/AddLaneHandler');var _AddLaneHandler2=_interopRequireDefault(_AddLaneHandler);var _SplitLaneHandler=require('./cmd/SplitLaneHandler');var _SplitLaneHandler2=_interopRequireDefault(_SplitLaneHandler);var _ResizeLaneHandler=require('./cmd/ResizeLaneHandler');var _ResizeLaneHandler2=_interopRequireDefault(_ResizeLaneHandler);var _UpdateFlowNodeRefsHandler=require('./cmd/UpdateFlowNodeRefsHandler');var _UpdateFlowNodeRefsHandler2=_interopRequireDefault(_UpdateFlowNodeRefsHandler);var _IdClaimHandler=require('./cmd/IdClaimHandler');var _IdClaimHandler2=_interopRequireDefault(_IdClaimHandler);var _SetColorHandler=require('./cmd/SetColorHandler');var _SetColorHandler2=_interopRequireDefault(_SetColorHandler);var _UpdateLabelHandler=require('../label-editing/cmd/UpdateLabelHandler');var _UpdateLabelHandler2=_interopRequireDefault(_UpdateLabelHandler);(0,_inherits2.default)(Modeling,_Modeling2.default),Modeling.$inject=['eventBus','elementFactory','commandStack','bpmnRules'],Modeling.prototype.getHandlers=function(){var handlers=_Modeling2.default.prototype.getHandlers.call(this);return handlers['element.updateProperties']=_UpdatePropertiesHandler2.default,handlers['canvas.updateRoot']=_UpdateCanvasRootHandler2.default,handlers['lane.add']=_AddLaneHandler2.default,handlers['lane.resize']=_ResizeLaneHandler2.default,handlers['lane.split']=_SplitLaneHandler2.default,handlers['lane.updateRefs']=_UpdateFlowNodeRefsHandler2.default,handlers['id.updateClaim']=_IdClaimHandler2.default,handlers['element.setColor']=_SetColorHandler2.default,handlers['element.updateLabel']=_UpdateLabelHandler2.default,handlers;},Modeling.prototype.updateLabel=function(element,newLabel,newBounds){this._commandStack.execute('element.updateLabel',{element:element,newLabel:newLabel,newBounds:newBounds});},Modeling.prototype.connect=function(source,target,attrs,hints){var bpmnRules=this._bpmnRules;return attrs||(attrs=bpmnRules.canConnect(source,target)),attrs?this.createConnection(source,target,attrs,source.parent,hints):void 0;},Modeling.prototype.updateProperties=function(element,properties){this._commandStack.execute('element.updateProperties',{element:element,properties:properties});},Modeling.prototype.resizeLane=function(laneShape,newBounds,balanced){this._commandStack.execute('lane.resize',{shape:laneShape,newBounds:newBounds,balanced:balanced});},Modeling.prototype.addLane=function(targetLaneShape,location){var context={shape:targetLaneShape,location:location};return this._commandStack.execute('lane.add',context),context.newLane;},Modeling.prototype.splitLane=function(targetLane,count){this._commandStack.execute('lane.split',{shape:targetLane,count:count});},Modeling.prototype.makeCollaboration=function(){var collaborationElement=this._create('root',{type:'bpmn:Collaboration'});var context={newRoot:collaborationElement};return this._commandStack.execute('canvas.updateRoot',context),collaborationElement;},Modeling.prototype.updateLaneRefs=function(flowNodeShapes,laneShapes){this._commandStack.execute('lane.updateRefs',{flowNodeShapes:flowNodeShapes,laneShapes:laneShapes});},Modeling.prototype.makeProcess=function(){var processElement=this._create('root',{type:'bpmn:Process'});var context={newRoot:processElement};this._commandStack.execute('canvas.updateRoot',context);},Modeling.prototype.claimId=function(id,moddleElement){this._commandStack.execute('id.updateClaim',{id:id,element:moddleElement,claiming:!0});},Modeling.prototype.unclaimId=function(id,moddleElement){this._commandStack.execute('id.updateClaim',{id:id,element:moddleElement});},Modeling.prototype.setColor=function(elements,colors){elements.length||(elements=[elements]),this._commandStack.execute('element.setColor',{elements:elements,colors:colors});};},{'../label-editing/cmd/UpdateLabelHandler':89,'./cmd/AddLaneHandler':122,'./cmd/IdClaimHandler':123,'./cmd/ResizeLaneHandler':124,'./cmd/SetColorHandler':125,'./cmd/SplitLaneHandler':126,'./cmd/UpdateCanvasRootHandler':127,'./cmd/UpdateFlowNodeRefsHandler':128,'./cmd/UpdatePropertiesHandler':129,'diagram-js/lib/features/modeling/Modeling':243,inherits:350}],96:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function AdaptiveLabelPositioningBehavior(eventBus,modeling){function checkLabelAdjustment(element){if(!(0,_LabelUtil.hasExternalLabel)(element))return;var optimalPosition=getOptimalPosition(element);if(!optimalPosition)return;adjustLabelPosition(element,optimalPosition);}function adjustLabelPosition(element,orientation){var elementMid=(0,_LayoutUtil.getMid)(element),label=element.label,labelMid=(0,_LayoutUtil.getMid)(label);var elementTrbl=(0,_LayoutUtil.asTRBL)(element);var newLabelMid;switch(orientation){case'top':newLabelMid={x:elementMid.x,y:elementTrbl.top-ELEMENT_LABEL_DISTANCE-label.height/2};break;case'left':newLabelMid={x:elementTrbl.left-ELEMENT_LABEL_DISTANCE-label.width/2,y:elementMid.y};break;case'bottom':newLabelMid={x:elementMid.x,y:elementTrbl.bottom+ELEMENT_LABEL_DISTANCE+label.height/2};break;case'right':newLabelMid={x:elementTrbl.right+ELEMENT_LABEL_DISTANCE+label.width/2,y:elementMid.y};break;}var delta=(0,_Math.substract)(newLabelMid,labelMid);modeling.moveShape(label,delta);}_CommandInterceptor2.default.call(this,eventBus),this.postExecuted(['connection.create','connection.layout','connection.reconnectEnd','connection.reconnectStart','connection.updateWaypoints'],function(event){var context=event.context,connection=context.connection;var source=connection.source,target=connection.target;checkLabelAdjustment(source),checkLabelAdjustment(target);});var ELEMENT_LABEL_DISTANCE=10;}function getOptimalPosition(element){var labelMid=(0,_LayoutUtil.getMid)(element.label);var elementMid=(0,_LayoutUtil.getMid)(element);var labelOrientation=getApproximateOrientation(elementMid,labelMid);if(!isAligned(labelOrientation))return;var takenAlignments=[].concat(element.incoming.map(function(c){return c.waypoints[c.waypoints.length-2];}),element.outgoing.map(function(c){return c.waypoints[1];})).map(function(point){return getApproximateOrientation(elementMid,point);});var freeAlignments=ALIGNMENTS.filter(function(alignment){return takenAlignments.indexOf(alignment)===-1;});return freeAlignments.indexOf(labelOrientation)!==-1?void 0:freeAlignments[0];}function getApproximateOrientation(p0,p1){return(0,_LayoutUtil.getOrientation)(p1,p0,5);}function isAligned(orientation){return ALIGNMENTS.indexOf(orientation)!==-1;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=AdaptiveLabelPositioningBehavior;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _LayoutUtil=require('diagram-js/lib/layout/LayoutUtil');var _Math=require('diagram-js/lib/util/Math');var _LabelUtil=require('../../../util/LabelUtil');var _CommandInterceptor=require('diagram-js/lib/command/CommandInterceptor');var _CommandInterceptor2=_interopRequireDefault(_CommandInterceptor);(0,_inherits2.default)(AdaptiveLabelPositioningBehavior,_CommandInterceptor2.default),AdaptiveLabelPositioningBehavior.$inject=['eventBus','modeling'];var ALIGNMENTS=['top','bottom','left','right'];},{'../../../util/LabelUtil':158,'diagram-js/lib/command/CommandInterceptor':185,'diagram-js/lib/layout/LayoutUtil':317,'diagram-js/lib/util/Math':337,inherits:350}],97:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function AppendBehavior(eventBus,elementFactory,bpmnRules){_CommandInterceptor2.default.call(this,eventBus),this.preExecute('shape.append',function(context){var source=context.source,shape=context.shape;context.position||((0,_ModelUtil.is)(shape,'bpmn:TextAnnotation')?context.position={x:source.x+source.width/2+75,y:source.y-50-shape.height/2}:context.position={x:source.x+source.width+80+shape.width/2,y:source.y+source.height/2});},!0);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=AppendBehavior;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _ModelUtil=require('../../../util/ModelUtil');var _CommandInterceptor=require('diagram-js/lib/command/CommandInterceptor');var _CommandInterceptor2=_interopRequireDefault(_CommandInterceptor);(0,_inherits2.default)(AppendBehavior,_CommandInterceptor2.default),AppendBehavior.$inject=['eventBus','elementFactory','bpmnRules'];},{'../../../util/ModelUtil':159,'diagram-js/lib/command/CommandInterceptor':185,inherits:350}],98:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function CopyPasteBehavior(eventBus,modeling,canvas){_CommandInterceptor2.default.call(this,eventBus),this.preExecute('elements.paste',1500,function(context){var topParent=context.topParent;if(topParent.parent||(context.topParent=canvas.getRootElement()),(0,_ModelUtil.is)(topParent,'bpmn:Lane'))do topParent=context.topParent=topParent.parent;while((0,_ModelUtil.is)(topParent,'bpmn:Lane')||!(0,_ModelUtil.is)(topParent,'bpmn:Participant'));},!0),this.postExecute('elements.paste',function(context){var tree=context.tree,createdElements=tree.createdElements;(0,_minDash.forEach)(createdElements,function(data){var element=data.element,businessObject=element.businessObject,descriptor=data.descriptor,defaultFlow;((0,_ModelUtil.is)(businessObject,'bpmn:ExclusiveGateway')||(0,_ModelUtil.is)(businessObject,'bpmn:InclusiveGateway')||(0,_ModelUtil.is)(businessObject,'bpmn:Activity'))&&descriptor.default&&(defaultFlow=createdElements[descriptor.default],defaultFlow?defaultFlow=defaultFlow.element:defaultFlow=undefined,delete element.default,modeling.updateProperties(element,{default:defaultFlow}));});},!0);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=CopyPasteBehavior;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _minDash=require('min-dash');var _ModelUtil=require('../../../util/ModelUtil');var _CommandInterceptor=require('diagram-js/lib/command/CommandInterceptor');var _CommandInterceptor2=_interopRequireDefault(_CommandInterceptor);CopyPasteBehavior.$inject=['eventBus','modeling','canvas'],(0,_inherits2.default)(CopyPasteBehavior,_CommandInterceptor2.default);},{'../../../util/ModelUtil':159,'diagram-js/lib/command/CommandInterceptor':185,inherits:350,'min-dash':438}],99:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function CreateBoundaryEventBehavior(eventBus,modeling,elementFactory,bpmnFactory){_CommandInterceptor2.default.call(this,eventBus),this.preExecute('shape.create',function(context){var shape=context.shape,host=context.host,businessObject,boundaryEvent;var attrs={cancelActivity:!0};host&&(0,_ModelUtil.is)(shape,'bpmn:IntermediateThrowEvent')&&(attrs.attachedToRef=host.businessObject,businessObject=bpmnFactory.create('bpmn:BoundaryEvent',attrs),boundaryEvent={type:'bpmn:BoundaryEvent',businessObject:businessObject},context.shape=elementFactory.createShape(boundaryEvent));},!0);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=CreateBoundaryEventBehavior;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _CommandInterceptor=require('diagram-js/lib/command/CommandInterceptor');var _CommandInterceptor2=_interopRequireDefault(_CommandInterceptor);var _ModelUtil=require('../../../util/ModelUtil');CreateBoundaryEventBehavior.$inject=['eventBus','modeling','elementFactory','bpmnFactory'],(0,_inherits2.default)(CreateBoundaryEventBehavior,_CommandInterceptor2.default);},{'../../../util/ModelUtil':159,'diagram-js/lib/command/CommandInterceptor':185,inherits:350}],100:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function CreateDataObjectBehavior(eventBus,bpmnFactory,moddle){_CommandInterceptor2.default.call(this,eventBus),this.preExecute('shape.create',function(event){var context=event.context,shape=context.shape;if((0,_ModelUtil.is)(shape,'bpmn:DataObjectReference')&&shape.type!=='label'){var dataObject=bpmnFactory.create('bpmn:DataObject');shape.businessObject.dataObjectRef=dataObject;}});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=CreateDataObjectBehavior;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _CommandInterceptor=require('diagram-js/lib/command/CommandInterceptor');var _CommandInterceptor2=_interopRequireDefault(_CommandInterceptor);var _ModelUtil=require('../../../util/ModelUtil');CreateDataObjectBehavior.$inject=['eventBus','bpmnFactory','moddle'],(0,_inherits2.default)(CreateDataObjectBehavior,_CommandInterceptor2.default);},{'../../../util/ModelUtil':159,'diagram-js/lib/command/CommandInterceptor':185,inherits:350}],101:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function CreateParticipantBehavior(eventBus,modeling,elementFactory,bpmnFactory,canvas){_CommandInterceptor2.default.call(this,eventBus),this.preExecute('shape.create',function(context){var parent=context.parent,shape=context.shape,position=context.position;var rootElement=canvas.getRootElement();if((0,_ModelUtil.is)(parent,'bpmn:Process')&&(0,_ModelUtil.is)(shape,'bpmn:Participant')&&!(0,_ModelUtil.is)(rootElement,'bpmn:Collaboration')){var collaborationElement=modeling.makeCollaboration();context.position=position,context.parent=collaborationElement,context.processRoot=parent;}},!0),this.execute('shape.create',function(context){var processRoot=context.processRoot,shape=context.shape;processRoot&&(context.oldProcessRef=shape.businessObject.processRef,shape.businessObject.processRef=processRoot.businessObject);},!0),this.revert('shape.create',function(context){var processRoot=context.processRoot,shape=context.shape;processRoot&&(shape.businessObject.processRef=context.oldProcessRef);},!0),this.postExecute('shape.create',function(context){var processRoot=context.processRoot,shape=context.shape;if(processRoot){var processChildren=processRoot.children.slice();modeling.moveElements(processChildren,{x:0,y:0},shape);}},!0);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=CreateParticipantBehavior;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _CommandInterceptor=require('diagram-js/lib/command/CommandInterceptor');var _CommandInterceptor2=_interopRequireDefault(_CommandInterceptor);var _ModelUtil=require('../../../util/ModelUtil');CreateParticipantBehavior.$inject=['eventBus','modeling','elementFactory','bpmnFactory','canvas'],(0,_inherits2.default)(CreateParticipantBehavior,_CommandInterceptor2.default);},{'../../../util/ModelUtil':159,'diagram-js/lib/command/CommandInterceptor':185,inherits:350}],102:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function DataInputAssociationBehavior(eventBus,bpmnFactory){function usesTargetRef(element,targetRef,removedConnection){var inputAssociations=element.get('dataInputAssociations');return(0,_minDash.find)(inputAssociations,function(association){return association!==removedConnection&&association.targetRef===targetRef;});}function getTargetRef(element,create){var properties=element.get('properties');var targetRefProp=(0,_minDash.find)(properties,function(p){return p.name===TARGET_REF_PLACEHOLDER_NAME;});return!targetRefProp&&create&&(targetRefProp=bpmnFactory.create('bpmn:Property',{name:TARGET_REF_PLACEHOLDER_NAME}),(0,_Collections.add)(properties,targetRefProp)),targetRefProp;}function cleanupTargetRef(element,connection){var targetRefProp=getTargetRef(element);if(!targetRefProp)return;usesTargetRef(element,targetRefProp,connection)||(0,_Collections.remove)(element.get('properties'),targetRefProp);}function fixTargetRef(event){var context=event.context,connection=context.connection,connectionBo=connection.businessObject,target=connection.target,targetBo=target&&target.businessObject,newTarget=context.newTarget,newTargetBo=newTarget&&newTarget.businessObject,oldTarget=context.oldTarget||context.target,oldTargetBo=oldTarget&&oldTarget.businessObject;var dataAssociation=connection.businessObject,targetRefProp;oldTargetBo&&oldTargetBo!==targetBo&&cleanupTargetRef(oldTargetBo,connectionBo),newTargetBo&&newTargetBo!==targetBo&&cleanupTargetRef(newTargetBo,connectionBo),targetBo?(targetRefProp=getTargetRef(targetBo,!0),dataAssociation.targetRef=targetRefProp):dataAssociation.targetRef=null;}_CommandInterceptor2.default.call(this,eventBus),this.executed(['connection.create','connection.delete','connection.move','connection.reconnectEnd'],ifDataInputAssociation(fixTargetRef)),this.reverted(['connection.create','connection.delete','connection.move','connection.reconnectEnd'],ifDataInputAssociation(fixTargetRef));}function ifDataInputAssociation(fn){return function(event){var context=event.context,connection=context.connection;return(0,_ModelUtil.is)(connection,'bpmn:DataInputAssociation')?fn(event):void 0;};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=DataInputAssociationBehavior;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _CommandInterceptor=require('diagram-js/lib/command/CommandInterceptor');var _CommandInterceptor2=_interopRequireDefault(_CommandInterceptor);var _Collections=require('diagram-js/lib/util/Collections');var _minDash=require('min-dash');var _ModelUtil=require('../../../util/ModelUtil');var TARGET_REF_PLACEHOLDER_NAME='__targetRef_placeholder';DataInputAssociationBehavior.$inject=['eventBus','bpmnFactory'],(0,_inherits2.default)(DataInputAssociationBehavior,_CommandInterceptor2.default);},{'../../../util/ModelUtil':159,'diagram-js/lib/command/CommandInterceptor':185,'diagram-js/lib/util/Collections':328,inherits:350,'min-dash':438}],103:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function DeleteLaneBehavior(eventBus,modeling,spaceTool){function compensateLaneDelete(shape,oldParent){var siblings=(0,_LaneUtil.getChildLanes)(oldParent);var topAffected=[];var bottomAffected=[];if((0,_Elements.eachElement)(siblings,function(element){return element.y>shape.y?bottomAffected.push(element):topAffected.push(element),element.children;}),!siblings.length)return;var offset;bottomAffected.length&&topAffected.length?offset=shape.height/2:offset=shape.height;var topAdjustments,bottomAdjustments;topAffected.length&&(topAdjustments=spaceTool.calculateAdjustments(topAffected,'y',offset,shape.y-10),spaceTool.makeSpace(topAdjustments.movingShapes,topAdjustments.resizingShapes,{x:0,y:offset},'s')),bottomAffected.length&&(bottomAdjustments=spaceTool.calculateAdjustments(bottomAffected,'y',-offset,shape.y+shape.height+10),spaceTool.makeSpace(bottomAdjustments.movingShapes,bottomAdjustments.resizingShapes,{x:0,y:-offset},'n'));}_CommandInterceptor2.default.call(this,eventBus),this.postExecuted('shape.delete',LOW_PRIORITY,function(event){var context=event.context,hints=context.hints,shape=context.shape,oldParent=context.oldParent;if(!(0,_ModelUtil.is)(shape,'bpmn:Lane'))return;if(hints&&hints.nested)return;compensateLaneDelete(shape,oldParent);});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=DeleteLaneBehavior;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _CommandInterceptor=require('diagram-js/lib/command/CommandInterceptor');var _CommandInterceptor2=_interopRequireDefault(_CommandInterceptor);var _ModelUtil=require('../../../util/ModelUtil');var _LaneUtil=require('../util/LaneUtil');var _Elements=require('diagram-js/lib/util/Elements');var LOW_PRIORITY=500;DeleteLaneBehavior.$inject=['eventBus','modeling','spaceTool'],(0,_inherits2.default)(DeleteLaneBehavior,_CommandInterceptor2.default);},{'../../../util/ModelUtil':159,'../util/LaneUtil':131,'diagram-js/lib/command/CommandInterceptor':185,'diagram-js/lib/util/Elements':331,inherits:350}],104:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function DropOnFlowBehavior(eventBus,bpmnRules,modeling){function insertShape(shape,targetFlow,position){var waypoints=targetFlow.waypoints,waypointsBefore,waypointsAfter,dockingPoint,source,target,reconnected;var intersection=(0,_LineIntersection.getApproxIntersection)(waypoints,position);if(intersection){if(waypointsBefore=waypoints.slice(0,intersection.index),waypointsAfter=waypoints.slice(intersection.index+(intersection.bendpoint?1:0)),!(waypointsBefore.length&&waypointsAfter.length))return;dockingPoint=intersection.bendpoint?waypoints[intersection.index]:position,isPointInsideBBox(shape,waypointsBefore[waypointsBefore.length-1])||waypointsBefore.push(copy(dockingPoint)),isPointInsideBBox(shape,waypointsAfter[0])||waypointsAfter.unshift(copy(dockingPoint));}source=targetFlow.source,target=targetFlow.target,bpmnRules.canConnect(source,shape,targetFlow)&&(modeling.reconnectEnd(targetFlow,shape,waypointsBefore||position),reconnected=!0),bpmnRules.canConnect(shape,target,targetFlow)&&(reconnected?modeling.connect(shape,target,{type:targetFlow.type,waypoints:waypointsAfter}):modeling.reconnectStart(targetFlow,shape,waypointsAfter||position));}_CommandInterceptor2.default.call(this,eventBus),this.preExecute('elements.move',function(context){var newParent=context.newParent,shapes=context.shapes,delta=context.delta,shape=shapes[0];if(!(shape&&newParent))return;newParent&&newParent.waypoints&&(context.newParent=newParent=newParent.parent);var shapeMid=getMid(shape);var newShapeMid={x:shapeMid.x+delta.x,y:shapeMid.y+delta.y};var connection=(0,_minDash.find)(newParent.children,function(element){var canInsert=bpmnRules.canInsert(shapes,element);return canInsert&&(0,_LineIntersection.getApproxIntersection)(element.waypoints,newShapeMid);});connection&&(context.targetFlow=connection,context.position=newShapeMid);},!0),this.postExecuted('elements.move',function(context){var shapes=context.shapes,targetFlow=context.targetFlow,position=context.position;targetFlow&&insertShape(shapes[0],targetFlow,position);},!0),this.preExecute('shape.create',function(context){var parent=context.parent,shape=context.shape;bpmnRules.canInsert(shape,parent)&&(context.targetFlow=parent,context.parent=parent.parent);},!0),this.postExecuted('shape.create',function(context){var shape=context.shape,targetFlow=context.targetFlow,position=context.position;targetFlow&&insertShape(shape,targetFlow,position);},!0);}function isPointInsideBBox(bbox,point){var x=point.x,y=point.y;return x>=bbox.x&&x<=bbox.x+bbox.width&&y>=bbox.y&&y<=bbox.y+bbox.height;}function copy(obj){return(0,_minDash.assign)({},obj);}function getMid(bounds){return{x:Math.round(bounds.x+bounds.width/2),y:Math.round(bounds.y+bounds.height/2)};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=DropOnFlowBehavior;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _minDash=require('min-dash');var _CommandInterceptor=require('diagram-js/lib/command/CommandInterceptor');var _CommandInterceptor2=_interopRequireDefault(_CommandInterceptor);var _LineIntersection=require('diagram-js/lib/util/LineIntersection');(0,_inherits2.default)(DropOnFlowBehavior,_CommandInterceptor2.default),DropOnFlowBehavior.$inject=['eventBus','bpmnRules','modeling'];},{'diagram-js/lib/command/CommandInterceptor':185,'diagram-js/lib/util/LineIntersection':336,inherits:350,'min-dash':438}],105:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function ImportDockingFix(eventBus){function adjustDocking(startPoint,nextPoint,elementMid){var elementTop={x:elementMid.x,y:elementMid.y-50};var elementLeft={x:elementMid.x-50,y:elementMid.y};var verticalIntersect=(0,_LineIntersect2.default)(startPoint,nextPoint,elementMid,elementTop),horizontalIntersect=(0,_LineIntersect2.default)(startPoint,nextPoint,elementMid,elementLeft);var centerIntersect;verticalIntersect&&horizontalIntersect?getDistance(verticalIntersect,elementMid)>getDistance(horizontalIntersect,elementMid)?centerIntersect=horizontalIntersect:centerIntersect=verticalIntersect:centerIntersect=verticalIntersect||horizontalIntersect,startPoint.original=centerIntersect;}function fixDockings(connection){var waypoints=connection.waypoints;adjustDocking(waypoints[0],waypoints[1],(0,_LayoutUtil.getMid)(connection.source)),adjustDocking(waypoints[waypoints.length-1],waypoints[waypoints.length-2],(0,_LayoutUtil.getMid)(connection.target));}eventBus.on('bpmnElement.added',function(e){var element=e.element;element.waypoints&&fixDockings(element);});}function getDistance(p1,p2){return Math.sqrt(Math.pow(p1.x-p2.x,2)+Math.pow(p1.y-p2.y,2));}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=ImportDockingFix;var _LayoutUtil=require('diagram-js/lib/layout/LayoutUtil');var _LineIntersect=require('./util/LineIntersect');var _LineIntersect2=_interopRequireDefault(_LineIntersect);ImportDockingFix.$inject=['eventBus'];},{'./util/LineIntersect':121,'diagram-js/lib/layout/LayoutUtil':317}],106:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function LabelBehavior(eventBus,modeling,bpmnFactory){function getHiddenLabelAdjustment(event){var context=event.context,connection=context.connection,label=connection.label;var labelPosition=(0,_LabelUtil.getExternalLabelMid)(connection);return{x:labelPosition.x-label.x-label.width/2,y:labelPosition.y-label.y-label.height/2};}function getVisibleLabelAdjustment(event){var command=event.command,context=event.context,connection=context.connection,label=connection.label,hints=(0,_minDash.assign)({},context.hints),newWaypoints=context.newWaypoints||connection.waypoints,oldWaypoints=context.oldWaypoints;return hints.startChanged===void 0&&(hints.startChanged=command==='connection.reconnectStart'),hints.endChanged===void 0&&(hints.endChanged=command==='connection.reconnectEnd'),(0,_LabelLayoutUtil.getLabelAdjustment)(label,newWaypoints,oldWaypoints,hints);}_CommandInterceptor2.default.call(this,eventBus);var textUtil=new _Text2.default();this.postExecute(['shape.create','connection.create'],function(e){var context=e.context;var element=context.shape||context.connection,businessObject=element.businessObject;if(!(0,_LabelUtil.hasExternalLabel)(element))return;var labelCenter=(0,_LabelUtil.getExternalLabelMid)(element);var labelDimensions=getLayoutedBounds(DEFAULT_LABEL_DIMENSIONS,businessObject.name||'',textUtil);modeling.createLabel(element,labelCenter,{id:businessObject.id+'_label',hidden:!businessObject.name,businessObject:businessObject,width:labelDimensions.width,height:labelDimensions.height});}),this.executed(['label.create'],function(event){var element=event.context.shape,businessObject,di;if(!element.labelTarget)return;if(!(0,_ModelUtil.is)(element.labelTarget||element,'bpmn:BaseElement'))return;businessObject=element.businessObject,di=businessObject.di,di.label||(di.label=bpmnFactory.create('bpmndi:BPMNLabel',{bounds:bpmnFactory.create('dc:Bounds')})),(0,_minDash.assign)(di.label.bounds,{x:element.x,y:element.y,width:element.width,height:element.height});}),this.postExecute(['connection.layout','connection.reconnectEnd','connection.reconnectStart','connection.updateWaypoints'],function(event){var label=event.context.connection.label,labelAdjustment;if(!label)return;label.hidden?labelAdjustment=getHiddenLabelAdjustment(event):labelAdjustment=getVisibleLabelAdjustment(event),modeling.moveShape(label,labelAdjustment);}),this.postExecute(['shape.replace'],function(event){var context=event.context,newShape=context.newShape,oldShape=context.oldShape;var businessObject=(0,_ModelUtil.getBusinessObject)(newShape);businessObject&&(0,_LabelUtil.hasExternalLabel)(businessObject)&&(newShape.label.x=oldShape.label.x,newShape.label.y=oldShape.label.y);});}function getLayoutedBounds(bounds,text,textUtil){var layoutedLabelDimensions=textUtil.getDimensions(text,{box:{width:90,height:30,x:bounds.width/2+bounds.x,y:bounds.height/2+bounds.y},style:EXTERNAL_LABEL_STYLE});return{x:Math.round(bounds.x+bounds.width/2-layoutedLabelDimensions.width/2),y:Math.round(bounds.y),width:Math.ceil(layoutedLabelDimensions.width),height:Math.ceil(layoutedLabelDimensions.height)};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=LabelBehavior;var _minDash=require('min-dash');var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _ModelUtil=require('../../../util/ModelUtil');var _LabelUtil=require('../../../util/LabelUtil');var _LabelLayoutUtil=require('./util/LabelLayoutUtil');var _CommandInterceptor=require('diagram-js/lib/command/CommandInterceptor');var _CommandInterceptor2=_interopRequireDefault(_CommandInterceptor);var _Text=require('diagram-js/lib/util/Text');var _Text2=_interopRequireDefault(_Text);var DEFAULT_LABEL_DIMENSIONS={width:90,height:20};(0,_inherits2.default)(LabelBehavior,_CommandInterceptor2.default),LabelBehavior.$inject=['eventBus','modeling','bpmnFactory'];var EXTERNAL_LABEL_STYLE={fontFamily:'Arial, sans-serif',fontSize:'11px'};},{'../../../util/LabelUtil':158,'../../../util/ModelUtil':159,'./util/LabelLayoutUtil':119,'diagram-js/lib/command/CommandInterceptor':185,'diagram-js/lib/util/Text':344,inherits:350,'min-dash':438}],107:[function(require,module,exports){'use strict';function ModelingFeedback(eventBus,tooltips,translate){function showError(position,message,timeout){tooltips.add({position:{x:position.x+5,y:position.y+5},type:'error',timeout:timeout||2000,html:'<div>'+message+'</div>'});}eventBus.on(['shape.move.rejected','create.rejected'],function(event){var context=event.context,shape=context.shape,target=context.target;(0,_ModelUtil.is)(target,'bpmn:Collaboration')&&(0,_ModelUtil.is)(shape,'bpmn:FlowNode')&&showError(event,translate(COLLAB_ERR_MSG));}),eventBus.on(['elements.paste.rejected'],function(event){var context=event.context,position=context.position,target=context.target;(0,_ModelUtil.is)(target,'bpmn:Collaboration')&&showError(position,translate(COLLAB_ERR_MSG)),(0,_ModelUtil.is)(target,'bpmn:Process')&&showError(position,translate(PROCESS_ERR_MSG),3000);});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=ModelingFeedback;var _ModelUtil=require('../../../util/ModelUtil');var COLLAB_ERR_MSG='flow elements must be children of pools/participants',PROCESS_ERR_MSG='participants cannot be pasted onto a non-empty process diagram';ModelingFeedback.$inject=['eventBus','tooltips','translate'];},{'../../../util/ModelUtil':159}],108:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function RemoveElementBehavior(eventBus,bpmnRules,modeling){_CommandInterceptor2.default.call(this,eventBus),this.preExecute('shape.delete',function(e){var shape=e.context.shape;if(shape.incoming.length==1&&shape.outgoing.length==1){var inConnection=shape.incoming[0],outConnection=shape.outgoing[0];if(bpmnRules.canConnect(inConnection.source,outConnection.target,inConnection)){var newWaypoints=getNewWaypoints(inConnection.waypoints,outConnection.waypoints);modeling.reconnectEnd(inConnection,outConnection.target,newWaypoints);}}});}function getDocking(point){return point.original||point;}function getNewWaypoints(inWaypoints,outWaypoints){var intersection=(0,_LineIntersect2.default)(getDocking(inWaypoints[inWaypoints.length-2]),getDocking(inWaypoints[inWaypoints.length-1]),getDocking(outWaypoints[1]),getDocking(outWaypoints[0]));return intersection?[].concat(inWaypoints.slice(0,inWaypoints.length-1),[intersection],outWaypoints.slice(1)):[getDocking(inWaypoints[0]),getDocking(outWaypoints[outWaypoints.length-1])];}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=RemoveElementBehavior;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _CommandInterceptor=require('diagram-js/lib/command/CommandInterceptor');var _CommandInterceptor2=_interopRequireDefault(_CommandInterceptor);var _LineIntersect=require('./util/LineIntersect');var _LineIntersect2=_interopRequireDefault(_LineIntersect);(0,_inherits2.default)(RemoveElementBehavior,_CommandInterceptor2.default),RemoveElementBehavior.$inject=['eventBus','bpmnRules','modeling'];},{'./util/LineIntersect':121,'diagram-js/lib/command/CommandInterceptor':185,inherits:350}],109:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function RemoveParticipantBehavior(eventBus,modeling){_CommandInterceptor2.default.call(this,eventBus),this.preExecute('shape.delete',function(context){var shape=context.shape,parent=shape.parent;(0,_ModelUtil.is)(shape,'bpmn:Participant')&&(context.collaborationRoot=parent);},!0),this.postExecute('shape.delete',function(context){var collaborationRoot=context.collaborationRoot;collaborationRoot&&!collaborationRoot.businessObject.participants.length&&modeling.makeProcess();},!0);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=RemoveParticipantBehavior;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _CommandInterceptor=require('diagram-js/lib/command/CommandInterceptor');var _CommandInterceptor2=_interopRequireDefault(_CommandInterceptor);var _ModelUtil=require('../../../util/ModelUtil');RemoveParticipantBehavior.$inject=['eventBus','modeling'],(0,_inherits2.default)(RemoveParticipantBehavior,_CommandInterceptor2.default);},{'../../../util/ModelUtil':159,'diagram-js/lib/command/CommandInterceptor':185,inherits:350}],110:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function ReplaceConnectionBehavior(eventBus,modeling,bpmnRules){function fixConnection(connection){var source=connection.source,target=connection.target,parent=connection.parent;if(!parent)return;var replacementType,remove;(0,_ModelUtil.is)(connection,'bpmn:SequenceFlow')&&(bpmnRules.canConnectSequenceFlow(source,target)||(remove=!0),bpmnRules.canConnectMessageFlow(source,target)&&(replacementType='bpmn:MessageFlow')),(0,_ModelUtil.is)(connection,'bpmn:MessageFlow')&&(bpmnRules.canConnectMessageFlow(source,target)||(remove=!0),bpmnRules.canConnectSequenceFlow(source,target)&&(replacementType='bpmn:SequenceFlow')),(0,_ModelUtil.is)(connection,'bpmn:Association')&&!bpmnRules.canConnectAssociation(source,target)&&(remove=!0),remove&&modeling.removeConnection(connection),replacementType&&modeling.connect(source,target,{type:replacementType,waypoints:connection.waypoints.slice()});}_CommandInterceptor2.default.call(this,eventBus),this.postExecuted('elements.move',function(context){var closure=context.closure,allConnections=closure.allConnections;(0,_minDash.forEach)(allConnections,fixConnection);},!0),this.postExecuted(['connection.reconnectStart','connection.reconnectEnd'],function(event){var connection=event.context.connection;fixConnection(connection);}),this.postExecuted('element.updateProperties',function(event){var context=event.context,properties=context.properties,element=context.element,businessObject=element.businessObject,connection;properties.default&&(connection=(0,_minDash.find)(element.outgoing,(0,_minDash.matchPattern)({id:element.businessObject.default.id})),connection&&modeling.updateProperties(connection,{conditionExpression:undefined})),properties.conditionExpression&&businessObject.sourceRef.default===businessObject&&modeling.updateProperties(element.source,{default:undefined});});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=ReplaceConnectionBehavior;var _minDash=require('min-dash');var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _CommandInterceptor=require('diagram-js/lib/command/CommandInterceptor');var _CommandInterceptor2=_interopRequireDefault(_CommandInterceptor);var _ModelUtil=require('../../../util/ModelUtil');(0,_inherits2.default)(ReplaceConnectionBehavior,_CommandInterceptor2.default),ReplaceConnectionBehavior.$inject=['eventBus','modeling','bpmnRules'];},{'../../../util/ModelUtil':159,'diagram-js/lib/command/CommandInterceptor':185,inherits:350,'min-dash':438}],111:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function ReplaceElementBehaviour(eventBus,bpmnReplace,bpmnRules,elementRegistry,selection,modeling){_CommandInterceptor2.default.call(this,eventBus),this._bpmnReplace=bpmnReplace,this._elementRegistry=elementRegistry,this._selection=selection,this._modeling=modeling,this.postExecuted(['elements.move'],500,function(event){var context=event.context,target=context.newParent,newHost=context.newHost,elements=[];(0,_minDash.forEach)(context.closure.topLevel,function(topLevelElements){(0,_DiUtil.isEventSubProcess)(topLevelElements)?elements=elements.concat(topLevelElements.children):elements=elements.concat(topLevelElements);}),elements.length===1&&newHost&&(target=newHost);var canReplace=bpmnRules.canReplace(elements,target);canReplace&&this.replaceElements(elements,canReplace.replacements,newHost);},this),this.postExecute(['shape.replace'],1500,function(e){var context=e.context,oldShape=context.oldShape,newShape=context.newShape,attachers=oldShape.attachers,canReplace;attachers&&attachers.length&&(canReplace=bpmnRules.canReplace(attachers,newShape),this.replaceElements(attachers,canReplace.replacements));},this),this.postExecuted(['shape.replace'],1500,function(e){var context=e.context,oldShape=context.oldShape,newShape=context.newShape;modeling.unclaimId(oldShape.businessObject.id,oldShape.businessObject),modeling.updateProperties(newShape,{id:oldShape.id});});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=ReplaceElementBehaviour;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _CommandInterceptor=require('diagram-js/lib/command/CommandInterceptor');var _CommandInterceptor2=_interopRequireDefault(_CommandInterceptor);var _minDash=require('min-dash');var _DiUtil=require('../../../util/DiUtil');var _ModelUtil=require('../../../util/ModelUtil');(0,_inherits2.default)(ReplaceElementBehaviour,_CommandInterceptor2.default),ReplaceElementBehaviour.prototype.replaceElements=function(elements,newElements,newHost){var elementRegistry=this._elementRegistry,bpmnReplace=this._bpmnReplace,selection=this._selection,modeling=this._modeling;(0,_minDash.forEach)(newElements,function(replacement){var newElement={type:replacement.newElementType};var oldElement=elementRegistry.get(replacement.oldElementId);newHost&&(0,_ModelUtil.is)(oldElement,'bpmn:BoundaryEvent')&&modeling.updateAttachment(oldElement,null);var idx=elements.indexOf(oldElement);elements[idx]=bpmnReplace.replaceElement(oldElement,newElement,{select:!1}),newHost&&(0,_ModelUtil.is)(elements[idx],'bpmn:BoundaryEvent')&&modeling.updateAttachment(elements[idx],newHost);}),newElements&&selection.select(elements);},ReplaceElementBehaviour.$inject=['eventBus','bpmnReplace','bpmnRules','elementRegistry','selection','modeling'];},{'../../../util/DiUtil':157,'../../../util/ModelUtil':159,'diagram-js/lib/command/CommandInterceptor':185,inherits:350,'min-dash':438}],112:[function(require,module,exports){'use strict';function ResizeLaneBehavior(eventBus,modeling){eventBus.on('resize.start',SLIGHTLY_HIGHER_PRIORITY+500,function(event){var context=event.context,shape=context.shape;((0,_ModelUtil.is)(shape,'bpmn:Lane')||(0,_ModelUtil.is)(shape,'bpmn:Participant'))&&(context.balanced=!(0,_Mouse.hasPrimaryModifier)(event));}),eventBus.on('resize.end',SLIGHTLY_HIGHER_PRIORITY,function(event){var context=event.context,shape=context.shape,canExecute=context.canExecute,newBounds=context.newBounds;return(0,_ModelUtil.is)(shape,'bpmn:Lane')||(0,_ModelUtil.is)(shape,'bpmn:Participant')?(canExecute&&(newBounds=(0,_LayoutUtil.roundBounds)(newBounds),modeling.resizeLane(shape,newBounds,context.balanced)),!1):void 0;});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=ResizeLaneBehavior;var _ModelUtil=require('../../../util/ModelUtil');var _LayoutUtil=require('diagram-js/lib/layout/LayoutUtil');var _Mouse=require('diagram-js/lib/util/Mouse');var SLIGHTLY_HIGHER_PRIORITY=1001;ResizeLaneBehavior.$inject=['eventBus','modeling'];},{'../../../util/ModelUtil':159,'diagram-js/lib/layout/LayoutUtil':317,'diagram-js/lib/util/Mouse':338}],113:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function ToggleElementCollapseBehaviour(eventBus,elementFactory,modeling,resize){function hideEmptyLables(children){children.length&&children.forEach(function(child){child.type==='label'&&!child.businessObject.name&&(child.hidden=!0);});}function expandedBounds(shape,defaultSize){var children=shape.children,newBounds=defaultSize,visibleElements,visibleBBox;return visibleElements=filterVisible(children).concat([shape]),visibleBBox=(0,_ResizeUtil.computeChildrenBBox)(visibleElements),visibleBBox?(newBounds.width=Math.max(visibleBBox.width,newBounds.width),newBounds.height=Math.max(visibleBBox.height,newBounds.height),newBounds.x=visibleBBox.x+(visibleBBox.width-newBounds.width)/2,newBounds.y=visibleBBox.y+(visibleBBox.height-newBounds.height)/2):(newBounds.x=shape.x+(shape.width-newBounds.width)/2,newBounds.y=shape.y+(shape.height-newBounds.height)/2),newBounds;}function collapsedBounds(shape,defaultSize){return{x:shape.x+(shape.width-defaultSize.width)/2,y:shape.y+(shape.height-defaultSize.height)/2,width:defaultSize.width,height:defaultSize.height};}_CommandInterceptor2.default.call(this,eventBus),this.executed(['shape.toggleCollapse'],LOW_PRIORITY,function(e){var context=e.context,shape=context.shape;if(!(0,_ModelUtil.is)(shape,'bpmn:SubProcess'))return;shape.collapsed?(0,_ModelUtil.getBusinessObject)(shape).di.isExpanded=!1:(hideEmptyLables(shape.children),(0,_ModelUtil.getBusinessObject)(shape).di.isExpanded=!0);}),this.reverted(['shape.toggleCollapse'],LOW_PRIORITY,function(e){var context=e.context;var shape=context.shape;shape.collapsed?(0,_ModelUtil.getBusinessObject)(shape).di.isExpanded=!1:(0,_ModelUtil.getBusinessObject)(shape).di.isExpanded=!0;}),this.postExecuted(['shape.toggleCollapse'],LOW_PRIORITY,function(e){var shape=e.context.shape,defaultSize=elementFactory._getDefaultSize(shape),newBounds;shape.collapsed?newBounds=collapsedBounds(shape,defaultSize):newBounds=expandedBounds(shape,defaultSize),modeling.resizeShape(shape,newBounds);});}function filterVisible(elements){return elements.filter(function(e){return!e.hidden;});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=ToggleElementCollapseBehaviour;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _CommandInterceptor=require('diagram-js/lib/command/CommandInterceptor');var _CommandInterceptor2=_interopRequireDefault(_CommandInterceptor);var _ModelUtil=require('../../../util/ModelUtil');var _ResizeUtil=require('diagram-js/lib/features/resize/ResizeUtil');var LOW_PRIORITY=500;(0,_inherits2.default)(ToggleElementCollapseBehaviour,_CommandInterceptor2.default),ToggleElementCollapseBehaviour.$inject=['eventBus','elementFactory','modeling'];},{'../../../util/ModelUtil':159,'diagram-js/lib/command/CommandInterceptor':185,'diagram-js/lib/features/resize/ResizeUtil':288,inherits:350}],114:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function UnclaimIdBehavior(eventBus,modeling){_CommandInterceptor2.default.call(this,eventBus),this.preExecute('elements.delete',function(event){var context=event.context,elements=context.elements;(0,_minDash.forEach)(elements,function(element){modeling.unclaimId(element.businessObject.id,element.businessObject);});});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=UnclaimIdBehavior;var _minDash=require('min-dash');var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _CommandInterceptor=require('diagram-js/lib/command/CommandInterceptor');var _CommandInterceptor2=_interopRequireDefault(_CommandInterceptor);(0,_inherits2.default)(UnclaimIdBehavior,_CommandInterceptor2.default),UnclaimIdBehavior.$inject=['eventBus','modeling'];},{'diagram-js/lib/command/CommandInterceptor':185,inherits:350,'min-dash':438}],115:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function DeleteSequenceFlowBehavior(eventBus,modeling){_CommandInterceptor2.default.call(this,eventBus),this.preExecute('connection.delete',function(event){var context=event.context,connection=context.connection,source=connection.source;isDefaultFlow(connection,source)&&modeling.updateProperties(source,{'default':null});});}function isDefaultFlow(connection,source){if(!(0,_ModelUtil.is)(connection,'bpmn:SequenceFlow'))return!1;var sourceBo=(0,_ModelUtil.getBusinessObject)(source),sequenceFlow=(0,_ModelUtil.getBusinessObject)(connection);return sourceBo.get('default')===sequenceFlow;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=DeleteSequenceFlowBehavior;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _CommandInterceptor=require('diagram-js/lib/command/CommandInterceptor');var _CommandInterceptor2=_interopRequireDefault(_CommandInterceptor);var _ModelUtil=require('../../../util/ModelUtil');(0,_inherits2.default)(DeleteSequenceFlowBehavior,_CommandInterceptor2.default),DeleteSequenceFlowBehavior.$inject=['eventBus','modeling'];},{'../../../util/ModelUtil':159,'diagram-js/lib/command/CommandInterceptor':185,inherits:350}],116:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function UpdateFlowNodeRefsBehavior(eventBus,modeling,translate){function initContext(){return context=context||new UpdateContext(),context.enter(),context;}function getContext(){if(!context)throw new Error(translate('out of bounds release'));return context;}function releaseContext(){if(!context)throw new Error(translate('out of bounds release'));var triggerUpdate=context.leave();return triggerUpdate&&(modeling.updateLaneRefs(context.flowNodes,context.lanes),context=null),triggerUpdate;}_CommandInterceptor2.default.call(this,eventBus);var context;var laneRefUpdateEvents=['spaceTool','lane.add','lane.resize','lane.split','elements.move','elements.delete','shape.create','shape.delete','shape.move','shape.resize'];this.preExecute(laneRefUpdateEvents,HIGH_PRIORITY,function(event){initContext();}),this.postExecuted(laneRefUpdateEvents,LOW_PRIORITY,function(event){releaseContext();}),this.preExecute(['shape.create','shape.move','shape.delete','shape.resize'],function(event){var context=event.context,shape=context.shape;var updateContext=getContext();if(shape.labelTarget)return;(0,_ModelUtil.is)(shape,'bpmn:Lane')&&updateContext.addLane(shape),(0,_ModelUtil.is)(shape,'bpmn:FlowNode')&&updateContext.addFlowNode(shape);});}function UpdateContext(){this.flowNodes=[],this.lanes=[],this.counter=0,this.addLane=function(lane){this.lanes.push(lane);},this.addFlowNode=function(flowNode){this.flowNodes.push(flowNode);},this.enter=function(){this.counter++;},this.leave=function(){return this.counter--,!this.counter;};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=UpdateFlowNodeRefsBehavior;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _CommandInterceptor=require('diagram-js/lib/command/CommandInterceptor');var _CommandInterceptor2=_interopRequireDefault(_CommandInterceptor);var _ModelUtil=require('../../../util/ModelUtil');var LOW_PRIORITY=500,HIGH_PRIORITY=5000;UpdateFlowNodeRefsBehavior.$inject=['eventBus','modeling','translate'],(0,_inherits2.default)(UpdateFlowNodeRefsBehavior,_CommandInterceptor2.default);},{'../../../util/ModelUtil':159,'diagram-js/lib/command/CommandInterceptor':185,inherits:350}],117:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _AdaptiveLabelPositioningBehavior=require('./AdaptiveLabelPositioningBehavior');var _AdaptiveLabelPositioningBehavior2=_interopRequireDefault(_AdaptiveLabelPositioningBehavior);var _AppendBehavior=require('./AppendBehavior');var _AppendBehavior2=_interopRequireDefault(_AppendBehavior);var _CopyPasteBehavior=require('./CopyPasteBehavior');var _CopyPasteBehavior2=_interopRequireDefault(_CopyPasteBehavior);var _CreateBoundaryEventBehavior=require('./CreateBoundaryEventBehavior');var _CreateBoundaryEventBehavior2=_interopRequireDefault(_CreateBoundaryEventBehavior);var _CreateDataObjectBehavior=require('./CreateDataObjectBehavior');var _CreateDataObjectBehavior2=_interopRequireDefault(_CreateDataObjectBehavior);var _CreateParticipantBehavior=require('./CreateParticipantBehavior');var _CreateParticipantBehavior2=_interopRequireDefault(_CreateParticipantBehavior);var _DataInputAssociationBehavior=require('./DataInputAssociationBehavior');var _DataInputAssociationBehavior2=_interopRequireDefault(_DataInputAssociationBehavior);var _DeleteLaneBehavior=require('./DeleteLaneBehavior');var _DeleteLaneBehavior2=_interopRequireDefault(_DeleteLaneBehavior);var _DropOnFlowBehavior=require('./DropOnFlowBehavior');var _DropOnFlowBehavior2=_interopRequireDefault(_DropOnFlowBehavior);var _ImportDockingFix=require('./ImportDockingFix');var _ImportDockingFix2=_interopRequireDefault(_ImportDockingFix);var _LabelBehavior=require('./LabelBehavior');var _LabelBehavior2=_interopRequireDefault(_LabelBehavior);var _ModelingFeedback=require('./ModelingFeedback');var _ModelingFeedback2=_interopRequireDefault(_ModelingFeedback);var _ReplaceConnectionBehavior=require('./ReplaceConnectionBehavior');var _ReplaceConnectionBehavior2=_interopRequireDefault(_ReplaceConnectionBehavior);var _RemoveParticipantBehavior=require('./RemoveParticipantBehavior');var _RemoveParticipantBehavior2=_interopRequireDefault(_RemoveParticipantBehavior);var _ReplaceElementBehaviour=require('./ReplaceElementBehaviour');var _ReplaceElementBehaviour2=_interopRequireDefault(_ReplaceElementBehaviour);var _ResizeLaneBehavior=require('./ResizeLaneBehavior');var _ResizeLaneBehavior2=_interopRequireDefault(_ResizeLaneBehavior);var _RemoveElementBehavior=require('./RemoveElementBehavior');var _RemoveElementBehavior2=_interopRequireDefault(_RemoveElementBehavior);var _ToggleElementCollapseBehaviour=require('./ToggleElementCollapseBehaviour');var _ToggleElementCollapseBehaviour2=_interopRequireDefault(_ToggleElementCollapseBehaviour);var _UnclaimIdBehavior=require('./UnclaimIdBehavior');var _UnclaimIdBehavior2=_interopRequireDefault(_UnclaimIdBehavior);var _UpdateFlowNodeRefsBehavior=require('./UpdateFlowNodeRefsBehavior');var _UpdateFlowNodeRefsBehavior2=_interopRequireDefault(_UpdateFlowNodeRefsBehavior);var _UnsetDefaultFlowBehavior=require('./UnsetDefaultFlowBehavior');var _UnsetDefaultFlowBehavior2=_interopRequireDefault(_UnsetDefaultFlowBehavior);exports.default={__init__:['adaptiveLabelPositioningBehavior','appendBehavior','copyPasteBehavior','createBoundaryEventBehavior','createDataObjectBehavior','createParticipantBehavior','dataInputAssociationBehavior','deleteLaneBehavior','dropOnFlowBehavior','importDockingFix','labelBehavior','modelingFeedback','removeElementBehavior','removeParticipantBehavior','replaceConnectionBehavior','replaceElementBehaviour','resizeLaneBehavior','toggleElementCollapseBehaviour','unclaimIdBehavior','unsetDefaultFlowBehavior','updateFlowNodeRefsBehavior'],adaptiveLabelPositioningBehavior:['type',_AdaptiveLabelPositioningBehavior2.default],appendBehavior:['type',_AppendBehavior2.default],copyPasteBehavior:['type',_CopyPasteBehavior2.default],createBoundaryEventBehavior:['type',_CreateBoundaryEventBehavior2.default],createDataObjectBehavior:['type',_CreateDataObjectBehavior2.default],createParticipantBehavior:['type',_CreateParticipantBehavior2.default],dataInputAssociationBehavior:['type',_DataInputAssociationBehavior2.default],deleteLaneBehavior:['type',_DeleteLaneBehavior2.default],dropOnFlowBehavior:['type',_DropOnFlowBehavior2.default],importDockingFix:['type',_ImportDockingFix2.default],labelBehavior:['type',_LabelBehavior2.default],modelingFeedback:['type',_ModelingFeedback2.default],replaceConnectionBehavior:['type',_ReplaceConnectionBehavior2.default],removeParticipantBehavior:['type',_RemoveParticipantBehavior2.default],replaceElementBehaviour:['type',_ReplaceElementBehaviour2.default],resizeLaneBehavior:['type',_ResizeLaneBehavior2.default],removeElementBehavior:['type',_RemoveElementBehavior2.default],toggleElementCollapseBehaviour:['type',_ToggleElementCollapseBehaviour2.default],unclaimIdBehavior:['type',_UnclaimIdBehavior2.default],updateFlowNodeRefsBehavior:['type',_UpdateFlowNodeRefsBehavior2.default],unsetDefaultFlowBehavior:['type',_UnsetDefaultFlowBehavior2.default]};},{'./AdaptiveLabelPositioningBehavior':96,'./AppendBehavior':97,'./CopyPasteBehavior':98,'./CreateBoundaryEventBehavior':99,'./CreateDataObjectBehavior':100,'./CreateParticipantBehavior':101,'./DataInputAssociationBehavior':102,'./DeleteLaneBehavior':103,'./DropOnFlowBehavior':104,'./ImportDockingFix':105,'./LabelBehavior':106,'./ModelingFeedback':107,'./RemoveElementBehavior':108,'./RemoveParticipantBehavior':109,'./ReplaceConnectionBehavior':110,'./ReplaceElementBehaviour':111,'./ResizeLaneBehavior':112,'./ToggleElementCollapseBehaviour':113,'./UnclaimIdBehavior':114,'./UnsetDefaultFlowBehavior':115,'./UpdateFlowNodeRefsBehavior':116}],118:[function(require,module,exports){'use strict';function vectorLength(v){return Math.sqrt(Math.pow(v.x,2)+Math.pow(v.y,2));}function getAngle(line){return Math.atan((line[1].y-line[0].y)/(line[1].x-line[0].x));}function rotateVector(vector,angle){return angle?{x:Math.cos(angle)*vector.x-Math.sin(angle)*vector.y,y:Math.sin(angle)*vector.x+Math.cos(angle)*vector.y}:vector;}function solveLambaSystem(a,b,c){var system=[{n:a[0]-c[0],lambda:b[0]},{n:a[1]-c[1],lambda:b[1]}];var n=system[0].n*b[0]+system[1].n*b[1],l=system[0].lambda*b[0]+system[1].lambda*b[1];return-n/l;}function perpendicularFoot(point,line){var a=line[0],b=line[1];var bd={x:b.x-a.x,y:b.y-a.y};var r=solveLambaSystem([a.x,a.y],[bd.x,bd.y],[point.x,point.y]);return{x:a.x+r*bd.x,y:a.y+r*bd.y};}function getDistancePointLine(point,line){var pfPoint=perpendicularFoot(point,line);var connectionVector={x:pfPoint.x-point.x,y:pfPoint.y-point.y};return vectorLength(connectionVector);}function getDistancePointPoint(point1,point2){return vectorLength({x:point1.x-point2.x,y:point1.y-point2.y});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.vectorLength=vectorLength,exports.getAngle=getAngle,exports.rotateVector=rotateVector,exports.perpendicularFoot=perpendicularFoot,exports.getDistancePointLine=getDistancePointLine,exports.getDistancePointPoint=getDistancePointPoint;},{}],119:[function(require,module,exports){'use strict';function findNewLabelLineStartIndex(oldWaypoints,newWaypoints,attachment,hints){var index=attachment.segmentIndex;var offset=newWaypoints.length-oldWaypoints.length;if(hints.segmentMove){var oldSegmentStartIndex=hints.segmentMove.segmentStartIndex,newSegmentStartIndex=hints.segmentMove.newSegmentStartIndex;return index===oldSegmentStartIndex?newSegmentStartIndex:index>=newSegmentStartIndex?index+offset<newSegmentStartIndex?newSegmentStartIndex:index+offset:index;}if(hints.bendpointMove){var insert=hints.bendpointMove.insert,bendpointIndex=hints.bendpointMove.bendpointIndex,newIndex;if(offset===0)return index;if(index>=bendpointIndex&&(newIndex=insert?index+1:index-1),index<bendpointIndex&&(newIndex=index,insert&&attachment.type!=='bendpoint'&&bendpointIndex-1===index)){var rel=relativePositionMidWaypoint(newWaypoints,bendpointIndex);rel<attachment.relativeLocation&&newIndex++;}return newIndex;}return offset===0?index:hints.connectionStart?index===0?0:null:hints.connectionEnd?index===oldWaypoints.length-2?newWaypoints.length-2:null:null;}function getLabelAdjustment(label,newWaypoints,oldWaypoints,hints){var x=0,y=0;var labelPosition=getLabelMid(label);var attachment=(0,_LineAttachmentUtil.getAttachment)(labelPosition,oldWaypoints),oldLabelLineIndex=attachment.segmentIndex,newLabelLineIndex=findNewLabelLineStartIndex(oldWaypoints,newWaypoints,attachment,hints);if(newLabelLineIndex===null)return{x:x,y:y};if(newLabelLineIndex<0||newLabelLineIndex>newWaypoints.length-2)return{x:x,y:y};var oldLabelLine=getLine(oldWaypoints,oldLabelLineIndex),newLabelLine=getLine(newWaypoints,newLabelLineIndex),oldFoot=attachment.position;var relativeFootPosition=getRelativeFootPosition(oldLabelLine,oldFoot),angleDelta=getAngleDelta(oldLabelLine,newLabelLine);if(attachment.type==='bendpoint'){var offset=newWaypoints.length-oldWaypoints.length,oldBendpointIndex=attachment.bendpointIndex,oldBendpoint=oldWaypoints[oldBendpointIndex];if(newWaypoints.indexOf(oldBendpoint)!==-1)return{x:x,y:y};if(offset===0){var newBendpoint=newWaypoints[oldBendpointIndex];return{x:newBendpoint.x-attachment.position.x,y:newBendpoint.y-attachment.position.y};}offset<0&&oldBendpointIndex!==0&&oldBendpointIndex<oldWaypoints.length-1&&(relativeFootPosition=relativePositionMidWaypoint(oldWaypoints,oldBendpointIndex));}var newFoot={x:(newLabelLine[1].x-newLabelLine[0].x)*relativeFootPosition+newLabelLine[0].x,y:(newLabelLine[1].y-newLabelLine[0].y)*relativeFootPosition+newLabelLine[0].y};var newLabelVector=(0,_GeometricUtil.rotateVector)({x:labelPosition.x-oldFoot.x,y:labelPosition.y-oldFoot.y},angleDelta);return x=newFoot.x+newLabelVector.x-labelPosition.x,y=newFoot.y+newLabelVector.y-labelPosition.y,(0,_LayoutUtil.roundPoint)({x:x,y:y});}function relativePositionMidWaypoint(waypoints,idx){var distanceSegment1=(0,_GeometricUtil.getDistancePointPoint)(waypoints[idx-1],waypoints[idx]),distanceSegment2=(0,_GeometricUtil.getDistancePointPoint)(waypoints[idx],waypoints[idx+1]);var relativePosition=distanceSegment1/(distanceSegment1+distanceSegment2);return relativePosition;}function getLabelMid(label){return{x:label.x+label.width/2,y:label.y+label.height/2};}function getAngleDelta(l1,l2){var a1=(0,_GeometricUtil.getAngle)(l1),a2=(0,_GeometricUtil.getAngle)(l2);return a2-a1;}function getLine(waypoints,idx){return[waypoints[idx],waypoints[idx+1]];}function getRelativeFootPosition(line,foot){var length=(0,_GeometricUtil.getDistancePointPoint)(line[0],line[1]),lengthToFoot=(0,_GeometricUtil.getDistancePointPoint)(line[0],foot);return length===0?0:lengthToFoot/length;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.findNewLabelLineStartIndex=findNewLabelLineStartIndex,exports.getLabelAdjustment=getLabelAdjustment;var _GeometricUtil=require('./GeometricUtil');var _LineAttachmentUtil=require('./LineAttachmentUtil');var _LayoutUtil=require('diagram-js/lib/layout/LayoutUtil');},{'./GeometricUtil':118,'./LineAttachmentUtil':120,'diagram-js/lib/layout/LayoutUtil':317}],120:[function(require,module,exports){'use strict';function sq(n){return Math.pow(n,2);}function getDistance(p1,p2){return sqrt(sq(p1.x-p2.x)+sq(p1.y-p2.y));}function getAttachment(point,line){var idx=0,segmentStart,segmentEnd,segmentStartDistance,segmentEndDistance,attachmentPosition,minDistance,intersections,attachment,attachmentDistance,closestAttachmentDistance,closestAttachment;for(idx=0;idx<line.length-1;idx++){if(segmentStart=line[idx],segmentEnd=line[idx+1],pointsEqual(segmentStart,segmentEnd)?intersections=[segmentStart]:(segmentStartDistance=getDistance(point,segmentStart),segmentEndDistance=getDistance(point,segmentEnd),minDistance=min(segmentStartDistance,segmentEndDistance),intersections=getCircleSegmentIntersections(segmentStart,segmentEnd,point,minDistance)),intersections.length<1)throw new Error('expected between [1, 2] circle -> line intersections');intersections.length===1&&(attachment={type:'bendpoint',position:intersections[0],segmentIndex:idx,bendpointIndex:pointsEqual(segmentStart,intersections[0])?idx:idx+1}),intersections.length===2&&(attachmentPosition=mid(intersections[0],intersections[1]),attachment={type:'segment',position:attachmentPosition,segmentIndex:idx,relativeLocation:getDistance(segmentStart,attachmentPosition)/getDistance(segmentStart,segmentEnd)}),attachmentDistance=getDistance(attachment.position,point),(!closestAttachment||closestAttachmentDistance>attachmentDistance)&&(closestAttachment=attachment,closestAttachmentDistance=attachmentDistance);}return closestAttachment;}function getCircleSegmentIntersections(s1,s2,cc,cr){var baX=s2.x-s1.x;var baY=s2.y-s1.y;var caX=cc.x-s1.x;var caY=cc.y-s1.y;var a=baX*baX+baY*baY;var bBy2=baX*caX+baY*caY;var c=caX*caX+caY*caY-cr*cr;var pBy2=bBy2/a;var q=c/a;var disc=pBy2*pBy2-q;if(disc<0&&disc>-0.000001&&(disc=0),disc<0)return[];var tmpSqrt=sqrt(disc);var abScalingFactor1=-pBy2+tmpSqrt;var abScalingFactor2=-pBy2-tmpSqrt;var i1={x:s1.x-baX*abScalingFactor1,y:s1.y-baY*abScalingFactor1};if(disc===0)return[i1];var i2={x:s1.x-baX*abScalingFactor2,y:s1.y-baY*abScalingFactor2};return[i1,i2].filter(function(p){return isPointInSegment(p,s1,s2);});}function isPointInSegment(p,segmentStart,segmentEnd){return fenced(p.x,segmentStart.x,segmentEnd.x)&&fenced(p.y,segmentStart.y,segmentEnd.y);}function fenced(n,rangeStart,rangeEnd){return n>=min(rangeStart,rangeEnd)-EQUAL_THRESHOLD&&n<=max(rangeStart,rangeEnd)+EQUAL_THRESHOLD;}function mid(p1,p2){return{x:(p1.x+p2.x)/2,y:(p1.y+p2.y)/2};}function pointsEqual(p1,p2){return abs(p1.x-p2.x)<=EQUAL_THRESHOLD&&abs(p1.y-p2.y)<=EQUAL_THRESHOLD;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.getAttachment=getAttachment;var sqrt=Math.sqrt,min=Math.min,max=Math.max,abs=Math.abs;var EQUAL_THRESHOLD=0.1;},{}],121:[function(require,module,exports){'use strict';function lineIntersect(l1s,l1e,l2s,l2e){var denominator,a,b,c,numerator;return denominator=(l2e.y-l2s.y)*(l1e.x-l1s.x)-(l2e.x-l2s.x)*(l1e.y-l1s.y),denominator==0?null:(a=l1s.y-l2s.y,b=l1s.x-l2s.x,numerator=(l2e.x-l2s.x)*a-(l2e.y-l2s.y)*b,c=numerator/denominator,{x:Math.round(l1s.x+c*(l1e.x-l1s.x)),y:Math.round(l1s.y+c*(l1e.y-l1s.y))});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=lineIntersect;},{}],122:[function(require,module,exports){'use strict';function AddLaneHandler(modeling,spaceTool){this._modeling=modeling,this._spaceTool=spaceTool;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=AddLaneHandler;var _minDash=require('min-dash');var _Elements=require('diagram-js/lib/util/Elements');var _LaneUtil=require('../util/LaneUtil');AddLaneHandler.$inject=['modeling','spaceTool'],AddLaneHandler.prototype.preExecute=function(context){var spaceTool=this._spaceTool,modeling=this._modeling;var shape=context.shape,location=context.location;var lanesRoot=(0,_LaneUtil.getLanesRoot)(shape);var isRoot=lanesRoot===shape,laneParent=isRoot?shape:shape.parent;var existingChildLanes=(0,_LaneUtil.getChildLanes)(laneParent);existingChildLanes.length||modeling.createShape({type:'bpmn:Lane'},{x:shape.x+_LaneUtil.LANE_INDENTATION,y:shape.y,width:shape.width-_LaneUtil.LANE_INDENTATION,height:shape.height},laneParent);var allAffected=[];(0,_Elements.eachElement)(lanesRoot,function(element){return allAffected.push(element),element===shape?[]:(0,_minDash.filter)(element.children,function(c){return c!==shape;});});var offset=location==='top'?-120:120,lanePosition=location==='top'?shape.y:shape.y+shape.height,spacePos=lanePosition+(location==='top'?10:-10),direction=location==='top'?'n':'s';var adjustments=spaceTool.calculateAdjustments(allAffected,'y',offset,spacePos);spaceTool.makeSpace(adjustments.movingShapes,adjustments.resizingShapes,{x:0,y:offset},direction),context.newLane=modeling.createShape({type:'bpmn:Lane'},{x:shape.x+(isRoot?_LaneUtil.LANE_INDENTATION:0),y:lanePosition-(location==='top'?120:0),width:shape.width-(isRoot?_LaneUtil.LANE_INDENTATION:0),height:120},laneParent);};},{'../util/LaneUtil':131,'diagram-js/lib/util/Elements':331,'min-dash':438}],123:[function(require,module,exports){'use strict';function IdClaimHandler(moddle){this._moddle=moddle;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=IdClaimHandler,IdClaimHandler.$inject=['moddle'],IdClaimHandler.prototype.execute=function(context){var ids=this._moddle.ids,id=context.id,element=context.element,claiming=context.claiming;claiming?ids.claim(id,element):ids.unclaim(id);},IdClaimHandler.prototype.revert=function(context){var ids=this._moddle.ids,id=context.id,element=context.element,claiming=context.claiming;claiming?ids.unclaim(id):ids.claim(id,element);};},{}],124:[function(require,module,exports){'use strict';function ResizeLaneHandler(modeling,spaceTool){this._modeling=modeling,this._spaceTool=spaceTool;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=ResizeLaneHandler;var _ModelUtil=require('../../../util/ModelUtil');var _LaneUtil=require('../util/LaneUtil');var _Elements=require('diagram-js/lib/util/Elements');var _LayoutUtil=require('diagram-js/lib/layout/LayoutUtil');var _ResizeUtil=require('diagram-js/lib/features/resize/ResizeUtil');ResizeLaneHandler.$inject=['modeling','spaceTool'],ResizeLaneHandler.prototype.preExecute=function(context){var shape=context.shape,newBounds=context.newBounds,balanced=context.balanced;balanced!==!1?this.resizeBalanced(shape,newBounds):this.resizeSpace(shape,newBounds);},ResizeLaneHandler.prototype.resizeBalanced=function(shape,newBounds){var modeling=this._modeling;var resizeNeeded=(0,_LaneUtil.computeLanesResize)(shape,newBounds);modeling.resizeShape(shape,newBounds),resizeNeeded.forEach(function(r){modeling.resizeShape(r.shape,r.newBounds);});},ResizeLaneHandler.prototype.resizeSpace=function(shape,newBounds){var spaceTool=this._spaceTool;var shapeTrbl=(0,_LayoutUtil.asTRBL)(shape),newTrbl=(0,_LayoutUtil.asTRBL)(newBounds);var trblDiff=(0,_ResizeUtil.substractTRBL)(newTrbl,shapeTrbl);var lanesRoot=(0,_LaneUtil.getLanesRoot)(shape);var allAffected=[],allLanes=[];(0,_Elements.eachElement)(lanesRoot,function(element){return allAffected.push(element),((0,_ModelUtil.is)(element,'bpmn:Lane')||(0,_ModelUtil.is)(element,'bpmn:Participant'))&&allLanes.push(element),element.children;});var change,spacePos,direction,offset,adjustments;(trblDiff.bottom||trblDiff.top)&&(change=trblDiff.bottom||trblDiff.top,spacePos=shape.y+(trblDiff.bottom?shape.height:0)+(trblDiff.bottom?-10:10),direction=trblDiff.bottom?'s':'n',offset=trblDiff.top>0||trblDiff.bottom<0?-change:change,adjustments=spaceTool.calculateAdjustments(allAffected,'y',offset,spacePos),spaceTool.makeSpace(adjustments.movingShapes,adjustments.resizingShapes,{x:0,y:change},direction)),(trblDiff.left||trblDiff.right)&&(change=trblDiff.right||trblDiff.left,spacePos=shape.x+(trblDiff.right?shape.width:0)+(trblDiff.right?-10:100),direction=trblDiff.right?'e':'w',offset=trblDiff.left>0||trblDiff.right<0?-change:change,adjustments=spaceTool.calculateAdjustments(allLanes,'x',offset,spacePos),spaceTool.makeSpace(adjustments.movingShapes,adjustments.resizingShapes,{x:change,y:0},direction));};},{'../../../util/ModelUtil':159,'../util/LaneUtil':131,'diagram-js/lib/features/resize/ResizeUtil':288,'diagram-js/lib/layout/LayoutUtil':317,'diagram-js/lib/util/Elements':331}],125:[function(require,module,exports){'use strict';function SetColorHandler(commandStack){this._commandStack=commandStack;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=SetColorHandler;var _minDash=require('min-dash');var DEFAULT_COLORS={fill:undefined,stroke:undefined};SetColorHandler.$inject=['commandStack'],SetColorHandler.prototype.postExecute=function(context){var elements=context.elements,colors=context.colors||DEFAULT_COLORS;var self=this;var di={};'fill'in colors&&(0,_minDash.assign)(di,{fill:colors.fill}),'stroke'in colors&&(0,_minDash.assign)(di,{stroke:colors.stroke}),(0,_minDash.forEach)(elements,function(element){self._commandStack.execute('element.updateProperties',{element:element,properties:{di:di}});});};},{'min-dash':438}],126:[function(require,module,exports){'use strict';function SplitLaneHandler(modeling,translate){this._modeling=modeling,this._translate=translate;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=SplitLaneHandler;var _LaneUtil=require('../util/LaneUtil');SplitLaneHandler.$inject=['modeling','translate'],SplitLaneHandler.prototype.preExecute=function(context){var modeling=this._modeling,translate=this._translate;var shape=context.shape,newLanesCount=context.count;var childLanes=(0,_LaneUtil.getChildLanes)(shape),existingLanesCount=childLanes.length;if(existingLanesCount>newLanesCount)throw new Error(translate('more than {count} child lanes',{count:newLanesCount}));var newLanesHeight=Math.round(shape.height/newLanesCount);var laneY,laneHeight,laneBounds,newLaneAttrs,idx;for(idx=0;idx<newLanesCount;idx++)laneY=shape.y+idx*newLanesHeight,idx===newLanesCount-1?laneHeight=shape.height-newLanesHeight*idx:laneHeight=newLanesHeight,laneBounds={x:shape.x+_LaneUtil.LANE_INDENTATION,y:laneY,width:shape.width-_LaneUtil.LANE_INDENTATION,height:laneHeight},idx<existingLanesCount?modeling.resizeShape(childLanes[idx],laneBounds):(newLaneAttrs={type:'bpmn:Lane'},modeling.createShape(newLaneAttrs,laneBounds,shape));};},{'../util/LaneUtil':131}],127:[function(require,module,exports){'use strict';function UpdateCanvasRootHandler(canvas,modeling){this._canvas=canvas,this._modeling=modeling;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=UpdateCanvasRootHandler;var _Collections=require('diagram-js/lib/util/Collections');UpdateCanvasRootHandler.$inject=['canvas','modeling'],UpdateCanvasRootHandler.prototype.execute=function(context){var canvas=this._canvas;var newRoot=context.newRoot,newRootBusinessObject=newRoot.businessObject,oldRoot=canvas.getRootElement(),oldRootBusinessObject=oldRoot.businessObject,bpmnDefinitions=oldRootBusinessObject.$parent,diPlane=oldRootBusinessObject.di;canvas.setRootElement(newRoot,!0),(0,_Collections.add)(bpmnDefinitions.rootElements,newRootBusinessObject),newRootBusinessObject.$parent=bpmnDefinitions,(0,_Collections.remove)(bpmnDefinitions.rootElements,oldRootBusinessObject),oldRootBusinessObject.$parent=null,oldRootBusinessObject.di=null,diPlane.bpmnElement=newRootBusinessObject,newRootBusinessObject.di=diPlane,context.oldRoot=oldRoot;},UpdateCanvasRootHandler.prototype.revert=function(context){var canvas=this._canvas;var newRoot=context.newRoot,newRootBusinessObject=newRoot.businessObject,oldRoot=context.oldRoot,oldRootBusinessObject=oldRoot.businessObject,bpmnDefinitions=newRootBusinessObject.$parent,diPlane=newRootBusinessObject.di;canvas.setRootElement(oldRoot,!0),(0,_Collections.remove)(bpmnDefinitions.rootElements,newRootBusinessObject),newRootBusinessObject.$parent=null,(0,_Collections.add)(bpmnDefinitions.rootElements,oldRootBusinessObject),oldRootBusinessObject.$parent=bpmnDefinitions,newRootBusinessObject.di=null,diPlane.bpmnElement=oldRootBusinessObject,oldRootBusinessObject.di=diPlane;};},{'diagram-js/lib/util/Collections':328}],128:[function(require,module,exports){'use strict';function UpdateFlowNodeRefsHandler(elementRegistry){this._elementRegistry=elementRegistry;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=UpdateFlowNodeRefsHandler;var _LaneUtil=require('../util/LaneUtil');var _ModelUtil=require('../../../util/ModelUtil');var _Collections=require('diagram-js/lib/util/Collections');var _LayoutUtil=require('diagram-js/lib/layout/LayoutUtil');var FLOW_NODE_REFS_ATTR='flowNodeRef',LANES_ATTR='lanes';UpdateFlowNodeRefsHandler.$inject=['elementRegistry'],UpdateFlowNodeRefsHandler.prototype.computeUpdates=function(flowNodeShapes,laneShapes){function isInLaneShape(element,laneShape){var laneTrbl=(0,_LayoutUtil.asTRBL)(laneShape);var elementMid={x:element.x+element.width/2,y:element.y+element.height/2};return elementMid.x>laneTrbl.left&&elementMid.x<laneTrbl.right&&elementMid.y>laneTrbl.top&&elementMid.y<laneTrbl.bottom;}function addFlowNodeShape(flowNodeShape){handledNodes[flowNodeShape.id]||(allFlowNodeShapes.push(flowNodeShape),handledNodes[flowNodeShape.id]=flowNodeShape);}function getAllLaneShapes(flowNodeShape){var root=(0,_LaneUtil.getLanesRoot)(flowNodeShape);return participantCache[root.id]||(participantCache[root.id]=(0,_LaneUtil.collectLanes)(root)),participantCache[root.id];}function getNewLanes(flowNodeShape){if(!flowNodeShape.parent)return[];var allLaneShapes=getAllLaneShapes(flowNodeShape);return allLaneShapes.filter(function(l){return isInLaneShape(flowNodeShape,l);}).map(function(shape){return shape.businessObject;});}var handledNodes={};var updates=[];var participantCache={};var allFlowNodeShapes=[];return laneShapes.forEach(function(laneShape){var root=(0,_LaneUtil.getLanesRoot)(laneShape);if(!root||handledNodes[root.id])return;var children=root.children.filter(function(c){return(0,_ModelUtil.is)(c,'bpmn:FlowNode');});children.forEach(addFlowNodeShape),handledNodes[root.id]=root;}),flowNodeShapes.forEach(addFlowNodeShape),allFlowNodeShapes.forEach(function(flowNodeShape){var flowNode=flowNodeShape.businessObject;var lanes=flowNode.get(LANES_ATTR),remove=lanes.slice(),add=getNewLanes(flowNodeShape);updates.push({flowNode:flowNode,remove:remove,add:add});}),laneShapes.forEach(function(laneShape){var lane=laneShape.businessObject;laneShape.parent||lane.get(FLOW_NODE_REFS_ATTR).forEach(function(flowNode){updates.push({flowNode:flowNode,remove:[lane],add:[]});});}),updates;},UpdateFlowNodeRefsHandler.prototype.execute=function(context){var updates=context.updates;updates||(updates=context.updates=this.computeUpdates(context.flowNodeShapes,context.laneShapes)),updates.forEach(function(update){var flowNode=update.flowNode,lanes=flowNode.get(LANES_ATTR);update.remove.forEach(function(oldLane){(0,_Collections.remove)(lanes,oldLane),(0,_Collections.remove)(oldLane.get(FLOW_NODE_REFS_ATTR),flowNode);}),update.add.forEach(function(newLane){(0,_Collections.add)(lanes,newLane),(0,_Collections.add)(newLane.get(FLOW_NODE_REFS_ATTR),flowNode);});});},UpdateFlowNodeRefsHandler.prototype.revert=function(context){var updates=context.updates;updates.forEach(function(update){var flowNode=update.flowNode,lanes=flowNode.get(LANES_ATTR);update.add.forEach(function(newLane){(0,_Collections.remove)(lanes,newLane),(0,_Collections.remove)(newLane.get(FLOW_NODE_REFS_ATTR),flowNode);}),update.remove.forEach(function(oldLane){(0,_Collections.add)(lanes,oldLane),(0,_Collections.add)(oldLane.get(FLOW_NODE_REFS_ATTR),flowNode);});});};},{'../../../util/ModelUtil':159,'../util/LaneUtil':131,'diagram-js/lib/layout/LayoutUtil':317,'diagram-js/lib/util/Collections':328}],129:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function UpdatePropertiesHandler(elementRegistry,moddle,translate,modeling){this._elementRegistry=elementRegistry,this._moddle=moddle,this._translate=translate,this._modeling=modeling,this._textUtil=new _Text2.default();}function isIdChange(properties,businessObject){return ID in properties&&properties[ID]!==businessObject[ID];}function getProperties(businessObject,properties){var propertyNames=(0,_minDash.keys)(properties);return(0,_minDash.reduce)(propertyNames,function(result,key){return key!==DI?result[key]=businessObject.get(key):result[key]=getDiProperties(businessObject.di,(0,_minDash.keys)(properties.di)),result;},{});}function getDiProperties(di,propertyNames){return(0,_minDash.reduce)(propertyNames,function(result,key){return result[key]=di.get(key),result;},{});}function setProperties(businessObject,properties){(0,_minDash.forEach)(properties,function(value,key){key!==DI?businessObject.set(key,value):businessObject.di&&setDiProperties(businessObject.di,value);});}function setDiProperties(di,properties){(0,_minDash.forEach)(properties,function(value,key){di.set(key,value);});}function unwrapBusinessObjects(properties){var unwrappedProps=(0,_minDash.assign)({},properties);return referencePropertyNames.forEach(function(name){name in properties&&(unwrappedProps[name]=(0,_ModelUtil.getBusinessObject)(unwrappedProps[name]));}),unwrappedProps;}function getLayoutedBounds(bounds,text,textUtil){var layoutedLabelDimensions=textUtil.getDimensions(text,{box:{width:90,height:30,x:bounds.width/2+bounds.x,y:bounds.height/2+bounds.y},style:EXTERNAL_LABEL_STYLE});return{x:Math.round(bounds.x+bounds.width/2-layoutedLabelDimensions.width/2),y:Math.round(bounds.y),width:Math.ceil(layoutedLabelDimensions.width),height:Math.ceil(layoutedLabelDimensions.height)};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=UpdatePropertiesHandler;var _minDash=require('min-dash');var _ModelUtil=require('../../../util/ModelUtil');var _Text=require('diagram-js/lib/util/Text');var _Text2=_interopRequireDefault(_Text);var DEFAULT_FLOW='default',NAME='name',ID='id',DI='di';var NULL_DIMENSIONS={width:0,height:0};UpdatePropertiesHandler.$inject=['elementRegistry','moddle','translate','modeling'],UpdatePropertiesHandler.prototype.execute=function(context){var element=context.element,changed=[element],translate=this._translate;if(!element)throw new Error(translate('element required'));var elementRegistry=this._elementRegistry,ids=this._moddle.ids;var businessObject=element.businessObject,properties=unwrapBusinessObjects(context.properties),oldProperties=context.oldProperties||getProperties(businessObject,properties);return isIdChange(properties,businessObject)&&(ids.unclaim(businessObject[ID]),elementRegistry.updateId(element,properties[ID]),ids.claim(properties[ID],businessObject)),DEFAULT_FLOW in properties&&(properties[DEFAULT_FLOW]&&changed.push(elementRegistry.get(properties[DEFAULT_FLOW].id)),businessObject[DEFAULT_FLOW]&&changed.push(elementRegistry.get(businessObject[DEFAULT_FLOW].id))),NAME in properties&&element.label&&(changed.push(element.label),element.label.hidden=!properties[NAME]),setProperties(businessObject,properties),context.oldProperties=oldProperties,context.changed=changed,changed;},UpdatePropertiesHandler.prototype.postExecute=function(context){var element=context.element,label=element.label;var text=label&&(0,_ModelUtil.getBusinessObject)(label).name;if(!text)return;var newLabelBounds=getLayoutedBounds(label,text,this._textUtil);this._modeling.resizeShape(label,newLabelBounds,NULL_DIMENSIONS);},UpdatePropertiesHandler.prototype.revert=function(context){var element=context.element,properties=context.properties,oldProperties=context.oldProperties,businessObject=element.businessObject,elementRegistry=this._elementRegistry,ids=this._moddle.ids;return setProperties(businessObject,oldProperties),isIdChange(properties,businessObject)&&(ids.unclaim(properties[ID]),elementRegistry.updateId(element,oldProperties[ID]),ids.claim(oldProperties[ID],businessObject)),context.changed;};var referencePropertyNames=['default'];var EXTERNAL_LABEL_STYLE={fontFamily:'Arial, sans-serif',fontSize:'11px'};},{'../../../util/ModelUtil':159,'diagram-js/lib/util/Text':344,'min-dash':438}],130:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _behavior=require('./behavior');var _behavior2=_interopRequireDefault(_behavior);var _rules=require('../rules');var _rules2=_interopRequireDefault(_rules);var _ordering=require('../ordering');var _ordering2=_interopRequireDefault(_ordering);var _replace=require('../replace');var _replace2=_interopRequireDefault(_replace);var _command=require('diagram-js/lib/command');var _command2=_interopRequireDefault(_command);var _tooltips=require('diagram-js/lib/features/tooltips');var _tooltips2=_interopRequireDefault(_tooltips);var _labelSupport=require('diagram-js/lib/features/label-support');var _labelSupport2=_interopRequireDefault(_labelSupport);var _attachSupport=require('diagram-js/lib/features/attach-support');var _attachSupport2=_interopRequireDefault(_attachSupport);var _selection=require('diagram-js/lib/features/selection');var _selection2=_interopRequireDefault(_selection);var _changeSupport=require('diagram-js/lib/features/change-support');var _changeSupport2=_interopRequireDefault(_changeSupport);var _spaceTool=require('diagram-js/lib/features/space-tool');var _spaceTool2=_interopRequireDefault(_spaceTool);var _BpmnFactory=require('./BpmnFactory');var _BpmnFactory2=_interopRequireDefault(_BpmnFactory);var _BpmnUpdater=require('./BpmnUpdater');var _BpmnUpdater2=_interopRequireDefault(_BpmnUpdater);var _ElementFactory=require('./ElementFactory');var _ElementFactory2=_interopRequireDefault(_ElementFactory);var _Modeling=require('./Modeling');var _Modeling2=_interopRequireDefault(_Modeling);var _BpmnLayouter=require('./BpmnLayouter');var _BpmnLayouter2=_interopRequireDefault(_BpmnLayouter);var _CroppingConnectionDocking=require('diagram-js/lib/layout/CroppingConnectionDocking');var _CroppingConnectionDocking2=_interopRequireDefault(_CroppingConnectionDocking);exports.default={__init__:['modeling','bpmnUpdater'],__depends__:[_behavior2.default,_rules2.default,_ordering2.default,_replace2.default,_command2.default,_tooltips2.default,_labelSupport2.default,_attachSupport2.default,_selection2.default,_changeSupport2.default,_spaceTool2.default],bpmnFactory:['type',_BpmnFactory2.default],bpmnUpdater:['type',_BpmnUpdater2.default],elementFactory:['type',_ElementFactory2.default],modeling:['type',_Modeling2.default],layouter:['type',_BpmnLayouter2.default],connectionDocking:['type',_CroppingConnectionDocking2.default]};},{'../ordering':134,'../replace':144,'../rules':146,'./BpmnFactory':91,'./BpmnLayouter':92,'./BpmnUpdater':93,'./ElementFactory':94,'./Modeling':95,'./behavior':117,'diagram-js/lib/command':187,'diagram-js/lib/features/attach-support':201,'diagram-js/lib/features/change-support':213,'diagram-js/lib/features/label-support':240,'diagram-js/lib/features/selection':298,'diagram-js/lib/features/space-tool':305,'diagram-js/lib/features/tooltips':309,'diagram-js/lib/layout/CroppingConnectionDocking':316}],131:[function(require,module,exports){'use strict';function getTRBLResize(oldBounds,newBounds){return(0,_ResizeUtil.substractTRBL)((0,_LayoutUtil.asTRBL)(newBounds),(0,_LayoutUtil.asTRBL)(oldBounds));}function collectLanes(shape,collectedShapes){return collectedShapes=collectedShapes||[],shape.children.filter(function(s){(0,_ModelUtil.is)(s,'bpmn:Lane')&&(collectLanes(s,collectedShapes),collectedShapes.push(s));}),collectedShapes;}function getChildLanes(shape){return shape.children.filter(function(c){return(0,_ModelUtil.is)(c,'bpmn:Lane');});}function getLanesRoot(shape){return(0,_ModelingUtil.getParent)(shape,LANE_PARENTS)||shape;}function computeLanesResize(shape,newBounds){var rootElement=getLanesRoot(shape);var initialShapes=(0,_ModelUtil.is)(rootElement,'bpmn:Process')?[]:[rootElement];var allLanes=collectLanes(rootElement,initialShapes),shapeTrbl=(0,_LayoutUtil.asTRBL)(shape),shapeNewTrbl=(0,_LayoutUtil.asTRBL)(newBounds),trblResize=getTRBLResize(shape,newBounds),resizeNeeded=[];return allLanes.forEach(function(other){if(other===shape)return;var topResize=0,rightResize=trblResize.right,bottomResize=0,leftResize=trblResize.left;var otherTrbl=(0,_LayoutUtil.asTRBL)(other);trblResize.top&&(abs(otherTrbl.bottom-shapeTrbl.top)<10&&(bottomResize=shapeNewTrbl.top-otherTrbl.bottom),abs(otherTrbl.top-shapeTrbl.top)<5&&(topResize=shapeNewTrbl.top-otherTrbl.top)),trblResize.bottom&&(abs(otherTrbl.top-shapeTrbl.bottom)<10&&(topResize=shapeNewTrbl.bottom-otherTrbl.top),abs(otherTrbl.bottom-shapeTrbl.bottom)<5&&(bottomResize=shapeNewTrbl.bottom-otherTrbl.bottom)),(topResize||rightResize||bottomResize||leftResize)&&resizeNeeded.push({shape:other,newBounds:(0,_ResizeUtil.resizeTRBL)(other,{top:topResize,right:rightResize,bottom:bottomResize,left:leftResize})});}),resizeNeeded;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.LANE_INDENTATION=undefined,exports.collectLanes=collectLanes,exports.getChildLanes=getChildLanes,exports.getLanesRoot=getLanesRoot,exports.computeLanesResize=computeLanesResize;var _ModelUtil=require('../../../util/ModelUtil');var _ModelingUtil=require('./ModelingUtil');var _LayoutUtil=require('diagram-js/lib/layout/LayoutUtil');var _ResizeUtil=require('diagram-js/lib/features/resize/ResizeUtil');var abs=Math.abs;var LANE_PARENTS=['bpmn:Participant','bpmn:Process','bpmn:SubProcess'];var LANE_INDENTATION=exports.LANE_INDENTATION=30;},{'../../../util/ModelUtil':159,'./ModelingUtil':132,'diagram-js/lib/features/resize/ResizeUtil':288,'diagram-js/lib/layout/LayoutUtil':317}],132:[function(require,module,exports){'use strict';function isAny(element,types){return(0,_minDash.some)(types,function(t){return(0,_ModelUtil.is)(element,t);});}function getParent(element,anyType){typeof anyType==='string'&&(anyType=[anyType]);while(element=element.parent)if(isAny(element,anyType))return element;return null;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.isAny=isAny,exports.getParent=getParent;var _minDash=require('min-dash');var _ModelUtil=require('../../../util/ModelUtil');},{'../../../util/ModelUtil':159,'min-dash':438}],133:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function BpmnOrderingProvider(eventBus,translate){function computeOrder(element){if(element.labelTarget)return{level:10};var entry=(0,_minDash.find)(orders,function(o){return(0,_ModelingUtil.isAny)(element,[o.type]);});return entry&&entry.order||{level:1};}function getOrder(element){var order=element.order;return order||(element.order=order=computeOrder(element)),order;}function findActualParent(element,newParent,containers){var actualParent=newParent;while(actualParent){if((0,_ModelingUtil.isAny)(actualParent,containers))break;actualParent=actualParent.parent;}if(!actualParent)throw new Error(translate('no parent for {element} in {parent}',{element:element.id,parent:newParent.id}));return actualParent;}_OrderingProvider2.default.call(this,eventBus);var orders=[{type:'bpmn:SubProcess',order:{level:6}},{type:'bpmn:SequenceFlow',order:{level:3,containers:['bpmn:Participant','bpmn:FlowElementsContainer']}},{type:'bpmn:DataAssociation',order:{level:9,containers:['bpmn:Collaboration','bpmn:Process']}},{type:'bpmn:MessageFlow',order:{level:9,containers:['bpmn:Collaboration']}},{type:'bpmn:Association',order:{level:6,containers:['bpmn:Participant','bpmn:FlowElementsContainer','bpmn:Collaboration']}},{type:'bpmn:BoundaryEvent',order:{level:8}},{type:'bpmn:FlowElement',order:{level:5}},{type:'bpmn:Participant',order:{level:-2}},{type:'bpmn:Lane',order:{level:-1}}];this.getOrdering=function(element,newParent){var elementOrder=getOrder(element);elementOrder.containers&&(newParent=findActualParent(element,newParent,elementOrder.containers));var currentIndex=newParent.children.indexOf(element);var insertIndex=(0,_minDash.findIndex)(newParent.children,function(child){return!element.labelTarget&&child.labelTarget?!1:elementOrder.level<getOrder(child).level;});return insertIndex!==-1&&currentIndex!==-1&&currentIndex<insertIndex&&(insertIndex-=1),{index:insertIndex,parent:newParent};};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=BpmnOrderingProvider;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _OrderingProvider=require('diagram-js/lib/features/ordering/OrderingProvider');var _OrderingProvider2=_interopRequireDefault(_OrderingProvider);var _ModelingUtil=require('../modeling/util/ModelingUtil');var _minDash=require('min-dash');BpmnOrderingProvider.$inject=['eventBus','translate'],(0,_inherits2.default)(BpmnOrderingProvider,_OrderingProvider2.default);},{'../modeling/util/ModelingUtil':132,'diagram-js/lib/features/ordering/OrderingProvider':272,inherits:350,'min-dash':438}],134:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _translate=require('diagram-js/lib/i18n/translate');var _translate2=_interopRequireDefault(_translate);var _BpmnOrderingProvider=require('./BpmnOrderingProvider');var _BpmnOrderingProvider2=_interopRequireDefault(_BpmnOrderingProvider);exports.default={__depends__:[_translate2.default],__init__:['bpmnOrderingProvider'],bpmnOrderingProvider:['type',_BpmnOrderingProvider2.default]};},{'./BpmnOrderingProvider':133,'diagram-js/lib/i18n/translate':313}],135:[function(require,module,exports){'use strict';function PaletteProvider(palette,create,elementFactory,spaceTool,lassoTool,handTool,globalConnect,translate){this._palette=palette,this._create=create,this._elementFactory=elementFactory,this._spaceTool=spaceTool,this._lassoTool=lassoTool,this._handTool=handTool,this._globalConnect=globalConnect,this._translate=translate,palette.registerProvider(this);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=PaletteProvider;var _minDash=require('min-dash');PaletteProvider.$inject=['palette','create','elementFactory','spaceTool','lassoTool','handTool','globalConnect','translate'],PaletteProvider.prototype.getPaletteEntries=function(element){function createAction(type,group,className,title,options){function createListener(event){var shape=elementFactory.createShape((0,_minDash.assign)({type:type},options));options&&(shape.businessObject.di.isExpanded=options.isExpanded),create.start(event,shape);}var shortType=type.replace(/^bpmn:/,'');return{group:group,className:className,title:title||translate('Create {type}',{type:shortType}),action:{dragstart:createListener,click:createListener}};}function createParticipant(event,collapsed){create.start(event,elementFactory.createParticipantShape(collapsed));}var actions={},create=this._create,elementFactory=this._elementFactory,spaceTool=this._spaceTool,lassoTool=this._lassoTool,handTool=this._handTool,globalConnect=this._globalConnect,translate=this._translate;return(0,_minDash.assign)(actions,{'hand-tool':{group:'tools',className:'bpmn-icon-hand-tool',title:translate('Activate the hand tool'),action:{click:function click(event){handTool.activateHand(event);}}},'lasso-tool':{group:'tools',className:'bpmn-icon-lasso-tool',title:translate('Activate the lasso tool'),action:{click:function click(event){lassoTool.activateSelection(event);}}},'space-tool':{group:'tools',className:'bpmn-icon-space-tool',title:translate('Activate the create/remove space tool'),action:{click:function click(event){spaceTool.activateSelection(event);}}},'global-connect-tool':{group:'tools',className:'bpmn-icon-connection-multi',title:translate('Activate the global connect tool'),action:{click:function click(event){globalConnect.toggle(event);}}},'tool-separator':{group:'tools',separator:!0},'create.start-event':createAction('bpmn:StartEvent','event','bpmn-icon-start-event-none'),'create.intermediate-event':createAction('bpmn:IntermediateThrowEvent','event','bpmn-icon-intermediate-event-none',translate('Create Intermediate/Boundary Event')),'create.end-event':createAction('bpmn:EndEvent','event','bpmn-icon-end-event-none'),'create.exclusive-gateway':createAction('bpmn:ExclusiveGateway','gateway','bpmn-icon-gateway-none',translate('Create Gateway')),'create.task':createAction('bpmn:Task','activity','bpmn-icon-task'),'create.data-object':createAction('bpmn:DataObjectReference','data-object','bpmn-icon-data-object'),'create.data-store':createAction('bpmn:DataStoreReference','data-store','bpmn-icon-data-store'),'create.subprocess-expanded':createAction('bpmn:SubProcess','activity','bpmn-icon-subprocess-expanded',translate('Create expanded SubProcess'),{isExpanded:!0}),'create.participant-expanded':{group:'collaboration',className:'bpmn-icon-participant',title:translate('Create Pool/Participant'),action:{dragstart:createParticipant,click:createParticipant}}}),actions;};},{'min-dash':438}],136:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _palette=require('diagram-js/lib/features/palette');var _palette2=_interopRequireDefault(_palette);var _create=require('diagram-js/lib/features/create');var _create2=_interopRequireDefault(_create);var _spaceTool=require('diagram-js/lib/features/space-tool');var _spaceTool2=_interopRequireDefault(_spaceTool);var _lassoTool=require('diagram-js/lib/features/lasso-tool');var _lassoTool2=_interopRequireDefault(_lassoTool);var _handTool=require('diagram-js/lib/features/hand-tool');var _handTool2=_interopRequireDefault(_handTool);var _translate=require('diagram-js/lib/i18n/translate');var _translate2=_interopRequireDefault(_translate);var _globalConnect=require('../global-connect');var _globalConnect2=_interopRequireDefault(_globalConnect);var _PaletteProvider=require('./PaletteProvider');var _PaletteProvider2=_interopRequireDefault(_PaletteProvider);exports.default={__depends__:[_palette2.default,_create2.default,_spaceTool2.default,_lassoTool2.default,_handTool2.default,_translate2.default,_globalConnect2.default],__init__:['paletteProvider'],paletteProvider:['type',_PaletteProvider2.default]};},{'../global-connect':83,'./PaletteProvider':135,'diagram-js/lib/features/create':223,'diagram-js/lib/features/hand-tool':234,'diagram-js/lib/features/lasso-tool':242,'diagram-js/lib/features/palette':278,'diagram-js/lib/features/space-tool':305,'diagram-js/lib/i18n/translate':313}],137:[function(require,module,exports){'use strict';function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;else{var newObj={};if(obj!=null)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj;}}function ReplaceMenuProvider(popupMenu,modeling,moddle,bpmnReplace,rules,translate){this._popupMenu=popupMenu,this._modeling=modeling,this._moddle=moddle,this._bpmnReplace=bpmnReplace,this._rules=rules,this._translate=translate,this.register();}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=ReplaceMenuProvider;var _ModelUtil=require('../../util/ModelUtil');var _DiUtil=require('../../util/DiUtil');var _TypeUtil=require('./util/TypeUtil');var _minDash=require('min-dash');var _ReplaceOptions=require('../replace/ReplaceOptions');var replaceOptions=_interopRequireWildcard(_ReplaceOptions);ReplaceMenuProvider.$inject=['popupMenu','modeling','moddle','bpmnReplace','rules','translate'],ReplaceMenuProvider.prototype.register=function(){this._popupMenu.registerProvider('bpmn-replace',this);},ReplaceMenuProvider.prototype.getEntries=function(element){var businessObject=element.businessObject;var rules=this._rules;var entries;if(!rules.allowed('shape.replace',{element:element}))return[];var differentType=(0,_TypeUtil.isDifferentType)(element);return(0,_ModelUtil.is)(businessObject,'bpmn:StartEvent')&&!(0,_DiUtil.isEventSubProcess)(businessObject.$parent)?(entries=(0,_minDash.filter)(replaceOptions.START_EVENT,differentType),this._createEntries(element,entries)):(0,_ModelUtil.is)(businessObject,'bpmn:Participant')?(entries=(0,_minDash.filter)(replaceOptions.PARTICIPANT,function(entry){return(0,_DiUtil.isExpanded)(businessObject)!==entry.target.isExpanded;}),this._createEntries(element,entries)):(0,_ModelUtil.is)(businessObject,'bpmn:StartEvent')&&(0,_DiUtil.isEventSubProcess)(businessObject.$parent)?(entries=(0,_minDash.filter)(replaceOptions.EVENT_SUB_PROCESS_START_EVENT,function(entry){var target=entry.target;var isInterrupting=target.isInterrupting!==!1;var isInterruptingEqual=(0,_ModelUtil.getBusinessObject)(element).isInterrupting===isInterrupting;return differentType(entry)||!differentType(entry)&&!isInterruptingEqual;}),this._createEntries(element,entries)):(0,_ModelUtil.is)(businessObject,'bpmn:EndEvent')?(entries=(0,_minDash.filter)(replaceOptions.END_EVENT,function(entry){var target=entry.target;return target.eventDefinitionType=='bpmn:CancelEventDefinition'&&!(0,_ModelUtil.is)(businessObject.$parent,'bpmn:Transaction')?!1:differentType(entry);}),this._createEntries(element,entries)):(0,_ModelUtil.is)(businessObject,'bpmn:BoundaryEvent')?(entries=(0,_minDash.filter)(replaceOptions.BOUNDARY_EVENT,function(entry){var target=entry.target;if(target.eventDefinition=='bpmn:CancelEventDefinition'&&!(0,_ModelUtil.is)(businessObject.attachedToRef,'bpmn:Transaction'))return!1;var cancelActivity=target.cancelActivity!==!1;var isCancelActivityEqual=businessObject.cancelActivity==cancelActivity;return differentType(entry)||!differentType(entry)&&!isCancelActivityEqual;}),this._createEntries(element,entries)):(0,_ModelUtil.is)(businessObject,'bpmn:IntermediateCatchEvent')||(0,_ModelUtil.is)(businessObject,'bpmn:IntermediateThrowEvent')?(entries=(0,_minDash.filter)(replaceOptions.INTERMEDIATE_EVENT,differentType),this._createEntries(element,entries)):(0,_ModelUtil.is)(businessObject,'bpmn:Gateway')?(entries=(0,_minDash.filter)(replaceOptions.GATEWAY,differentType),this._createEntries(element,entries)):(0,_ModelUtil.is)(businessObject,'bpmn:Transaction')?(entries=(0,_minDash.filter)(replaceOptions.TRANSACTION,differentType),this._createEntries(element,entries)):(0,_DiUtil.isEventSubProcess)(businessObject)&&(0,_DiUtil.isExpanded)(businessObject)?(entries=(0,_minDash.filter)(replaceOptions.EVENT_SUB_PROCESS,differentType),this._createEntries(element,entries)):(0,_ModelUtil.is)(businessObject,'bpmn:SubProcess')&&(0,_DiUtil.isExpanded)(businessObject)?(entries=(0,_minDash.filter)(replaceOptions.SUBPROCESS_EXPANDED,differentType),this._createEntries(element,entries)):(0,_ModelUtil.is)(businessObject,'bpmn:AdHocSubProcess')&&!(0,_DiUtil.isExpanded)(businessObject)?(entries=(0,_minDash.filter)(replaceOptions.TASK,function(entry){var target=entry.target;var isTargetSubProcess=target.type==='bpmn:SubProcess';var isTargetExpanded=target.isExpanded===!0;return(0,_TypeUtil.isDifferentType)(element,target)&&(!isTargetSubProcess||isTargetExpanded);}),this._createEntries(element,entries)):(0,_ModelUtil.is)(businessObject,'bpmn:SequenceFlow')?this._createSequenceFlowEntries(element,replaceOptions.SEQUENCE_FLOW):(0,_ModelUtil.is)(businessObject,'bpmn:FlowNode')?(entries=(0,_minDash.filter)(replaceOptions.TASK,differentType),(0,_ModelUtil.is)(businessObject,'bpmn:SubProcess')&&!(0,_DiUtil.isExpanded)(businessObject)&&(entries=(0,_minDash.filter)(entries,function(entry){return entry.label!=='Sub Process (collapsed)';})),this._createEntries(element,entries)):[];},ReplaceMenuProvider.prototype.getHeaderEntries=function(element){var headerEntries=[];return(0,_ModelUtil.is)(element,'bpmn:Activity')&&!(0,_DiUtil.isEventSubProcess)(element)&&(headerEntries=headerEntries.concat(this._getLoopEntries(element))),(0,_ModelUtil.is)(element,'bpmn:SubProcess')&&!(0,_ModelUtil.is)(element,'bpmn:Transaction')&&!(0,_DiUtil.isEventSubProcess)(element)&&headerEntries.push(this._getAdHocEntry(element)),headerEntries;},ReplaceMenuProvider.prototype._createEntries=function(element,replaceOptions){var menuEntries=[];var self=this;return(0,_minDash.forEach)(replaceOptions,function(definition){var entry=self._createMenuEntry(definition,element);menuEntries.push(entry);}),menuEntries;},ReplaceMenuProvider.prototype._createSequenceFlowEntries=function(element,replaceOptions){var businessObject=(0,_ModelUtil.getBusinessObject)(element);var menuEntries=[];var modeling=this._modeling,moddle=this._moddle;var self=this;return(0,_minDash.forEach)(replaceOptions,function(entry){switch(entry.actionName){case'replace-with-default-flow':businessObject.sourceRef.default!==businessObject&&((0,_ModelUtil.is)(businessObject.sourceRef,'bpmn:ExclusiveGateway')||(0,_ModelUtil.is)(businessObject.sourceRef,'bpmn:InclusiveGateway')||(0,_ModelUtil.is)(businessObject.sourceRef,'bpmn:ComplexGateway')||(0,_ModelUtil.is)(businessObject.sourceRef,'bpmn:Activity'))&&menuEntries.push(self._createMenuEntry(entry,element,function(){modeling.updateProperties(element.source,{default:businessObject});}));break;case'replace-with-conditional-flow':!businessObject.conditionExpression&&(0,_ModelUtil.is)(businessObject.sourceRef,'bpmn:Activity')&&menuEntries.push(self._createMenuEntry(entry,element,function(){var conditionExpression=moddle.create('bpmn:FormalExpression',{body:''});modeling.updateProperties(element,{conditionExpression:conditionExpression});}));break;default:if((0,_ModelUtil.is)(businessObject.sourceRef,'bpmn:Activity')&&businessObject.conditionExpression)return menuEntries.push(self._createMenuEntry(entry,element,function(){modeling.updateProperties(element,{conditionExpression:undefined});}));if(((0,_ModelUtil.is)(businessObject.sourceRef,'bpmn:ExclusiveGateway')||(0,_ModelUtil.is)(businessObject.sourceRef,'bpmn:InclusiveGateway')||(0,_ModelUtil.is)(businessObject.sourceRef,'bpmn:ComplexGateway')||(0,_ModelUtil.is)(businessObject.sourceRef,'bpmn:Activity'))&&businessObject.sourceRef.default===businessObject)return menuEntries.push(self._createMenuEntry(entry,element,function(){modeling.updateProperties(element.source,{default:undefined});}));}}),menuEntries;},ReplaceMenuProvider.prototype._createMenuEntry=function(definition,element,action){var translate=this._translate;var replaceElement=this._bpmnReplace.replaceElement;var replaceAction=function replaceAction(){return replaceElement(element,definition.target);};action=action||replaceAction;var menuEntry={label:translate(definition.label),className:definition.className,id:definition.actionName,action:action};return menuEntry;},ReplaceMenuProvider.prototype._getLoopEntries=function(element){function toggleLoopEntry(event,entry){var loopCharacteristics;entry.active?loopCharacteristics=undefined:(loopCharacteristics=self._moddle.create(entry.options.loopCharacteristics),entry.options.isSequential&&(loopCharacteristics.isSequential=entry.options.isSequential)),self._modeling.updateProperties(element,{loopCharacteristics:loopCharacteristics});}var self=this;var translate=this._translate;var businessObject=(0,_ModelUtil.getBusinessObject)(element),loopCharacteristics=businessObject.loopCharacteristics;var isSequential,isLoop,isParallel;loopCharacteristics&&(isSequential=loopCharacteristics.isSequential,isLoop=loopCharacteristics.isSequential===undefined,isParallel=loopCharacteristics.isSequential!==undefined&&!loopCharacteristics.isSequential);var loopEntries=[{id:'toggle-parallel-mi',className:'bpmn-icon-parallel-mi-marker',title:translate('Parallel Multi Instance'),active:isParallel,action:toggleLoopEntry,options:{loopCharacteristics:'bpmn:MultiInstanceLoopCharacteristics',isSequential:!1}},{id:'toggle-sequential-mi',className:'bpmn-icon-sequential-mi-marker',title:translate('Sequential Multi Instance'),active:isSequential,action:toggleLoopEntry,options:{loopCharacteristics:'bpmn:MultiInstanceLoopCharacteristics',isSequential:!0}},{id:'toggle-loop',className:'bpmn-icon-loop-marker',title:translate('Loop'),active:isLoop,action:toggleLoopEntry,options:{loopCharacteristics:'bpmn:StandardLoopCharacteristics'}}];return loopEntries;},ReplaceMenuProvider.prototype._getAdHocEntry=function(element){var translate=this._translate;var businessObject=(0,_ModelUtil.getBusinessObject)(element);var isAdHoc=(0,_ModelUtil.is)(businessObject,'bpmn:AdHocSubProcess');var replaceElement=this._bpmnReplace.replaceElement;var adHocEntry={id:'toggle-adhoc',className:'bpmn-icon-ad-hoc-marker',title:translate('Ad-hoc'),active:isAdHoc,action:function action(event,entry){return isAdHoc?replaceElement(element,{type:'bpmn:SubProcess'}):replaceElement(element,{type:'bpmn:AdHocSubProcess'});}};return adHocEntry;};},{'../../util/DiUtil':157,'../../util/ModelUtil':159,'../replace/ReplaceOptions':143,'./util/TypeUtil':139,'min-dash':438}],138:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _popupMenu=require('diagram-js/lib/features/popup-menu');var _popupMenu2=_interopRequireDefault(_popupMenu);var _replace=require('../replace');var _replace2=_interopRequireDefault(_replace);var _ReplaceMenuProvider=require('./ReplaceMenuProvider');var _ReplaceMenuProvider2=_interopRequireDefault(_ReplaceMenuProvider);exports.default={__depends__:[_popupMenu2.default,_replace2.default],__init__:['replaceMenuProvider'],replaceMenuProvider:['type',_ReplaceMenuProvider2.default]};},{'../replace':144,'./ReplaceMenuProvider':137,'diagram-js/lib/features/popup-menu':280}],139:[function(require,module,exports){'use strict';function isDifferentType(element){return function(entry){var target=entry.target;var businessObject=(0,_ModelUtil.getBusinessObject)(element),eventDefinition=businessObject.eventDefinitions&&businessObject.eventDefinitions[0];var isTypeEqual=businessObject.$type===target.type;var isEventDefinitionEqual=(eventDefinition&&eventDefinition.$type)===target.eventDefinitionType;var isTriggeredByEventEqual=businessObject.triggeredByEvent===target.triggeredByEvent;var isExpandedEqual=target.isExpanded===undefined||target.isExpanded===(0,_DiUtil.isExpanded)(businessObject);return!isTypeEqual||!isEventDefinitionEqual||!isTriggeredByEventEqual||!isExpandedEqual;};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.isDifferentType=isDifferentType;var _ModelUtil=require('../../../util/ModelUtil');var _DiUtil=require('../../../util/DiUtil');},{'../../../util/DiUtil':157,'../../../util/ModelUtil':159}],140:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function BpmnReplacePreview(eventBus,elementRegistry,elementFactory,canvas,previewSupport){function replaceVisual(context){var replacements=context.canExecute.replacements;(0,_minDash.forEach)(replacements,function(replacement){var id=replacement.oldElementId;var newElement={type:replacement.newElementType};if(context.visualReplacements[id])return;var element=elementRegistry.get(id);(0,_minDash.assign)(newElement,{x:element.x,y:element.y});var tempShape=elementFactory.createShape(newElement);canvas.addShape(tempShape,element.parent);var gfx=(0,_minDom.query)('[data-element-id="'+(0,_css2.default)(element.id)+'"]',context.dragGroup);gfx&&(0,_tinySvg.attr)(gfx,{display:'none'});var dragger=previewSupport.addDragger(tempShape,context.dragGroup);context.visualReplacements[id]=dragger,canvas.removeShape(tempShape);});}function restoreVisual(context){var visualReplacements=context.visualReplacements;(0,_minDash.forEach)(visualReplacements,function(dragger,id){var originalGfx=(0,_minDom.query)('[data-element-id="'+(0,_css2.default)(id)+'"]',context.dragGroup);originalGfx&&(0,_tinySvg.attr)(originalGfx,{display:'inline'}),dragger.remove(),visualReplacements[id]&&delete visualReplacements[id];});}_CommandInterceptor2.default.call(this,eventBus),eventBus.on('shape.move.move',LOW_PRIORITY,function(event){var context=event.context,canExecute=context.canExecute;context.visualReplacements||(context.visualReplacements={}),canExecute.replacements?replaceVisual(context):restoreVisual(context);});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=BpmnReplacePreview;var _CommandInterceptor=require('diagram-js/lib/command/CommandInterceptor');var _CommandInterceptor2=_interopRequireDefault(_CommandInterceptor);var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _css=require('css.escape');var _css2=_interopRequireDefault(_css);var _minDash=require('min-dash');var _minDom=require('min-dom');var _tinySvg=require('tiny-svg');var LOW_PRIORITY=250;BpmnReplacePreview.$inject=['eventBus','elementRegistry','elementFactory','canvas','previewSupport'],(0,_inherits2.default)(BpmnReplacePreview,_CommandInterceptor2.default);},{'css.escape':179,'diagram-js/lib/command/CommandInterceptor':185,inherits:350,'min-dash':438,'min-dom':439,'tiny-svg':468}],141:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _previewSupport=require('diagram-js/lib/features/preview-support');var _previewSupport2=_interopRequireDefault(_previewSupport);var _BpmnReplacePreview=require('./BpmnReplacePreview');var _BpmnReplacePreview2=_interopRequireDefault(_BpmnReplacePreview);exports.default={__depends__:[_previewSupport2.default],__init__:['bpmnReplacePreview'],bpmnReplacePreview:['type',_BpmnReplacePreview2.default]};},{'./BpmnReplacePreview':140,'diagram-js/lib/features/preview-support':282}],142:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function toggeling(element,target){var oldCollapsed=element&&(0,_minDash.has)(element,'collapsed')?element.collapsed:!(0,_DiUtil.isExpanded)(element);var targetCollapsed;return target&&((0,_minDash.has)(target,'collapsed')||(0,_minDash.has)(target,'isExpanded'))?targetCollapsed=(0,_minDash.has)(target,'collapsed')?target.collapsed:!target.isExpanded:targetCollapsed=oldCollapsed,oldCollapsed!==targetCollapsed?(element.collapsed=oldCollapsed,!0):!1;}function BpmnReplace(bpmnFactory,replace,selection,modeling,eventBus){function replaceElement(element,target,hints){hints=hints||{};var type=target.type,oldBusinessObject=element.businessObject;if(isSubProcess(oldBusinessObject)&&type==='bpmn:SubProcess'&&toggeling(element,target))return modeling.toggleCollapse(element),element;var newBusinessObject=bpmnFactory.create(type);var newElement={type:type,businessObject:newBusinessObject};var elementProps=(0,_ModelCloneUtils.getProperties)(oldBusinessObject.$descriptor),newElementProps=(0,_ModelCloneUtils.getProperties)(newBusinessObject.$descriptor,!0),properties=(0,_minDash.uniqueBy)(function(e){return e;},(0,_minDash.filter)(elementProps,function(value){return(0,_minDash.findIndex)(newElementProps,value)!==-1;}));return(0,_minDash.assign)(newBusinessObject,(0,_minDash.pick)(target,CUSTOM_PROPERTIES)),properties=(0,_minDash.filter)(properties,function(property){var propName=property.replace(/bpmn:/,'');return newBusinessObject[property]!==undefined?!1:propName==='loopCharacteristics'?!(0,_DiUtil.isEventSubProcess)(newBusinessObject):propName==='processRef'&&target.isExpanded===!1||propName==='triggeredByEvent'||propName==='eventDefinitions'?!1:_ModelCloneUtils.IGNORED_PROPERTIES.indexOf(propName)===-1;}),newBusinessObject=helper.clone(oldBusinessObject,newBusinessObject,properties),target.eventDefinitionType&&(newElement.eventDefinitionType=target.eventDefinitionType),(0,_ModelUtil.is)(oldBusinessObject,'bpmn:Activity')&&(isSubProcess(oldBusinessObject)?newElement.isExpanded=(0,_DiUtil.isExpanded)(oldBusinessObject):target&&(0,_minDash.has)(target,'isExpanded')&&(newElement.isExpanded=target.isExpanded),(0,_DiUtil.isExpanded)(oldBusinessObject)&&!(0,_ModelUtil.is)(oldBusinessObject,'bpmn:Task')&&newElement.isExpanded&&(newElement.width=element.width,newElement.height=element.height)),isSubProcess(oldBusinessObject)&&!isSubProcess(newBusinessObject)&&(hints.moveChildren=!1),(0,_ModelUtil.is)(oldBusinessObject,'bpmn:Participant')&&(target.isExpanded===!0?newBusinessObject.processRef=bpmnFactory.create('bpmn:Process'):hints.moveChildren=!1,newElement.width=element.width,newElement.height=element.height),newBusinessObject.name=oldBusinessObject.name,(0,_ModelingUtil.isAny)(oldBusinessObject,['bpmn:ExclusiveGateway','bpmn:InclusiveGateway','bpmn:Activity'])&&(0,_ModelingUtil.isAny)(newBusinessObject,['bpmn:ExclusiveGateway','bpmn:InclusiveGateway','bpmn:Activity'])&&(newBusinessObject.default=oldBusinessObject.default),('fill'in oldBusinessObject.di||'stroke'in oldBusinessObject.di)&&(0,_minDash.assign)(newElement,{colors:(0,_minDash.pick)(oldBusinessObject.di,['fill','stroke'])}),newElement=replace.replaceElement(element,newElement,hints),hints.select!==!1&&selection.select(newElement),newElement;}var helper=new _ModelCloneHelper2.default(eventBus,bpmnFactory);this.replaceElement=replaceElement;}function isSubProcess(bo){return(0,_ModelUtil.is)(bo,'bpmn:SubProcess');}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=BpmnReplace;var _minDash=require('min-dash');var _ModelUtil=require('../../util/ModelUtil');var _ModelingUtil=require('../modeling/util/ModelingUtil');var _DiUtil=require('../../util/DiUtil');var _ModelCloneUtils=require('../../util/model/ModelCloneUtils');var _ModelCloneHelper=require('../../util/model/ModelCloneHelper');var _ModelCloneHelper2=_interopRequireDefault(_ModelCloneHelper);var CUSTOM_PROPERTIES=['cancelActivity','instantiate','eventGatewayType','triggeredByEvent','isInterrupting'];BpmnReplace.$inject=['bpmnFactory','replace','selection','modeling','eventBus'];},{'../../util/DiUtil':157,'../../util/ModelUtil':159,'../../util/model/ModelCloneHelper':161,'../../util/model/ModelCloneUtils':162,'../modeling/util/ModelingUtil':132,'min-dash':438}],143:[function(require,module,exports){'use strict';Object.defineProperty(exports,'__esModule',{value:!0});var START_EVENT=exports.START_EVENT=[{label:'Start Event',actionName:'replace-with-none-start',className:'bpmn-icon-start-event-none',target:{type:'bpmn:StartEvent'}},{label:'Intermediate Throw Event',actionName:'replace-with-none-intermediate-throwing',className:'bpmn-icon-intermediate-event-none',target:{type:'bpmn:IntermediateThrowEvent'}},{label:'End Event',actionName:'replace-with-none-end',className:'bpmn-icon-end-event-none',target:{type:'bpmn:EndEvent'}},{label:'Message Start Event',actionName:'replace-with-message-start',className:'bpmn-icon-start-event-message',target:{type:'bpmn:StartEvent',eventDefinitionType:'bpmn:MessageEventDefinition'}},{label:'Timer Start Event',actionName:'replace-with-timer-start',className:'bpmn-icon-start-event-timer',target:{type:'bpmn:StartEvent',eventDefinitionType:'bpmn:TimerEventDefinition'}},{label:'Conditional Start Event',actionName:'replace-with-conditional-start',className:'bpmn-icon-start-event-condition',target:{type:'bpmn:StartEvent',eventDefinitionType:'bpmn:ConditionalEventDefinition'}},{label:'Signal Start Event',actionName:'replace-with-signal-start',className:'bpmn-icon-start-event-signal',target:{type:'bpmn:StartEvent',eventDefinitionType:'bpmn:SignalEventDefinition'}}];var INTERMEDIATE_EVENT=exports.INTERMEDIATE_EVENT=[{label:'Start Event',actionName:'replace-with-none-start',className:'bpmn-icon-start-event-none',target:{type:'bpmn:StartEvent'}},{label:'Intermediate Throw Event',actionName:'replace-with-none-intermediate-throw',className:'bpmn-icon-intermediate-event-none',target:{type:'bpmn:IntermediateThrowEvent'}},{label:'End Event',actionName:'replace-with-none-end',className:'bpmn-icon-end-event-none',target:{type:'bpmn:EndEvent'}},{label:'Message Intermediate Catch Event',actionName:'replace-with-message-intermediate-catch',className:'bpmn-icon-intermediate-event-catch-message',target:{type:'bpmn:IntermediateCatchEvent',eventDefinitionType:'bpmn:MessageEventDefinition'}},{label:'Message Intermediate Throw Event',actionName:'replace-with-message-intermediate-throw',className:'bpmn-icon-intermediate-event-throw-message',target:{type:'bpmn:IntermediateThrowEvent',eventDefinitionType:'bpmn:MessageEventDefinition'}},{label:'Timer Intermediate Catch Event',actionName:'replace-with-timer-intermediate-catch',className:'bpmn-icon-intermediate-event-catch-timer',target:{type:'bpmn:IntermediateCatchEvent',eventDefinitionType:'bpmn:TimerEventDefinition'}},{label:'Escalation Intermediate Throw Event',actionName:'replace-with-escalation-intermediate-throw',className:'bpmn-icon-intermediate-event-throw-escalation',target:{type:'bpmn:IntermediateThrowEvent',eventDefinitionType:'bpmn:EscalationEventDefinition'}},{label:'Conditional Intermediate Catch Event',actionName:'replace-with-conditional-intermediate-catch',className:'bpmn-icon-intermediate-event-catch-condition',target:{type:'bpmn:IntermediateCatchEvent',eventDefinitionType:'bpmn:ConditionalEventDefinition'}},{label:'Link Intermediate Catch Event',actionName:'replace-with-link-intermediate-catch',className:'bpmn-icon-intermediate-event-catch-link',target:{type:'bpmn:IntermediateCatchEvent',eventDefinitionType:'bpmn:LinkEventDefinition'}},{label:'Link Intermediate Throw Event',actionName:'replace-with-link-intermediate-throw',className:'bpmn-icon-intermediate-event-throw-link',target:{type:'bpmn:IntermediateThrowEvent',eventDefinitionType:'bpmn:LinkEventDefinition'}},{label:'Compensation Intermediate Throw Event',actionName:'replace-with-compensation-intermediate-throw',className:'bpmn-icon-intermediate-event-throw-compensation',target:{type:'bpmn:IntermediateThrowEvent',eventDefinitionType:'bpmn:CompensateEventDefinition'}},{label:'Signal Intermediate Catch Event',actionName:'replace-with-signal-intermediate-catch',className:'bpmn-icon-intermediate-event-catch-signal',target:{type:'bpmn:IntermediateCatchEvent',eventDefinitionType:'bpmn:SignalEventDefinition'}},{label:'Signal Intermediate Throw Event',actionName:'replace-with-signal-intermediate-throw',className:'bpmn-icon-intermediate-event-throw-signal',target:{type:'bpmn:IntermediateThrowEvent',eventDefinitionType:'bpmn:SignalEventDefinition'}}];var END_EVENT=exports.END_EVENT=[{label:'Start Event',actionName:'replace-with-none-start',className:'bpmn-icon-start-event-none',target:{type:'bpmn:StartEvent'}},{label:'Intermediate Throw Event',actionName:'replace-with-none-intermediate-throw',className:'bpmn-icon-intermediate-event-none',target:{type:'bpmn:IntermediateThrowEvent'}},{label:'End Event',actionName:'replace-with-none-end',className:'bpmn-icon-end-event-none',target:{type:'bpmn:EndEvent'}},{label:'Message End Event',actionName:'replace-with-message-end',className:'bpmn-icon-end-event-message',target:{type:'bpmn:EndEvent',eventDefinitionType:'bpmn:MessageEventDefinition'}},{label:'Escalation End Event',actionName:'replace-with-escalation-end',className:'bpmn-icon-end-event-escalation',target:{type:'bpmn:EndEvent',eventDefinitionType:'bpmn:EscalationEventDefinition'}},{label:'Error End Event',actionName:'replace-with-error-end',className:'bpmn-icon-end-event-error',target:{type:'bpmn:EndEvent',eventDefinitionType:'bpmn:ErrorEventDefinition'}},{label:'Cancel End Event',actionName:'replace-with-cancel-end',className:'bpmn-icon-end-event-cancel',target:{type:'bpmn:EndEvent',eventDefinitionType:'bpmn:CancelEventDefinition'}},{label:'Compensation End Event',actionName:'replace-with-compensation-end',className:'bpmn-icon-end-event-compensation',target:{type:'bpmn:EndEvent',eventDefinitionType:'bpmn:CompensateEventDefinition'}},{label:'Signal End Event',actionName:'replace-with-signal-end',className:'bpmn-icon-end-event-signal',target:{type:'bpmn:EndEvent',eventDefinitionType:'bpmn:SignalEventDefinition'}},{label:'Terminate End Event',actionName:'replace-with-terminate-end',className:'bpmn-icon-end-event-terminate',target:{type:'bpmn:EndEvent',eventDefinitionType:'bpmn:TerminateEventDefinition'}}];var GATEWAY=exports.GATEWAY=[{label:'Exclusive Gateway',actionName:'replace-with-exclusive-gateway',className:'bpmn-icon-gateway-xor',target:{type:'bpmn:ExclusiveGateway'}},{label:'Parallel Gateway',actionName:'replace-with-parallel-gateway',className:'bpmn-icon-gateway-parallel',target:{type:'bpmn:ParallelGateway'}},{label:'Inclusive Gateway',actionName:'replace-with-inclusive-gateway',className:'bpmn-icon-gateway-or',target:{type:'bpmn:InclusiveGateway'}},{label:'Complex Gateway',actionName:'replace-with-complex-gateway',className:'bpmn-icon-gateway-complex',target:{type:'bpmn:ComplexGateway'}},{label:'Event based Gateway',actionName:'replace-with-event-based-gateway',className:'bpmn-icon-gateway-eventbased',target:{type:'bpmn:EventBasedGateway',instantiate:!1,eventGatewayType:'Exclusive'}}];var SUBPROCESS_EXPANDED=exports.SUBPROCESS_EXPANDED=[{label:'Transaction',actionName:'replace-with-transaction',className:'bpmn-icon-transaction',target:{type:'bpmn:Transaction',isExpanded:!0}},{label:'Event Sub Process',actionName:'replace-with-event-subprocess',className:'bpmn-icon-event-subprocess-expanded',target:{type:'bpmn:SubProcess',triggeredByEvent:!0,isExpanded:!0}},{label:'Sub Process (collapsed)',actionName:'replace-with-collapsed-subprocess',className:'bpmn-icon-subprocess-collapsed',target:{type:'bpmn:SubProcess',isExpanded:!1}}];var TRANSACTION=exports.TRANSACTION=[{label:'Sub Process',actionName:'replace-with-subprocess',className:'bpmn-icon-subprocess-expanded',target:{type:'bpmn:SubProcess',isExpanded:!0}},{label:'Event Sub Process',actionName:'replace-with-event-subprocess',className:'bpmn-icon-event-subprocess-expanded',target:{type:'bpmn:SubProcess',triggeredByEvent:!0,isExpanded:!0}}];var EVENT_SUB_PROCESS=exports.EVENT_SUB_PROCESS=[{label:'Sub Process',actionName:'replace-with-subprocess',className:'bpmn-icon-subprocess-expanded',target:{type:'bpmn:SubProcess',isExpanded:!0}},{label:'Transaction',actionName:'replace-with-transaction',className:'bpmn-icon-transaction',target:{type:'bpmn:Transaction',isExpanded:!0}}];var TASK=exports.TASK=[{label:'Task',actionName:'replace-with-task',className:'bpmn-icon-task',target:{type:'bpmn:Task'}},{label:'Send Task',actionName:'replace-with-send-task',className:'bpmn-icon-send',target:{type:'bpmn:SendTask'}},{label:'Receive Task',actionName:'replace-with-receive-task',className:'bpmn-icon-receive',target:{type:'bpmn:ReceiveTask'}},{label:'User Task',actionName:'replace-with-user-task',className:'bpmn-icon-user',target:{type:'bpmn:UserTask'}},{label:'Manual Task',actionName:'replace-with-manual-task',className:'bpmn-icon-manual',target:{type:'bpmn:ManualTask'}},{label:'Business Rule Task',actionName:'replace-with-rule-task',className:'bpmn-icon-business-rule',target:{type:'bpmn:BusinessRuleTask'}},{label:'Service Task',actionName:'replace-with-service-task',className:'bpmn-icon-service',target:{type:'bpmn:ServiceTask'}},{label:'Script Task',actionName:'replace-with-script-task',className:'bpmn-icon-script',target:{type:'bpmn:ScriptTask'}},{label:'Call Activity',actionName:'replace-with-call-activity',className:'bpmn-icon-call-activity',target:{type:'bpmn:CallActivity'}},{label:'Sub Process (collapsed)',actionName:'replace-with-collapsed-subprocess',className:'bpmn-icon-subprocess-collapsed',target:{type:'bpmn:SubProcess',isExpanded:!1}},{label:'Sub Process (expanded)',actionName:'replace-with-expanded-subprocess',className:'bpmn-icon-subprocess-expanded',target:{type:'bpmn:SubProcess',isExpanded:!0}}];var BOUNDARY_EVENT=exports.BOUNDARY_EVENT=[{label:'Message Boundary Event',actionName:'replace-with-message-boundary',className:'bpmn-icon-intermediate-event-catch-message',target:{type:'bpmn:BoundaryEvent',eventDefinitionType:'bpmn:MessageEventDefinition'}},{label:'Timer Boundary Event',actionName:'replace-with-timer-boundary',className:'bpmn-icon-intermediate-event-catch-timer',target:{type:'bpmn:BoundaryEvent',eventDefinitionType:'bpmn:TimerEventDefinition'}},{label:'Escalation Boundary Event',actionName:'replace-with-escalation-boundary',className:'bpmn-icon-intermediate-event-catch-escalation',target:{type:'bpmn:BoundaryEvent',eventDefinitionType:'bpmn:EscalationEventDefinition'}},{label:'Conditional Boundary Event',actionName:'replace-with-conditional-boundary',className:'bpmn-icon-intermediate-event-catch-condition',target:{type:'bpmn:BoundaryEvent',eventDefinitionType:'bpmn:ConditionalEventDefinition'}},{label:'Error Boundary Event',actionName:'replace-with-error-boundary',className:'bpmn-icon-intermediate-event-catch-error',target:{type:'bpmn:BoundaryEvent',eventDefinitionType:'bpmn:ErrorEventDefinition'}},{label:'Cancel Boundary Event',actionName:'replace-with-cancel-boundary',className:'bpmn-icon-intermediate-event-catch-cancel',target:{type:'bpmn:BoundaryEvent',eventDefinitionType:'bpmn:CancelEventDefinition'}},{label:'Signal Boundary Event',actionName:'replace-with-signal-boundary',className:'bpmn-icon-intermediate-event-catch-signal',target:{type:'bpmn:BoundaryEvent',eventDefinitionType:'bpmn:SignalEventDefinition'}},{label:'Compensation Boundary Event',actionName:'replace-with-compensation-boundary',className:'bpmn-icon-intermediate-event-catch-compensation',target:{type:'bpmn:BoundaryEvent',eventDefinitionType:'bpmn:CompensateEventDefinition'}},{label:'Message Boundary Event (non-interrupting)',actionName:'replace-with-non-interrupting-message-boundary',className:'bpmn-icon-intermediate-event-catch-non-interrupting-message',target:{type:'bpmn:BoundaryEvent',eventDefinitionType:'bpmn:MessageEventDefinition',cancelActivity:!1}},{label:'Timer Boundary Event (non-interrupting)',actionName:'replace-with-non-interrupting-timer-boundary',className:'bpmn-icon-intermediate-event-catch-non-interrupting-timer',target:{type:'bpmn:BoundaryEvent',eventDefinitionType:'bpmn:TimerEventDefinition',cancelActivity:!1}},{label:'Escalation Boundary Event (non-interrupting)',actionName:'replace-with-non-interrupting-escalation-boundary',className:'bpmn-icon-intermediate-event-catch-non-interrupting-escalation',target:{type:'bpmn:BoundaryEvent',eventDefinitionType:'bpmn:EscalationEventDefinition',cancelActivity:!1}},{label:'Conditional Boundary Event (non-interrupting)',actionName:'replace-with-non-interrupting-conditional-boundary',className:'bpmn-icon-intermediate-event-catch-non-interrupting-condition',target:{type:'bpmn:BoundaryEvent',eventDefinitionType:'bpmn:ConditionalEventDefinition',cancelActivity:!1}},{label:'Signal Boundary Event (non-interrupting)',actionName:'replace-with-non-interrupting-signal-boundary',className:'bpmn-icon-intermediate-event-catch-non-interrupting-signal',target:{type:'bpmn:BoundaryEvent',eventDefinitionType:'bpmn:SignalEventDefinition',cancelActivity:!1}}];var EVENT_SUB_PROCESS_START_EVENT=exports.EVENT_SUB_PROCESS_START_EVENT=[{label:'Message Start Event',actionName:'replace-with-message-start',className:'bpmn-icon-start-event-message',target:{type:'bpmn:StartEvent',eventDefinitionType:'bpmn:MessageEventDefinition'}},{label:'Timer Start Event',actionName:'replace-with-timer-start',className:'bpmn-icon-start-event-timer',target:{type:'bpmn:StartEvent',eventDefinitionType:'bpmn:TimerEventDefinition'}},{label:'Conditional Start Event',actionName:'replace-with-conditional-start',className:'bpmn-icon-start-event-condition',target:{type:'bpmn:StartEvent',eventDefinitionType:'bpmn:ConditionalEventDefinition'}},{label:'Signal Start Event',actionName:'replace-with-signal-start',className:'bpmn-icon-start-event-signal',target:{type:'bpmn:StartEvent',eventDefinitionType:'bpmn:SignalEventDefinition'}},{label:'Error Start Event',actionName:'replace-with-error-start',className:'bpmn-icon-start-event-error',target:{type:'bpmn:StartEvent',eventDefinitionType:'bpmn:ErrorEventDefinition'}},{label:'Escalation Start Event',actionName:'replace-with-escalation-start',className:'bpmn-icon-start-event-escalation',target:{type:'bpmn:StartEvent',eventDefinitionType:'bpmn:EscalationEventDefinition'}},{label:'Compensation Start Event',actionName:'replace-with-compensation-start',className:'bpmn-icon-start-event-compensation',target:{type:'bpmn:StartEvent',eventDefinitionType:'bpmn:CompensateEventDefinition'}},{label:'Message Start Event (non-interrupting)',actionName:'replace-with-non-interrupting-message-start',className:'bpmn-icon-start-event-non-interrupting-message',target:{type:'bpmn:StartEvent',eventDefinitionType:'bpmn:MessageEventDefinition',isInterrupting:!1}},{label:'Timer Start Event (non-interrupting)',actionName:'replace-with-non-interrupting-timer-start',className:'bpmn-icon-start-event-non-interrupting-timer',target:{type:'bpmn:StartEvent',eventDefinitionType:'bpmn:TimerEventDefinition',isInterrupting:!1}},{label:'Conditional Start Event (non-interrupting)',actionName:'replace-with-non-interrupting-conditional-start',className:'bpmn-icon-start-event-non-interrupting-condition',target:{type:'bpmn:StartEvent',eventDefinitionType:'bpmn:ConditionalEventDefinition',isInterrupting:!1}},{label:'Signal Start Event (non-interrupting)',actionName:'replace-with-non-interrupting-signal-start',className:'bpmn-icon-start-event-non-interrupting-signal',target:{type:'bpmn:StartEvent',eventDefinitionType:'bpmn:SignalEventDefinition',isInterrupting:!1}},{label:'Escalation Start Event (non-interrupting)',actionName:'replace-with-non-interrupting-escalation-start',className:'bpmn-icon-start-event-non-interrupting-escalation',target:{type:'bpmn:StartEvent',eventDefinitionType:'bpmn:EscalationEventDefinition',isInterrupting:!1}}];var SEQUENCE_FLOW=exports.SEQUENCE_FLOW=[{label:'Sequence Flow',actionName:'replace-with-sequence-flow',className:'bpmn-icon-connection'},{label:'Default Flow',actionName:'replace-with-default-flow',className:'bpmn-icon-default-flow'},{label:'Conditional Flow',actionName:'replace-with-conditional-flow',className:'bpmn-icon-conditional-flow'}];var PARTICIPANT=exports.PARTICIPANT=[{label:'Expanded Pool',actionName:'replace-with-expanded-pool',className:'bpmn-icon-participant',target:{type:'bpmn:Participant',isExpanded:!0}},{label:'Collapsed Pool',actionName:'replace-with-collapsed-pool',className:'bpmn-icon-lane',target:{type:'bpmn:Participant',isExpanded:!1}}];},{}],144:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _selection=require('diagram-js/lib/features/selection');var _selection2=_interopRequireDefault(_selection);var _replace=require('diagram-js/lib/features/replace');var _replace2=_interopRequireDefault(_replace);var _BpmnReplace=require('./BpmnReplace');var _BpmnReplace2=_interopRequireDefault(_BpmnReplace);exports.default={__depends__:[_selection2.default,_replace2.default],bpmnReplace:['type',_BpmnReplace2.default]};},{'./BpmnReplace':142,'diagram-js/lib/features/replace':284,'diagram-js/lib/features/selection':298}],145:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function BpmnRules(eventBus){_RuleProvider2.default.call(this,eventBus);}function nonExistantOrLabel(element){return!element||isLabel(element);}function isSame(a,b){return a===b;}function getOrganizationalParent(element){do{if((0,_ModelUtil.is)(element,'bpmn:Process'))return(0,_ModelUtil.getBusinessObject)(element);if((0,_ModelUtil.is)(element,'bpmn:Participant'))return(0,_ModelUtil.getBusinessObject)(element).processRef||(0,_ModelUtil.getBusinessObject)(element);}while(element=element.parent);}function isTextAnnotation(element){return(0,_ModelUtil.is)(element,'bpmn:TextAnnotation');}function isCompensationBoundary(element){return(0,_ModelUtil.is)(element,'bpmn:BoundaryEvent')&&hasEventDefinition(element,'bpmn:CompensateEventDefinition');}function isForCompensation(e){return(0,_ModelUtil.getBusinessObject)(e).isForCompensation;}function isSameOrganization(a,b){var parentA=getOrganizationalParent(a),parentB=getOrganizationalParent(b);return parentA===parentB;}function isMessageFlowSource(element){return(0,_ModelUtil.is)(element,'bpmn:InteractionNode')&&(!(0,_ModelUtil.is)(element,'bpmn:Event')||(0,_ModelUtil.is)(element,'bpmn:ThrowEvent')&&hasEventDefinitionOrNone(element,'bpmn:MessageEventDefinition'));}function isMessageFlowTarget(element){return(0,_ModelUtil.is)(element,'bpmn:InteractionNode')&&!isForCompensation(element)&&(!(0,_ModelUtil.is)(element,'bpmn:Event')||(0,_ModelUtil.is)(element,'bpmn:CatchEvent')&&hasEventDefinitionOrNone(element,'bpmn:MessageEventDefinition'));}function getScopeParent(element){var parent=element;while(parent=parent.parent){if((0,_ModelUtil.is)(parent,'bpmn:FlowElementsContainer'))return(0,_ModelUtil.getBusinessObject)(parent);if((0,_ModelUtil.is)(parent,'bpmn:Participant'))return(0,_ModelUtil.getBusinessObject)(parent).processRef;}return null;}function isSameScope(a,b){var scopeParentA=getScopeParent(a),scopeParentB=getScopeParent(b);return scopeParentA&&scopeParentA===scopeParentB;}function hasEventDefinition(element,eventDefinition){var bo=(0,_ModelUtil.getBusinessObject)(element);return!!(0,_minDash.find)(bo.eventDefinitions||[],function(definition){return(0,_ModelUtil.is)(definition,eventDefinition);});}function hasEventDefinitionOrNone(element,eventDefinition){var bo=(0,_ModelUtil.getBusinessObject)(element);return(bo.eventDefinitions||[]).every(function(definition){return(0,_ModelUtil.is)(definition,eventDefinition);});}function isSequenceFlowSource(element){return(0,_ModelUtil.is)(element,'bpmn:FlowNode')&&!(0,_ModelUtil.is)(element,'bpmn:EndEvent')&&!(0,_DiUtil.isEventSubProcess)(element)&&!((0,_ModelUtil.is)(element,'bpmn:IntermediateThrowEvent')&&hasEventDefinition(element,'bpmn:LinkEventDefinition'))&&!isCompensationBoundary(element)&&!isForCompensation(element);}function isSequenceFlowTarget(element){return(0,_ModelUtil.is)(element,'bpmn:FlowNode')&&!(0,_ModelUtil.is)(element,'bpmn:StartEvent')&&!(0,_ModelUtil.is)(element,'bpmn:BoundaryEvent')&&!(0,_DiUtil.isEventSubProcess)(element)&&!((0,_ModelUtil.is)(element,'bpmn:IntermediateCatchEvent')&&hasEventDefinition(element,'bpmn:LinkEventDefinition'))&&!isForCompensation(element);}function isEventBasedTarget(element){return(0,_ModelUtil.is)(element,'bpmn:ReceiveTask')||(0,_ModelUtil.is)(element,'bpmn:IntermediateCatchEvent')&&(hasEventDefinition(element,'bpmn:MessageEventDefinition')||hasEventDefinition(element,'bpmn:TimerEventDefinition')||hasEventDefinition(element,'bpmn:ConditionalEventDefinition')||hasEventDefinition(element,'bpmn:SignalEventDefinition'));}function isLabel(element){return element.labelTarget;}function isConnection(element){return element.waypoints;}function getParents(element){var parents=[];while(element)element=element.parent,element&&parents.push(element);return parents;}function isParent(possibleParent,element){var allParents=getParents(element);return allParents.indexOf(possibleParent)!==-1;}function canConnect(source,target,connection){if(nonExistantOrLabel(source)||nonExistantOrLabel(target))return null;if(isSame(source,target))return!1;if(!(0,_ModelUtil.is)(connection,'bpmn:DataAssociation')){if(canConnectMessageFlow(source,target))return{type:'bpmn:MessageFlow'};if(canConnectSequenceFlow(source,target))return{type:'bpmn:SequenceFlow'};}var connectDataAssociation=canConnectDataAssociation(source,target);return connectDataAssociation?connectDataAssociation:isCompensationBoundary(source)&&isForCompensation(target)?{type:'bpmn:Association',associationDirection:'One'}:canConnectAssociation(source,target)?{type:'bpmn:Association'}:!1;}function canDrop(element,target,position){return isLabel(element)&&!isConnection(target)?!0:(0,_ModelUtil.is)(target,'bpmn:Participant')&&!(0,_DiUtil.isExpanded)(target)?!1:(0,_ModelUtil.is)(element,'bpmn:Participant')?(0,_ModelUtil.is)(target,'bpmn:Process')||(0,_ModelUtil.is)(target,'bpmn:Collaboration'):(0,_ModelUtil.is)(element,'bpmn:Lane')?(0,_ModelUtil.is)(target,'bpmn:Participant')||(0,_ModelUtil.is)(target,'bpmn:Lane'):(0,_ModelUtil.is)(element,'bpmn:BoundaryEvent')?!1:(0,_ModelUtil.is)(element,'bpmn:FlowElement')?(0,_ModelUtil.is)(target,'bpmn:FlowElementsContainer')?(0,_DiUtil.isExpanded)(target):(0,_ModelingUtil.isAny)(target,['bpmn:Participant','bpmn:Lane']):(0,_ModelingUtil.isAny)(element,['bpmn:Artifact','bpmn:DataAssociation'])?(0,_ModelingUtil.isAny)(target,['bpmn:Collaboration','bpmn:Lane','bpmn:Participant','bpmn:Process','bpmn:SubProcess']):(0,_ModelUtil.is)(element,'bpmn:MessageFlow')?(0,_ModelUtil.is)(target,'bpmn:Collaboration')||element.source.parent==target||element.target.parent==target:!1;}function canPaste(tree,target){var topLevel=tree[0],participants;return(0,_ModelUtil.is)(target,'bpmn:Collaboration')?(0,_minDash.every)(topLevel,function(e){return e.type==='bpmn:Participant';}):(0,_ModelUtil.is)(target,'bpmn:Process')?(participants=(0,_minDash.some)(topLevel,function(e){return e.type==='bpmn:Participant';}),!(participants&&target.children.length>0)):(0,_ModelUtil.is)(target,'bpmn:Participant')&&!(0,_DiUtil.isExpanded)(target)?!1:(0,_ModelUtil.is)(target,'bpmn:FlowElementsContainer')?(0,_DiUtil.isExpanded)(target):(0,_ModelingUtil.isAny)(target,['bpmn:Collaboration','bpmn:Lane','bpmn:Participant','bpmn:Process','bpmn:SubProcess']);}function isBoundaryEvent(element){return!isLabel(element)&&(0,_ModelUtil.is)(element,'bpmn:BoundaryEvent');}function isLane(element){return(0,_ModelUtil.is)(element,'bpmn:Lane');}function isBoundaryCandidate(element){return isBoundaryEvent(element)||(0,_ModelUtil.is)(element,'bpmn:IntermediateThrowEvent')&&!element.parent;}function canAttach(elements,target,source,position){if(Array.isArray(elements)||(elements=[elements]),source)return!1;if(elements.length!==1)return!1;var element=elements[0];return isLabel(element)?!1:isBoundaryCandidate(element)?target?(0,_DiUtil.isEventSubProcess)(target)?!1:!(0,_ModelUtil.is)(target,'bpmn:Activity')||isForCompensation(target)?!1:position&&!(0,_BpmnSnappingUtil.getBoundaryAttachment)(position,target)?!1:'attach':!0:!1;}function canReplace(elements,target,position){if(!target)return!1;var canExecute={replacements:[]};return(0,_minDash.forEach)(elements,function(element){!(0,_DiUtil.isEventSubProcess)(target)&&(0,_ModelUtil.is)(element,'bpmn:StartEvent')&&element.type!=='label'&&canDrop(element,target)&&((0,_DiUtil.isInterrupting)(element)||canExecute.replacements.push({oldElementId:element.id,newElementType:'bpmn:StartEvent'}),((0,_DiUtil.hasErrorEventDefinition)(element)||(0,_DiUtil.hasEscalationEventDefinition)(element)||(0,_DiUtil.hasCompensateEventDefinition)(element))&&canExecute.replacements.push({oldElementId:element.id,newElementType:'bpmn:StartEvent'})),!(0,_ModelUtil.is)(target,'bpmn:Transaction')&&hasEventDefinition(element,'bpmn:CancelEventDefinition')&&element.type!=='label'&&((0,_ModelUtil.is)(element,'bpmn:EndEvent')&&canDrop(element,target)&&canExecute.replacements.push({oldElementId:element.id,newElementType:'bpmn:EndEvent'}),(0,_ModelUtil.is)(element,'bpmn:BoundaryEvent')&&canAttach(element,target,null,position)&&canExecute.replacements.push({oldElementId:element.id,newElementType:'bpmn:BoundaryEvent'}));}),canExecute.replacements.length?canExecute:!1;}function canMove(elements,target){return(0,_minDash.some)(elements,isBoundaryEvent)?!1:(0,_minDash.some)(elements,isLane)?!1:target?elements.every(function(element){return canDrop(element,target);}):!0;}function canCreate(shape,target,source,position){return target?isLabel(target)?null:isSame(source,target)?!1:source&&isParent(source,target)?!1:canDrop(shape,target,position)||canInsert(shape,target,position):!1;}function canResize(shape,newBounds){return(0,_ModelUtil.is)(shape,'bpmn:SubProcess')?(0,_DiUtil.isExpanded)(shape)&&(!newBounds||newBounds.width>=100&&newBounds.height>=80):(0,_ModelUtil.is)(shape,'bpmn:Lane')?!newBounds||newBounds.width>=130&&newBounds.height>=60:(0,_ModelUtil.is)(shape,'bpmn:Participant')?!newBounds||newBounds.width>=250&&newBounds.height>=50:isTextAnnotation(shape)?!0:!1;}function isOneTextAnnotation(source,target){var sourceTextAnnotation=isTextAnnotation(source),targetTextAnnotation=isTextAnnotation(target);return(sourceTextAnnotation||targetTextAnnotation)&&sourceTextAnnotation!==targetTextAnnotation;}function canConnectAssociation(source,target){return isConnection(source)||isConnection(target)?!1:isCompensationBoundary(source)&&isForCompensation(target)?!0:isParent(target,source)||isParent(source,target)?!1:isOneTextAnnotation(source,target);}function canConnectMessageFlow(source,target){return isMessageFlowSource(source)&&isMessageFlowTarget(target)&&!isSameOrganization(source,target);}function canConnectSequenceFlow(source,target){return isSequenceFlowSource(source)&&isSequenceFlowTarget(target)&&isSameScope(source,target)&&!((0,_ModelUtil.is)(source,'bpmn:EventBasedGateway')&&!isEventBasedTarget(target));}function canConnectDataAssociation(source,target){return(0,_ModelingUtil.isAny)(source,['bpmn:DataObjectReference','bpmn:DataStoreReference'])&&(0,_ModelingUtil.isAny)(target,['bpmn:Activity','bpmn:ThrowEvent'])?{type:'bpmn:DataInputAssociation'}:(0,_ModelingUtil.isAny)(target,['bpmn:DataObjectReference','bpmn:DataStoreReference'])&&(0,_ModelingUtil.isAny)(source,['bpmn:Activity','bpmn:CatchEvent'])?{type:'bpmn:DataOutputAssociation'}:!1;}function canInsert(shape,flow,position){if(Array.isArray(shape)){if(shape.length!==1)return!1;shape=shape[0];}return(0,_ModelingUtil.isAny)(flow,['bpmn:SequenceFlow','bpmn:MessageFlow'])&&!isLabel(flow)&&(0,_ModelUtil.is)(shape,'bpmn:FlowNode')&&!(0,_ModelUtil.is)(shape,'bpmn:BoundaryEvent')&&canDrop(shape,flow.parent,position);}function contains(collection,element){return collection&&element&&collection.indexOf(element)!==-1;}function canCopy(collection,element){return(0,_ModelUtil.is)(element,'bpmn:Lane')&&!contains(collection,element.parent)?!1:(0,_ModelUtil.is)(element,'bpmn:BoundaryEvent')&&!contains(collection,element.host)?!1:!0;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=BpmnRules;var _minDash=require('min-dash');var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _ModelUtil=require('../../util/ModelUtil');var _ModelingUtil=require('../modeling/util/ModelingUtil');var _DiUtil=require('../../util/DiUtil');var _RuleProvider=require('diagram-js/lib/features/rules/RuleProvider');var _RuleProvider2=_interopRequireDefault(_RuleProvider);var _BpmnSnappingUtil=require('../snapping/BpmnSnappingUtil');(0,_inherits2.default)(BpmnRules,_RuleProvider2.default),BpmnRules.$inject=['eventBus'],BpmnRules.prototype.init=function(){this.addRule('connection.create',function(context){var source=context.source,target=context.target,hints=context.hints||{},targetParent=hints.targetParent,targetAttach=hints.targetAttach;if(targetAttach)return!1;targetParent&&(target.parent=targetParent);try{return canConnect(source,target);}finally{targetParent&&(target.parent=null);}}),this.addRule('connection.reconnectStart',function(context){var connection=context.connection,source=context.hover||context.source,target=connection.target;return canConnect(source,target,connection);}),this.addRule('connection.reconnectEnd',function(context){var connection=context.connection,source=connection.source,target=context.hover||context.target;return canConnect(source,target,connection);}),this.addRule('connection.updateWaypoints',function(context){return null;}),this.addRule('shape.resize',function(context){var shape=context.shape,newBounds=context.newBounds;return canResize(shape,newBounds);}),this.addRule('elements.move',function(context){var target=context.target,shapes=context.shapes,position=context.position;return canAttach(shapes,target,null,position)||canReplace(shapes,target,position)||canMove(shapes,target,position)||canInsert(shapes,target,position);}),this.addRule('shape.create',function(context){return canCreate(context.shape,context.target,context.source,context.position);}),this.addRule('shape.attach',function(context){return canAttach(context.shape,context.target,null,context.position);}),this.addRule('element.copy',function(context){var collection=context.collection,element=context.element;return canCopy(collection,element);}),this.addRule('element.paste',function(context){var parent=context.parent,element=context.element,position=context.position,source=context.source,target=context.target;return source||target?canConnect(source,target):canAttach([element],parent,null,position)||canCreate(element,parent,null,position);}),this.addRule('elements.paste',function(context){var tree=context.tree,target=context.target;return canPaste(tree,target);}),this.addRule(['elements.delete'],function(context){return(0,_minDash.filter)(context.elements,function(e){return!isLabel(e);});});},BpmnRules.prototype.canConnectMessageFlow=canConnectMessageFlow,BpmnRules.prototype.canConnectSequenceFlow=canConnectSequenceFlow,BpmnRules.prototype.canConnectDataAssociation=canConnectDataAssociation,BpmnRules.prototype.canConnectAssociation=canConnectAssociation,BpmnRules.prototype.canMove=canMove,BpmnRules.prototype.canAttach=canAttach,BpmnRules.prototype.canReplace=canReplace,BpmnRules.prototype.canDrop=canDrop,BpmnRules.prototype.canInsert=canInsert,BpmnRules.prototype.canCreate=canCreate,BpmnRules.prototype.canConnect=canConnect,BpmnRules.prototype.canResize=canResize,BpmnRules.prototype.canCopy=canCopy;},{'../../util/DiUtil':157,'../../util/ModelUtil':159,'../modeling/util/ModelingUtil':132,'../snapping/BpmnSnappingUtil':150,'diagram-js/lib/features/rules/RuleProvider':290,inherits:350,'min-dash':438}],146:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _rules=require('diagram-js/lib/features/rules');var _rules2=_interopRequireDefault(_rules);var _BpmnRules=require('./BpmnRules');var _BpmnRules2=_interopRequireDefault(_BpmnRules);exports.default={__depends__:[_rules2.default],__init__:['bpmnRules'],bpmnRules:['type',_BpmnRules2.default]};},{'./BpmnRules':145,'diagram-js/lib/features/rules':292}],147:[function(require,module,exports){'use strict';function BpmnSearchProvider(elementRegistry,searchPad,canvas){this._elementRegistry=elementRegistry,this._canvas=canvas,searchPad.registerProvider(this);}function hasMatched(tokens){var matched=(0,_minDash.filter)(tokens,function(t){return!!t.matched;});return matched.length>0;}function matchAndSplit(text,pattern){var tokens=[],originalText=text;if(!text)return tokens;text=text.toLowerCase(),pattern=pattern.toLowerCase();var i=text.indexOf(pattern);return i>-1?(i!==0&&tokens.push({normal:originalText.substr(0,i)}),tokens.push({matched:originalText.substr(i,pattern.length)}),pattern.length+i<text.length&&tokens.push({normal:originalText.substr(pattern.length+i,text.length)})):tokens.push({normal:originalText}),tokens;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=BpmnSearchProvider;var _minDash=require('min-dash');var _LabelUtil=require('../label-editing/LabelUtil');BpmnSearchProvider.$inject=['elementRegistry','searchPad','canvas'],BpmnSearchProvider.prototype.find=function(pattern){var rootElement=this._canvas.getRootElement();var elements=this._elementRegistry.filter(function(element){return element.labelTarget?!1:!0;});return elements=(0,_minDash.filter)(elements,function(element){return element!==rootElement;}),elements=(0,_minDash.map)(elements,function(element){return{primaryTokens:matchAndSplit((0,_LabelUtil.getLabel)(element),pattern),secondaryTokens:matchAndSplit(element.id,pattern),element:element};}),elements=(0,_minDash.filter)(elements,function(element){return hasMatched(element.primaryTokens)||hasMatched(element.secondaryTokens);}),elements=(0,_minDash.sortBy)(elements,function(element){return(0,_LabelUtil.getLabel)(element.element)+element.element.id;}),elements;};},{'../label-editing/LabelUtil':88,'min-dash':438}],148:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _searchPad=require('diagram-js/lib/features/search-pad');var _searchPad2=_interopRequireDefault(_searchPad);var _BpmnSearchProvider=require('./BpmnSearchProvider');var _BpmnSearchProvider2=_interopRequireDefault(_BpmnSearchProvider);exports.default={__depends__:[_searchPad2.default],__init__:['bpmnSearch'],bpmnSearch:['type',_BpmnSearchProvider2.default]};},{'./BpmnSearchProvider':147,'diagram-js/lib/features/search-pad':294}],149:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function BpmnSnapping(eventBus,canvas,bpmnRules,elementRegistry){function canAttach(shape,target,position){return bpmnRules.canAttach([shape],target,null,position)==='attach';}function canConnect(source,target){return bpmnRules.canConnect(source,target);}_Snapping2.default.call(this,eventBus,canvas),eventBus.on('create.start',function(event){var context=event.context,shape=context.shape,rootElement=canvas.getRootElement();(0,_ModelUtil.is)(shape,'bpmn:Participant')&&(0,_ModelUtil.is)(rootElement,'bpmn:Process')&&initParticipantSnapping(context,shape,rootElement.children);}),eventBus.on(['create.move','create.end'],HIGH_PRIORITY,function(event){var context=event.context,shape=context.shape,participantSnapBox=context.participantSnapBox;!(0,_SnapUtil.isSnapped)(event)&&participantSnapBox&&snapParticipant(participantSnapBox,shape,event);}),eventBus.on('shape.move.start',function(event){var context=event.context,shape=context.shape,rootElement=canvas.getRootElement();(0,_ModelUtil.is)(shape,'bpmn:Participant')&&(0,_ModelUtil.is)(rootElement,'bpmn:Process')&&initParticipantSnapping(context,shape,rootElement.children);}),eventBus.on(['create.move','create.end','shape.move.move','shape.move.end'],HIGH_PRIORITY,function(event){var context=event.context,target=context.target,shape=context.shape;target&&!(0,_SnapUtil.isSnapped)(event)&&canAttach(shape,target,event)&&snapBoundaryEvent(event,shape,target);}),eventBus.on(['shape.move.hover','shape.move.move','shape.move.end','create.hover','create.move','create.end'],HIGH_PRIORITY,function(event){var context=event.context,shape=context.shape,hover=event.hover;(0,_ModelUtil.is)(hover,'bpmn:Lane')&&!(0,_ModelingUtil.isAny)(shape,['bpmn:Lane','bpmn:Participant'])&&(event.hover=(0,_LaneUtil.getLanesRoot)(hover),event.hoverGfx=elementRegistry.getGraphics(event.hover));}),eventBus.on(['connect.move','connect.hover','connect.end'],HIGH_PRIORITY,function(event){var context=event.context,source=context.source,target=context.target;var connection=canConnect(source,target)||{};context.initialSourcePosition||(context.initialSourcePosition=context.sourcePosition),target&&(connection.type==='bpmn:Association'||connection.type==='bpmn:DataOutputAssociation'||connection.type==='bpmn:DataInputAssociation'||connection.type==='bpmn:SequenceFlow')?(context.sourcePosition=(0,_SnapUtil.mid)(source),(0,_minDash.assign)(event,(0,_SnapUtil.mid)(target))):context.sourcePosition=context.initialSourcePosition;}),eventBus.on('resize.start',HIGH_PRIORITY,function(event){var context=event.context,shape=context.shape;(0,_ModelUtil.is)(shape,'bpmn:SubProcess')&&(0,_DiUtil.isExpanded)(shape)&&(context.minDimensions={width:140,height:120}),(0,_ModelUtil.is)(shape,'bpmn:Participant')&&(context.minDimensions={width:300,height:150}),((0,_ModelUtil.is)(shape,'bpmn:Lane')||(0,_ModelUtil.is)(shape,'bpmn:Participant'))&&(context.resizeConstraints=(0,_BpmnSnappingUtil.getParticipantSizeConstraints)(shape,context.direction,context.balanced)),(0,_ModelUtil.is)(shape,'bpmn:TextAnnotation')&&(context.minDimensions={width:50,height:30});});}function initParticipantSnapping(context,shape,elements){if(!elements.length)return;var snapBox=(0,_Elements.getBBox)(elements.filter(function(e){return!e.labelTarget&&!e.waypoints;}));snapBox.x-=50,snapBox.y-=20,snapBox.width+=70,snapBox.height+=40,shape.width=Math.max(shape.width,snapBox.width),shape.height=Math.max(shape.height,snapBox.height),context.participantSnapBox=snapBox;}function snapParticipant(snapBox,shape,event,offset){offset=offset||0;var shapeHalfWidth=shape.width/2-offset,shapeHalfHeight=shape.height/2;var currentTopLeft={x:event.x-shapeHalfWidth-offset,y:event.y-shapeHalfHeight};var currentBottomRight={x:event.x+shapeHalfWidth+offset,y:event.y+shapeHalfHeight};var snapTopLeft=snapBox,snapBottomRight=(0,_SnapUtil.bottomRight)(snapBox);currentTopLeft.x>=snapTopLeft.x?(0,_SnapUtil.setSnapped)(event,'x',snapTopLeft.x+offset+shapeHalfWidth):currentBottomRight.x<=snapBottomRight.x&&(0,_SnapUtil.setSnapped)(event,'x',snapBottomRight.x-offset-shapeHalfWidth),currentTopLeft.y>=snapTopLeft.y?(0,_SnapUtil.setSnapped)(event,'y',snapTopLeft.y+shapeHalfHeight):currentBottomRight.y<=snapBottomRight.y&&(0,_SnapUtil.setSnapped)(event,'y',snapBottomRight.y-shapeHalfHeight);}function snapBoundaryEvent(event,shape,target){var targetTRBL=(0,_LayoutUtil.asTRBL)(target);var direction=(0,_BpmnSnappingUtil.getBoundaryAttachment)(event,target);/top/.test(direction)?(0,_SnapUtil.setSnapped)(event,'y',targetTRBL.top):/bottom/.test(direction)&&(0,_SnapUtil.setSnapped)(event,'y',targetTRBL.bottom),/left/.test(direction)?(0,_SnapUtil.setSnapped)(event,'x',targetTRBL.left):/right/.test(direction)&&(0,_SnapUtil.setSnapped)(event,'x',targetTRBL.right);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=BpmnSnapping;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _minDash=require('min-dash');var _Elements=require('diagram-js/lib/util/Elements');var _ModelUtil=require('../../util/ModelUtil');var _ModelingUtil=require('../modeling/util/ModelingUtil');var _DiUtil=require('../../util/DiUtil');var _Snapping=require('diagram-js/lib/features/snapping/Snapping');var _Snapping2=_interopRequireDefault(_Snapping);var _SnapUtil=require('diagram-js/lib/features/snapping/SnapUtil');var _LayoutUtil=require('diagram-js/lib/layout/LayoutUtil');var _BpmnSnappingUtil=require('./BpmnSnappingUtil');var _LaneUtil=require('../modeling/util/LaneUtil');var round=Math.round;var HIGH_PRIORITY=1500;(0,_inherits2.default)(BpmnSnapping,_Snapping2.default),BpmnSnapping.$inject=['eventBus','canvas','bpmnRules','elementRegistry'],BpmnSnapping.prototype.initSnap=function(event){var context=event.context,shape=event.shape,shapeMid,shapeBounds,shapeTopLeft,shapeBottomRight,snapContext;snapContext=_Snapping2.default.prototype.initSnap.call(this,event),(0,_ModelUtil.is)(shape,'bpmn:Participant')&&snapContext.setSnapLocations(['top-left','bottom-right','mid']),shape&&(shapeMid=(0,_SnapUtil.mid)(shape,event),shapeBounds={width:shape.width,height:shape.height,x:isNaN(shape.x)?round(shapeMid.x-shape.width/2):shape.x,y:isNaN(shape.y)?round(shapeMid.y-shape.height/2):shape.y},shapeTopLeft=(0,_SnapUtil.topLeft)(shapeBounds),shapeBottomRight=(0,_SnapUtil.bottomRight)(shapeBounds),snapContext.setSnapOrigin('top-left',{x:shapeTopLeft.x-event.x,y:shapeTopLeft.y-event.y}),snapContext.setSnapOrigin('bottom-right',{x:shapeBottomRight.x-event.x,y:shapeBottomRight.y-event.y}),(0,_minDash.forEach)(shape.outgoing,function(c){var docking=c.waypoints[0];docking=docking.original||docking,snapContext.setSnapOrigin(c.id+'-docking',{x:docking.x-event.x,y:docking.y-event.y});}),(0,_minDash.forEach)(shape.incoming,function(c){var docking=c.waypoints[c.waypoints.length-1];docking=docking.original||docking,snapContext.setSnapOrigin(c.id+'-docking',{x:docking.x-event.x,y:docking.y-event.y});}));var source=context.source;source&&snapContext.addDefaultSnap('mid',(0,_SnapUtil.mid)(source));},BpmnSnapping.prototype.addTargetSnaps=function(snapPoints,shape,target){(0,_ModelUtil.is)(shape,'bpmn:BoundaryEvent')&&shape.type!=='label'&&(target=target.parent),(0,_ModelUtil.is)(target,'bpmn:SequenceFlow')&&this.addTargetSnaps(snapPoints,shape,target.parent);var siblings=this.getSiblings(shape,target)||[];(0,_minDash.forEach)(siblings,function(sibling){if((0,_ModelUtil.is)(sibling,'bpmn:Lane'))return;if(sibling.waypoints){(0,_minDash.forEach)(sibling.waypoints.slice(1,-1),function(waypoint,i){var nextWaypoint=sibling.waypoints[i+2],previousWaypoint=sibling.waypoints[i];if(!(nextWaypoint&&previousWaypoint))throw new Error('waypoints must exist');(nextWaypoint.x===waypoint.x||nextWaypoint.y===waypoint.y||previousWaypoint.x===waypoint.x||previousWaypoint.y===waypoint.y)&&snapPoints.add('mid',waypoint);});return;}snapPoints.add('mid',(0,_SnapUtil.mid)(sibling)),(0,_ModelUtil.is)(sibling,'bpmn:Participant')&&(snapPoints.add('top-left',(0,_SnapUtil.topLeft)(sibling)),snapPoints.add('bottom-right',(0,_SnapUtil.bottomRight)(sibling)));}),(0,_minDash.forEach)(shape.incoming,function(c){siblings.indexOf(c.source)===-1&&snapPoints.add('mid',(0,_SnapUtil.mid)(c.source));var docking=c.waypoints[0];snapPoints.add(c.id+'-docking',docking.original||docking);}),(0,_minDash.forEach)(shape.outgoing,function(c){siblings.indexOf(c.target)===-1&&snapPoints.add('mid',(0,_SnapUtil.mid)(c.target));var docking=c.waypoints[c.waypoints.length-1];snapPoints.add(c.id+'-docking',docking.original||docking);});};},{'../../util/DiUtil':157,'../../util/ModelUtil':159,'../modeling/util/LaneUtil':131,'../modeling/util/ModelingUtil':132,'./BpmnSnappingUtil':150,'diagram-js/lib/features/snapping/SnapUtil':300,'diagram-js/lib/features/snapping/Snapping':301,'diagram-js/lib/layout/LayoutUtil':317,'diagram-js/lib/util/Elements':331,inherits:350,'min-dash':438}],150:[function(require,module,exports){'use strict';function getBoundaryAttachment(position,targetBounds){var orientation=(0,_LayoutUtil.getOrientation)(position,targetBounds,-15);return orientation!=='intersect'?orientation:null;}function addToTrbl(trbl,attr,value,choice){var current=trbl[attr];trbl[attr]=current===undefined?value:choice(value,current);}function addMin(trbl,attr,value){return addToTrbl(trbl,attr,value,min);}function addMax(trbl,attr,value){return addToTrbl(trbl,attr,value,max);}function getParticipantSizeConstraints(laneShape,resizeDirection,balanced){var lanesRoot=(0,_LaneUtil.getLanesRoot)(laneShape);var isFirst=!0,isLast=!0;var allLanes=(0,_LaneUtil.collectLanes)(lanesRoot,[lanesRoot]);var laneTrbl=(0,_LayoutUtil.asTRBL)(laneShape);var maxTrbl={},minTrbl={};/e/.test(resizeDirection)?minTrbl.right=laneTrbl.left+LANE_MIN_WIDTH:/w/.test(resizeDirection)&&(minTrbl.left=laneTrbl.right-LANE_MIN_WIDTH),allLanes.forEach(function(other){var otherTrbl=(0,_LayoutUtil.asTRBL)(other);/n/.test(resizeDirection)&&(otherTrbl.top<laneTrbl.top-10&&(isFirst=!1),balanced&&abs(laneTrbl.top-otherTrbl.bottom)<10&&addMax(maxTrbl,'top',otherTrbl.top+LANE_MIN_HEIGHT),abs(laneTrbl.top-otherTrbl.top)<5&&addMin(minTrbl,'top',otherTrbl.bottom-LANE_MIN_HEIGHT)),/s/.test(resizeDirection)&&(otherTrbl.bottom>laneTrbl.bottom+10&&(isLast=!1),balanced&&abs(laneTrbl.bottom-otherTrbl.top)<10&&addMin(maxTrbl,'bottom',otherTrbl.bottom-LANE_MIN_HEIGHT),abs(laneTrbl.bottom-otherTrbl.bottom)<5&&addMax(minTrbl,'bottom',otherTrbl.top+LANE_MIN_HEIGHT));});var flowElements=lanesRoot.children.filter(function(s){return!s.hidden&&!s.waypoints&&((0,_ModelUtil.is)(s,'bpmn:FlowElement')||(0,_ModelUtil.is)(s,'bpmn:Artifact'));});return flowElements.forEach(function(flowElement){var flowElementTrbl=(0,_LayoutUtil.asTRBL)(flowElement);isFirst&&/n/.test(resizeDirection)&&addMin(minTrbl,'top',flowElementTrbl.top-LANE_TOP_PADDING),/e/.test(resizeDirection)&&addMax(minTrbl,'right',flowElementTrbl.right+LANE_RIGHT_PADDING),isLast&&/s/.test(resizeDirection)&&addMax(minTrbl,'bottom',flowElementTrbl.bottom+LANE_BOTTOM_PADDING),/w/.test(resizeDirection)&&addMin(minTrbl,'left',flowElementTrbl.left-LANE_LEFT_PADDING);}),{min:minTrbl,max:maxTrbl};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.getBoundaryAttachment=getBoundaryAttachment,exports.getParticipantSizeConstraints=getParticipantSizeConstraints;var _LayoutUtil=require('diagram-js/lib/layout/LayoutUtil');var _ModelUtil=require('../../util/ModelUtil');var _LaneUtil=require('../modeling/util/LaneUtil');var abs=Math.abs,min=Math.min,max=Math.max;var LANE_MIN_HEIGHT=60,LANE_MIN_WIDTH=300,LANE_RIGHT_PADDING=20,LANE_LEFT_PADDING=50,LANE_TOP_PADDING=20,LANE_BOTTOM_PADDING=20;},{'../../util/ModelUtil':159,'../modeling/util/LaneUtil':131,'diagram-js/lib/layout/LayoutUtil':317}],151:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _BpmnSnapping=require('./BpmnSnapping');var _BpmnSnapping2=_interopRequireDefault(_BpmnSnapping);exports.default={__init__:['snapping'],snapping:['type',_BpmnSnapping2.default]};},{'./BpmnSnapping':149}],152:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function elementData(semantic,attrs){return(0,_minDash.assign)({id:semantic.id,type:semantic.$type,businessObject:semantic},attrs);}function collectWaypoints(waypoints){return(0,_minDash.map)(waypoints,function(p){return{x:p.x,y:p.y};});}function notYetDrawn(translate,semantic,refSemantic,property){return new Error(translate('element {element} referenced by {referenced}#{property} not yet drawn',{element:(0,_Util.elementToString)(refSemantic),referenced:(0,_Util.elementToString)(semantic),property:property}));}function BpmnImporter(eventBus,canvas,elementFactory,elementRegistry,translate){this._eventBus=eventBus,this._canvas=canvas,this._elementFactory=elementFactory,this._elementRegistry=elementRegistry,this._translate=translate,this._textUtil=new _Text2.default();}function getLayoutedBounds(bounds,text,textUtil){var layoutedLabelDimensions=textUtil.getDimensions(text,{box:{width:90,height:30,x:bounds.width/2+bounds.x,y:bounds.height/2+bounds.y},style:EXTERNAL_LABEL_STYLE});return{x:Math.round(bounds.x+bounds.width/2-layoutedLabelDimensions.width/2),y:Math.round(bounds.y),width:Math.ceil(layoutedLabelDimensions.width),height:Math.ceil(layoutedLabelDimensions.height)};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=BpmnImporter;var _minDash=require('min-dash');var _Text=require('diagram-js/lib/util/Text');var _Text2=_interopRequireDefault(_Text);var _ModelUtil=require('../util/ModelUtil');var _LabelUtil=require('../util/LabelUtil');var _DiUtil=require('../util/DiUtil');var _Util=require('./Util');BpmnImporter.$inject=['eventBus','canvas','elementFactory','elementRegistry','translate'],BpmnImporter.prototype.add=function(semantic,parentElement){var di=semantic.di,element,translate=this._translate,hidden;var parentIndex;if((0,_ModelUtil.is)(di,'bpmndi:BPMNPlane'))element=this._elementFactory.createRoot(elementData(semantic)),this._canvas.setRootElement(element);else if((0,_ModelUtil.is)(di,'bpmndi:BPMNShape')){var collapsed=!(0,_DiUtil.isExpanded)(semantic);hidden=parentElement&&(parentElement.hidden||parentElement.collapsed);var bounds=semantic.di.bounds;element=this._elementFactory.createShape(elementData(semantic,{collapsed:collapsed,hidden:hidden,x:Math.round(bounds.x),y:Math.round(bounds.y),width:Math.round(bounds.width),height:Math.round(bounds.height)})),(0,_ModelUtil.is)(semantic,'bpmn:BoundaryEvent')&&this._attachBoundary(semantic,element),(0,_ModelUtil.is)(semantic,'bpmn:Lane')&&(parentIndex=0),this._canvas.addShape(element,parentElement,parentIndex);}else if((0,_ModelUtil.is)(di,'bpmndi:BPMNEdge')){var source=this._getSource(semantic),target=this._getTarget(semantic);hidden=parentElement&&(parentElement.hidden||parentElement.collapsed),element=this._elementFactory.createConnection(elementData(semantic,{hidden:hidden,source:source,target:target,waypoints:collectWaypoints(semantic.di.waypoint)})),(0,_ModelUtil.is)(semantic,'bpmn:DataAssociation')&&(parentElement=null),(0,_ModelUtil.is)(semantic,'bpmn:SequenceFlow')&&(parentIndex=0),this._canvas.addConnection(element,parentElement,parentIndex);}else throw new Error(translate('unknown di {di} for element {semantic}',{di:(0,_Util.elementToString)(di),semantic:(0,_Util.elementToString)(semantic)}));return(0,_LabelUtil.hasExternalLabel)(semantic)&&this.addLabel(semantic,element),this._eventBus.fire('bpmnElement.added',{element:element}),element;},BpmnImporter.prototype._attachBoundary=function(boundarySemantic,boundaryElement){var translate=this._translate;var hostSemantic=boundarySemantic.attachedToRef;if(!hostSemantic)throw new Error(translate('missing {semantic}#attachedToRef',{semantic:(0,_Util.elementToString)(boundarySemantic)}));var host=this._elementRegistry.get(hostSemantic.id),attachers=host&&host.attachers;if(!host)throw notYetDrawn(translate,boundarySemantic,hostSemantic,'attachedToRef');boundaryElement.host=host,attachers||(host.attachers=attachers=[]),attachers.indexOf(boundaryElement)===-1&&attachers.push(boundaryElement);},BpmnImporter.prototype.addLabel=function(semantic,element){var bounds,text,label;return bounds=(0,_LabelUtil.getExternalLabelBounds)(semantic,element),text=semantic.name,text&&(bounds=getLayoutedBounds(bounds,text,this._textUtil)),label=this._elementFactory.createLabel(elementData(semantic,{id:semantic.id+'_label',labelTarget:element,type:'label',hidden:element.hidden||!semantic.name,x:Math.round(bounds.x),y:Math.round(bounds.y),width:Math.round(bounds.width),height:Math.round(bounds.height)})),this._canvas.addShape(label,element.parent);},BpmnImporter.prototype._getEnd=function(semantic,side){var element,refSemantic,type=semantic.$type,translate=this._translate;if(refSemantic=semantic[side+'Ref'],side==='source'&&type==='bpmn:DataInputAssociation'&&(refSemantic=refSemantic&&refSemantic[0]),(side==='source'&&type==='bpmn:DataOutputAssociation'||side==='target'&&type==='bpmn:DataInputAssociation')&&(refSemantic=semantic.$parent),element=refSemantic&&this._getElement(refSemantic),element)return element;throw refSemantic?notYetDrawn(translate,semantic,refSemantic,side+'Ref'):new Error(translate('{semantic}#{side} Ref not specified',{semantic:(0,_Util.elementToString)(semantic),side:side}));},BpmnImporter.prototype._getSource=function(semantic){return this._getEnd(semantic,'source');},BpmnImporter.prototype._getTarget=function(semantic){return this._getEnd(semantic,'target');},BpmnImporter.prototype._getElement=function(semantic){return this._elementRegistry.get(semantic.id);};var EXTERNAL_LABEL_STYLE={fontFamily:'Arial, sans-serif',fontSize:'11px'};},{'../util/DiUtil':157,'../util/LabelUtil':158,'../util/ModelUtil':159,'./Util':155,'diagram-js/lib/util/Text':344,'min-dash':438}],153:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function is(element,type){return element.$instanceOf(type);}function findDisplayCandidate(definitions){return(0,_minDash.find)(definitions.rootElements,function(e){return is(e,'bpmn:Process')||is(e,'bpmn:Collaboration');});}function BpmnTreeWalker(handler,translate){function contextual(fn,ctx){return function(e){fn(e,ctx);};}function handled(element){handledElements[element.id]=element;}function isHandled(element){return handledElements[element.id];}function visit(element,ctx){var gfx=element.gfx;if(gfx)throw new Error(translate('already rendered {element}',{element:(0,_Util.elementToString)(element)}));return handler.element(element,ctx);}function visitRoot(element,diagram){return handler.root(element,diagram);}function visitIfDi(element,ctx){try{var gfx=element.di&&visit(element,ctx);return handled(element),gfx;}catch(e){logError(e.message,{element:element,error:e});console.error(translate('failed to import {element}',{element:(0,_Util.elementToString)(element)}));console.error(e);}}function logError(message,context){handler.error(message,context);}function registerDi(di){var bpmnElement=di.bpmnElement;bpmnElement?bpmnElement.di?logError(translate('multiple DI elements defined for {element}',{element:(0,_Util.elementToString)(bpmnElement)}),{element:bpmnElement}):(diRefs.bind(bpmnElement,'di'),bpmnElement.di=di):logError(translate('no bpmnElement referenced in {element}',{element:(0,_Util.elementToString)(di)}),{element:di});}function handleDiagram(diagram){handlePlane(diagram.plane);}function handlePlane(plane){registerDi(plane),(0,_minDash.forEach)(plane.planeElement,handlePlaneElement);}function handlePlaneElement(planeElement){registerDi(planeElement);}function handleDefinitions(definitions,diagram){var diagrams=definitions.diagrams;if(diagram&&diagrams.indexOf(diagram)===-1)throw new Error(translate('diagram not part of bpmn:Definitions'));if(!diagram&&diagrams&&diagrams.length&&(diagram=diagrams[0]),!diagram)throw new Error(translate('no diagram to display'));handleDiagram(diagram);var plane=diagram.plane;if(!plane)throw new Error(translate('no plane for {element}',{element:(0,_Util.elementToString)(diagram)}));var rootElement=plane.bpmnElement;if(!rootElement)if(rootElement=findDisplayCandidate(definitions),!rootElement)throw new Error(translate('no process or collaboration to display'));else logError(translate('correcting missing bpmnElement on {plane} to {rootElement}',{plane:(0,_Util.elementToString)(plane),rootElement:(0,_Util.elementToString)(rootElement)})),plane.bpmnElement=rootElement,registerDi(plane);var ctx=visitRoot(rootElement,plane);if(is(rootElement,'bpmn:Process'))handleProcess(rootElement,ctx);else if(is(rootElement,'bpmn:Collaboration'))handleCollaboration(rootElement,ctx),handleUnhandledProcesses(definitions.rootElements,ctx);else throw new Error(translate('unsupported bpmnElement for {plane}: {rootElement}',{plane:(0,_Util.elementToString)(plane),rootElement:(0,_Util.elementToString)(rootElement)}));handleDeferred(deferred);}function handleDeferred(){var fn;while(deferred.length)fn=deferred.shift(),fn();}function handleProcess(process,context){handleFlowElementsContainer(process,context),handleIoSpecification(process.ioSpecification,context),handleArtifacts(process.artifacts,context),handled(process);}function handleUnhandledProcesses(rootElements){var processes=(0,_minDash.filter)(rootElements,function(e){return!isHandled(e)&&is(e,'bpmn:Process')&&e.laneSets;});processes.forEach(contextual(handleProcess));}function handleMessageFlow(messageFlow,context){visitIfDi(messageFlow,context);}function handleMessageFlows(messageFlows,context){(0,_minDash.forEach)(messageFlows,contextual(handleMessageFlow,context));}function handleDataAssociation(association,context){visitIfDi(association,context);}function handleDataInput(dataInput,context){visitIfDi(dataInput,context);}function handleDataOutput(dataOutput,context){visitIfDi(dataOutput,context);}function handleArtifact(artifact,context){visitIfDi(artifact,context);}function handleArtifacts(artifacts,context){(0,_minDash.forEach)(artifacts,function(e){is(e,'bpmn:Association')?deferred.push(function(){handleArtifact(e,context);}):handleArtifact(e,context);});}function handleIoSpecification(ioSpecification,context){if(!ioSpecification)return;(0,_minDash.forEach)(ioSpecification.dataInputs,contextual(handleDataInput,context)),(0,_minDash.forEach)(ioSpecification.dataOutputs,contextual(handleDataOutput,context));}function handleSubProcess(subProcess,context){handleFlowElementsContainer(subProcess,context),handleArtifacts(subProcess.artifacts,context);}function handleFlowNode(flowNode,context){var childCtx=visitIfDi(flowNode,context);is(flowNode,'bpmn:SubProcess')&&handleSubProcess(flowNode,childCtx||context),is(flowNode,'bpmn:Activity')&&handleIoSpecification(flowNode.ioSpecification,context),deferred.push(function(){(0,_minDash.forEach)(flowNode.dataInputAssociations,contextual(handleDataAssociation,context)),(0,_minDash.forEach)(flowNode.dataOutputAssociations,contextual(handleDataAssociation,context));});}function handleSequenceFlow(sequenceFlow,context){visitIfDi(sequenceFlow,context);}function handleDataElement(dataObject,context){visitIfDi(dataObject,context);}function handleBoundaryEvent(dataObject,context){visitIfDi(dataObject,context);}function handleLane(lane,context){deferred.push(function(){var newContext=visitIfDi(lane,context);lane.childLaneSet&&handleLaneSet(lane.childLaneSet,newContext||context),wireFlowNodeRefs(lane);});}function handleLaneSet(laneSet,context){(0,_minDash.forEach)(laneSet.lanes,contextual(handleLane,context));}function handleLaneSets(laneSets,context){(0,_minDash.forEach)(laneSets,contextual(handleLaneSet,context));}function handleFlowElementsContainer(container,context){handleFlowElements(container.flowElements,context),container.laneSets&&handleLaneSets(container.laneSets,context);}function handleFlowElements(flowElements,context){(0,_minDash.forEach)(flowElements,function(e){is(e,'bpmn:SequenceFlow')?deferred.push(function(){handleSequenceFlow(e,context);}):is(e,'bpmn:BoundaryEvent')?deferred.unshift(function(){handleBoundaryEvent(e,context);}):is(e,'bpmn:FlowNode')?handleFlowNode(e,context):is(e,'bpmn:DataObject')||(is(e,'bpmn:DataStoreReference')?handleDataElement(e,context):is(e,'bpmn:DataObjectReference')?handleDataElement(e,context):logError(translate('unrecognized flowElement {element} in context {context}',{element:(0,_Util.elementToString)(e),context:context?(0,_Util.elementToString)(context.businessObject):'null'}),{element:e,context:context}));});}function handleParticipant(participant,context){var newCtx=visitIfDi(participant,context);var process=participant.processRef;process&&handleProcess(process,newCtx||context);}function handleCollaboration(collaboration){(0,_minDash.forEach)(collaboration.participants,contextual(handleParticipant)),handleArtifacts(collaboration.artifacts),deferred.push(function(){handleMessageFlows(collaboration.messageFlows);});}function wireFlowNodeRefs(lane){(0,_minDash.forEach)(lane.flowNodeRef,function(flowNode){var lanes=flowNode.get('lanes');lanes&&lanes.push(lane);});}var handledElements={};var deferred=[];return{handleDeferred:handleDeferred,handleDefinitions:handleDefinitions,handleSubProcess:handleSubProcess,registerDi:registerDi};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=BpmnTreeWalker;var _minDash=require('min-dash');var _objectRefs=require('object-refs');var _objectRefs2=_interopRequireDefault(_objectRefs);var _Util=require('./Util');var diRefs=new _objectRefs2.default({name:'bpmnElement',enumerable:!0},{name:'di',configurable:!0});},{'./Util':155,'min-dash':438,'object-refs':453}],154:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function importBpmnDiagram(diagram,definitions,done){function render(definitions){var visitor={root:function root(element){return importer.add(element);},element:function element(_element,parentShape){return importer.add(_element,parentShape);},error:function error(message,context){warnings.push({message:message,context:context});}};var walker=new _BpmnTreeWalker2.default(visitor,translate);walker.handleDefinitions(definitions);}var importer,eventBus,translate;var error,warnings=[];try{importer=diagram.get('bpmnImporter'),eventBus=diagram.get('eventBus'),translate=diagram.get('translate'),eventBus.fire('import.render.start',{definitions:definitions}),render(definitions),eventBus.fire('import.render.complete',{error:error,warnings:warnings});}catch(e){error=e;}done(error,warnings);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.importBpmnDiagram=importBpmnDiagram;var _BpmnTreeWalker=require('./BpmnTreeWalker');var _BpmnTreeWalker2=_interopRequireDefault(_BpmnTreeWalker);},{'./BpmnTreeWalker':153}],155:[function(require,module,exports){'use strict';function elementToString(e){return e?'<'+e.$type+(e.id?' id="'+e.id:'')+'" />':'<null>';}Object.defineProperty(exports,'__esModule',{value:!0}),exports.elementToString=elementToString;},{}],156:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _translate=require('diagram-js/lib/i18n/translate');var _translate2=_interopRequireDefault(_translate);var _BpmnImporter=require('./BpmnImporter');var _BpmnImporter2=_interopRequireDefault(_BpmnImporter);exports.default={__depends__:[_translate2.default],bpmnImporter:['type',_BpmnImporter2.default]};},{'./BpmnImporter':152,'diagram-js/lib/i18n/translate':313}],157:[function(require,module,exports){'use strict';function isExpanded(element){return(0,_ModelUtil.is)(element,'bpmn:CallActivity')?!1:(0,_ModelUtil.is)(element,'bpmn:SubProcess')?!!(0,_ModelUtil.getBusinessObject)(element).di.isExpanded:(0,_ModelUtil.is)(element,'bpmn:Participant')?!!(0,_ModelUtil.getBusinessObject)(element).processRef:!0;}function isInterrupting(element){return element&&(0,_ModelUtil.getBusinessObject)(element).isInterrupting!==!1;}function isEventSubProcess(element){return element&&!!(0,_ModelUtil.getBusinessObject)(element).triggeredByEvent;}function hasEventDefinition(element,eventType){var bo=(0,_ModelUtil.getBusinessObject)(element),hasEventDefinition=!1;return bo.eventDefinitions&&(0,_minDash.forEach)(bo.eventDefinitions,function(event){(0,_ModelUtil.is)(event,eventType)&&(hasEventDefinition=!0);}),hasEventDefinition;}function hasErrorEventDefinition(element){return hasEventDefinition(element,'bpmn:ErrorEventDefinition');}function hasEscalationEventDefinition(element){return hasEventDefinition(element,'bpmn:EscalationEventDefinition');}function hasCompensateEventDefinition(element){return hasEventDefinition(element,'bpmn:CompensateEventDefinition');}Object.defineProperty(exports,'__esModule',{value:!0}),exports.isExpanded=isExpanded,exports.isInterrupting=isInterrupting,exports.isEventSubProcess=isEventSubProcess,exports.hasEventDefinition=hasEventDefinition,exports.hasErrorEventDefinition=hasErrorEventDefinition,exports.hasEscalationEventDefinition=hasEscalationEventDefinition,exports.hasCompensateEventDefinition=hasCompensateEventDefinition;var _ModelUtil=require('./ModelUtil');var _minDash=require('min-dash');},{'./ModelUtil':159,'min-dash':438}],158:[function(require,module,exports){'use strict';function hasExternalLabel(semantic){return(0,_ModelUtil.is)(semantic,'bpmn:Event')||(0,_ModelUtil.is)(semantic,'bpmn:Gateway')||(0,_ModelUtil.is)(semantic,'bpmn:DataStoreReference')||(0,_ModelUtil.is)(semantic,'bpmn:DataObjectReference')||(0,_ModelUtil.is)(semantic,'bpmn:SequenceFlow')||(0,_ModelUtil.is)(semantic,'bpmn:MessageFlow');}function getFlowLabelPosition(waypoints){var mid=waypoints.length/2-1;var first=waypoints[Math.floor(mid)];var second=waypoints[Math.ceil(mid+0.01)];var position=getWaypointsMid(waypoints);var angle=Math.atan((second.y-first.y)/(second.x-first.x));var x=position.x,y=position.y;return Math.abs(angle)<Math.PI/2?y-=FLOW_LABEL_INDENT:x+=FLOW_LABEL_INDENT,{x:x,y:y};}function getWaypointsMid(waypoints){var mid=waypoints.length/2-1;var first=waypoints[Math.floor(mid)];var second=waypoints[Math.ceil(mid+0.01)];return{x:first.x+(second.x-first.x)/2,y:first.y+(second.y-first.y)/2};}function getExternalLabelMid(element){return element.waypoints?getFlowLabelPosition(element.waypoints):{x:element.x+element.width/2,y:element.y+element.height+DEFAULT_LABEL_SIZE.height/2};}function getExternalLabelBounds(semantic,element){var mid,size,bounds,di=semantic.di,label=di.label;return label&&label.bounds?(bounds=label.bounds,size={width:Math.max(DEFAULT_LABEL_SIZE.width,bounds.width),height:bounds.height},mid={x:bounds.x+bounds.width/2,y:bounds.y+bounds.height/2}):(mid=getExternalLabelMid(element),size=DEFAULT_LABEL_SIZE),(0,_minDash.assign)({x:mid.x-size.width/2,y:mid.y-size.height/2},size);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.FLOW_LABEL_INDENT=exports.DEFAULT_LABEL_SIZE=undefined,exports.hasExternalLabel=hasExternalLabel,exports.getFlowLabelPosition=getFlowLabelPosition,exports.getWaypointsMid=getWaypointsMid,exports.getExternalLabelMid=getExternalLabelMid,exports.getExternalLabelBounds=getExternalLabelBounds;var _minDash=require('min-dash');var _ModelUtil=require('./ModelUtil');var DEFAULT_LABEL_SIZE=exports.DEFAULT_LABEL_SIZE={width:90,height:20};var FLOW_LABEL_INDENT=exports.FLOW_LABEL_INDENT=15;},{'./ModelUtil':159,'min-dash':438}],159:[function(require,module,exports){'use strict';function is(element,type){var bo=getBusinessObject(element);return bo&&typeof bo.$instanceOf==='function'&&bo.$instanceOf(type);}function getBusinessObject(element){return element&&element.businessObject||element;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.is=is,exports.getBusinessObject=getBusinessObject;},{}],160:[function(require,module,exports){'use strict';function css(attrs){return attrs.join(';');}function open(){lightbox||(lightbox=(0,_minDom.domify)(LIGHTBOX_MARKUP),_minDom.delegate.bind(lightbox,'.backdrop','click',function(event){document.body.removeChild(lightbox);})),document.body.appendChild(lightbox);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.BPMNIO_IMG=undefined,exports.open=open;var _minDom=require('min-dom');var BPMNIO_LOGO_SVG='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 960 960"><path fill="#fff" d="M960 60v839c0 33-27 61-60 61H60c-33 0-60-27-60-60V60C0 27 27 0 60 0h839c34 0 61 27 61 60z"/><path fill="#52b415" d="M217 548a205 205 0 0 0-144 58 202 202 0 0 0-4 286 202 202 0 0 0 285 3 200 200 0 0 0 48-219 203 203 0 0 0-185-128zM752 6a206 206 0 0 0-192 285 206 206 0 0 0 269 111 207 207 0 0 0 111-260A204 204 0 0 0 752 6zM62 0A62 62 0 0 0 0 62v398l60 46a259 259 0 0 1 89-36c5-28 10-57 14-85l99 2 12 85a246 246 0 0 1 88 38l70-52 69 71-52 68c17 30 29 58 35 90l86 14-2 100-86 12a240 240 0 0 1-38 89l43 58h413c37 0 60-27 60-61V407a220 220 0 0 1-44 40l21 85-93 39-45-76a258 258 0 0 1-98 1l-45 76-94-39 22-85a298 298 0 0 1-70-69l-86 22-38-94 76-45a258 258 0 0 1-1-98l-76-45 40-94 85 22a271 271 0 0 1 41-47z"/></svg>';var BPMNIO_LOGO_URL='data:image/svg+xml,'+encodeURIComponent(BPMNIO_LOGO_SVG);var BPMNIO_IMG=exports.BPMNIO_IMG='<img width="52" height="52" src="'+BPMNIO_LOGO_URL+'" />';var LIGHTBOX_STYLES=css(['z-index: 1001','position: fixed','top: 0','left: 0','right: 0','bottom: 0']);var BACKDROP_STYLES=css(['width: 100%','height: 100%','background: rgba(0,0,0,0.2)']);var NOTICE_STYLES=css(['position: absolute','left: 50%','top: 40%','margin: 0 -130px','width: 260px','padding: 10px','background: white','border: solid 1px #AAA','border-radius: 3px','font-family: Helvetica, Arial, sans-serif','font-size: 14px','line-height: 1.2em']);var LIGHTBOX_MARKUP='<div class="bjs-powered-by-lightbox" style="'+LIGHTBOX_STYLES+'">'+'<div class="backdrop" style="'+BACKDROP_STYLES+'"></div>'+'<div class="notice" style="'+NOTICE_STYLES+'">'+'<a href="http://bpmn.io" target="_blank" style="float: left; margin-right: 10px">'+BPMNIO_IMG+'</a>'+'Web-based tooling for BPMN, DMN and CMMN diagrams '+'powered by <a href="http://bpmn.io" target="_blank">bpmn.io</a>.'+'</div>'+'</div>';var lightbox;},{'min-dom':439}],161:[function(require,module,exports){'use strict';function isAllowedIn(extProp,type){var allowedIn=extProp.meta.allowedIn;return allowedIn.length===1&&allowedIn[0]==='*'?!0:allowedIn.indexOf(type)!==-1;}function isType(element,types){return(0,_minDash.some)(types,function(type){return(element===void 0?'undefined':_typeof(element))===type;});}function ModelCloneHelper(eventBus,bpmnFactory){this._eventBus=eventBus,this._bpmnFactory=bpmnFactory;}Object.defineProperty(exports,'__esModule',{value:!0});var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj;};exports.default=ModelCloneHelper;var _minDash=require('min-dash');var _ModelCloneUtils=require('./ModelCloneUtils');ModelCloneHelper.prototype.clone=function(refElement,newElement,properties){var self=this;var context={newElement:newElement,hasNestedProperty:!1};return properties=(0,_minDash.sortBy)(properties,function(prop){return prop==='bpmn:extensionElements';}),(0,_minDash.forEach)(properties,function(propName){var refElementProp=refElement.get(propName),newElementProp=newElement.get(propName),propDescriptor=newElement.$model.getPropertyDescriptor(newElement,propName),newProperty,name;if(newElementProp===refElementProp)return;if(propDescriptor&&(propDescriptor.isId||propDescriptor.isReference))return;if(isType(refElementProp,['boolean','string','number'])||refElementProp===null){newElement.set(propName,refElementProp);return;}(0,_minDash.isArray)(refElementProp)?(0,_minDash.forEach)(refElementProp,function(extElement){var newProp;context.refTopLevelProperty=extElement,newProp=self._deepClone(extElement,context),context.hasNestedProperty&&(newProp.$parent=newElement,newElementProp.push(newProp)),context.hasNestedProperty=!1;}):(name=propName.replace(/bpmn:/,''),context.refTopLevelProperty=refElementProp,newProperty=self._deepClone(refElementProp,context),context.hasNestedProperty&&(newProperty.$parent=newElement,newElement.set(name,newProperty)),context.hasNestedProperty=!1);}),newElement;},ModelCloneHelper.prototype._deepClone=function _deepClone(propertyElement,context){var self=this;var eventBus=this._eventBus;var bpmnFactory=this._bpmnFactory;var newProp=bpmnFactory.create(propertyElement.$type);var properties=(0,_minDash.filter)(Object.keys(propertyElement),function(prop){var descriptor=newProp.$model.getPropertyDescriptor(newProp,prop);return descriptor&&(descriptor.isId||descriptor.isReference)?!1:_ModelCloneUtils.IGNORED_PROPERTIES.indexOf(prop)!==-1?!1:prop!=='$type';});return properties.length||(context.hasNestedProperty=!0),(0,_minDash.forEach)(properties,function(propName){propertyElement[propName]!==undefined&&(propertyElement[propName].$type||(0,_minDash.isArray)(propertyElement[propName]))?(0,_minDash.isArray)(propertyElement[propName])?(newProp[propName]=[],(0,_minDash.forEach)(propertyElement[propName],function(property){var extProp=propertyElement.$model.getTypeDescriptor(property.$type),newDeepProp;if(!extProp)return;var canClone=eventBus.fire('property.clone',{newElement:context.newElement,refTopLevelProperty:context.refTopLevelProperty,propertyDescriptor:extProp});if(!canClone&&propertyElement.$type==='bpmn:ExtensionElements'&&extProp.meta&&extProp.meta.allowedIn&&!isAllowedIn(extProp,context.newElement.$type))return!1;newDeepProp=self._deepClone(property,context),newDeepProp.$parent=newProp,newProp[propName]||(newProp[propName]=[]),context.hasNestedProperty=!0,newProp[propName].push(newDeepProp);})):propertyElement[propName].$type&&(newProp[propName]=self._deepClone(propertyElement[propName],context),newProp[propName]&&(context.hasNestedProperty=!0,newProp[propName].$parent=newProp)):(context.hasNestedProperty=!0,newProp[propName]=propertyElement[propName]);}),newProp;};},{'./ModelCloneUtils':162,'min-dash':438}],162:[function(require,module,exports){'use strict';function getProperties(descriptor,keepDefault){var properties=[];return(0,_minDash.forEach)(descriptor.properties,function(property){if(keepDefault&&property.default)return;properties.push(property.ns.name);}),properties;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.IGNORED_PROPERTIES=undefined,exports.getProperties=getProperties;var _minDash=require('min-dash');var IGNORED_PROPERTIES=exports.IGNORED_PROPERTIES=['lanes','incoming','outgoing','artifacts','default','flowElements','dataInputAssociations','dataOutputAssociations'];},{'min-dash':438}],163:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _simple=require('./lib/simple');Object.defineProperty(exports,'default',{enumerable:!0,get:function get(){return _interopRequireDefault(_simple).default;}});},{'./lib/simple':165}],164:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function BpmnModdle(packages,options){_moddle2.default.call(this,packages,options);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=BpmnModdle;var _minDash=require('min-dash');var _moddle=require('moddle');var _moddle2=_interopRequireDefault(_moddle);var _moddleXml=require('moddle-xml');BpmnModdle.prototype=Object.create(_moddle2.default.prototype),BpmnModdle.prototype.fromXML=function(xmlStr,typeName,options,done){(0,_minDash.isString)(typeName)||(done=options,options=typeName,typeName='bpmn:Definitions'),(0,_minDash.isFunction)(options)&&(done=options,options={});var reader=new _moddleXml.Reader((0,_minDash.assign)({model:this,lax:!0},options));var rootHandler=reader.handler(typeName);reader.fromXML(xmlStr,rootHandler,done);},BpmnModdle.prototype.toXML=function(element,options,done){(0,_minDash.isFunction)(options)&&(done=options,options={});var writer=new _moddleXml.Writer(options);var result;var err;try{result=writer.toXML(element);}catch(e){err=e;}return done(err,result);};},{'min-dash':438,moddle:444,'moddle-xml':440}],165:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=function(additionalPackages,options){var pks=(0,_minDash.assign)({},packages,additionalPackages);return new _bpmnModdle2.default(pks,options);};var _minDash=require('min-dash');var _bpmnModdle=require('./bpmn-moddle');var _bpmnModdle2=_interopRequireDefault(_bpmnModdle);var _bpmn=require('../resources/bpmn/json/bpmn.json');var _bpmn2=_interopRequireDefault(_bpmn);var _bpmndi=require('../resources/bpmn/json/bpmndi.json');var _bpmndi2=_interopRequireDefault(_bpmndi);var _dc=require('../resources/bpmn/json/dc.json');var _dc2=_interopRequireDefault(_dc);var _di=require('../resources/bpmn/json/di.json');var _di2=_interopRequireDefault(_di);var _bioc=require('../resources/bpmn-io/json/bioc.json');var _bioc2=_interopRequireDefault(_bioc);var packages={bpmn:_bpmn2.default,bpmndi:_bpmndi2.default,dc:_dc2.default,di:_di2.default,bioc:_bioc2.default};},{'../resources/bpmn-io/json/bioc.json':166,'../resources/bpmn/json/bpmn.json':167,'../resources/bpmn/json/bpmndi.json':168,'../resources/bpmn/json/dc.json':169,'../resources/bpmn/json/di.json':170,'./bpmn-moddle':164,'min-dash':438}],166:[function(require,module,exports){module.exports={name:'bpmn.io colors for BPMN',uri:'http://bpmn.io/schema/bpmn/biocolor/1.0',prefix:'bioc',types:[{name:'ColoredShape','extends':['bpmndi:BPMNShape'],properties:[{name:'stroke',isAttr:!0,type:'String'},{name:'fill',isAttr:!0,type:'String'}]},{name:'ColoredEdge','extends':['bpmndi:BPMNEdge'],properties:[{name:'stroke',isAttr:!0,type:'String'},{name:'fill',isAttr:!0,type:'String'}]}],enumerations:[],associations:[]};},{}],167:[function(require,module,exports){module.exports={name:'BPMN20',uri:'http://www.omg.org/spec/BPMN/20100524/MODEL',associations:[],types:[{name:'Interface',superClass:['RootElement'],properties:[{name:'name',isAttr:!0,type:'String'},{name:'operations',type:'Operation',isMany:!0},{name:'implementationRef',type:'String',isAttr:!0}]},{name:'Operation',superClass:['BaseElement'],properties:[{name:'name',isAttr:!0,type:'String'},{name:'inMessageRef',type:'Message',isReference:!0},{name:'outMessageRef',type:'Message',isReference:!0},{name:'errorRef',type:'Error',isMany:!0,isReference:!0},{name:'implementationRef',type:'String',isAttr:!0}]},{name:'EndPoint',superClass:['RootElement']},{name:'Auditing',superClass:['BaseElement']},{name:'GlobalTask',superClass:['CallableElement'],properties:[{name:'resources',type:'ResourceRole',isMany:!0}]},{name:'Monitoring',superClass:['BaseElement']},{name:'Performer',superClass:['ResourceRole']},{name:'Process',superClass:['FlowElementsContainer','CallableElement'],properties:[{name:'processType',type:'ProcessType',isAttr:!0},{name:'isClosed',isAttr:!0,type:'Boolean'},{name:'auditing',type:'Auditing'},{name:'monitoring',type:'Monitoring'},{name:'properties',type:'Property',isMany:!0},{name:'laneSets',type:'LaneSet',isMany:!0,replaces:'FlowElementsContainer#laneSets'},{name:'flowElements',type:'FlowElement',isMany:!0,replaces:'FlowElementsContainer#flowElements'},{name:'artifacts',type:'Artifact',isMany:!0},{name:'resources',type:'ResourceRole',isMany:!0},{name:'correlationSubscriptions',type:'CorrelationSubscription',isMany:!0},{name:'supports',type:'Process',isMany:!0,isReference:!0},{name:'definitionalCollaborationRef',type:'Collaboration',isAttr:!0,isReference:!0},{name:'isExecutable',isAttr:!0,type:'Boolean'}]},{name:'LaneSet',superClass:['BaseElement'],properties:[{name:'lanes',type:'Lane',isMany:!0},{name:'name',isAttr:!0,type:'String'}]},{name:'Lane',superClass:['BaseElement'],properties:[{name:'name',isAttr:!0,type:'String'},{name:'partitionElementRef',type:'BaseElement',isAttr:!0,isReference:!0},{name:'partitionElement',type:'BaseElement'},{name:'flowNodeRef',type:'FlowNode',isMany:!0,isReference:!0},{name:'childLaneSet',type:'LaneSet',xml:{serialize:'xsi:type'}}]},{name:'GlobalManualTask',superClass:['GlobalTask']},{name:'ManualTask',superClass:['Task']},{name:'UserTask',superClass:['Task'],properties:[{name:'renderings',type:'Rendering',isMany:!0},{name:'implementation',isAttr:!0,type:'String'}]},{name:'Rendering',superClass:['BaseElement']},{name:'HumanPerformer',superClass:['Performer']},{name:'PotentialOwner',superClass:['HumanPerformer']},{name:'GlobalUserTask',superClass:['GlobalTask'],properties:[{name:'implementation',isAttr:!0,type:'String'},{name:'renderings',type:'Rendering',isMany:!0}]},{name:'Gateway',isAbstract:!0,superClass:['FlowNode'],properties:[{name:'gatewayDirection',type:'GatewayDirection','default':'Unspecified',isAttr:!0}]},{name:'EventBasedGateway',superClass:['Gateway'],properties:[{name:'instantiate','default':!1,isAttr:!0,type:'Boolean'},{name:'eventGatewayType',type:'EventBasedGatewayType',isAttr:!0,'default':'Exclusive'}]},{name:'ComplexGateway',superClass:['Gateway'],properties:[{name:'activationCondition',type:'Expression',xml:{serialize:'xsi:type'}},{name:'default',type:'SequenceFlow',isAttr:!0,isReference:!0}]},{name:'ExclusiveGateway',superClass:['Gateway'],properties:[{name:'default',type:'SequenceFlow',isAttr:!0,isReference:!0}]},{name:'InclusiveGateway',superClass:['Gateway'],properties:[{name:'default',type:'SequenceFlow',isAttr:!0,isReference:!0}]},{name:'ParallelGateway',superClass:['Gateway']},{name:'RootElement',isAbstract:!0,superClass:['BaseElement']},{name:'Relationship',superClass:['BaseElement'],properties:[{name:'type',isAttr:!0,type:'String'},{name:'direction',type:'RelationshipDirection',isAttr:!0},{name:'source',isMany:!0,isReference:!0,type:'Element'},{name:'target',isMany:!0,isReference:!0,type:'Element'}]},{name:'BaseElement',isAbstract:!0,properties:[{name:'id',isAttr:!0,type:'String',isId:!0},{name:'documentation',type:'Documentation',isMany:!0},{name:'extensionDefinitions',type:'ExtensionDefinition',isMany:!0,isReference:!0},{name:'extensionElements',type:'ExtensionElements'}]},{name:'Extension',properties:[{name:'mustUnderstand','default':!1,isAttr:!0,type:'Boolean'},{name:'definition',type:'ExtensionDefinition',isAttr:!0,isReference:!0}]},{name:'ExtensionDefinition',properties:[{name:'name',isAttr:!0,type:'String'},{name:'extensionAttributeDefinitions',type:'ExtensionAttributeDefinition',isMany:!0}]},{name:'ExtensionAttributeDefinition',properties:[{name:'name',isAttr:!0,type:'String'},{name:'type',isAttr:!0,type:'String'},{name:'isReference','default':!1,isAttr:!0,type:'Boolean'},{name:'extensionDefinition',type:'ExtensionDefinition',isAttr:!0,isReference:!0}]},{name:'ExtensionElements',properties:[{name:'valueRef',isAttr:!0,isReference:!0,type:'Element'},{name:'values',type:'Element',isMany:!0},{name:'extensionAttributeDefinition',type:'ExtensionAttributeDefinition',isAttr:!0,isReference:!0}]},{name:'Documentation',superClass:['BaseElement'],properties:[{name:'text',type:'String',isBody:!0},{name:'textFormat','default':'text/plain',isAttr:!0,type:'String'}]},{name:'Event',isAbstract:!0,superClass:['FlowNode','InteractionNode'],properties:[{name:'properties',type:'Property',isMany:!0}]},{name:'IntermediateCatchEvent',superClass:['CatchEvent']},{name:'IntermediateThrowEvent',superClass:['ThrowEvent']},{name:'EndEvent',superClass:['ThrowEvent']},{name:'StartEvent',superClass:['CatchEvent'],properties:[{name:'isInterrupting','default':!0,isAttr:!0,type:'Boolean'}]},{name:'ThrowEvent',isAbstract:!0,superClass:['Event'],properties:[{name:'dataInputs',type:'DataInput',isMany:!0},{name:'dataInputAssociations',type:'DataInputAssociation',isMany:!0},{name:'inputSet',type:'InputSet'},{name:'eventDefinitions',type:'EventDefinition',isMany:!0},{name:'eventDefinitionRef',type:'EventDefinition',isMany:!0,isReference:!0}]},{name:'CatchEvent',isAbstract:!0,superClass:['Event'],properties:[{name:'parallelMultiple',isAttr:!0,type:'Boolean','default':!1},{name:'dataOutputs',type:'DataOutput',isMany:!0},{name:'dataOutputAssociations',type:'DataOutputAssociation',isMany:!0},{name:'outputSet',type:'OutputSet'},{name:'eventDefinitions',type:'EventDefinition',isMany:!0},{name:'eventDefinitionRef',type:'EventDefinition',isMany:!0,isReference:!0}]},{name:'BoundaryEvent',superClass:['CatchEvent'],properties:[{name:'cancelActivity','default':!0,isAttr:!0,type:'Boolean'},{name:'attachedToRef',type:'Activity',isAttr:!0,isReference:!0}]},{name:'EventDefinition',isAbstract:!0,superClass:['RootElement']},{name:'CancelEventDefinition',superClass:['EventDefinition']},{name:'ErrorEventDefinition',superClass:['EventDefinition'],properties:[{name:'errorRef',type:'Error',isAttr:!0,isReference:!0}]},{name:'TerminateEventDefinition',superClass:['EventDefinition']},{name:'EscalationEventDefinition',superClass:['EventDefinition'],properties:[{name:'escalationRef',type:'Escalation',isAttr:!0,isReference:!0}]},{name:'Escalation',properties:[{name:'structureRef',type:'ItemDefinition',isAttr:!0,isReference:!0},{name:'name',isAttr:!0,type:'String'},{name:'escalationCode',isAttr:!0,type:'String'}],superClass:['RootElement']},{name:'CompensateEventDefinition',superClass:['EventDefinition'],properties:[{name:'waitForCompletion',isAttr:!0,type:'Boolean','default':!0},{name:'activityRef',type:'Activity',isAttr:!0,isReference:!0}]},{name:'TimerEventDefinition',superClass:['EventDefinition'],properties:[{name:'timeDate',type:'Expression',xml:{serialize:'xsi:type'}},{name:'timeCycle',type:'Expression',xml:{serialize:'xsi:type'}},{name:'timeDuration',type:'Expression',xml:{serialize:'xsi:type'}}]},{name:'LinkEventDefinition',superClass:['EventDefinition'],properties:[{name:'name',isAttr:!0,type:'String'},{name:'target',type:'LinkEventDefinition',isAttr:!0,isReference:!0},{name:'source',type:'LinkEventDefinition',isMany:!0,isReference:!0}]},{name:'MessageEventDefinition',superClass:['EventDefinition'],properties:[{name:'messageRef',type:'Message',isAttr:!0,isReference:!0},{name:'operationRef',type:'Operation',isAttr:!0,isReference:!0}]},{name:'ConditionalEventDefinition',superClass:['EventDefinition'],properties:[{name:'condition',type:'Expression',xml:{serialize:'xsi:type'}}]},{name:'SignalEventDefinition',superClass:['EventDefinition'],properties:[{name:'signalRef',type:'Signal',isAttr:!0,isReference:!0}]},{name:'Signal',superClass:['RootElement'],properties:[{name:'structureRef',type:'ItemDefinition',isAttr:!0,isReference:!0},{name:'name',isAttr:!0,type:'String'}]},{name:'ImplicitThrowEvent',superClass:['ThrowEvent']},{name:'DataState',superClass:['BaseElement'],properties:[{name:'name',isAttr:!0,type:'String'}]},{name:'ItemAwareElement',superClass:['BaseElement'],properties:[{name:'itemSubjectRef',type:'ItemDefinition',isAttr:!0,isReference:!0},{name:'dataState',type:'DataState'}]},{name:'DataAssociation',superClass:['BaseElement'],properties:[{name:'assignment',type:'Assignment',isMany:!0},{name:'sourceRef',type:'ItemAwareElement',isMany:!0,isReference:!0},{name:'targetRef',type:'ItemAwareElement',isReference:!0},{name:'transformation',type:'FormalExpression',xml:{serialize:'property'}}]},{name:'DataInput',superClass:['ItemAwareElement'],properties:[{name:'name',isAttr:!0,type:'String'},{name:'isCollection','default':!1,isAttr:!0,type:'Boolean'},{name:'inputSetRef',type:'InputSet',isVirtual:!0,isMany:!0,isReference:!0},{name:'inputSetWithOptional',type:'InputSet',isVirtual:!0,isMany:!0,isReference:!0},{name:'inputSetWithWhileExecuting',type:'InputSet',isVirtual:!0,isMany:!0,isReference:!0}]},{name:'DataOutput',superClass:['ItemAwareElement'],properties:[{name:'name',isAttr:!0,type:'String'},{name:'isCollection','default':!1,isAttr:!0,type:'Boolean'},{name:'outputSetRef',type:'OutputSet',isVirtual:!0,isMany:!0,isReference:!0},{name:'outputSetWithOptional',type:'OutputSet',isVirtual:!0,isMany:!0,isReference:!0},{name:'outputSetWithWhileExecuting',type:'OutputSet',isVirtual:!0,isMany:!0,isReference:!0}]},{name:'InputSet',superClass:['BaseElement'],properties:[{name:'name',isAttr:!0,type:'String'},{name:'dataInputRefs',type:'DataInput',isMany:!0,isReference:!0},{name:'optionalInputRefs',type:'DataInput',isMany:!0,isReference:!0},{name:'whileExecutingInputRefs',type:'DataInput',isMany:!0,isReference:!0},{name:'outputSetRefs',type:'OutputSet',isMany:!0,isReference:!0}]},{name:'OutputSet',superClass:['BaseElement'],properties:[{name:'dataOutputRefs',type:'DataOutput',isMany:!0,isReference:!0},{name:'name',isAttr:!0,type:'String'},{name:'inputSetRefs',type:'InputSet',isMany:!0,isReference:!0},{name:'optionalOutputRefs',type:'DataOutput',isMany:!0,isReference:!0},{name:'whileExecutingOutputRefs',type:'DataOutput',isMany:!0,isReference:!0}]},{name:'Property',superClass:['ItemAwareElement'],properties:[{name:'name',isAttr:!0,type:'String'}]},{name:'DataInputAssociation',superClass:['DataAssociation']},{name:'DataOutputAssociation',superClass:['DataAssociation']},{name:'InputOutputSpecification',superClass:['BaseElement'],properties:[{name:'dataInputs',type:'DataInput',isMany:!0},{name:'dataOutputs',type:'DataOutput',isMany:!0},{name:'inputSets',type:'InputSet',isMany:!0},{name:'outputSets',type:'OutputSet',isMany:!0}]},{name:'DataObject',superClass:['FlowElement','ItemAwareElement'],properties:[{name:'isCollection','default':!1,isAttr:!0,type:'Boolean'}]},{name:'InputOutputBinding',properties:[{name:'inputDataRef',type:'InputSet',isAttr:!0,isReference:!0},{name:'outputDataRef',type:'OutputSet',isAttr:!0,isReference:!0},{name:'operationRef',type:'Operation',isAttr:!0,isReference:!0}]},{name:'Assignment',superClass:['BaseElement'],properties:[{name:'from',type:'Expression',xml:{serialize:'xsi:type'}},{name:'to',type:'Expression',xml:{serialize:'xsi:type'}}]},{name:'DataStore',superClass:['RootElement','ItemAwareElement'],properties:[{name:'name',isAttr:!0,type:'String'},{name:'capacity',isAttr:!0,type:'Integer'},{name:'isUnlimited','default':!0,isAttr:!0,type:'Boolean'}]},{name:'DataStoreReference',superClass:['ItemAwareElement','FlowElement'],properties:[{name:'dataStoreRef',type:'DataStore',isAttr:!0,isReference:!0}]},{name:'DataObjectReference',superClass:['ItemAwareElement','FlowElement'],properties:[{name:'dataObjectRef',type:'DataObject',isAttr:!0,isReference:!0}]},{name:'ConversationLink',superClass:['BaseElement'],properties:[{name:'sourceRef',type:'InteractionNode',isAttr:!0,isReference:!0},{name:'targetRef',type:'InteractionNode',isAttr:!0,isReference:!0},{name:'name',isAttr:!0,type:'String'}]},{name:'ConversationAssociation',superClass:['BaseElement'],properties:[{name:'innerConversationNodeRef',type:'ConversationNode',isAttr:!0,isReference:!0},{name:'outerConversationNodeRef',type:'ConversationNode',isAttr:!0,isReference:!0}]},{name:'CallConversation',superClass:['ConversationNode'],properties:[{name:'calledCollaborationRef',type:'Collaboration',isAttr:!0,isReference:!0},{name:'participantAssociations',type:'ParticipantAssociation',isMany:!0}]},{name:'Conversation',superClass:['ConversationNode']},{name:'SubConversation',superClass:['ConversationNode'],properties:[{name:'conversationNodes',type:'ConversationNode',isMany:!0}]},{name:'ConversationNode',isAbstract:!0,superClass:['InteractionNode','BaseElement'],properties:[{name:'name',isAttr:!0,type:'String'},{name:'participantRefs',type:'Participant',isMany:!0,isReference:!0},{name:'messageFlowRefs',type:'MessageFlow',isMany:!0,isReference:!0},{name:'correlationKeys',type:'CorrelationKey',isMany:!0}]},{name:'GlobalConversation',superClass:['Collaboration']},{name:'PartnerEntity',superClass:['RootElement'],properties:[{name:'name',isAttr:!0,type:'String'},{name:'participantRef',type:'Participant',isMany:!0,isReference:!0}]},{name:'PartnerRole',superClass:['RootElement'],properties:[{name:'name',isAttr:!0,type:'String'},{name:'participantRef',type:'Participant',isMany:!0,isReference:!0}]},{name:'CorrelationProperty',superClass:['RootElement'],properties:[{name:'correlationPropertyRetrievalExpression',type:'CorrelationPropertyRetrievalExpression',isMany:!0},{name:'name',isAttr:!0,type:'String'},{name:'type',type:'ItemDefinition',isAttr:!0,isReference:!0}]},{name:'Error',superClass:['RootElement'],properties:[{name:'structureRef',type:'ItemDefinition',isAttr:!0,isReference:!0},{name:'name',isAttr:!0,type:'String'},{name:'errorCode',isAttr:!0,type:'String'}]},{name:'CorrelationKey',superClass:['BaseElement'],properties:[{name:'correlationPropertyRef',type:'CorrelationProperty',isMany:!0,isReference:!0},{name:'name',isAttr:!0,type:'String'}]},{name:'Expression',superClass:['BaseElement'],isAbstract:!1,properties:[{name:'body',type:'String',isBody:!0}]},{name:'FormalExpression',superClass:['Expression'],properties:[{name:'language',isAttr:!0,type:'String'},{name:'evaluatesToTypeRef',type:'ItemDefinition',isAttr:!0,isReference:!0}]},{name:'Message',superClass:['RootElement'],properties:[{name:'name',isAttr:!0,type:'String'},{name:'itemRef',type:'ItemDefinition',isAttr:!0,isReference:!0}]},{name:'ItemDefinition',superClass:['RootElement'],properties:[{name:'itemKind',type:'ItemKind',isAttr:!0},{name:'structureRef',type:'String',isAttr:!0},{name:'isCollection','default':!1,isAttr:!0,type:'Boolean'},{name:'import',type:'Import',isAttr:!0,isReference:!0}]},{name:'FlowElement',isAbstract:!0,superClass:['BaseElement'],properties:[{name:'name',isAttr:!0,type:'String'},{name:'auditing',type:'Auditing'},{name:'monitoring',type:'Monitoring'},{name:'categoryValueRef',type:'CategoryValue',isMany:!0,isReference:!0}]},{name:'SequenceFlow',superClass:['FlowElement'],properties:[{name:'isImmediate',isAttr:!0,type:'Boolean'},{name:'conditionExpression',type:'Expression',xml:{serialize:'xsi:type'}},{name:'sourceRef',type:'FlowNode',isAttr:!0,isReference:!0},{name:'targetRef',type:'FlowNode',isAttr:!0,isReference:!0}]},{name:'FlowElementsContainer',isAbstract:!0,superClass:['BaseElement'],properties:[{name:'laneSets',type:'LaneSet',isMany:!0},{name:'flowElements',type:'FlowElement',isMany:!0}]},{name:'CallableElement',isAbstract:!0,superClass:['RootElement'],properties:[{name:'name',isAttr:!0,type:'String'},{name:'ioSpecification',type:'InputOutputSpecification',xml:{serialize:'property'}},{name:'supportedInterfaceRef',type:'Interface',isMany:!0,isReference:!0},{name:'ioBinding',type:'InputOutputBinding',isMany:!0,xml:{serialize:'property'}}]},{name:'FlowNode',isAbstract:!0,superClass:['FlowElement'],properties:[{name:'incoming',type:'SequenceFlow',isMany:!0,isReference:!0},{name:'outgoing',type:'SequenceFlow',isMany:!0,isReference:!0},{name:'lanes',type:'Lane',isVirtual:!0,isMany:!0,isReference:!0}]},{name:'CorrelationPropertyRetrievalExpression',superClass:['BaseElement'],properties:[{name:'messagePath',type:'FormalExpression'},{name:'messageRef',type:'Message',isAttr:!0,isReference:!0}]},{name:'CorrelationPropertyBinding',superClass:['BaseElement'],properties:[{name:'dataPath',type:'FormalExpression'},{name:'correlationPropertyRef',type:'CorrelationProperty',isAttr:!0,isReference:!0}]},{name:'Resource',superClass:['RootElement'],properties:[{name:'name',isAttr:!0,type:'String'},{name:'resourceParameters',type:'ResourceParameter',isMany:!0}]},{name:'ResourceParameter',superClass:['BaseElement'],properties:[{name:'name',isAttr:!0,type:'String'},{name:'isRequired',isAttr:!0,type:'Boolean'},{name:'type',type:'ItemDefinition',isAttr:!0,isReference:!0}]},{name:'CorrelationSubscription',superClass:['BaseElement'],properties:[{name:'correlationKeyRef',type:'CorrelationKey',isAttr:!0,isReference:!0},{name:'correlationPropertyBinding',type:'CorrelationPropertyBinding',isMany:!0}]},{name:'MessageFlow',superClass:['BaseElement'],properties:[{name:'name',isAttr:!0,type:'String'},{name:'sourceRef',type:'InteractionNode',isAttr:!0,isReference:!0},{name:'targetRef',type:'InteractionNode',isAttr:!0,isReference:!0},{name:'messageRef',type:'Message',isAttr:!0,isReference:!0}]},{name:'MessageFlowAssociation',superClass:['BaseElement'],properties:[{name:'innerMessageFlowRef',type:'MessageFlow',isAttr:!0,isReference:!0},{name:'outerMessageFlowRef',type:'MessageFlow',isAttr:!0,isReference:!0}]},{name:'InteractionNode',isAbstract:!0,properties:[{name:'incomingConversationLinks',type:'ConversationLink',isVirtual:!0,isMany:!0,isReference:!0},{name:'outgoingConversationLinks',type:'ConversationLink',isVirtual:!0,isMany:!0,isReference:!0}]},{name:'Participant',superClass:['InteractionNode','BaseElement'],properties:[{name:'name',isAttr:!0,type:'String'},{name:'interfaceRef',type:'Interface',isMany:!0,isReference:!0},{name:'participantMultiplicity',type:'ParticipantMultiplicity'},{name:'endPointRefs',type:'EndPoint',isMany:!0,isReference:!0},{name:'processRef',type:'Process',isAttr:!0,isReference:!0}]},{name:'ParticipantAssociation',superClass:['BaseElement'],properties:[{name:'innerParticipantRef',type:'Participant',isAttr:!0,isReference:!0},{name:'outerParticipantRef',type:'Participant',isAttr:!0,isReference:!0}]},{name:'ParticipantMultiplicity',properties:[{name:'minimum','default':0,isAttr:!0,type:'Integer'},{name:'maximum','default':1,isAttr:!0,type:'Integer'}],superClass:['BaseElement']},{name:'Collaboration',superClass:['RootElement'],properties:[{name:'name',isAttr:!0,type:'String'},{name:'isClosed',isAttr:!0,type:'Boolean'},{name:'participants',type:'Participant',isMany:!0},{name:'messageFlows',type:'MessageFlow',isMany:!0},{name:'artifacts',type:'Artifact',isMany:!0},{name:'conversations',type:'ConversationNode',isMany:!0},{name:'conversationAssociations',type:'ConversationAssociation'},{name:'participantAssociations',type:'ParticipantAssociation',isMany:!0},{name:'messageFlowAssociations',type:'MessageFlowAssociation',isMany:!0},{name:'correlationKeys',type:'CorrelationKey',isMany:!0},{name:'choreographyRef',type:'Choreography',isMany:!0,isReference:!0},{name:'conversationLinks',type:'ConversationLink',isMany:!0}]},{name:'ChoreographyActivity',isAbstract:!0,superClass:['FlowNode'],properties:[{name:'participantRefs',type:'Participant',isMany:!0,isReference:!0},{name:'initiatingParticipantRef',type:'Participant',isAttr:!0,isReference:!0},{name:'correlationKeys',type:'CorrelationKey',isMany:!0},{name:'loopType',type:'ChoreographyLoopType','default':'None',isAttr:!0}]},{name:'CallChoreography',superClass:['ChoreographyActivity'],properties:[{name:'calledChoreographyRef',type:'Choreography',isAttr:!0,isReference:!0},{name:'participantAssociations',type:'ParticipantAssociation',isMany:!0}]},{name:'SubChoreography',superClass:['ChoreographyActivity','FlowElementsContainer'],properties:[{name:'artifacts',type:'Artifact',isMany:!0}]},{name:'ChoreographyTask',superClass:['ChoreographyActivity'],properties:[{name:'messageFlowRef',type:'MessageFlow',isMany:!0,isReference:!0}]},{name:'Choreography',superClass:['FlowElementsContainer','Collaboration']},{name:'GlobalChoreographyTask',superClass:['Choreography'],properties:[{name:'initiatingParticipantRef',type:'Participant',isAttr:!0,isReference:!0}]},{name:'TextAnnotation',superClass:['Artifact'],properties:[{name:'text',type:'String'},{name:'textFormat','default':'text/plain',isAttr:!0,type:'String'}]},{name:'Group',superClass:['Artifact'],properties:[{name:'categoryValueRef',type:'CategoryValue',isAttr:!0,isReference:!0}]},{name:'Association',superClass:['Artifact'],properties:[{name:'associationDirection',type:'AssociationDirection',isAttr:!0},{name:'sourceRef',type:'BaseElement',isAttr:!0,isReference:!0},{name:'targetRef',type:'BaseElement',isAttr:!0,isReference:!0}]},{name:'Category',superClass:['RootElement'],properties:[{name:'categoryValue',type:'CategoryValue',isMany:!0},{name:'name',isAttr:!0,type:'String'}]},{name:'Artifact',isAbstract:!0,superClass:['BaseElement']},{name:'CategoryValue',superClass:['BaseElement'],properties:[{name:'categorizedFlowElements',type:'FlowElement',isVirtual:!0,isMany:!0,isReference:!0},{name:'value',isAttr:!0,type:'String'}]},{name:'Activity',isAbstract:!0,superClass:['FlowNode'],properties:[{name:'isForCompensation','default':!1,isAttr:!0,type:'Boolean'},{name:'default',type:'SequenceFlow',isAttr:!0,isReference:!0},{name:'ioSpecification',type:'InputOutputSpecification',xml:{serialize:'property'}},{name:'boundaryEventRefs',type:'BoundaryEvent',isMany:!0,isReference:!0},{name:'properties',type:'Property',isMany:!0},{name:'dataInputAssociations',type:'DataInputAssociation',isMany:!0},{name:'dataOutputAssociations',type:'DataOutputAssociation',isMany:!0},{name:'startQuantity','default':1,isAttr:!0,type:'Integer'},{name:'resources',type:'ResourceRole',isMany:!0},{name:'completionQuantity','default':1,isAttr:!0,type:'Integer'},{name:'loopCharacteristics',type:'LoopCharacteristics'}]},{name:'ServiceTask',superClass:['Task'],properties:[{name:'implementation',isAttr:!0,type:'String'},{name:'operationRef',type:'Operation',isAttr:!0,isReference:!0}]},{name:'SubProcess',superClass:['Activity','FlowElementsContainer','InteractionNode'],properties:[{name:'triggeredByEvent','default':!1,isAttr:!0,type:'Boolean'},{name:'artifacts',type:'Artifact',isMany:!0}]},{name:'LoopCharacteristics',isAbstract:!0,superClass:['BaseElement']},{name:'MultiInstanceLoopCharacteristics',superClass:['LoopCharacteristics'],properties:[{name:'isSequential','default':!1,isAttr:!0,type:'Boolean'},{name:'behavior',type:'MultiInstanceBehavior','default':'All',isAttr:!0},{name:'loopCardinality',type:'Expression',xml:{serialize:'xsi:type'}},{name:'loopDataInputRef',type:'ItemAwareElement',isReference:!0},{name:'loopDataOutputRef',type:'ItemAwareElement',isReference:!0},{name:'inputDataItem',type:'DataInput',xml:{serialize:'property'}},{name:'outputDataItem',type:'DataOutput',xml:{serialize:'property'}},{name:'complexBehaviorDefinition',type:'ComplexBehaviorDefinition',isMany:!0},{name:'completionCondition',type:'Expression',xml:{serialize:'xsi:type'}},{name:'oneBehaviorEventRef',type:'EventDefinition',isAttr:!0,isReference:!0},{name:'noneBehaviorEventRef',type:'EventDefinition',isAttr:!0,isReference:!0}]},{name:'StandardLoopCharacteristics',superClass:['LoopCharacteristics'],properties:[{name:'testBefore','default':!1,isAttr:!0,type:'Boolean'},{name:'loopCondition',type:'Expression',xml:{serialize:'xsi:type'}},{name:'loopMaximum',type:'Expression',xml:{serialize:'xsi:type'}}]},{name:'CallActivity',superClass:['Activity'],properties:[{name:'calledElement',type:'String',isAttr:!0}]},{name:'Task',superClass:['Activity','InteractionNode']},{name:'SendTask',superClass:['Task'],properties:[{name:'implementation',isAttr:!0,type:'String'},{name:'operationRef',type:'Operation',isAttr:!0,isReference:!0},{name:'messageRef',type:'Message',isAttr:!0,isReference:!0}]},{name:'ReceiveTask',superClass:['Task'],properties:[{name:'implementation',isAttr:!0,type:'String'},{name:'instantiate','default':!1,isAttr:!0,type:'Boolean'},{name:'operationRef',type:'Operation',isAttr:!0,isReference:!0},{name:'messageRef',type:'Message',isAttr:!0,isReference:!0}]},{name:'ScriptTask',superClass:['Task'],properties:[{name:'scriptFormat',isAttr:!0,type:'String'},{name:'script',type:'String'}]},{name:'BusinessRuleTask',superClass:['Task'],properties:[{name:'implementation',isAttr:!0,type:'String'}]},{name:'AdHocSubProcess',superClass:['SubProcess'],properties:[{name:'completionCondition',type:'Expression',xml:{serialize:'xsi:type'}},{name:'ordering',type:'AdHocOrdering',isAttr:!0},{name:'cancelRemainingInstances','default':!0,isAttr:!0,type:'Boolean'}]},{name:'Transaction',superClass:['SubProcess'],properties:[{name:'protocol',isAttr:!0,type:'String'},{name:'method',isAttr:!0,type:'String'}]},{name:'GlobalScriptTask',superClass:['GlobalTask'],properties:[{name:'scriptLanguage',isAttr:!0,type:'String'},{name:'script',isAttr:!0,type:'String'}]},{name:'GlobalBusinessRuleTask',superClass:['GlobalTask'],properties:[{name:'implementation',isAttr:!0,type:'String'}]},{name:'ComplexBehaviorDefinition',superClass:['BaseElement'],properties:[{name:'condition',type:'FormalExpression'},{name:'event',type:'ImplicitThrowEvent'}]},{name:'ResourceRole',superClass:['BaseElement'],properties:[{name:'resourceRef',type:'Resource',isReference:!0},{name:'resourceParameterBindings',type:'ResourceParameterBinding',isMany:!0},{name:'resourceAssignmentExpression',type:'ResourceAssignmentExpression'},{name:'name',isAttr:!0,type:'String'}]},{name:'ResourceParameterBinding',properties:[{name:'expression',type:'Expression',xml:{serialize:'xsi:type'}},{name:'parameterRef',type:'ResourceParameter',isAttr:!0,isReference:!0}],superClass:['BaseElement']},{name:'ResourceAssignmentExpression',properties:[{name:'expression',type:'Expression',xml:{serialize:'xsi:type'}}],superClass:['BaseElement']},{name:'Import',properties:[{name:'importType',isAttr:!0,type:'String'},{name:'location',isAttr:!0,type:'String'},{name:'namespace',isAttr:!0,type:'String'}]},{name:'Definitions',superClass:['BaseElement'],properties:[{name:'name',isAttr:!0,type:'String'},{name:'targetNamespace',isAttr:!0,type:'String'},{name:'expressionLanguage','default':'http://www.w3.org/1999/XPath',isAttr:!0,type:'String'},{name:'typeLanguage','default':'http://www.w3.org/2001/XMLSchema',isAttr:!0,type:'String'},{name:'imports',type:'Import',isMany:!0},{name:'extensions',type:'Extension',isMany:!0},{name:'rootElements',type:'RootElement',isMany:!0},{name:'diagrams',isMany:!0,type:'bpmndi:BPMNDiagram'},{name:'exporter',isAttr:!0,type:'String'},{name:'relationships',type:'Relationship',isMany:!0},{name:'exporterVersion',isAttr:!0,type:'String'}]}],enumerations:[{name:'ProcessType',literalValues:[{name:'None'},{name:'Public'},{name:'Private'}]},{name:'GatewayDirection',literalValues:[{name:'Unspecified'},{name:'Converging'},{name:'Diverging'},{name:'Mixed'}]},{name:'EventBasedGatewayType',literalValues:[{name:'Parallel'},{name:'Exclusive'}]},{name:'RelationshipDirection',literalValues:[{name:'None'},{name:'Forward'},{name:'Backward'},{name:'Both'}]},{name:'ItemKind',literalValues:[{name:'Physical'},{name:'Information'}]},{name:'ChoreographyLoopType',literalValues:[{name:'None'},{name:'Standard'},{name:'MultiInstanceSequential'},{name:'MultiInstanceParallel'}]},{name:'AssociationDirection',literalValues:[{name:'None'},{name:'One'},{name:'Both'}]},{name:'MultiInstanceBehavior',literalValues:[{name:'None'},{name:'One'},{name:'All'},{name:'Complex'}]},{name:'AdHocOrdering',literalValues:[{name:'Parallel'},{name:'Sequential'}]}],prefix:'bpmn',xml:{tagAlias:'lowerCase',typePrefix:'t'}};},{}],168:[function(require,module,exports){module.exports={name:'BPMNDI',uri:'http://www.omg.org/spec/BPMN/20100524/DI',types:[{name:'BPMNDiagram',properties:[{name:'plane',type:'BPMNPlane',redefines:'di:Diagram#rootElement'},{name:'labelStyle',type:'BPMNLabelStyle',isMany:!0}],superClass:['di:Diagram']},{name:'BPMNPlane',properties:[{name:'bpmnElement',isAttr:!0,isReference:!0,type:'bpmn:BaseElement',redefines:'di:DiagramElement#modelElement'}],superClass:['di:Plane']},{name:'BPMNShape',properties:[{name:'bpmnElement',isAttr:!0,isReference:!0,type:'bpmn:BaseElement',redefines:'di:DiagramElement#modelElement'},{name:'isHorizontal',isAttr:!0,type:'Boolean'},{name:'isExpanded',isAttr:!0,type:'Boolean'},{name:'isMarkerVisible',isAttr:!0,type:'Boolean'},{name:'label',type:'BPMNLabel'},{name:'isMessageVisible',isAttr:!0,type:'Boolean'},{name:'participantBandKind',type:'ParticipantBandKind',isAttr:!0},{name:'choreographyActivityShape',type:'BPMNShape',isAttr:!0,isReference:!0}],superClass:['di:LabeledShape']},{name:'BPMNEdge',properties:[{name:'label',type:'BPMNLabel'},{name:'bpmnElement',isAttr:!0,isReference:!0,type:'bpmn:BaseElement',redefines:'di:DiagramElement#modelElement'},{name:'sourceElement',isAttr:!0,isReference:!0,type:'di:DiagramElement',redefines:'di:Edge#source'},{name:'targetElement',isAttr:!0,isReference:!0,type:'di:DiagramElement',redefines:'di:Edge#target'},{name:'messageVisibleKind',type:'MessageVisibleKind',isAttr:!0,'default':'initiating'}],superClass:['di:LabeledEdge']},{name:'BPMNLabel',properties:[{name:'labelStyle',type:'BPMNLabelStyle',isAttr:!0,isReference:!0,redefines:'di:DiagramElement#style'}],superClass:['di:Label']},{name:'BPMNLabelStyle',properties:[{name:'font',type:'dc:Font'}],superClass:['di:Style']}],enumerations:[{name:'ParticipantBandKind',literalValues:[{name:'top_initiating'},{name:'middle_initiating'},{name:'bottom_initiating'},{name:'top_non_initiating'},{name:'middle_non_initiating'},{name:'bottom_non_initiating'}]},{name:'MessageVisibleKind',literalValues:[{name:'initiating'},{name:'non_initiating'}]}],associations:[],prefix:'bpmndi'};},{}],169:[function(require,module,exports){module.exports={name:'DC',uri:'http://www.omg.org/spec/DD/20100524/DC',types:[{name:'Boolean'},{name:'Integer'},{name:'Real'},{name:'String'},{name:'Font',properties:[{name:'name',type:'String',isAttr:!0},{name:'size',type:'Real',isAttr:!0},{name:'isBold',type:'Boolean',isAttr:!0},{name:'isItalic',type:'Boolean',isAttr:!0},{name:'isUnderline',type:'Boolean',isAttr:!0},{name:'isStrikeThrough',type:'Boolean',isAttr:!0}]},{name:'Point',properties:[{name:'x',type:'Real','default':'0',isAttr:!0},{name:'y',type:'Real','default':'0',isAttr:!0}]},{name:'Bounds',properties:[{name:'x',type:'Real','default':'0',isAttr:!0},{name:'y',type:'Real','default':'0',isAttr:!0},{name:'width',type:'Real',isAttr:!0},{name:'height',type:'Real',isAttr:!0}]}],prefix:'dc',associations:[]};},{}],170:[function(require,module,exports){module.exports={name:'DI',uri:'http://www.omg.org/spec/DD/20100524/DI',types:[{name:'DiagramElement',isAbstract:!0,properties:[{name:'id',type:'String',isAttr:!0,isId:!0},{name:'extension',type:'Extension'},{name:'owningDiagram',type:'Diagram',isReadOnly:!0,isVirtual:!0,isReference:!0},{name:'owningElement',type:'DiagramElement',isReadOnly:!0,isVirtual:!0,isReference:!0},{name:'modelElement',isReadOnly:!0,isVirtual:!0,isReference:!0,type:'Element'},{name:'style',type:'Style',isReadOnly:!0,isVirtual:!0,isReference:!0},{name:'ownedElement',type:'DiagramElement',isReadOnly:!0,isVirtual:!0,isMany:!0}]},{name:'Node',isAbstract:!0,superClass:['DiagramElement']},{name:'Edge',isAbstract:!0,superClass:['DiagramElement'],properties:[{name:'source',type:'DiagramElement',isReadOnly:!0,isVirtual:!0,isReference:!0},{name:'target',type:'DiagramElement',isReadOnly:!0,isVirtual:!0,isReference:!0},{name:'waypoint',isUnique:!1,isMany:!0,type:'dc:Point',xml:{serialize:'xsi:type'}}]},{name:'Diagram',isAbstract:!0,properties:[{name:'id',type:'String',isAttr:!0,isId:!0},{name:'rootElement',type:'DiagramElement',isReadOnly:!0,isVirtual:!0},{name:'name',isAttr:!0,type:'String'},{name:'documentation',isAttr:!0,type:'String'},{name:'resolution',isAttr:!0,type:'Real'},{name:'ownedStyle',type:'Style',isReadOnly:!0,isVirtual:!0,isMany:!0}]},{name:'Shape',isAbstract:!0,superClass:['Node'],properties:[{name:'bounds',type:'dc:Bounds'}]},{name:'Plane',isAbstract:!0,superClass:['Node'],properties:[{name:'planeElement',type:'DiagramElement',subsettedProperty:'DiagramElement-ownedElement',isMany:!0}]},{name:'LabeledEdge',isAbstract:!0,superClass:['Edge'],properties:[{name:'ownedLabel',type:'Label',isReadOnly:!0,subsettedProperty:'DiagramElement-ownedElement',isVirtual:!0,isMany:!0}]},{name:'LabeledShape',isAbstract:!0,superClass:['Shape'],properties:[{name:'ownedLabel',type:'Label',isReadOnly:!0,subsettedProperty:'DiagramElement-ownedElement',isVirtual:!0,isMany:!0}]},{name:'Label',isAbstract:!0,superClass:['Node'],properties:[{name:'bounds',type:'dc:Bounds'}]},{name:'Style',isAbstract:!0,properties:[{name:'id',type:'String',isAttr:!0,isId:!0}]},{name:'Extension',properties:[{name:'values',type:'Element',isMany:!0}]}],associations:[],prefix:'di',xml:{tagAlias:'lowerCase'}};},{}],171:[function(require,module,exports){'use strict';function EventEmitter(){this._events&&Object.prototype.hasOwnProperty.call(this,'_events')||(this._events=objectCreate(null),this._eventsCount=0),this._maxListeners=this._maxListeners||undefined;}function $getMaxListeners(that){return that._maxListeners===undefined?EventEmitter.defaultMaxListeners:that._maxListeners;}function emitNone(handler,isFn,self){if(isFn)handler.call(self);else{var len=handler.length;var listeners=arrayClone(handler,len);for(var i=0;i<len;++i)listeners[i].call(self);}}function emitOne(handler,isFn,self,arg1){if(isFn)handler.call(self,arg1);else{var len=handler.length;var listeners=arrayClone(handler,len);for(var i=0;i<len;++i)listeners[i].call(self,arg1);}}function emitTwo(handler,isFn,self,arg1,arg2){if(isFn)handler.call(self,arg1,arg2);else{var len=handler.length;var listeners=arrayClone(handler,len);for(var i=0;i<len;++i)listeners[i].call(self,arg1,arg2);}}function emitThree(handler,isFn,self,arg1,arg2,arg3){if(isFn)handler.call(self,arg1,arg2,arg3);else{var len=handler.length;var listeners=arrayClone(handler,len);for(var i=0;i<len;++i)listeners[i].call(self,arg1,arg2,arg3);}}function emitMany(handler,isFn,self,args){if(isFn)handler.apply(self,args);else{var len=handler.length;var listeners=arrayClone(handler,len);for(var i=0;i<len;++i)listeners[i].apply(self,args);}}function _addListener(target,type,listener,prepend){var m;var events;var existing;if(typeof listener!=='function')throw new TypeError('"listener" argument must be a function');if(events=target._events,events?(events.newListener&&(target.emit('newListener',type,listener.listener?listener.listener:listener),events=target._events),existing=events[type]):(events=target._events=objectCreate(null),target._eventsCount=0),!existing)existing=events[type]=listener,++target._eventsCount;else if(typeof existing==='function'?existing=events[type]=prepend?[listener,existing]:[existing,listener]:prepend?existing.unshift(listener):existing.push(listener),!existing.warned&&(m=$getMaxListeners(target),m&&m>0&&existing.length>m)){existing.warned=!0;var w=new Error('Possible EventEmitter memory leak detected. '+existing.length+' "'+String(type)+'" listeners '+'added. Use emitter.setMaxListeners() to '+'increase limit.');w.name='MaxListenersExceededWarning',w.emitter=target,w.type=type,w.count=existing.length,(typeof console==='undefined'?'undefined':_typeof(console))==='object'&&console.warn&&console.warn('%s: %s',w.name,w.message);}return target;}function onceWrapper(){if(!this.fired){this.target.removeListener(this.type,this.wrapFn),this.fired=!0;switch(arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:var args=new Array(arguments.length);for(var i=0;i<args.length;++i)args[i]=arguments[i];this.listener.apply(this.target,args);}}}function _onceWrap(target,type,listener){var state={fired:!1,wrapFn:undefined,target:target,type:type,listener:listener};var wrapped=bind.call(onceWrapper,state);return wrapped.listener=listener,state.wrapFn=wrapped,wrapped;}function listenerCount(type){var events=this._events;if(events){var evlistener=events[type];if(typeof evlistener==='function')return 1;else if(evlistener)return evlistener.length;}return 0;}function spliceOne(list,index){for(var i=index,k=i+1,n=list.length;k<n;i+=1,k+=1)list[i]=list[k];list.pop();}function arrayClone(arr,n){var copy=new Array(n);for(var i=0;i<n;++i)copy[i]=arr[i];return copy;}function unwrapListeners(arr){var ret=new Array(arr.length);for(var i=0;i<ret.length;++i)ret[i]=arr[i].listener||arr[i];return ret;}function objectCreatePolyfill(proto){var F=function F(){};return F.prototype=proto,new F();}function objectKeysPolyfill(obj){var keys=[];for(var k in obj)Object.prototype.hasOwnProperty.call(obj,k)&&keys.push(k);return k;}function functionBindPolyfill(context){var fn=this;return function(){return fn.apply(context,arguments);};}var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj;};var objectCreate=Object.create||objectCreatePolyfill;var objectKeys=Object.keys||objectKeysPolyfill;var bind=Function.prototype.bind||functionBindPolyfill;module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=undefined,EventEmitter.prototype._maxListeners=undefined;var defaultMaxListeners=10;var hasDefineProperty;try{var o={};Object.defineProperty&&Object.defineProperty(o,'x',{value:0}),hasDefineProperty=o.x===0;}catch(err){hasDefineProperty=false;}hasDefineProperty?Object.defineProperty(EventEmitter,'defaultMaxListeners',{enumerable:!0,get:function get(){return defaultMaxListeners;},set:function set(arg){if(typeof arg!=='number'||arg<0||arg!==arg)throw new TypeError('"defaultMaxListeners" must be a positive number');defaultMaxListeners=arg;}}):EventEmitter.defaultMaxListeners=defaultMaxListeners,EventEmitter.prototype.setMaxListeners=function setMaxListeners(n){if(typeof n!=='number'||n<0||isNaN(n))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=n,this;},EventEmitter.prototype.getMaxListeners=function getMaxListeners(){return $getMaxListeners(this);},EventEmitter.prototype.emit=function emit(type){var er,handler,len,args,i,events;var doError=type==='error';if(events=this._events,events)doError=doError&&events.error==null;else if(!doError)return!1;if(doError){if(arguments.length>1&&(er=arguments[1]),er instanceof Error)throw er;else{var err=new Error('Unhandled "error" event. ('+er+')');throw err.context=er,err;}return!1;}if(handler=events[type],!handler)return!1;var isFn=typeof handler==='function';len=arguments.length;switch(len){case 1:emitNone(handler,isFn,this);break;case 2:emitOne(handler,isFn,this,arguments[1]);break;case 3:emitTwo(handler,isFn,this,arguments[1],arguments[2]);break;case 4:emitThree(handler,isFn,this,arguments[1],arguments[2],arguments[3]);break;default:args=new Array(len-1);for(i=1;i<len;i++)args[i-1]=arguments[i];emitMany(handler,isFn,this,args);}return!0;},EventEmitter.prototype.addListener=function addListener(type,listener){return _addListener(this,type,listener,!1);},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.prependListener=function prependListener(type,listener){return _addListener(this,type,listener,!0);},EventEmitter.prototype.once=function once(type,listener){if(typeof listener!=='function')throw new TypeError('"listener" argument must be a function');return this.on(type,_onceWrap(this,type,listener)),this;},EventEmitter.prototype.prependOnceListener=function prependOnceListener(type,listener){if(typeof listener!=='function')throw new TypeError('"listener" argument must be a function');return this.prependListener(type,_onceWrap(this,type,listener)),this;},EventEmitter.prototype.removeListener=function removeListener(type,listener){var list,events,position,i,originalListener;if(typeof listener!=='function')throw new TypeError('"listener" argument must be a function');if(events=this._events,!events)return this;if(list=events[type],!list)return this;if(list===listener||list.listener===listener)--this._eventsCount===0?this._events=objectCreate(null):(delete events[type],events.removeListener&&this.emit('removeListener',type,list.listener||listener));else if(typeof list!=='function'){for(position=-1,i=list.length-1;i>=0;i--)if(list[i]===listener||list[i].listener===listener){originalListener=list[i].listener,position=i;break;}if(position<0)return this;position===0?list.shift():spliceOne(list,position),list.length===1&&(events[type]=list[0]),events.removeListener&&this.emit('removeListener',type,originalListener||listener);}return this;},EventEmitter.prototype.removeAllListeners=function removeAllListeners(type){var listeners,events,i;if(events=this._events,!events)return this;if(!events.removeListener)return arguments.length===0?(this._events=objectCreate(null),this._eventsCount=0):events[type]&&(--this._eventsCount===0?this._events=objectCreate(null):delete events[type]),this;if(arguments.length===0){var keys=objectKeys(events);var key;for(i=0;i<keys.length;++i){if(key=keys[i],key==='removeListener')continue;this.removeAllListeners(key);}return this.removeAllListeners('removeListener'),this._events=objectCreate(null),this._eventsCount=0,this;}if(listeners=events[type],typeof listeners==='function')this.removeListener(type,listeners);else if(listeners)for(i=listeners.length-1;i>=0;i--)this.removeListener(type,listeners[i]);return this;},EventEmitter.prototype.listeners=function listeners(type){var evlistener;var ret;var events=this._events;return events?(evlistener=events[type],evlistener?typeof evlistener==='function'?ret=[evlistener.listener||evlistener]:ret=unwrapListeners(evlistener):ret=[]):ret=[],ret;},EventEmitter.listenerCount=function(emitter,type){return typeof emitter.listenerCount==='function'?emitter.listenerCount(type):listenerCount.call(emitter,type);},EventEmitter.prototype.listenerCount=listenerCount,EventEmitter.prototype.eventNames=function eventNames(){return this._eventsCount>0?Reflect.ownKeys(this._events):[];};},{}],172:[function(require,module,exports){'use strict';function ClassList(el){if(!(el&&el.nodeType))throw new Error('A DOM element reference is required');this.el=el,this.list=el.classList;}try{var index=require('indexof');}catch(err){var index=require('component-indexof');}var re=/\s+/;var toString=Object.prototype.toString;module.exports=function(el){return new ClassList(el);},ClassList.prototype.add=function(name){if(this.list)return this.list.add(name),this;var arr=this.array();var i=index(arr,name);return~i||arr.push(name),this.el.className=arr.join(' '),this;},ClassList.prototype.remove=function(name){if('[object RegExp]'==toString.call(name))return this.removeMatching(name);if(this.list)return this.list.remove(name),this;var arr=this.array();var i=index(arr,name);return~i&&arr.splice(i,1),this.el.className=arr.join(' '),this;},ClassList.prototype.removeMatching=function(re){var arr=this.array();for(var i=0;i<arr.length;i++)re.test(arr[i])&&this.remove(arr[i]);return this;},ClassList.prototype.toggle=function(name,force){return this.list?(void 0!==force?force!==this.list.toggle(name,force)&&this.list.toggle(name):this.list.toggle(name),this):(void 0!==force?force?this.add(name):this.remove(name):this.has(name)?this.remove(name):this.add(name),this);},ClassList.prototype.array=function(){var className=this.el.getAttribute('class')||'';var str=className.replace(/^\s+|\s+$/g,'');var arr=str.split(re);return''===arr[0]&&arr.shift(),arr;},ClassList.prototype.has=ClassList.prototype.contains=function(name){return this.list?this.list.contains(name):!!~index(this.array(),name);};},{'component-indexof':176,indexof:176}],173:[function(require,module,exports){'use strict';var matches=require('matches-selector');module.exports=function(element,selector,checkYoSelf,root){element=checkYoSelf?{parentNode:element}:element,root=root||document;while((element=element.parentNode)&&element!==document){if(matches(element,selector))return element;if(element===root)return;}};},{'matches-selector':177}],174:[function(require,module,exports){'use strict';try{var closest=require('closest');}catch(err){var closest=require('component-closest');}try{var event=require('event');}catch(err){var event=require('component-event');}exports.bind=function(el,selector,type,fn,capture){return event.bind(el,type,function(e){var target=e.target||e.srcElement;e.delegateTarget=closest(target,selector,!0,el),e.delegateTarget&&fn.call(el,e);},capture);},exports.unbind=function(el,type,fn,capture){event.unbind(el,type,fn,capture);};},{closest:173,'component-closest':173,'component-event':175,event:175}],175:[function(require,module,exports){'use strict';var bind=window.addEventListener?'addEventListener':'attachEvent',unbind=window.removeEventListener?'removeEventListener':'detachEvent',prefix=bind!=='addEventListener'?'on':'';exports.bind=function(el,type,fn,capture){return el[bind](prefix+type,fn,capture||!1),fn;},exports.unbind=function(el,type,fn,capture){return el[unbind](prefix+type,fn,capture||!1),fn;};},{}],176:[function(require,module,exports){'use strict';module.exports=function(arr,obj){if(arr.indexOf)return arr.indexOf(obj);for(var i=0;i<arr.length;++i)if(arr[i]===obj)return i;return-1;};},{}],177:[function(require,module,exports){'use strict';function match(el,selector){if(!el||el.nodeType!==1)return!1;if(vendor)return vendor.call(el,selector);var nodes=query.all(selector,el.parentNode);for(var i=0;i<nodes.length;++i)if(nodes[i]==el)return!0;return!1;}try{var query=require('query');}catch(err){var query=require('component-query');}var proto=Element.prototype;var vendor=proto.matches||proto.webkitMatchesSelector||proto.mozMatchesSelector||proto.msMatchesSelector||proto.oMatchesSelector;module.exports=match;},{'component-query':178,query:178}],178:[function(require,module,exports){'use strict';function one(selector,el){return el.querySelector(selector);}exports=module.exports=function(selector,el){return el=el||document,one(selector,el);},exports.all=function(selector,el){return el=el||document,el.querySelectorAll(selector);},exports.engine=function(obj){if(!obj.one)throw new Error('.one callback required');if(!obj.all)throw new Error('.all callback required');return one=obj.one,exports.all=obj.all,exports;};},{}],179:[function(require,module,exports){(function(global){'use strict';var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj;};(function(root,factory){(exports===void 0?'undefined':_typeof(exports))=='object'?module.exports=factory(root):typeof define=='function'&&define.amd?define([],factory.bind(root,root)):factory(root);}(global!==void 0?global:undefined,function(root){if(root.CSS&&root.CSS.escape)return root.CSS.escape;var cssEscape=function cssEscape(value){if(arguments.length==0)throw new TypeError('`CSS.escape` requires an argument.');var string=String(value);var length=string.length;var index=-1;var codeUnit;var result='';var firstCodeUnit=string.charCodeAt(0);while(++index<length){if(codeUnit=string.charCodeAt(index),codeUnit==0){result+='\uFFFD';continue;}if(codeUnit>=1&&codeUnit<=31||codeUnit==127||index==0&&codeUnit>=48&&codeUnit<=57||index==1&&codeUnit>=48&&codeUnit<=57&&firstCodeUnit==45){result+='\\'+codeUnit.toString(16)+' ';continue;}if(index==0&&length==1&&codeUnit==45){result+='\\'+string.charAt(index);continue;}if(codeUnit>=128||codeUnit==45||codeUnit==95||codeUnit>=48&&codeUnit<=57||codeUnit>=65&&codeUnit<=90||codeUnit>=97&&codeUnit<=122){result+=string.charAt(index);continue;}result+='\\'+string.charAt(index);}return result;};return root.CSS||(root.CSS={}),root.CSS.escape=cssEscape,cssEscape;}));}.call(this,typeof global!=='undefined'?global:typeof self!=='undefined'?self:typeof window!=='undefined'?window:{}));},{}],180:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _interactionEvents=require('diagram-js/lib/features/interaction-events');var _interactionEvents2=_interopRequireDefault(_interactionEvents);var _DirectEditing=require('./lib/DirectEditing');var _DirectEditing2=_interopRequireDefault(_DirectEditing);exports.default={__depends__:[_interactionEvents2.default],__init__:['directEditing'],directEditing:['type',_DirectEditing2.default]};},{'./lib/DirectEditing':181,'diagram-js/lib/features/interaction-events':236}],181:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function DirectEditing(eventBus,canvas){this._eventBus=eventBus,this._providers=[],this._textbox=new _TextBox2.default({container:canvas.getContainer(),keyHandler:(0,_minDash.bind)(this._handleKey,this),resizeHandler:(0,_minDash.bind)(this._handleResize,this)});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=DirectEditing;var _minDash=require('min-dash');var _TextBox=require('./TextBox');var _TextBox2=_interopRequireDefault(_TextBox);DirectEditing.$inject=['eventBus','canvas'],DirectEditing.prototype.registerProvider=function(provider){this._providers.push(provider);},DirectEditing.prototype.isActive=function(){return!!this._active;},DirectEditing.prototype.cancel=function(){if(!this._active)return;this._fire('cancel'),this.close();},DirectEditing.prototype._fire=function(event,context){this._eventBus.fire('directEditing.'+event,context||{active:this._active});},DirectEditing.prototype.close=function(){this._textbox.destroy(),this._fire('deactivate'),this._active=null,this.resizable=undefined;},DirectEditing.prototype.complete=function(){var active=this._active;if(!active)return;var text=this.getValue();var bounds=this.$textbox.getBoundingClientRect();(text!==active.context.text||this.resizable)&&active.provider.update(active.element,text,active.context.text,{x:bounds.top,y:bounds.left,width:bounds.width,height:bounds.height}),this._fire('complete'),this.close();},DirectEditing.prototype.getValue=function(){return this._textbox.getValue();},DirectEditing.prototype._handleKey=function(e){e.stopPropagation();var key=e.keyCode||e.charCode;return key===27?(e.preventDefault(),this.cancel()):key===13&&!e.shiftKey?(e.preventDefault(),this.complete()):void 0;},DirectEditing.prototype._handleResize=function(event){this._fire('resize',event);},DirectEditing.prototype.activate=function(element){this.isActive()&&this.cancel();var context;var provider=(0,_minDash.find)(this._providers,function(p){return(context=p.activate(element))?p:null;});return context&&(this.$textbox=this._textbox.create(context.bounds,context.style,context.text,context.options),this._active={element:element,context:context,provider:provider},context.options&&context.options.resizable&&(this.resizable=!0),this._fire('activate')),!!context;};},{'./TextBox':182,'min-dash':438}],182:[function(require,module,exports){'use strict';function preventDefault(e){e.preventDefault();}function stopPropagation(e){e.stopPropagation();}function isTextNode(node){return node.nodeType===Node.TEXT_NODE;}function toArray(nodeList){return[].slice.call(nodeList);}function TextBox(options){this.container=options.container,this.parent=(0,_minDom.domify)('<div class="djs-direct-editing-parent">'+'<div class="djs-direct-editing-content" contenteditable="true"></div>'+'</div>'),this.content=(0,_minDom.query)('[contenteditable]',this.parent),this.keyHandler=options.keyHandler||function(){},this.resizeHandler=options.resizeHandler||function(){},this.autoResize=(0,_minDash.bind)(this.autoResize,this),this.handlePaste=(0,_minDash.bind)(this.handlePaste,this);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=TextBox;var _minDash=require('min-dash');var _minDom=require('min-dom');var min=Math.min,max=Math.max;TextBox.prototype.create=function(bounds,style,value,options){var self=this;var parent=this.parent,content=this.content,container=this.container;options=this.options=options||{},style=this.style=style||{};var parentStyle=(0,_minDash.pick)(style,['width','height','maxWidth','maxHeight','minWidth','minHeight','left','top','backgroundColor','position','overflow','border','wordWrap','textAlign','outline','transform']);(0,_minDash.assign)(parent.style,{width:bounds.width+'px',height:bounds.height+'px',maxWidth:bounds.maxWidth+'px',maxHeight:bounds.maxHeight+'px',minWidth:bounds.minWidth+'px',minHeight:bounds.minHeight+'px',left:bounds.x+'px',top:bounds.y+'px',backgroundColor:'#ffffff',position:'absolute',overflow:'visible',border:'1px solid #ccc',wordWrap:'normal',textAlign:'center',outline:'none'},parentStyle);var contentStyle=(0,_minDash.pick)(style,['fontSize','lineHeight','padding','paddingTop','paddingRight','paddingBottom','paddingLeft']);return(0,_minDash.assign)(content.style,{boxSizing:'border-box',width:'100%',outline:'none'},contentStyle),options.centerVertically&&(0,_minDash.assign)(content.style,{position:'absolute',top:'50%',transform:'translate(0, -50%)'},contentStyle),content.innerText=value,_minDom.event.bind(content,'keydown',this.keyHandler),_minDom.event.bind(content,'mousedown',stopPropagation),_minDom.event.bind(content,'paste',self.handlePaste),options.autoResize&&_minDom.event.bind(content,'input',this.autoResize),options.resizable&&this.resizable(style),container.appendChild(parent),this.setSelection(content.lastChild,content.lastChild&&content.lastChild.length),parent;},TextBox.prototype.handlePaste=function(e){var self=this;var options=this.options,style=this.style;e.preventDefault();var text;e.clipboardData?text=e.clipboardData.getData('text/plain'):text=window.clipboardData.getData('Text');var success=document.execCommand('insertHTML',!1,text);if(!success){var range=this.getSelection(),startContainer=range.startContainer,endContainer=range.endContainer,startOffset=range.startOffset,endOffset=range.endOffset,commonAncestorContainer=range.commonAncestorContainer;var childNodesArray=toArray(commonAncestorContainer.childNodes);var container,offset;if(isTextNode(commonAncestorContainer)){var containerTextContent=startContainer.textContent;startContainer.textContent=containerTextContent.substring(0,startOffset)+text+containerTextContent.substring(endOffset),container=startContainer,offset=startOffset+text.length;}else if(startContainer===this.content&&endContainer===this.content){var textNode=document.createTextNode(text);this.content.insertBefore(textNode,childNodesArray[startOffset]),container=textNode,offset=textNode.textContent.length;}else{var startContainerChildIndex=childNodesArray.indexOf(startContainer),endContainerChildIndex=childNodesArray.indexOf(endContainer);childNodesArray.forEach(function(childNode,index){index===startContainerChildIndex?childNode.textContent=startContainer.textContent.substring(0,startOffset)+text+endContainer.textContent.substring(endOffset):index>startContainerChildIndex&&index<=endContainerChildIndex&&(0,_minDom.remove)(childNode);}),container=startContainer,offset=startOffset+text.length;}container&&offset!==undefined&&setTimeout(function(){self.setSelection(container,offset);});}if(options.autoResize){var hasResized=this.autoResize(style);hasResized&&this.resizeHandler(hasResized);}},TextBox.prototype.autoResize=function(){var parent=this.parent,content=this.content;var fontSize=parseInt(this.style.fontSize)||12;if(content.scrollHeight>parent.offsetHeight||content.scrollHeight<parent.offsetHeight-fontSize){var bounds=parent.getBoundingClientRect();var height=content.scrollHeight;parent.style.height=height+'px',this.resizeHandler({width:bounds.width,height:bounds.height,dx:0,dy:height-bounds.height});}},TextBox.prototype.resizable=function(){var self=this;var parent=this.parent,resizeHandle=this.resizeHandle;var minWidth=parseInt(this.style.minWidth)||0,minHeight=parseInt(this.style.minHeight)||0,maxWidth=parseInt(this.style.maxWidth)||Infinity,maxHeight=parseInt(this.style.maxHeight)||Infinity;if(!resizeHandle){resizeHandle=this.resizeHandle=(0,_minDom.domify)('<div class="djs-direct-editing-resize-handle"></div>');var startX,startY,startWidth,startHeight;var onMouseDown=function onMouseDown(e){preventDefault(e),stopPropagation(e),startX=e.clientX,startY=e.clientY;var bounds=parent.getBoundingClientRect();startWidth=bounds.width,startHeight=bounds.height,_minDom.event.bind(document,'mousemove',onMouseMove),_minDom.event.bind(document,'mouseup',onMouseUp);};var onMouseMove=function onMouseMove(e){preventDefault(e),stopPropagation(e);var newWidth=min(max(startWidth+e.clientX-startX,minWidth),maxWidth);var newHeight=min(max(startHeight+e.clientY-startY,minHeight),maxHeight);parent.style.width=newWidth+'px',parent.style.height=newHeight+'px',self.resizeHandler({width:startWidth,height:startHeight,dx:e.clientX-startX,dy:e.clientY-startY});};var onMouseUp=function onMouseUp(e){preventDefault(e),stopPropagation(e),_minDom.event.unbind(document,'mousemove',onMouseMove,!1),_minDom.event.unbind(document,'mouseup',onMouseUp,!1);};_minDom.event.bind(resizeHandle,'mousedown',onMouseDown);}(0,_minDash.assign)(resizeHandle.style,{position:'absolute',bottom:'0px',right:'0px',cursor:'nwse-resize',width:'0',height:'0',borderTop:(parseInt(this.style.fontSize)/4||3)+'px solid transparent',borderRight:(parseInt(this.style.fontSize)/4||3)+'px solid #ccc',borderBottom:(parseInt(this.style.fontSize)/4||3)+'px solid #ccc',borderLeft:(parseInt(this.style.fontSize)/4||3)+'px solid transparent'}),parent.appendChild(resizeHandle);},TextBox.prototype.destroy=function(){var parent=this.parent,content=this.content,resizeHandle=this.resizeHandle;content.innerText='',parent.removeAttribute('style'),content.removeAttribute('style'),_minDom.event.unbind(content,'keydown',this.keyHandler),_minDom.event.unbind(content,'mousedown',stopPropagation),_minDom.event.unbind(content,'input',this.autoResize),_minDom.event.unbind(content,'paste',this.handlePaste),resizeHandle&&(resizeHandle.removeAttribute('style'),(0,_minDom.remove)(resizeHandle)),(0,_minDom.remove)(parent);},TextBox.prototype.getValue=function(){return this.content.innerText;},TextBox.prototype.getSelection=function(){var selection=window.getSelection(),range=selection.getRangeAt(0);return range;},TextBox.prototype.setSelection=function(container,offset){var range=document.createRange();container===null?range.selectNodeContents(this.content):(range.setStart(container,offset),range.setEnd(container,offset));var selection=window.getSelection();selection.removeAllRanges(),selection.addRange(range);};},{'min-dash':438,'min-dom':439}],183:[function(require,module,exports){'use strict';module.exports=require('./lib/Diagram');},{'./lib/Diagram':184}],184:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function bootstrap(bootstrapModules){function hasModule(m){return modules.indexOf(m)>=0;}function addModule(m){modules.push(m);}function visit(m){if(hasModule(m))return;if((m.__depends__||[]).forEach(visit),hasModule(m))return;addModule(m),(m.__init__||[]).forEach(function(c){components.push(c);});}var modules=[],components=[];bootstrapModules.forEach(visit);var injector=new _didi.Injector(modules);return components.forEach(function(c){try{injector[typeof c==='string'?'get':'invoke'](c);}catch(e){console.error('Failed to instantiate component');console.error(e.stack);throw e;}}),injector;}function createInjector(options){options=options||{};var configModule={config:['value',options]};var modules=[configModule,_core2.default].concat(options.modules||[]);return bootstrap(modules);}function Diagram(options,injector){this.injector=injector=injector||createInjector(options),this.get=injector.get,this.invoke=injector.invoke,this.get('eventBus').fire('diagram.init');}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=Diagram;var _didi=require('didi');var _core=require('./core');var _core2=_interopRequireDefault(_core);Diagram.prototype.destroy=function(){this.get('eventBus').fire('diagram.destroy');},Diagram.prototype.clear=function(){this.get('eventBus').fire('diagram.clear');};},{'./core':193,didi:345}],185:[function(require,module,exports){'use strict';function CommandInterceptor(eventBus){this._eventBus=eventBus;}function unwrapEvent(fn,that){return function(event){return fn.call(that||null,event.context,event.command,event);};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=CommandInterceptor;var _minDash=require('min-dash');var DEFAULT_PRIORITY=1000;CommandInterceptor.$inject=['eventBus'],CommandInterceptor.prototype.on=function(events,hook,priority,handlerFn,unwrap,that){if(((0,_minDash.isFunction)(hook)||(0,_minDash.isNumber)(hook))&&(that=unwrap,unwrap=handlerFn,handlerFn=priority,priority=hook,hook=null),(0,_minDash.isFunction)(priority)&&(that=unwrap,unwrap=handlerFn,handlerFn=priority,priority=DEFAULT_PRIORITY),(0,_minDash.isObject)(unwrap)&&(that=unwrap,unwrap=!1),!(0,_minDash.isFunction)(handlerFn))throw new Error('handlerFn must be a function');(0,_minDash.isArray)(events)||(events=[events]);var eventBus=this._eventBus;(0,_minDash.forEach)(events,function(event){var fullEvent=['commandStack',event,hook].filter(function(e){return e;}).join('.');eventBus.on(fullEvent,priority,unwrap?unwrapEvent(handlerFn,that):handlerFn,that);});};var hooks=['canExecute','preExecute','preExecuted','execute','executed','postExecute','postExecuted','revert','reverted'];(0,_minDash.forEach)(hooks,function(hook){CommandInterceptor.prototype[hook]=function(events,priority,handlerFn,unwrap,that){((0,_minDash.isFunction)(events)||(0,_minDash.isNumber)(events))&&(that=unwrap,unwrap=handlerFn,handlerFn=priority,priority=events,events=null),this.on(events,hook,priority,handlerFn,unwrap,that);};});},{'min-dash':438}],186:[function(require,module,exports){'use strict';function CommandStack(eventBus,injector){this._handlerMap={},this._stack=[],this._stackIdx=-1,this._currentExecution={actions:[],dirty:[]},this._injector=injector,this._eventBus=eventBus,this._uid=1,eventBus.on(['diagram.destroy','diagram.clear'],function(){this.clear(!1);},this);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=CommandStack;var _minDash=require('min-dash');CommandStack.$inject=['eventBus','injector'],CommandStack.prototype.execute=function(command,context){if(!command)throw new Error('command required');var action={command:command,context:context};this._pushAction(action),this._internalExecute(action),this._popAction(action);},CommandStack.prototype.canExecute=function(command,context){var action={command:command,context:context};var handler=this._getHandler(command);var result=this._fire(command,'canExecute',action);if(result===undefined){if(!handler)return!1;handler.canExecute&&(result=handler.canExecute(context));}return result;},CommandStack.prototype.clear=function(emit){this._stack.length=0,this._stackIdx=-1,emit!==!1&&this._fire('changed');},CommandStack.prototype.undo=function(){var action=this._getUndoAction(),next;if(action){this._pushAction(action);while(action){if(this._internalUndo(action),next=this._getUndoAction(),!next||next.id!==action.id)break;action=next;}this._popAction();}},CommandStack.prototype.redo=function(){var action=this._getRedoAction(),next;if(action){this._pushAction(action);while(action){if(this._internalExecute(action,!0),next=this._getRedoAction(),!next||next.id!==action.id)break;action=next;}this._popAction();}},CommandStack.prototype.register=function(command,handler){this._setHandler(command,handler);},CommandStack.prototype.registerHandler=function(command,handlerCls){if(!(command&&handlerCls))throw new Error('command and handlerCls must be defined');var handler=this._injector.instantiate(handlerCls);this.register(command,handler);},CommandStack.prototype.canUndo=function(){return!!this._getUndoAction();},CommandStack.prototype.canRedo=function(){return!!this._getRedoAction();},CommandStack.prototype._getRedoAction=function(){return this._stack[this._stackIdx+1];},CommandStack.prototype._getUndoAction=function(){return this._stack[this._stackIdx];},CommandStack.prototype._internalUndo=function(action){var self=this;var command=action.command,context=action.context;var handler=this._getHandler(command);this._atomicDo(function(){self._fire(command,'revert',action),handler.revert&&self._markDirty(handler.revert(context)),self._revertedAction(action),self._fire(command,'reverted',action);});},CommandStack.prototype._fire=function(command,qualifier,event){arguments.length<3&&(event=qualifier,qualifier=null);var names=qualifier?[command+'.'+qualifier,qualifier]:[command],i,name,result;for(event=this._eventBus.createEvent(event),i=0;name=names[i];i++)if(result=this._eventBus.fire('commandStack.'+name,event),event.cancelBubble)break;return result;},CommandStack.prototype._createId=function(){return this._uid++;},CommandStack.prototype._atomicDo=function(fn){var execution=this._currentExecution;execution.atomic=!0;try{fn();}finally{execution.atomic=!1;}},CommandStack.prototype._internalExecute=function(action,redo){var self=this;var command=action.command,context=action.context;var handler=this._getHandler(command);if(!handler)throw new Error('no command handler registered for <'+command+'>');this._pushAction(action),redo||(this._fire(command,'preExecute',action),handler.preExecute&&handler.preExecute(context),this._fire(command,'preExecuted',action)),this._atomicDo(function(){self._fire(command,'execute',action),handler.execute&&self._markDirty(handler.execute(context)),self._executedAction(action,redo),self._fire(command,'executed',action);}),redo||(this._fire(command,'postExecute',action),handler.postExecute&&handler.postExecute(context),this._fire(command,'postExecuted',action)),this._popAction(action);},CommandStack.prototype._pushAction=function(action){var execution=this._currentExecution,actions=execution.actions;var baseAction=actions[0];if(execution.atomic)throw new Error('illegal invocation in <execute> or <revert> phase (action: '+action.command+')');action.id||(action.id=baseAction&&baseAction.id||this._createId()),actions.push(action);},CommandStack.prototype._popAction=function(){var execution=this._currentExecution,actions=execution.actions,dirty=execution.dirty;actions.pop(),actions.length||(this._eventBus.fire('elements.changed',{elements:(0,_minDash.uniqueBy)('id',dirty)}),dirty.length=0,this._fire('changed'));},CommandStack.prototype._markDirty=function(elements){var execution=this._currentExecution;if(!elements)return;elements=(0,_minDash.isArray)(elements)?elements:[elements],execution.dirty=execution.dirty.concat(elements);},CommandStack.prototype._executedAction=function(action,redo){var stackIdx=++this._stackIdx;redo||this._stack.splice(stackIdx,this._stack.length,action);},CommandStack.prototype._revertedAction=function(action){this._stackIdx--;},CommandStack.prototype._getHandler=function(command){return this._handlerMap[command];},CommandStack.prototype._setHandler=function(command,handler){if(!(command&&handler))throw new Error('command and handler required');if(this._handlerMap[command])throw new Error('overriding handler for command <'+command+'>');this._handlerMap[command]=handler;};},{'min-dash':438}],187:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _CommandStack=require('./CommandStack');var _CommandStack2=_interopRequireDefault(_CommandStack);exports.default={commandStack:['type',_CommandStack2.default]};},{'./CommandStack':186}],188:[function(require,module,exports){'use strict';function round(number,resolution){return Math.round(number*resolution)/resolution;}function ensurePx(number){return(0,_minDash.isNumber)(number)?number+'px':number;}function createContainer(options){options=(0,_minDash.assign)({},{width:'100%',height:'100%'},options);var container=options.container||document.body;var parent=document.createElement('div');return parent.setAttribute('class','djs-container'),(0,_minDash.assign)(parent.style,{position:'relative',overflow:'hidden',width:ensurePx(options.width),height:ensurePx(options.height)}),container.appendChild(parent),parent;}function createGroup(parent,cls,childIndex){var group=(0,_tinySvg.create)('g');(0,_tinySvg.classes)(group).add(cls);var index=childIndex!==undefined?childIndex:parent.childNodes.length-1;return parent.insertBefore(group,parent.childNodes[index]),group;}function Canvas(config,eventBus,graphicsFactory,elementRegistry){this._eventBus=eventBus,this._elementRegistry=elementRegistry,this._graphicsFactory=graphicsFactory,this._init(config||{});}function setCTM(node,m){var mstr='matrix('+m.a+','+m.b+','+m.c+','+m.d+','+m.e+','+m.f+')';node.setAttribute('transform',mstr);}Object.defineProperty(exports,'__esModule',{value:!0});var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj;};exports.default=Canvas;var _minDash=require('min-dash');var _Collections=require('../util/Collections');var _Elements=require('../util/Elements');var _tinySvg=require('tiny-svg');var BASE_LAYER='base';var REQUIRED_MODEL_ATTRS={shape:['x','y','width','height'],connection:['waypoints']};Canvas.$inject=['config.canvas','eventBus','graphicsFactory','elementRegistry'],Canvas.prototype._init=function(config){var eventBus=this._eventBus;var container=this._container=createContainer(config);var svg=this._svg=(0,_tinySvg.create)('svg');(0,_tinySvg.attr)(svg,{width:'100%',height:'100%'}),(0,_tinySvg.append)(container,svg);var viewport=this._viewport=createGroup(svg,'viewport');this._layers={},config.deferUpdate!==!1&&(this._viewboxChanged=(0,_minDash.debounce)((0,_minDash.bind)(this._viewboxChanged,this),300)),eventBus.on('diagram.init',function(){eventBus.fire('canvas.init',{svg:svg,viewport:viewport});},this),eventBus.on(['shape.added','connection.added','shape.removed','connection.removed','elements.changed'],function(){delete this._cachedViewbox;},this),eventBus.on('diagram.destroy',500,this._destroy,this),eventBus.on('diagram.clear',500,this._clear,this);},Canvas.prototype._destroy=function(emit){this._eventBus.fire('canvas.destroy',{svg:this._svg,viewport:this._viewport});var parent=this._container.parentNode;parent&&parent.removeChild(this._container),delete this._svg,delete this._container,delete this._layers,delete this._rootElement,delete this._viewport;},Canvas.prototype._clear=function(){var self=this;var allElements=this._elementRegistry.getAll();allElements.forEach(function(element){var type=(0,_Elements.getType)(element);type==='root'?self.setRootElement(null,!0):self._removeElement(element,type);}),delete this._cachedViewbox;},Canvas.prototype.getDefaultLayer=function(){return this.getLayer(BASE_LAYER,0);},Canvas.prototype.getLayer=function(name,index){if(!name)throw new Error('must specify a name');var layer=this._layers[name];if(layer||(layer=this._layers[name]=this._createLayer(name,index)),index!==void 0&&layer.index!==index)throw new Error('layer <'+name+'> already created at index <'+index+'>');return layer.group;},Canvas.prototype._createLayer=function(name,index){index||(index=0);var childIndex=(0,_minDash.reduce)(this._layers,function(childIndex,layer){return index>=layer.index&&childIndex++,childIndex;},0);return{group:createGroup(this._viewport,'layer-'+name,childIndex),index:index};},Canvas.prototype.getContainer=function(){return this._container;},Canvas.prototype._updateMarker=function(element,marker,add){var container;if(element.id||(element=this._elementRegistry.get(element)),container=this._elementRegistry._elements[element.id],!container)return;(0,_minDash.forEach)([container.gfx,container.secondaryGfx],function(gfx){gfx&&(add?(0,_tinySvg.classes)(gfx).add(marker):(0,_tinySvg.classes)(gfx).remove(marker));}),this._eventBus.fire('element.marker.update',{element:element,gfx:container.gfx,marker:marker,add:!!add});},Canvas.prototype.addMarker=function(element,marker){this._updateMarker(element,marker,!0);},Canvas.prototype.removeMarker=function(element,marker){this._updateMarker(element,marker,!1);},Canvas.prototype.hasMarker=function(element,marker){element.id||(element=this._elementRegistry.get(element));var gfx=this.getGraphics(element);return(0,_tinySvg.classes)(gfx).has(marker);},Canvas.prototype.toggleMarker=function(element,marker){this.hasMarker(element,marker)?this.removeMarker(element,marker):this.addMarker(element,marker);},Canvas.prototype.getRootElement=function(){return this._rootElement||this.setRootElement({id:'__implicitroot',children:[]}),this._rootElement;},Canvas.prototype.setRootElement=function(element,override){element&&this._ensureValid('root',element);var currentRoot=this._rootElement,elementRegistry=this._elementRegistry,eventBus=this._eventBus;if(currentRoot){if(!override)throw new Error('rootElement already set, need to specify override');eventBus.fire('root.remove',{element:currentRoot}),eventBus.fire('root.removed',{element:currentRoot}),elementRegistry.remove(currentRoot);}if(element){var gfx=this.getDefaultLayer();eventBus.fire('root.add',{element:element}),elementRegistry.add(element,gfx,this._svg),eventBus.fire('root.added',{element:element,gfx:gfx});}return this._rootElement=element,element;},Canvas.prototype._ensureValid=function(type,element){if(!element.id)throw new Error('element must have an id');if(this._elementRegistry.get(element.id))throw new Error('element with id '+element.id+' already exists');var requiredAttrs=REQUIRED_MODEL_ATTRS[type];var valid=(0,_minDash.every)(requiredAttrs,function(attr){return element[attr]!==void 0;});if(!valid)throw new Error('must supply { '+requiredAttrs.join(', ')+' } with '+type);},Canvas.prototype._setParent=function(element,parent,parentIndex){(0,_Collections.add)(parent.children,element,parentIndex),element.parent=parent;},Canvas.prototype._addElement=function(type,element,parent,parentIndex){parent=parent||this.getRootElement();var eventBus=this._eventBus,graphicsFactory=this._graphicsFactory;this._ensureValid(type,element),eventBus.fire(type+'.add',{element:element,parent:parent}),this._setParent(element,parent,parentIndex);var gfx=graphicsFactory.create(type,element,parentIndex);return this._elementRegistry.add(element,gfx),graphicsFactory.update(type,element,gfx),eventBus.fire(type+'.added',{element:element,gfx:gfx}),element;},Canvas.prototype.addShape=function(shape,parent,parentIndex){return this._addElement('shape',shape,parent,parentIndex);},Canvas.prototype.addConnection=function(connection,parent,parentIndex){return this._addElement('connection',connection,parent,parentIndex);},Canvas.prototype._removeElement=function(element,type){var elementRegistry=this._elementRegistry,graphicsFactory=this._graphicsFactory,eventBus=this._eventBus;return element=elementRegistry.get(element.id||element),element?(eventBus.fire(type+'.remove',{element:element}),graphicsFactory.remove(element),(0,_Collections.remove)(element.parent&&element.parent.children,element),element.parent=null,eventBus.fire(type+'.removed',{element:element}),elementRegistry.remove(element),element):void 0;},Canvas.prototype.removeShape=function(shape){return this._removeElement(shape,'shape');},Canvas.prototype.removeConnection=function(connection){return this._removeElement(connection,'connection');},Canvas.prototype.getGraphics=function(element,secondary){return this._elementRegistry.getGraphics(element,secondary);},Canvas.prototype._changeViewbox=function(changeFn){this._eventBus.fire('canvas.viewbox.changing'),changeFn.apply(this),this._cachedViewbox=null,this._viewboxChanged();},Canvas.prototype._viewboxChanged=function(){this._eventBus.fire('canvas.viewbox.changed',{viewbox:this.viewbox()});},Canvas.prototype.viewbox=function(box){if(box===undefined&&this._cachedViewbox)return this._cachedViewbox;var viewport=this._viewport,innerBox,outerBox=this.getSize(),matrix,transform,scale,x,y;if(!box)return innerBox=this.getDefaultLayer().getBBox(),transform=(0,_tinySvg.transform)(viewport),matrix=transform?transform.matrix:(0,_tinySvg.createMatrix)(),scale=round(matrix.a,1000),x=round(-matrix.e||0,1000),y=round(-matrix.f||0,1000),box=this._cachedViewbox={x:x?x/scale:0,y:y?y/scale:0,width:outerBox.width/scale,height:outerBox.height/scale,scale:scale,inner:{width:innerBox.width,height:innerBox.height,x:innerBox.x,y:innerBox.y},outer:outerBox},box;else this._changeViewbox(function(){scale=Math.min(outerBox.width/box.width,outerBox.height/box.height);var matrix=this._svg.createSVGMatrix().scale(scale).translate(-box.x,-box.y);(0,_tinySvg.transform)(viewport,matrix);});return box;},Canvas.prototype.scroll=function(delta){var node=this._viewport;var matrix=node.getCTM();return delta&&this._changeViewbox(function(){delta=(0,_minDash.assign)({dx:0,dy:0},delta||{}),matrix=this._svg.createSVGMatrix().translate(delta.dx,delta.dy).multiply(matrix),setCTM(node,matrix);}),{x:matrix.e,y:matrix.f};},Canvas.prototype.zoom=function(newScale,center){if(!newScale)return this.viewbox(newScale).scale;if(newScale==='fit-viewport')return this._fitViewport(center);var outer,matrix;return this._changeViewbox(function(){(center===void 0?'undefined':_typeof(center))!=='object'&&(outer=this.viewbox().outer,center={x:outer.width/2,y:outer.height/2}),matrix=this._setZoom(newScale,center);}),round(matrix.a,1000);},Canvas.prototype._fitViewport=function(center){var vbox=this.viewbox(),outer=vbox.outer,inner=vbox.inner,newScale,newViewbox;return inner.x>=0&&inner.y>=0&&inner.x+inner.width<=outer.width&&inner.y+inner.height<=outer.height&&!center?newViewbox={x:0,y:0,width:Math.max(inner.width+inner.x,outer.width),height:Math.max(inner.height+inner.y,outer.height)}:(newScale=Math.min(1,outer.width/ inner.width,outer.height/ inner.height),newViewbox={x:inner.x+(center?inner.width/2-outer.width/newScale/2:0),y:inner.y+(center?inner.height/2-outer.height/newScale/2:0),width:outer.width/newScale,height:outer.height/newScale}),this.viewbox(newViewbox),this.viewbox(!1).scale;},Canvas.prototype._setZoom=function(scale,center){var svg=this._svg,viewport=this._viewport;var matrix=svg.createSVGMatrix();var point=svg.createSVGPoint();var centerPoint,originalPoint,currentMatrix,scaleMatrix,newMatrix;currentMatrix=viewport.getCTM();var currentScale=currentMatrix.a;return center?(centerPoint=(0,_minDash.assign)(point,center),originalPoint=centerPoint.matrixTransform(currentMatrix.inverse()),scaleMatrix=matrix.translate(originalPoint.x,originalPoint.y).scale(1/currentScale*scale).translate(-originalPoint.x,-originalPoint.y),newMatrix=currentMatrix.multiply(scaleMatrix)):newMatrix=matrix.scale(scale),setCTM(this._viewport,newMatrix),newMatrix;},Canvas.prototype.getSize=function(){return{width:this._container.clientWidth,height:this._container.clientHeight};},Canvas.prototype.getAbsoluteBBox=function(element){var vbox=this.viewbox();var bbox;if(element.waypoints){var gfx=this.getGraphics(element);bbox=gfx.getBBox();}else bbox=element;var x=bbox.x*vbox.scale-vbox.x*vbox.scale;var y=bbox.y*vbox.scale-vbox.y*vbox.scale;var width=bbox.width*vbox.scale;var height=bbox.height*vbox.scale;return{x:x,y:y,width:width,height:height};},Canvas.prototype.resized=function(){delete this._cachedViewbox,this._eventBus.fire('canvas.resized');};},{'../util/Collections':328,'../util/Elements':331,'min-dash':438,'tiny-svg':468}],189:[function(require,module,exports){'use strict';function ElementFactory(){this._uid=12;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=ElementFactory;var _model=require('../model');var _minDash=require('min-dash');ElementFactory.prototype.createRoot=function(attrs){return this.create('root',attrs);},ElementFactory.prototype.createLabel=function(attrs){return this.create('label',attrs);},ElementFactory.prototype.createShape=function(attrs){return this.create('shape',attrs);},ElementFactory.prototype.createConnection=function(attrs){return this.create('connection',attrs);},ElementFactory.prototype.create=function(type,attrs){return attrs=(0,_minDash.assign)({},attrs||{}),attrs.id||(attrs.id=type+'_'+this._uid++),(0,_model.create)(type,attrs);};},{'../model':319,'min-dash':438}],190:[function(require,module,exports){'use strict';function ElementRegistry(eventBus){this._elements={},this._eventBus=eventBus;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=ElementRegistry;var _tinySvg=require('tiny-svg');var ELEMENT_ID='data-element-id';ElementRegistry.$inject=['eventBus'],ElementRegistry.prototype.add=function(element,gfx,secondaryGfx){var id=element.id;this._validateId(id),(0,_tinySvg.attr)(gfx,ELEMENT_ID,id),secondaryGfx&&(0,_tinySvg.attr)(secondaryGfx,ELEMENT_ID,id),this._elements[id]={element:element,gfx:gfx,secondaryGfx:secondaryGfx};},ElementRegistry.prototype.remove=function(element){var elements=this._elements,id=element.id||element,container=id&&elements[id];container&&((0,_tinySvg.attr)(container.gfx,ELEMENT_ID,''),container.secondaryGfx&&(0,_tinySvg.attr)(container.secondaryGfx,ELEMENT_ID,''),delete elements[id]);},ElementRegistry.prototype.updateId=function(element,newId){this._validateId(newId),typeof element==='string'&&(element=this.get(element)),this._eventBus.fire('element.updateId',{element:element,newId:newId});var gfx=this.getGraphics(element),secondaryGfx=this.getGraphics(element,!0);this.remove(element),element.id=newId,this.add(element,gfx,secondaryGfx);},ElementRegistry.prototype.get=function(filter){var id;typeof filter==='string'?id=filter:id=filter&&(0,_tinySvg.attr)(filter,ELEMENT_ID);var container=this._elements[id];return container&&container.element;},ElementRegistry.prototype.filter=function(fn){var filtered=[];return this.forEach(function(element,gfx){fn(element,gfx)&&filtered.push(element);}),filtered;},ElementRegistry.prototype.getAll=function(){return this.filter(function(e){return e;});},ElementRegistry.prototype.forEach=function(fn){var map=this._elements;Object.keys(map).forEach(function(id){var container=map[id],element=container.element,gfx=container.gfx;return fn(element,gfx);});},ElementRegistry.prototype.getGraphics=function(filter,secondary){var id=filter.id||filter;var container=this._elements[id];return container&&(secondary?container.secondaryGfx:container.gfx);},ElementRegistry.prototype._validateId=function(id){if(!id)throw new Error('element must have an id');if(this._elements[id])throw new Error('element with id '+id+' already added');};},{'tiny-svg':468}],191:[function(require,module,exports){'use strict';function EventBus(){this._listeners={},this.on('diagram.destroy',1,this._destroy,this);}function InternalEvent(){}function invokeFunction(fn,args){return fn.apply(null,args);}Object.defineProperty(exports,'__esModule',{value:!0});var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj;};exports.default=EventBus;var _minDash=require('min-dash');var FN_REF='__fn';var DEFAULT_PRIORITY=1000;var slice=Array.prototype.slice;EventBus.prototype.on=function(events,priority,callback,that){if(events=(0,_minDash.isArray)(events)?events:[events],(0,_minDash.isFunction)(priority)&&(that=callback,callback=priority,priority=DEFAULT_PRIORITY),!(0,_minDash.isNumber)(priority))throw new Error('priority must be a number');var actualCallback=callback;that&&(actualCallback=(0,_minDash.bind)(callback,that),actualCallback[FN_REF]=callback[FN_REF]||callback);var self=this,listener={priority:priority,callback:actualCallback};events.forEach(function(e){self._addListener(e,listener);});},EventBus.prototype.once=function(event,priority,callback,that){function wrappedCallback(){return self.off(event,wrappedCallback),callback.apply(that,arguments);}var self=this;if((0,_minDash.isFunction)(priority)&&(that=callback,callback=priority,priority=DEFAULT_PRIORITY),!(0,_minDash.isNumber)(priority))throw new Error('priority must be a number');wrappedCallback[FN_REF]=callback,this.on(event,priority,wrappedCallback);},EventBus.prototype.off=function(event,callback){var listeners=this._getListeners(event),listener,listenerCallback,idx;if(callback)for(idx=listeners.length-1;listener=listeners[idx];idx--)listenerCallback=listener.callback,(listenerCallback===callback||listenerCallback[FN_REF]===callback)&&listeners.splice(idx,1);else listeners.length=0;},EventBus.prototype.createEvent=function(data){var event=new InternalEvent();return event.init(data),event;},EventBus.prototype.fire=function(type,data){var event,listeners,returnValue,args;if(args=slice.call(arguments),(type===void 0?'undefined':_typeof(type))==='object'&&(event=type,type=event.type),!type)throw new Error('no event type specified');if(listeners=this._listeners[type],!listeners)return;data instanceof InternalEvent?event=data:event=this.createEvent(data),args[0]=event;var originalType=event.type;type!==originalType&&(event.type=type);try{returnValue=this._invokeListeners(event,args,listeners);}finally{type!==originalType&&(event.type=originalType);}return returnValue===undefined&&event.defaultPrevented&&(returnValue=!1),returnValue;},EventBus.prototype.handleError=function(error){return this.fire('error',{error:error})===!1;},EventBus.prototype._destroy=function(){this._listeners={};},EventBus.prototype._invokeListeners=function(event,args,listeners){var idx,listener,returnValue;for(idx=0;listener=listeners[idx];idx++){if(event.cancelBubble)break;returnValue=this._invokeListener(event,args,listener);}return returnValue;},EventBus.prototype._invokeListener=function(event,args,listener){var returnValue;try{returnValue=invokeFunction(listener.callback,args),returnValue!==undefined&&(event.returnValue=returnValue,event.stopPropagation()),returnValue===!1&&event.preventDefault();}catch(e){if(!this.handleError(e)){console.error('unhandled error in event listener');console.error(e.stack);throw e;}}return returnValue;},EventBus.prototype._addListener=function(event,newListener){var listeners=this._getListeners(event),existingListener,idx;for(idx=0;existingListener=listeners[idx];idx++)if(existingListener.priority<newListener.priority){listeners.splice(idx,0,newListener);return;}listeners.push(newListener);},EventBus.prototype._getListeners=function(name){var listeners=this._listeners[name];return listeners||(this._listeners[name]=listeners=[]),listeners;},InternalEvent.prototype.stopPropagation=function(){this.cancelBubble=!0;},InternalEvent.prototype.preventDefault=function(){this.defaultPrevented=!0;},InternalEvent.prototype.init=function(data){(0,_minDash.assign)(this,data||{});};},{'min-dash':438}],192:[function(require,module,exports){'use strict';function GraphicsFactory(eventBus,elementRegistry){this._eventBus=eventBus,this._elementRegistry=elementRegistry;}function prependTo(newNode,parentNode,siblingNode){parentNode.insertBefore(newNode,siblingNode||parentNode.firstChild);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=GraphicsFactory;var _minDash=require('min-dash');var _GraphicsUtil=require('../util/GraphicsUtil');var _SvgTransformUtil=require('../util/SvgTransformUtil');var _minDom=require('min-dom');var _tinySvg=require('tiny-svg');GraphicsFactory.$inject=['eventBus','elementRegistry'],GraphicsFactory.prototype._getChildren=function(element){var gfx=this._elementRegistry.getGraphics(element);var childrenGfx;return element.parent?(childrenGfx=(0,_GraphicsUtil.getChildren)(gfx),childrenGfx||(childrenGfx=(0,_tinySvg.create)('g'),(0,_tinySvg.classes)(childrenGfx).add('djs-children'),(0,_tinySvg.append)(gfx.parentNode,childrenGfx))):childrenGfx=gfx,childrenGfx;},GraphicsFactory.prototype._clear=function(gfx){var visual=(0,_GraphicsUtil.getVisual)(gfx);return(0,_minDom.clear)(visual),visual;},GraphicsFactory.prototype._createContainer=function(type,childrenGfx,parentIndex){var outerGfx=(0,_tinySvg.create)('g');(0,_tinySvg.classes)(outerGfx).add('djs-group'),parentIndex!==void 0?prependTo(outerGfx,childrenGfx,childrenGfx.childNodes[parentIndex]):(0,_tinySvg.append)(childrenGfx,outerGfx);var gfx=(0,_tinySvg.create)('g');(0,_tinySvg.classes)(gfx).add('djs-element'),(0,_tinySvg.classes)(gfx).add('djs-'+type),(0,_tinySvg.append)(outerGfx,gfx);var visual=(0,_tinySvg.create)('g');return(0,_tinySvg.classes)(visual).add('djs-visual'),(0,_tinySvg.append)(gfx,visual),gfx;},GraphicsFactory.prototype.create=function(type,element,parentIndex){var childrenGfx=this._getChildren(element.parent);return this._createContainer(type,childrenGfx,parentIndex);},GraphicsFactory.prototype.updateContainments=function(elements){var self=this,elementRegistry=this._elementRegistry,parents;parents=(0,_minDash.reduce)(elements,function(map,e){return e.parent&&(map[e.parent.id]=e.parent),map;},{}),(0,_minDash.forEach)(parents,function(parent){var children=parent.children;if(!children)return;var childGfx=self._getChildren(parent);(0,_minDash.forEach)(children.slice().reverse(),function(c){var gfx=elementRegistry.getGraphics(c);prependTo(gfx.parentNode,childGfx);});});},GraphicsFactory.prototype.drawShape=function(visual,element){var eventBus=this._eventBus;return eventBus.fire('render.shape',{gfx:visual,element:element});},GraphicsFactory.prototype.getShapePath=function(element){var eventBus=this._eventBus;return eventBus.fire('render.getShapePath',element);},GraphicsFactory.prototype.drawConnection=function(visual,element){var eventBus=this._eventBus;return eventBus.fire('render.connection',{gfx:visual,element:element});},GraphicsFactory.prototype.getConnectionPath=function(waypoints){var eventBus=this._eventBus;return eventBus.fire('render.getConnectionPath',waypoints);},GraphicsFactory.prototype.update=function(type,element,gfx){if(!element.parent)return;var visual=this._clear(gfx);if(type==='shape')this.drawShape(visual,element),(0,_SvgTransformUtil.translate)(gfx,element.x,element.y);else if(type==='connection')this.drawConnection(visual,element);else throw new Error('unknown type: '+type);element.hidden?(0,_tinySvg.attr)(gfx,'display','none'):(0,_tinySvg.attr)(gfx,'display','block');},GraphicsFactory.prototype.remove=function(element){var gfx=this._elementRegistry.getGraphics(element);(0,_tinySvg.remove)(gfx.parentNode);};},{'../util/GraphicsUtil':334,'../util/SvgTransformUtil':343,'min-dash':438,'min-dom':439,'tiny-svg':468}],193:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _draw=require('../draw');var _draw2=_interopRequireDefault(_draw);var _Canvas=require('./Canvas');var _Canvas2=_interopRequireDefault(_Canvas);var _ElementRegistry=require('./ElementRegistry');var _ElementRegistry2=_interopRequireDefault(_ElementRegistry);var _ElementFactory=require('./ElementFactory');var _ElementFactory2=_interopRequireDefault(_ElementFactory);var _EventBus=require('./EventBus');var _EventBus2=_interopRequireDefault(_EventBus);var _GraphicsFactory=require('./GraphicsFactory');var _GraphicsFactory2=_interopRequireDefault(_GraphicsFactory);exports.default={__depends__:[_draw2.default],__init__:['canvas'],canvas:['type',_Canvas2.default],elementRegistry:['type',_ElementRegistry2.default],elementFactory:['type',_ElementFactory2.default],eventBus:['type',_EventBus2.default],graphicsFactory:['type',_GraphicsFactory2.default]};},{'../draw':197,'./Canvas':188,'./ElementFactory':189,'./ElementRegistry':190,'./EventBus':191,'./GraphicsFactory':192}],194:[function(require,module,exports){'use strict';function BaseRenderer(eventBus,renderPriority){var self=this;renderPriority=renderPriority||DEFAULT_RENDER_PRIORITY,eventBus.on(['render.shape','render.connection'],renderPriority,function(evt,context){var type=evt.type,element=context.element,visuals=context.gfx;return self.canRender(element)?type==='render.shape'?self.drawShape(visuals,element):self.drawConnection(visuals,element):void 0;}),eventBus.on(['render.getShapePath','render.getConnectionPath'],renderPriority,function(evt,element){return self.canRender(element)?evt.type==='render.getShapePath'?self.getShapePath(element):self.getConnectionPath(element):void 0;});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=BaseRenderer;var DEFAULT_RENDER_PRIORITY=1000;BaseRenderer.prototype.canRender=function(){},BaseRenderer.prototype.drawShape=function(){},BaseRenderer.prototype.drawConnection=function(){},BaseRenderer.prototype.getShapePath=function(){},BaseRenderer.prototype.getConnectionPath=function(){};},{}],195:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function DefaultRenderer(eventBus,styles){_BaseRenderer2.default.call(this,eventBus,DEFAULT_RENDER_PRIORITY),this.CONNECTION_STYLE=styles.style(['no-fill'],{strokeWidth:5,stroke:'fuchsia'}),this.SHAPE_STYLE=styles.style({fill:'white',stroke:'fuchsia',strokeWidth:2});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=DefaultRenderer;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _BaseRenderer=require('./BaseRenderer');var _BaseRenderer2=_interopRequireDefault(_BaseRenderer);var _RenderUtil=require('../util/RenderUtil');var _tinySvg=require('tiny-svg');var DEFAULT_RENDER_PRIORITY=1;(0,_inherits2.default)(DefaultRenderer,_BaseRenderer2.default),DefaultRenderer.prototype.canRender=function(){return!0;},DefaultRenderer.prototype.drawShape=function drawShape(visuals,element){var rect=(0,_tinySvg.create)('rect');return(0,_tinySvg.attr)(rect,{x:0,y:0,width:element.width||0,height:element.height||0}),(0,_tinySvg.attr)(rect,this.SHAPE_STYLE),(0,_tinySvg.append)(visuals,rect),rect;},DefaultRenderer.prototype.drawConnection=function drawConnection(visuals,connection){var line=(0,_RenderUtil.createLine)(connection.waypoints,this.CONNECTION_STYLE);return(0,_tinySvg.append)(visuals,line),line;},DefaultRenderer.prototype.getShapePath=function getShapePath(shape){var x=shape.x,y=shape.y,width=shape.width,height=shape.height;var shapePath=[['M',x,y],['l',width,0],['l',0,height],['l',-width,0],['z']];return(0,_RenderUtil.componentsToPath)(shapePath);},DefaultRenderer.prototype.getConnectionPath=function getConnectionPath(connection){var waypoints=connection.waypoints;var idx,point,connectionPath=[];for(idx=0;point=waypoints[idx];idx++)point=point.original||point,connectionPath.push([idx===0?'M':'L',point.x,point.y]);return(0,_RenderUtil.componentsToPath)(connectionPath);},DefaultRenderer.$inject=['eventBus','styles'];},{'../util/RenderUtil':342,'./BaseRenderer':194,inherits:350,'tiny-svg':468}],196:[function(require,module,exports){'use strict';function Styles(){var defaultTraits={'no-fill':{fill:'none'},'no-border':{strokeOpacity:0},'no-events':{pointerEvents:'none'}};var self=this;this.cls=function(className,traits,additionalAttrs){var attrs=this.style(traits,additionalAttrs);return(0,_minDash.assign)(attrs,{'class':className});},this.style=function(traits,additionalAttrs){(0,_minDash.isArray)(traits)||additionalAttrs||(additionalAttrs=traits,traits=[]);var attrs=(0,_minDash.reduce)(traits,function(attrs,t){return(0,_minDash.assign)(attrs,defaultTraits[t]||{});},{});return additionalAttrs?(0,_minDash.assign)(attrs,additionalAttrs):attrs;},this.computeStyle=function(custom,traits,defaultStyles){return(0,_minDash.isArray)(traits)||(defaultStyles=traits,traits=[]),self.style(traits||[],(0,_minDash.assign)({},defaultStyles,custom||{}));};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=Styles;var _minDash=require('min-dash');},{'min-dash':438}],197:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _DefaultRenderer=require('./DefaultRenderer');var _DefaultRenderer2=_interopRequireDefault(_DefaultRenderer);var _Styles=require('./Styles');var _Styles2=_interopRequireDefault(_Styles);exports.default={__init__:['defaultRenderer'],defaultRenderer:['type',_DefaultRenderer2.default],styles:['type',_Styles2.default]};},{'./DefaultRenderer':195,'./Styles':196}],198:[function(require,module,exports){'use strict';function last(arr){return arr&&arr[arr.length-1];}function sortTopOrMiddle(element){return element.y;}function sortLeftOrCenter(element){return element.x;}function AlignElements(modeling){this._modeling=modeling;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=AlignElements;var _minDash=require('min-dash');var ALIGNMENT_SORTING={left:sortLeftOrCenter,center:sortLeftOrCenter,right:function right(element){return element.x+element.width;},top:sortTopOrMiddle,middle:sortTopOrMiddle,bottom:function bottom(element){return element.y+element.height;}};AlignElements.$inject=['modeling'],AlignElements.prototype._getOrientationDetails=function(type){var vertical=['top','bottom','middle'],axis='x',dimension='width';return vertical.indexOf(type)!==-1&&(axis='y',dimension='height'),{axis:axis,dimension:dimension};},AlignElements.prototype._isType=function(type,types){return types.indexOf(type)!==-1;},AlignElements.prototype._alignmentPosition=function(type,sortedElements){function getMiddleOrTop(first,last){return Math.round((first[axis]+last[axis]+last[dimension])/2);}var orientation=this._getOrientationDetails(type),axis=orientation.axis,dimension=orientation.dimension,alignment={},centers={},hasSharedCenters=!1,centeredElements,firstElement,lastElement;if(this._isType(type,['left','top']))alignment[type]=sortedElements[0][axis];else if(this._isType(type,['right','bottom']))lastElement=last(sortedElements),alignment[type]=lastElement[axis]+lastElement[dimension];else if(this._isType(type,['center','middle'])){if((0,_minDash.forEach)(sortedElements,function(element){var center=element[axis]+Math.round(element[dimension]/2);centers[center]?centers[center].elements.push(element):centers[center]={elements:[element],center:center};}),centeredElements=(0,_minDash.sortBy)(centers,function(center){return center.elements.length>1&&(hasSharedCenters=!0),center.elements.length;}),hasSharedCenters)return alignment[type]=last(centeredElements).center,alignment;firstElement=sortedElements[0],sortedElements=(0,_minDash.sortBy)(sortedElements,function(element){return element[axis]+element[dimension];}),lastElement=last(sortedElements),alignment[type]=getMiddleOrTop(firstElement,lastElement);}return alignment;},AlignElements.prototype.trigger=function(elements,type){var modeling=this._modeling;var filteredElements=(0,_minDash.filter)(elements,function(element){return!(element.waypoints||element.host||element.labelTarget);});var sortFn=ALIGNMENT_SORTING[type];var sortedElements=(0,_minDash.sortBy)(filteredElements,sortFn);var alignment=this._alignmentPosition(type,sortedElements);modeling.alignElements(sortedElements,alignment);};},{'min-dash':438}],199:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _AlignElements=require('./AlignElements');var _AlignElements2=_interopRequireDefault(_AlignElements);exports.default={__init__:['alignElements'],alignElements:['type',_AlignElements2.default]};},{'./AlignElements':198}],200:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function AttachSupport(injector,eventBus,rules,modeling){_CommandInterceptor2.default.call(this,eventBus);var movePreview=injector.get('movePreview',!1);eventBus.on('shape.move.start',HIGH_PRIORITY,function(e){var context=e.context,shapes=context.shapes,validatedShapes=context.validatedShapes;context.shapes=addAttached(shapes),context.validatedShapes=removeAttached(validatedShapes);}),movePreview&&eventBus.on('shape.move.start',LOW_PRIORITY,function(e){var context=e.context,shapes=context.shapes,attachers=getAttachers(shapes);(0,_minDash.forEach)(attachers,function(attacher){movePreview.makeDraggable(context,attacher,!0),attacher.label&&movePreview.makeDraggable(context,attacher.label,!0);});}),this.postExecuted('elements.move',function(event){var context=event.context,delta=context.delta,newParent=context.newParent,closure=context.closure,enclosedElements=closure.enclosedElements,attachers=getAttachers(enclosedElements);(0,_minDash.forEach)(attachers,function(attacher){enclosedElements[attacher.id]||(modeling.moveShape(attacher,delta,newParent),attacher.label&&modeling.moveShape(attacher.label,delta,newParent));});}),this.postExecuted('elements.move',function(e){var context=e.context,shapes=context.shapes,newHost=context.newHost,attachers;if(shapes.length>1)return;newHost?attachers=shapes:attachers=(0,_minDash.filter)(shapes,function(s){return!!s.host;}),(0,_minDash.forEach)(attachers,function(attacher){modeling.updateAttachment(attacher,newHost);});}),this.postExecuted('elements.move',function(e){var shapes=e.context.shapes;(0,_minDash.forEach)(shapes,function(shape){(0,_minDash.forEach)(shape.attachers,function(attacher){(0,_minDash.forEach)(attacher.outgoing.slice(),function(connection){var allowed=rules.allowed('connection.reconnectStart',{connection:connection,source:connection.source,target:connection.target});allowed||modeling.removeConnection(connection);}),(0,_minDash.forEach)(attacher.incoming.slice(),function(connection){var allowed=rules.allowed('connection.reconnectEnd',{connection:connection,source:connection.source,target:connection.target});allowed||modeling.removeConnection(connection);});});});}),this.postExecute('shape.create',function(e){var context=e.context,shape=context.shape,host=context.host;host&&modeling.updateAttachment(shape,host);}),this.postExecute('shape.replace',function(e){var context=e.context,oldShape=context.oldShape,newShape=context.newShape;(0,_Removal.saveClear)(oldShape.attachers,function(attacher){var allowed=rules.allowed('elements.move',{target:newShape,shapes:[attacher]});allowed==='attach'?modeling.updateAttachment(attacher,newShape):modeling.removeShape(attacher);}),newShape.attachers.length&&(0,_minDash.forEach)(newShape.attachers,function(attacher){var delta=(0,_AttachUtil.getNewAttachShapeDelta)(attacher,oldShape,newShape);modeling.moveShape(attacher,delta,attacher.parent);});}),this.postExecute('shape.resize',function(event){var context=event.context,shape=context.shape,oldBounds=context.oldBounds,newBounds=context.newBounds,attachers=shape.attachers;if(!attachers.length)return;(0,_minDash.forEach)(attachers,function(attacher){var delta=(0,_AttachUtil.getNewAttachShapeDelta)(attacher,oldBounds,newBounds);modeling.moveShape(attacher,delta,attacher.parent),attacher.label&&modeling.moveShape(attacher.label,delta,attacher.label.parent);});}),this.preExecute('shape.delete',function(event){var shape=event.context.shape;(0,_Removal.saveClear)(shape.attachers,function(attacher){modeling.removeShape(attacher);}),shape.host&&modeling.updateAttachment(shape,null);}),eventBus.on('spaceTool.move',function(event){var context=event.context,initialized=context.initialized,attachSupportInitialized=context.attachSupportInitialized;if(!initialized||attachSupportInitialized)return;var movingShapes=context.movingShapes;var staticAttachers=(0,_minDash.filter)(movingShapes,function(shape){var host=shape.host;return host&&movingShapes.indexOf(host)===-1;});(0,_minDash.forEach)(staticAttachers,function(shape){(0,_Collections.remove)(movingShapes,shape),shape.label&&(0,_Collections.remove)(movingShapes,shape.label);}),context.attachSupportInitialized=!0;});}function getAttachers(shapes){return(0,_minDash.flatten)((0,_minDash.map)(shapes,function(s){return s.attachers||[];}));}function addAttached(elements){var attachers=getAttachers(elements);return(0,_minDash.unionBy)('id',elements,attachers);}function removeAttached(elements){var ids=(0,_minDash.groupBy)(elements,'id');return(0,_minDash.filter)(elements,function(element){while(element){if(element.host&&ids[element.host.id])return!1;element=element.parent;}return!0;});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=AttachSupport;var _minDash=require('min-dash');var _Removal=require('../../util/Removal');var _Collections=require('../../util/Collections');var _AttachUtil=require('../../util/AttachUtil');var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _CommandInterceptor=require('../../command/CommandInterceptor');var _CommandInterceptor2=_interopRequireDefault(_CommandInterceptor);var LOW_PRIORITY=251,HIGH_PRIORITY=1401;(0,_inherits2.default)(AttachSupport,_CommandInterceptor2.default),AttachSupport.$inject=['injector','eventBus','rules','modeling'];},{'../../command/CommandInterceptor':185,'../../util/AttachUtil':326,'../../util/Collections':328,'../../util/Removal':341,inherits:350,'min-dash':438}],201:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _rules=require('../rules');var _rules2=_interopRequireDefault(_rules);var _AttachSupport=require('./AttachSupport');var _AttachSupport2=_interopRequireDefault(_AttachSupport);exports.default={__depends__:[_rules2.default],__init__:['attachSupport'],attachSupport:['type',_AttachSupport2.default]};},{'../rules':292,'./AttachSupport':200}],202:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function AutoResize(eventBus,elementRegistry,modeling,rules){_CommandInterceptor2.default.call(this,eventBus),this._elementRegistry=elementRegistry,this._modeling=modeling,this._rules=rules;var self=this;this.postExecuted(['shape.create'],function(event){var context=event.context,hints=context.hints,shape=context.shape,parent=context.parent||context.newParent;if(hints&&hints.root===!1)return;self._expand([shape],parent);}),this.postExecuted(['elements.move'],function(event){var context=event.context,elements=(0,_minDash.flatten)((0,_minDash.values)(context.closure.topLevel)),hints=context.hints;if(hints&&hints.autoResize===!1)return;var expandings=(0,_minDash.groupBy)(elements,function(element){return element.parent.id;});(0,_minDash.forEach)(expandings,function(elements,parentId){self._expand(elements,parentId);});});}function boundsChanged(newBounds,oldBounds){return newBounds.x!==oldBounds.x||newBounds.y!==oldBounds.y||newBounds.width!==oldBounds.width||newBounds.height!==oldBounds.height;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=AutoResize;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _Elements=require('../../util/Elements');var _LayoutUtil=require('../../layout/LayoutUtil');var _minDash=require('min-dash');var _CommandInterceptor=require('../../command/CommandInterceptor');var _CommandInterceptor2=_interopRequireDefault(_CommandInterceptor);AutoResize.$inject=['eventBus','elementRegistry','modeling','rules'],(0,_inherits2.default)(AutoResize,_CommandInterceptor2.default),AutoResize.prototype._getOptimalBounds=function(elements,target){var offset=this.getOffset(target),padding=this.getPadding(target);var elementsTrbl=(0,_LayoutUtil.asTRBL)((0,_Elements.getBBox)(elements)),targetTrbl=(0,_LayoutUtil.asTRBL)(target);var newTrbl={};return elementsTrbl.top-targetTrbl.top<padding.top&&(newTrbl.top=elementsTrbl.top-offset.top),elementsTrbl.left-targetTrbl.left<padding.left&&(newTrbl.left=elementsTrbl.left-offset.left),targetTrbl.right-elementsTrbl.right<padding.right&&(newTrbl.right=elementsTrbl.right+offset.right),targetTrbl.bottom-elementsTrbl.bottom<padding.bottom&&(newTrbl.bottom=elementsTrbl.bottom+offset.bottom),(0,_LayoutUtil.asBounds)((0,_minDash.assign)({},targetTrbl,newTrbl));},AutoResize.prototype._expand=function(elements,target){typeof target==='string'&&(target=this._elementRegistry.get(target));var allowed=this._rules.allowed('element.autoResize',{elements:elements,target:target});if(!allowed)return;var newBounds=this._getOptimalBounds(elements,target);if(!boundsChanged(newBounds,target))return;this.resize(target,newBounds);var parent=target.parent;parent&&this._expand([target],parent);},AutoResize.prototype.getOffset=function(shape){return{top:60,bottom:60,left:100,right:100};},AutoResize.prototype.getPadding=function(shape){return{top:2,bottom:2,left:15,right:15};},AutoResize.prototype.resize=function(target,newBounds){this._modeling.resizeShape(target,newBounds);};},{'../../command/CommandInterceptor':185,'../../layout/LayoutUtil':317,'../../util/Elements':331,inherits:350,'min-dash':438}],203:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function AutoResizeProvider(eventBus){_RuleProvider2.default.call(this,eventBus);var self=this;this.addRule('element.autoResize',function(context){return self.canResize(context.elements,context.target);});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=AutoResizeProvider;var _RuleProvider=require('../rules/RuleProvider');var _RuleProvider2=_interopRequireDefault(_RuleProvider);var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);AutoResizeProvider.$inject=['eventBus'],(0,_inherits2.default)(AutoResizeProvider,_RuleProvider2.default),AutoResizeProvider.prototype.canResize=function(elements,target){return!1;};},{'../rules/RuleProvider':290,inherits:350}],204:[function(require,module,exports){'use strict';function AutoScroll(config,eventBus,canvas,mouseTracking){this._canvas=canvas,this._mouseTracking=mouseTracking,this._opts=(0,_minDash.assign)({scrollThresholdIn:[20,20,20,20],scrollThresholdOut:[0,0,0,0],scrollRepeatTimeout:15,scrollStep:10},config);var self=this;eventBus.on('drag.move',function(e){var point=self._toBorderPoint(e);self.startScroll(point);}),eventBus.on(['drag.cleanup'],function(){self.stopScroll();});}function between(val,start,end){return start<val&&val<end?!0:!1;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=AutoScroll;var _minDash=require('min-dash');var _Event=require('../../util/Event');AutoScroll.$inject=['config.autoScroll','eventBus','canvas','mouseTracking'],AutoScroll.prototype.startScroll=function(point){var canvas=this._canvas;var opts=this._opts;var self=this;var clientRect=canvas.getContainer().getBoundingClientRect();var diff=[point.x,point.y,clientRect.width-point.x,clientRect.height-point.y];this.stopScroll();var dx=0,dy=0;for(var i=0;i<4;i++)between(diff[i],opts.scrollThresholdOut[i],opts.scrollThresholdIn[i])&&(i===0?dx=opts.scrollStep:i==1?dy=opts.scrollStep:i==2?dx=-opts.scrollStep:i==3&&(dy=-opts.scrollStep));(dx!==0||dy!==0)&&(canvas.scroll({dx:dx,dy:dy}),this._scrolling=setTimeout(function(){self.startScroll(point);},opts.scrollRepeatTimeout));},AutoScroll.prototype.stopScroll=function(){clearTimeout(this._scrolling);},AutoScroll.prototype.setOptions=function(options){this._opts=(0,_minDash.assign)({},this._opts,options);},AutoScroll.prototype._toBorderPoint=function(event){var clientRect=this._canvas._container.getBoundingClientRect();var globalPosition=(0,_Event.toPoint)(event.originalEvent);return{x:globalPosition.x-clientRect.left,y:globalPosition.y-clientRect.top};};},{'../../util/Event':332,'min-dash':438}],205:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _dragging=require('../dragging');var _dragging2=_interopRequireDefault(_dragging);var _mouseTracking=require('../mouse-tracking');var _mouseTracking2=_interopRequireDefault(_mouseTracking);var _AutoScroll=require('./AutoScroll');var _AutoScroll2=_interopRequireDefault(_AutoScroll);exports.default={__depends__:[_dragging2.default,_mouseTracking2.default],__init__:['autoScroll'],autoScroll:['type',_AutoScroll2.default]};},{'../dragging':228,'../mouse-tracking':268,'./AutoScroll':204}],206:[function(require,module,exports){'use strict';function BendpointMove(injector,eventBus,canvas,dragging,graphicsFactory,rules,modeling){function redrawConnection(data){graphicsFactory.update('connection',data.connection,data.connectionGfx);}function filterRedundantWaypoints(waypoints){waypoints=waypoints.slice();var idx=0,point,previousPoint,nextPoint;while(waypoints[idx])point=waypoints[idx],previousPoint=waypoints[idx-1],nextPoint=waypoints[idx+1],(0,_Geometry.pointDistance)(point,nextPoint)===0||(0,_Geometry.pointsOnLine)(previousPoint,nextPoint,point)?waypoints.splice(idx,1):idx++;return waypoints;}var connectionDocking=injector.get('connectionDocking',!1);this.start=function(event,connection,bendpointIndex,insert){var type,context,waypoints=connection.waypoints,gfx=canvas.getGraphics(connection);!insert&&bendpointIndex===0?type=COMMAND_RECONNECT_START:!insert&&bendpointIndex===waypoints.length-1?type=COMMAND_RECONNECT_END:type=COMMAND_BENDPOINT_UPDATE,context={connection:connection,bendpointIndex:bendpointIndex,insert:insert,type:type},dragging.init(event,'bendpoint.move',{data:{connection:connection,connectionGfx:gfx,context:context}});},eventBus.on('bendpoint.move.start',function(e){var context=e.context,connection=context.connection,originalWaypoints=connection.waypoints,waypoints=originalWaypoints.slice(),insert=context.insert,idx=context.bendpointIndex;context.originalWaypoints=originalWaypoints,insert&&waypoints.splice(idx,0,null),connection.waypoints=waypoints,context.draggerGfx=(0,_BendpointUtil.addBendpoint)(canvas.getLayer('overlays')),(0,_tinySvg.classes)(context.draggerGfx).add('djs-dragging'),canvas.addMarker(connection,MARKER_CONNECT_UPDATING);}),eventBus.on('bendpoint.move.hover',function(e){var context=e.context;if(context.hover=e.hover,e.hover){canvas.addMarker(e.hover,MARKER_CONNECT_HOVER);var allowed=context.allowed=rules.allowed(context.type,context);allowed?(canvas.removeMarker(context.hover,MARKER_NOT_OK),canvas.addMarker(context.hover,MARKER_OK),context.target=context.hover):allowed===!1&&(canvas.removeMarker(context.hover,MARKER_OK),canvas.addMarker(context.hover,MARKER_NOT_OK),context.target=null);}}),eventBus.on(['bendpoint.move.out','bendpoint.move.cleanup'],function(e){var hover=e.context.hover;hover&&(canvas.removeMarker(hover,MARKER_CONNECT_HOVER),canvas.removeMarker(hover,e.context.target?MARKER_OK:MARKER_NOT_OK));}),eventBus.on('bendpoint.move.move',function(e){var context=e.context,moveType=context.type,connection=e.connection,source,target;connection.waypoints[context.bendpointIndex]={x:e.x,y:e.y},connectionDocking&&(context.hover&&(moveType===COMMAND_RECONNECT_START&&(source=context.hover),moveType===COMMAND_RECONNECT_END&&(target=context.hover)),connection.waypoints=connectionDocking.getCroppedWaypoints(connection,source,target)),(0,_SvgTransformUtil.translate)(context.draggerGfx,e.x,e.y),redrawConnection(e);}),eventBus.on(['bendpoint.move.end','bendpoint.move.cancel'],function(e){var context=e.context,hover=context.hover,connection=context.connection;(0,_tinySvg.remove)(context.draggerGfx),context.newWaypoints=connection.waypoints.slice(),connection.waypoints=context.originalWaypoints,canvas.removeMarker(connection,MARKER_CONNECT_UPDATING),hover&&(canvas.removeMarker(hover,MARKER_OK),canvas.removeMarker(hover,MARKER_NOT_OK));}),eventBus.on('bendpoint.move.end',function(e){var context=e.context,waypoints=context.newWaypoints,bendpointIndex=context.bendpointIndex,bendpoint=waypoints[bendpointIndex],allowed=context.allowed,hints;if(bendpoint.x=round(bendpoint.x),bendpoint.y=round(bendpoint.y),allowed&&context.type===COMMAND_RECONNECT_START)modeling.reconnectStart(context.connection,context.target,bendpoint);else if(allowed&&context.type===COMMAND_RECONNECT_END)modeling.reconnectEnd(context.connection,context.target,bendpoint);else if(allowed!==!1&&context.type===COMMAND_BENDPOINT_UPDATE)hints={bendpointMove:{insert:e.context.insert,bendpointIndex:bendpointIndex}},modeling.updateWaypoints(context.connection,filterRedundantWaypoints(waypoints),hints);else return redrawConnection(e),!1;}),eventBus.on('bendpoint.move.cancel',function(e){redrawConnection(e);});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=BendpointMove;var _Geometry=require('../../util/Geometry');var _BendpointUtil=require('./BendpointUtil');var _tinySvg=require('tiny-svg');var _SvgTransformUtil=require('../../util/SvgTransformUtil');var MARKER_OK='connect-ok',MARKER_NOT_OK='connect-not-ok',MARKER_CONNECT_HOVER='connect-hover',MARKER_CONNECT_UPDATING='djs-updating';var COMMAND_BENDPOINT_UPDATE='connection.updateWaypoints',COMMAND_RECONNECT_START='connection.reconnectStart',COMMAND_RECONNECT_END='connection.reconnectEnd';var round=Math.round;BendpointMove.$inject=['injector','eventBus','canvas','dragging','graphicsFactory','rules','modeling'];},{'../../util/Geometry':333,'../../util/SvgTransformUtil':343,'./BendpointUtil':208,'tiny-svg':468}],207:[function(require,module,exports){'use strict';function BendpointSnapping(eventBus){function snapTo(values,value){if((0,_minDash.isArray)(values)){var i=values.length;while(i--)if(abs(values[i]-value)<=TOLERANCE)return values[i];}else{values=+values;var rem=value%values;if(rem<TOLERANCE)return value-rem;if(rem>values-TOLERANCE)return value-rem+values;}return value;}function mid(element){return element.width?{x:round(element.width/2+element.x),y:round(element.height/2+element.y)}:void 0;}function getConnectionSegmentSnaps(context){var snapPoints=context.snapPoints,connection=context.connection,waypoints=connection.waypoints,segmentStart=context.segmentStart,segmentStartIndex=context.segmentStartIndex,segmentEnd=context.segmentEnd,segmentEndIndex=context.segmentEndIndex,axis=context.axis;if(snapPoints)return snapPoints;var referenceWaypoints=[waypoints[segmentStartIndex-1],segmentStart,segmentEnd,waypoints[segmentEndIndex+1]];return segmentStartIndex<2&&referenceWaypoints.unshift(mid(connection.source)),segmentEndIndex>waypoints.length-3&&referenceWaypoints.unshift(mid(connection.target)),context.snapPoints=snapPoints={horizontal:[],vertical:[]},(0,_minDash.forEach)(referenceWaypoints,function(p){p&&(p=p.original||p,axis==='y'&&snapPoints.horizontal.push(p.y),axis==='x'&&snapPoints.vertical.push(p.x));}),snapPoints;}function getBendpointSnaps(context){var snapPoints=context.snapPoints,waypoints=context.connection.waypoints,bendpointIndex=context.bendpointIndex;if(snapPoints)return snapPoints;var referenceWaypoints=[waypoints[bendpointIndex-1],waypoints[bendpointIndex+1]];return context.snapPoints=snapPoints={horizontal:[],vertical:[]},(0,_minDash.forEach)(referenceWaypoints,function(p){p&&(p=p.original||p,snapPoints.horizontal.push(p.y),snapPoints.vertical.push(p.x));}),snapPoints;}eventBus.on('connectionSegment.move.move',1500,function(event){var context=event.context,snapPoints=getConnectionSegmentSnaps(context),x=event.x,y=event.y,sx,sy;if(!snapPoints)return;sx=snapTo(snapPoints.vertical,x),sy=snapTo(snapPoints.horizontal,y);var cx=x-sx,cy=y-sy;(0,_minDash.assign)(event,{dx:event.dx-cx,dy:event.dy-cy,x:sx,y:sy});}),eventBus.on('bendpoint.move.move',1500,function(event){var context=event.context,snapPoints=getBendpointSnaps(context),target=context.target,targetMid=target&&mid(target),x=event.x,y=event.y,sx,sy;if(!snapPoints)return;sx=snapTo(targetMid?snapPoints.vertical.concat([targetMid.x]):snapPoints.vertical,x),sy=snapTo(targetMid?snapPoints.horizontal.concat([targetMid.y]):snapPoints.horizontal,y);var cx=x-sx,cy=y-sy;(0,_minDash.assign)(event,{dx:event.dx-cx,dy:event.dy-cy,x:event.x-cx,y:event.y-cy});});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=BendpointSnapping;var _minDash=require('min-dash');var abs=Math.abs,round=Math.round;var TOLERANCE=10;BendpointSnapping.$inject=['eventBus'];},{'min-dash':438}],208:[function(require,module,exports){'use strict';function toCanvasCoordinates(canvas,event){var position=(0,_Event.toPoint)(event),clientRect=canvas._container.getBoundingClientRect(),offset;offset={x:clientRect.left,y:clientRect.top};var viewbox=canvas.viewbox();return{x:viewbox.x+(position.x-offset.x)/viewbox.scale,y:viewbox.y+(position.y-offset.y)/viewbox.scale};}function addBendpoint(parentGfx,cls){var groupGfx=(0,_tinySvg.create)('g');(0,_tinySvg.classes)(groupGfx).add(BENDPOINT_CLS),(0,_tinySvg.append)(parentGfx,groupGfx);var visual=(0,_tinySvg.create)('circle');(0,_tinySvg.attr)(visual,{cx:0,cy:0,r:4}),(0,_tinySvg.classes)(visual).add('djs-visual'),(0,_tinySvg.append)(groupGfx,visual);var hit=(0,_tinySvg.create)('circle');return(0,_tinySvg.attr)(hit,{cx:0,cy:0,r:10}),(0,_tinySvg.classes)(hit).add('djs-hit'),(0,_tinySvg.append)(groupGfx,hit),cls&&(0,_tinySvg.classes)(groupGfx).add(cls),groupGfx;}function createParallelDragger(parentGfx,position,alignment){var draggerGfx=(0,_tinySvg.create)('g');(0,_tinySvg.append)(parentGfx,draggerGfx);var width=14,height=3,padding=6,hitWidth=width+padding,hitHeight=height+padding;var visual=(0,_tinySvg.create)('rect');(0,_tinySvg.attr)(visual,{x:-width/2,y:-height/2,width:width,height:height}),(0,_tinySvg.classes)(visual).add('djs-visual'),(0,_tinySvg.append)(draggerGfx,visual);var hit=(0,_tinySvg.create)('rect');return(0,_tinySvg.attr)(hit,{x:-hitWidth/2,y:-hitHeight/2,width:hitWidth,height:hitHeight}),(0,_tinySvg.classes)(hit).add('djs-hit'),(0,_tinySvg.append)(draggerGfx,hit),(0,_SvgTransformUtil.rotate)(draggerGfx,alignment==='h'?90:0,0,0),draggerGfx;}function addSegmentDragger(parentGfx,segmentStart,segmentEnd){var groupGfx=(0,_tinySvg.create)('g'),mid=(0,_Geometry.getMidPoint)(segmentStart,segmentEnd),alignment=(0,_Geometry.pointsAligned)(segmentStart,segmentEnd);return(0,_tinySvg.append)(parentGfx,groupGfx),createParallelDragger(groupGfx,mid,alignment),(0,_tinySvg.classes)(groupGfx).add(SEGMENT_DRAGGER_CLS),(0,_tinySvg.classes)(groupGfx).add(alignment==='h'?'vertical':'horizontal'),(0,_SvgTransformUtil.translate)(groupGfx,mid.x,mid.y),groupGfx;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.SEGMENT_DRAGGER_CLS=exports.BENDPOINT_CLS=undefined,exports.toCanvasCoordinates=toCanvasCoordinates,exports.addBendpoint=addBendpoint,exports.addSegmentDragger=addSegmentDragger;var _Event=require('../../util/Event');var _Geometry=require('../../util/Geometry');var _tinySvg=require('tiny-svg');var _SvgTransformUtil=require('../../util/SvgTransformUtil');var BENDPOINT_CLS=exports.BENDPOINT_CLS='djs-bendpoint';var SEGMENT_DRAGGER_CLS=exports.SEGMENT_DRAGGER_CLS='djs-segment-dragger';},{'../../util/Event':332,'../../util/Geometry':333,'../../util/SvgTransformUtil':343,'tiny-svg':468}],209:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function Bendpoints(eventBus,canvas,interactionEvents,bendpointMove,connectionSegmentMove){function getConnectionIntersection(waypoints,event){var localPosition=(0,_BendpointUtil.toCanvasCoordinates)(canvas,event),intersection=(0,_LineIntersection.getApproxIntersection)(waypoints,localPosition);return intersection;}function isIntersectionMiddle(intersection,waypoints,treshold){var idx=intersection.index,p=intersection.point,p0,p1,mid,aligned,xDelta,yDelta;return idx<=0||intersection.bendpoint?!1:(p0=waypoints[idx-1],p1=waypoints[idx],mid=(0,_Geometry.getMidPoint)(p0,p1),aligned=(0,_Geometry.pointsAligned)(p0,p1),xDelta=Math.abs(p.x-mid.x),yDelta=Math.abs(p.y-mid.y),aligned&&xDelta<=treshold&&yDelta<=treshold);}function activateBendpointMove(event,connection){var waypoints=connection.waypoints,intersection=getConnectionIntersection(waypoints,event);return intersection?(isIntersectionMiddle(intersection,waypoints,10)?connectionSegmentMove.start(event,connection,intersection.index):bendpointMove.start(event,connection,intersection.index,!intersection.bendpoint),!0):void 0;}function bindInteractionEvents(node,eventName,element){_minDom.event.bind(node,eventName,function(event){interactionEvents.triggerMouseEvent(eventName,event,element),event.stopPropagation();});}function getBendpointsContainer(element,create){var layer=canvas.getLayer('overlays'),gfx=(0,_minDom.query)('.djs-bendpoints[data-element-id="'+(0,_css2.default)(element.id)+'"]',layer);return!gfx&&create&&(gfx=(0,_tinySvg.create)('g'),(0,_tinySvg.attr)(gfx,{'data-element-id':element.id}),(0,_tinySvg.classes)(gfx).add('djs-bendpoints'),(0,_tinySvg.append)(layer,gfx),bindInteractionEvents(gfx,'mousedown',element),bindInteractionEvents(gfx,'click',element),bindInteractionEvents(gfx,'dblclick',element)),gfx;}function createBendpoints(gfx,connection){connection.waypoints.forEach(function(p,idx){var bendpoint=(0,_BendpointUtil.addBendpoint)(gfx);(0,_tinySvg.append)(gfx,bendpoint),(0,_SvgTransformUtil.translate)(bendpoint,p.x,p.y);}),(0,_BendpointUtil.addBendpoint)(gfx,'floating');}function createSegmentDraggers(gfx,connection){var waypoints=connection.waypoints;var segmentStart,segmentEnd;for(var i=1;i<waypoints.length;i++)segmentStart=waypoints[i-1],segmentEnd=waypoints[i],(0,_Geometry.pointsAligned)(segmentStart,segmentEnd)&&(0,_BendpointUtil.addSegmentDragger)(gfx,segmentStart,segmentEnd);}function clearBendpoints(gfx){(0,_minDash.forEach)((0,_minDom.queryAll)('.'+_BendpointUtil.BENDPOINT_CLS,gfx),function(node){(0,_tinySvg.remove)(node);});}function clearSegmentDraggers(gfx){(0,_minDash.forEach)((0,_minDom.queryAll)('.'+_BendpointUtil.SEGMENT_DRAGGER_CLS,gfx),function(node){(0,_tinySvg.remove)(node);});}function addHandles(connection){var gfx=getBendpointsContainer(connection);return gfx||(gfx=getBendpointsContainer(connection,!0),createBendpoints(gfx,connection),createSegmentDraggers(gfx,connection)),gfx;}function updateHandles(connection){var gfx=getBendpointsContainer(connection);gfx&&(clearSegmentDraggers(gfx),clearBendpoints(gfx),createSegmentDraggers(gfx,connection),createBendpoints(gfx,connection));}eventBus.on('connection.changed',function(event){updateHandles(event.element);}),eventBus.on('connection.remove',function(event){var gfx=getBendpointsContainer(event.element);gfx&&(0,_tinySvg.remove)(gfx);}),eventBus.on('element.marker.update',function(event){var element=event.element,bendpointsGfx;if(!element.waypoints)return;bendpointsGfx=addHandles(element),event.add?(0,_tinySvg.classes)(bendpointsGfx).add(event.marker):(0,_tinySvg.classes)(bendpointsGfx).remove(event.marker);}),eventBus.on('element.mousemove',function(event){var element=event.element,waypoints=element.waypoints,bendpointsGfx,floating,intersection;if(waypoints){if(bendpointsGfx=getBendpointsContainer(element,!0),floating=(0,_minDom.query)('.floating',bendpointsGfx),!floating)return;intersection=getConnectionIntersection(waypoints,event.originalEvent),intersection&&(0,_SvgTransformUtil.translate)(floating,intersection.point.x,intersection.point.y);}}),eventBus.on('element.mousedown',function(event){var originalEvent=event.originalEvent,element=event.element,waypoints=element.waypoints;return waypoints?activateBendpointMove(originalEvent,element,waypoints):void 0;}),eventBus.on('selection.changed',function(event){var newSelection=event.newSelection,primary=newSelection[0];primary&&primary.waypoints&&addHandles(primary);}),eventBus.on('element.hover',function(event){var element=event.element;element.waypoints&&(addHandles(element),interactionEvents.registerEvent(event.gfx,'mousemove','element.mousemove'));}),eventBus.on('element.out',function(event){interactionEvents.unregisterEvent(event.gfx,'mousemove','element.mousemove');}),eventBus.on('element.updateId',function(context){var element=context.element,newId=context.newId;if(element.waypoints){var bendpointContainer=getBendpointsContainer(element);bendpointContainer&&(0,_tinySvg.attr)(bendpointContainer,{'data-element-id':newId});}}),this.addHandles=addHandles,this.updateHandles=updateHandles,this.getBendpointsContainer=getBendpointsContainer;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=Bendpoints;var _minDash=require('min-dash');var _minDom=require('min-dom');var _BendpointUtil=require('./BendpointUtil');var _css=require('css.escape');var _css2=_interopRequireDefault(_css);var _Geometry=require('../../util/Geometry');var _LineIntersection=require('../../util/LineIntersection');var _tinySvg=require('tiny-svg');var _SvgTransformUtil=require('../../util/SvgTransformUtil');Bendpoints.$inject=['eventBus','canvas','interactionEvents','bendpointMove','connectionSegmentMove'];},{'../../util/Geometry':333,'../../util/LineIntersection':336,'../../util/SvgTransformUtil':343,'./BendpointUtil':208,'css.escape':179,'min-dash':438,'min-dom':439,'tiny-svg':468}],210:[function(require,module,exports){'use strict';function axisAdd(point,axis,delta){return axisSet(point,axis,point[axis]+delta);}function axisSet(point,axis,value){return{x:axis==='x'?value:point.x,y:axis==='y'?value:point.y};}function axisFenced(position,segmentStart,segmentEnd,axis){var maxValue=Math.max(segmentStart[axis],segmentEnd[axis]),minValue=Math.min(segmentStart[axis],segmentEnd[axis]);var padding=20;var fencedValue=Math.min(Math.max(minValue+padding,position[axis]),maxValue-padding);return axisSet(segmentStart,axis,fencedValue);}function flipAxis(axis){return axis==='x'?'y':'x';}function getDocking(point,referenceElement,moveAxis){var referenceMid,inverseAxis;return point.original?point.original:(referenceMid=(0,_LayoutUtil.getMid)(referenceElement),inverseAxis=flipAxis(moveAxis),axisSet(point,inverseAxis,referenceMid[inverseAxis]));}function ConnectionSegmentMove(injector,eventBus,canvas,dragging,graphicsFactory,rules,modeling){function cropConnection(connection,newWaypoints){if(!connectionDocking)return newWaypoints;var oldWaypoints=connection.waypoints,croppedWaypoints;return connection.waypoints=newWaypoints,croppedWaypoints=connectionDocking.getCroppedWaypoints(connection),connection.waypoints=oldWaypoints,croppedWaypoints;}function redrawConnection(data){graphicsFactory.update('connection',data.connection,data.connectionGfx);}function updateDragger(context,segmentOffset,event){var newWaypoints=context.newWaypoints,segmentStartIndex=context.segmentStartIndex+segmentOffset,segmentStart=newWaypoints[segmentStartIndex],segmentEndIndex=context.segmentEndIndex+segmentOffset,segmentEnd=newWaypoints[segmentEndIndex],axis=flipAxis(context.axis);var draggerPosition=axisFenced(event,segmentStart,segmentEnd,axis);(0,_SvgTransformUtil.translate)(context.draggerGfx,draggerPosition.x,draggerPosition.y);}function filterRedundantWaypoints(waypoints,segmentStartIndex){var segmentOffset=0;var filteredWaypoints=waypoints.filter(function(r,idx){return(0,_Geometry.pointsOnLine)(waypoints[idx-1],waypoints[idx+1],r)?(segmentOffset=idx<=segmentStartIndex?segmentOffset-1:segmentOffset,!1):!0;});return{waypoints:filteredWaypoints,segmentOffset:segmentOffset};}var connectionDocking=injector.get('connectionDocking',!1);this.start=function(event,connection,idx){var context,gfx=canvas.getGraphics(connection),segmentStartIndex=idx-1,segmentEndIndex=idx,waypoints=connection.waypoints,segmentStart=waypoints[segmentStartIndex],segmentEnd=waypoints[segmentEndIndex],direction,axis;if(direction=(0,_Geometry.pointsAligned)(segmentStart,segmentEnd),!direction)return;axis=direction==='v'?'y':'x',segmentStartIndex===0&&(segmentStart=getDocking(segmentStart,connection.source,axis)),segmentEndIndex===waypoints.length-1&&(segmentEnd=getDocking(segmentEnd,connection.target,axis)),context={connection:connection,segmentStartIndex:segmentStartIndex,segmentEndIndex:segmentEndIndex,segmentStart:segmentStart,segmentEnd:segmentEnd,axis:axis},dragging.init(event,{x:(segmentStart.x+segmentEnd.x)/2,y:(segmentStart.y+segmentEnd.y)/2},'connectionSegment.move',{cursor:axis==='x'?'resize-ew':'resize-ns',data:{connection:connection,connectionGfx:gfx,context:context}});},eventBus.on('connectionSegment.move.start',function(e){var context=e.context,connection=e.connection,layer=canvas.getLayer('overlays');context.originalWaypoints=connection.waypoints.slice(),context.draggerGfx=(0,_BendpointUtil.addSegmentDragger)(layer,context.segmentStart,context.segmentEnd),(0,_tinySvg.classes)(context.draggerGfx).add('djs-dragging'),canvas.addMarker(connection,MARKER_CONNECT_UPDATING);}),eventBus.on('connectionSegment.move.move',function(e){var context=e.context,connection=context.connection,segmentStartIndex=context.segmentStartIndex,segmentEndIndex=context.segmentEndIndex,segmentStart=context.segmentStart,segmentEnd=context.segmentEnd,axis=context.axis;var newWaypoints=context.originalWaypoints.slice(),newSegmentStart=axisAdd(segmentStart,axis,e['d'+axis]),newSegmentEnd=axisAdd(segmentEnd,axis,e['d'+axis]);var waypointCount=newWaypoints.length,segmentOffset=0;newWaypoints[segmentStartIndex]=newSegmentStart,newWaypoints[segmentEndIndex]=newSegmentEnd;var sourceToSegmentOrientation,targetToSegmentOrientation;segmentStartIndex<2&&(sourceToSegmentOrientation=(0,_LayoutUtil.getOrientation)(connection.source,newSegmentStart),segmentStartIndex===1?sourceToSegmentOrientation==='intersect'&&(newWaypoints.shift(),newWaypoints[0]=newSegmentStart,segmentOffset--):sourceToSegmentOrientation!=='intersect'&&(newWaypoints.unshift(segmentStart),segmentOffset++)),segmentEndIndex>waypointCount-3&&(targetToSegmentOrientation=(0,_LayoutUtil.getOrientation)(connection.target,newSegmentEnd),segmentEndIndex===waypointCount-2?targetToSegmentOrientation==='intersect'&&(newWaypoints.pop(),newWaypoints[newWaypoints.length-1]=newSegmentEnd):targetToSegmentOrientation!=='intersect'&&newWaypoints.push(segmentEnd)),context.newWaypoints=connection.waypoints=cropConnection(connection,newWaypoints),updateDragger(context,segmentOffset,e),context.newSegmentStartIndex=segmentStartIndex+segmentOffset,redrawConnection(e);}),eventBus.on('connectionSegment.move.hover',function(e){e.context.hover=e.hover,canvas.addMarker(e.hover,MARKER_CONNECT_HOVER);}),eventBus.on(['connectionSegment.move.out','connectionSegment.move.cleanup'],function(e){var hover=e.context.hover;hover&&canvas.removeMarker(hover,MARKER_CONNECT_HOVER);}),eventBus.on('connectionSegment.move.cleanup',function(e){var context=e.context,connection=context.connection;context.draggerGfx&&(0,_tinySvg.remove)(context.draggerGfx),canvas.removeMarker(connection,MARKER_CONNECT_UPDATING);}),eventBus.on(['connectionSegment.move.cancel','connectionSegment.move.end'],function(e){var context=e.context,connection=context.connection;connection.waypoints=context.originalWaypoints,redrawConnection(e);}),eventBus.on('connectionSegment.move.end',function(e){var context=e.context,connection=context.connection,newWaypoints=context.newWaypoints,newSegmentStartIndex=context.newSegmentStartIndex;newWaypoints=newWaypoints.map(function(p){return{original:p.original,x:Math.round(p.x),y:Math.round(p.y)};});var filtered=filterRedundantWaypoints(newWaypoints,newSegmentStartIndex);var filteredWaypoints=filtered.waypoints,croppedWaypoints=cropConnection(connection,filteredWaypoints),segmentOffset=filtered.segmentOffset;var hints={segmentMove:{segmentStartIndex:context.segmentStartIndex,newSegmentStartIndex:newSegmentStartIndex+segmentOffset}};modeling.updateWaypoints(connection,croppedWaypoints,hints);});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=ConnectionSegmentMove;var _Geometry=require('../../util/Geometry');var _BendpointUtil=require('./BendpointUtil');var _LayoutUtil=require('../../layout/LayoutUtil');var _tinySvg=require('tiny-svg');var _SvgTransformUtil=require('../../util/SvgTransformUtil');var MARKER_CONNECT_HOVER='connect-hover',MARKER_CONNECT_UPDATING='djs-updating';ConnectionSegmentMove.$inject=['injector','eventBus','canvas','dragging','graphicsFactory','rules','modeling'];},{'../../layout/LayoutUtil':317,'../../util/Geometry':333,'../../util/SvgTransformUtil':343,'./BendpointUtil':208,'tiny-svg':468}],211:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _dragging=require('../dragging');var _dragging2=_interopRequireDefault(_dragging);var _rules=require('../rules');var _rules2=_interopRequireDefault(_rules);var _Bendpoints=require('./Bendpoints');var _Bendpoints2=_interopRequireDefault(_Bendpoints);var _BendpointMove=require('./BendpointMove');var _BendpointMove2=_interopRequireDefault(_BendpointMove);var _ConnectionSegmentMove=require('./ConnectionSegmentMove');var _ConnectionSegmentMove2=_interopRequireDefault(_ConnectionSegmentMove);var _BendpointSnapping=require('./BendpointSnapping');var _BendpointSnapping2=_interopRequireDefault(_BendpointSnapping);exports.default={__depends__:[_dragging2.default,_rules2.default],__init__:['bendpoints','bendpointSnapping'],bendpoints:['type',_Bendpoints2.default],bendpointMove:['type',_BendpointMove2.default],connectionSegmentMove:['type',_ConnectionSegmentMove2.default],bendpointSnapping:['type',_BendpointSnapping2.default]};},{'../dragging':228,'../rules':292,'./BendpointMove':206,'./BendpointSnapping':207,'./Bendpoints':209,'./ConnectionSegmentMove':210}],212:[function(require,module,exports){'use strict';function ChangeSupport(eventBus,canvas,elementRegistry,graphicsFactory){eventBus.on('element.changed',function(event){var element=event.element;if((element.parent||element===canvas.getRootElement())&&(event.gfx=elementRegistry.getGraphics(element)),!event.gfx)return;eventBus.fire((0,_Elements.getType)(element)+'.changed',event);}),eventBus.on('elements.changed',function(event){var elements=event.elements;elements.forEach(function(e){eventBus.fire('element.changed',{element:e});}),graphicsFactory.updateContainments(elements);}),eventBus.on('shape.changed',function(event){graphicsFactory.update('shape',event.element,event.gfx);}),eventBus.on('connection.changed',function(event){graphicsFactory.update('connection',event.element,event.gfx);});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=ChangeSupport;var _Elements=require('../../util/Elements');ChangeSupport.$inject=['eventBus','canvas','elementRegistry','graphicsFactory'];},{'../../util/Elements':331}],213:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _ChangeSupport=require('./ChangeSupport');var _ChangeSupport2=_interopRequireDefault(_ChangeSupport);exports.default={__init__:['changeSupport'],changeSupport:['type',_ChangeSupport2.default]};},{'./ChangeSupport':212}],214:[function(require,module,exports){'use strict';function Clipboard(){}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=Clipboard,Clipboard.prototype.get=function(){return this._data;},Clipboard.prototype.set=function(data){this._data=data;},Clipboard.prototype.clear=function(){var data=this._data;return delete this._data,data;},Clipboard.prototype.isEmpty=function(){return!this._data;};},{}],215:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _Clipboard=require('./Clipboard');var _Clipboard2=_interopRequireDefault(_Clipboard);exports.default={clipboard:['type',_Clipboard2.default]};},{'./Clipboard':214}],216:[function(require,module,exports){'use strict';function Connect(eventBus,dragging,modeling,rules,canvas,graphicsFactory){function canConnect(source,target){return rules.allowed('connection.create',{source:source,target:target});}function crop(start,end,source,target){var sourcePath=graphicsFactory.getShapePath(source),targetPath=target&&graphicsFactory.getShapePath(target),connectionPath=graphicsFactory.getConnectionPath({waypoints:[start,end]});return start=(0,_LayoutUtil.getElementLineIntersection)(sourcePath,connectionPath,!0)||start,end=target&&(0,_LayoutUtil.getElementLineIntersection)(targetPath,connectionPath,!1)||end,[start,end];}eventBus.on('connect.move',function(event){var context=event.context,source=context.source,target=context.target,visual=context.visual,sourcePosition=context.sourcePosition,endPosition,waypoints;endPosition={x:event.x,y:event.y},waypoints=crop(sourcePosition,endPosition,source,target),(0,_tinySvg.attr)(visual,{points:[waypoints[0].x,waypoints[0].y,waypoints[1].x,waypoints[1].y]});}),eventBus.on('connect.hover',function(event){var context=event.context,source=context.source,hover=event.hover,canExecute;if(canExecute=context.canExecute=canConnect(source,hover),canExecute===null)return;context.target=hover,canvas.addMarker(hover,canExecute?MARKER_OK:MARKER_NOT_OK);}),eventBus.on(['connect.out','connect.cleanup'],function(event){var context=event.context;context.target&&canvas.removeMarker(context.target,context.canExecute?MARKER_OK:MARKER_NOT_OK),context.target=null,context.canExecute=!1;}),eventBus.on('connect.cleanup',function(event){var context=event.context;context.visual&&(0,_tinySvg.remove)(context.visual);}),eventBus.on('connect.start',function(event){var context=event.context,visual;visual=(0,_tinySvg.create)('polyline'),(0,_tinySvg.attr)(visual,{stroke:'#333',strokeDasharray:[1],strokeWidth:2,'pointer-events':'none'}),(0,_tinySvg.append)(canvas.getDefaultLayer(),visual),context.visual=visual;}),eventBus.on('connect.end',function(event){var context=event.context,source=context.source,sourcePosition=context.sourcePosition,target=context.target,targetPosition={x:event.x,y:event.y},canExecute=context.canExecute||canConnect(source,target);if(!canExecute)return!1;var attrs=null,hints={connectionStart:sourcePosition,connectionEnd:targetPosition};(canExecute===void 0?'undefined':_typeof(canExecute))==='object'&&(attrs=canExecute),modeling.connect(source,target,attrs,hints);}),this.start=function(event,source,sourcePosition,autoActivate){(sourcePosition===void 0?'undefined':_typeof(sourcePosition))!=='object'&&(autoActivate=sourcePosition,sourcePosition=(0,_LayoutUtil.getMid)(source)),dragging.init(event,'connect',{autoActivate:autoActivate,data:{shape:source,context:{source:source,sourcePosition:sourcePosition}}});};}Object.defineProperty(exports,'__esModule',{value:!0});var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj;};exports.default=Connect;var _LayoutUtil=require('../../layout/LayoutUtil');var _tinySvg=require('tiny-svg');var MARKER_OK='connect-ok',MARKER_NOT_OK='connect-not-ok';Connect.$inject=['eventBus','dragging','modeling','rules','canvas','graphicsFactory'];},{'../../layout/LayoutUtil':317,'tiny-svg':468}],217:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _selection=require('../selection');var _selection2=_interopRequireDefault(_selection);var _rules=require('../rules');var _rules2=_interopRequireDefault(_rules);var _dragging=require('../dragging');var _dragging2=_interopRequireDefault(_dragging);var _Connect=require('./Connect');var _Connect2=_interopRequireDefault(_Connect);exports.default={__depends__:[_selection2.default,_rules2.default,_dragging2.default],connect:['type',_Connect2.default]};},{'../dragging':228,'../rules':292,'../selection':298,'./Connect':216}],218:[function(require,module,exports){'use strict';function ContextPad(eventBus,overlays){this._providers=[],this._eventBus=eventBus,this._overlays=overlays,this._current=null,this._init();}function addClasses(element,classNames){var classes=(0,_minDom.classes)(element);var actualClassNames=(0,_minDash.isArray)(classNames)?classNames:classNames.split(/\s+/g);actualClassNames.forEach(function(cls){classes.add(cls);});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=ContextPad;var _minDash=require('min-dash');var _minDom=require('min-dom');var entrySelector='.entry';ContextPad.$inject=['eventBus','overlays'],ContextPad.prototype._init=function(){var eventBus=this._eventBus;var self=this;eventBus.on('selection.changed',function(e){var selection=e.newSelection;selection.length===1?self.open(selection[0]):self.close();}),eventBus.on('elements.delete',function(event){var elements=event.elements;(0,_minDash.forEach)(elements,function(e){self.isOpen(e)&&self.close();});}),eventBus.on('element.changed',function(event){var element=event.element,current=self._current;current&&current.element===element&&self.open(element,!0);});},ContextPad.prototype.registerProvider=function(provider){this._providers.push(provider);},ContextPad.prototype.getEntries=function(element){var entries={};return(0,_minDash.forEach)(this._providers,function(provider){var e=provider.getContextPadEntries(element);(0,_minDash.forEach)(e,function(entry,id){entries[id]=entry;});}),entries;},ContextPad.prototype.trigger=function(action,event,autoActivate){var element=this._current.element,entries=this._current.entries,entry,handler,originalEvent,button=event.delegateTarget||event.target;if(!button)return event.preventDefault();if(entry=entries[(0,_minDom.attr)(button,'data-action')],handler=entry.action,originalEvent=event.originalEvent||event,(0,_minDash.isFunction)(handler)){if(action==='click')return handler(originalEvent,element,autoActivate);}else if(handler[action])return handler[action](originalEvent,element,autoActivate);event.preventDefault();},ContextPad.prototype.open=function(element,force){if(!force&&this.isOpen(element))return;this.close(),this._updateAndOpen(element);},ContextPad.prototype._updateAndOpen=function(element){var entries=this.getEntries(element),pad=this.getPad(element),html=pad.html;(0,_minDash.forEach)(entries,function(entry,id){var grouping=entry.group||'default',control=(0,_minDom.domify)(entry.html||'<div class="entry" draggable="true"></div>'),container;(0,_minDom.attr)(control,'data-action',id),container=(0,_minDom.query)('[data-group='+grouping+']',html),container||(container=(0,_minDom.domify)('<div class="group" data-group="'+grouping+'"></div>'),html.appendChild(container)),container.appendChild(control),entry.className&&addClasses(control,entry.className),entry.title&&(0,_minDom.attr)(control,'title',entry.title),entry.imageUrl&&control.appendChild((0,_minDom.domify)('<img src="'+entry.imageUrl+'">'));}),(0,_minDom.classes)(html).add('open'),this._current={element:element,pad:pad,entries:entries},this._eventBus.fire('contextPad.open',{current:this._current});},ContextPad.prototype.getPad=function(element){if(this.isOpen())return this._current.pad;var self=this;var overlays=this._overlays;var html=(0,_minDom.domify)('<div class="djs-context-pad"></div>');_minDom.delegate.bind(html,entrySelector,'click',function(event){self.trigger('click',event);}),_minDom.delegate.bind(html,entrySelector,'dragstart',function(event){self.trigger('dragstart',event);}),_minDom.event.bind(html,'mousedown',function(event){event.stopPropagation();}),this._overlayId=overlays.add(element,'context-pad',{position:{right:-9,top:-6},html:html});var pad=overlays.get(this._overlayId);return this._eventBus.fire('contextPad.create',{element:element,pad:pad}),pad;},ContextPad.prototype.close=function(){if(!this.isOpen())return;this._overlays.remove(this._overlayId),this._overlayId=null,this._eventBus.fire('contextPad.close',{current:this._current}),this._current=null;},ContextPad.prototype.isOpen=function(element){return!!this._current&&(element?this._current.element===element:!0);};},{'min-dash':438,'min-dom':439}],219:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _interactionEvents=require('../interaction-events');var _interactionEvents2=_interopRequireDefault(_interactionEvents);var _overlays=require('../overlays');var _overlays2=_interopRequireDefault(_overlays);var _ContextPad=require('./ContextPad');var _ContextPad2=_interopRequireDefault(_ContextPad);exports.default={__depends__:[_interactionEvents2.default,_overlays2.default],contextPad:['type',_ContextPad2.default]};},{'../interaction-events':236,'../overlays':276,'./ContextPad':218}],220:[function(require,module,exports){'use strict';function CopyPaste(eventBus,modeling,elementFactory,rules,clipboard,canvas){this._eventBus=eventBus,this._modeling=modeling,this._elementFactory=elementFactory,this._rules=rules,this._canvas=canvas,this._clipboard=clipboard,this._descriptors=[],this.registerDescriptor(function(element,descriptor){return descriptor.priority=1,descriptor.id=element.id,element.parent&&(descriptor.parent=element.parent.id),element.labelTarget&&(descriptor.priority=4,descriptor.labelTarget=element.labelTarget.id),element.host&&(descriptor.priority=2,descriptor.host=element.host.id),typeof element.x==='number'&&(descriptor.x=element.x,descriptor.y=element.y),element.width&&(descriptor.width=element.width,descriptor.height=element.height),element.waypoints&&(descriptor.priority=3,descriptor.waypoints=[],(0,_minDash.forEach)(element.waypoints,function(waypoint){var wp={x:waypoint.x,y:waypoint.y};waypoint.original&&(wp.original={x:waypoint.original.x,y:waypoint.original.y}),descriptor.waypoints.push(wp);})),element.source&&element.target&&(descriptor.source=element.source.id,descriptor.target=element.target.id),descriptor;});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=CopyPaste;var _minDash=require('min-dash');var _Elements=require('../../util/Elements');var _PositionUtil=require('../../util/PositionUtil');var _CopyPasteUtil=require('../../util/CopyPasteUtil');CopyPaste.$inject=['eventBus','modeling','elementFactory','rules','clipboard','canvas'],CopyPaste.prototype.copy=function(selectedElements){var clipboard=this._clipboard,tree,bbox;return(0,_minDash.isArray)(selectedElements)||(selectedElements=selectedElements?[selectedElements]:[]),selectedElements.length?(tree=this.createTree(selectedElements),bbox=this._bbox=(0,_PositionUtil.center)((0,_Elements.getBBox)(tree.allShapes)),delete tree.allShapes,(0,_minDash.forEach)(tree,function(elements){(0,_minDash.forEach)(elements,function(element){var delta,labelTarget;element.labelTarget?(labelTarget=(0,_minDash.find)(elements,(0,_minDash.matchPattern)({id:element.labelTarget})),labelTarget.waypoints?delta=(0,_PositionUtil.delta)(element,labelTarget.waypoints[0]):delta=(0,_PositionUtil.delta)(element,labelTarget)):element.priority===3?(delta=[],(0,_minDash.forEach)(element.waypoints,function(waypoint){var waypointDelta=(0,_PositionUtil.delta)(waypoint,bbox);delta.push(waypointDelta);})):delta=(0,_PositionUtil.delta)(element,bbox),element.delta=delta;});}),this._eventBus.fire('elements.copy',{context:{tree:tree}}),Object.keys(tree).length===0?clipboard.clear():clipboard.set(tree),this._eventBus.fire('elements.copied',{context:{tree:tree}}),tree):void 0;},CopyPaste.prototype.paste=function(context){var clipboard=this._clipboard,modeling=this._modeling,eventBus=this._eventBus,rules=this._rules;var tree=clipboard.get(),topParent=context.element,position=context.point,newTree,canPaste;if(clipboard.isEmpty())return;if(newTree=(0,_minDash.reduce)(tree,function(pasteTree,elements,depthStr){var depth=parseInt(depthStr,10);return isNaN(depth)?pasteTree:(pasteTree[depth]=elements,pasteTree);},{}),canPaste=rules.allowed('elements.paste',{tree:newTree,target:topParent}),!canPaste){eventBus.fire('elements.paste.rejected',{context:{tree:newTree,position:position,target:topParent}});return;}modeling.pasteElements(newTree,topParent,position);},CopyPaste.prototype._computeDelta=function(elements,element){var bbox=this._bbox,delta={};return element.labelTarget?(0,_PositionUtil.delta)(element,element.labelTarget):(element.priority===3?(delta=[],(0,_minDash.forEach)(element.waypoints,function(waypoint){var waypointDelta=(0,_PositionUtil.delta)(waypoint,bbox);delta.push(waypointDelta);})):delta=(0,_PositionUtil.delta)(element,bbox),delta);},CopyPaste.prototype.hasRelations=function(elements,element){var source,target,labelTarget;return element.waypoints&&(source=(0,_minDash.find)(elements,(0,_minDash.matchPattern)({id:element.source.id})),target=(0,_minDash.find)(elements,(0,_minDash.matchPattern)({id:element.target.id})),!(source&&target))?!1:element.labelTarget&&(labelTarget=(0,_minDash.find)(elements,(0,_minDash.matchPattern)({id:element.labelTarget.id})),!labelTarget)?!1:!0;},CopyPaste.prototype.registerDescriptor=function(descriptor){if(typeof descriptor!=='function')throw new Error('the descriptor must be a function');if(this._descriptors.indexOf(descriptor)!==-1)throw new Error('this descriptor is already registered');this._descriptors.push(descriptor);},CopyPaste.prototype._executeDescriptors=function(data){return data.descriptor||(data.descriptor={}),(0,_minDash.forEach)(this._descriptors,function(descriptor){data.descriptor=descriptor(data.element,data.descriptor);}),data;},CopyPaste.prototype.createTree=function(elements){function canCopy(collection,element){return rules.allowed('element.copy',{collection:collection,element:element});}function includeElement(data){var idx=(0,_minDash.findIndex)(includedElements,(0,_minDash.matchPattern)({element:data.element})),element;if(idx!==-1)element=includedElements[idx];else return includedElements.push(data);element.depth<data.depth&&(includedElements.splice(idx,1),includedElements.push(data));}var rules=this._rules,self=this;var tree={},includedElements=[],_elements;var topLevel=(0,_CopyPasteUtil.getTopLevel)(elements);return tree.allShapes=[],(0,_Elements.eachElement)(topLevel,function(element,i,depth){function getNested(lists){(0,_minDash.forEach)(lists,function(list){list&&list.length&&(0,_minDash.forEach)(list,function(elem){elem.label&&includeElement({element:elem.label,depth:depth}),includeElement({element:elem,depth:depth});});});}var nestedChildren=element.children;return element.labelTarget?void 0:(element.label&&includeElement({element:element.label,depth:depth}),getNested([element.attachers,element.incoming,element.outgoing]),includeElement({element:element,depth:depth}),nestedChildren?nestedChildren:void 0);}),includedElements=(0,_minDash.map)(includedElements,function(data){return self._executeDescriptors(data);}),includedElements=(0,_minDash.sortBy)(includedElements,function(data){return data.descriptor.priority;}),_elements=(0,_minDash.map)(includedElements,function(data){return data.element;}),(0,_minDash.forEach)(includedElements,function(data){var depth=data.depth;if(!self.hasRelations(tree.allShapes,data.element))return;if(!canCopy(_elements,data.element))return;tree.allShapes.push(data.element),tree[depth]||(tree[depth]=[]),tree[depth].push(data.descriptor);}),tree;};},{'../../util/CopyPasteUtil':329,'../../util/Elements':331,'../../util/PositionUtil':340,'min-dash':438}],221:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _clipboard=require('../clipboard');var _clipboard2=_interopRequireDefault(_clipboard);var _rules=require('../rules');var _rules2=_interopRequireDefault(_rules);var _mouseTracking=require('../mouse-tracking');var _mouseTracking2=_interopRequireDefault(_mouseTracking);var _CopyPaste=require('./CopyPaste');var _CopyPaste2=_interopRequireDefault(_CopyPaste);exports.default={__depends__:[_clipboard2.default,_rules2.default,_mouseTracking2.default],__init__:['copyPaste'],copyPaste:['type',_CopyPaste2.default]};},{'../clipboard':215,'../mouse-tracking':268,'../rules':292,'./CopyPaste':220}],222:[function(require,module,exports){'use strict';function Create(eventBus,dragging,rules,modeling,canvas,styles,graphicsFactory){function canCreate(shape,target,source,position){if(!target)return!1;var ctx={source:source,shape:shape,target:target,position:position};var create,attach,connect;return attach=rules.allowed('shape.attach',ctx),attach||(create=rules.allowed('shape.create',ctx)),(create||attach)&&(connect=source&&rules.allowed('connection.create',{source:source,target:shape,hints:{targetParent:target,targetAttach:attach}})),create||attach?{attach:attach,connect:connect}:!1;}function setMarker(element,marker){[MARKER_ATTACH,MARKER_OK,MARKER_NOT_OK,MARKER_NEW_PARENT].forEach(function(m){m===marker?canvas.addMarker(element,m):canvas.removeMarker(element,m);});}function createVisual(shape){var group,preview,visual;group=(0,_tinySvg.create)('g'),(0,_tinySvg.attr)(group,styles.cls('djs-drag-group',['no-events'])),(0,_tinySvg.append)(canvas.getDefaultLayer(),group),preview=(0,_tinySvg.create)('g'),(0,_tinySvg.classes)(preview).add('djs-dragger'),(0,_tinySvg.append)(group,preview),(0,_SvgTransformUtil.translate)(preview,shape.width/-2,shape.height/-2);var visualGroup=(0,_tinySvg.create)('g');return(0,_tinySvg.classes)(visualGroup).add('djs-visual'),(0,_tinySvg.append)(preview,visualGroup),visual=visualGroup,graphicsFactory.drawShape(visual,shape),group;}eventBus.on('create.move',function(event){var context=event.context,hover=event.hover,shape=context.shape,source=context.source,canExecute;var position={x:event.x,y:event.y};canExecute=context.canExecute=hover&&canCreate(shape,hover,source,position),hover&&canExecute!==null&&(context.target=hover,canExecute&&canExecute.attach?setMarker(hover,MARKER_ATTACH):setMarker(hover,canExecute?MARKER_NEW_PARENT:MARKER_NOT_OK));}),eventBus.on('create.move',LOW_PRIORITY,function(event){var context=event.context,shape=context.shape,visual=context.visual;visual||(visual=context.visual=createVisual(shape)),(0,_SvgTransformUtil.translate)(visual,event.x,event.y);}),eventBus.on(['create.end','create.out','create.cleanup'],function(event){var context=event.context,target=context.target;target&&setMarker(target,null);}),eventBus.on('create.end',function(event){var context=event.context,source=context.source,shape=context.shape,target=context.target,canExecute=context.canExecute,attach=canExecute&&canExecute.attach,connect=canExecute&&canExecute.connect,position={x:event.x,y:event.y};if(!canExecute)return!1;connect?shape=modeling.appendShape(source,shape,position,target,{attach:attach,connection:connect===!0?{}:connect}):shape=modeling.createShape(shape,position,target,{attach:attach}),context.shape=shape;}),eventBus.on('create.cleanup',function(event){var context=event.context;context.visual&&(0,_tinySvg.remove)(context.visual);}),this.start=function(event,shape,source){dragging.init(event,'create',{cursor:'grabbing',autoActivate:!0,data:{shape:shape,context:{shape:shape,source:source}}});};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=Create;var _tinySvg=require('tiny-svg');var _SvgTransformUtil=require('../../util/SvgTransformUtil');var LOW_PRIORITY=750;var MARKER_OK='drop-ok',MARKER_NOT_OK='drop-not-ok',MARKER_ATTACH='attach-ok',MARKER_NEW_PARENT='new-parent';Create.$inject=['eventBus','dragging','rules','modeling','canvas','styles','graphicsFactory'];},{'../../util/SvgTransformUtil':343,'tiny-svg':468}],223:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _dragging=require('../dragging');var _dragging2=_interopRequireDefault(_dragging);var _selection=require('../selection');var _selection2=_interopRequireDefault(_selection);var _rules=require('../rules');var _rules2=_interopRequireDefault(_rules);var _Create=require('./Create');var _Create2=_interopRequireDefault(_Create);exports.default={__depends__:[_dragging2.default,_selection2.default,_rules2.default],create:['type',_Create2.default]};},{'../dragging':228,'../rules':292,'../selection':298,'./Create':222}],224:[function(require,module,exports){'use strict';function DistributeElements(modeling){this._modeling=modeling,this._filters=[],this.registerFilter(function(elements,axis,dimension){var elementsSize=0,numOfShapes=0,avgDimension;return(0,_minDash.forEach)(elements,function(element){if(element.waypoints||element.labelTarget)return;elementsSize+=element[dimension],numOfShapes+=1;}),avgDimension=Math.round(elementsSize/numOfShapes),(0,_minDash.filter)(elements,function(element){return element[dimension]<avgDimension+50;});});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=DistributeElements;var _minDash=require('min-dash');var AXIS_DIMENSIONS={horizontal:['x','width'],vertical:['y','height']};var THRESHOLD=5;DistributeElements.$inject=['modeling'],DistributeElements.prototype.registerFilter=function(filterFn){if(typeof filterFn!=='function')throw new Error('the filter has to be a function');this._filters.push(filterFn);},DistributeElements.prototype.trigger=function(elements,orientation){var modeling=this._modeling;var groups,distributableElements;return elements.length<3?void 0:(this._setOrientation(orientation),distributableElements=this._filterElements(elements),groups=this._createGroups(distributableElements),groups.length<=2?void 0:(modeling.distributeElements(groups,this._axis,this._dimension),groups));},DistributeElements.prototype._filterElements=function(elements){var filters=this._filters,axis=this._axis,dimension=this._dimension,distributableElements=[].concat(elements);return filters.length?((0,_minDash.forEach)(filters,function(filterFn){distributableElements=filterFn(distributableElements,axis,dimension);}),distributableElements):elements;},DistributeElements.prototype._createGroups=function(elements){var rangeGroups=[],self=this,axis=this._axis,dimension=this._dimension;if(!axis)throw new Error('must have a defined "axis" and "dimension"');var sortedElements=(0,_minDash.sortBy)(elements,axis);return(0,_minDash.forEach)(sortedElements,function(element,idx){var elementRange=self._findRange(element,axis,dimension),range;var previous=rangeGroups[rangeGroups.length-1];previous&&self._hasIntersection(previous.range,elementRange)?rangeGroups[rangeGroups.length-1].elements.push(element):(range={range:elementRange,elements:[element]},rangeGroups.push(range));}),rangeGroups;},DistributeElements.prototype._setOrientation=function(direction){var orientation=AXIS_DIMENSIONS[direction];this._axis=orientation[0],this._dimension=orientation[1];},DistributeElements.prototype._hasIntersection=function(rangeA,rangeB){return Math.max(rangeA.min,rangeA.max)>=Math.min(rangeB.min,rangeB.max)&&Math.min(rangeA.min,rangeA.max)<=Math.max(rangeB.min,rangeB.max);},DistributeElements.prototype._findRange=function(element){var axis=element[this._axis],dimension=element[this._dimension];return{min:axis+THRESHOLD,max:axis+dimension-THRESHOLD};};},{'min-dash':438}],225:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _DistributeElements=require('./DistributeElements');var _DistributeElements2=_interopRequireDefault(_DistributeElements);exports.default={__init__:['distributeElements'],distributeElements:['type',_DistributeElements2.default]};},{'./DistributeElements':224}],226:[function(require,module,exports){'use strict';function preventDefault(event){event.preventDefault();}function isTouchEvent(event){return typeof TouchEvent!=='undefined'&&event instanceof TouchEvent;}function getLength(point){return Math.sqrt(Math.pow(point.x,2)+Math.pow(point.y,2));}function Dragging(eventBus,canvas,selection){function toLocalPoint(globalPosition){var viewbox=canvas.viewbox();var clientRect=canvas._container.getBoundingClientRect();return{x:viewbox.x+round((globalPosition.x-clientRect.left)/viewbox.scale),y:viewbox.y+round((globalPosition.y-clientRect.top)/viewbox.scale)};}function fire(type,dragContext){dragContext=dragContext||context;var event=eventBus.createEvent((0,_minDash.assign)({},dragContext.payload,dragContext.data,{isTouch:dragContext.isTouch}));return eventBus.fire('drag.'+type,event)===!1?!1:eventBus.fire(dragContext.prefix+'.'+type,event);}function move(event,activate){var payload=context.payload,displacement=context.displacement;var globalStart=context.globalStart,globalCurrent=(0,_Event.toPoint)(event),globalDelta=(0,_PositionUtil.delta)(globalCurrent,globalStart);var localStart=context.localStart,localCurrent=toLocalPoint(globalCurrent),localDelta=(0,_PositionUtil.delta)(localCurrent,localStart);if(!context.active&&(activate||getLength(globalDelta)>context.threshold)){if((0,_minDash.assign)(payload,{x:localStart.x+displacement.x,y:localStart.y+displacement.y,dx:0,dy:0},{originalEvent:event}),!1===fire('start'))return cancel();context.active=!0,context.keepSelection||(payload.previousSelection=selection.get(),selection.select(null)),context.cursor&&(0,_Cursor.set)(context.cursor),canvas.addMarker(canvas.getRootElement(),DRAG_ACTIVE_CLS);}(0,_Event.stopPropagation)(event),context.active&&((0,_minDash.assign)(payload,{x:localCurrent.x+displacement.x,y:localCurrent.y+displacement.y,dx:localDelta.x,dy:localDelta.y},{originalEvent:event}),fire('move'));}function end(event){var previousContext,returnValue=!0;context.active&&(event&&(context.payload.originalEvent=event,(0,_Event.stopPropagation)(event)),returnValue=fire('end')),returnValue===!1&&fire('rejected'),previousContext=cleanup(returnValue!==!0),fire('ended',previousContext);}function checkCancel(event){event.which===27&&(preventDefault(event),cancel());}function trapClickAndEnd(event){var untrap;context.active&&(untrap=(0,_ClickTrap.install)(eventBus),setTimeout(untrap,400),preventDefault(event)),end(event);}function trapTouch(event){move(event);}function hover(event){var payload=context.payload;payload.hoverGfx=event.gfx,payload.hover=event.element,fire('hover');}function out(event){fire('out');var payload=context.payload;payload.hoverGfx=null,payload.hover=null;}function cancel(restore){var previousContext;if(!context)return;var wasActive=context.active;wasActive&&fire('cancel'),previousContext=cleanup(restore),wasActive&&fire('canceled',previousContext);}function cleanup(restore){var previousContext,endDrag;fire('cleanup'),(0,_Cursor.unset)(),context.trapClick?endDrag=trapClickAndEnd:endDrag=end,_minDom.event.unbind(document,'mousemove',move),_minDom.event.unbind(document,'dragstart',preventDefault),_minDom.event.unbind(document,'selectstart',preventDefault),_minDom.event.unbind(document,'mousedown',endDrag,!0),_minDom.event.unbind(document,'mouseup',endDrag,!0),_minDom.event.unbind(document,'keyup',checkCancel),_minDom.event.unbind(document,'touchstart',trapTouch,!0),_minDom.event.unbind(document,'touchcancel',cancel,!0),_minDom.event.unbind(document,'touchmove',move,!0),_minDom.event.unbind(document,'touchend',end,!0),eventBus.off('element.hover',hover),eventBus.off('element.out',out),canvas.removeMarker(canvas.getRootElement(),DRAG_ACTIVE_CLS);var previousSelection=context.payload.previousSelection;return restore!==!1&&previousSelection&&!selection.get().length&&selection.select(previousSelection),previousContext=context,context=null,previousContext;}function init(event,relativeTo,prefix,options){context&&cancel(!1),typeof relativeTo==='string'&&(options=prefix,prefix=relativeTo,relativeTo=null),options=(0,_minDash.assign)({},defaultOptions,options||{});var data=options.data||{},originalEvent,globalStart,localStart,endDrag,isTouch;options.trapClick?endDrag=trapClickAndEnd:endDrag=end,event?(originalEvent=(0,_Event.getOriginal)(event)||event,globalStart=(0,_Event.toPoint)(event),(0,_Event.stopPropagation)(event),originalEvent.type==='dragstart'&&preventDefault(originalEvent)):(originalEvent=null,globalStart={x:0,y:0}),localStart=toLocalPoint(globalStart),relativeTo||(relativeTo=localStart),isTouch=isTouchEvent(originalEvent),context=(0,_minDash.assign)({prefix:prefix,data:data,payload:{},globalStart:globalStart,displacement:(0,_PositionUtil.delta)(relativeTo,localStart),localStart:localStart,isTouch:isTouch},options),options.manual||(isTouch?(_minDom.event.bind(document,'touchstart',trapTouch,!0),_minDom.event.bind(document,'touchcancel',cancel,!0),_minDom.event.bind(document,'touchmove',move,!0),_minDom.event.bind(document,'touchend',end,!0)):(_minDom.event.bind(document,'mousemove',move),_minDom.event.bind(document,'dragstart',preventDefault),_minDom.event.bind(document,'selectstart',preventDefault),_minDom.event.bind(document,'mousedown',endDrag,!0),_minDom.event.bind(document,'mouseup',endDrag,!0)),_minDom.event.bind(document,'keyup',checkCancel),eventBus.on('element.hover',hover),eventBus.on('element.out',out)),fire('init'),options.autoActivate&&move(event,!0);}var defaultOptions={threshold:5,trapClick:!0};var context;eventBus.on('diagram.destroy',cancel),this.init=init,this.move=move,this.hover=hover,this.out=out,this.end=end,this.cancel=cancel,this.context=function(){return context;},this.setOptions=function(options){(0,_minDash.assign)(defaultOptions,options);};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=Dragging;var _minDash=require('min-dash');var _minDom=require('min-dom');var _Event=require('../../util/Event');var _Cursor=require('../../util/Cursor');var _ClickTrap=require('../../util/ClickTrap');var _PositionUtil=require('../../util/PositionUtil');var round=Math.round;var DRAG_ACTIVE_CLS='djs-drag-active';Dragging.$inject=['eventBus','canvas','selection'];},{'../../util/ClickTrap':327,'../../util/Cursor':330,'../../util/Event':332,'../../util/PositionUtil':340,'min-dash':438,'min-dom':439}],227:[function(require,module,exports){'use strict';function getGfx(target){var node=(0,_minDom.closest)(target,'svg, .djs-element',!0);return node;}function HoverFix(eventBus,dragging,elementRegistry){var self=this;eventBus.on('drag.start',function(event){eventBus.once('drag.move',function(){eventBus.once('drag.move',function(event){self.ensureHover(event);});});}),this.ensureHover=function(event){if(event.hover)return;var originalEvent=event.originalEvent,position,target,element,gfx;if(!(originalEvent instanceof MouseEvent))return;position=(0,_Event.toPoint)(originalEvent),target=document.elementFromPoint(position.x,position.y),gfx=getGfx(target),gfx&&(element=elementRegistry.get(gfx),dragging.hover({element:element,gfx:gfx}));};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=HoverFix;var _minDom=require('min-dom');var _Event=require('../../util/Event');HoverFix.$inject=['eventBus','dragging','elementRegistry'];},{'../../util/Event':332,'min-dom':439}],228:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _selection=require('../selection');var _selection2=_interopRequireDefault(_selection);var _Dragging=require('./Dragging');var _Dragging2=_interopRequireDefault(_Dragging);var _HoverFix=require('./HoverFix');var _HoverFix2=_interopRequireDefault(_HoverFix);exports.default={__init__:['hoverFix'],__depends__:[_selection2.default],dragging:['type',_Dragging2.default],hoverFix:['type',_HoverFix2.default]};},{'../selection':298,'./Dragging':226,'./HoverFix':227}],229:[function(require,module,exports){'use strict';function EditorActions(eventBus,commandStack,modeling,selection,zoomScroll,copyPaste,canvas,rules,mouseTracking){this._actions={undo:function undo(){commandStack.undo();},redo:function redo(){commandStack.redo();},copy:function copy(){var selectedElements=selection.get();copyPaste.copy(selectedElements);},paste:function paste(){var context=mouseTracking.getHoverContext();copyPaste.paste(context);},stepZoom:function stepZoom(opts){zoomScroll.stepZoom(opts.value);},zoom:function zoom(opts){canvas.zoom(opts.value);},removeSelection:function removeSelection(){var selectedElements=selection.get();if(selectedElements.length){var allowed=rules.allowed('elements.delete',{elements:selectedElements}),removableElements;if(allowed===!1)return;else(0,_minDash.isArray)(allowed)?removableElements=allowed:removableElements=selectedElements;removableElements.length&&modeling.removeElements(removableElements.slice());}},moveCanvas:function moveCanvas(opts){var dx=0,dy=0,invertY=opts.invertY,speed=opts.speed;var actualSpeed=speed/Math.min(Math.sqrt(canvas.viewbox().scale),1);switch(opts.direction){case'left':dx=actualSpeed;break;case'up':dy=actualSpeed;break;case'right':dx=-actualSpeed;break;case'down':dy=-actualSpeed;break;}dy&&invertY&&(dy=-dy),canvas.scroll({dx:dx,dy:dy});}};}function error(action,message){return new Error(action+' '+message);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=EditorActions;var _minDash=require('min-dash');var NOT_REGISTERED_ERROR='is not a registered action',IS_REGISTERED_ERROR='is already registered';EditorActions.$inject=['eventBus','commandStack','modeling','selection','zoomScroll','copyPaste','canvas','rules','mouseTracking'],EditorActions.prototype.trigger=function(action,opts){if(!this._actions[action])throw error(action,NOT_REGISTERED_ERROR);return this._actions[action](opts);},EditorActions.prototype.register=function(actions,listener){var self=this;if(typeof actions==='string')return this._registerAction(actions,listener);(0,_minDash.forEach)(actions,function(listener,action){self._registerAction(action,listener);});},EditorActions.prototype._registerAction=function(action,listener){if(this.isRegistered(action))throw error(action,IS_REGISTERED_ERROR);this._actions[action]=listener;},EditorActions.prototype.unregister=function(action){if(!this.isRegistered(action))throw error(action,NOT_REGISTERED_ERROR);this._actions[action]=undefined;},EditorActions.prototype.length=function(){return Object.keys(this._actions).length;},EditorActions.prototype.isRegistered=function(action){return!!this._actions[action];};},{'min-dash':438}],230:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _selection=require('../selection');var _selection2=_interopRequireDefault(_selection);var _copyPaste=require('../copy-paste');var _copyPaste2=_interopRequireDefault(_copyPaste);var _zoomscroll=require('../../navigation/zoomscroll');var _zoomscroll2=_interopRequireDefault(_zoomscroll);var _EditorActions=require('./EditorActions');var _EditorActions2=_interopRequireDefault(_EditorActions);exports.default={__depends__:[_selection2.default,_copyPaste2.default,_zoomscroll2.default],__init__:['editorActions'],editorActions:['type',_EditorActions2.default]};},{'../../navigation/zoomscroll':325,'../copy-paste':221,'../selection':298,'./EditorActions':229}],231:[function(require,module,exports){'use strict';function GlobalConnect(eventBus,dragging,connect,canvas,toolManager){var self=this;this._dragging=dragging,toolManager.registerTool('global-connect',{tool:'global-connect',dragging:'global-connect.drag'}),eventBus.on('global-connect.hover',function(event){var context=event.context,startTarget=event.hover;var canStartConnect=context.canStartConnect=self.canStartConnect(startTarget);if(canStartConnect===null)return;context.startTarget=startTarget,canvas.addMarker(startTarget,canStartConnect?MARKER_OK:MARKER_NOT_OK);}),eventBus.on(['global-connect.out','global-connect.cleanup'],function(event){var startTarget=event.context.startTarget,canStartConnect=event.context.canStartConnect;startTarget&&canvas.removeMarker(startTarget,canStartConnect?MARKER_OK:MARKER_NOT_OK);}),eventBus.on(['global-connect.ended'],function(event){var context=event.context,startTarget=context.startTarget,startPosition={x:event.x,y:event.y};var canStartConnect=self.canStartConnect(startTarget);return canStartConnect?(eventBus.once('element.out',function(){eventBus.once(['connect.ended','connect.canceled'],function(){eventBus.fire('global-connect.drag.ended');}),connect.start(null,startTarget,startPosition);}),!1):void 0;});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=GlobalConnect;var MARKER_OK='connect-ok',MARKER_NOT_OK='connect-not-ok';GlobalConnect.$inject=['eventBus','dragging','connect','canvas','toolManager'],GlobalConnect.prototype.start=function(event){this._dragging.init(event,'global-connect',{trapClick:!1,data:{context:{}}});},GlobalConnect.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.start();},GlobalConnect.prototype.isActive=function(){var context=this._dragging.context();return context&&/^global-connect/.test(context.prefix);},GlobalConnect.prototype.registerProvider=function(provider){this._provider=provider;},GlobalConnect.prototype.canStartConnect=function(startTarget){return this._provider.canStartConnect(startTarget);};},{}],232:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _connect=require('../connect');var _connect2=_interopRequireDefault(_connect);var _rules=require('../rules');var _rules2=_interopRequireDefault(_rules);var _dragging=require('../dragging');var _dragging2=_interopRequireDefault(_dragging);var _toolManager=require('../tool-manager');var _toolManager2=_interopRequireDefault(_toolManager);var _GlobalConnect=require('./GlobalConnect');var _GlobalConnect2=_interopRequireDefault(_GlobalConnect);exports.default={__depends__:[_connect2.default,_rules2.default,_dragging2.default,_toolManager2.default],globalConnect:['type',_GlobalConnect2.default]};},{'../connect':217,'../dragging':228,'../rules':292,'../tool-manager':307,'./GlobalConnect':231}],233:[function(require,module,exports){'use strict';function HandTool(eventBus,canvas,dragging,toolManager){this._dragging=dragging,toolManager.registerTool('hand',{tool:'hand',dragging:'hand.move'}),eventBus.on('element.mousedown',HIGH_PRIORITY,function(event){return(0,_Mouse.hasPrimaryModifier)(event)?(this.activateMove(event.originalEvent),!1):void 0;},this),eventBus.on('hand.end',function(event){var target=event.originalEvent.target;if(!(event.hover||target instanceof SVGElement))return!1;eventBus.once('hand.ended',function(){this.activateMove(event.originalEvent,{reactivate:!0});},this);},this),eventBus.on('hand.move.move',function(event){var scale=canvas.viewbox().scale;canvas.scroll({dx:event.dx*scale,dy:event.dy*scale});}),eventBus.on('hand.move.end',function(event){var context=event.context,reactivate=context.reactivate;return!(0,_Mouse.hasPrimaryModifier)(event)&&reactivate&&eventBus.once('hand.move.ended',function(event){this.activateHand(event.originalEvent,!0,!0);},this),!1;},this);}Object.defineProperty(exports,'__esModule',{value:!0});var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj;};exports.default=HandTool;var _Mouse=require('../../util/Mouse');var HIGH_PRIORITY=1500;var HAND_CURSOR='grab';HandTool.$inject=['eventBus','canvas','dragging','toolManager'],HandTool.prototype.activateMove=function(event,autoActivate,context){(autoActivate===void 0?'undefined':_typeof(autoActivate))==='object'&&(context=autoActivate,autoActivate=!1),this._dragging.init(event,'hand.move',{autoActivate:autoActivate,cursor:HAND_CURSOR,data:{context:context||{}}});},HandTool.prototype.activateHand=function(event,autoActivate,reactivate){this._dragging.init(event,'hand',{trapClick:!1,autoActivate:autoActivate,cursor:HAND_CURSOR,data:{context:{reactivate:reactivate}}});},HandTool.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.activateHand();},HandTool.prototype.isActive=function(){var context=this._dragging.context();return context&&/^hand/.test(context.prefix);};},{'../../util/Mouse':338}],234:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _toolManager=require('../tool-manager');var _toolManager2=_interopRequireDefault(_toolManager);var _HandTool=require('./HandTool');var _HandTool2=_interopRequireDefault(_HandTool);exports.default={__depends__:[_toolManager2.default],__init__:['handTool'],handTool:['type',_HandTool2.default]};},{'../tool-manager':307,'./HandTool':233}],235:[function(require,module,exports){'use strict';function allowAll(e){return!0;}function InteractionEvents(eventBus,elementRegistry,styles){function fire(type,event,element){if(isIgnored(type,event))return;var target,gfx,returnValue;if(element?gfx=elementRegistry.getGraphics(element):(target=event.delegateTarget||event.target,target&&(gfx=target,element=elementRegistry.get(gfx))),!(gfx&&element))return;returnValue=eventBus.fire(type,{element:element,gfx:gfx,originalEvent:event}),returnValue===!1&&(event.stopPropagation(),event.preventDefault());}function mouseHandler(localEventName){return handlers[localEventName];}function isIgnored(localEventName,event){var filter=ignoredFilters[localEventName]||_Mouse.isPrimaryButton;return!filter(event);}function triggerMouseEvent(eventName,event,targetElement){var localEventName=bindings[eventName];if(!localEventName)throw new Error('unmapped DOM event name <'+eventName+'>');return fire(localEventName,event,targetElement);}function registerEvent(node,event,localEvent,ignoredFilter){var handler=handlers[localEvent]=function(event){fire(localEvent,event);};ignoredFilter&&(ignoredFilters[localEvent]=ignoredFilter),handler.$delegate=_minDom.delegate.bind(node,elementSelector,event,handler);}function unregisterEvent(node,event,localEvent){var handler=mouseHandler(localEvent);if(!handler)return;_minDom.delegate.unbind(node,event,handler.$delegate);}function registerEvents(svg){(0,_minDash.forEach)(bindings,function(val,key){registerEvent(svg,key,val);});}function unregisterEvents(svg){(0,_minDash.forEach)(bindings,function(val,key){unregisterEvent(svg,key,val);});}var HIT_STYLE=styles.cls('djs-hit',['no-fill','no-border'],{stroke:'white',strokeWidth:15});var handlers={};var bindings={mouseover:'element.hover',mouseout:'element.out',click:'element.click',dblclick:'element.dblclick',mousedown:'element.mousedown',mouseup:'element.mouseup',contextmenu:'element.contextmenu'};var ignoredFilters={'element.contextmenu':allowAll};var elementSelector='svg, .djs-element';eventBus.on('canvas.destroy',function(event){unregisterEvents(event.svg);}),eventBus.on('canvas.init',function(event){registerEvents(event.svg);}),eventBus.on(['shape.added','connection.added'],function(event){var element=event.element,gfx=event.gfx,hit;element.waypoints?hit=(0,_RenderUtil.createLine)(element.waypoints):(hit=(0,_tinySvg.create)('rect'),(0,_tinySvg.attr)(hit,{x:0,y:0,width:element.width,height:element.height})),(0,_tinySvg.attr)(hit,HIT_STYLE),(0,_tinySvg.append)(gfx,hit);}),eventBus.on('shape.changed',LOW_PRIORITY,function(event){var element=event.element,gfx=event.gfx,hit=(0,_minDom.query)('.djs-hit',gfx);(0,_tinySvg.attr)(hit,{width:element.width,height:element.height});}),eventBus.on('connection.changed',function(event){var element=event.element,gfx=event.gfx,hit=(0,_minDom.query)('.djs-hit',gfx);(0,_RenderUtil.updateLine)(hit,element.waypoints);}),this.fire=fire,this.triggerMouseEvent=triggerMouseEvent,this.mouseHandler=mouseHandler,this.registerEvent=registerEvent,this.unregisterEvent=unregisterEvent;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=InteractionEvents;var _minDash=require('min-dash');var _minDom=require('min-dom');var _Mouse=require('../../util/Mouse');var _tinySvg=require('tiny-svg');var _RenderUtil=require('../../util/RenderUtil');var LOW_PRIORITY=500;InteractionEvents.$inject=['eventBus','elementRegistry','styles'];},{'../../util/Mouse':338,'../../util/RenderUtil':342,'min-dash':438,'min-dom':439,'tiny-svg':468}],236:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _InteractionEvents=require('./InteractionEvents');var _InteractionEvents2=_interopRequireDefault(_InteractionEvents);exports.default={__init__:['interactionEvents'],interactionEvents:['type',_InteractionEvents2.default]};},{'./InteractionEvents':235}],237:[function(require,module,exports){'use strict';function Keyboard(config,eventBus,editorActions){var self=this;this._config=config||{},this._eventBus=eventBus,this._editorActions=editorActions,this._listeners=[],this._keyHandler=function(event){var i,l,target=event.target,listeners=self._listeners,code=event.keyCode||event.charCode||-1;if(target&&((0,_minDom.matches)(target,'input, textarea')||target.contentEditable==='true'))return;for(i=0;l=listeners[i];i++)l(code,event)&&(event.preventDefault(),event.stopPropagation());},eventBus.on('diagram.destroy',function(){self._fire('destroy'),self.unbind(),self._listeners=null;}),eventBus.on('diagram.init',function(){self._fire('init');}),eventBus.on('attach',function(){config&&config.bindTo&&self.bind(config.bindTo);}),eventBus.on('detach',function(){self.unbind();}),this._init();}function hasModifier(modifiers){return modifiers.ctrlKey||modifiers.metaKey||modifiers.shiftKey||modifiers.altKey;}function isCmd(modifiers){return modifiers.altKey?!1:modifiers.ctrlKey||modifiers.metaKey;}function isShift(modifiers){return modifiers.shiftKey;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=Keyboard;var _minDom=require('min-dom');Keyboard.$inject=['config.keyboard','eventBus','editorActions'],Keyboard.prototype.bind=function(node){this.unbind(),this._node=node,_minDom.event.bind(node,'keydown',this._keyHandler,!0),this._fire('bind');},Keyboard.prototype.getBinding=function(){return this._node;},Keyboard.prototype.unbind=function(){var node=this._node;node&&(this._fire('unbind'),_minDom.event.unbind(node,'keydown',this._keyHandler,!0)),this._node=null;},Keyboard.prototype._fire=function(event){this._eventBus.fire('keyboard.'+event,{node:this._node,listeners:this._listeners});},Keyboard.prototype._init=function(){function undo(key,modifiers){return isCmd(modifiers)&&!isShift(modifiers)&&key===90?(editorActions.trigger('undo'),!0):void 0;}function redo(key,modifiers){return isCmd(modifiers)&&(key===89||key===90&&isShift(modifiers))?(editorActions.trigger('redo'),!0):void 0;}function copy(key,modifiers){return isCmd(modifiers)&&key===67?(editorActions.trigger('copy'),!0):void 0;}function paste(key,modifiers){return isCmd(modifiers)&&key===86?(editorActions.trigger('paste'),!0):void 0;}function zoomIn(key,modifiers){return(key===107||key===187||key===171||key===61)&&isCmd(modifiers)?(editorActions.trigger('stepZoom',{value:1}),!0):void 0;}function zoomOut(key,modifiers){return(key===109||key===189||key===173)&&isCmd(modifiers)?(editorActions.trigger('stepZoom',{value:-1}),!0):void 0;}function zoomDefault(key,modifiers){return(key===96||key===48)&&isCmd(modifiers)?(editorActions.trigger('zoom',{value:1}),!0):void 0;}function removeSelection(key,modifiers){return key===46?(editorActions.trigger('removeSelection'),!0):void 0;}function moveCanvas(key,modifiers){if([37,38,39,40].indexOf(key)>=0){var opts={invertY:config.invertY,speed:config.speed||50};switch(key){case 37:opts.direction='left';break;case 38:opts.direction='up';break;case 39:opts.direction='right';break;case 40:opts.direction='down';break;}return editorActions.trigger('moveCanvas',opts),!0;}}var listeners=this._listeners;var editorActions=this._editorActions,config=this._config;listeners.push(undo),listeners.push(redo),listeners.push(copy),listeners.push(paste),listeners.push(removeSelection),listeners.push(zoomIn),listeners.push(zoomOut),listeners.push(zoomDefault),listeners.push(moveCanvas);},Keyboard.prototype.addListener=function(listenerFn){this._listeners.push(listenerFn);},Keyboard.prototype.hasModifier=hasModifier,Keyboard.prototype.isCmd=isCmd,Keyboard.prototype.isShift=isShift;},{'min-dom':439}],238:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _Keyboard=require('./Keyboard');var _Keyboard2=_interopRequireDefault(_Keyboard);exports.default={__init__:['keyboard'],keyboard:['type',_Keyboard2.default]};},{'./Keyboard':237}],239:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function LabelSupport(injector,eventBus,modeling){_CommandInterceptor2.default.call(this,eventBus);var movePreview=injector.get('movePreview',!1);eventBus.on('shape.move.start',HIGH_PRIORITY,function(e){var context=e.context,shapes=context.shapes,validatedShapes=context.validatedShapes;context.shapes=removeLabels(shapes),context.validatedShapes=removeLabels(validatedShapes);}),movePreview&&eventBus.on('shape.move.start',LOW_PRIORITY,function(e){var context=e.context,shapes=context.shapes;var labels=[];(0,_minDash.forEach)(shapes,function(element){var label=element.label;label&&!label.hidden&&context.shapes.indexOf(label)===-1&&labels.push(label),element.labelTarget&&labels.push(element);}),(0,_minDash.forEach)(labels,function(label){movePreview.makeDraggable(context,label,!0);});}),this.postExecute('elements.move',HIGH_PRIORITY,function(e){var context=e.context,closure=context.closure,enclosedElements=closure.enclosedElements;context.enclosedLabels=(0,_minDash.map)(enclosedElements,function(element){var label=element.label;return label&&!enclosedElements[label.id]?[label,(0,_LayoutUtil.getMid)(label)]:null;}).filter(function(s){return s;});}),this.postExecuted('elements.move',function(e){var context=e.context,labels=context.enclosedLabels,delta=context.delta;(0,_minDash.forEach)(labels,function(entry){var label=entry[0];var mid=entry[1];var currentMid=(0,_LayoutUtil.getMid)(label);currentMid.x===mid.x&&currentMid.y===mid.y&&modeling.moveShape(label,delta,label.labelTarget.parent);});});}function removeLabels(elements){return(0,_minDash.filter)(elements,function(element){return elements.indexOf(element.labelTarget)===-1;});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=LabelSupport;var _minDash=require('min-dash');var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _LayoutUtil=require('../../layout/LayoutUtil');var _CommandInterceptor=require('../../command/CommandInterceptor');var _CommandInterceptor2=_interopRequireDefault(_CommandInterceptor);var LOW_PRIORITY=250,HIGH_PRIORITY=1400;(0,_inherits2.default)(LabelSupport,_CommandInterceptor2.default),LabelSupport.$inject=['injector','eventBus','modeling'];},{'../../command/CommandInterceptor':185,'../../layout/LayoutUtil':317,inherits:350,'min-dash':438}],240:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _LabelSupport=require('./LabelSupport');var _LabelSupport2=_interopRequireDefault(_LabelSupport);exports.default={__init__:['labelSupport'],labelSupport:['type',_LabelSupport2.default]};},{'./LabelSupport':239}],241:[function(require,module,exports){'use strict';function LassoTool(eventBus,canvas,dragging,elementRegistry,selection,toolManager){this._selection=selection,this._dragging=dragging;var self=this;var visuals={create:function create(context){var container=canvas.getDefaultLayer(),frame;frame=context.frame=(0,_tinySvg.create)('rect'),(0,_tinySvg.attr)(frame,{class:'djs-lasso-overlay',width:1,height:1,x:0,y:0}),(0,_tinySvg.append)(container,frame);},update:function update(context){var frame=context.frame,bbox=context.bbox;(0,_tinySvg.attr)(frame,{x:bbox.x,y:bbox.y,width:bbox.width,height:bbox.height});},remove:function remove(context){context.frame&&(0,_tinySvg.remove)(context.frame);}};toolManager.registerTool('lasso',{tool:'lasso.selection',dragging:'lasso'}),eventBus.on('lasso.selection.end',function(event){var target=event.originalEvent.target;if(!(event.hover||target instanceof SVGElement))return;eventBus.once('lasso.selection.ended',function(){self.activateLasso(event.originalEvent,!0);});}),eventBus.on('lasso.end',function(event){var bbox=toBBox(event);var elements=elementRegistry.filter(function(element){return element;});self.select(elements,bbox);}),eventBus.on('lasso.start',function(event){var context=event.context;context.bbox=toBBox(event),visuals.create(context);}),eventBus.on('lasso.move',function(event){var context=event.context;context.bbox=toBBox(event),visuals.update(context);}),eventBus.on('lasso.cleanup',function(event){var context=event.context;visuals.remove(context);}),eventBus.on('element.mousedown',1500,function(event){return(0,_Mouse.hasSecondaryModifier)(event)?(self.activateLasso(event.originalEvent),!0):void 0;});}function toBBox(event){var start={x:event.x-event.dx,y:event.y-event.dy};var end={x:event.x,y:event.y};var bbox;return start.x<=end.x&&start.y<end.y||start.x<end.x&&start.y<=end.y?bbox={x:start.x,y:start.y,width:end.x-start.x,height:end.y-start.y}:start.x>=end.x&&start.y<end.y||start.x>end.x&&start.y<=end.y?bbox={x:end.x,y:start.y,width:start.x-end.x,height:end.y-start.y}:start.x<=end.x&&start.y>end.y||start.x<end.x&&start.y>=end.y?bbox={x:start.x,y:end.y,width:end.x-start.x,height:start.y-end.y}:start.x>=end.x&&start.y>end.y||start.x>end.x&&start.y>=end.y?bbox={x:end.x,y:end.y,width:start.x-end.x,height:start.y-end.y}:bbox={x:end.x,y:end.y,width:0,height:0},bbox;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=LassoTool;var _minDash=require('min-dash');var _Elements=require('../../util/Elements');var _Mouse=require('../../util/Mouse');var _tinySvg=require('tiny-svg');var LASSO_TOOL_CURSOR='crosshair';LassoTool.$inject=['eventBus','canvas','dragging','elementRegistry','selection','toolManager'],LassoTool.prototype.activateLasso=function(event,autoActivate){this._dragging.init(event,'lasso',{autoActivate:autoActivate,cursor:LASSO_TOOL_CURSOR,data:{context:{}}});},LassoTool.prototype.activateSelection=function(event){this._dragging.init(event,'lasso.selection',{trapClick:!1,cursor:LASSO_TOOL_CURSOR,data:{context:{}}});},LassoTool.prototype.select=function(elements,bbox){var selectedElements=(0,_Elements.getEnclosedElements)(elements,bbox);this._selection.select((0,_minDash.values)(selectedElements));},LassoTool.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.activateSelection();},LassoTool.prototype.isActive=function(){var context=this._dragging.context();return context&&/^lasso/.test(context.prefix);};},{'../../util/Elements':331,'../../util/Mouse':338,'min-dash':438,'tiny-svg':468}],242:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _toolManager=require('../tool-manager');var _toolManager2=_interopRequireDefault(_toolManager);var _LassoTool=require('./LassoTool');var _LassoTool2=_interopRequireDefault(_LassoTool);exports.default={__depends__:[_toolManager2.default],__init__:['lassoTool'],lassoTool:['type',_LassoTool2.default]};},{'../tool-manager':307,'./LassoTool':241}],243:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function Modeling(eventBus,elementFactory,commandStack){this._eventBus=eventBus,this._elementFactory=elementFactory,this._commandStack=commandStack;var self=this;eventBus.on('diagram.init',function(){self.registerHandlers(commandStack);});}Object.defineProperty(exports,'__esModule',{value:!0});var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj;};exports.default=Modeling;var _minDash=require('min-dash');var _model=require('../../model');var _AppendShapeHandler=require('./cmd/AppendShapeHandler');var _AppendShapeHandler2=_interopRequireDefault(_AppendShapeHandler);var _CreateShapeHandler=require('./cmd/CreateShapeHandler');var _CreateShapeHandler2=_interopRequireDefault(_CreateShapeHandler);var _DeleteShapeHandler=require('./cmd/DeleteShapeHandler');var _DeleteShapeHandler2=_interopRequireDefault(_DeleteShapeHandler);var _MoveShapeHandler=require('./cmd/MoveShapeHandler');var _MoveShapeHandler2=_interopRequireDefault(_MoveShapeHandler);var _ResizeShapeHandler=require('./cmd/ResizeShapeHandler');var _ResizeShapeHandler2=_interopRequireDefault(_ResizeShapeHandler);var _ReplaceShapeHandler=require('./cmd/ReplaceShapeHandler');var _ReplaceShapeHandler2=_interopRequireDefault(_ReplaceShapeHandler);var _ToggleShapeCollapseHandler=require('./cmd/ToggleShapeCollapseHandler');var _ToggleShapeCollapseHandler2=_interopRequireDefault(_ToggleShapeCollapseHandler);var _SpaceToolHandler=require('./cmd/SpaceToolHandler');var _SpaceToolHandler2=_interopRequireDefault(_SpaceToolHandler);var _CreateLabelHandler=require('./cmd/CreateLabelHandler');var _CreateLabelHandler2=_interopRequireDefault(_CreateLabelHandler);var _CreateConnectionHandler=require('./cmd/CreateConnectionHandler');var _CreateConnectionHandler2=_interopRequireDefault(_CreateConnectionHandler);var _DeleteConnectionHandler=require('./cmd/DeleteConnectionHandler');var _DeleteConnectionHandler2=_interopRequireDefault(_DeleteConnectionHandler);var _MoveConnectionHandler=require('./cmd/MoveConnectionHandler');var _MoveConnectionHandler2=_interopRequireDefault(_MoveConnectionHandler);var _LayoutConnectionHandler=require('./cmd/LayoutConnectionHandler');var _LayoutConnectionHandler2=_interopRequireDefault(_LayoutConnectionHandler);var _UpdateWaypointsHandler=require('./cmd/UpdateWaypointsHandler');var _UpdateWaypointsHandler2=_interopRequireDefault(_UpdateWaypointsHandler);var _ReconnectConnectionHandler=require('./cmd/ReconnectConnectionHandler');var _ReconnectConnectionHandler2=_interopRequireDefault(_ReconnectConnectionHandler);var _MoveElementsHandler=require('./cmd/MoveElementsHandler');var _MoveElementsHandler2=_interopRequireDefault(_MoveElementsHandler);var _DeleteElementsHandler=require('./cmd/DeleteElementsHandler');var _DeleteElementsHandler2=_interopRequireDefault(_DeleteElementsHandler);var _DistributeElementsHandler=require('./cmd/DistributeElementsHandler');var _DistributeElementsHandler2=_interopRequireDefault(_DistributeElementsHandler);var _AlignElementsHandler=require('./cmd/AlignElementsHandler');var _AlignElementsHandler2=_interopRequireDefault(_AlignElementsHandler);var _UpdateAttachmentHandler=require('./cmd/UpdateAttachmentHandler');var _UpdateAttachmentHandler2=_interopRequireDefault(_UpdateAttachmentHandler);var _PasteHandler=require('./cmd/PasteHandler');var _PasteHandler2=_interopRequireDefault(_PasteHandler);Modeling.$inject=['eventBus','elementFactory','commandStack'],Modeling.prototype.getHandlers=function(){return{'shape.append':_AppendShapeHandler2.default,'shape.create':_CreateShapeHandler2.default,'shape.delete':_DeleteShapeHandler2.default,'shape.move':_MoveShapeHandler2.default,'shape.resize':_ResizeShapeHandler2.default,'shape.replace':_ReplaceShapeHandler2.default,'shape.toggleCollapse':_ToggleShapeCollapseHandler2.default,spaceTool:_SpaceToolHandler2.default,'label.create':_CreateLabelHandler2.default,'connection.create':_CreateConnectionHandler2.default,'connection.delete':_DeleteConnectionHandler2.default,'connection.move':_MoveConnectionHandler2.default,'connection.layout':_LayoutConnectionHandler2.default,'connection.updateWaypoints':_UpdateWaypointsHandler2.default,'connection.reconnectStart':_ReconnectConnectionHandler2.default,'connection.reconnectEnd':_ReconnectConnectionHandler2.default,'elements.move':_MoveElementsHandler2.default,'elements.delete':_DeleteElementsHandler2.default,'elements.distribute':_DistributeElementsHandler2.default,'elements.align':_AlignElementsHandler2.default,'element.updateAttachment':_UpdateAttachmentHandler2.default,'elements.paste':_PasteHandler2.default};},Modeling.prototype.registerHandlers=function(commandStack){(0,_minDash.forEach)(this.getHandlers(),function(handler,id){commandStack.registerHandler(id,handler);});},Modeling.prototype.moveShape=function(shape,delta,newParent,newParentIndex,hints){(newParentIndex===void 0?'undefined':_typeof(newParentIndex))==='object'&&(hints=newParentIndex,newParentIndex=null);var context={shape:shape,delta:delta,newParent:newParent,newParentIndex:newParentIndex,hints:hints||{}};this._commandStack.execute('shape.move',context);},Modeling.prototype.updateAttachment=function(shape,newHost){var context={shape:shape,newHost:newHost};this._commandStack.execute('element.updateAttachment',context);},Modeling.prototype.moveElements=function(shapes,delta,target,hints){hints=hints||{};var attach=hints.attach;var newParent=target,newHost;attach===!0?(newHost=target,newParent=target.parent):attach===!1&&(newHost=null);var context={shapes:shapes,delta:delta,newParent:newParent,newHost:newHost,hints:hints};this._commandStack.execute('elements.move',context);},Modeling.prototype.moveConnection=function(connection,delta,newParent,newParentIndex,hints){(newParentIndex===void 0?'undefined':_typeof(newParentIndex))==='object'&&(hints=newParentIndex,newParentIndex=undefined);var context={connection:connection,delta:delta,newParent:newParent,newParentIndex:newParentIndex,hints:hints||{}};this._commandStack.execute('connection.move',context);},Modeling.prototype.layoutConnection=function(connection,hints){var context={connection:connection,hints:hints||{}};this._commandStack.execute('connection.layout',context);},Modeling.prototype.createConnection=function(source,target,parentIndex,connection,parent,hints){(parentIndex===void 0?'undefined':_typeof(parentIndex))==='object'&&(hints=parent,parent=connection,connection=parentIndex,parentIndex=undefined),connection=this._create('connection',connection);var context={source:source,target:target,parent:parent,parentIndex:parentIndex,connection:connection,hints:hints};return this._commandStack.execute('connection.create',context),context.connection;},Modeling.prototype.createShape=function(shape,position,target,parentIndex,hints){typeof parentIndex!=='number'&&(hints=parentIndex,parentIndex=undefined),hints=hints||{};var attach=hints.attach,parent,host;shape=this._create('shape',shape),attach?(parent=target.parent,host=target):parent=target;var context={position:position,shape:shape,parent:parent,parentIndex:parentIndex,host:host,hints:hints};return this._commandStack.execute('shape.create',context),context.shape;},Modeling.prototype.createLabel=function(labelTarget,position,label,parent){label=this._create('label',label);var context={labelTarget:labelTarget,position:position,parent:parent||labelTarget.parent,shape:label};return this._commandStack.execute('label.create',context),context.shape;},Modeling.prototype.appendShape=function(source,shape,position,target,hints){hints=hints||{},shape=this._create('shape',shape);var context={source:source,position:position,target:target,shape:shape,connection:hints.connection,connectionParent:hints.connectionParent,attach:hints.attach};return this._commandStack.execute('shape.append',context),context.shape;},Modeling.prototype.removeElements=function(elements){var context={elements:elements};this._commandStack.execute('elements.delete',context);},Modeling.prototype.distributeElements=function(groups,axis,dimension){var context={groups:groups,axis:axis,dimension:dimension};this._commandStack.execute('elements.distribute',context);},Modeling.prototype.removeShape=function(shape,hints){var context={shape:shape,hints:hints||{}};this._commandStack.execute('shape.delete',context);},Modeling.prototype.removeConnection=function(connection,hints){var context={connection:connection,hints:hints||{}};this._commandStack.execute('connection.delete',context);},Modeling.prototype.replaceShape=function(oldShape,newShape,hints){var context={oldShape:oldShape,newData:newShape,hints:hints||{}};return this._commandStack.execute('shape.replace',context),context.newShape;},Modeling.prototype.pasteElements=function(tree,topParent,position){var context={tree:tree,topParent:topParent,position:position};this._commandStack.execute('elements.paste',context);},Modeling.prototype.alignElements=function(elements,alignment){var context={elements:elements,alignment:alignment};this._commandStack.execute('elements.align',context);},Modeling.prototype.resizeShape=function(shape,newBounds,minBounds){var context={shape:shape,newBounds:newBounds,minBounds:minBounds};this._commandStack.execute('shape.resize',context);},Modeling.prototype.createSpace=function(movingShapes,resizingShapes,delta,direction){var context={movingShapes:movingShapes,resizingShapes:resizingShapes,delta:delta,direction:direction};this._commandStack.execute('spaceTool',context);},Modeling.prototype.updateWaypoints=function(connection,newWaypoints,hints){var context={connection:connection,newWaypoints:newWaypoints,hints:hints||{}};this._commandStack.execute('connection.updateWaypoints',context);},Modeling.prototype.reconnectStart=function(connection,newSource,dockingOrPoints){var context={connection:connection,newSource:newSource,dockingOrPoints:dockingOrPoints};this._commandStack.execute('connection.reconnectStart',context);},Modeling.prototype.reconnectEnd=function(connection,newTarget,dockingOrPoints){var context={connection:connection,newTarget:newTarget,dockingOrPoints:dockingOrPoints};this._commandStack.execute('connection.reconnectEnd',context);},Modeling.prototype.connect=function(source,target,attrs,hints){return this.createConnection(source,target,attrs||{},source.parent,hints);},Modeling.prototype._create=function(type,attrs){return attrs instanceof _model.Base?attrs:this._elementFactory.create(type,attrs);},Modeling.prototype.toggleCollapse=function(shape,hints){var context={shape:shape,hints:hints||{}};this._commandStack.execute('shape.toggleCollapse',context);};},{'../../model':319,'./cmd/AlignElementsHandler':244,'./cmd/AppendShapeHandler':245,'./cmd/CreateConnectionHandler':246,'./cmd/CreateLabelHandler':247,'./cmd/CreateShapeHandler':248,'./cmd/DeleteConnectionHandler':249,'./cmd/DeleteElementsHandler':250,'./cmd/DeleteShapeHandler':251,'./cmd/DistributeElementsHandler':252,'./cmd/LayoutConnectionHandler':253,'./cmd/MoveConnectionHandler':254,'./cmd/MoveElementsHandler':255,'./cmd/MoveShapeHandler':256,'./cmd/PasteHandler':257,'./cmd/ReconnectConnectionHandler':258,'./cmd/ReplaceShapeHandler':259,'./cmd/ResizeShapeHandler':260,'./cmd/SpaceToolHandler':261,'./cmd/ToggleShapeCollapseHandler':262,'./cmd/UpdateAttachmentHandler':263,'./cmd/UpdateWaypointsHandler':264,'min-dash':438}],244:[function(require,module,exports){'use strict';function AlignElements(modeling,canvas){this._modeling=modeling,this._canvas=canvas;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=AlignElements;var _minDash=require('min-dash');AlignElements.$inject=['modeling','canvas'],AlignElements.prototype.preExecute=function(context){var modeling=this._modeling;var elements=context.elements,alignment=context.alignment;(0,_minDash.forEach)(elements,function(element){var delta={x:0,y:0};alignment.left?delta.x=alignment.left-element.x:alignment.right?delta.x=alignment.right-element.width-element.x:alignment.center?delta.x=alignment.center-Math.round(element.width/2)-element.x:alignment.top?delta.y=alignment.top-element.y:alignment.bottom?delta.y=alignment.bottom-element.height-element.y:alignment.middle&&(delta.y=alignment.middle-Math.round(element.height/2)-element.y),modeling.moveElements([element],delta,element.parent);});},AlignElements.prototype.postExecute=function(context){};},{'min-dash':438}],245:[function(require,module,exports){'use strict';function AppendShapeHandler(modeling){this._modeling=modeling;}function existsConnection(source,target){return(0,_minDash.some)(source.outgoing,function(c){return c.target===target;});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=AppendShapeHandler;var _minDash=require('min-dash');AppendShapeHandler.$inject=['modeling'],AppendShapeHandler.prototype.preExecute=function(context){var source=context.source;if(!source)throw new Error('source required');var target=context.target||source.parent,shape=context.shape;shape=context.shape=this._modeling.createShape(shape,context.position,target,{attach:context.attach}),context.shape=shape;},AppendShapeHandler.prototype.postExecute=function(context){var parent=context.connectionParent||context.shape.parent;existsConnection(context.source,context.shape)||this._modeling.connect(context.source,context.shape,context.connection,parent);};},{'min-dash':438}],246:[function(require,module,exports){'use strict';function CreateConnectionHandler(canvas,layouter){this._canvas=canvas,this._layouter=layouter;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=CreateConnectionHandler,CreateConnectionHandler.$inject=['canvas','layouter'],CreateConnectionHandler.prototype.execute=function(context){var connection=context.connection,source=context.source,target=context.target,parent=context.parent,parentIndex=context.parentIndex,hints=context.hints;if(!(source&&target))throw new Error('source and target required');if(!parent)throw new Error('parent required');return connection.source=source,connection.target=target,connection.waypoints||(connection.waypoints=this._layouter.layoutConnection(connection,hints)),this._canvas.addConnection(connection,parent,parentIndex),connection;},CreateConnectionHandler.prototype.revert=function(context){var connection=context.connection;this._canvas.removeConnection(connection),connection.source=null,connection.target=null;};},{}],247:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function CreateLabelHandler(canvas){_CreateShapeHandler2.default.call(this,canvas);}function ensureValidDimensions(label){['width','height'].forEach(function(prop){label[prop]===void 0&&(label[prop]=0);});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=CreateLabelHandler;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _CreateShapeHandler=require('./CreateShapeHandler');var _CreateShapeHandler2=_interopRequireDefault(_CreateShapeHandler);(0,_inherits2.default)(CreateLabelHandler,_CreateShapeHandler2.default),CreateLabelHandler.$inject=['canvas'];var originalExecute=_CreateShapeHandler2.default.prototype.execute;CreateLabelHandler.prototype.execute=function(context){var label=context.shape;return ensureValidDimensions(label),label.labelTarget=context.labelTarget,originalExecute.call(this,context);};var originalRevert=_CreateShapeHandler2.default.prototype.revert;CreateLabelHandler.prototype.revert=function(context){return context.shape.labelTarget=null,originalRevert.call(this,context);};},{'./CreateShapeHandler':248,inherits:350}],248:[function(require,module,exports){'use strict';function CreateShapeHandler(canvas){this._canvas=canvas;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=CreateShapeHandler;var _minDash=require('min-dash');var round=Math.round;CreateShapeHandler.$inject=['canvas'],CreateShapeHandler.prototype.execute=function(context){var shape=context.shape,positionOrBounds=context.position,parent=context.parent,parentIndex=context.parentIndex;if(!parent)throw new Error('parent required');if(!positionOrBounds)throw new Error('position required');return positionOrBounds.width!==undefined?(0,_minDash.assign)(shape,positionOrBounds):(0,_minDash.assign)(shape,{x:positionOrBounds.x-round(shape.width/2),y:positionOrBounds.y-round(shape.height/2)}),this._canvas.addShape(shape,parent,parentIndex),shape;},CreateShapeHandler.prototype.revert=function(context){this._canvas.removeShape(context.shape);};},{'min-dash':438}],249:[function(require,module,exports){'use strict';function DeleteConnectionHandler(canvas,modeling){this._canvas=canvas,this._modeling=modeling;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=DeleteConnectionHandler;var _Collections=require('../../../util/Collections');DeleteConnectionHandler.$inject=['canvas','modeling'],DeleteConnectionHandler.prototype.preExecute=function(context){var connection=context.connection;connection.label&&this._modeling.removeShape(connection.label);},DeleteConnectionHandler.prototype.execute=function(context){var connection=context.connection,parent=connection.parent;return context.parent=parent,context.parentIndex=(0,_Collections.indexOf)(parent.children,connection),context.source=connection.source,context.target=connection.target,this._canvas.removeConnection(connection),connection.source=null,connection.target=null,connection.label=null,connection;},DeleteConnectionHandler.prototype.revert=function(context){var connection=context.connection,parent=context.parent,parentIndex=context.parentIndex;return connection.source=context.source,connection.target=context.target,(0,_Collections.add)(parent.children,connection,parentIndex),this._canvas.addConnection(connection,parent),connection;};},{'../../../util/Collections':328}],250:[function(require,module,exports){'use strict';function DeleteElementsHandler(modeling,elementRegistry){this._modeling=modeling,this._elementRegistry=elementRegistry;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=DeleteElementsHandler;var _minDash=require('min-dash');DeleteElementsHandler.$inject=['modeling','elementRegistry'],DeleteElementsHandler.prototype.postExecute=function(context){var modeling=this._modeling,elementRegistry=this._elementRegistry,elements=context.elements;(0,_minDash.forEach)(elements,function(element){if(!elementRegistry.get(element.id))return;element.waypoints?modeling.removeConnection(element):modeling.removeShape(element);});};},{'min-dash':438}],251:[function(require,module,exports){'use strict';function DeleteShapeHandler(canvas,modeling){this._canvas=canvas,this._modeling=modeling;}function isConnection(element){return element.waypoints;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=DeleteShapeHandler;var _Collections=require('../../../util/Collections');var _Removal=require('../../../util/Removal');DeleteShapeHandler.$inject=['canvas','modeling'],DeleteShapeHandler.prototype.preExecute=function(context){var modeling=this._modeling;var shape=context.shape,label=shape.label;shape.labelTarget&&(context.labelTarget=shape.labelTarget,shape.labelTarget=null),label&&this._modeling.removeShape(label,{nested:!0}),(0,_Removal.saveClear)(shape.incoming,function(connection){modeling.removeConnection(connection,{nested:!0});}),(0,_Removal.saveClear)(shape.outgoing,function(connection){modeling.removeConnection(connection,{nested:!0});}),(0,_Removal.saveClear)(shape.children,function(child){isConnection(child)?modeling.removeConnection(child,{nested:!0}):modeling.removeShape(child,{nested:!0});});},DeleteShapeHandler.prototype.execute=function(context){var canvas=this._canvas;var shape=context.shape,oldParent=shape.parent;return context.oldParent=oldParent,context.oldParentIndex=(0,_Collections.indexOf)(oldParent.children,shape),shape.label=null,canvas.removeShape(shape),shape;},DeleteShapeHandler.prototype.revert=function(context){var canvas=this._canvas;var shape=context.shape,oldParent=context.oldParent,oldParentIndex=context.oldParentIndex,labelTarget=context.labelTarget;return(0,_Collections.add)(oldParent.children,shape,oldParentIndex),labelTarget&&(labelTarget.label=shape),canvas.addShape(shape,oldParent),shape;};},{'../../../util/Collections':328,'../../../util/Removal':341}],252:[function(require,module,exports){'use strict';function DistributeElements(modeling){this._modeling=modeling;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=DistributeElements;var _minDash=require('min-dash');DistributeElements.$inject=['modeling'];var OFF_AXIS={x:'y',y:'x'};DistributeElements.prototype.preExecute=function(context){function updateRange(group,element){group.range.min=Math.min(element[axis],group.range.min),group.range.max=Math.max(element[axis]+element[dimension],group.range.max);}function center(element){return element[axis]+element[dimension]/2;}function lastIdx(arr){return arr.length-1;}function rangeDiff(range){return range.max-range.min;}function centerElement(refCenter,element){var delta={y:0};delta[axis]=refCenter-center(element),delta[axis]&&(delta[OFF_AXIS[axis]]=0,modeling.moveElements([element],delta,element.parent));}var modeling=this._modeling;var groups=context.groups,axis=context.axis,dimension=context.dimension;var firstGroup=groups[0],lastGroupIdx=lastIdx(groups),lastGroup=groups[lastGroupIdx];var margin,spaceInBetween,groupsSize=0;if((0,_minDash.forEach)(groups,function(group,idx){var sortedElements,refElem,refCenter;if(group.elements.length<2){idx&&idx!==groups.length-1&&(updateRange(group,group.elements[0]),groupsSize+=rangeDiff(group.range));return;}sortedElements=(0,_minDash.sortBy)(group.elements,axis),refElem=sortedElements[0],idx===lastGroupIdx&&(refElem=sortedElements[lastIdx(sortedElements)]),refCenter=center(refElem),group.range=null,(0,_minDash.forEach)(sortedElements,function(element){if(centerElement(refCenter,element),group.range===null){group.range={min:element[axis],max:element[axis]+element[dimension]};return;}updateRange(group,element);}),idx&&idx!==groups.length-1&&(groupsSize+=rangeDiff(group.range));}),spaceInBetween=Math.abs(lastGroup.range.min-firstGroup.range.max),margin=Math.round((spaceInBetween-groupsSize)/(groups.length-1)),margin<groups.length-1)return;(0,_minDash.forEach)(groups,function(group,groupIdx){var delta={},prevGroup;if(group===firstGroup||group===lastGroup)return;prevGroup=groups[groupIdx-1],group.range.max=0,(0,_minDash.forEach)(group.elements,function(element,idx){delta[OFF_AXIS[axis]]=0,delta[axis]=prevGroup.range.max-element[axis]+margin,group.range.min!==element[axis]&&(delta[axis]+=element[axis]-group.range.min),delta[axis]&&modeling.moveElements([element],delta,element.parent),group.range.max=Math.max(element[axis]+element[dimension],idx?group.range.max:0);});});},DistributeElements.prototype.postExecute=function(context){};},{'min-dash':438}],253:[function(require,module,exports){'use strict';function LayoutConnectionHandler(layouter,canvas){this._layouter=layouter,this._canvas=canvas;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=LayoutConnectionHandler;var _minDash=require('min-dash');LayoutConnectionHandler.$inject=['layouter','canvas'],LayoutConnectionHandler.prototype.execute=function(context){var connection=context.connection;var oldWaypoints=connection.waypoints;return(0,_minDash.assign)(context,{oldWaypoints:oldWaypoints}),connection.waypoints=this._layouter.layoutConnection(connection,context.hints),connection;},LayoutConnectionHandler.prototype.revert=function(context){var connection=context.connection;return connection.waypoints=context.oldWaypoints,connection;};},{'min-dash':438}],254:[function(require,module,exports){'use strict';function MoveConnectionHandler(){}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=MoveConnectionHandler;var _minDash=require('min-dash');var _Collections=require('../../../util/Collections');MoveConnectionHandler.prototype.execute=function(context){var connection=context.connection,delta=context.delta;var newParent=context.newParent||connection.parent,newParentIndex=context.newParentIndex,oldParent=connection.parent;return context.oldParent=oldParent,context.oldParentIndex=(0,_Collections.remove)(oldParent.children,connection),(0,_Collections.add)(newParent.children,connection,newParentIndex),connection.parent=newParent,(0,_minDash.forEach)(connection.waypoints,function(p){p.x+=delta.x,p.y+=delta.y,p.original&&(p.original.x+=delta.x,p.original.y+=delta.y);}),connection;},MoveConnectionHandler.prototype.revert=function(context){var connection=context.connection,newParent=connection.parent,oldParent=context.oldParent,oldParentIndex=context.oldParentIndex,delta=context.delta;return(0,_Collections.remove)(newParent.children,connection),(0,_Collections.add)(oldParent.children,connection,oldParentIndex),connection.parent=oldParent,(0,_minDash.forEach)(connection.waypoints,function(p){p.x-=delta.x,p.y-=delta.y,p.original&&(p.original.x-=delta.x,p.original.y-=delta.y);}),connection;};},{'../../../util/Collections':328,'min-dash':438}],255:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function MoveElementsHandler(modeling){this._helper=new _MoveHelper2.default(modeling);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=MoveElementsHandler;var _MoveHelper=require('./helper/MoveHelper');var _MoveHelper2=_interopRequireDefault(_MoveHelper);MoveElementsHandler.$inject=['modeling'],MoveElementsHandler.prototype.preExecute=function(context){context.closure=this._helper.getClosure(context.shapes);},MoveElementsHandler.prototype.postExecute=function(context){var hints=context.hints,primaryShape;hints&&hints.primaryShape&&(primaryShape=hints.primaryShape,hints.oldParent=primaryShape.parent),this._helper.moveClosure(context.closure,context.delta,context.newParent,context.newHost,primaryShape);};},{'./helper/MoveHelper':266}],256:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function MoveShapeHandler(modeling){this._modeling=modeling,this._helper=new _MoveHelper2.default(modeling);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=MoveShapeHandler;var _minDash=require('min-dash');var _MoveHelper=require('./helper/MoveHelper');var _MoveHelper2=_interopRequireDefault(_MoveHelper);var _Collections=require('../../../util/Collections');var _AnchorsHelper=require('./helper/AnchorsHelper');MoveShapeHandler.$inject=['modeling'],MoveShapeHandler.prototype.execute=function(context){var shape=context.shape,delta=context.delta,newParent=context.newParent||shape.parent,newParentIndex=context.newParentIndex,oldParent=shape.parent;return context.oldBounds=(0,_minDash.pick)(shape,['x','y','width','height']),context.oldParent=oldParent,context.oldParentIndex=(0,_Collections.remove)(oldParent.children,shape),(0,_Collections.add)(newParent.children,shape,newParentIndex),(0,_minDash.assign)(shape,{parent:newParent,x:shape.x+delta.x,y:shape.y+delta.y}),shape;},MoveShapeHandler.prototype.postExecute=function(context){var shape=context.shape,delta=context.delta,hints=context.hints;var modeling=this._modeling;hints.layout!==!1&&((0,_minDash.forEach)(shape.incoming,function(c){modeling.layoutConnection(c,{connectionEnd:(0,_AnchorsHelper.getMovedTargetAnchor)(c,shape,delta)});}),(0,_minDash.forEach)(shape.outgoing,function(c){modeling.layoutConnection(c,{connectionStart:(0,_AnchorsHelper.getMovedSourceAnchor)(c,shape,delta)});})),hints.recurse!==!1&&this.moveChildren(context);},MoveShapeHandler.prototype.revert=function(context){var shape=context.shape,oldParent=context.oldParent,oldParentIndex=context.oldParentIndex,delta=context.delta;return(0,_Collections.add)(oldParent.children,shape,oldParentIndex),(0,_minDash.assign)(shape,{parent:oldParent,x:shape.x-delta.x,y:shape.y-delta.y}),shape;},MoveShapeHandler.prototype.moveChildren=function(context){var delta=context.delta,shape=context.shape;this._helper.moveRecursive(shape.children,delta,null);},MoveShapeHandler.prototype.getNewParent=function(context){return context.newParent||context.shape.parent;};},{'../../../util/Collections':328,'./helper/AnchorsHelper':265,'./helper/MoveHelper':266,'min-dash':438}],257:[function(require,module,exports){'use strict';function removeProperties(element,properties){(0,_minDash.forEach)(properties,function(prop){element[prop]&&delete element[prop];});}function PasteHandler(eventBus,canvas,selection,elementFactory,modeling,rules){this._eventBus=eventBus,this._canvas=canvas,this._selection=selection,this._elementFactory=elementFactory,this._modeling=modeling,this._rules=rules;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=PasteHandler;var _minDash=require('min-dash');PasteHandler.$inject=['eventBus','canvas','selection','elementFactory','modeling','rules'],PasteHandler.prototype.preExecute=function(context){var eventBus=this._eventBus,self=this;var tree=context.tree,topParent=context.topParent,position=context.position;tree.createdElements={},tree.labels=[],(0,_minDash.forEach)(tree,function(elements,depthStr){var depth=parseInt(depthStr,10);if(isNaN(depth))return;depth||(elements=(0,_minDash.map)(elements,function(descriptor){return descriptor.parent=topParent,descriptor;})),elements=(0,_minDash.sortBy)(elements,'priority'),(0,_minDash.forEach)(elements,function(descriptor){var id=descriptor.id,parent=descriptor.parent,hints={},newPosition;var element=(0,_minDash.assign)({},descriptor);if(depth&&(element.parent=self._getCreatedElement(parent,tree)),!parent)return;if(eventBus.fire('element.paste',{createdElements:tree.createdElements,descriptor:element}),parent=element.parent,element.waypoints){element=self._createConnection(element,parent,position,tree),element&&(tree.createdElements[id]={element:element,descriptor:descriptor});return;}if(element.parent!==topParent&&(hints.root=!1),element.host&&(hints.attach=!0,parent=self._getCreatedElement(element.host,tree)),element.labelTarget)return tree.labels.push(element);newPosition={x:Math.round(position.x+element.delta.x+element.width/2),y:Math.round(position.y+element.delta.y+element.height/2)},removeProperties(element,['id','parent','delta','host','priority']),element=self._createShape(element,parent,newPosition,hints),element&&(tree.createdElements[id]={element:element,descriptor:descriptor});});});},PasteHandler.prototype.postExecute=function(context){var modeling=this._modeling,selection=this._selection,self=this;var tree=context.tree,labels=tree.labels,topLevelElements=[];(0,_minDash.forEach)(labels,function(labelDescriptor){var labelTarget=self._getCreatedElement(labelDescriptor.labelTarget,tree),label,labelTargetPos,newPosition;if(!labelTarget)return;if(label=labelTarget.label,!label)return;labelTargetPos={x:labelTarget.x,y:labelTarget.y},labelTarget.waypoints&&(labelTargetPos=labelTarget.waypoints[0]),newPosition={x:Math.round(labelTargetPos.x-label.x+labelDescriptor.delta.x),y:Math.round(labelTargetPos.y-label.y+labelDescriptor.delta.y)},modeling.moveShape(label,newPosition,labelTarget.parent);}),(0,_minDash.forEach)(tree[0],function(descriptor){var id=descriptor.id,toplevel=tree.createdElements[id];toplevel&&topLevelElements.push(toplevel.element);}),selection.select(topLevelElements);},PasteHandler.prototype._createConnection=function(element,parent,parentCenter,tree){var modeling=this._modeling,rules=this._rules;var connection,source,target,canPaste;return element.waypoints=(0,_minDash.map)(element.waypoints,function(waypoint,idx){return{x:Math.round(parentCenter.x+element.delta[idx].x),y:Math.round(parentCenter.y+element.delta[idx].y)};}),source=this._getCreatedElement(element.source,tree),target=this._getCreatedElement(element.target,tree),source&&target?(canPaste=rules.allowed('element.paste',{source:source,target:target}),canPaste?(removeProperties(element,['id','parent','delta','source','target','width','height','priority']),connection=modeling.createConnection(source,target,element,parent),connection):null):null;},PasteHandler.prototype._createShape=function(element,parent,position,isAttach,hints){var modeling=this._modeling,elementFactory=this._elementFactory,rules=this._rules;var canPaste=rules.allowed('element.paste',{element:element,position:position,parent:parent});if(!canPaste)return null;var shape=elementFactory.createShape(element);return modeling.createShape(shape,position,parent,isAttach,hints),shape;},PasteHandler.prototype._getCreatedElement=function(id,tree){return tree.createdElements[id]&&tree.createdElements[id].element;};},{'min-dash':438}],258:[function(require,module,exports){'use strict';function ReconnectConnectionHandler(){}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=ReconnectConnectionHandler;var _minDash=require('min-dash');ReconnectConnectionHandler.$inject=[],ReconnectConnectionHandler.prototype.execute=function(context){var newSource=context.newSource,newTarget=context.newTarget,connection=context.connection,dockingOrPoints=context.dockingOrPoints,oldWaypoints=connection.waypoints,newWaypoints;if(!(newSource||newTarget))throw new Error('newSource or newTarget are required');if(newSource&&newTarget)throw new Error('must specify either newSource or newTarget');return context.oldWaypoints=oldWaypoints,(0,_minDash.isArray)(dockingOrPoints)?newWaypoints=dockingOrPoints:(newWaypoints=oldWaypoints.slice(),newWaypoints.splice(newSource?0:-1,1,dockingOrPoints)),newSource&&(context.oldSource=connection.source,connection.source=newSource),newTarget&&(context.oldTarget=connection.target,connection.target=newTarget),connection.waypoints=newWaypoints,connection;},ReconnectConnectionHandler.prototype.revert=function(context){var newSource=context.newSource,newTarget=context.newTarget,connection=context.connection;return newSource&&(connection.source=context.oldSource),newTarget&&(connection.target=context.oldTarget),connection.waypoints=context.oldWaypoints,connection;};},{'min-dash':438}],259:[function(require,module,exports){'use strict';function ReplaceShapeHandler(modeling,rules){this._modeling=modeling,this._rules=rules;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=ReplaceShapeHandler;var _minDash=require('min-dash');ReplaceShapeHandler.$inject=['modeling','rules'],ReplaceShapeHandler.prototype.preExecute=function(context){function canReconnect(type,source,target,connection){return rules.allowed(type,{source:source,target:target,connection:connection});}var self=this,modeling=this._modeling,rules=this._rules;var oldShape=context.oldShape,newData=context.newData,hints=context.hints,newShape;var position={x:newData.x,y:newData.y};newShape=context.newShape=context.newShape||self.createShape(newData,position,oldShape.parent),oldShape.host&&modeling.updateAttachment(newShape,oldShape.host);var children;hints.moveChildren!==!1&&(children=oldShape.children.slice(),modeling.moveElements(children,{x:0,y:0},newShape));var incoming=oldShape.incoming.slice(),outgoing=oldShape.outgoing.slice();(0,_minDash.forEach)(incoming,function(connection){var waypoints=connection.waypoints,docking=waypoints[waypoints.length-1],source=connection.source,allowed=canReconnect('connection.reconnectEnd',source,newShape,connection);allowed&&self.reconnectEnd(connection,newShape,docking);}),(0,_minDash.forEach)(outgoing,function(connection){var waypoints=connection.waypoints,docking=waypoints[0],target=connection.target,allowed=canReconnect('connection.reconnectStart',newShape,target,connection);allowed&&self.reconnectStart(connection,newShape,docking);});},ReplaceShapeHandler.prototype.postExecute=function(context){var modeling=this._modeling;var oldShape=context.oldShape,newShape=context.newShape;(0,_minDash.forEach)(newShape.incoming,function(c){modeling.layoutConnection(c,{endChanged:!0});}),(0,_minDash.forEach)(newShape.outgoing,function(c){modeling.layoutConnection(c,{startChanged:!0});}),modeling.removeShape(oldShape);},ReplaceShapeHandler.prototype.execute=function(context){},ReplaceShapeHandler.prototype.revert=function(context){},ReplaceShapeHandler.prototype.createShape=function(shape,position,target){var modeling=this._modeling;return modeling.createShape(shape,position,target);},ReplaceShapeHandler.prototype.reconnectStart=function(connection,newSource,dockingPoint){var modeling=this._modeling;modeling.reconnectStart(connection,newSource,dockingPoint);},ReplaceShapeHandler.prototype.reconnectEnd=function(connection,newTarget,dockingPoint){var modeling=this._modeling;modeling.reconnectEnd(connection,newTarget,dockingPoint);};},{'min-dash':438}],260:[function(require,module,exports){'use strict';function ResizeShapeHandler(modeling){this._modeling=modeling;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=ResizeShapeHandler;var _minDash=require('min-dash');var _AnchorsHelper=require('./helper/AnchorsHelper');ResizeShapeHandler.$inject=['modeling'],ResizeShapeHandler.prototype.execute=function(context){var shape=context.shape,newBounds=context.newBounds,minBounds=context.minBounds;if(newBounds.x===undefined||newBounds.y===undefined||newBounds.width===undefined||newBounds.height===undefined)throw new Error('newBounds must have {x, y, width, height} properties');if(minBounds&&(newBounds.width<minBounds.width||newBounds.height<minBounds.height))throw new Error('width and height cannot be less than minimum height and width');else if(!minBounds&&newBounds.width<10||newBounds.height<10)throw new Error('width and height cannot be less than 10px');return context.oldBounds={width:shape.width,height:shape.height,x:shape.x,y:shape.y},(0,_minDash.assign)(shape,{width:newBounds.width,height:newBounds.height,x:newBounds.x,y:newBounds.y}),shape;},ResizeShapeHandler.prototype.postExecute=function(context){var shape=context.shape,oldBounds=context.oldBounds;var modeling=this._modeling;(0,_minDash.forEach)(shape.incoming,function(c){modeling.layoutConnection(c,{connectionEnd:(0,_AnchorsHelper.getResizedTargetAnchor)(c,shape,oldBounds)});}),(0,_minDash.forEach)(shape.outgoing,function(c){modeling.layoutConnection(c,{connectionStart:(0,_AnchorsHelper.getResizedSourceAnchor)(c,shape,oldBounds)});});},ResizeShapeHandler.prototype.revert=function(context){var shape=context.shape,oldBounds=context.oldBounds;return(0,_minDash.assign)(shape,{width:oldBounds.width,height:oldBounds.height,x:oldBounds.x,y:oldBounds.y}),shape;};},{'./helper/AnchorsHelper':265,'min-dash':438}],261:[function(require,module,exports){'use strict';function SpaceToolHandler(modeling){this._modeling=modeling;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=SpaceToolHandler;var _minDash=require('min-dash');var _SpaceUtil=require('../../space-tool/SpaceUtil');SpaceToolHandler.$inject=['modeling'],SpaceToolHandler.prototype.preExecute=function(context){var modeling=this._modeling,resizingShapes=context.resizingShapes,delta=context.delta,direction=context.direction;(0,_minDash.forEach)(resizingShapes,function(shape){var newBounds=(0,_SpaceUtil.resizeBounds)(shape,direction,delta);modeling.resizeShape(shape,newBounds);});},SpaceToolHandler.prototype.postExecute=function(context){var modeling=this._modeling,movingShapes=context.movingShapes,delta=context.delta;modeling.moveElements(movingShapes,delta,undefined,{autoResize:!1,attach:!1});},SpaceToolHandler.prototype.execute=function(context){},SpaceToolHandler.prototype.revert=function(context){};},{'../../space-tool/SpaceUtil':304,'min-dash':438}],262:[function(require,module,exports){'use strict';function ToggleShapeCollapseHandler(modeling){this._modeling=modeling;}function getElementsVisibility(elements){var result={};return elements.forEach(function(e){result[e.id]=e.hidden;}),result;}function setHidden(elements,newHidden){elements.forEach(function(element){element.hidden=newHidden;});}function restoreVisibility(elements,lastState){elements.forEach(function(e){e.hidden=lastState[e.id];});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=ToggleShapeCollapseHandler,ToggleShapeCollapseHandler.$inject=['modeling'],ToggleShapeCollapseHandler.prototype.execute=function(context){var shape=context.shape,children=shape.children;return context.oldChildrenVisibility=getElementsVisibility(children),shape.collapsed=!shape.collapsed,setHidden(children,shape.collapsed),[shape].concat(children);},ToggleShapeCollapseHandler.prototype.revert=function(context){var shape=context.shape,oldChildrenVisibility=context.oldChildrenVisibility;var children=shape.children;return restoreVisibility(children,oldChildrenVisibility),shape.collapsed=!shape.collapsed,[shape].concat(children);};},{}],263:[function(require,module,exports){'use strict';function UpdateAttachmentHandler(modeling){this._modeling=modeling;}function removeAttacher(host,attacher){return(0,_Collections.remove)(host&&host.attachers,attacher);}function addAttacher(host,attacher,idx){if(!host)return;var attachers=host.attachers;attachers||(host.attachers=attachers=[]),(0,_Collections.add)(attachers,attacher,idx);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=UpdateAttachmentHandler;var _Collections=require('../../../util/Collections');UpdateAttachmentHandler.$inject=['modeling'],UpdateAttachmentHandler.prototype.execute=function(context){var shape=context.shape,newHost=context.newHost,oldHost=shape.host;return context.oldHost=oldHost,context.attacherIdx=removeAttacher(oldHost,shape),addAttacher(newHost,shape),shape.host=newHost,shape;},UpdateAttachmentHandler.prototype.revert=function(context){var shape=context.shape,newHost=context.newHost,oldHost=context.oldHost,attacherIdx=context.attacherIdx;return shape.host=oldHost,removeAttacher(newHost,shape),addAttacher(oldHost,shape,attacherIdx),shape;};},{'../../../util/Collections':328}],264:[function(require,module,exports){'use strict';function UpdateWaypointsHandler(){}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=UpdateWaypointsHandler,UpdateWaypointsHandler.prototype.execute=function(context){var connection=context.connection,newWaypoints=context.newWaypoints;return context.oldWaypoints=connection.waypoints,connection.waypoints=newWaypoints,connection;},UpdateWaypointsHandler.prototype.revert=function(context){var connection=context.connection,oldWaypoints=context.oldWaypoints;return connection.waypoints=oldWaypoints,connection;};},{}],265:[function(require,module,exports){'use strict';function getResizedSourceAnchor(connection,shape,oldBounds){var waypoints=safeGetWaypoints(connection),oldAnchor=waypoints[0];return(0,_AttachUtil.getNewAttachPoint)(oldAnchor.original||oldAnchor,oldBounds,shape);}function getResizedTargetAnchor(connection,shape,oldBounds){var waypoints=safeGetWaypoints(connection),oldAnchor=waypoints[waypoints.length-1];return(0,_AttachUtil.getNewAttachPoint)(oldAnchor.original||oldAnchor,oldBounds,shape);}function getMovedSourceAnchor(connection,source,moveDelta){return getResizedSourceAnchor(connection,source,substractPosition(source,moveDelta));}function getMovedTargetAnchor(connection,target,moveDelta){return getResizedTargetAnchor(connection,target,substractPosition(target,moveDelta));}function substractPosition(bounds,delta){return{x:bounds.x-delta.x,y:bounds.y-delta.y,width:bounds.width,height:bounds.height};}function safeGetWaypoints(connection){var waypoints=connection.waypoints;if(!waypoints.length)throw new Error('connection#'+connection.id+': no waypoints');return waypoints;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.getResizedSourceAnchor=getResizedSourceAnchor,exports.getResizedTargetAnchor=getResizedTargetAnchor,exports.getMovedSourceAnchor=getMovedSourceAnchor,exports.getMovedTargetAnchor=getMovedTargetAnchor;var _AttachUtil=require('../../../../util/AttachUtil');},{'../../../../util/AttachUtil':326}],266:[function(require,module,exports){'use strict';function MoveHelper(modeling){this._modeling=modeling;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=MoveHelper;var _minDash=require('min-dash');var _Elements=require('../../../../util/Elements');var _AnchorsHelper=require('./AnchorsHelper');MoveHelper.prototype.moveRecursive=function(elements,delta,newParent){return elements?this.moveClosure(this.getClosure(elements),delta,newParent):[];},MoveHelper.prototype.moveClosure=function(closure,delta,newParent,newHost,primaryShape){var modeling=this._modeling;var allShapes=closure.allShapes,allConnections=closure.allConnections,enclosedConnections=closure.enclosedConnections,topLevel=closure.topLevel,keepParent=!1;primaryShape&&primaryShape.parent===newParent&&(keepParent=!0),(0,_minDash.forEach)(allShapes,function(shape){modeling.moveShape(shape,delta,topLevel[shape.id]&&!keepParent&&newParent,{recurse:!1,layout:!1});}),(0,_minDash.forEach)(allConnections,function(c){var sourceMoved=!!allShapes[c.source.id],targetMoved=!!allShapes[c.target.id];enclosedConnections[c.id]&&sourceMoved&&targetMoved?modeling.moveConnection(c,delta,topLevel[c.id]&&!keepParent&&newParent):modeling.layoutConnection(c,{connectionStart:sourceMoved&&(0,_AnchorsHelper.getMovedSourceAnchor)(c,c.source,delta),connectionEnd:targetMoved&&(0,_AnchorsHelper.getMovedTargetAnchor)(c,c.target,delta)});});},MoveHelper.prototype.getClosure=_Elements.getClosure;},{'../../../../util/Elements':331,'./AnchorsHelper':265,'min-dash':438}],267:[function(require,module,exports){'use strict';function MouseTracking(eventBus,canvas){this._eventBus=eventBus,this._canvas=canvas,this._init();}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=MouseTracking;var _minDash=require('min-dash');MouseTracking.$inject=['eventBus','canvas'],MouseTracking.prototype.getHoverContext=function(){var viewbox=this._canvas.viewbox();return{element:this._hoverElement,point:{x:viewbox.x+Math.round(this._mouseX/viewbox.scale),y:viewbox.y+Math.round(this._mouseY/viewbox.scale)}};},MouseTracking.prototype._init=function(){var eventBus=this._eventBus,canvas=this._canvas;var container=canvas.getContainer();this._setMousePosition=(0,_minDash.bind)(this._setMousePosition,this),container.addEventListener('mousemove',this._setMousePosition),eventBus.on('diagram.destroy',function(){container.removeEventListener('mousemove',this._setMousePosition);},this),eventBus.on('element.hover',this._setHoverElement,this);},MouseTracking.prototype._setHoverElement=function(event){this._hoverElement=event.element;},MouseTracking.prototype._setMousePosition=function(event){this._mouseX=event.layerX,this._mouseY=event.layerY;};},{'min-dash':438}],268:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _MouseTracking=require('./MouseTracking');var _MouseTracking2=_interopRequireDefault(_MouseTracking);exports.default={__init__:['mouseTracking'],mouseTracking:['type',_MouseTracking2.default]};},{'./MouseTracking':267}],269:[function(require,module,exports){'use strict';function mid(element){return{x:element.x+round(element.width/2),y:element.y+round(element.height/2)};}function MoveEvents(eventBus,dragging,modeling,selection,rules){function canMove(shapes,delta,position,target){return rules.allowed('elements.move',{shapes:shapes,delta:delta,position:position,target:target});}function start(event,element,activate){if(element.waypoints||!element.parent)return;var referencePoint=mid(element);return dragging.init(event,referencePoint,'shape.move',{cursor:'grabbing',autoActivate:activate,data:{shape:element,context:{}}}),!0;}eventBus.on('shape.move.start',HIGH_PRIORITY,function(event){var context=event.context,shape=event.shape,shapes=selection.get().slice();shapes.indexOf(shape)===-1&&(shapes=[shape]),shapes=removeNested(shapes),(0,_minDash.assign)(context,{shapes:shapes,validatedShapes:shapes,shape:shape});}),eventBus.on('shape.move.start',MEDIUM_PRIORITY,function(event){var context=event.context,validatedShapes=context.validatedShapes,canExecute;return canExecute=context.canExecute=canMove(validatedShapes),canExecute?void 0:!1;}),eventBus.on('shape.move.move',LOW_PRIORITY,function(event){var context=event.context,validatedShapes=context.validatedShapes,hover=event.hover,delta={x:event.dx,y:event.dy},position={x:event.x,y:event.y},canExecute;if(canExecute=canMove(validatedShapes,delta,position,hover),context.delta=delta,context.canExecute=canExecute,canExecute===null){context.target=null;return;}context.target=hover;}),eventBus.on('shape.move.end',function(event){var context=event.context;var delta=context.delta,canExecute=context.canExecute,isAttach=canExecute==='attach',shapes=context.shapes;if(!canExecute)return!1;delta.x=round(delta.x),delta.y=round(delta.y),modeling.moveElements(shapes,delta,context.target,{primaryShape:context.shape,attach:isAttach});}),eventBus.on('element.mousedown',function(event){var originalEvent=(0,_Event.getOriginal)(event);if(!originalEvent)throw new Error('must supply DOM mousedown event');return start(originalEvent,event.element);}),this.start=start;}function removeNested(elements){var ids=(0,_minDash.groupBy)(elements,'id');return(0,_minDash.filter)(elements,function(element){while(element=element.parent)if(ids[element.id])return!1;return!0;});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=MoveEvents;var _minDash=require('min-dash');var _Event=require('../../util/Event');var LOW_PRIORITY=500,MEDIUM_PRIORITY=1250,HIGH_PRIORITY=1500;var round=Math.round;MoveEvents.$inject=['eventBus','dragging','modeling','selection','rules'];},{'../../util/Event':332,'min-dash':438}],270:[function(require,module,exports){'use strict';function MovePreview(eventBus,elementRegistry,canvas,styles,previewSupport){function getVisualDragShapes(shapes){var elements=getAllDraggedElements(shapes);var filteredElements=removeEdges(elements);return filteredElements;}function getAllDraggedElements(shapes){var allShapes=(0,_Elements.selfAndAllChildren)(shapes,!0);var allConnections=(0,_minDash.map)(allShapes,function(shape){return(shape.incoming||[]).concat(shape.outgoing||[]);});return(0,_minDash.flatten)(allShapes.concat(allConnections),!0);}function setMarker(element,marker){[MARKER_ATTACH,MARKER_OK,MARKER_NOT_OK,MARKER_NEW_PARENT].forEach(function(m){m===marker?canvas.addMarker(element,m):canvas.removeMarker(element,m);});}function makeDraggable(context,element,addMarker){previewSupport.addDragger(element,context.dragGroup),addMarker&&canvas.addMarker(element,MARKER_DRAGGING),context.allDraggedElements?context.allDraggedElements.push(element):context.allDraggedElements=[element];}eventBus.on('shape.move.start',LOW_PRIORITY,function(event){var context=event.context,dragShapes=context.shapes,allDraggedElements=context.allDraggedElements;var visuallyDraggedShapes=getVisualDragShapes(dragShapes);if(!context.dragGroup){var dragGroup=(0,_tinySvg.create)('g');(0,_tinySvg.attr)(dragGroup,styles.cls('djs-drag-group',['no-events']));var defaultLayer=canvas.getDefaultLayer();(0,_tinySvg.append)(defaultLayer,dragGroup),context.dragGroup=dragGroup;}visuallyDraggedShapes.forEach(function(shape){previewSupport.addDragger(shape,context.dragGroup);}),allDraggedElements?allDraggedElements=(0,_minDash.flatten)(allDraggedElements,getAllDraggedElements(dragShapes)):allDraggedElements=getAllDraggedElements(dragShapes),(0,_minDash.forEach)(allDraggedElements,function(e){canvas.addMarker(e,MARKER_DRAGGING);}),context.allDraggedElements=allDraggedElements,context.differentParents=haveDifferentParents(dragShapes);}),eventBus.on('shape.move.move',LOW_PRIORITY,function(event){var context=event.context,dragGroup=context.dragGroup,target=context.target,parent=context.shape.parent,canExecute=context.canExecute;target&&(canExecute==='attach'?setMarker(target,MARKER_ATTACH):context.canExecute&&target&&target.id!==parent.id?setMarker(target,MARKER_NEW_PARENT):setMarker(target,context.canExecute?MARKER_OK:MARKER_NOT_OK)),(0,_SvgTransformUtil.translate)(dragGroup,event.dx,event.dy);}),eventBus.on(['shape.move.out','shape.move.cleanup'],function(event){var context=event.context,target=context.target;target&&setMarker(target,null);}),eventBus.on('shape.move.cleanup',function(event){var context=event.context,allDraggedElements=context.allDraggedElements,dragGroup=context.dragGroup;(0,_minDash.forEach)(allDraggedElements,function(e){canvas.removeMarker(e,MARKER_DRAGGING);}),dragGroup&&(0,_tinySvg.clear)(dragGroup);}),this.makeDraggable=makeDraggable;}function removeEdges(elements){var filteredElements=(0,_minDash.filter)(elements,function(element){return isConnection(element)?(0,_minDash.find)(elements,(0,_minDash.matchPattern)({id:element.source.id}))&&(0,_minDash.find)(elements,(0,_minDash.matchPattern)({id:element.target.id})):!0;});return filteredElements;}function haveDifferentParents(elements){return(0,_minDash.size)((0,_minDash.groupBy)(elements,function(e){return e.parent&&e.parent.id;}))!==1;}function isConnection(element){return element.waypoints;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=MovePreview;var _minDash=require('min-dash');var _Elements=require('../../util/Elements');var _tinySvg=require('tiny-svg');var _SvgTransformUtil=require('../../util/SvgTransformUtil');var LOW_PRIORITY=499;var MARKER_DRAGGING='djs-dragging',MARKER_OK='drop-ok',MARKER_NOT_OK='drop-not-ok',MARKER_NEW_PARENT='new-parent',MARKER_ATTACH='attach-ok';MovePreview.$inject=['eventBus','elementRegistry','canvas','styles','previewSupport'];},{'../../util/Elements':331,'../../util/SvgTransformUtil':343,'min-dash':438,'tiny-svg':468}],271:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _interactionEvents=require('../interaction-events');var _interactionEvents2=_interopRequireDefault(_interactionEvents);var _selection=require('../selection');var _selection2=_interopRequireDefault(_selection);var _outline=require('../outline');var _outline2=_interopRequireDefault(_outline);var _rules=require('../rules');var _rules2=_interopRequireDefault(_rules);var _dragging=require('../dragging');var _dragging2=_interopRequireDefault(_dragging);var _previewSupport=require('../preview-support');var _previewSupport2=_interopRequireDefault(_previewSupport);var _Move=require('./Move');var _Move2=_interopRequireDefault(_Move);var _MovePreview=require('./MovePreview');var _MovePreview2=_interopRequireDefault(_MovePreview);exports.default={__depends__:[_interactionEvents2.default,_selection2.default,_outline2.default,_rules2.default,_dragging2.default,_previewSupport2.default],__init__:['move','movePreview'],move:['type',_Move2.default],movePreview:['type',_MovePreview2.default]};},{'../dragging':228,'../interaction-events':236,'../outline':274,'../preview-support':282,'../rules':292,'../selection':298,'./Move':269,'./MovePreview':270}],272:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function OrderingProvider(eventBus){_CommandInterceptor2.default.call(this,eventBus);var self=this;this.preExecute(['shape.create','connection.create'],function(event){var context=event.context,element=context.shape||context.connection,parent=context.parent;var ordering=self.getOrdering(element,parent);ordering&&(ordering.parent!==undefined&&(context.parent=ordering.parent),context.parentIndex=ordering.index);}),this.preExecute(['shape.move','connection.move'],function(event){var context=event.context,element=context.shape||context.connection,parent=context.newParent||element.parent;var ordering=self.getOrdering(element,parent);ordering&&(ordering.parent!==undefined&&(context.newParent=ordering.parent),context.newParentIndex=ordering.index);});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=OrderingProvider;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _CommandInterceptor=require('../../command/CommandInterceptor');var _CommandInterceptor2=_interopRequireDefault(_CommandInterceptor);OrderingProvider.prototype.getOrdering=function(element,newParent){return null;},(0,_inherits2.default)(OrderingProvider,_CommandInterceptor2.default);},{'../../command/CommandInterceptor':185,inherits:350}],273:[function(require,module,exports){'use strict';function Outline(eventBus,styles,elementRegistry){function createOutline(gfx,bounds){var outline=(0,_tinySvg.create)('rect');return(0,_tinySvg.attr)(outline,(0,_minDash.assign)({x:10,y:10,width:100,height:100},OUTLINE_STYLE)),(0,_tinySvg.append)(gfx,outline),outline;}this.offset=6;var OUTLINE_STYLE=styles.cls('djs-outline',['no-fill']);var self=this;eventBus.on(['shape.added','shape.changed'],LOW_PRIORITY,function(event){var element=event.element,gfx=event.gfx;var outline=(0,_minDom.query)('.djs-outline',gfx);outline||(outline=createOutline(gfx,element)),self.updateShapeOutline(outline,element);}),eventBus.on(['connection.added','connection.changed'],function(event){var element=event.element,gfx=event.gfx;var outline=(0,_minDom.query)('.djs-outline',gfx);outline||(outline=createOutline(gfx,element)),self.updateConnectionOutline(outline,element);});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=Outline;var _Elements=require('../../util/Elements');var _tinySvg=require('tiny-svg');var _minDom=require('min-dom');var _minDash=require('min-dash');var LOW_PRIORITY=500;Outline.prototype.updateShapeOutline=function(outline,element){(0,_tinySvg.attr)(outline,{x:-this.offset,y:-this.offset,width:element.width+this.offset*2,height:element.height+this.offset*2});},Outline.prototype.updateConnectionOutline=function(outline,connection){var bbox=(0,_Elements.getBBox)(connection);(0,_tinySvg.attr)(outline,{x:bbox.x-this.offset,y:bbox.y-this.offset,width:bbox.width+this.offset*2,height:bbox.height+this.offset*2});},Outline.$inject=['eventBus','styles','elementRegistry'];},{'../../util/Elements':331,'min-dash':438,'min-dom':439,'tiny-svg':468}],274:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _Outline=require('./Outline');var _Outline2=_interopRequireDefault(_Outline);exports.default={__init__:['outline'],outline:['type',_Outline2.default]};},{'./Outline':273}],275:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function createRoot(parent){var root=(0,_minDom.domify)('<div class="djs-overlay-container" style="position: absolute; width: 0; height: 0;" />');return parent.insertBefore(root,parent.firstChild),root;}function setPosition(el,x,y){(0,_minDash.assign)(el.style,{left:x+'px',top:y+'px'});}function setVisible(el,visible){el.style.display=visible===!1?'none':'';}function setTransform(el,transform){el.style['transform-origin']='top left',['','-ms-','-webkit-'].forEach(function(prefix){el.style[prefix+'transform']=transform;});}function isDef(o){return o!==void 0;}function Overlays(config,eventBus,canvas,elementRegistry){this._eventBus=eventBus,this._canvas=canvas,this._elementRegistry=elementRegistry,this._ids=ids,this._overlayDefaults=(0,_minDash.assign)({show:null,scale:!0},config&&config.defaults),this._overlays={},this._overlayContainers=[],this._overlayRoot=createRoot(canvas.getContainer()),this._init();}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=Overlays;var _minDash=require('min-dash');var _minDom=require('min-dom');var _Elements=require('../../util/Elements');var _IdGenerator=require('../../util/IdGenerator');var _IdGenerator2=_interopRequireDefault(_IdGenerator);var ids=new _IdGenerator2.default('ov');var LOW_PRIORITY=500;Overlays.$inject=['config.overlays','eventBus','canvas','elementRegistry'],Overlays.prototype.get=function(search){if((0,_minDash.isString)(search)&&(search={id:search}),(0,_minDash.isString)(search.element)&&(search.element=this._elementRegistry.get(search.element)),search.element){var container=this._getOverlayContainer(search.element,!0);return container?search.type?(0,_minDash.filter)(container.overlays,(0,_minDash.matchPattern)({type:search.type})):container.overlays.slice():[];}else return search.type?(0,_minDash.filter)(this._overlays,(0,_minDash.matchPattern)({type:search.type})):search.id?this._overlays[search.id]:null;},Overlays.prototype.add=function(element,type,overlay){if((0,_minDash.isObject)(type)&&(overlay=type,type=null),element.id||(element=this._elementRegistry.get(element)),!overlay.position)throw new Error('must specifiy overlay position');if(!overlay.html)throw new Error('must specifiy overlay html');if(!element)throw new Error('invalid element specified');var id=this._ids.next();return overlay=(0,_minDash.assign)({},this._overlayDefaults,overlay,{id:id,type:type,element:element,html:overlay.html}),this._addOverlay(overlay),id;},Overlays.prototype.remove=function(filter){var overlays=this.get(filter)||[];(0,_minDash.isArray)(overlays)||(overlays=[overlays]);var self=this;(0,_minDash.forEach)(overlays,function(overlay){var container=self._getOverlayContainer(overlay.element,!0);if(overlay&&((0,_minDom.remove)(overlay.html),(0,_minDom.remove)(overlay.htmlContainer),delete overlay.htmlContainer,delete overlay.element,delete self._overlays[overlay.id]),container){var idx=container.overlays.indexOf(overlay);idx!==-1&&container.overlays.splice(idx,1);}});},Overlays.prototype.show=function(){setVisible(this._overlayRoot);},Overlays.prototype.hide=function(){setVisible(this._overlayRoot,!1);},Overlays.prototype.clear=function(){this._overlays={},this._overlayContainers=[],(0,_minDom.clear)(this._overlayRoot);},Overlays.prototype._updateOverlayContainer=function(container){var element=container.element,html=container.html;var x=element.x,y=element.y;if(element.waypoints){var bbox=(0,_Elements.getBBox)(element);x=bbox.x,y=bbox.y;}setPosition(html,x,y),(0,_minDom.attr)(container.html,'data-container-id',element.id);},Overlays.prototype._updateOverlay=function(overlay){var position=overlay.position,htmlContainer=overlay.htmlContainer,element=overlay.element;var left=position.left,top=position.top;if(position.right!==undefined){var width;element.waypoints?width=(0,_Elements.getBBox)(element).width:width=element.width,left=position.right*-1+width;}if(position.bottom!==undefined){var height;element.waypoints?height=(0,_Elements.getBBox)(element).height:height=element.height,top=position.bottom*-1+height;}setPosition(htmlContainer,left||0,top||0);},Overlays.prototype._createOverlayContainer=function(element){var html=(0,_minDom.domify)('<div class="djs-overlays" style="position: absolute" />');this._overlayRoot.appendChild(html);var container={html:html,element:element,overlays:[]};return this._updateOverlayContainer(container),this._overlayContainers.push(container),container;},Overlays.prototype._updateRoot=function(viewbox){var scale=viewbox.scale||1;var matrix='matrix('+[scale,0,0,scale,-1*viewbox.x*scale,-1*viewbox.y*scale].join(',')+')';setTransform(this._overlayRoot,matrix);},Overlays.prototype._getOverlayContainer=function(element,raw){var container=(0,_minDash.find)(this._overlayContainers,function(c){return c.element===element;});return container||raw?container:this._createOverlayContainer(element);},Overlays.prototype._addOverlay=function(overlay){var id=overlay.id,element=overlay.element,html=overlay.html,htmlContainer,overlayContainer;html.get&&html.constructor.prototype.jquery&&(html=html.get(0)),(0,_minDash.isString)(html)&&(html=(0,_minDom.domify)(html)),overlayContainer=this._getOverlayContainer(element),htmlContainer=(0,_minDom.domify)('<div class="djs-overlay" data-overlay-id="'+id+'" style="position: absolute">'),htmlContainer.appendChild(html),overlay.type&&(0,_minDom.classes)(htmlContainer).add('djs-overlay-'+overlay.type),overlay.htmlContainer=htmlContainer,overlayContainer.overlays.push(overlay),overlayContainer.html.appendChild(htmlContainer),this._overlays[id]=overlay,this._updateOverlay(overlay),this._updateOverlayVisibilty(overlay,this._canvas.viewbox());},Overlays.prototype._updateOverlayVisibilty=function(overlay,viewbox){var show=overlay.show,minZoom=show&&show.minZoom,maxZoom=show&&show.maxZoom,htmlContainer=overlay.htmlContainer,visible=!0;show&&((isDef(minZoom)&&minZoom>viewbox.scale||isDef(maxZoom)&&maxZoom<viewbox.scale)&&(visible=!1),setVisible(htmlContainer,visible)),this._updateOverlayScale(overlay,viewbox);},Overlays.prototype._updateOverlayScale=function(overlay,viewbox){var shouldScale=overlay.scale,minScale,maxScale,htmlContainer=overlay.htmlContainer;var scale,transform='';shouldScale!==!0&&(shouldScale===!1?(minScale=1,maxScale=1):(minScale=shouldScale.min,maxScale=shouldScale.max),isDef(minScale)&&viewbox.scale<minScale&&(scale=(1/viewbox.scale||1)*minScale),isDef(maxScale)&&viewbox.scale>maxScale&&(scale=(1/viewbox.scale||1)*maxScale)),isDef(scale)&&(transform='scale('+scale+','+scale+')'),setTransform(htmlContainer,transform);},Overlays.prototype._updateOverlaysVisibilty=function(viewbox){var self=this;(0,_minDash.forEach)(this._overlays,function(overlay){self._updateOverlayVisibilty(overlay,viewbox);});},Overlays.prototype._init=function(){function updateViewbox(viewbox){self._updateRoot(viewbox),self._updateOverlaysVisibilty(viewbox),self.show();}var eventBus=this._eventBus;var self=this;eventBus.on('canvas.viewbox.changing',function(event){self.hide();}),eventBus.on('canvas.viewbox.changed',function(event){updateViewbox(event.viewbox);}),eventBus.on(['shape.remove','connection.remove'],function(e){var element=e.element;var overlays=self.get({element:element});(0,_minDash.forEach)(overlays,function(o){self.remove(o.id);});var container=self._getOverlayContainer(element);if(container){(0,_minDom.remove)(container.html);var i=self._overlayContainers.indexOf(container);i!==-1&&self._overlayContainers.splice(i,1);}}),eventBus.on('element.changed',LOW_PRIORITY,function(e){var element=e.element;var container=self._getOverlayContainer(element,!0);container&&((0,_minDash.forEach)(container.overlays,function(overlay){self._updateOverlay(overlay);}),self._updateOverlayContainer(container));}),eventBus.on('element.marker.update',function(e){var container=self._getOverlayContainer(e.element,!0);container&&(0,_minDom.classes)(container.html)[e.add?'add':'remove'](e.marker);}),eventBus.on('diagram.clear',this.clear,this);};},{'../../util/Elements':331,'../../util/IdGenerator':335,'min-dash':438,'min-dom':439}],276:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _Overlays=require('./Overlays');var _Overlays2=_interopRequireDefault(_Overlays);exports.default={__init__:['overlays'],overlays:['type',_Overlays2.default]};},{'./Overlays':275}],277:[function(require,module,exports){'use strict';function Palette(eventBus,canvas){this._eventBus=eventBus,this._canvas=canvas,this._providers=[];var self=this;eventBus.on('tool-manager.update',function(event){var tool=event.tool;self.updateToolHighlight(tool);}),eventBus.on('i18n.changed',function(){self._update();}),eventBus.on('diagram.init',function(){self._diagramInitialized=!0,self._providers.length&&(self._init(),self._update());});}function addClasses(element,classNames){var classes=(0,_minDom.classes)(element);var actualClassNames=(0,_minDash.isArray)(classNames)?classNames:classNames.split(/\s+/g);actualClassNames.forEach(function(cls){classes.add(cls);});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=Palette;var _minDash=require('min-dash');var _minDom=require('min-dom');var TOGGLE_SELECTOR='.djs-palette-toggle',ENTRY_SELECTOR='.entry',ELEMENT_SELECTOR=TOGGLE_SELECTOR+', '+ENTRY_SELECTOR;var PALETTE_OPEN_CLS='open',PALETTE_TWO_COLUMN_CLS='two-column';Palette.$inject=['eventBus','canvas'],Palette.prototype.registerProvider=function(provider){if(this._providers.push(provider),!this._diagramInitialized)return;this._container||this._init(),this._update();},Palette.prototype.getEntries=function(){var entries={};return(0,_minDash.forEach)(this._providers,function(provider){var e=provider.getPaletteEntries();(0,_minDash.forEach)(e,function(entry,id){entries[id]=entry;});}),entries;},Palette.prototype._init=function(){var canvas=this._canvas,eventBus=this._eventBus;var parent=canvas.getContainer(),container=this._container=(0,_minDom.domify)(Palette.HTML_MARKUP),self=this;parent.appendChild(container),_minDom.delegate.bind(container,ELEMENT_SELECTOR,'click',function(event){var target=event.delegateTarget;if((0,_minDom.matches)(target,TOGGLE_SELECTOR))return self.toggle();self.trigger('click',event);}),_minDom.event.bind(container,'mousedown',function(event){event.stopPropagation();}),_minDom.delegate.bind(container,ENTRY_SELECTOR,'dragstart',function(event){self.trigger('dragstart',event);}),eventBus.on('canvas.resized',this._layoutChanged,this),eventBus.fire('palette.create',{container:container});},Palette.prototype._toggleState=function(state){state=state||{};var parent=this._getParentContainer(),container=this._container;var eventBus=this._eventBus;var twoColumn;var cls=(0,_minDom.classes)(container);'twoColumn'in state?twoColumn=state.twoColumn:twoColumn=this._needsCollapse(parent.clientHeight,this._entries||{}),cls.toggle(PALETTE_TWO_COLUMN_CLS,twoColumn),'open'in state&&cls.toggle(PALETTE_OPEN_CLS,state.open),eventBus.fire('palette.changed',{twoColumn:twoColumn,open:this.isOpen()});},Palette.prototype._update=function(){var entriesContainer=(0,_minDom.query)('.djs-palette-entries',this._container),entries=this._entries=this.getEntries();(0,_minDom.clear)(entriesContainer),(0,_minDash.forEach)(entries,function(entry,id){var grouping=entry.group||'default';var container=(0,_minDom.query)('[data-group='+grouping+']',entriesContainer);container||(container=(0,_minDom.domify)('<div class="group" data-group="'+grouping+'"></div>'),entriesContainer.appendChild(container));var html=entry.html||(entry.separator?'<hr class="separator" />':'<div class="entry" draggable="true"></div>');var control=(0,_minDom.domify)(html);container.appendChild(control),entry.separator||((0,_minDom.attr)(control,'data-action',id),entry.title&&(0,_minDom.attr)(control,'title',entry.title),entry.className&&addClasses(control,entry.className),entry.imageUrl&&control.appendChild((0,_minDom.domify)('<img src="'+entry.imageUrl+'">')));}),this.open();},Palette.prototype.trigger=function(action,event,autoActivate){var entries=this._entries,entry,handler,originalEvent,button=event.delegateTarget||event.target;if(!button)return event.preventDefault();if(entry=entries[(0,_minDom.attr)(button,'data-action')],!entry)return;handler=entry.action,originalEvent=event.originalEvent||event,(0,_minDash.isFunction)(handler)?action==='click'&&handler(originalEvent,autoActivate):handler[action]&&handler[action](originalEvent,autoActivate),event.preventDefault();},Palette.prototype._layoutChanged=function(){this._toggleState({});},Palette.prototype._needsCollapse=function(availableHeight,entries){var margin=20+10+20;var entriesHeight=Object.keys(entries).length*46;return availableHeight<entriesHeight+margin;},Palette.prototype.close=function(){this._toggleState({open:!1,twoColumn:!1});},Palette.prototype.open=function(){this._toggleState({open:!0});},Palette.prototype.toggle=function(open){this.isOpen()?this.close():this.open();},Palette.prototype.isActiveTool=function(tool){return tool&&this._activeTool===tool;},Palette.prototype.updateToolHighlight=function(name){var entriesContainer,toolsContainer;this._toolsContainer||(entriesContainer=(0,_minDom.query)('.djs-palette-entries',this._container),this._toolsContainer=(0,_minDom.query)('[data-group=tools]',entriesContainer)),toolsContainer=this._toolsContainer,(0,_minDash.forEach)(toolsContainer.children,function(tool){var actionName=tool.getAttribute('data-action');if(!actionName)return;var toolClasses=(0,_minDom.classes)(tool);actionName=actionName.replace('-tool',''),toolClasses.contains('entry')&&actionName===name?toolClasses.add('highlighted-entry'):toolClasses.remove('highlighted-entry');});},Palette.prototype.isOpen=function(){return(0,_minDom.classes)(this._container).has(PALETTE_OPEN_CLS);},Palette.prototype._getParentContainer=function(){return this._canvas.getContainer();},Palette.HTML_MARKUP='<div class="djs-palette">'+'<div class="djs-palette-entries"></div>'+'<div class="djs-palette-toggle"></div>'+'</div>';},{'min-dash':438,'min-dom':439}],278:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _Palette=require('./Palette');var _Palette2=_interopRequireDefault(_Palette);exports.default={__init__:['palette'],palette:['type',_Palette2.default]};},{'./Palette':277}],279:[function(require,module,exports){'use strict';function PopupMenu(eventBus,canvas){this._eventBus=eventBus,this._canvas=canvas,this._providers={};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=PopupMenu;var _minDash=require('min-dash');var _minDom=require('min-dom');var DATA_REF='data-id';PopupMenu.$inject=['eventBus','canvas'],PopupMenu.prototype.registerProvider=function(id,provider){this._providers[id]=provider;},PopupMenu.prototype.create=function(id,element){var provider=this._providers[id];if(!provider)throw new Error('Provider is not registered: '+id);if(!element)throw new Error('Element is missing');var current=this._current={provider:provider,className:id,element:element};return provider.getHeaderEntries&&(current.headerEntries=provider.getHeaderEntries(element)),current.entries=provider.getEntries(element),this;},PopupMenu.prototype.isEmpty=function(){var current=this._current;return current.entries.length===0&&current.headerEntries&&current.headerEntries.length===0;},PopupMenu.prototype.open=function(position){if(!position)throw new Error('the position argument is missing');this.isOpen()&&this.close(),this._emit('open');var current=this._current,canvas=this._canvas,parent=canvas.getContainer();current.position=position,current.container=this._createContainer();var headerEntries=current.headerEntries||[],entries=current.entries||[];return headerEntries.length&&current.container.appendChild(this._createEntries(current.headerEntries,'djs-popup-header')),entries.length&&current.container.appendChild(this._createEntries(current.entries,'djs-popup-body')),this._attachContainer(current.container,parent,position.cursor),this;},PopupMenu.prototype.close=function(){if(!this.isOpen())return;this._emit('close'),this._unbindHandlers(),(0,_minDom.remove)(this._current.container),this._current.container=null;},PopupMenu.prototype.isOpen=function(){return!!this._current.container;},PopupMenu.prototype.trigger=function(event){event.preventDefault();var element=event.delegateTarget||event.target,entryId=(0,_minDom.attr)(element,DATA_REF);var entry=this._getEntry(entryId);return entry.action?entry.action.call(null,event,entry):void 0;},PopupMenu.prototype._getEntry=function(entryId){var search=(0,_minDash.matchPattern)({id:entryId});var entry=(0,_minDash.find)(this._current.entries,search)||(0,_minDash.find)(this._current.headerEntries,search);if(!entry)throw new Error('entry not found');return entry;},PopupMenu.prototype._emit=function(eventName){this._eventBus.fire('popupMenu.'+eventName);},PopupMenu.prototype._createContainer=function(){var container=(0,_minDom.domify)('<div class="djs-popup">'),position=this._current.position,className=this._current.className;return(0,_minDash.assign)(container.style,{position:'absolute',left:position.x+'px',top:position.y+'px',visibility:'hidden'}),(0,_minDom.classes)(container).add(className),container;},PopupMenu.prototype._attachContainer=function(container,parent,cursor){var self=this;_minDom.delegate.bind(container,'.entry','click',function(event){self.trigger(event);});var zoom=this._canvas.zoom();container.style.transformOrigin='top left',container.style.transform='scale('+zoom+')',parent.appendChild(container),cursor&&this._assureIsInbounds(container,cursor),this._bindHandlers();},PopupMenu.prototype._assureIsInbounds=function(container,cursor){var canvas=this._canvas,clientRect=canvas._container.getBoundingClientRect();var containerX=container.offsetLeft,containerY=container.offsetTop,containerWidth=container.scrollWidth,containerHeight=container.scrollHeight,overAxis={},left,top;var cursorPosition={x:cursor.x-clientRect.left,y:cursor.y-clientRect.top};containerX+containerWidth>clientRect.width&&(overAxis.x=!0),containerY+containerHeight>clientRect.height&&(overAxis.y=!0),overAxis.x&&overAxis.y?(left=cursorPosition.x-containerWidth+'px',top=cursorPosition.y-containerHeight+'px'):overAxis.x?(left=cursorPosition.x-containerWidth+'px',top=cursorPosition.y+'px'):overAxis.y&&cursorPosition.y<containerHeight?(left=cursorPosition.x+'px',top=10+'px'):overAxis.y&&(left=cursorPosition.x+'px',top=cursorPosition.y-containerHeight+'px'),(0,_minDash.assign)(container.style,{left:left,top:top},{visibility:'visible','z-index':1000});},PopupMenu.prototype._createEntries=function(entries,className){var entriesContainer=(0,_minDom.domify)('<div>'),self=this;return(0,_minDom.classes)(entriesContainer).add(className),(0,_minDash.forEach)(entries,function(entry){var entryContainer=self._createEntry(entry,entriesContainer);entriesContainer.appendChild(entryContainer);}),entriesContainer;},PopupMenu.prototype._createEntry=function(entry){if(!entry.id)throw new Error('every entry must have the id property set');var entryContainer=(0,_minDom.domify)('<div>'),entryClasses=(0,_minDom.classes)(entryContainer);if(entryClasses.add('entry'),entry.className&&entryClasses.add(entry.className),(0,_minDom.attr)(entryContainer,DATA_REF,entry.id),entry.label){var label=(0,_minDom.domify)('<span>');label.textContent=entry.label,entryContainer.appendChild(label);}return entry.imageUrl&&entryContainer.appendChild((0,_minDom.domify)('<img src="'+entry.imageUrl+'" />')),entry.active===!0&&entryClasses.add('active'),entry.disabled===!0&&entryClasses.add('disabled'),entry.title&&(entryContainer.title=entry.title),entryContainer;},PopupMenu.prototype._bindHandlers=function(){function close(){self.close();}var eventBus=this._eventBus,self=this;eventBus.once('contextPad.close',close),eventBus.once('canvas.viewbox.changing',close),eventBus.once('commandStack.changed',close);},PopupMenu.prototype._unbindHandlers=function(){function close(){self.close();}var eventBus=this._eventBus,self=this;eventBus.off('contextPad.close',close),eventBus.off('canvas.viewbox.changed',close),eventBus.off('commandStack.changed',close);};},{'min-dash':438,'min-dom':439}],280:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _PopupMenu=require('./PopupMenu');var _PopupMenu2=_interopRequireDefault(_PopupMenu);exports.default={__init__:['popupMenu'],popupMenu:['type',_PopupMenu2.default]};},{'./PopupMenu':279}],281:[function(require,module,exports){'use strict';function PreviewSupport(elementRegistry,canvas,styles){this._elementRegistry=elementRegistry,this._canvas=canvas,this._styles=styles;}function removeMarkers(gfx){gfx.children&&(0,_minDash.forEach)(gfx.children,function(child){removeMarkers(child);}),gfx.style.markerStart='',gfx.style.markerEnd='';}function isConnection(element){return element.waypoints;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=PreviewSupport;var _minDash=require('min-dash');var _tinySvg=require('tiny-svg');PreviewSupport.$inject=['elementRegistry','canvas','styles'],PreviewSupport.prototype.getGfx=function(element){return this._elementRegistry.getGraphics(element);},PreviewSupport.prototype.addDragger=function(shape,group){var gfx=this.getGfx(shape);var dragger=(0,_tinySvg.clone)(gfx);var bbox=gfx.getBoundingClientRect();return isConnection(shape)&&removeMarkers(dragger),(0,_tinySvg.attr)(dragger,this._styles.cls('djs-dragger',[],{x:bbox.top,y:bbox.left})),(0,_tinySvg.append)(group,dragger),dragger;},PreviewSupport.prototype.addFrame=function(shape,group){var frame=(0,_tinySvg.create)('rect',{class:'djs-resize-overlay',width:shape.width,height:shape.height,x:shape.x,y:shape.y});return(0,_tinySvg.append)(group,frame),frame;};},{'min-dash':438,'tiny-svg':468}],282:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _PreviewSupport=require('./PreviewSupport');var _PreviewSupport2=_interopRequireDefault(_PreviewSupport);exports.default={__init__:['previewSupport'],previewSupport:['type',_PreviewSupport2.default]};},{'./PreviewSupport':281}],283:[function(require,module,exports){'use strict';function Replace(modeling){this._modeling=modeling;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=Replace,Replace.$inject=['modeling'],Replace.prototype.replaceElement=function(oldElement,newElementData,options){var modeling=this._modeling;var newElement=null;return oldElement.waypoints||(newElementData.x=Math.ceil(oldElement.x+(newElementData.width||oldElement.width)/2),newElementData.y=Math.ceil(oldElement.y+(newElementData.height||oldElement.height)/2),newElement=modeling.replaceShape(oldElement,newElementData,options)),newElement;};},{}],284:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _Replace=require('./Replace');var _Replace2=_interopRequireDefault(_Replace);exports.default={__init__:['replace'],replace:['type',_Replace2.default]};},{'./Replace':283}],285:[function(require,module,exports){'use strict';function Resize(eventBus,rules,modeling,dragging){function handleMove(context,delta){var shape=context.shape,direction=context.direction,resizeConstraints=context.resizeConstraints,newBounds;context.delta=delta,newBounds=(0,_ResizeUtil.resizeBounds)(shape,direction,delta),context.newBounds=(0,_ResizeUtil.ensureConstraints)(newBounds,resizeConstraints),context.canExecute=self.canResize(context);}function handleStart(context){var resizeConstraints=context.resizeConstraints,minBounds=context.minBounds;if(resizeConstraints!==undefined)return;minBounds===undefined&&(minBounds=self.computeMinResizeBox(context)),context.resizeConstraints={min:(0,_LayoutUtil.asTRBL)(minBounds)};}function handleEnd(context){var shape=context.shape,canExecute=context.canExecute,newBounds=context.newBounds;canExecute&&(newBounds=(0,_LayoutUtil.roundBounds)(newBounds),modeling.resizeShape(shape,newBounds));}this._dragging=dragging,this._rules=rules;var self=this;eventBus.on('resize.start',function(event){handleStart(event.context);}),eventBus.on('resize.move',function(event){var delta={x:event.dx,y:event.dy};handleMove(event.context,delta);}),eventBus.on('resize.end',function(event){handleEnd(event.context);});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=Resize;var _minDash=require('min-dash');var _ResizeUtil=require('./ResizeUtil');var _LayoutUtil=require('../../layout/LayoutUtil');var DEFAULT_MIN_WIDTH=10;Resize.prototype.canResize=function(context){var rules=this._rules;var ctx=(0,_minDash.pick)(context,['newBounds','shape','delta','direction']);return rules.allowed('shape.resize',ctx);},Resize.prototype.activate=function(event,shape,contextOrDirection){var dragging=this._dragging,context,direction;if(typeof contextOrDirection==='string'&&(contextOrDirection={direction:contextOrDirection}),context=(0,_minDash.assign)({shape:shape},contextOrDirection),direction=context.direction,!direction)throw new Error('must provide a direction (nw|se|ne|sw)');dragging.init(event,'resize',{autoActivate:!0,cursor:'resize-'+(/nw|se/.test(direction)?'nwse':'nesw'),data:{shape:shape,context:context}});},Resize.prototype.computeMinResizeBox=function(context){var shape=context.shape,direction=context.direction,minDimensions,childrenBounds;return minDimensions=context.minDimensions||{width:DEFAULT_MIN_WIDTH,height:DEFAULT_MIN_WIDTH},childrenBounds=(0,_ResizeUtil.computeChildrenBBox)(shape,context.childrenBoxPadding),(0,_ResizeUtil.getMinResizeBounds)(direction,shape,minDimensions,childrenBounds);},Resize.$inject=['eventBus','rules','modeling','dragging'];},{'../../layout/LayoutUtil':317,'./ResizeUtil':288,'min-dash':438}],286:[function(require,module,exports){'use strict';function ResizeHandles(eventBus,canvas,selection,resize){this._resize=resize,this._canvas=canvas;var self=this;eventBus.on('selection.changed',function(e){var newSelection=e.newSelection;self.removeResizers(),newSelection.length===1&&(0,_minDash.forEach)(newSelection,(0,_minDash.bind)(self.addResizer,self));}),eventBus.on('shape.changed',function(e){var shape=e.element;selection.isSelected(shape)&&(self.removeResizers(),self.addResizer(shape));});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=ResizeHandles;var _minDash=require('min-dash');var _tinySvg=require('tiny-svg');var _minDom=require('min-dom');var _Mouse=require('../../util/Mouse');var _LayoutUtil=require('../../layout/LayoutUtil');var _SvgTransformUtil=require('../../util/SvgTransformUtil');var HANDLE_OFFSET=-2,HANDLE_SIZE=5,HANDLE_HIT_SIZE=20;var CLS_RESIZER='djs-resizer';ResizeHandles.prototype.makeDraggable=function(element,gfx,direction){function startResize(event){(0,_Mouse.isPrimaryButton)(event)&&resize.activate(event,element,direction);}var resize=this._resize;_minDom.event.bind(gfx,'mousedown',startResize),_minDom.event.bind(gfx,'touchstart',startResize);},ResizeHandles.prototype._createResizer=function(element,x,y,rotation,direction){var resizersParent=this._getResizersParent();var group=(0,_tinySvg.create)('g');(0,_tinySvg.classes)(group).add(CLS_RESIZER),(0,_tinySvg.classes)(group).add(CLS_RESIZER+'-'+element.id),(0,_tinySvg.classes)(group).add(CLS_RESIZER+'-'+direction),(0,_tinySvg.append)(resizersParent,group);var origin=-HANDLE_SIZE+HANDLE_OFFSET;var visual=(0,_tinySvg.create)('rect');(0,_tinySvg.attr)(visual,{x:origin,y:origin,width:HANDLE_SIZE,height:HANDLE_SIZE}),(0,_tinySvg.classes)(visual).add(CLS_RESIZER+'-visual'),(0,_tinySvg.append)(group,visual);var hit=(0,_tinySvg.create)('rect');return(0,_tinySvg.attr)(hit,{x:origin,y:origin,width:HANDLE_HIT_SIZE,height:HANDLE_HIT_SIZE}),(0,_tinySvg.classes)(hit).add(CLS_RESIZER+'-hit'),(0,_tinySvg.append)(group,hit),(0,_SvgTransformUtil.transform)(group,x,y,rotation),group;},ResizeHandles.prototype.createResizer=function(element,direction){var resizer;var trbl=(0,_LayoutUtil.asTRBL)(element);direction==='nw'?resizer=this._createResizer(element,trbl.left,trbl.top,0,direction):direction==='ne'?resizer=this._createResizer(element,trbl.right,trbl.top,90,direction):direction==='se'?resizer=this._createResizer(element,trbl.right,trbl.bottom,180,direction):resizer=this._createResizer(element,trbl.left,trbl.bottom,270,direction),this.makeDraggable(element,resizer,direction);},ResizeHandles.prototype.addResizer=function(shape){var resize=this._resize;if(!resize.canResize({shape:shape}))return;this.createResizer(shape,'nw'),this.createResizer(shape,'ne'),this.createResizer(shape,'se'),this.createResizer(shape,'sw');},ResizeHandles.prototype.removeResizers=function(){var resizersParent=this._getResizersParent();(0,_tinySvg.clear)(resizersParent);},ResizeHandles.prototype._getResizersParent=function(){return this._canvas.getLayer('resizers');},ResizeHandles.$inject=['eventBus','canvas','selection','resize'];},{'../../layout/LayoutUtil':317,'../../util/Mouse':338,'../../util/SvgTransformUtil':343,'min-dash':438,'min-dom':439,'tiny-svg':468}],287:[function(require,module,exports){'use strict';function ResizePreview(eventBus,canvas,previewSupport){function updateFrame(context){var shape=context.shape,bounds=context.newBounds,frame=context.frame;frame||(frame=context.frame=previewSupport.addFrame(shape,canvas.getDefaultLayer()),canvas.addMarker(shape,MARKER_RESIZING)),bounds.width>5&&(0,_tinySvg.attr)(frame,{x:bounds.x,width:bounds.width}),bounds.height>5&&(0,_tinySvg.attr)(frame,{y:bounds.y,height:bounds.height}),context.canExecute?(0,_tinySvg.classes)(frame).remove(MARKER_RESIZE_NOT_OK):(0,_tinySvg.classes)(frame).add(MARKER_RESIZE_NOT_OK);}function removeFrame(context){var shape=context.shape,frame=context.frame;frame&&(0,_tinySvg.remove)(context.frame),canvas.removeMarker(shape,MARKER_RESIZING);}eventBus.on('resize.move',LOW_PRIORITY,function(event){updateFrame(event.context);}),eventBus.on('resize.cleanup',function(event){removeFrame(event.context);});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=ResizePreview;var _tinySvg=require('tiny-svg');var MARKER_RESIZING='djs-resizing',MARKER_RESIZE_NOT_OK='resize-not-ok';var LOW_PRIORITY=500;ResizePreview.$inject=['eventBus','canvas','previewSupport'];},{'tiny-svg':468}],288:[function(require,module,exports){'use strict';function substractTRBL(trblA,trblB){return{top:trblA.top-trblB.top,right:trblA.right-trblB.right,bottom:trblA.bottom-trblB.bottom,left:trblA.left-trblB.left};}function resizeBounds(bounds,direction,delta){var dx=delta.x,dy=delta.y;switch(direction){case'nw':return{x:bounds.x+dx,y:bounds.y+dy,width:bounds.width-dx,height:bounds.height-dy};case'sw':return{x:bounds.x+dx,y:bounds.y,width:bounds.width-dx,height:bounds.height+dy};case'ne':return{x:bounds.x,y:bounds.y+dy,width:bounds.width+dx,height:bounds.height-dy};case'se':return{x:bounds.x,y:bounds.y,width:bounds.width+dx,height:bounds.height+dy};default:throw new Error('unrecognized direction: '+direction);}}function resizeTRBL(bounds,resize){return{x:bounds.x+(resize.left||0),y:bounds.y+(resize.top||0),width:bounds.width-(resize.left||0)+(resize.right||0),height:bounds.height-(resize.top||0)+(resize.bottom||0)};}function reattachPoint(bounds,newBounds,point){var sx=bounds.width/newBounds.width,sy=bounds.height/newBounds.height;return{x:Math.round(newBounds.x+newBounds.width/2)-Math.floor((bounds.x+bounds.width/2-point.x)/sx),y:Math.round(newBounds.y+newBounds.height/2)-Math.floor((bounds.y+bounds.height/2-point.y)/sy)};}function applyConstraints(attr,trbl,resizeConstraints){var value=trbl[attr],minValue=resizeConstraints.min&&resizeConstraints.min[attr],maxValue=resizeConstraints.max&&resizeConstraints.max[attr];return(0,_minDash.isNumber)(minValue)&&(value=(/top|left/.test(attr)?min:max)(value,minValue)),(0,_minDash.isNumber)(maxValue)&&(value=(/top|left/.test(attr)?max:min)(value,maxValue)),value;}function ensureConstraints(currentBounds,resizeConstraints){if(!resizeConstraints)return currentBounds;var currentTrbl=(0,_LayoutUtil.asTRBL)(currentBounds);return(0,_LayoutUtil.asBounds)({top:applyConstraints('top',currentTrbl,resizeConstraints),right:applyConstraints('right',currentTrbl,resizeConstraints),bottom:applyConstraints('bottom',currentTrbl,resizeConstraints),left:applyConstraints('left',currentTrbl,resizeConstraints)});}function getMinResizeBounds(direction,currentBounds,minDimensions,childrenBounds){var currentBox=(0,_LayoutUtil.asTRBL)(currentBounds);var minBox={top:/n/.test(direction)?currentBox.bottom-minDimensions.height:currentBox.top,left:/w/.test(direction)?currentBox.right-minDimensions.width:currentBox.left,bottom:/s/.test(direction)?currentBox.top+minDimensions.height:currentBox.bottom,right:/e/.test(direction)?currentBox.left+minDimensions.width:currentBox.right};var childrenBox=childrenBounds?(0,_LayoutUtil.asTRBL)(childrenBounds):minBox;var combinedBox={top:min(minBox.top,childrenBox.top),left:min(minBox.left,childrenBox.left),bottom:max(minBox.bottom,childrenBox.bottom),right:max(minBox.right,childrenBox.right)};return(0,_LayoutUtil.asBounds)(combinedBox);}function asPadding(mayBePadding,defaultValue){return mayBePadding!==void 0?mayBePadding:DEFAULT_CHILD_BOX_PADDING;}function addPadding(bbox,padding){var left,right,top,bottom;return(padding===void 0?'undefined':_typeof(padding))==='object'?(left=asPadding(padding.left),right=asPadding(padding.right),top=asPadding(padding.top),bottom=asPadding(padding.bottom)):left=right=top=bottom=asPadding(padding),{x:bbox.x-left,y:bbox.y-top,width:bbox.width+left+right,height:bbox.height+top+bottom};}function isBBoxChild(element){return element.waypoints?!1:element.type==='label'?!1:!0;}function computeChildrenBBox(shapeOrChildren,padding){var elements;return shapeOrChildren.length===undefined?elements=(0,_minDash.filter)(shapeOrChildren.children,isBBoxChild):elements=shapeOrChildren,elements.length?addPadding((0,_Elements.getBBox)(elements),padding):void 0;}Object.defineProperty(exports,'__esModule',{value:!0});var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj;};exports.substractTRBL=substractTRBL,exports.resizeBounds=resizeBounds,exports.resizeTRBL=resizeTRBL,exports.reattachPoint=reattachPoint,exports.ensureConstraints=ensureConstraints,exports.getMinResizeBounds=getMinResizeBounds,exports.addPadding=addPadding,exports.computeChildrenBBox=computeChildrenBBox;var _minDash=require('min-dash');var _Elements=require('../../util/Elements');var _LayoutUtil=require('../../layout/LayoutUtil');var max=Math.max,min=Math.min;var DEFAULT_CHILD_BOX_PADDING=20;},{'../../layout/LayoutUtil':317,'../../util/Elements':331,'min-dash':438}],289:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _rules=require('../rules');var _rules2=_interopRequireDefault(_rules);var _dragging=require('../dragging');var _dragging2=_interopRequireDefault(_dragging);var _previewSupport=require('../preview-support');var _previewSupport2=_interopRequireDefault(_previewSupport);var _Resize=require('./Resize');var _Resize2=_interopRequireDefault(_Resize);var _ResizePreview=require('./ResizePreview');var _ResizePreview2=_interopRequireDefault(_ResizePreview);var _ResizeHandles=require('./ResizeHandles');var _ResizeHandles2=_interopRequireDefault(_ResizeHandles);exports.default={__depends__:[_rules2.default,_dragging2.default,_previewSupport2.default],__init__:['resize','resizePreview','resizeHandles'],resize:['type',_Resize2.default],resizePreview:['type',_ResizePreview2.default],resizeHandles:['type',_ResizeHandles2.default]};},{'../dragging':228,'../preview-support':282,'../rules':292,'./Resize':285,'./ResizeHandles':286,'./ResizePreview':287}],290:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function RuleProvider(eventBus){_CommandInterceptor2.default.call(this,eventBus),this.init();}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=RuleProvider;var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _CommandInterceptor=require('../../command/CommandInterceptor');var _CommandInterceptor2=_interopRequireDefault(_CommandInterceptor);RuleProvider.$inject=['eventBus'],(0,_inherits2.default)(RuleProvider,_CommandInterceptor2.default),RuleProvider.prototype.addRule=function(actions,priority,fn){var self=this;typeof actions==='string'&&(actions=[actions]),actions.forEach(function(action){self.canExecute(action,priority,function(context,action,event){return fn(context);},!0);});},RuleProvider.prototype.init=function(){};},{'../../command/CommandInterceptor':185,inherits:350}],291:[function(require,module,exports){'use strict';function Rules(injector){this._commandStack=injector.get('commandStack',!1);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=Rules,Rules.$inject=['injector'],Rules.prototype.allowed=function(action,context){var allowed=!0;var commandStack=this._commandStack;return commandStack&&(allowed=commandStack.canExecute(action,context)),allowed===undefined?!0:allowed;};},{}],292:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _Rules=require('./Rules');var _Rules2=_interopRequireDefault(_Rules);exports.default={__init__:['rules'],rules:['type',_Rules2.default]};},{'./Rules':291}],293:[function(require,module,exports){'use strict';function SearchPad(canvas,eventBus,overlays,selection){this._open=!1,this._results=[],this._eventMaps=[],this._canvas=canvas,this._eventBus=eventBus,this._overlays=overlays,this._selection=selection,this._container=(0,_minDom.domify)(SearchPad.BOX_HTML),this._searchInput=(0,_minDom.query)(SearchPad.INPUT_SELECTOR,this._container),this._resultsContainer=(0,_minDom.query)(SearchPad.RESULTS_CONTAINER_SELECTOR,this._container),this._canvas.getContainer().appendChild(this._container),eventBus.on(['canvas.destroy','diagram.destroy'],this.close,this);}function constructOverlay(box){var offset=6;var w=box.width+offset*2;var h=box.height+offset*2;var styles=['width: '+w+'px','height: '+h+'px'].join('; ');return{position:{bottom:h-offset,right:w-offset},show:!0,html:'<div style="'+styles+'" class="'+SearchPad.OVERLAY_CLASS+'"></div>'};}function createInnerTextNode(parentNode,tokens,template){var text=createHtmlText(tokens);var childNode=(0,_minDom.domify)(template);childNode.innerHTML=text,parentNode.appendChild(childNode);}function createHtmlText(tokens){var htmlText='';return tokens.forEach(function(t){t.matched?htmlText+='<strong class="'+SearchPad.RESULT_HIGHLIGHT_CLASS+'">'+t.matched+'</strong>':htmlText+=t.normal;}),htmlText!==''?htmlText:null;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=SearchPad;var _minDom=require('min-dom');var _Elements=require('../../util/Elements');SearchPad.$inject=['canvas','eventBus','overlays','selection'],SearchPad.prototype._bindEvents=function(){function listen(el,selector,type,fn){self._eventMaps.push({el:el,type:type,listener:_minDom.delegate.bind(el,selector,type,fn)});}var self=this;listen(document,'html','click',function(e){self.close();},!0),listen(this._container,SearchPad.INPUT_SELECTOR,'click',function(e){e.stopPropagation(),e.delegateTarget.focus();}),listen(this._container,SearchPad.RESULT_SELECTOR,'mouseover',function(e){e.stopPropagation(),self._scrollToNode(e.delegateTarget),self._preselect(e.delegateTarget);}),listen(this._container,SearchPad.RESULT_SELECTOR,'click',function(e){e.stopPropagation(),self._select(e.delegateTarget);}),listen(this._container,SearchPad.INPUT_SELECTOR,'keydown',function(e){e.keyCode===38&&e.preventDefault(),e.keyCode===40&&e.preventDefault();}),listen(this._container,SearchPad.INPUT_SELECTOR,'keyup',function(e){if(e.keyCode===27)return self.close();if(e.keyCode===13){var selected=self._getCurrentResult();return selected?self._select(selected):self.close();}if(e.keyCode===38)return self._scrollToDirection(!0);if(e.keyCode===40)return self._scrollToDirection();if(e.keyCode===37||e.keyCode===39)return;self._search(e.delegateTarget.value);});},SearchPad.prototype._unbindEvents=function(){this._eventMaps.forEach(function(m){_minDom.delegate.unbind(m.el,m.type,m.listener);});},SearchPad.prototype._search=function(pattern){var self=this;if(this._clearResults(),!pattern||pattern==='')return;var searchResults=this._searchProvider.find(pattern);if(!searchResults.length)return;searchResults.forEach(function(result){var id=result.element.id;var node=self._createResultNode(result,id);self._results[id]={element:result.element,node:node};});var node=(0,_minDom.query)(SearchPad.RESULT_SELECTOR,this._resultsContainer);this._scrollToNode(node),this._preselect(node);},SearchPad.prototype._scrollToDirection=function(previous){var selected=this._getCurrentResult();if(!selected)return;var node=previous?selected.previousElementSibling:selected.nextElementSibling;node&&(this._scrollToNode(node),this._preselect(node));},SearchPad.prototype._scrollToNode=function(node){if(!node||node===this._getCurrentResult())return;var nodeOffset=node.offsetTop;var containerScroll=this._resultsContainer.scrollTop;var bottomScroll=nodeOffset-this._resultsContainer.clientHeight+node.clientHeight;nodeOffset<containerScroll?this._resultsContainer.scrollTop=nodeOffset:containerScroll<bottomScroll&&(this._resultsContainer.scrollTop=bottomScroll);},SearchPad.prototype._clearResults=function(){(0,_minDom.clear)(this._resultsContainer),this._results=[],this._resetOverlay(),this._eventBus.fire('searchPad.cleared');},SearchPad.prototype._getCurrentResult=function(){return(0,_minDom.query)(SearchPad.RESULT_SELECTED_SELECTOR,this._resultsContainer);},SearchPad.prototype._createResultNode=function(result,id){var node=(0,_minDom.domify)(SearchPad.RESULT_HTML);return result.primaryTokens.length>0&&createInnerTextNode(node,result.primaryTokens,SearchPad.RESULT_PRIMARY_HTML),createInnerTextNode(node,result.secondaryTokens,SearchPad.RESULT_SECONDARY_HTML),(0,_minDom.attr)(node,SearchPad.RESULT_ID_ATTRIBUTE,id),this._resultsContainer.appendChild(node),node;},SearchPad.prototype.registerProvider=function(provider){this._searchProvider=provider;},SearchPad.prototype.open=function(){if(!this._searchProvider)throw new Error('no search provider registered');if(this.isOpen())return;this._bindEvents(),this._open=!0,(0,_minDom.classes)(this._container).add('open'),this._searchInput.focus(),this._eventBus.fire('searchPad.opened');},SearchPad.prototype.close=function(){if(!this.isOpen())return;this._unbindEvents(),this._open=!1,(0,_minDom.classes)(this._container).remove('open'),this._clearResults(),this._searchInput.value='',this._searchInput.blur(),this._resetOverlay(),this._eventBus.fire('searchPad.closed');},SearchPad.prototype.toggle=function(){this.isOpen()?this.close():this.open();},SearchPad.prototype.isOpen=function(){return this._open;},SearchPad.prototype._preselect=function(node){var selectedNode=this._getCurrentResult();if(node===selectedNode)return;selectedNode&&(0,_minDom.classes)(selectedNode).remove(SearchPad.RESULT_SELECTED_CLASS);var id=(0,_minDom.attr)(node,SearchPad.RESULT_ID_ATTRIBUTE);var element=this._results[id].element;(0,_minDom.classes)(node).add(SearchPad.RESULT_SELECTED_CLASS),this._resetOverlay(element),this._centerViewbox(element),this._selection.select(element),this._eventBus.fire('searchPad.preselected',element);},SearchPad.prototype._select=function(node){var id=(0,_minDom.attr)(node,SearchPad.RESULT_ID_ATTRIBUTE);var element=this._results[id].element;this.close(),this._resetOverlay(),this._centerViewbox(element),this._selection.select(element),this._eventBus.fire('searchPad.selected',element);},SearchPad.prototype._centerViewbox=function(element){var viewbox=this._canvas.viewbox();var box=(0,_Elements.getBBox)(element);var newViewbox={x:box.x+box.width/2-viewbox.outer.width/2,y:box.y+box.height/2-viewbox.outer.height/2,width:viewbox.outer.width,height:viewbox.outer.height};this._canvas.viewbox(newViewbox),this._canvas.zoom(viewbox.scale);},SearchPad.prototype._resetOverlay=function(element){if(this._overlayId&&this._overlays.remove(this._overlayId),element){var box=(0,_Elements.getBBox)(element);var overlay=constructOverlay(box);this._overlayId=this._overlays.add(element,overlay);}},SearchPad.CONTAINER_SELECTOR='.djs-search-container',SearchPad.INPUT_SELECTOR='.djs-search-input input',SearchPad.RESULTS_CONTAINER_SELECTOR='.djs-search-results',SearchPad.RESULT_SELECTOR='.djs-search-result',SearchPad.RESULT_SELECTED_CLASS='djs-search-result-selected',SearchPad.RESULT_SELECTED_SELECTOR='.'+SearchPad.RESULT_SELECTED_CLASS,SearchPad.RESULT_ID_ATTRIBUTE='data-result-id',SearchPad.RESULT_HIGHLIGHT_CLASS='djs-search-highlight',SearchPad.OVERLAY_CLASS='djs-search-overlay',SearchPad.BOX_HTML='<div class="djs-search-container djs-draggable djs-scrollable">'+'<div class="djs-search-input">'+'<input type="text"/>'+'</div>'+'<div class="djs-search-results"></div>'+'</div>',SearchPad.RESULT_HTML='<div class="djs-search-result"></div>',SearchPad.RESULT_PRIMARY_HTML='<div class="djs-search-result-primary"></div>',SearchPad.RESULT_SECONDARY_HTML='<p class="djs-search-result-secondary"></p>';},{'../../util/Elements':331,'min-dom':439}],294:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _overlays=require('../overlays');var _overlays2=_interopRequireDefault(_overlays);var _selection=require('../selection');var _selection2=_interopRequireDefault(_selection);var _SearchPad=require('./SearchPad');var _SearchPad2=_interopRequireDefault(_SearchPad);exports.default={__depends__:[_overlays2.default,_selection2.default],searchPad:['type',_SearchPad2.default]};},{'../overlays':276,'../selection':298,'./SearchPad':293}],295:[function(require,module,exports){'use strict';function Selection(eventBus){this._eventBus=eventBus,this._selectedElements=[];var self=this;eventBus.on(['shape.remove','connection.remove'],function(e){var element=e.element;self.deselect(element);}),eventBus.on(['diagram.clear'],function(e){self.select(null);});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=Selection;var _minDash=require('min-dash');Selection.$inject=['eventBus'],Selection.prototype.deselect=function(element){var selectedElements=this._selectedElements;var idx=selectedElements.indexOf(element);if(idx!==-1){var oldSelection=selectedElements.slice();selectedElements.splice(idx,1),this._eventBus.fire('selection.changed',{oldSelection:oldSelection,newSelection:selectedElements});}},Selection.prototype.get=function(){return this._selectedElements;},Selection.prototype.isSelected=function(element){return this._selectedElements.indexOf(element)!==-1;},Selection.prototype.select=function(elements,add){var selectedElements=this._selectedElements,oldSelection=selectedElements.slice();(0,_minDash.isArray)(elements)||(elements=elements?[elements]:[]),add?(0,_minDash.forEach)(elements,function(element){if(selectedElements.indexOf(element)!==-1)return;else selectedElements.push(element);}):this._selectedElements=selectedElements=elements.slice(),this._eventBus.fire('selection.changed',{oldSelection:oldSelection,newSelection:selectedElements});};},{'min-dash':438}],296:[function(require,module,exports){'use strict';function SelectionBehavior(eventBus,selection,canvas,elementRegistry){eventBus.on('create.end',500,function(e){e.context.canExecute&&selection.select(e.context.shape);}),eventBus.on('connect.end',500,function(e){e.context.canExecute&&e.context.target&&selection.select(e.context.target);}),eventBus.on('shape.move.end',500,function(e){var previousSelection=e.previousSelection||[];var shape=elementRegistry.get(e.context.shape.id);var inSelection=(0,_minDash.find)(previousSelection,function(selectedShape){return shape.id===selectedShape.id;});inSelection||selection.select(shape);}),eventBus.on('element.click',function(event){var element=event.element;element===canvas.getRootElement()&&(element=null);var isSelected=selection.isSelected(element),isMultiSelect=selection.get().length>1;var add=(0,_Mouse.hasPrimaryModifier)(event);if(isSelected&&isMultiSelect)return add?selection.deselect(element):selection.select(element);else isSelected?selection.deselect(element):selection.select(element,add);});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=SelectionBehavior;var _Mouse=require('../../util/Mouse');var _minDash=require('min-dash');SelectionBehavior.$inject=['eventBus','selection','canvas','elementRegistry'];},{'../../util/Mouse':338,'min-dash':438}],297:[function(require,module,exports){'use strict';function SelectionVisuals(events,canvas,selection,styles){function addMarker(e,cls){canvas.addMarker(e,cls);}function removeMarker(e,cls){canvas.removeMarker(e,cls);}this._multiSelectionBox=null,events.on('element.hover',function(event){addMarker(event.element,MARKER_HOVER);}),events.on('element.out',function(event){removeMarker(event.element,MARKER_HOVER);}),events.on('selection.changed',function(event){function deselect(s){removeMarker(s,MARKER_SELECTED);}function select(s){addMarker(s,MARKER_SELECTED);}var oldSelection=event.oldSelection,newSelection=event.newSelection;(0,_minDash.forEach)(oldSelection,function(e){newSelection.indexOf(e)===-1&&deselect(e);}),(0,_minDash.forEach)(newSelection,function(e){oldSelection.indexOf(e)===-1&&select(e);});});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=SelectionVisuals;var _minDash=require('min-dash');var MARKER_HOVER='hover',MARKER_SELECTED='selected';SelectionVisuals.$inject=['eventBus','canvas','selection','styles'];},{'min-dash':438}],298:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _interactionEvents=require('../interaction-events');var _interactionEvents2=_interopRequireDefault(_interactionEvents);var _outline=require('../outline');var _outline2=_interopRequireDefault(_outline);var _Selection=require('./Selection');var _Selection2=_interopRequireDefault(_Selection);var _SelectionVisuals=require('./SelectionVisuals');var _SelectionVisuals2=_interopRequireDefault(_SelectionVisuals);var _SelectionBehavior=require('./SelectionBehavior');var _SelectionBehavior2=_interopRequireDefault(_SelectionBehavior);exports.default={__init__:['selectionVisuals','selectionBehavior'],__depends__:[_interactionEvents2.default,_outline2.default],selection:['type',_Selection2.default],selectionVisuals:['type',_SelectionVisuals2.default],selectionBehavior:['type',_SelectionBehavior2.default]};},{'../interaction-events':236,'../outline':274,'./Selection':295,'./SelectionBehavior':296,'./SelectionVisuals':297}],299:[function(require,module,exports){'use strict';function SnapContext(){this._targets={},this._snapOrigins={},this._snapLocations=[],this._defaultSnaps={};}function SnapPoints(defaultSnaps){this._snapValues={};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=SnapContext;var _minDash=require('min-dash');var _SnapUtil=require('./SnapUtil');SnapContext.prototype.getSnapOrigin=function(snapLocation){return this._snapOrigins[snapLocation];},SnapContext.prototype.setSnapOrigin=function(snapLocation,initialValue){this._snapOrigins[snapLocation]=initialValue,this._snapLocations.indexOf(snapLocation)===-1&&this._snapLocations.push(snapLocation);},SnapContext.prototype.addDefaultSnap=function(type,point){var snapValues=this._defaultSnaps[type];snapValues||(snapValues=this._defaultSnaps[type]=[]),snapValues.push(point);},SnapContext.prototype.getSnapLocations=function(){return this._snapLocations;},SnapContext.prototype.setSnapLocations=function(snapLocations){this._snapLocations=snapLocations;},SnapContext.prototype.pointsForTarget=function(target){var targetId=target.id||target;var snapPoints=this._targets[targetId];return snapPoints||(snapPoints=this._targets[targetId]=new SnapPoints(),snapPoints.initDefaults(this._defaultSnaps)),snapPoints;},SnapPoints.prototype.add=function(snapLocation,point){var snapValues=this._snapValues[snapLocation];snapValues||(snapValues=this._snapValues[snapLocation]={x:[],y:[]}),snapValues.x.indexOf(point.x)===-1&&snapValues.x.push(point.x),snapValues.y.indexOf(point.y)===-1&&snapValues.y.push(point.y);},SnapPoints.prototype.snap=function(point,snapLocation,axis,tolerance){var snappingValues=this._snapValues[snapLocation];return snappingValues&&(0,_SnapUtil.snapTo)(point[axis],snappingValues[axis],tolerance);},SnapPoints.prototype.initDefaults=function(defaultSnaps){var self=this;(0,_minDash.forEach)(defaultSnaps||{},function(snapPoints,snapLocation){(0,_minDash.forEach)(snapPoints,function(point){self.add(snapLocation,point);});});};},{'./SnapUtil':300,'min-dash':438}],300:[function(require,module,exports){'use strict';function snapTo(value,values,tolerance){tolerance=tolerance===undefined?10:tolerance;var idx,snapValue;for(idx=0;idx<values.length;idx++)if(snapValue=values[idx],abs(snapValue-value)<=tolerance)return snapValue;}function topLeft(bounds){return{x:bounds.x,y:bounds.y};}function mid(bounds,defaultValue){return!bounds||isNaN(bounds.x)||isNaN(bounds.y)?defaultValue:{x:round(bounds.x+bounds.width/2),y:round(bounds.y+bounds.height/2)};}function bottomRight(bounds){return{x:bounds.x+bounds.width,y:bounds.y+bounds.height};}function isSnapped(event,axis){var snapped=event.snapped;return snapped?typeof axis==='string'?snapped[axis]:snapped.x&&snapped.y:!1;}function setSnapped(event,axis,value){if(typeof axis!=='string')throw new Error('axis must be in [x, y]');if(typeof value!=='number'&&value!==!1)throw new Error('value must be Number or false');var delta,previousValue=event[axis];var snapped=event.snapped=event.snapped||{};return value===!1?snapped[axis]=!1:(snapped[axis]=!0,delta=value-previousValue,event[axis]+=delta,event['d'+axis]+=delta),previousValue;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.snapTo=snapTo,exports.topLeft=topLeft,exports.mid=mid,exports.bottomRight=bottomRight,exports.isSnapped=isSnapped,exports.setSnapped=setSnapped;var abs=Math.abs,round=Math.round;},{}],301:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function Snapping(eventBus,canvas){this._canvas=canvas;var self=this;eventBus.on(['shape.move.start','create.start'],function(event){self.initSnap(event);}),eventBus.on(['shape.move.move','shape.move.end','create.move','create.end'],HIGHER_PRIORITY,function(event){if(event.originalEvent&&event.originalEvent.ctrlKey)return;if((0,_SnapUtil.isSnapped)(event))return;self.snap(event);}),eventBus.on(['shape.move.cleanup','create.cleanup'],function(event){self.hide();}),this._asyncHide=(0,_minDash.debounce)((0,_minDash.bind)(this.hide,this),1000);}Object.defineProperty(exports,'__esModule',{value:!0});var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj;};exports.default=Snapping;var _minDash=require('min-dash');var _SnapContext=require('./SnapContext');var _SnapContext2=_interopRequireDefault(_SnapContext);var _SnapUtil=require('./SnapUtil');var _tinySvg=require('tiny-svg');var HIGHER_PRIORITY=1250;Snapping.$inject=['eventBus','canvas'],Snapping.prototype.initSnap=function(event){var context=event.context,shape=context.shape,snapContext=context.snapContext;snapContext||(snapContext=context.snapContext=new _SnapContext2.default());var snapMid=(0,_SnapUtil.mid)(shape,event);return snapContext.setSnapOrigin('mid',{x:snapMid.x-event.x,y:snapMid.y-event.y}),snapContext;},Snapping.prototype.snap=function(event){var context=event.context,snapContext=context.snapContext,shape=context.shape,target=context.target,snapLocations=snapContext.getSnapLocations();if(!target)return;var snapPoints=snapContext.pointsForTarget(target);snapPoints.initialized||(this.addTargetSnaps(snapPoints,shape,target),snapPoints.initialized=!0);var snapping={x:(0,_SnapUtil.isSnapped)(event,'x'),y:(0,_SnapUtil.isSnapped)(event,'y')};(0,_minDash.forEach)(snapLocations,function(location){var snapOrigin=snapContext.getSnapOrigin(location);var snapCurrent={x:event.x+snapOrigin.x,y:event.y+snapOrigin.y};return(0,_minDash.forEach)(['x','y'],function(axis){var locationSnapping;snapping[axis]||(locationSnapping=snapPoints.snap(snapCurrent,location,axis,7),locationSnapping!==undefined&&(snapping[axis]={value:locationSnapping,originValue:locationSnapping-snapOrigin[axis]}));}),snapping.x&&snapping.y?!1:void 0;}),this.showSnapLine('vertical',snapping.x&&snapping.x.value),this.showSnapLine('horizontal',snapping.y&&snapping.y.value),(0,_minDash.forEach)(['x','y'],function(axis){var axisSnapping=snapping[axis];(axisSnapping===void 0?'undefined':_typeof(axisSnapping))==='object'&&(0,_SnapUtil.setSnapped)(event,axis,axisSnapping.originValue);});},Snapping.prototype._createLine=function(orientation){var root=this._canvas.getLayer('snap');var line=(0,_tinySvg.create)('path');return(0,_tinySvg.attr)(line,{d:'M0,0 L0,0'}),(0,_tinySvg.classes)(line).add('djs-snap-line'),(0,_tinySvg.append)(root,line),{update:function update(position){typeof position!=='number'?(0,_tinySvg.attr)(line,{display:'none'}):orientation==='horizontal'?(0,_tinySvg.attr)(line,{d:'M-100000,'+position+' L+100000,'+position,display:''}):(0,_tinySvg.attr)(line,{d:'M '+position+',-100000 L '+position+', +100000',display:''});}};},Snapping.prototype._createSnapLines=function(){this._snapLines={horizontal:this._createLine('horizontal'),vertical:this._createLine('vertical')};},Snapping.prototype.showSnapLine=function(orientation,position){var line=this.getSnapLine(orientation);line&&line.update(position),this._asyncHide();},Snapping.prototype.getSnapLine=function(orientation){return this._snapLines||this._createSnapLines(),this._snapLines[orientation];},Snapping.prototype.hide=function(){(0,_minDash.forEach)(this._snapLines,function(l){l.update();});},Snapping.prototype.addTargetSnaps=function(snapPoints,shape,target){var siblings=this.getSiblings(shape,target);(0,_minDash.forEach)(siblings,function(s){snapPoints.add('mid',(0,_SnapUtil.mid)(s));});},Snapping.prototype.getSiblings=function(element,target){return target&&(0,_minDash.filter)(target.children,function(e){return!e.hidden&&!e.labelTarget&&e.host!==element&&e!==element;});};},{'./SnapContext':299,'./SnapUtil':300,'min-dash':438,'tiny-svg':468}],302:[function(require,module,exports){'use strict';function SpaceTool(eventBus,dragging,canvas,modeling,rules,toolManager){this._canvas=canvas,this._dragging=dragging,this._modeling=modeling,this._rules=rules,this._toolManager=toolManager;var self=this;toolManager.registerTool('space',{tool:'spaceTool.selection',dragging:'spaceTool'}),eventBus.on('spaceTool.selection.end',function(event){var target=event.originalEvent.target;if(!(event.hover||target instanceof SVGElement))return;eventBus.once('spaceTool.selection.ended',function(){self.activateMakeSpace(event.originalEvent);});}),eventBus.on('spaceTool.move',HIGH_PRIORITY,function(event){var context=event.context;context.initialized||(context.initialized=self.initializeMakeSpace(event,context));}),eventBus.on('spaceTool.end',function(event){var context=event.context,axis=context.axis,direction=context.direction,movingShapes=context.movingShapes,resizingShapes=context.resizingShapes;if(!context.initialized)return;var delta={x:round(event.dx),y:round(event.dy)};delta[AXIS_INVERTED[axis]]=0;var insideBounds=!0;(0,_minDash.forEach)(resizingShapes,function(shape){if(direction==='w'&&event.x>shape.x+shape.width||direction==='e'&&event.x<shape.x||direction==='n'&&event.y>shape.y+shape.height||direction==='s'&&event.y<shape.y){insideBounds=!1;return;}}),insideBounds&&self.makeSpace(movingShapes,resizingShapes,delta,direction),eventBus.once('spaceTool.ended',function(event){self.activateSelection(event.originalEvent,!0,!0);});});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=SpaceTool;var _SpaceUtil=require('./SpaceUtil');var _Cursor=require('../../util/Cursor');var _Mouse=require('../../util/Mouse');var _Elements=require('../../util/Elements');var _minDash=require('min-dash');var abs=Math.abs,round=Math.round;var HIGH_PRIORITY=1500,SPACE_TOOL_CURSOR='crosshair';var AXIS_TO_DIMENSION={x:'width',y:'height'},AXIS_INVERTED={x:'y',y:'x'};SpaceTool.$inject=['eventBus','dragging','canvas','modeling','rules','toolManager'],SpaceTool.prototype.activateSelection=function(event,autoActivate,reactivate){this._dragging.init(event,'spaceTool.selection',{trapClick:!1,cursor:SPACE_TOOL_CURSOR,autoActivate:autoActivate,data:{context:{reactivate:reactivate}}});},SpaceTool.prototype.activateMakeSpace=function(event){this._dragging.init(event,'spaceTool',{autoActivate:!0,cursor:SPACE_TOOL_CURSOR,data:{context:{}}});},SpaceTool.prototype.makeSpace=function(movingShapes,resizingShapes,delta,direction){return this._modeling.createSpace(movingShapes,resizingShapes,delta,direction);},SpaceTool.prototype.initializeMakeSpace=function(event,context){var axis=abs(event.dx)>abs(event.dy)?'x':'y',offset=event['d'+axis],spacePos=event[axis]-offset;if(abs(offset)<5)return!1;offset<0&&(offset*=-1),(0,_Mouse.hasPrimaryModifier)(event)&&(offset*=-1);var rootShape=this._canvas.getRootElement();var allShapes=(0,_Elements.selfAndAllChildren)(rootShape,!0);var adjustments=this.calculateAdjustments(allShapes,axis,offset,spacePos);return(0,_minDash.assign)(context,adjustments,{axis:axis,direction:(0,_SpaceUtil.getDirection)(axis,offset)}),(0,_Cursor.set)('resize-'+(axis==='x'?'ew':'ns')),!0;},SpaceTool.prototype.calculateAdjustments=function(elements,axis,offset,spacePos){var movingShapes=[],resizingShapes=[];var rules=this._rules;return elements.forEach(function(shape){var shapeStart=shape[axis],shapeEnd=shapeStart+shape[AXIS_TO_DIMENSION[axis]];return shape.parent?shape.waypoints?void 0:offset>0&&shapeStart>spacePos?movingShapes.push(shape):offset<0&&shapeEnd<spacePos?movingShapes.push(shape):shapeStart<spacePos&&shapeEnd>spacePos&&rules.allowed('shape.resize',{shape:shape})?resizingShapes.push(shape):void 0:void 0;}),{movingShapes:movingShapes,resizingShapes:resizingShapes};},SpaceTool.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.activateSelection();},SpaceTool.prototype.isActive=function(){var context=this._dragging.context();return context&&/^spaceTool/.test(context.prefix);};},{'../../util/Cursor':330,'../../util/Elements':331,'../../util/Mouse':338,'./SpaceUtil':304,'min-dash':438}],303:[function(require,module,exports){'use strict';function SpaceToolPreview(eventBus,elementRegistry,canvas,styles,previewSupport){function addPreviewGfx(collection,dragGroup){(0,_minDash.forEach)(collection,function(element){previewSupport.addDragger(element,dragGroup),canvas.addMarker(element,MARKER_DRAGGING);});}eventBus.on('spaceTool.selection.start',function(event){var space=canvas.getLayer('space'),context=event.context;var orientation={x:'M 0,-10000 L 0,10000',y:'M -10000,0 L 10000,0'};var crosshairGroup=(0,_tinySvg.create)('g');(0,_tinySvg.attr)(crosshairGroup,styles.cls('djs-crosshair-group',['no-events'])),(0,_tinySvg.append)(space,crosshairGroup);var pathX=(0,_tinySvg.create)('path');(0,_tinySvg.attr)(pathX,'d',orientation.x),(0,_tinySvg.classes)(pathX).add('djs-crosshair'),(0,_tinySvg.append)(crosshairGroup,pathX);var pathY=(0,_tinySvg.create)('path');(0,_tinySvg.attr)(pathY,'d',orientation.y),(0,_tinySvg.classes)(pathY).add('djs-crosshair'),(0,_tinySvg.append)(crosshairGroup,pathY),context.crosshairGroup=crosshairGroup;}),eventBus.on('spaceTool.selection.move',function(event){var crosshairGroup=event.context.crosshairGroup;(0,_SvgTransformUtil.translate)(crosshairGroup,event.x,event.y);}),eventBus.on('spaceTool.selection.cleanup',function(event){var context=event.context,crosshairGroup=context.crosshairGroup;crosshairGroup&&(0,_tinySvg.remove)(crosshairGroup);}),eventBus.on('spaceTool.move',LOW_PRIORITY,function(event){var context=event.context,line=context.line,axis=context.axis,movingShapes=context.movingShapes,resizingShapes=context.resizingShapes;if(!context.initialized)return;if(!context.dragGroup){var spaceLayer=canvas.getLayer('space');line=(0,_tinySvg.create)('path'),(0,_tinySvg.attr)(line,'d','M0,0 L0,0'),(0,_tinySvg.classes)(line).add('djs-crosshair'),(0,_tinySvg.append)(spaceLayer,line),context.line=line;var dragGroup=(0,_tinySvg.create)('g');(0,_tinySvg.attr)(dragGroup,styles.cls('djs-drag-group',['no-events'])),(0,_tinySvg.append)(canvas.getDefaultLayer(),dragGroup),addPreviewGfx(movingShapes,dragGroup);var movingConnections=context.movingConnections=elementRegistry.filter(function(element){var sourceIsMoving=!1;(0,_minDash.forEach)(movingShapes,function(shape){(0,_minDash.forEach)(shape.outgoing,function(connection){element===connection&&(sourceIsMoving=!0);});});var targetIsMoving=!1;(0,_minDash.forEach)(movingShapes,function(shape){(0,_minDash.forEach)(shape.incoming,function(connection){element===connection&&(targetIsMoving=!0);});});var sourceIsResizing=!1;(0,_minDash.forEach)(resizingShapes,function(shape){(0,_minDash.forEach)(shape.outgoing,function(connection){element===connection&&(sourceIsResizing=!0);});});var targetIsResizing=!1;return(0,_minDash.forEach)(resizingShapes,function(shape){(0,_minDash.forEach)(shape.incoming,function(connection){element===connection&&(targetIsResizing=!0);});}),isConnection(element)&&(sourceIsMoving||sourceIsResizing)&&(targetIsMoving||targetIsResizing);});addPreviewGfx(movingConnections,dragGroup),context.dragGroup=dragGroup;}if(!context.frameGroup){var frameGroup=(0,_tinySvg.create)('g');(0,_tinySvg.attr)(frameGroup,styles.cls('djs-frame-group',['no-events'])),(0,_tinySvg.append)(canvas.getDefaultLayer(),frameGroup);var frames=[];(0,_minDash.forEach)(resizingShapes,function(shape){var frame=previewSupport.addFrame(shape,frameGroup);frames.push({element:frame,initialWidth:frame.getBBox().width,initialHeight:frame.getBBox().height}),canvas.addMarker(shape,MARKER_RESIZING);}),context.frameGroup=frameGroup,context.frames=frames;}var orientation={x:'M'+event.x+', -10000 L'+event.x+', 10000',y:'M -10000, '+event.y+' L 10000, '+event.y};(0,_tinySvg.attr)(line,{path:orientation[axis],display:''});var opposite={x:'y',y:'x'};var delta={x:event.dx,y:event.dy};delta[opposite[context.axis]]=0,(0,_SvgTransformUtil.translate)(context.dragGroup,delta.x,delta.y),(0,_minDash.forEach)(context.frames,function(frame){frame.initialWidth+delta.x>5&&(0,_tinySvg.attr)(frame.element,{width:frame.initialWidth+delta.x}),frame.initialHeight+delta.y>5&&(0,_tinySvg.attr)(frame.element,{height:frame.initialHeight+delta.y});});}),eventBus.on('spaceTool.cleanup',function(event){var context=event.context,movingShapes=context.movingShapes,movingConnections=context.movingConnections,resizingShapes=context.resizingShapes,line=context.line,dragGroup=context.dragGroup,frameGroup=context.frameGroup;(0,_minDash.forEach)(movingShapes,function(shape){canvas.removeMarker(shape,MARKER_DRAGGING);}),(0,_minDash.forEach)(movingConnections,function(connection){canvas.removeMarker(connection,MARKER_DRAGGING);}),dragGroup&&((0,_tinySvg.remove)(line),(0,_tinySvg.remove)(dragGroup)),(0,_minDash.forEach)(resizingShapes,function(shape){canvas.removeMarker(shape,MARKER_RESIZING);}),frameGroup&&(0,_tinySvg.remove)(frameGroup);});}function isConnection(element){return element.waypoints;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=SpaceToolPreview;var _minDash=require('min-dash');var _tinySvg=require('tiny-svg');var _SvgTransformUtil=require('../../util/SvgTransformUtil');var MARKER_DRAGGING='djs-dragging',MARKER_RESIZING='djs-resizing';var LOW_PRIORITY=250;SpaceToolPreview.$inject=['eventBus','elementRegistry','canvas','styles','previewSupport'];},{'../../util/SvgTransformUtil':343,'min-dash':438,'tiny-svg':468}],304:[function(require,module,exports){'use strict';function getDirection(axis,offset){if(axis==='x'){if(offset>0)return'e';if(offset<0)return'w';}if(axis==='y'){if(offset>0)return's';if(offset<0)return'n';}return null;}function resizeBounds(bounds,direction,delta){var dx=delta.x,dy=delta.y;switch(direction){case'n':return{x:bounds.x,y:bounds.y+dy,width:bounds.width,height:bounds.height-dy};case's':return{x:bounds.x,y:bounds.y,width:bounds.width,height:bounds.height+dy};case'w':return{x:bounds.x+dx,y:bounds.y,width:bounds.width-dx,height:bounds.height};case'e':return{x:bounds.x,y:bounds.y,width:bounds.width+dx,height:bounds.height};default:throw new Error('unrecognized direction: '+direction);}}Object.defineProperty(exports,'__esModule',{value:!0}),exports.getDirection=getDirection,exports.resizeBounds=resizeBounds;},{}],305:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _dragging=require('../dragging');var _dragging2=_interopRequireDefault(_dragging);var _rules=require('../rules');var _rules2=_interopRequireDefault(_rules);var _toolManager=require('../tool-manager');var _toolManager2=_interopRequireDefault(_toolManager);var _previewSupport=require('../preview-support');var _previewSupport2=_interopRequireDefault(_previewSupport);var _SpaceTool=require('./SpaceTool');var _SpaceTool2=_interopRequireDefault(_SpaceTool);var _SpaceToolPreview=require('./SpaceToolPreview');var _SpaceToolPreview2=_interopRequireDefault(_SpaceToolPreview);exports.default={__init__:['spaceToolPreview'],__depends__:[_dragging2.default,_rules2.default,_toolManager2.default,_previewSupport2.default],spaceTool:['type',_SpaceTool2.default],spaceToolPreview:['type',_SpaceToolPreview2.default]};},{'../dragging':228,'../preview-support':282,'../rules':292,'../tool-manager':307,'./SpaceTool':302,'./SpaceToolPreview':303}],306:[function(require,module,exports){'use strict';function ToolManager(eventBus,dragging){this._eventBus=eventBus,this._dragging=dragging,this._tools=[],this._active=null;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=ToolManager;var _minDash=require('min-dash');var LOW_PRIORITY=250;ToolManager.$inject=['eventBus','dragging'],ToolManager.prototype.registerTool=function(name,events){var tools=this._tools;if(!events)throw new Error('A tool has to be registered with it\'s "events"');tools.push(name),this.bindEvents(name,events);},ToolManager.prototype.isActive=function(tool){return tool&&this._active===tool;},ToolManager.prototype.length=function(tool){return this._tools.length;},ToolManager.prototype.setActive=function(tool){var eventBus=this._eventBus;this._active!==tool&&(this._active=tool,eventBus.fire('tool-manager.update',{tool:tool}));},ToolManager.prototype.bindEvents=function(name,events){var eventBus=this._eventBus,dragging=this._dragging;var eventsToRegister=[];eventBus.on(events.tool+'.init',function(event){var context=event.context;if(!context.reactivate&&this.isActive(name)){this.setActive(null),dragging.cancel();return;}this.setActive(name);},this),(0,_minDash.forEach)(events,function(event){eventsToRegister.push(event+'.ended'),eventsToRegister.push(event+'.canceled');}),eventBus.on(eventsToRegister,LOW_PRIORITY,function(event){var originalEvent=event.originalEvent;if(!this._active||originalEvent&&originalEvent.target.parentNode.getAttribute('data-group')==='tools')return;this.setActive(null);},this);};},{'min-dash':438}],307:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _dragging=require('../dragging');var _dragging2=_interopRequireDefault(_dragging);var _ToolManager=require('./ToolManager');var _ToolManager2=_interopRequireDefault(_ToolManager);exports.default={__depends__:[_dragging2.default],__init__:['toolManager'],toolManager:['type',_ToolManager2.default]};},{'../dragging':228,'./ToolManager':306}],308:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function createRoot(parent){var root=(0,_minDom.domify)('<div class="djs-tooltip-container" style="position: absolute; width: 0; height: 0;" />');return parent.insertBefore(root,parent.firstChild),root;}function setPosition(el,x,y){(0,_minDash.assign)(el.style,{left:x+'px',top:y+'px'});}function setVisible(el,visible){el.style.display=visible===!1?'none':'';}function Tooltips(eventBus,canvas){this._eventBus=eventBus,this._canvas=canvas,this._ids=ids,this._tooltipDefaults={show:{minZoom:0.7,maxZoom:5}},this._tooltips={},this._tooltipRoot=createRoot(canvas.getContainer());var self=this;_minDom.delegate.bind(this._tooltipRoot,tooltipSelector,'mousedown',function(event){event.stopPropagation();}),_minDom.delegate.bind(this._tooltipRoot,tooltipSelector,'mouseover',function(event){self.trigger('mouseover',event);}),_minDom.delegate.bind(this._tooltipRoot,tooltipSelector,'mouseout',function(event){self.trigger('mouseout',event);}),this._init();}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=Tooltips;var _minDash=require('min-dash');var _minDom=require('min-dom');var _IdGenerator=require('../../util/IdGenerator');var _IdGenerator2=_interopRequireDefault(_IdGenerator);var ids=new _IdGenerator2.default('tt');var tooltipClass='djs-tooltip',tooltipSelector='.'+tooltipClass;Tooltips.$inject=['eventBus','canvas'],Tooltips.prototype.add=function(tooltip){if(!tooltip.position)throw new Error('must specifiy tooltip position');if(!tooltip.html)throw new Error('must specifiy tooltip html');var id=this._ids.next();return tooltip=(0,_minDash.assign)({},this._tooltipDefaults,tooltip,{id:id}),this._addTooltip(tooltip),tooltip.timeout&&this.setTimeout(tooltip),id;},Tooltips.prototype.trigger=function(action,event){var node=event.delegateTarget||event.target;var tooltip=this.get((0,_minDom.attr)(node,'data-tooltip-id'));if(!tooltip)return;action==='mouseover'&&tooltip.timeout&&this.clearTimeout(tooltip),action==='mouseout'&&tooltip.timeout&&(tooltip.timeout=1000,this.setTimeout(tooltip));},Tooltips.prototype.get=function(id){return typeof id!=='string'&&(id=id.id),this._tooltips[id];},Tooltips.prototype.clearTimeout=function(tooltip){if(tooltip=this.get(tooltip),!tooltip)return;var removeTimer=tooltip.removeTimer;removeTimer&&(clearTimeout(removeTimer),tooltip.removeTimer=null);},Tooltips.prototype.setTimeout=function(tooltip){if(tooltip=this.get(tooltip),!tooltip)return;this.clearTimeout(tooltip);var self=this;tooltip.removeTimer=setTimeout(function(){self.remove(tooltip);},tooltip.timeout);},Tooltips.prototype.remove=function(id){var tooltip=this.get(id);tooltip&&((0,_minDom.remove)(tooltip.html),(0,_minDom.remove)(tooltip.htmlContainer),delete tooltip.htmlContainer,delete this._tooltips[tooltip.id]);},Tooltips.prototype.show=function(){setVisible(this._tooltipRoot);},Tooltips.prototype.hide=function(){setVisible(this._tooltipRoot,!1);},Tooltips.prototype._updateRoot=function(viewbox){var a=viewbox.scale||1;var d=viewbox.scale||1;var matrix='matrix('+a+',0,0,'+d+','+-1*viewbox.x*a+','+-1*viewbox.y*d+')';this._tooltipRoot.style.transform=matrix,this._tooltipRoot.style['-ms-transform']=matrix;},Tooltips.prototype._addTooltip=function(tooltip){var id=tooltip.id,html=tooltip.html,htmlContainer,tooltipRoot=this._tooltipRoot;html.get&&html.constructor.prototype.jquery&&(html=html.get(0)),(0,_minDash.isString)(html)&&(html=(0,_minDom.domify)(html)),htmlContainer=(0,_minDom.domify)('<div data-tooltip-id="'+id+'" class="'+tooltipClass+'" style="position: absolute">'),htmlContainer.appendChild(html),tooltip.type&&(0,_minDom.classes)(htmlContainer).add('djs-tooltip-'+tooltip.type),tooltip.className&&(0,_minDom.classes)(htmlContainer).add(tooltip.className),tooltip.htmlContainer=htmlContainer,tooltipRoot.appendChild(htmlContainer),this._tooltips[id]=tooltip,this._updateTooltip(tooltip);},Tooltips.prototype._updateTooltip=function(tooltip){var position=tooltip.position,htmlContainer=tooltip.htmlContainer;setPosition(htmlContainer,position.x,position.y);},Tooltips.prototype._updateTooltipVisibilty=function(viewbox){(0,_minDash.forEach)(this._tooltips,function(tooltip){var show=tooltip.show,htmlContainer=tooltip.htmlContainer,visible=!0;show&&((show.minZoom>viewbox.scale||show.maxZoom<viewbox.scale)&&(visible=!1),setVisible(htmlContainer,visible));});},Tooltips.prototype._init=function(){function updateViewbox(viewbox){self._updateRoot(viewbox),self._updateTooltipVisibilty(viewbox),self.show();}var self=this;this._eventBus.on('canvas.viewbox.changing',function(event){self.hide();}),this._eventBus.on('canvas.viewbox.changed',function(event){updateViewbox(event.viewbox);});};},{'../../util/IdGenerator':335,'min-dash':438,'min-dom':439}],309:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _Tooltips=require('./Tooltips');var _Tooltips2=_interopRequireDefault(_Tooltips);exports.default={__init__:['tooltips'],tooltips:['type',_Tooltips2.default]};},{'./Tooltips':308}],310:[function(require,module,exports){'use strict';function TouchFix(canvas,eventBus){var self=this;eventBus.on('canvas.init',function(e){self.addBBoxMarker(e.svg);});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=TouchFix;var _tinySvg=require('tiny-svg');TouchFix.$inject=['canvas','eventBus'],TouchFix.prototype.addBBoxMarker=function(svg){var markerStyle={fill:'none',class:'outer-bound-marker'};var rect1=(0,_tinySvg.create)('rect');(0,_tinySvg.attr)(rect1,{x:-10000,y:10000,width:10,height:10}),(0,_tinySvg.attr)(rect1,markerStyle),(0,_tinySvg.append)(svg,rect1);var rect2=(0,_tinySvg.create)('rect');(0,_tinySvg.attr)(rect2,{x:10000,y:10000,width:10,height:10}),(0,_tinySvg.attr)(rect2,markerStyle),(0,_tinySvg.append)(svg,rect2);};},{'tiny-svg':468}],311:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function log(){}function get(service,injector){return injector.get(service,!1);}function stopEvent(event){event.preventDefault(),event.stopPropagation(),typeof event.stopImmediatePropagation==='function'&&event.stopImmediatePropagation();}function createTouchRecognizer(node){function stopMouse(event){(0,_minDash.forEach)(mouseEvents,function(e){_minDom.event.bind(node,e,stopEvent,!0);});}function allowMouse(event){setTimeout(function(){(0,_minDash.forEach)(mouseEvents,function(e){_minDom.event.unbind(node,e,stopEvent,!0);});},500);}_minDom.event.bind(node,'touchstart',stopMouse,!0),_minDom.event.bind(node,'touchend',allowMouse,!0),_minDom.event.bind(node,'touchcancel',allowMouse,!0);var recognizer=new _hammerjs2.default.Manager(node,{inputClass:_hammerjs2.default.TouchInput,recognizers:[]});var tap=new _hammerjs2.default.Tap();var pan=new _hammerjs2.default.Pan({threshold:10});var press=new _hammerjs2.default.Press();var pinch=new _hammerjs2.default.Pinch();var doubleTap=new _hammerjs2.default.Tap({event:'doubletap',taps:2});return pinch.requireFailure(pan),pinch.requireFailure(press),recognizer.add([pan,press,pinch,doubleTap,tap]),recognizer.reset=function(force){var recognizers=this.recognizers,session=this.session;if(session.stopped)return;log('recognizer','stop'),recognizer.stop(force),setTimeout(function(){var i,r;for(log('recognizer','reset'),i=0;r=recognizers[i];i++)r.reset(),r.state=8;session.curRecognizer=null;},0);},recognizer.on('hammer.input',function(event){event.srcEvent.defaultPrevented&&recognizer.reset(!0);}),recognizer;}function TouchInteractionEvents(injector,canvas,eventBus,elementRegistry,interactionEvents){function handler(type){return function(event){log('element',type,event),interactionEvents.fire(type,event);};}function getGfx(target){var node=(0,_minDom.closest)(target,'svg, .djs-element',!0);return node;}function initEvents(svg){function startGrabCanvas(event){function update(e){var dx=e.deltaX-lx,dy=e.deltaY-ly;canvas.scroll({dx:dx,dy:dy}),lx=e.deltaX,ly=e.deltaY;}function end(e){recognizer.off('panmove',update),recognizer.off('panend',end),recognizer.off('pancancel',end),log('canvas','grab end');}log('canvas','grab start');var lx=0,ly=0;recognizer.on('panmove',update),recognizer.on('panend',end),recognizer.on('pancancel',end);}function startGrab(event){var gfx=getGfx(event.target),element=gfx&&elementRegistry.get(gfx);if(move&&canvas.getRootElement()!==element)return log('element','move start',element,event,!0),move.start(event,element,!0);else startGrabCanvas(event);}function startZoom(e){function update(e){var ratio=1-(1-e.scale)/1.5,newZoom=Math.max(MIN_ZOOM,Math.min(MAX_ZOOM,ratio*zoom));canvas.zoom(newZoom,mid),stopEvent(e);}function end(e){recognizer.off('pinchmove',update),recognizer.off('pinchend',end),recognizer.off('pinchcancel',end),recognizer.reset(!0),log('canvas','zoom end');}log('canvas','zoom start');var zoom=canvas.zoom(),mid=e.center;recognizer.on('pinchmove',update),recognizer.on('pinchend',end),recognizer.on('pinchcancel',end);}recognizer=createTouchRecognizer(svg),recognizer.on('doubletap',handler('element.dblclick')),recognizer.on('tap',handler('element.click')),recognizer.on('panstart',startGrab),recognizer.on('press',startGrab),recognizer.on('pinchstart',startZoom);}var dragging=get('dragging',injector),move=get('move',injector),contextPad=get('contextPad',injector),palette=get('palette',injector);var recognizer;dragging&&eventBus.on('drag.move',function(event){var originalEvent=event.originalEvent;if(!originalEvent||originalEvent instanceof MouseEvent)return;var position=(0,_Event.toPoint)(originalEvent);var node=document.elementFromPoint(position.x,position.y),gfx=getGfx(node),element=gfx&&elementRegistry.get(gfx);element!==event.hover&&(event.hover&&dragging.out(event),element&&(dragging.hover({element:element,gfx:gfx}),event.hover=element,event.hoverGfx=gfx));}),contextPad&&eventBus.on('contextPad.create',function(event){var node=event.pad.html;var padRecognizer=createTouchRecognizer(node);padRecognizer.on('panstart',function(event){log('context-pad','panstart',event),contextPad.trigger('dragstart',event,!0);}),padRecognizer.on('press',function(event){log('context-pad','press',event),contextPad.trigger('dragstart',event,!0);}),padRecognizer.on('tap',function(event){log('context-pad','tap',event),contextPad.trigger('click',event);});}),palette&&eventBus.on('palette.create',function(event){var node=event.container;var padRecognizer=createTouchRecognizer(node);padRecognizer.on('panstart',function(event){log('palette','panstart',event),palette.trigger('dragstart',event,!0);}),padRecognizer.on('press',function(event){log('palette','press',event),palette.trigger('dragstart',event,!0);}),padRecognizer.on('tap',function(event){log('palette','tap',event),palette.trigger('click',event);});}),eventBus.on('canvas.init',function(event){initEvents(event.svg);});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=TouchInteractionEvents;var _minDash=require('min-dash');var _minDom=require('min-dom');var _hammerjs=require('hammerjs');var _hammerjs2=_interopRequireDefault(_hammerjs);var _Event=require('../../util/Event');var MIN_ZOOM=0.2,MAX_ZOOM=4;var mouseEvents=['mousedown','mouseup','mouseover','mouseout','click','dblclick'];TouchInteractionEvents.$inject=['injector','canvas','eventBus','elementRegistry','interactionEvents','touchFix'];},{'../../util/Event':332,hammerjs:347,'min-dash':438,'min-dom':439}],312:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _interactionEvents=require('../interaction-events');var _interactionEvents2=_interopRequireDefault(_interactionEvents);var _TouchInteractionEvents=require('./TouchInteractionEvents');var _TouchInteractionEvents2=_interopRequireDefault(_TouchInteractionEvents);var _TouchFix=require('./TouchFix');var _TouchFix2=_interopRequireDefault(_TouchFix);exports.default={__depends__:[_interactionEvents2.default],__init__:['touchInteractionEvents'],touchInteractionEvents:['type',_TouchInteractionEvents2.default],touchFix:['type',_TouchFix2.default]};},{'../interaction-events':236,'./TouchFix':310,'./TouchInteractionEvents':311}],313:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _translate=require('./translate');var _translate2=_interopRequireDefault(_translate);exports.default={translate:['value',_translate2.default]};},{'./translate':314}],314:[function(require,module,exports){'use strict';function translate(template,replacements){return replacements=replacements||{},template.replace(/{([^}]+)}/g,function(_,key){return replacements[key]||'{'+key+'}';});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=translate;},{}],315:[function(require,module,exports){'use strict';function BaseLayouter(){}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=BaseLayouter;var _LayoutUtil=require('./LayoutUtil');BaseLayouter.prototype.layoutConnection=function(connection,hints){return hints=hints||{},[hints.connectionStart||(0,_LayoutUtil.getMid)(connection.source),hints.connectionEnd||(0,_LayoutUtil.getMid)(connection.target)];};},{'./LayoutUtil':317}],316:[function(require,module,exports){'use strict';function dockingToPoint(docking){return(0,_minDash.assign)({original:docking.point.original||docking.point},docking.actual);}function CroppingConnectionDocking(elementRegistry,graphicsFactory){this._elementRegistry=elementRegistry,this._graphicsFactory=graphicsFactory;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=CroppingConnectionDocking;var _minDash=require('min-dash');var _LayoutUtil=require('./LayoutUtil');CroppingConnectionDocking.$inject=['elementRegistry','graphicsFactory'],CroppingConnectionDocking.prototype.getCroppedWaypoints=function(connection,source,target){source=source||connection.source,target=target||connection.target;var sourceDocking=this.getDockingPoint(connection,source,!0),targetDocking=this.getDockingPoint(connection,target);var croppedWaypoints=connection.waypoints.slice(sourceDocking.idx+1,targetDocking.idx);return croppedWaypoints.unshift(dockingToPoint(sourceDocking)),croppedWaypoints.push(dockingToPoint(targetDocking)),croppedWaypoints;},CroppingConnectionDocking.prototype.getDockingPoint=function(connection,shape,dockStart){var waypoints=connection.waypoints,dockingIdx,dockingPoint,croppedPoint;return dockingIdx=dockStart?0:waypoints.length-1,dockingPoint=waypoints[dockingIdx],croppedPoint=this._getIntersection(shape,connection,dockStart),{point:dockingPoint,actual:croppedPoint||dockingPoint,idx:dockingIdx};},CroppingConnectionDocking.prototype._getIntersection=function(shape,connection,takeFirst){var shapePath=this._getShapePath(shape),connectionPath=this._getConnectionPath(connection);return(0,_LayoutUtil.getElementLineIntersection)(shapePath,connectionPath,takeFirst);},CroppingConnectionDocking.prototype._getConnectionPath=function(connection){return this._graphicsFactory.getConnectionPath(connection);},CroppingConnectionDocking.prototype._getShapePath=function(shape){return this._graphicsFactory.getShapePath(shape);},CroppingConnectionDocking.prototype._getGfx=function(element){return this._elementRegistry.getGraphics(element);};},{'./LayoutUtil':317,'min-dash':438}],317:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function roundBounds(bounds){return{x:Math.round(bounds.x),y:Math.round(bounds.y),width:Math.round(bounds.width),height:Math.round(bounds.height)};}function roundPoint(point){return{x:Math.round(point.x),y:Math.round(point.y)};}function asTRBL(bounds){return{top:bounds.y,right:bounds.x+(bounds.width||0),bottom:bounds.y+(bounds.height||0),left:bounds.x};}function asBounds(trbl){return{x:trbl.left,y:trbl.top,width:trbl.right-trbl.left,height:trbl.bottom-trbl.top};}function getMid(bounds){return roundPoint({x:bounds.x+(bounds.width||0)/2,y:bounds.y+(bounds.height||0)/2});}function getOrientation(rect,reference,padding){padding=padding||0,(0,_minDash.isObject)(padding)||(padding={x:padding,y:padding});var rectOrientation=asTRBL(rect),referenceOrientation=asTRBL(reference);var top=rectOrientation.bottom+padding.y<=referenceOrientation.top,right=rectOrientation.left-padding.x>=referenceOrientation.right,bottom=rectOrientation.top-padding.y>=referenceOrientation.bottom,left=rectOrientation.right+padding.x<=referenceOrientation.left;var vertical=top?'top':bottom?'bottom':null,horizontal=left?'left':right?'right':null;return horizontal&&vertical?vertical+'-'+horizontal:horizontal||vertical||'intersect';}function getElementLineIntersection(elementPath,linePath,cropStart){var intersections=getIntersections(elementPath,linePath);if(intersections.length===1)return roundPoint(intersections[0]);else if(intersections.length===2&&(0,_Geometry.pointDistance)(intersections[0],intersections[1])<1)return roundPoint(intersections[0]);else if(intersections.length>1)return intersections=(0,_minDash.sortBy)(intersections,function(i){var distance=Math.floor(i.t2*100)||1;return distance=100-distance,distance=(distance<10?'0':'')+distance,i.segment2+'#'+distance;}),roundPoint(intersections[cropStart?0:intersections.length-1]);return null;}function getIntersections(a,b){return(0,_pathIntersection2.default)(a,b);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.roundBounds=roundBounds,exports.roundPoint=roundPoint,exports.asTRBL=asTRBL,exports.asBounds=asBounds,exports.getMid=getMid,exports.getOrientation=getOrientation,exports.getElementLineIntersection=getElementLineIntersection,exports.getIntersections=getIntersections;var _minDash=require('min-dash');var _Geometry=require('../util/Geometry');var _pathIntersection=require('path-intersection');var _pathIntersection2=_interopRequireDefault(_pathIntersection);},{'../util/Geometry':333,'min-dash':438,'path-intersection':456}],318:[function(require,module,exports){'use strict';function getBendpoints(a,b,directions){directions=directions||'h:h';var xmid,ymid;if(directions==='h:v')return[{x:b.x,y:a.y}];else if(directions==='v:h')return[{x:a.x,y:b.y}];else if(directions==='h:h')return xmid=Math.round((b.x-a.x)/2+a.x),[{x:xmid,y:a.y},{x:xmid,y:b.y}];else if(directions==='v:v')return ymid=Math.round((b.y-a.y)/2+a.y),[{x:a.x,y:ymid},{x:b.x,y:ymid}];else throw new Error('unknown directions: <'+directions+'>: '+'directions must be specified as {a direction}:{b direction} (direction in h|v)');}function connectPoints(a,b,directions){var points=[];return(0,_Geometry.pointsAligned)(a,b)||(points=getBendpoints(a,b,directions)),points.unshift(a),points.push(b),points;}function connectRectangles(source,target,start,end,hints){var preferredLayouts=hints&&hints.preferredLayouts||[];var preferredLayout=(0,_minDash.without)(preferredLayouts,'straight')[0]||'h:h';var threshold=ORIENTATION_THRESHOLD[preferredLayout]||0;var orientation=(0,_LayoutUtil.getOrientation)(source,target,threshold);var directions=getDirections(orientation,preferredLayout);if(start=start||(0,_LayoutUtil.getMid)(source),end=end||(0,_LayoutUtil.getMid)(target),!directions)return;if(directions==='h:h')switch(orientation){case'top-right':case'right':case'bottom-right':start={original:start,x:source.x,y:start.y};end={original:end,x:target.x+target.width,y:end.y};break;case'top-left':case'left':case'bottom-left':start={original:start,x:source.x+source.width,y:start.y};end={original:end,x:target.x,y:end.y};break;}if(directions==='v:v')switch(orientation){case'top-left':case'top':case'top-right':start={original:start,x:start.x,y:source.y+source.height};end={original:end,x:end.x,y:target.y};break;case'bottom-left':case'bottom':case'bottom-right':start={original:start,x:start.x,y:source.y};end={original:end,x:end.x,y:target.y+target.height};break;}return connectPoints(start,end,directions);}function repairConnection(source,target,start,end,waypoints,hints){(0,_minDash.isArray)(start)&&(waypoints=start,hints=end,start=(0,_LayoutUtil.getMid)(source),end=(0,_LayoutUtil.getMid)(target)),hints=(0,_minDash.assign)({preferredLayouts:[]},hints),waypoints=waypoints||[];var preferredLayouts=hints.preferredLayouts,preferStraight=preferredLayouts.indexOf('straight')!==-1,repairedWaypoints;return preferStraight&&(repairedWaypoints=layoutStraight(source,target,start,end,hints)),repairedWaypoints||(hints.connectionEnd?(repairedWaypoints=_repairConnectionSide(target,source,end,waypoints.slice().reverse()),repairedWaypoints=repairedWaypoints&&repairedWaypoints.reverse()):hints.connectionStart?repairedWaypoints=_repairConnectionSide(source,target,start,waypoints):waypoints&&waypoints.length&&(repairedWaypoints=waypoints)),repairedWaypoints||(repairedWaypoints=connectRectangles(source,target,start,end,hints)),repairedWaypoints;}function inRange(a,start,end){return a>=start&&a<=end;}function isInRange(axis,a,b){var size={x:'width',y:'height'};return inRange(a[axis],b[axis],b[axis]+b[size[axis]]);}function layoutStraight(source,target,start,end,hints){var axis={},primaryAxis,orientation;return orientation=(0,_LayoutUtil.getOrientation)(source,target),/^(top|bottom|left|right)$/.test(orientation)?(/top|bottom/.test(orientation)&&(primaryAxis='x'),/left|right/.test(orientation)&&(primaryAxis='y'),hints.preserveDocking==='target'?isInRange(primaryAxis,end,source)?(axis[primaryAxis]=end[primaryAxis],[{x:axis.x!==undefined?axis.x:start.x,y:axis.y!==undefined?axis.y:start.y,original:{x:axis.x!==undefined?axis.x:start.x,y:axis.y!==undefined?axis.y:start.y}},{x:end.x,y:end.y}]):null:isInRange(primaryAxis,start,target)?(axis[primaryAxis]=start[primaryAxis],[{x:start.x,y:start.y},{x:axis.x!==undefined?axis.x:end.x,y:axis.y!==undefined?axis.y:end.y,original:{x:axis.x!==undefined?axis.x:end.x,y:axis.y!==undefined?axis.y:end.y}}]):null):null;}function _repairConnectionSide(moved,other,newDocking,points){function needsRelayout(moved,other,points){return points.length<3?!0:points.length>4?!1:!!(0,_minDash.find)(points,function(p,idx){var q=points[idx-1];return q&&(0,_Geometry.pointDistance)(p,q)<3;});}function repairBendpoint(candidate,oldPeer,newPeer){var alignment=(0,_Geometry.pointsAligned)(oldPeer,candidate);switch(alignment){case'v':return{x:candidate.x,y:newPeer.y};case'h':return{x:newPeer.x,y:candidate.y};}return{x:candidate.x,y:candidate.y};}function removeOverlapping(points,a,b){var i;for(i=points.length-2;i!==0;i--)if((0,_Geometry.pointInRect)(points[i],a,INTERSECTION_THRESHOLD)||(0,_Geometry.pointInRect)(points[i],b,INTERSECTION_THRESHOLD))return points.slice(i);return points;}if(needsRelayout(moved,other,points))return null;var oldDocking=points[0],newPoints=points.slice(),slicedPoints;return newPoints[0]=newDocking,newPoints[1]=repairBendpoint(newPoints[1],oldDocking,newDocking),slicedPoints=removeOverlapping(newPoints,moved,other),slicedPoints!==newPoints?_repairConnectionSide(moved,other,newDocking,slicedPoints):newPoints;}function getDirections(orientation,defaultLayout){switch(orientation){case'intersect':return null;case'top':case'bottom':return'v:v';case'left':case'right':return'h:h';default:return defaultLayout;}}Object.defineProperty(exports,'__esModule',{value:!0}),exports.getBendpoints=getBendpoints,exports.connectPoints=connectPoints,exports.connectRectangles=connectRectangles,exports.repairConnection=repairConnection,exports.layoutStraight=layoutStraight,exports._repairConnectionSide=_repairConnectionSide;var _minDash=require('min-dash');var _LayoutUtil=require('./LayoutUtil');var _Geometry=require('../util/Geometry');var INTERSECTION_THRESHOLD=20,ORIENTATION_THRESHOLD={'h:h':20,'v:v':20,'h:v':-10,'v:h':-10};},{'../util/Geometry':333,'./LayoutUtil':317,'min-dash':438}],319:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function Base(){Object.defineProperty(this,'businessObject',{writable:!0}),parentRefs.bind(this,'parent'),labelRefs.bind(this,'label'),outgoingRefs.bind(this,'outgoing'),incomingRefs.bind(this,'incoming');}function Shape(){Base.call(this),parentRefs.bind(this,'children'),attacherRefs.bind(this,'host'),attacherRefs.bind(this,'attachers');}function Root(){Shape.call(this);}function Label(){Shape.call(this),labelRefs.bind(this,'labelTarget');}function Connection(){Base.call(this),outgoingRefs.bind(this,'source'),incomingRefs.bind(this,'target');}function create(type,attrs){var Type=types[type];if(!Type)throw new Error('unknown type: <'+type+'>');return(0,_minDash.assign)(new Type(),attrs);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.Base=Base,exports.Shape=Shape,exports.Root=Root,exports.Label=Label,exports.Connection=Connection,exports.create=create;var _minDash=require('min-dash');var _inherits=require('inherits');var _inherits2=_interopRequireDefault(_inherits);var _objectRefs=require('object-refs');var _objectRefs2=_interopRequireDefault(_objectRefs);var parentRefs=new _objectRefs2.default({name:'children',enumerable:!0,collection:!0},{name:'parent'}),labelRefs=new _objectRefs2.default({name:'label',enumerable:!0},{name:'labelTarget'}),attacherRefs=new _objectRefs2.default({name:'attachers',collection:!0},{name:'host'}),outgoingRefs=new _objectRefs2.default({name:'outgoing',collection:!0},{name:'source'}),incomingRefs=new _objectRefs2.default({name:'incoming',collection:!0},{name:'target'});(0,_inherits2.default)(Shape,Base),(0,_inherits2.default)(Root,Shape),(0,_inherits2.default)(Label,Shape),(0,_inherits2.default)(Connection,Base);var types={connection:Connection,shape:Shape,label:Label,root:Root};},{inherits:350,'min-dash':438,'object-refs':453}],320:[function(require,module,exports){'use strict';function length(point){return Math.sqrt(Math.pow(point.x,2)+Math.pow(point.y,2));}function MoveCanvas(eventBus,canvas){function handleMove(event){var start=context.start,position=(0,_Event.toPoint)(event),delta=(0,_PositionUtil.delta)(position,start);if(!context.dragging&&length(delta)>THRESHOLD&&(context.dragging=!0,(0,_ClickTrap.install)(eventBus),(0,_Cursor.set)('grab')),context.dragging){var lastPosition=context.last||context.start;delta=(0,_PositionUtil.delta)(position,lastPosition),canvas.scroll({dx:delta.x,dy:delta.y}),context.last=position;}event.preventDefault();}function handleEnd(event){_minDom.event.unbind(document,'mousemove',handleMove),_minDom.event.unbind(document,'mouseup',handleEnd),context=null,(0,_Cursor.unset)();}function handleStart(event){return(0,_minDom.closest)(event.target,'.djs-draggable')?void 0:event.button||event.ctrlKey||event.shiftKey||event.altKey?void 0:(context={start:(0,_Event.toPoint)(event)},_minDom.event.bind(document,'mousemove',handleMove),_minDom.event.bind(document,'mouseup',handleEnd),!0);}var context;eventBus.on('element.mousedown',500,function(e){return handleStart(e.originalEvent);});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=MoveCanvas;var _Cursor=require('../../util/Cursor');var _ClickTrap=require('../../util/ClickTrap');var _PositionUtil=require('../../util/PositionUtil');var _minDom=require('min-dom');var _Event=require('../../util/Event');var THRESHOLD=15;MoveCanvas.$inject=['eventBus','canvas'];},{'../../util/ClickTrap':327,'../../util/Cursor':330,'../../util/Event':332,'../../util/PositionUtil':340,'min-dom':439}],321:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _MoveCanvas=require('./MoveCanvas');var _MoveCanvas2=_interopRequireDefault(_MoveCanvas);exports.default={__init__:['moveCanvas'],moveCanvas:['type',_MoveCanvas2.default]};},{'./MoveCanvas':320}],322:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _touch=require('../../features/touch');var _touch2=_interopRequireDefault(_touch);exports.default={__depends__:[_touch2.default]};},{'../../features/touch':312}],323:[function(require,module,exports){'use strict';function ZoomScroll(config,eventBus,canvas){config=config||{},this._enabled=!1,this._canvas=canvas,this._container=canvas._container,this._handleWheel=(0,_minDash.bind)(this._handleWheel,this),this._totalDelta=0,this._scale=config.scale||DEFAULT_SCALE;var self=this;eventBus.on('canvas.init',function(e){self._init(config.enabled!==!1);});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=ZoomScroll;var _minDom=require('min-dom');var _ZoomUtil=require('./ZoomUtil');var _Math=require('../../util/Math');var _minDash=require('min-dash');var sign=Math.sign||function(n){return n>=0?1:-1;};var RANGE={min:0.2,max:4},NUM_STEPS=10;var DELTA_THRESHOLD=0.1;var DEFAULT_SCALE=0.75;ZoomScroll.$inject=['config.zoomScroll','eventBus','canvas'],ZoomScroll.prototype.scroll=function scroll(delta){this._canvas.scroll(delta);},ZoomScroll.prototype.reset=function reset(){this._canvas.zoom('fit-viewport');},ZoomScroll.prototype.zoom=function zoom(delta,position){var stepSize=(0,_ZoomUtil.getStepSize)(RANGE,NUM_STEPS*2);this._totalDelta+=delta,Math.abs(this._totalDelta)>DELTA_THRESHOLD&&(this._zoom(delta,position,stepSize),this._totalDelta=0);},ZoomScroll.prototype._handleWheel=function handleWheel(event){if((0,_minDom.closest)(event.target,'.djs-scrollable',!0))return;var element=this._container;event.preventDefault();var isZoom=event.ctrlKey;var isHorizontalScroll=event.shiftKey;var factor=-1*this._scale,delta;if(isZoom?factor*=event.deltaMode===0?0.02:0.32:factor*=event.deltaMode===0?1:16,isZoom){var elementRect=element.getBoundingClientRect();var offset={x:event.clientX-elementRect.left,y:event.clientY-elementRect.top};delta=Math.sqrt(Math.pow(event.deltaY,2)+Math.pow(event.deltaX,2))*sign(event.deltaY)*factor,this.zoom(delta,offset);}else isHorizontalScroll?delta={dx:factor*event.deltaY,dy:0}:delta={dx:factor*event.deltaX,dy:factor*event.deltaY},this.scroll(delta);},ZoomScroll.prototype.stepZoom=function stepZoom(delta,position){var stepSize=(0,_ZoomUtil.getStepSize)(RANGE,NUM_STEPS);this._zoom(delta,position,stepSize);},ZoomScroll.prototype._zoom=function(delta,position,stepSize){var canvas=this._canvas;var direction=delta>0?1:-1;var currentLinearZoomLevel=(0,_Math.log10)(canvas.zoom());var newLinearZoomLevel=Math.round(currentLinearZoomLevel/stepSize)*stepSize;newLinearZoomLevel+=stepSize*direction;var newLogZoomLevel=Math.pow(10,newLinearZoomLevel);canvas.zoom((0,_ZoomUtil.cap)(RANGE,newLogZoomLevel),position);},ZoomScroll.prototype.toggle=function toggle(newEnabled){var element=this._container;var handleWheel=this._handleWheel;var oldEnabled=this._enabled;return newEnabled===void 0&&(newEnabled=!oldEnabled),oldEnabled!==newEnabled&&_minDom.event[newEnabled?'bind':'unbind'](element,'wheel',handleWheel,!1),this._enabled=newEnabled,newEnabled;},ZoomScroll.prototype._init=function(newEnabled){this.toggle(newEnabled);};},{'../../util/Math':337,'./ZoomUtil':324,'min-dash':438,'min-dom':439}],324:[function(require,module,exports){'use strict';function getStepSize(range,steps){var minLinearRange=(0,_Math.log10)(range.min),maxLinearRange=(0,_Math.log10)(range.max);var absoluteLinearRange=Math.abs(minLinearRange)+Math.abs(maxLinearRange);return absoluteLinearRange/steps;}function cap(range,scale){return Math.max(range.min,Math.min(range.max,scale));}Object.defineProperty(exports,'__esModule',{value:!0}),exports.getStepSize=getStepSize,exports.cap=cap;var _Math=require('../../util/Math');},{'../../util/Math':337}],325:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _ZoomScroll=require('./ZoomScroll');var _ZoomScroll2=_interopRequireDefault(_ZoomScroll);exports.default={__init__:['zoomScroll'],zoomScroll:['type',_ZoomScroll2.default]};},{'./ZoomScroll':323}],326:[function(require,module,exports){'use strict';function getNewAttachPoint(point,oldBounds,newBounds){var oldCenter=(0,_PositionUtil.center)(oldBounds),newCenter=(0,_PositionUtil.center)(newBounds),oldDelta=(0,_PositionUtil.delta)(point,oldCenter);var newDelta={x:oldDelta.x*(newBounds.width/oldBounds.width),y:oldDelta.y*(newBounds.height/oldBounds.height)};return(0,_LayoutUtil.roundPoint)({x:newCenter.x+newDelta.x,y:newCenter.y+newDelta.y});}function getNewAttachShapeDelta(shape,oldBounds,newBounds){var shapeCenter=(0,_PositionUtil.center)(shape),oldCenter=(0,_PositionUtil.center)(oldBounds),newCenter=(0,_PositionUtil.center)(newBounds),shapeDelta=(0,_PositionUtil.delta)(shape,shapeCenter),oldCenterDelta=(0,_PositionUtil.delta)(shapeCenter,oldCenter);var newCenterDelta={x:oldCenterDelta.x*(newBounds.width/oldBounds.width),y:oldCenterDelta.y*(newBounds.height/oldBounds.height)};var newShapeCenter={x:newCenter.x+newCenterDelta.x,y:newCenter.y+newCenterDelta.y};return(0,_LayoutUtil.roundPoint)({x:newShapeCenter.x+shapeDelta.x-shape.x,y:newShapeCenter.y+shapeDelta.y-shape.y});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.getNewAttachPoint=getNewAttachPoint,exports.getNewAttachShapeDelta=getNewAttachShapeDelta;var _LayoutUtil=require('../layout/LayoutUtil');var _PositionUtil=require('./PositionUtil');},{'../layout/LayoutUtil':317,'./PositionUtil':340}],327:[function(require,module,exports){'use strict';function install(eventBus,eventName){function trap(){return!1;}return eventName=eventName||'element.click',eventBus.once(eventName,TRAP_PRIORITY,trap),function(){eventBus.off(eventName,trap);};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.install=install;var TRAP_PRIORITY=5000;},{}],328:[function(require,module,exports){'use strict';function remove(collection,element){if(!(collection&&element))return-1;var idx=collection.indexOf(element);return idx!==-1&&collection.splice(idx,1),idx;}function add(collection,element,idx){if(!(collection&&element))return;typeof idx!=='number'&&(idx=-1);var currentIdx=collection.indexOf(element);if(currentIdx!==-1)if(currentIdx===idx)return;else if(idx!==-1)collection.splice(currentIdx,1);else return;idx!==-1?collection.splice(idx,0,element):collection.push(element);}function indexOf(collection,element){return collection&&element?collection.indexOf(element):-1;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.remove=remove,exports.add=add,exports.indexOf=indexOf;},{}],329:[function(require,module,exports){'use strict';function getTopLevel(elements){var topLevel={},parents=[],result=[],clearedParents=[];return(0,_minDash.forEach)(elements,function(element){var parent=element.parent;topLevel[parent.id]||(topLevel[parent.id]=[]),parents.indexOf(parent.id)===-1&&parents.push(parent.id),topLevel[parent.id].push(element);}),(0,_minDash.forEach)(parents,function(parent){(0,_minDash.forEach)(topLevel[parent],function(element){topLevel[element.id]&&clearedParents.push(element.id);});}),(0,_minDash.forEach)(parents,function(parent){var idx=clearedParents.indexOf(parent);idx===-1&&(result=result.concat(topLevel[parent]));}),result;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.getTopLevel=getTopLevel;var _minDash=require('min-dash');},{'min-dash':438}],330:[function(require,module,exports){'use strict';function set(mode){var classes=(0,_minDom.classes)(document.body);classes.removeMatching(CURSOR_CLS_PATTERN),mode&&classes.add('djs-cursor-'+mode);}function unset(){set(null);}function has(mode){var classes=(0,_minDom.classes)(document.body);return classes.has('djs-cursor-'+mode);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.set=set,exports.unset=unset,exports.has=has;var _minDom=require('min-dom');var CURSOR_CLS_PATTERN=/^djs-cursor-.*$/;},{'min-dom':439}],331:[function(require,module,exports){'use strict';function add(elements,e,unique){var canAdd=!unique||elements.indexOf(e)===-1;return canAdd&&elements.push(e),canAdd;}function eachElement(elements,fn,depth){depth=depth||0,(0,_minDash.isArray)(elements)||(elements=[elements]),(0,_minDash.forEach)(elements,function(s,i){var filter=fn(s,i,depth);(0,_minDash.isArray)(filter)&&filter.length&&eachElement(filter,fn,depth+1);});}function selfAndChildren(elements,unique,maxDepth){var result=[],processedChildren=[];return eachElement(elements,function(element,i,depth){add(result,element,unique);var children=element.children;return(maxDepth===-1||depth<maxDepth)&&children&&add(processedChildren,children,unique)?children:void 0;}),result;}function selfAndDirectChildren(elements,allowDuplicates){return selfAndChildren(elements,!allowDuplicates,1);}function selfAndAllChildren(elements,allowDuplicates){return selfAndChildren(elements,!allowDuplicates,-1);}function getClosure(elements){function handleConnection(c){topLevel[c.source.id]&&topLevel[c.target.id]&&(topLevel[c.id]=[c]),allShapes[c.source.id]&&allShapes[c.target.id]&&(enclosedConnections[c.id]=enclosedElements[c.id]=c),allConnections[c.id]=c;}function handleElement(element){if(enclosedElements[element.id]=element,element.waypoints)enclosedConnections[element.id]=allConnections[element.id]=element;else return allShapes[element.id]=element,(0,_minDash.forEach)(element.incoming,handleConnection),(0,_minDash.forEach)(element.outgoing,handleConnection),element.children;}var topLevel=(0,_minDash.groupBy)(elements,function(e){return e.id;});var allShapes={},allConnections={},enclosedElements={},enclosedConnections={};return eachElement(elements,handleElement),{allShapes:allShapes,allConnections:allConnections,topLevel:topLevel,enclosedConnections:enclosedConnections,enclosedElements:enclosedElements};}function getBBox(elements,stopRecursion){stopRecursion=!!stopRecursion,(0,_minDash.isArray)(elements)||(elements=[elements]);var minX,minY,maxX,maxY;return(0,_minDash.forEach)(elements,function(element){var bbox=element;element.waypoints&&!stopRecursion&&(bbox=getBBox(element.waypoints,!0));var x=bbox.x,y=bbox.y,height=bbox.height||0,width=bbox.width||0;(x<minX||minX===undefined)&&(minX=x),(y<minY||minY===undefined)&&(minY=y),(x+width>maxX||maxX===undefined)&&(maxX=x+width),(y+height>maxY||maxY===undefined)&&(maxY=y+height);}),{x:minX,y:minY,height:maxY-minY,width:maxX-minX};}function getEnclosedElements(elements,bbox){var filteredElements={};return(0,_minDash.forEach)(elements,function(element){var e=element;e.waypoints&&(e=getBBox(e)),!(0,_minDash.isNumber)(bbox.y)&&e.x>bbox.x&&(filteredElements[element.id]=element),!(0,_minDash.isNumber)(bbox.x)&&e.y>bbox.y&&(filteredElements[element.id]=element),e.x>bbox.x&&e.y>bbox.y&&((0,_minDash.isNumber)(bbox.width)&&(0,_minDash.isNumber)(bbox.height)&&e.width+e.x<bbox.width+bbox.x&&e.height+e.y<bbox.height+bbox.y?filteredElements[element.id]=element:(0,_minDash.isNumber)(bbox.width)&&(0,_minDash.isNumber)(bbox.height)||(filteredElements[element.id]=element));}),filteredElements;}function getType(element){return'waypoints'in element?'connection':'x'in element?'shape':'root';}Object.defineProperty(exports,'__esModule',{value:!0}),exports.add=add,exports.eachElement=eachElement,exports.selfAndChildren=selfAndChildren,exports.selfAndDirectChildren=selfAndDirectChildren,exports.selfAndAllChildren=selfAndAllChildren,exports.getClosure=getClosure,exports.getBBox=getBBox,exports.getEnclosedElements=getEnclosedElements,exports.getType=getType;var _minDash=require('min-dash');},{'min-dash':438}],332:[function(require,module,exports){'use strict';function __stopPropagation(event){if(!event||typeof event.stopPropagation!=='function')return;event.stopPropagation();}function getOriginal(event){return event.originalEvent||event.srcEvent;}function stopPropagation(event,immediate){__stopPropagation(event,immediate),__stopPropagation(getOriginal(event),immediate);}function toPoint(event){return event.pointers&&event.pointers.length&&(event=event.pointers[0]),event.touches&&event.touches.length&&(event=event.touches[0]),event?{x:event.clientX,y:event.clientY}:null;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.getOriginal=getOriginal,exports.stopPropagation=stopPropagation,exports.toPoint=toPoint;},{}],333:[function(require,module,exports){'use strict';function pointDistance(a,b){return a&&b?Math.sqrt(Math.pow(a.x-b.x,2)+Math.pow(a.y-b.y,2)):-1;}function pointsOnLine(p,q,r,accuracy){if(accuracy===void 0&&(accuracy=5),!(p&&q&&r))return!1;var val=(q.x-p.x)*(r.y-p.y)-(q.y-p.y)*(r.x-p.x),dist=pointDistance(p,q);return Math.abs(val/dist)<=accuracy;}function pointsAligned(a,b){return Math.abs(a.x-b.x)<=ALIGNED_THRESHOLD?'h':Math.abs(a.y-b.y)<=ALIGNED_THRESHOLD?'v':!1;}function pointInRect(p,rect,tolerance){return tolerance=tolerance||0,p.x>rect.x-tolerance&&p.y>rect.y-tolerance&&p.x<rect.x+rect.width+tolerance&&p.y<rect.y+rect.height+tolerance;}function getMidPoint(p,q){return{x:Math.round(p.x+(q.x-p.x)/2),y:Math.round(p.y+(q.y-p.y)/2)};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.pointDistance=pointDistance,exports.pointsOnLine=pointsOnLine,exports.pointsAligned=pointsAligned,exports.pointInRect=pointInRect,exports.getMidPoint=getMidPoint;var ALIGNED_THRESHOLD=2;},{}],334:[function(require,module,exports){'use strict';function getVisual(gfx){return(0,_minDom.query)('.djs-visual',gfx);}function getChildren(gfx){return gfx.parentNode.childNodes[1];}Object.defineProperty(exports,'__esModule',{value:!0}),exports.getVisual=getVisual,exports.getChildren=getChildren;var _minDom=require('min-dom');},{'min-dom':439}],335:[function(require,module,exports){'use strict';function IdGenerator(prefix){this._counter=0,this._prefix=(prefix?prefix+'-':'')+Math.floor(Math.random()*1000000000)+'-';}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=IdGenerator,IdGenerator.prototype.next=function(){return this._prefix+ ++this._counter;};},{}],336:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function circlePath(center,r){var x=center.x,y=center.y;return[['M',x,y],['m',0,-r],['a',r,r,0,1,1,0,2*r],['a',r,r,0,1,1,0,-2*r],['z']];}function linePath(points){var segments=[];return points.forEach(function(p,idx){segments.push([idx===0?'M':'L',p.x,p.y]);}),segments;}function getBendpointIntersection(waypoints,reference){var i,w;for(i=0;w=waypoints[i];i++)if((0,_Geometry.pointDistance)(w,reference)<=INTERSECTION_THRESHOLD)return{point:waypoints[i],bendpoint:!0,index:i};return null;}function getPathIntersection(waypoints,reference){var intersections=(0,_pathIntersection2.default)(circlePath(reference,INTERSECTION_THRESHOLD),linePath(waypoints));var a=intersections[0],b=intersections[intersections.length-1],idx;return a?a!==b?a.segment2!==b.segment2?(idx=max(a.segment2,b.segment2)-1,{point:waypoints[idx],bendpoint:!0,index:idx}):{point:{x:round(a.x+b.x)/2,y:round(a.y+b.y)/2},index:a.segment2}:{point:{x:round(a.x),y:round(a.y)},index:a.segment2}:null;}function getApproxIntersection(waypoints,reference){return getBendpointIntersection(waypoints,reference)||getPathIntersection(waypoints,reference);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.getApproxIntersection=getApproxIntersection;var _Geometry=require('./Geometry');var _pathIntersection=require('path-intersection');var _pathIntersection2=_interopRequireDefault(_pathIntersection);var round=Math.round,max=Math.max;var INTERSECTION_THRESHOLD=10;},{'./Geometry':333,'path-intersection':456}],337:[function(require,module,exports){'use strict';function log10(x){return Math.log(x)/Math.log(10);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.log10=log10;var _PositionUtil=require('./PositionUtil');Object.defineProperty(exports,'substract',{enumerable:!0,get:function get(){return _PositionUtil.delta;}});},{'./PositionUtil':340}],338:[function(require,module,exports){'use strict';function isPrimaryButton(event){return!((0,_Event.getOriginal)(event)||event).button;}function hasPrimaryModifier(event){var originalEvent=(0,_Event.getOriginal)(event)||event;return isPrimaryButton(event)?(0,_Platform.isMac)()?originalEvent.metaKey:originalEvent.ctrlKey:!1;}function hasSecondaryModifier(event){var originalEvent=(0,_Event.getOriginal)(event)||event;return isPrimaryButton(event)&&originalEvent.shiftKey;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.isMac=undefined;var _Platform=require('./Platform');Object.defineProperty(exports,'isMac',{enumerable:!0,get:function get(){return _Platform.isMac;}}),exports.isPrimaryButton=isPrimaryButton,exports.hasPrimaryModifier=hasPrimaryModifier,exports.hasSecondaryModifier=hasSecondaryModifier;var _Event=require('./Event');},{'./Event':332,'./Platform':339}],339:[function(require,module,exports){'use strict';function isMac(){return/mac/i.test(navigator.platform);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.isMac=isMac;},{}],340:[function(require,module,exports){'use strict';function center(bounds){return{x:bounds.x+bounds.width/2,y:bounds.y+bounds.height/2};}function delta(a,b){return{x:a.x-b.x,y:a.y-b.y};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.center=center,exports.delta=delta;},{}],341:[function(require,module,exports){'use strict';function saveClear(collection,removeFn){if(typeof removeFn!=='function')throw new Error('removeFn iterator must be a function');if(!collection)return;var e;while(e=collection[0])removeFn(e);return collection;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.saveClear=saveClear;},{}],342:[function(require,module,exports){'use strict';function componentsToPath(elements){return elements.join(',').replace(/,?([A-z]),?/g,'$1');}function toSVGPoints(points){var result='';for(var i=0,p;p=points[i];i++)result+=p.x+','+p.y+' ';return result;}function createLine(points,attrs){var line=(0,_tinySvg.create)('polyline');return(0,_tinySvg.attr)(line,{points:toSVGPoints(points)}),attrs&&(0,_tinySvg.attr)(line,attrs),line;}function updateLine(gfx,points){return(0,_tinySvg.attr)(gfx,{points:toSVGPoints(points)}),gfx;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.componentsToPath=componentsToPath,exports.toSVGPoints=toSVGPoints,exports.createLine=createLine,exports.updateLine=updateLine;var _tinySvg=require('tiny-svg');},{'tiny-svg':468}],343:[function(require,module,exports){'use strict';function transform(gfx,x,y,angle,amount){var translate=(0,_tinySvg.createTransform)();translate.setTranslate(x,y);var rotate=(0,_tinySvg.createTransform)();rotate.setRotate(angle,0,0);var scale=(0,_tinySvg.createTransform)();scale.setScale(amount||1,amount||1),(0,_tinySvg.transform)(gfx,[translate,rotate,scale]);}function translate(gfx,x,y){var translate=(0,_tinySvg.createTransform)();translate.setTranslate(x,y),(0,_tinySvg.transform)(gfx,translate);}function rotate(gfx,angle){var rotate=(0,_tinySvg.createTransform)();rotate.setRotate(angle,0,0),(0,_tinySvg.transform)(gfx,rotate);}function scale(gfx,amount){var scale=(0,_tinySvg.createTransform)();scale.setScale(amount,amount),(0,_tinySvg.transform)(gfx,scale);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.transform=transform,exports.translate=translate,exports.rotate=rotate,exports.scale=scale;var _tinySvg=require('tiny-svg');},{'tiny-svg':468}],344:[function(require,module,exports){'use strict';function parseAlign(align){var parts=align.split('-');return{horizontal:parts[0]||'center',vertical:parts[1]||'top'};}function parsePadding(padding){return(0,_minDash.isObject)(padding)?(0,_minDash.assign)({top:0,left:0,right:0,bottom:0},padding):{top:padding,left:padding,right:padding,bottom:padding};}function getTextBBox(text,fakeText){fakeText.textContent=text;try{var bbox,emptyLine=text==='';return fakeText.textContent=emptyLine?'dummy':text,bbox=(0,_minDash.pick)(fakeText.getBBox(),['width','height']),emptyLine&&(bbox.width=0),bbox;}catch(e){return{width:0,height:0};}}function layoutNext(lines,maxWidth,fakeText){var originalLine=lines.shift(),fitLine=originalLine;var textBBox;for(;;){if(textBBox=getTextBBox(fitLine,fakeText),textBBox.width=fitLine?textBBox.width:0,fitLine===' '||fitLine===''||textBBox.width<Math.round(maxWidth)||fitLine.length<2)return fit(lines,fitLine,originalLine,textBBox);fitLine=shortenLine(fitLine,textBBox.width,maxWidth);}}function fit(lines,fitLine,originalLine,textBBox){if(fitLine.length<originalLine.length){var remainder=originalLine.slice(fitLine.length).trim();lines.unshift(remainder);}return{width:textBBox.width,height:textBBox.height,text:fitLine};}function semanticShorten(line,maxLength){var parts=line.split(/(\s|-)/g),part,shortenedParts=[],length=0;if(parts.length>1)while(part=parts.shift())if(part.length+length<maxLength)shortenedParts.push(part),length+=part.length;else{part==='-'&&shortenedParts.pop();break;}return shortenedParts.join('');}function shortenLine(line,width,maxWidth){var length=Math.max(line.length*(maxWidth/width),1);var shortenedLine=semanticShorten(line,length);return shortenedLine||(shortenedLine=line.slice(0,Math.max(Math.round(length-1),1))),shortenedLine;}function getHelperSvg(){var helperSvg=document.getElementById('helper-svg');return helperSvg||(helperSvg=(0,_tinySvg.create)('svg'),(0,_tinySvg.attr)(helperSvg,{id:'helper-svg',width:0,height:0,style:'visibility: hidden; position: fixed'}),document.body.appendChild(helperSvg)),helperSvg;}function Text(config){this._config=(0,_minDash.assign)({},{size:DEFAULT_LABEL_SIZE,padding:DEFAULT_BOX_PADDING,style:{},align:'center-top'},config||{});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=Text;var _minDash=require('min-dash');var _tinySvg=require('tiny-svg');var DEFAULT_BOX_PADDING=0;var DEFAULT_LABEL_SIZE={width:150,height:50};Text.prototype.createText=function(text,options){return this.layoutText(text,options).element;},Text.prototype.getDimensions=function(text,options){return this.layoutText(text,options).dimensions;},Text.prototype.layoutText=function(text,options){var box=(0,_minDash.assign)({},this._config.size,options.box),style=(0,_minDash.assign)({},this._config.style,options.style),align=parseAlign(options.align||this._config.align),padding=parsePadding(options.padding!==undefined?options.padding:this._config.padding),fitBox=options.fitBox||!1;var lines=text.split(/\r?\n/g),layouted=[];var maxWidth=box.width-padding.left-padding.right;var helperText=(0,_tinySvg.create)('text');(0,_tinySvg.attr)(helperText,{x:0,y:0}),(0,_tinySvg.attr)(helperText,style);var helperSvg=getHelperSvg();(0,_tinySvg.append)(helperSvg,helperText);while(lines.length)layouted.push(layoutNext(lines,maxWidth,helperText));var totalHeight=(0,_minDash.reduce)(layouted,function(sum,line,idx){return sum+line.height;},0);var maxLineWidth=(0,_minDash.reduce)(layouted,function(sum,line,idx){return line.width>sum?line.width:sum;},0);var y,x;switch(align.vertical){case'middle':y=(box.height-totalHeight)/2-layouted[0].height/4;break;default:y=padding.top;}var textElement=(0,_tinySvg.create)('text');(0,_tinySvg.attr)(textElement,style),(0,_minDash.forEach)(layouted,function(line){y+=line.height;switch(align.horizontal){case'left':x=padding.left;break;case'right':x=(fitBox?maxLineWidth:maxWidth)-padding.right-line.width;break;default:x=Math.max(((fitBox?maxLineWidth:maxWidth)-line.width)/2+padding.left,0);}var tspan=(0,_tinySvg.create)('tspan');(0,_tinySvg.attr)(tspan,{x:x,y:y}),tspan.textContent=line.text,(0,_tinySvg.append)(textElement,tspan);}),(0,_tinySvg.remove)(helperText);var dimensions={width:maxLineWidth,height:totalHeight};return{dimensions:dimensions,element:textElement};};},{'min-dash':438,'tiny-svg':468}],345:[function(require,module,exports){'use strict';function isClass(fn){return CLASS_PATTERN.test(fn.toString());}function isArray(obj){return Object.prototype.toString.call(obj)==='[object Array]';}function annotate(){var args=Array.prototype.slice.call(arguments);args.length===1&&isArray(args[0])&&(args=args[0]);var fn=args.pop();return fn.$inject=args,fn;}function parse(fn){if(typeof fn!=='function')throw new Error('Cannot annotate "'+fn+'". Expected a function!');var match=fn.toString().match(isClass(fn)?CONSTRUCTOR_ARGS:FN_ARGS);return match?match[1]&&match[1].split(',').map(function(arg){return match=arg.match(FN_ARG),match?match[1].trim():arg.trim();})||[]:[];}function Module(){var providers=[];this.factory=function(name,factory){return providers.push([name,'factory',factory]),this;},this.value=function(name,value){return providers.push([name,'value',value]),this;},this.type=function(name,type){return providers.push([name,'type',type]),this;},this.forEach=function(iterator){providers.forEach(iterator);};}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2;}else return Array.from(arr);}function Injector(modules,parent){parent=parent||{get:function get(name,strict){if(currentlyResolving.push(name),strict===!1)return null;else throw error('No provider for "'+name+'"!');}};var currentlyResolving=[];var providers=this._providers=Object.create(parent._providers||null);var instances=this._instances=Object.create(null);var self=instances.injector=this;var error=function error(msg){var stack=currentlyResolving.join(' -> ');return currentlyResolving.length=0,new Error(stack?msg+' (Resolving: '+stack+')':msg);};var get=function get(name,strict){if(!providers[name]&&name.indexOf('.')!==-1){var parts=name.split('.');var pivot=get(parts.shift());while(parts.length)pivot=pivot[parts.shift()];return pivot;}if(hasProp(instances,name))return instances[name];if(hasProp(providers,name)){if(currentlyResolving.indexOf(name)!==-1)throw currentlyResolving.push(name),error('Cannot resolve circular dependency!');return currentlyResolving.push(name),instances[name]=providers[name][0](providers[name][1]),currentlyResolving.pop(),instances[name];}return parent.get(name,strict);};var fnDef=function fnDef(fn){var locals=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(typeof fn!=='function')if(isArray(fn))fn=annotate(fn.slice());else throw new Error('Cannot invoke "'+fn+'". Expected a function!');var inject=fn.$inject||parse(fn);var dependencies=inject.map(function(dep){return hasProp(locals,dep)?locals[dep]:get(dep);});return{fn:fn,dependencies:dependencies};};var instantiate=function instantiate(Type){var _fnDef=fnDef(Type),dependencies=_fnDef.dependencies,fn=_fnDef.fn;return new(Function.prototype.bind.apply(fn,[null].concat(_toConsumableArray(dependencies))))();};var invoke=function invoke(func,context,locals){var _fnDef2=fnDef(func,locals),dependencies=_fnDef2.dependencies,fn=_fnDef2.fn;return fn.call.apply(fn,[context].concat(_toConsumableArray(dependencies)));};var createPrivateInjectorFactory=function createPrivateInjectorFactory(privateChildInjector){return annotate(function(key){return privateChildInjector.get(key);});};var createChild=function createChild(modules,forceNewInstances){if(forceNewInstances&&forceNewInstances.length){var fromParentModule=Object.create(null);var matchedScopes=Object.create(null);var privateInjectorsCache=[];var privateChildInjectors=[];var privateChildFactories=[];var provider;var cacheIdx;var privateChildInjector;var privateChildInjectorFactory;for(var name in providers)provider=providers[name],forceNewInstances.indexOf(name)!==-1&&(provider[2]==='private'?(cacheIdx=privateInjectorsCache.indexOf(provider[3]),cacheIdx===-1?(privateChildInjector=provider[3].createChild([],forceNewInstances),privateChildInjectorFactory=createPrivateInjectorFactory(privateChildInjector),privateInjectorsCache.push(provider[3]),privateChildInjectors.push(privateChildInjector),privateChildFactories.push(privateChildInjectorFactory),fromParentModule[name]=[privateChildInjectorFactory,name,'private',privateChildInjector]):fromParentModule[name]=[privateChildFactories[cacheIdx],name,'private',privateChildInjectors[cacheIdx]]):fromParentModule[name]=[provider[2],provider[1]],matchedScopes[name]=!0),(provider[2]==='factory'||provider[2]==='type')&&provider[1].$scope&&forceNewInstances.forEach(function(scope){provider[1].$scope.indexOf(scope)!==-1&&(fromParentModule[name]=[provider[2],provider[1]],matchedScopes[scope]=!0);});forceNewInstances.forEach(function(scope){if(!matchedScopes[scope])throw new Error('No provider for "'+scope+'". Cannot use provider from the parent!');}),modules.unshift(fromParentModule);}return new Injector(modules,self);};var factoryMap={factory:invoke,type:instantiate,value:function value(_value){return _value;}};modules.forEach(function(module){function arrayUnwrap(type,value){return type!=='value'&&isArray(value)&&(value=annotate(value.slice())),value;}if(module instanceof Module)module.forEach(function(provider){var name=provider[0];var type=provider[1];var value=provider[2];providers[name]=[factoryMap[type],arrayUnwrap(type,value),type];});else if((module===void 0?'undefined':_typeof(module))==='object')if(module.__exports__){var clonedModule=Object.keys(module).reduce(function(m,key){return key.substring(0,2)!=='__'&&(m[key]=module[key]),m;},Object.create(null));var privateInjector=new Injector((module.__modules__||[]).concat([clonedModule]),self);var getFromPrivateInjector=annotate(function(key){return privateInjector.get(key);});module.__exports__.forEach(function(key){providers[key]=[getFromPrivateInjector,key,'private',privateInjector];});}else Object.keys(module).forEach(function(name){if(module[name][2]==='private'){providers[name]=module[name];return;}var type=module[name][0];var value=module[name][1];providers[name]=[factoryMap[type],arrayUnwrap(type,value),type];});}),this.get=get,this.invoke=invoke,this.instantiate=instantiate,this.createChild=createChild;}function hasProp(obj,prop){return Object.hasOwnProperty.call(obj,prop);}var _typeof2=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj;};Object.defineProperty(exports,'__esModule',{value:!0});var CLASS_PATTERN=/^class /;var CONSTRUCTOR_ARGS=/constructor\s*[^(]*\(\s*([^)]*)\)/m;var FN_ARGS=/^function\s*[^(]*\(\s*([^)]*)\)/m;var FN_ARG=/\/\*([^*]*)\*\//m;var _typeof=typeof Symbol==='function'&&_typeof2(Symbol.iterator)==='symbol'?function(obj){return obj===void 0?'undefined':_typeof2(obj);}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':obj===void 0?'undefined':_typeof2(obj);};exports.annotate=annotate,exports.Module=Module,exports.Injector=Injector;},{}],346:[function(require,module,exports){'use strict';function parse(html,doc){if('string'!=typeof html)throw new TypeError('String expected');doc||(doc=document);var m=/<([\w:]+)/.exec(html);if(!m)return doc.createTextNode(html);html=html.replace(/^\s+|\s+$/g,'');var tag=m[1];if(tag=='body'){var el=doc.createElement('html');return el.innerHTML=html,el.removeChild(el.lastChild);}var wrap=map[tag]||map._default;var depth=wrap[0];var prefix=wrap[1];var suffix=wrap[2];var el=doc.createElement('div');el.innerHTML=prefix+html+suffix;while(depth--)el=el.lastChild;if(el.firstChild==el.lastChild)return el.removeChild(el.firstChild);var fragment=doc.createDocumentFragment();while(el.firstChild)fragment.appendChild(el.removeChild(el.firstChild));return fragment;}module.exports=parse;var innerHTMLBug=!1;var bugTestDiv;typeof document!=='undefined'&&(bugTestDiv=document.createElement('div'),bugTestDiv.innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',innerHTMLBug=!bugTestDiv.getElementsByTagName('link').length,bugTestDiv=undefined);var map={legend:[1,'<fieldset>','</fieldset>'],tr:[2,'<table><tbody>','</tbody></table>'],col:[2,'<table><tbody></tbody><colgroup>','</colgroup></table>'],_default:innerHTMLBug?[1,'X<div>','</div>']:[0,'','']};map.td=map.th=[3,'<table><tbody><tr>','</tr></tbody></table>'],map.option=map.optgroup=[1,'<select multiple="multiple">','</select>'],map.thead=map.tbody=map.colgroup=map.caption=map.tfoot=[1,'<table>','</table>'],map.polyline=map.ellipse=map.polygon=map.circle=map.text=map.line=map.path=map.rect=map.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">','</svg>'];},{}],347:[function(require,module,exports){'use strict';var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj;};(function(window,document,exportName,undefined){'use strict';function setTimeoutContext(fn,timeout,context){return setTimeout(bindFn(fn,context),timeout);}function invokeArrayArg(arg,fn,context){return Array.isArray(arg)?(each(arg,context[fn],context),!0):!1;}function each(obj,iterator,context){var i;if(!obj)return;if(obj.forEach)obj.forEach(iterator,context);else if(obj.length!==undefined){i=0;while(i<obj.length)iterator.call(context,obj[i],i,obj),i++;}else for(i in obj)obj.hasOwnProperty(i)&&iterator.call(context,obj[i],i,obj);}function deprecate(method,name,message){var deprecationMessage='DEPRECATED METHOD: '+name+'\n'+message+' AT \n';return function(){var e=new Error('get-stack-trace');var stack=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,'').replace(/^\s+at\s+/gm,'').replace(/^Object.<anonymous>\s*\(/gm,'{anonymous}()@'):'Unknown Stack Trace';var log=window.console&&(window.console.warn||window.console.log);return log&&log.call(window.console,deprecationMessage,stack),method.apply(this,arguments);};}function inherit(child,base,properties){var baseP=base.prototype,childP;childP=child.prototype=Object.create(baseP),childP.constructor=child,childP._super=baseP,properties&&assign(childP,properties);}function bindFn(fn,context){return function boundFn(){return fn.apply(context,arguments);};}function boolOrFn(val,args){return(val===void 0?'undefined':_typeof(val))==TYPE_FUNCTION?val.apply(args?args[0]||undefined:undefined,args):val;}function ifUndefined(val1,val2){return val1===undefined?val2:val1;}function addEventListeners(target,types,handler){each(splitStr(types),function(type){target.addEventListener(type,handler,!1);});}function removeEventListeners(target,types,handler){each(splitStr(types),function(type){target.removeEventListener(type,handler,!1);});}function hasParent(node,parent){while(node){if(node==parent)return!0;node=node.parentNode;}return!1;}function inStr(str,find){return str.indexOf(find)>-1;}function splitStr(str){return str.trim().split(/\s+/g);}function inArray(src,find,findByKey){if(src.indexOf&&!findByKey)return src.indexOf(find);else{var i=0;while(i<src.length){if(findByKey&&src[i][findByKey]==find||!findByKey&&src[i]===find)return i;i++;}return-1;}}function toArray(obj){return Array.prototype.slice.call(obj,0);}function uniqueArray(src,key,sort){var results=[];var values=[];var i=0;while(i<src.length){var val=key?src[i][key]:src[i];inArray(values,val)<0&&results.push(src[i]),values[i]=val,i++;}return sort&&(key?results=results.sort(function sortUniqueArray(a,b){return a[key]>b[key];}):results=results.sort()),results;}function prefixed(obj,property){var prefix,prop;var camelProp=property[0].toUpperCase()+property.slice(1);var i=0;while(i<VENDOR_PREFIXES.length){if(prefix=VENDOR_PREFIXES[i],prop=prefix?prefix+camelProp:property,prop in obj)return prop;i++;}return undefined;}function uniqueId(){return _uniqueId++;}function getWindowForElement(element){var doc=element.ownerDocument||element;return doc.defaultView||doc.parentWindow||window;}function Input(manager,callback){var self=this;this.manager=manager,this.callback=callback,this.element=manager.element,this.target=manager.options.inputTarget,this.domHandler=function(ev){boolOrFn(manager.options.enable,[manager])&&self.handler(ev);},this.init();}function createInputInstance(manager){var Type;var inputClass=manager.options.inputClass;return inputClass?Type=inputClass:SUPPORT_POINTER_EVENTS?Type=PointerEventInput:SUPPORT_ONLY_TOUCH?Type=TouchInput:SUPPORT_TOUCH?Type=TouchMouseInput:Type=MouseInput,new Type(manager,inputHandler);}function inputHandler(manager,eventType,input){var pointersLen=input.pointers.length;var changedPointersLen=input.changedPointers.length;var isFirst=eventType&INPUT_START&&pointersLen-changedPointersLen===0;var isFinal=eventType&(INPUT_END|INPUT_CANCEL)&&pointersLen-changedPointersLen===0;input.isFirst=!!isFirst,input.isFinal=!!isFinal,isFirst&&(manager.session={}),input.eventType=eventType,computeInputData(manager,input),manager.emit('hammer.input',input),manager.recognize(input),manager.session.prevInput=input;}function computeInputData(manager,input){var session=manager.session;var pointers=input.pointers;var pointersLength=pointers.length;session.firstInput||(session.firstInput=simpleCloneInputData(input)),pointersLength>1&&!session.firstMultiple?session.firstMultiple=simpleCloneInputData(input):pointersLength===1&&(session.firstMultiple=!1);var firstInput=session.firstInput;var firstMultiple=session.firstMultiple;var offsetCenter=firstMultiple?firstMultiple.center:firstInput.center;var center=input.center=getCenter(pointers);input.timeStamp=now(),input.deltaTime=input.timeStamp-firstInput.timeStamp,input.angle=getAngle(offsetCenter,center),input.distance=getDistance(offsetCenter,center),computeDeltaXY(session,input),input.offsetDirection=getDirection(input.deltaX,input.deltaY);var overallVelocity=getVelocity(input.deltaTime,input.deltaX,input.deltaY);input.overallVelocityX=overallVelocity.x,input.overallVelocityY=overallVelocity.y,input.overallVelocity=abs(overallVelocity.x)>abs(overallVelocity.y)?overallVelocity.x:overallVelocity.y,input.scale=firstMultiple?getScale(firstMultiple.pointers,pointers):1,input.rotation=firstMultiple?getRotation(firstMultiple.pointers,pointers):0,input.maxPointers=session.prevInput?input.pointers.length>session.prevInput.maxPointers?input.pointers.length:session.prevInput.maxPointers:input.pointers.length,computeIntervalInputData(session,input);var target=manager.element;hasParent(input.srcEvent.target,target)&&(target=input.srcEvent.target),input.target=target;}function computeDeltaXY(session,input){var center=input.center;var offset=session.offsetDelta||{};var prevDelta=session.prevDelta||{};var prevInput=session.prevInput||{};(input.eventType===INPUT_START||prevInput.eventType===INPUT_END)&&(prevDelta=session.prevDelta={x:prevInput.deltaX||0,y:prevInput.deltaY||0},offset=session.offsetDelta={x:center.x,y:center.y}),input.deltaX=prevDelta.x+(center.x-offset.x),input.deltaY=prevDelta.y+(center.y-offset.y);}function computeIntervalInputData(session,input){var last=session.lastInterval||input,deltaTime=input.timeStamp-last.timeStamp,velocity,velocityX,velocityY,direction;if(input.eventType!=INPUT_CANCEL&&(deltaTime>COMPUTE_INTERVAL||last.velocity===undefined)){var deltaX=input.deltaX-last.deltaX;var deltaY=input.deltaY-last.deltaY;var v=getVelocity(deltaTime,deltaX,deltaY);velocityX=v.x,velocityY=v.y,velocity=abs(v.x)>abs(v.y)?v.x:v.y,direction=getDirection(deltaX,deltaY),session.lastInterval=input;}else velocity=last.velocity,velocityX=last.velocityX,velocityY=last.velocityY,direction=last.direction;input.velocity=velocity,input.velocityX=velocityX,input.velocityY=velocityY,input.direction=direction;}function simpleCloneInputData(input){var pointers=[];var i=0;while(i<input.pointers.length)pointers[i]={clientX:round(input.pointers[i].clientX),clientY:round(input.pointers[i].clientY)},i++;return{timeStamp:now(),pointers:pointers,center:getCenter(pointers),deltaX:input.deltaX,deltaY:input.deltaY};}function getCenter(pointers){var pointersLength=pointers.length;if(pointersLength===1)return{x:round(pointers[0].clientX),y:round(pointers[0].clientY)};var x=0,y=0,i=0;while(i<pointersLength)x+=pointers[i].clientX,y+=pointers[i].clientY,i++;return{x:round(x/pointersLength),y:round(y/pointersLength)};}function getVelocity(deltaTime,x,y){return{x:x/deltaTime||0,y:y/deltaTime||0};}function getDirection(x,y){return x===y?DIRECTION_NONE:abs(x)>=abs(y)?x<0?DIRECTION_LEFT:DIRECTION_RIGHT:y<0?DIRECTION_UP:DIRECTION_DOWN;}function getDistance(p1,p2,props){props||(props=PROPS_XY);var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return Math.sqrt(x*x+y*y);}function getAngle(p1,p2,props){props||(props=PROPS_XY);var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return Math.atan2(y,x)*180/Math.PI;}function getRotation(start,end){return getAngle(end[1],end[0],PROPS_CLIENT_XY)+getAngle(start[1],start[0],PROPS_CLIENT_XY);}function getScale(start,end){return getDistance(end[0],end[1],PROPS_CLIENT_XY)/getDistance(start[0],start[1],PROPS_CLIENT_XY);}function MouseInput(){this.evEl=MOUSE_ELEMENT_EVENTS,this.evWin=MOUSE_WINDOW_EVENTS,this.pressed=!1,Input.apply(this,arguments);}function PointerEventInput(){this.evEl=POINTER_ELEMENT_EVENTS,this.evWin=POINTER_WINDOW_EVENTS,Input.apply(this,arguments),this.store=this.manager.session.pointerEvents=[];}function SingleTouchInput(){this.evTarget=SINGLE_TOUCH_TARGET_EVENTS,this.evWin=SINGLE_TOUCH_WINDOW_EVENTS,this.started=!1,Input.apply(this,arguments);}function normalizeSingleTouches(ev,type){var all=toArray(ev.touches);var changed=toArray(ev.changedTouches);return type&(INPUT_END|INPUT_CANCEL)&&(all=uniqueArray(all.concat(changed),'identifier',!0)),[all,changed];}function TouchInput(){this.evTarget=TOUCH_TARGET_EVENTS,this.targetIds={},Input.apply(this,arguments);}function getTouches(ev,type){var allTouches=toArray(ev.touches);var targetIds=this.targetIds;if(type&(INPUT_START|INPUT_MOVE)&&allTouches.length===1)return targetIds[allTouches[0].identifier]=!0,[allTouches,allTouches];var i,targetTouches,changedTouches=toArray(ev.changedTouches),changedTargetTouches=[],target=this.target;if(targetTouches=allTouches.filter(function(touch){return hasParent(touch.target,target);}),type===INPUT_START){i=0;while(i<targetTouches.length)targetIds[targetTouches[i].identifier]=!0,i++;}i=0;while(i<changedTouches.length)targetIds[changedTouches[i].identifier]&&changedTargetTouches.push(changedTouches[i]),type&(INPUT_END|INPUT_CANCEL)&&delete targetIds[changedTouches[i].identifier],i++;return changedTargetTouches.length?[uniqueArray(targetTouches.concat(changedTargetTouches),'identifier',!0),changedTargetTouches]:void 0;}function TouchMouseInput(){Input.apply(this,arguments);var handler=bindFn(this.handler,this);this.touch=new TouchInput(this.manager,handler),this.mouse=new MouseInput(this.manager,handler),this.primaryTouch=null,this.lastTouches=[];}function recordTouches(eventType,eventData){eventType&INPUT_START?(this.primaryTouch=eventData.changedPointers[0].identifier,setLastTouch.call(this,eventData)):eventType&(INPUT_END|INPUT_CANCEL)&&setLastTouch.call(this,eventData);}function setLastTouch(eventData){var touch=eventData.changedPointers[0];if(touch.identifier===this.primaryTouch){var lastTouch={x:touch.clientX,y:touch.clientY};this.lastTouches.push(lastTouch);var lts=this.lastTouches;var removeLastTouch=function removeLastTouch(){var i=lts.indexOf(lastTouch);i>-1&&lts.splice(i,1);};setTimeout(removeLastTouch,DEDUP_TIMEOUT);}}function isSyntheticEvent(eventData){var x=eventData.srcEvent.clientX,y=eventData.srcEvent.clientY;for(var i=0;i<this.lastTouches.length;i++){var t=this.lastTouches[i];var dx=Math.abs(x-t.x),dy=Math.abs(y-t.y);if(dx<=DEDUP_DISTANCE&&dy<=DEDUP_DISTANCE)return!0;}return!1;}function TouchAction(manager,value){this.manager=manager,this.set(value);}function cleanTouchActions(actions){if(inStr(actions,TOUCH_ACTION_NONE))return TOUCH_ACTION_NONE;var hasPanX=inStr(actions,TOUCH_ACTION_PAN_X);var hasPanY=inStr(actions,TOUCH_ACTION_PAN_Y);return hasPanX&&hasPanY?TOUCH_ACTION_NONE:hasPanX||hasPanY?hasPanX?TOUCH_ACTION_PAN_X:TOUCH_ACTION_PAN_Y:inStr(actions,TOUCH_ACTION_MANIPULATION)?TOUCH_ACTION_MANIPULATION:TOUCH_ACTION_AUTO;}function getTouchActionProps(){if(!NATIVE_TOUCH_ACTION)return!1;var touchMap={};var cssSupports=window.CSS&&window.CSS.supports;return['auto','manipulation','pan-y','pan-x','pan-x pan-y','none'].forEach(function(val){touchMap[val]=cssSupports?window.CSS.supports('touch-action',val):!0;}),touchMap;}function Recognizer(options){this.options=assign({},this.defaults,options||{}),this.id=uniqueId(),this.manager=null,this.options.enable=ifUndefined(this.options.enable,!0),this.state=STATE_POSSIBLE,this.simultaneous={},this.requireFail=[];}function stateStr(state){if(state&STATE_CANCELLED)return'cancel';else if(state&STATE_ENDED)return'end';else if(state&STATE_CHANGED)return'move';else if(state&STATE_BEGAN)return'start';return'';}function directionStr(direction){if(direction==DIRECTION_DOWN)return'down';else if(direction==DIRECTION_UP)return'up';else if(direction==DIRECTION_LEFT)return'left';else if(direction==DIRECTION_RIGHT)return'right';return'';}function getRecognizerByNameIfManager(otherRecognizer,recognizer){var manager=recognizer.manager;return manager?manager.get(otherRecognizer):otherRecognizer;}function AttrRecognizer(){Recognizer.apply(this,arguments);}function PanRecognizer(){AttrRecognizer.apply(this,arguments),this.pX=null,this.pY=null;}function PinchRecognizer(){AttrRecognizer.apply(this,arguments);}function PressRecognizer(){Recognizer.apply(this,arguments),this._timer=null,this._input=null;}function RotateRecognizer(){AttrRecognizer.apply(this,arguments);}function SwipeRecognizer(){AttrRecognizer.apply(this,arguments);}function TapRecognizer(){Recognizer.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0;}function Hammer(element,options){return options=options||{},options.recognizers=ifUndefined(options.recognizers,Hammer.defaults.preset),new Manager(element,options);}function Manager(element,options){this.options=assign({},Hammer.defaults,options||{}),this.options.inputTarget=this.options.inputTarget||element,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=element,this.input=createInputInstance(this),this.touchAction=new TouchAction(this,this.options.touchAction),toggleCssProps(this,!0),each(this.options.recognizers,function(item){var recognizer=this.add(new item[0](item[1]));item[2]&&recognizer.recognizeWith(item[2]),item[3]&&recognizer.requireFailure(item[3]);},this);}function toggleCssProps(manager,add){var element=manager.element;if(!element.style)return;var prop;each(manager.options.cssProps,function(value,name){prop=prefixed(element.style,name),add?(manager.oldCssProps[prop]=element.style[prop],element.style[prop]=value):element.style[prop]=manager.oldCssProps[prop]||'';}),add||(manager.oldCssProps={});}function triggerDomEvent(event,data){var gestureEvent=document.createEvent('Event');gestureEvent.initEvent(event,!0,!0),gestureEvent.gesture=data,data.target.dispatchEvent(gestureEvent);}var VENDOR_PREFIXES=['','webkit','Moz','MS','ms','o'];var TEST_ELEMENT=document.createElement('div');var TYPE_FUNCTION='function';var round=Math.round;var abs=Math.abs;var now=Date.now;var assign;typeof Object.assign!=='function'?assign=function assign(target){if(target===undefined||target===null)throw new TypeError('Cannot convert undefined or null to object');var output=Object(target);for(var index=1;index<arguments.length;index++){var source=arguments[index];if(source!==undefined&&source!==null)for(var nextKey in source)source.hasOwnProperty(nextKey)&&(output[nextKey]=source[nextKey]);}return output;}:assign=Object.assign;var extend=deprecate(function extend(dest,src,merge){var keys=Object.keys(src);var i=0;while(i<keys.length)(!merge||merge&&dest[keys[i]]===undefined)&&(dest[keys[i]]=src[keys[i]]),i++;return dest;},'extend','Use `assign`.');var merge=deprecate(function merge(dest,src){return extend(dest,src,!0);},'merge','Use `assign`.');var _uniqueId=1;var MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android/i;var SUPPORT_TOUCH='ontouchstart'in window;var SUPPORT_POINTER_EVENTS=prefixed(window,'PointerEvent')!==undefined;var SUPPORT_ONLY_TOUCH=SUPPORT_TOUCH&&MOBILE_REGEX.test(navigator.userAgent);var INPUT_TYPE_TOUCH='touch';var INPUT_TYPE_PEN='pen';var INPUT_TYPE_MOUSE='mouse';var INPUT_TYPE_KINECT='kinect';var COMPUTE_INTERVAL=25;var INPUT_START=1;var INPUT_MOVE=2;var INPUT_END=4;var INPUT_CANCEL=8;var DIRECTION_NONE=1;var DIRECTION_LEFT=2;var DIRECTION_RIGHT=4;var DIRECTION_UP=8;var DIRECTION_DOWN=16;var DIRECTION_HORIZONTAL=DIRECTION_LEFT|DIRECTION_RIGHT;var DIRECTION_VERTICAL=DIRECTION_UP|DIRECTION_DOWN;var DIRECTION_ALL=DIRECTION_HORIZONTAL|DIRECTION_VERTICAL;var PROPS_XY=['x','y'];var PROPS_CLIENT_XY=['clientX','clientY'];Input.prototype={handler:function handler(){},init:function init(){this.evEl&&addEventListeners(this.element,this.evEl,this.domHandler),this.evTarget&&addEventListeners(this.target,this.evTarget,this.domHandler),this.evWin&&addEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler);},destroy:function destroy(){this.evEl&&removeEventListeners(this.element,this.evEl,this.domHandler),this.evTarget&&removeEventListeners(this.target,this.evTarget,this.domHandler),this.evWin&&removeEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler);}};var MOUSE_INPUT_MAP={mousedown:INPUT_START,mousemove:INPUT_MOVE,mouseup:INPUT_END};var MOUSE_ELEMENT_EVENTS='mousedown';var MOUSE_WINDOW_EVENTS='mousemove mouseup';inherit(MouseInput,Input,{handler:function MEhandler(ev){var eventType=MOUSE_INPUT_MAP[ev.type];if(eventType&INPUT_START&&ev.button===0&&(this.pressed=!0),eventType&INPUT_MOVE&&ev.which!==1&&(eventType=INPUT_END),!this.pressed)return;eventType&INPUT_END&&(this.pressed=!1),this.callback(this.manager,eventType,{pointers:[ev],changedPointers:[ev],pointerType:INPUT_TYPE_MOUSE,srcEvent:ev});}});var POINTER_INPUT_MAP={pointerdown:INPUT_START,pointermove:INPUT_MOVE,pointerup:INPUT_END,pointercancel:INPUT_CANCEL,pointerout:INPUT_CANCEL};var IE10_POINTER_TYPE_ENUM={2:INPUT_TYPE_TOUCH,3:INPUT_TYPE_PEN,4:INPUT_TYPE_MOUSE,5:INPUT_TYPE_KINECT};var POINTER_ELEMENT_EVENTS='pointerdown';var POINTER_WINDOW_EVENTS='pointermove pointerup pointercancel';window.MSPointerEvent&&!window.PointerEvent&&(POINTER_ELEMENT_EVENTS='MSPointerDown',POINTER_WINDOW_EVENTS='MSPointerMove MSPointerUp MSPointerCancel'),inherit(PointerEventInput,Input,{handler:function PEhandler(ev){var store=this.store;var removePointer=!1;var eventTypeNormalized=ev.type.toLowerCase().replace('ms','');var eventType=POINTER_INPUT_MAP[eventTypeNormalized];var pointerType=IE10_POINTER_TYPE_ENUM[ev.pointerType]||ev.pointerType;var isTouch=pointerType==INPUT_TYPE_TOUCH;var storeIndex=inArray(store,ev.pointerId,'pointerId');if(eventType&INPUT_START&&(ev.button===0||isTouch)?storeIndex<0&&(store.push(ev),storeIndex=store.length-1):eventType&(INPUT_END|INPUT_CANCEL)&&(removePointer=!0),storeIndex<0)return;store[storeIndex]=ev,this.callback(this.manager,eventType,{pointers:store,changedPointers:[ev],pointerType:pointerType,srcEvent:ev}),removePointer&&store.splice(storeIndex,1);}});var SINGLE_TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:INPUT_MOVE,touchend:INPUT_END,touchcancel:INPUT_CANCEL};var SINGLE_TOUCH_TARGET_EVENTS='touchstart';var SINGLE_TOUCH_WINDOW_EVENTS='touchstart touchmove touchend touchcancel';inherit(SingleTouchInput,Input,{handler:function TEhandler(ev){var type=SINGLE_TOUCH_INPUT_MAP[ev.type];if(type===INPUT_START&&(this.started=!0),!this.started)return;var touches=normalizeSingleTouches.call(this,ev,type);type&(INPUT_END|INPUT_CANCEL)&&touches[0].length-touches[1].length===0&&(this.started=!1),this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:INPUT_TYPE_TOUCH,srcEvent:ev});}});var TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:INPUT_MOVE,touchend:INPUT_END,touchcancel:INPUT_CANCEL};var TOUCH_TARGET_EVENTS='touchstart touchmove touchend touchcancel';inherit(TouchInput,Input,{handler:function MTEhandler(ev){var type=TOUCH_INPUT_MAP[ev.type];var touches=getTouches.call(this,ev,type);if(!touches)return;this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:INPUT_TYPE_TOUCH,srcEvent:ev});}});var DEDUP_TIMEOUT=2500;var DEDUP_DISTANCE=25;inherit(TouchMouseInput,Input,{handler:function TMEhandler(manager,inputEvent,inputData){var isTouch=inputData.pointerType==INPUT_TYPE_TOUCH,isMouse=inputData.pointerType==INPUT_TYPE_MOUSE;if(isMouse&&inputData.sourceCapabilities&&inputData.sourceCapabilities.firesTouchEvents)return;if(isTouch)recordTouches.call(this,inputEvent,inputData);else if(isMouse&&isSyntheticEvent.call(this,inputData))return;this.callback(manager,inputEvent,inputData);},destroy:function destroy(){this.touch.destroy(),this.mouse.destroy();}});var PREFIXED_TOUCH_ACTION=prefixed(TEST_ELEMENT.style,'touchAction');var NATIVE_TOUCH_ACTION=PREFIXED_TOUCH_ACTION!==undefined;var TOUCH_ACTION_COMPUTE='compute';var TOUCH_ACTION_AUTO='auto';var TOUCH_ACTION_MANIPULATION='manipulation';var TOUCH_ACTION_NONE='none';var TOUCH_ACTION_PAN_X='pan-x';var TOUCH_ACTION_PAN_Y='pan-y';var TOUCH_ACTION_MAP=getTouchActionProps();TouchAction.prototype={set:function set(value){value==TOUCH_ACTION_COMPUTE&&(value=this.compute()),NATIVE_TOUCH_ACTION&&this.manager.element.style&&TOUCH_ACTION_MAP[value]&&(this.manager.element.style[PREFIXED_TOUCH_ACTION]=value),this.actions=value.toLowerCase().trim();},update:function update(){this.set(this.manager.options.touchAction);},compute:function compute(){var actions=[];return each(this.manager.recognizers,function(recognizer){boolOrFn(recognizer.options.enable,[recognizer])&&(actions=actions.concat(recognizer.getTouchAction()));}),cleanTouchActions(actions.join(' '));},preventDefaults:function preventDefaults(input){var srcEvent=input.srcEvent;var direction=input.offsetDirection;if(this.manager.session.prevented){srcEvent.preventDefault();return;}var actions=this.actions;var hasNone=inStr(actions,TOUCH_ACTION_NONE)&&!TOUCH_ACTION_MAP[TOUCH_ACTION_NONE];var hasPanY=inStr(actions,TOUCH_ACTION_PAN_Y)&&!TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_Y];var hasPanX=inStr(actions,TOUCH_ACTION_PAN_X)&&!TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_X];if(hasNone){var isTapPointer=input.pointers.length===1;var isTapMovement=input.distance<2;var isTapTouchTime=input.deltaTime<250;if(isTapPointer&&isTapMovement&&isTapTouchTime)return;}return hasPanX&&hasPanY?void 0:hasNone||hasPanY&&direction&DIRECTION_HORIZONTAL||hasPanX&&direction&DIRECTION_VERTICAL?this.preventSrc(srcEvent):void 0;},preventSrc:function preventSrc(srcEvent){this.manager.session.prevented=!0,srcEvent.preventDefault();}};var STATE_POSSIBLE=1;var STATE_BEGAN=2;var STATE_CHANGED=4;var STATE_ENDED=8;var STATE_RECOGNIZED=STATE_ENDED;var STATE_CANCELLED=16;var STATE_FAILED=32;Recognizer.prototype={defaults:{},set:function set(options){return assign(this.options,options),this.manager&&this.manager.touchAction.update(),this;},recognizeWith:function recognizeWith(otherRecognizer){if(invokeArrayArg(otherRecognizer,'recognizeWith',this))return this;var simultaneous=this.simultaneous;return otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this),simultaneous[otherRecognizer.id]||(simultaneous[otherRecognizer.id]=otherRecognizer,otherRecognizer.recognizeWith(this)),this;},dropRecognizeWith:function dropRecognizeWith(otherRecognizer){return invokeArrayArg(otherRecognizer,'dropRecognizeWith',this)?this:(otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this),delete this.simultaneous[otherRecognizer.id],this);},requireFailure:function requireFailure(otherRecognizer){if(invokeArrayArg(otherRecognizer,'requireFailure',this))return this;var requireFail=this.requireFail;return otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this),inArray(requireFail,otherRecognizer)===-1&&(requireFail.push(otherRecognizer),otherRecognizer.requireFailure(this)),this;},dropRequireFailure:function dropRequireFailure(otherRecognizer){if(invokeArrayArg(otherRecognizer,'dropRequireFailure',this))return this;otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);var index=inArray(this.requireFail,otherRecognizer);return index>-1&&this.requireFail.splice(index,1),this;},hasRequireFailures:function hasRequireFailures(){return this.requireFail.length>0;},canRecognizeWith:function canRecognizeWith(otherRecognizer){return!!this.simultaneous[otherRecognizer.id];},emit:function emit(input){function emit(event){self.manager.emit(event,input);}var self=this;var state=this.state;state<STATE_ENDED&&emit(self.options.event+stateStr(state)),emit(self.options.event),input.additionalEvent&&emit(input.additionalEvent),state>=STATE_ENDED&&emit(self.options.event+stateStr(state));},tryEmit:function tryEmit(input){if(this.canEmit())return this.emit(input);this.state=STATE_FAILED;},canEmit:function canEmit(){var i=0;while(i<this.requireFail.length){if(!(this.requireFail[i].state&(STATE_FAILED|STATE_POSSIBLE)))return!1;i++;}return!0;},recognize:function recognize(inputData){var inputDataClone=assign({},inputData);if(!boolOrFn(this.options.enable,[this,inputDataClone])){this.reset(),this.state=STATE_FAILED;return;}this.state&(STATE_RECOGNIZED|STATE_CANCELLED|STATE_FAILED)&&(this.state=STATE_POSSIBLE),this.state=this.process(inputDataClone),this.state&(STATE_BEGAN|STATE_CHANGED|STATE_ENDED|STATE_CANCELLED)&&this.tryEmit(inputDataClone);},process:function process(inputData){},getTouchAction:function getTouchAction(){},reset:function reset(){}},inherit(AttrRecognizer,Recognizer,{defaults:{pointers:1},attrTest:function attrTest(input){var optionPointers=this.options.pointers;return optionPointers===0||input.pointers.length===optionPointers;},process:function process(input){var state=this.state;var eventType=input.eventType;var isRecognized=state&(STATE_BEGAN|STATE_CHANGED);var isValid=this.attrTest(input);if(isRecognized&&(eventType&INPUT_CANCEL||!isValid))return state|STATE_CANCELLED;else if(isRecognized||isValid){if(eventType&INPUT_END)return state|STATE_ENDED;else if(!(state&STATE_BEGAN))return STATE_BEGAN;return state|STATE_CHANGED;}return STATE_FAILED;}}),inherit(PanRecognizer,AttrRecognizer,{defaults:{event:'pan',threshold:10,pointers:1,direction:DIRECTION_ALL},getTouchAction:function getTouchAction(){var direction=this.options.direction;var actions=[];return direction&DIRECTION_HORIZONTAL&&actions.push(TOUCH_ACTION_PAN_Y),direction&DIRECTION_VERTICAL&&actions.push(TOUCH_ACTION_PAN_X),actions;},directionTest:function directionTest(input){var options=this.options;var hasMoved=!0;var distance=input.distance;var direction=input.direction;var x=input.deltaX;var y=input.deltaY;return direction&options.direction||(options.direction&DIRECTION_HORIZONTAL?(direction=x===0?DIRECTION_NONE:x<0?DIRECTION_LEFT:DIRECTION_RIGHT,hasMoved=x!=this.pX,distance=Math.abs(input.deltaX)):(direction=y===0?DIRECTION_NONE:y<0?DIRECTION_UP:DIRECTION_DOWN,hasMoved=y!=this.pY,distance=Math.abs(input.deltaY))),input.direction=direction,hasMoved&&distance>options.threshold&&direction&options.direction;},attrTest:function attrTest(input){return AttrRecognizer.prototype.attrTest.call(this,input)&&(this.state&STATE_BEGAN||!(this.state&STATE_BEGAN)&&this.directionTest(input));},emit:function emit(input){this.pX=input.deltaX,this.pY=input.deltaY;var direction=directionStr(input.direction);direction&&(input.additionalEvent=this.options.event+direction),this._super.emit.call(this,input);}}),inherit(PinchRecognizer,AttrRecognizer,{defaults:{event:'pinch',threshold:0,pointers:2},getTouchAction:function getTouchAction(){return[TOUCH_ACTION_NONE];},attrTest:function attrTest(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.scale-1)>this.options.threshold||this.state&STATE_BEGAN);},emit:function emit(input){if(input.scale!==1){var inOut=input.scale<1?'in':'out';input.additionalEvent=this.options.event+inOut;}this._super.emit.call(this,input);}}),inherit(PressRecognizer,Recognizer,{defaults:{event:'press',pointers:1,time:251,threshold:9},getTouchAction:function getTouchAction(){return[TOUCH_ACTION_AUTO];},process:function process(input){var options=this.options;var validPointers=input.pointers.length===options.pointers;var validMovement=input.distance<options.threshold;var validTime=input.deltaTime>options.time;if(this._input=input,!(validMovement&&validPointers)||input.eventType&(INPUT_END|INPUT_CANCEL)&&!validTime)this.reset();else if(input.eventType&INPUT_START)this.reset(),this._timer=setTimeoutContext(function(){this.state=STATE_RECOGNIZED,this.tryEmit();},options.time,this);else if(input.eventType&INPUT_END)return STATE_RECOGNIZED;return STATE_FAILED;},reset:function reset(){clearTimeout(this._timer);},emit:function emit(input){if(this.state!==STATE_RECOGNIZED)return;input&&input.eventType&INPUT_END?this.manager.emit(this.options.event+'up',input):(this._input.timeStamp=now(),this.manager.emit(this.options.event,this._input));}}),inherit(RotateRecognizer,AttrRecognizer,{defaults:{event:'rotate',threshold:0,pointers:2},getTouchAction:function getTouchAction(){return[TOUCH_ACTION_NONE];},attrTest:function attrTest(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.rotation)>this.options.threshold||this.state&STATE_BEGAN);}}),inherit(SwipeRecognizer,AttrRecognizer,{defaults:{event:'swipe',threshold:10,velocity:0.3,direction:DIRECTION_HORIZONTAL|DIRECTION_VERTICAL,pointers:1},getTouchAction:function getTouchAction(){return PanRecognizer.prototype.getTouchAction.call(this);},attrTest:function attrTest(input){var direction=this.options.direction;var velocity;return direction&(DIRECTION_HORIZONTAL|DIRECTION_VERTICAL)?velocity=input.overallVelocity:direction&DIRECTION_HORIZONTAL?velocity=input.overallVelocityX:direction&DIRECTION_VERTICAL&&(velocity=input.overallVelocityY),this._super.attrTest.call(this,input)&&direction&input.offsetDirection&&input.distance>this.options.threshold&&input.maxPointers==this.options.pointers&&abs(velocity)>this.options.velocity&&input.eventType&INPUT_END;},emit:function emit(input){var direction=directionStr(input.offsetDirection);direction&&this.manager.emit(this.options.event+direction,input),this.manager.emit(this.options.event,input);}}),inherit(TapRecognizer,Recognizer,{defaults:{event:'tap',pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function getTouchAction(){return[TOUCH_ACTION_MANIPULATION];},process:function process(input){var options=this.options;var validPointers=input.pointers.length===options.pointers;var validMovement=input.distance<options.threshold;var validTouchTime=input.deltaTime<options.time;if(this.reset(),input.eventType&INPUT_START&&this.count===0)return this.failTimeout();if(validMovement&&validTouchTime&&validPointers){if(input.eventType!=INPUT_END)return this.failTimeout();var validInterval=this.pTime?input.timeStamp-this.pTime<options.interval:!0;var validMultiTap=!this.pCenter||getDistance(this.pCenter,input.center)<options.posThreshold;this.pTime=input.timeStamp,this.pCenter=input.center,validMultiTap&&validInterval?this.count+=1:this.count=1,this._input=input;var tapCount=this.count%options.taps;if(tapCount===0)return this.hasRequireFailures()?(this._timer=setTimeoutContext(function(){this.state=STATE_RECOGNIZED,this.tryEmit();},options.interval,this),STATE_BEGAN):STATE_RECOGNIZED;}return STATE_FAILED;},failTimeout:function failTimeout(){return this._timer=setTimeoutContext(function(){this.state=STATE_FAILED;},this.options.interval,this),STATE_FAILED;},reset:function reset(){clearTimeout(this._timer);},emit:function emit(){this.state==STATE_RECOGNIZED&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input));}}),Hammer.VERSION='2.0.7',Hammer.defaults={domEvents:!1,touchAction:TOUCH_ACTION_COMPUTE,enable:!0,inputTarget:null,inputClass:null,preset:[[RotateRecognizer,{enable:!1}],[PinchRecognizer,{enable:!1},['rotate']],[SwipeRecognizer,{direction:DIRECTION_HORIZONTAL}],[PanRecognizer,{direction:DIRECTION_HORIZONTAL},['swipe']],[TapRecognizer],[TapRecognizer,{event:'doubletap',taps:2},['tap']],[PressRecognizer]],cssProps:{userSelect:'none',touchSelect:'none',touchCallout:'none',contentZooming:'none',userDrag:'none',tapHighlightColor:'rgba(0,0,0,0)'}};var STOP=1;var FORCED_STOP=2;Manager.prototype={set:function set(options){return assign(this.options,options),options.touchAction&&this.touchAction.update(),options.inputTarget&&(this.input.destroy(),this.input.target=options.inputTarget,this.input.init()),this;},stop:function stop(force){this.session.stopped=force?FORCED_STOP:STOP;},recognize:function recognize(inputData){var session=this.session;if(session.stopped)return;this.touchAction.preventDefaults(inputData);var recognizer;var recognizers=this.recognizers;var curRecognizer=session.curRecognizer;(!curRecognizer||curRecognizer&&curRecognizer.state&STATE_RECOGNIZED)&&(curRecognizer=session.curRecognizer=null);var i=0;while(i<recognizers.length)recognizer=recognizers[i],session.stopped!==FORCED_STOP&&(!curRecognizer||recognizer==curRecognizer||recognizer.canRecognizeWith(curRecognizer))?recognizer.recognize(inputData):recognizer.reset(),!curRecognizer&&recognizer.state&(STATE_BEGAN|STATE_CHANGED|STATE_ENDED)&&(curRecognizer=session.curRecognizer=recognizer),i++;},get:function get(recognizer){if(recognizer instanceof Recognizer)return recognizer;var recognizers=this.recognizers;for(var i=0;i<recognizers.length;i++)if(recognizers[i].options.event==recognizer)return recognizers[i];return null;},add:function add(recognizer){if(invokeArrayArg(recognizer,'add',this))return this;var existing=this.get(recognizer.options.event);return existing&&this.remove(existing),this.recognizers.push(recognizer),recognizer.manager=this,this.touchAction.update(),recognizer;},remove:function remove(recognizer){if(invokeArrayArg(recognizer,'remove',this))return this;if(recognizer=this.get(recognizer),recognizer){var recognizers=this.recognizers;var index=inArray(recognizers,recognizer);index!==-1&&(recognizers.splice(index,1),this.touchAction.update());}return this;},on:function on(events,handler){if(events===undefined)return;if(handler===undefined)return;var handlers=this.handlers;return each(splitStr(events),function(event){handlers[event]=handlers[event]||[],handlers[event].push(handler);}),this;},off:function off(events,handler){if(events===undefined)return;var handlers=this.handlers;return each(splitStr(events),function(event){handler?handlers[event]&&handlers[event].splice(inArray(handlers[event],handler),1):delete handlers[event];}),this;},emit:function emit(event,data){this.options.domEvents&&triggerDomEvent(event,data);var handlers=this.handlers[event]&&this.handlers[event].slice();if(!(handlers&&handlers.length))return;data.type=event,data.preventDefault=function(){data.srcEvent.preventDefault();};var i=0;while(i<handlers.length)handlers[i](data),i++;},destroy:function destroy(){this.element&&toggleCssProps(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null;}},assign(Hammer,{INPUT_START:INPUT_START,INPUT_MOVE:INPUT_MOVE,INPUT_END:INPUT_END,INPUT_CANCEL:INPUT_CANCEL,STATE_POSSIBLE:STATE_POSSIBLE,STATE_BEGAN:STATE_BEGAN,STATE_CHANGED:STATE_CHANGED,STATE_ENDED:STATE_ENDED,STATE_RECOGNIZED:STATE_RECOGNIZED,STATE_CANCELLED:STATE_CANCELLED,STATE_FAILED:STATE_FAILED,DIRECTION_NONE:DIRECTION_NONE,DIRECTION_LEFT:DIRECTION_LEFT,DIRECTION_RIGHT:DIRECTION_RIGHT,DIRECTION_UP:DIRECTION_UP,DIRECTION_DOWN:DIRECTION_DOWN,DIRECTION_HORIZONTAL:DIRECTION_HORIZONTAL,DIRECTION_VERTICAL:DIRECTION_VERTICAL,DIRECTION_ALL:DIRECTION_ALL,Manager:Manager,Input:Input,TouchAction:TouchAction,TouchInput:TouchInput,MouseInput:MouseInput,PointerEventInput:PointerEventInput,TouchMouseInput:TouchMouseInput,SingleTouchInput:SingleTouchInput,Recognizer:Recognizer,AttrRecognizer:AttrRecognizer,Tap:TapRecognizer,Pan:PanRecognizer,Swipe:SwipeRecognizer,Pinch:PinchRecognizer,Rotate:RotateRecognizer,Press:PressRecognizer,on:addEventListeners,off:removeEventListeners,each:each,merge:merge,extend:extend,assign:assign,inherit:inherit,bindFn:bindFn,prefixed:prefixed});var freeGlobal=window!==void 0?window:typeof self!=='undefined'?self:{};freeGlobal.Hammer=Hammer,typeof define==='function'&&define.amd?define(function(){return Hammer;}):module!==void 0&&module.exports?module.exports=Hammer:window[exportName]=Hammer;}(window,document,'Hammer'));},{}],348:[function(require,module,exports){'use strict';var hat=module.exports=function(bits,base){if(base||(base=16),bits===undefined&&(bits=128),bits<=0)return'0';var digits=Math.log(Math.pow(2,bits))/Math.log(base);for(var i=2;digits===Infinity;i*=2)digits=Math.log(Math.pow(2,bits/ i))/Math.log(base)*i;var rem=digits-Math.floor(digits);var res='';for(var i=0;i<Math.floor(digits);i++){var x=Math.floor(Math.random()*base).toString(base);res=x+res;}if(rem){var b=Math.pow(base,rem);var x=Math.floor(Math.random()*b).toString(base);res=x+res;}var parsed=parseInt(res,base);return parsed!==Infinity&&parsed>=Math.pow(2,bits)?hat(bits,base):res;};hat.rack=function(bits,base,expandBy){var fn=function fn(data){var iters=0;do{if(iters++>10)if(expandBy)bits+=expandBy;else throw new Error('too many ID collisions, use more bits');var id=hat(bits,base);}while(Object.hasOwnProperty.call(hats,id));return hats[id]=data,id;};var hats=fn.hats={};return fn.get=function(id){return fn.hats[id];},fn.set=function(id,value){return fn.hats[id]=value,fn;},fn.bits=bits||128,fn.base=base||16,fn;};},{}],349:[function(require,module,exports){'use strict';function Ids(seed){if(!(this instanceof Ids))return new Ids(seed);seed=seed||[128,36,1],this._seed=seed.length?hat.rack(seed[0],seed[1],seed[2]):seed;}var hat=require('hat');module.exports=Ids,Ids.prototype.next=function(element){return this._seed(element||!0);},Ids.prototype.nextPrefixed=function(prefix,element){var id;do id=prefix+this.next(!0);while(this.assigned(id));return this.claim(id,element),id;},Ids.prototype.claim=function(id,element){this._seed.set(id,element||!0);},Ids.prototype.assigned=function(id){return this._seed.get(id)||!1;},Ids.prototype.unclaim=function(id){delete this._seed.hats[id];},Ids.prototype.clear=function(){var hats=this._seed.hats,id;for(id in hats)this.unclaim(id);};},{hat:348}],350:[function(require,module,exports){'use strict';typeof Object.create==='function'?module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}});}:module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function TempCtor(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor(),ctor.prototype.constructor=ctor;};},{}],351:[function(require,module,exports){'use strict';var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj;};(function(global,factory){'use strict';(module===void 0?'undefined':_typeof(module))==='object'&&_typeof(module.exports)==='object'?module.exports=global.document?factory(global,!0):function(w){if(!w.document)throw new Error('jQuery requires a window with a document');return factory(w);}:factory(global);}(typeof window!=='undefined'?window:undefined,function(window,noGlobal){'use strict';function DOMEval(code,doc,node){doc=doc||document;var i,script=doc.createElement('script');if(script.text=code,node)for(i in preservedScriptAttributes)node[i]&&(script[i]=node[i]);doc.head.appendChild(script).parentNode.removeChild(script);}function toType(obj){return obj==null?obj+'':(obj===void 0?'undefined':_typeof(obj))==='object'||typeof obj==='function'?class2type[toString.call(obj)]||'object':obj===void 0?'undefined':_typeof(obj);}function isArrayLike(obj){var length=!!obj&&'length'in obj&&obj.length,type=toType(obj);return isFunction(obj)||isWindow(obj)?!1:type==='array'||length===0||typeof length==='number'&&length>0&&length-1 in obj;}function nodeName(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase();}function winnow(elements,qualifier,not){return isFunction(qualifier)?jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not;}):qualifier.nodeType?jQuery.grep(elements,function(elem){return elem===qualifier!==not;}):typeof qualifier!=='string'?jQuery.grep(elements,function(elem){return indexOf.call(qualifier,elem)>-1!==not;}):jQuery.filter(qualifier,elements,not);}function sibling(cur,dir){while((cur=cur[dir])&&cur.nodeType!==1);return cur;}function createOptions(options){var object={};return jQuery.each(options.match(rnothtmlwhite)||[],function(_,flag){object[flag]=!0;}),object;}function Identity(v){return v;}function Thrower(ex){throw ex;}function adoptValue(value,resolve,reject,noValue){var method;try{value&&isFunction(method=value.promise)?method.call(value).done(resolve).fail(reject):value&&isFunction(method=value.then)?method.call(value,resolve,reject):resolve.apply(undefined,[value].slice(noValue));}catch(value){reject.apply(undefined,[value]);}}function completed(){document.removeEventListener('DOMContentLoaded',completed),window.removeEventListener('load',completed),jQuery.ready();}function fcamelCase(all,letter){return letter.toUpperCase();}function camelCase(string){return string.replace(rmsPrefix,'ms-').replace(rdashAlpha,fcamelCase);}function Data(){this.expando=jQuery.expando+Data.uid++;}function getData(data){return data==='true'?!0:data==='false'?!1:data==='null'?null:data===+data+''?+data:rbrace.test(data)?JSON.parse(data):data;}function dataAttr(elem,key,data){var name;if(data===undefined&&elem.nodeType===1)if(name='data-'+key.replace(rmultiDash,'-$&').toLowerCase(),data=elem.getAttribute(name),typeof data==='string'){try{data=getData(data);}catch(e){}dataUser.set(elem,key,data);}else data=undefined;return data;}function adjustCSS(elem,prop,valueParts,tween){var adjusted,scale,maxIterations=20,currentValue=tween?function(){return tween.cur();}:function(){return jQuery.css(elem,prop,'');},initial=currentValue(),unit=valueParts&&valueParts[3]||(jQuery.cssNumber[prop]?'':'px'),initialInUnit=(jQuery.cssNumber[prop]||unit!=='px'&&+initial)&&rcssNum.exec(jQuery.css(elem,prop));if(initialInUnit&&initialInUnit[3]!==unit){initial/=2,unit=unit||initialInUnit[3],initialInUnit=+initial||1;while(maxIterations--)jQuery.style(elem,prop,initialInUnit+unit),(1-scale)*(1-(scale=currentValue()/ initial||0.5))<=0&&(maxIterations=0),initialInUnit/=scale;initialInUnit*=2,jQuery.style(elem,prop,initialInUnit+unit),valueParts=valueParts||[];}return valueParts&&(initialInUnit=+initialInUnit||+initial||0,adjusted=valueParts[1]?initialInUnit+(valueParts[1]+1)*valueParts[2]:+valueParts[2],tween&&(tween.unit=unit,tween.start=initialInUnit,tween.end=adjusted)),adjusted;}function getDefaultDisplay(elem){var temp,doc=elem.ownerDocument,nodeName=elem.nodeName,display=defaultDisplayMap[nodeName];return display?display:(temp=doc.body.appendChild(doc.createElement(nodeName)),display=jQuery.css(temp,'display'),temp.parentNode.removeChild(temp),display==='none'&&(display='block'),defaultDisplayMap[nodeName]=display,display);}function showHide(elements,show){var display,elem,values=[],index=0,length=elements.length;for(;index<length;index++){if(elem=elements[index],!elem.style)continue;display=elem.style.display,show?(display==='none'&&(values[index]=dataPriv.get(elem,'display')||null,values[index]||(elem.style.display='')),elem.style.display===''&&isHiddenWithinTree(elem)&&(values[index]=getDefaultDisplay(elem))):display!=='none'&&(values[index]='none',dataPriv.set(elem,'display',display));}for(index=0;index<length;index++)values[index]!=null&&(elements[index].style.display=values[index]);return elements;}function getAll(context,tag){var ret;return context.getElementsByTagName!==void 0?ret=context.getElementsByTagName(tag||'*'):context.querySelectorAll!==void 0?ret=context.querySelectorAll(tag||'*'):ret=[],tag===undefined||tag&&nodeName(context,tag)?jQuery.merge([context],ret):ret;}function setGlobalEval(elems,refElements){var i=0,l=elems.length;for(;i<l;i++)dataPriv.set(elems[i],'globalEval',!refElements||dataPriv.get(refElements[i],'globalEval'));}function buildFragment(elems,context,scripts,selection,ignored){var elem,tmp,tag,wrap,contains,j,fragment=context.createDocumentFragment(),nodes=[],i=0,l=elems.length;for(;i<l;i++)if(elem=elems[i],elem||elem===0)if(toType(elem)==='object')jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(!rhtml.test(elem))nodes.push(context.createTextNode(elem));else{tmp=tmp||fragment.appendChild(context.createElement('div')),tag=(rtagName.exec(elem)||['',''])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+jQuery.htmlPrefilter(elem)+wrap[2],j=wrap[0];while(j--)tmp=tmp.lastChild;jQuery.merge(nodes,tmp.childNodes),tmp=fragment.firstChild,tmp.textContent='';}fragment.textContent='',i=0;while(elem=nodes[i++]){if(selection&&jQuery.inArray(elem,selection)>-1){ignored&&ignored.push(elem);continue;}if(contains=jQuery.contains(elem.ownerDocument,elem),tmp=getAll(fragment.appendChild(elem),'script'),contains&&setGlobalEval(tmp),scripts){j=0;while(elem=tmp[j++])rscriptType.test(elem.type||'')&&scripts.push(elem);}}return fragment;}function returnTrue(){return!0;}function returnFalse(){return!1;}function safeActiveElement(){try{return document.activeElement;}catch(err){}}function _on(elem,types,selector,data,fn,one){var origFn,type;if((types===void 0?'undefined':_typeof(types))==='object'){typeof selector!=='string'&&(data=data||selector,selector=undefined);for(type in types)_on(elem,type,selector,data,types[type],one);return elem;}if(data==null&&fn==null?(fn=selector,data=selector=undefined):fn==null&&(typeof selector==='string'?(fn=data,data=undefined):(fn=data,data=selector,selector=undefined)),fn===!1)fn=returnFalse;else if(!fn)return elem;return one===1&&(origFn=fn,fn=function fn(event){return jQuery().off(event),origFn.apply(this,arguments);},fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)),elem.each(function(){jQuery.event.add(this,types,fn,data,selector);});}function manipulationTarget(elem,content){return nodeName(elem,'table')&&nodeName(content.nodeType!==11?content:content.firstChild,'tr')?jQuery(elem).children('tbody')[0]||elem:elem;}function disableScript(elem){return elem.type=(elem.getAttribute('type')!==null)+'/'+elem.type,elem;}function restoreScript(elem){return(elem.type||'').slice(0,5)==='true/'?elem.type=elem.type.slice(5):elem.removeAttribute('type'),elem;}function cloneCopyEvent(src,dest){var i,l,type,pdataOld,pdataCur,udataOld,udataCur,events;if(dest.nodeType!==1)return;if(dataPriv.hasData(src)&&(pdataOld=dataPriv.access(src),pdataCur=dataPriv.set(dest,pdataOld),events=pdataOld.events,events)){delete pdataCur.handle,pdataCur.events={};for(type in events)for(i=0,l=events[type].length;i<l;i++)jQuery.event.add(dest,type,events[type][i]);}dataUser.hasData(src)&&(udataOld=dataUser.access(src),udataCur=jQuery.extend({},udataOld),dataUser.set(dest,udataCur));}function fixInput(src,dest){var nodeName=dest.nodeName.toLowerCase();nodeName==='input'&&rcheckableType.test(src.type)?dest.checked=src.checked:(nodeName==='input'||nodeName==='textarea')&&(dest.defaultValue=src.defaultValue);}function domManip(collection,args,callback,ignored){args=concat.apply([],args);var fragment,first,scripts,hasScripts,node,doc,i=0,l=collection.length,iNoClone=l-1,value=args[0],valueIsFunction=isFunction(value);if(valueIsFunction||l>1&&typeof value==='string'&&!support.checkClone&&rchecked.test(value))return collection.each(function(index){var self=collection.eq(index);valueIsFunction&&(args[0]=value.call(this,index,self.html())),domManip(self,args,callback,ignored);});if(l&&(fragment=buildFragment(args,collection[0].ownerDocument,!1,collection,ignored),first=fragment.firstChild,fragment.childNodes.length===1&&(fragment=first),first||ignored)){for(scripts=jQuery.map(getAll(fragment,'script'),disableScript),hasScripts=scripts.length;i<l;i++)node=fragment,i!==iNoClone&&(node=jQuery.clone(node,!0,!0),hasScripts&&jQuery.merge(scripts,getAll(node,'script'))),callback.call(collection[i],node,i);if(hasScripts)for(doc=scripts[scripts.length-1].ownerDocument,jQuery.map(scripts,restoreScript),i=0;i<hasScripts;i++)node=scripts[i],rscriptType.test(node.type||'')&&!dataPriv.access(node,'globalEval')&&jQuery.contains(doc,node)&&(node.src&&(node.type||'').toLowerCase()!=='module'?jQuery._evalUrl&&jQuery._evalUrl(node.src):DOMEval(node.textContent.replace(rcleanScript,''),doc,node));}return collection;}function _remove(elem,selector,keepData){var node,nodes=selector?jQuery.filter(selector,elem):elem,i=0;for(;(node=nodes[i])!=null;i++)!keepData&&node.nodeType===1&&jQuery.cleanData(getAll(node)),node.parentNode&&(keepData&&jQuery.contains(node.ownerDocument,node)&&setGlobalEval(getAll(node,'script')),node.parentNode.removeChild(node));return elem;}function curCSS(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;return computed=computed||getStyles(elem),computed&&(ret=computed.getPropertyValue(name)||computed[name],ret===''&&!jQuery.contains(elem.ownerDocument,elem)&&(ret=jQuery.style(elem,name)),!support.pixelBoxStyles()&&rnumnonpx.test(ret)&&rboxStyle.test(name)&&(width=style.width,minWidth=style.minWidth,maxWidth=style.maxWidth,style.minWidth=style.maxWidth=style.width=ret,ret=computed.width,style.width=width,style.minWidth=minWidth,style.maxWidth=maxWidth)),ret!==undefined?ret+'':ret;}function addGetHookIf(conditionFn,hookFn){return{get:function get(){if(conditionFn()){delete this.get;return;}return(this.get=hookFn).apply(this,arguments);}};}function vendorPropName(name){if(name in emptyStyle)return name;var capName=name[0].toUpperCase()+name.slice(1),i=cssPrefixes.length;while(i--)if(name=cssPrefixes[i]+capName,name in emptyStyle)return name;}function finalPropName(name){var ret=jQuery.cssProps[name];return ret||(ret=jQuery.cssProps[name]=vendorPropName(name)||name),ret;}function setPositiveNumber(elem,value,subtract){var matches=rcssNum.exec(value);return matches?Math.max(0,matches[2]-(subtract||0))+(matches[3]||'px'):value;}function boxModelAdjustment(elem,dimension,box,isBorderBox,styles,computedVal){var i=dimension==='width'?1:0,extra=0,delta=0;if(box===(isBorderBox?'border':'content'))return 0;for(;i<4;i+=2)box==='margin'&&(delta+=jQuery.css(elem,box+cssExpand[i],!0,styles)),isBorderBox?(box==='content'&&(delta-=jQuery.css(elem,'padding'+cssExpand[i],!0,styles)),box!=='margin'&&(delta-=jQuery.css(elem,'border'+cssExpand[i]+'Width',!0,styles))):(delta+=jQuery.css(elem,'padding'+cssExpand[i],!0,styles),box!=='padding'?delta+=jQuery.css(elem,'border'+cssExpand[i]+'Width',!0,styles):extra+=jQuery.css(elem,'border'+cssExpand[i]+'Width',!0,styles));return!isBorderBox&&computedVal>=0&&(delta+=Math.max(0,Math.ceil(elem['offset'+dimension[0].toUpperCase()+dimension.slice(1)]-computedVal-delta-extra-0.5))),delta;}function getWidthOrHeight(elem,dimension,extra){var styles=getStyles(elem),val=curCSS(elem,dimension,styles),isBorderBox=jQuery.css(elem,'boxSizing',!1,styles)==='border-box',valueIsBorderBox=isBorderBox;if(rnumnonpx.test(val)){if(!extra)return val;val='auto';}return valueIsBorderBox=valueIsBorderBox&&(support.boxSizingReliable()||val===elem.style[dimension]),(val==='auto'||!parseFloat(val)&&jQuery.css(elem,'display',!1,styles)==='inline')&&(val=elem['offset'+dimension[0].toUpperCase()+dimension.slice(1)],valueIsBorderBox=!0),val=parseFloat(val)||0,val+boxModelAdjustment(elem,dimension,extra||(isBorderBox?'border':'content'),valueIsBorderBox,styles,val)+'px';}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing);}function schedule(){inProgress&&(document.hidden===!1&&window.requestAnimationFrame?window.requestAnimationFrame(schedule):window.setTimeout(schedule,jQuery.fx.interval),jQuery.fx.tick());}function createFxNow(){return window.setTimeout(function(){fxNow=undefined;}),fxNow=Date.now();}function genFx(type,includeWidth){var which,i=0,attrs={height:type};for(includeWidth=includeWidth?1:0;i<4;i+=2-includeWidth)which=cssExpand[i],attrs['margin'+which]=attrs['padding'+which]=type;return includeWidth&&(attrs.opacity=attrs.width=type),attrs;}function createTween(value,prop,animation){var tween,collection=(Animation.tweeners[prop]||[]).concat(Animation.tweeners['*']),index=0,length=collection.length;for(;index<length;index++)if(tween=collection[index].call(animation,prop,value))return tween;}function defaultPrefilter(elem,props,opts){var prop,value,toggle,hooks,oldfire,propTween,restoreDisplay,display,isBox='width'in props||'height'in props,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHiddenWithinTree(elem),dataShow=dataPriv.get(elem,'fxshow');opts.queue||(hooks=jQuery._queueHooks(elem,'fx'),hooks.unqueued==null&&(hooks.unqueued=0,oldfire=hooks.empty.fire,hooks.empty.fire=function(){hooks.unqueued||oldfire();}),hooks.unqueued++,anim.always(function(){anim.always(function(){hooks.unqueued--,jQuery.queue(elem,'fx').length||hooks.empty.fire();});}));for(prop in props)if(value=props[prop],rfxtypes.test(value)){if(delete props[prop],toggle=toggle||value==='toggle',value===(hidden?'hide':'show'))if(value==='show'&&dataShow&&dataShow[prop]!==undefined)hidden=!0;else continue;orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop);}if(propTween=!jQuery.isEmptyObject(props),!propTween&&jQuery.isEmptyObject(orig))return;isBox&&elem.nodeType===1&&(opts.overflow=[style.overflow,style.overflowX,style.overflowY],restoreDisplay=dataShow&&dataShow.display,restoreDisplay==null&&(restoreDisplay=dataPriv.get(elem,'display')),display=jQuery.css(elem,'display'),display==='none'&&(restoreDisplay?display=restoreDisplay:(showHide([elem],!0),restoreDisplay=elem.style.display||restoreDisplay,display=jQuery.css(elem,'display'),showHide([elem]))),(display==='inline'||display==='inline-block'&&restoreDisplay!=null)&&jQuery.css(elem,'float')==='none'&&(propTween||(anim.done(function(){style.display=restoreDisplay;}),restoreDisplay==null&&(display=style.display,restoreDisplay=display==='none'?'':display)),style.display='inline-block')),opts.overflow&&(style.overflow='hidden',anim.always(function(){style.overflow=opts.overflow[0],style.overflowX=opts.overflow[1],style.overflowY=opts.overflow[2];})),propTween=!1;for(prop in orig)propTween||(dataShow?'hidden'in dataShow&&(hidden=dataShow.hidden):dataShow=dataPriv.access(elem,'fxshow',{display:restoreDisplay}),toggle&&(dataShow.hidden=!hidden),hidden&&showHide([elem],!0),anim.done(function(){hidden||showHide([elem]),dataPriv.remove(elem,'fxshow');for(prop in orig)jQuery.style(elem,prop,orig[prop]);})),propTween=createTween(hidden?dataShow[prop]:0,prop,anim),prop in dataShow||(dataShow[prop]=propTween.start,hidden&&(propTween.end=propTween.start,propTween.start=0));}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props)if(name=camelCase(index),easing=specialEasing[name],value=props[index],Array.isArray(value)&&(easing=value[1],value=props[index]=value[0]),index!==name&&(props[name]=value,delete props[index]),hooks=jQuery.cssHooks[name],hooks&&'expand'in hooks){value=hooks.expand(value),delete props[name];for(index in value)index in props||(props[index]=value[index],specialEasing[index]=easing);}else specialEasing[name]=easing;}function Animation(elem,properties,options){var result,stopped,index=0,length=Animation.prefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem;}),tick=function tick(){if(stopped)return!1;var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;for(;index<length;index++)animation.tweens[index].run(percent);return deferred.notifyWith(elem,[animation,percent,remaining]),percent<1&&length?remaining:(length||deferred.notifyWith(elem,[animation,1,0]),deferred.resolveWith(elem,[animation]),!1);},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{},easing:jQuery.easing._default},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function createTween(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);return animation.tweens.push(tween),tween;},stop:function stop(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;for(stopped=!0;index<length;index++)animation.tweens[index].run(1);return gotoEnd?(deferred.notifyWith(elem,[animation,1,0]),deferred.resolveWith(elem,[animation,gotoEnd])):deferred.rejectWith(elem,[animation,gotoEnd]),this;}}),props=animation.props;for(propFilter(props,animation.opts.specialEasing);index<length;index++)if(result=Animation.prefilters[index].call(animation,elem,props,animation.opts),result)return isFunction(result.stop)&&(jQuery._queueHooks(animation.elem,animation.opts.queue).stop=result.stop.bind(result)),result;return jQuery.map(props,createTween,animation),isFunction(animation.opts.start)&&animation.opts.start.call(elem,animation),animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always),jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue})),animation;}function stripAndCollapse(value){var tokens=value.match(rnothtmlwhite)||[];return tokens.join(' ');}function getClass(elem){return elem.getAttribute&&elem.getAttribute('class')||'';}function classesToArray(value){return Array.isArray(value)?value:typeof value==='string'?value.match(rnothtmlwhite)||[]:[];}function buildParams(prefix,obj,traditional,add){var name;if(Array.isArray(obj))jQuery.each(obj,function(i,v){traditional||rbracket.test(prefix)?add(prefix,v):buildParams(prefix+'['+((v===void 0?'undefined':_typeof(v))==='object'&&v!=null?i:'')+']',v,traditional,add);});else if(!traditional&&toType(obj)==='object')for(name in obj)buildParams(prefix+'['+name+']',obj[name],traditional,add);else add(prefix,obj);}function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){typeof dataTypeExpression!=='string'&&(func=dataTypeExpression,dataTypeExpression='*');var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnothtmlwhite)||[];if(isFunction(func))while(dataType=dataTypes[i++])dataType[0]==='+'?(dataType=dataType.slice(1)||'*',(structure[dataType]=structure[dataType]||[]).unshift(func)):(structure[dataType]=structure[dataType]||[]).push(func);};}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){function inspect(dataType){var selected;return inspected[dataType]=!0,jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);if(typeof dataTypeOrTransport==='string'&&!seekingTransport&&!inspected[dataTypeOrTransport])return options.dataTypes.unshift(dataTypeOrTransport),inspect(dataTypeOrTransport),!1;else if(seekingTransport)return!(selected=dataTypeOrTransport);}),selected;}var inspected={},seekingTransport=structure===transports;return inspect(options.dataTypes[0])||!inspected['*']&&inspect('*');}function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)src[key]!==undefined&&((flatOptions[key]?target:deep||(deep={}))[key]=src[key]);return deep&&jQuery.extend(!0,target,deep),target;}function ajaxHandleResponses(s,jqXHR,responses){var ct,type,finalDataType,firstDataType,contents=s.contents,dataTypes=s.dataTypes;while(dataTypes[0]==='*')dataTypes.shift(),ct===undefined&&(ct=s.mimeType||jqXHR.getResponseHeader('Content-Type'));if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break;}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+' '+dataTypes[0]]){finalDataType=type;break;}firstDataType||(firstDataType=type);}finalDataType=finalDataType||firstDataType;}return finalDataType?(finalDataType!==dataTypes[0]&&dataTypes.unshift(finalDataType),responses[finalDataType]):void 0;}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];current=dataTypes.shift();while(current)if(s.responseFields[current]&&(jqXHR[s.responseFields[current]]=response),!prev&&isSuccess&&s.dataFilter&&(response=s.dataFilter(response,s.dataType)),prev=current,current=dataTypes.shift(),current)if(current==='*')current=prev;else if(prev!=='*'&&prev!==current){if(conv=converters[prev+' '+current]||converters['* '+current],!conv)for(conv2 in converters)if(tmp=conv2.split(' '),tmp[1]===current&&(conv=converters[prev+' '+tmp[0]]||converters['* '+tmp[0]],conv)){conv===!0?conv=converters[conv2]:converters[conv2]!==!0&&(current=tmp[0],dataTypes.unshift(tmp[1]));break;}if(conv!==!0)if(conv&&s.throws)response=conv(response);else try{response=conv(response);}catch(e){return{state:'parsererror',error:conv?e:'No conversion from '+prev+' to '+current};}}return{state:'success',data:response};}var arr=[];var document=window.document;var getProto=Object.getPrototypeOf;var _slice=arr.slice;var concat=arr.concat;var push=arr.push;var indexOf=arr.indexOf;var class2type={};var toString=class2type.toString;var hasOwn=class2type.hasOwnProperty;var fnToString=hasOwn.toString;var ObjectFunctionString=fnToString.call(Object);var support={};var isFunction=function isFunction(obj){return typeof obj==='function'&&typeof obj.nodeType!=='number';};var isWindow=function isWindow(obj){return obj!=null&&obj===obj.window;};var preservedScriptAttributes={type:!0,src:!0,noModule:!0};var version='3.3.1',jQuery=function jQuery(selector,context){return new jQuery.fn.init(selector,context);},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,length:0,toArray:function toArray(){return _slice.call(this);},get:function get(num){return num==null?_slice.call(this):num<0?this[num+this.length]:this[num];},pushStack:function pushStack(elems){var ret=jQuery.merge(this.constructor(),elems);return ret.prevObject=this,ret;},each:function each(callback){return jQuery.each(this,callback);},map:function map(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem);}));},slice:function slice(){return this.pushStack(_slice.apply(this,arguments));},first:function first(){return this.eq(0);},last:function last(){return this.eq(-1);},eq:function eq(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=0&&j<len?[this[j]]:[]);},end:function end(){return this.prevObject||this.constructor();},push:push,sort:arr.sort,splice:arr.splice},jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for(typeof target==='boolean'&&(deep=target,target=arguments[i]||{},i++),(target===void 0?'undefined':_typeof(target))!=='object'&&!isFunction(target)&&(target={}),i===length&&(target=this,i--);i<length;i++)if((options=arguments[i])!=null)for(name in options){if(src=target[name],copy=options[name],target===copy)continue;deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=Array.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&Array.isArray(src)?src:[]):clone=src&&jQuery.isPlainObject(src)?src:{},target[name]=jQuery.extend(deep,clone,copy)):copy!==undefined&&(target[name]=copy);}return target;},jQuery.extend({expando:'jQuery'+(version+Math.random()).replace(/\D/g,''),isReady:!0,error:function error(msg){throw new Error(msg);},noop:function noop(){},isPlainObject:function isPlainObject(obj){var proto,Ctor;return!obj||toString.call(obj)!=='[object Object]'?!1:(proto=getProto(obj),proto?(Ctor=hasOwn.call(proto,'constructor')&&proto.constructor,typeof Ctor==='function'&&fnToString.call(Ctor)===ObjectFunctionString):!0);},isEmptyObject:function isEmptyObject(obj){var name;for(name in obj)return!1;return!0;},globalEval:function globalEval(code){DOMEval(code);},each:function each(obj,callback){var length,i=0;if(isArrayLike(obj)){for(length=obj.length;i<length;i++)if(callback.call(obj[i],i,obj[i])===!1)break;}else for(i in obj)if(callback.call(obj[i],i,obj[i])===!1)break;return obj;},trim:function trim(text){return text==null?'':(text+'').replace(rtrim,'');},makeArray:function makeArray(arr,results){var ret=results||[];return arr!=null&&(isArrayLike(Object(arr))?jQuery.merge(ret,typeof arr==='string'?[arr]:arr):push.call(ret,arr)),ret;},inArray:function inArray(elem,arr,i){return arr==null?-1:indexOf.call(arr,elem,i);},merge:function merge(first,second){var len=+second.length,j=0,i=first.length;for(;j<len;j++)first[i++]=second[j];return first.length=i,first;},grep:function grep(elems,callback,invert){var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;for(;i<length;i++)callbackInverse=!callback(elems[i],i),callbackInverse!==callbackExpect&&matches.push(elems[i]);return matches;},map:function map(elems,callback,arg){var length,value,i=0,ret=[];if(isArrayLike(elems))for(length=elems.length;i<length;i++)value=callback(elems[i],i,arg),value!=null&&ret.push(value);else for(i in elems)value=callback(elems[i],i,arg),value!=null&&ret.push(value);return concat.apply([],ret);},guid:1,support:support}),typeof Symbol==='function'&&(jQuery.fn[Symbol.iterator]=arr[Symbol.iterator]),jQuery.each('Boolean Number String Function Array Date RegExp Object Error Symbol'.split(' '),function(i,name){class2type['[object '+name+']']=name.toLowerCase();});var Sizzle=function(window,i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando,preferredDoc,dirruns,done,classCache,tokenCache,compilerCache,sortOrder,hasOwn,arr,pop,push_native,push,slice,indexOf,booleans,whitespace,identifier,attributes,pseudos,rwhitespace,rtrim,rcomma,rcombinators,rattributeQuotes,rpseudo,ridentifier,matchExpr,rinputs,rheader,rnative,rquickExpr,rsibling,runescape,funescape,rcssescape,fcssescape,unloadHandler,disabledAncestor){function Sizzle(selector,context,results,seed){var m,i,elem,nid,match,groups,newSelector,newContext=context&&context.ownerDocument,nodeType=context?context.nodeType:9;if(results=results||[],typeof selector!=='string'||!selector||nodeType!==1&&nodeType!==9&&nodeType!==11)return results;if(!seed&&((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),context=context||document,documentIsHTML)){if(nodeType!==11&&(match=rquickExpr.exec(selector)))if(m=match[1]){if(nodeType===9)if(elem=context.getElementById(m)){if(elem.id===m)return results.push(elem),results;}else return results;else if(newContext&&(elem=newContext.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results;}else if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;else if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results;if(support.qsa&&!compilerCache[selector+' ']&&!(rbuggyQSA&&rbuggyQSA.test(selector))){if(nodeType!==1)newContext=context,newSelector=selector;else if(context.nodeName.toLowerCase()!=='object'){(nid=context.getAttribute('id'))?nid=nid.replace(rcssescape,fcssescape):context.setAttribute('id',nid=expando),groups=tokenize(selector),i=groups.length;while(i--)groups[i]='#'+nid+' '+toSelector(groups[i]);newSelector=groups.join(','),newContext=rsibling.test(selector)&&testContext(context.parentNode)||context;}if(newSelector)try{return push.apply(results,newContext.querySelectorAll(newSelector)),results;}catch(qsaError){}finally{nid===expando&&context.removeAttribute('id');}}}return select(selector.replace(rtrim,'$1'),context,results,seed);}function createCache(){function cache(key,value){return keys.push(key+' ')>Expr.cacheLength&&delete cache[keys.shift()],cache[key+' ']=value;}var keys=[];return cache;}function markFunction(fn){return fn[expando]=!0,fn;}function assert(fn){var el=document.createElement('fieldset');try{return!!fn(el);}catch(e){return false;}finally{el.parentNode&&el.parentNode.removeChild(el),el=null;}}function addHandle(attrs,handler){var arr=attrs.split('|'),i=arr.length;while(i--)Expr.attrHandle[arr[i]]=handler;}function siblingCheck(a,b){var cur=b&&a,diff=cur&&a.nodeType===1&&b.nodeType===1&&a.sourceIndex-b.sourceIndex;if(diff)return diff;if(cur)while(cur=cur.nextSibling)if(cur===b)return-1;return a?1:-1;}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return name==='input'&&elem.type===type;};}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return(name==='input'||name==='button')&&elem.type===type;};}function createDisabledPseudo(disabled){return function(elem){if('form'in elem)return elem.parentNode&&elem.disabled===!1?'label'in elem?'label'in elem.parentNode?elem.parentNode.disabled===disabled:elem.disabled===disabled:elem.isDisabled===disabled||elem.isDisabled!==!disabled&&disabledAncestor(elem)===disabled:elem.disabled===disabled;else if('label'in elem)return elem.disabled===disabled;return!1;};}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;while(i--)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]));});});}function testContext(context){return context&&context.getElementsByTagName!==void 0&&context;}function setFilters(){}function toSelector(tokens){var i=0,len=tokens.length,selector='';for(;i<len;i++)selector+=tokens[i].value;return selector;}function addCombinator(matcher,combinator,base){var dir=combinator.dir,skip=combinator.next,key=skip||dir,checkNonElements=base&&key==='parentNode',doneName=done++;return combinator.first?function(elem,context,xml){while(elem=elem[dir])if(elem.nodeType===1||checkNonElements)return matcher(elem,context,xml);return!1;}:function(elem,context,xml){var oldCache,uniqueCache,outerCache,newCache=[dirruns,doneName];if(xml){while(elem=elem[dir])if((elem.nodeType===1||checkNonElements)&&matcher(elem,context,xml))return!0;}else while(elem=elem[dir])if(elem.nodeType===1||checkNonElements)if(outerCache=elem[expando]||(elem[expando]={}),uniqueCache=outerCache[elem.uniqueID]||(outerCache[elem.uniqueID]={}),skip&&skip===elem.nodeName.toLowerCase())elem=elem[dir]||elem;else if((oldCache=uniqueCache[key])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];else if(uniqueCache[key]=newCache,newCache[2]=matcher(elem,context,xml))return!0;return!1;};}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){var i=matchers.length;while(i--)if(!matchers[i](elem,context,xml))return!1;return!0;}:matchers[0];}function multipleContexts(selector,contexts,results){var i=0,len=contexts.length;for(;i<len;i++)Sizzle(selector,contexts[i],results);return results;}function condense(unmatched,map,filter,context,xml){var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=map!=null;for(;i<len;i++)(elem=unmatched[i])&&(!filter||filter(elem,context,xml))&&(newUnmatched.push(elem),mapped&&map.push(i));return newUnmatched;}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||'*',context.nodeType?[context]:context,[]),matcherIn=preFilter&&(seed||!selector)?condense(elems,preMap,preFilter,context,xml):elems,matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter){temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;while(i--)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));}if(seed){if(postFinder||preFilter){if(postFinder){temp=[],i=matcherOut.length;while(i--)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml);}i=matcherOut.length;while(i--)(elem=matcherOut[i])&&(temp=postFinder?indexOf(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem));}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut);});}function matcherFromTokens(tokens){var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[' '],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext;},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf(checkContext,elem)>-1;},implicitRelative,!0),matchers=[function(elem,context,xml){var ret=!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));return checkContext=null,ret;}];for(;i<len;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if(matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches),matcher[expando]){for(j=++i;j<len;j++)if(Expr.relative[tokens[j].type])break;return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:tokens[i-2].type===' '?'*':''})).replace(rtrim,'$1'),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens(tokens=tokens.slice(j)),j<len&&toSelector(tokens));}matchers.push(matcher);}return elementMatcher(matchers);}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function superMatcher(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i='0',unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG('*',outermost),dirrunsUnique=dirruns+=contextBackup==null?1:Math.random()||0.1,len=elems.length;for(outermost&&(outermostContext=context===document||context||outermost);i!==len&&(elem=elems[i])!=null;i++){if(byElement&&elem){j=0,!context&&elem.ownerDocument!==document&&(setDocument(elem),xml=!documentIsHTML);while(matcher=elementMatchers[j++])if(matcher(elem,context||document,xml)){results.push(elem);break;}outermost&&(dirruns=dirrunsUnique);}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem));}if(matchedCount+=i,bySet&&i!==matchedCount){j=0;while(matcher=setMatchers[j++])matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)while(i--)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched);}push.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results);}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched;};return bySet?markFunction(superMatcher):superMatcher;}expando='sizzle'+1*new Date(),preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function sortOrder(a,b){return a===b&&(hasDuplicate=!0),0;},hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=function indexOf(list,elem){var i=0,len=list.length;for(;i<len;i++)if(list[i]===elem)return i;return-1;},booleans='checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped',whitespace='[\\x20\\t\\r\\n\\f]',identifier='(?:\\\\.|[\\w-]|[^\0-\\xa0])+',attributes='\\['+whitespace+'*('+identifier+')(?:'+whitespace+'*([*^$|!~]?=)'+whitespace+'*(?:\'((?:\\\\.|[^\\\\\'])*)\'|"((?:\\\\.|[^\\\\"])*)"|('+identifier+'))|)'+whitespace+'*\\]',pseudos=':('+identifier+')(?:\\(('+'(\'((?:\\\\.|[^\\\\\'])*)\'|"((?:\\\\.|[^\\\\"])*)")|'+'((?:\\\\.|[^\\\\()[\\]]|'+attributes+')*)|'+'.*'+')\\)|)',rwhitespace=new RegExp(whitespace+'+','g'),rtrim=new RegExp('^'+whitespace+'+|((?:^|[^\\\\])(?:\\\\.)*)'+whitespace+'+$','g'),rcomma=new RegExp('^'+whitespace+'*,'+whitespace+'*'),rcombinators=new RegExp('^'+whitespace+'*([>+~]|'+whitespace+')'+whitespace+'*'),rattributeQuotes=new RegExp('='+whitespace+'*([^\\]\'"]*?)'+whitespace+'*\\]','g'),rpseudo=new RegExp(pseudos),ridentifier=new RegExp('^'+identifier+'$'),matchExpr={ID:new RegExp('^#('+identifier+')'),CLASS:new RegExp('^\\.('+identifier+')'),TAG:new RegExp('^('+identifier+'|[*])'),ATTR:new RegExp('^'+attributes),PSEUDO:new RegExp('^'+pseudos),CHILD:new RegExp('^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\('+whitespace+'*(even|odd|(([+-]|)(\\d*)n|)'+whitespace+'*(?:([+-]|)'+whitespace+'*(\\d+)|))'+whitespace+'*\\)|)','i'),bool:new RegExp('^(?:'+booleans+')$','i'),needsContext:new RegExp('^'+whitespace+'*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\('+whitespace+'*((?:-\\d)?\\d*)'+whitespace+'*\\)|)(?=[^-]|$)','i')},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,runescape=new RegExp('\\\\([\\da-f]{1,6}'+whitespace+'?|('+whitespace+')|.)','ig'),funescape=function funescape(_,escaped,escapedWhitespace){var high='0x'+escaped-65536;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,high&1023|56320);},rcssescape=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,fcssescape=function fcssescape(ch,asCodePoint){return asCodePoint?ch==='\0'?'\uFFFD':ch.slice(0,-1)+'\\'+ch.charCodeAt(ch.length-1).toString(16)+' ':'\\'+ch;},unloadHandler=function unloadHandler(){setDocument();},disabledAncestor=addCombinator(function(elem){return elem.disabled===!0&&('form'in elem||'label'in elem);},{dir:'parentNode',next:'legend'});try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType;}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els));}:function(target,els){var j=target.length,i=0;while(target[j++]=els[i++]){}target.length=j-1;}};}support=Sizzle.support={},isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?documentElement.nodeName!=='HTML':!1;},setDocument=Sizzle.setDocument=function(node){var hasCompare,subWindow,doc=node?node.ownerDocument||node:preferredDoc;return doc===document||doc.nodeType!==9||!doc.documentElement?document:(document=doc,docElem=document.documentElement,documentIsHTML=!isXML(document),preferredDoc!==document&&(subWindow=document.defaultView)&&subWindow.top!==subWindow&&(subWindow.addEventListener?subWindow.addEventListener('unload',unloadHandler,!1):subWindow.attachEvent&&subWindow.attachEvent('onunload',unloadHandler)),support.attributes=assert(function(el){return el.className='i',!el.getAttribute('className');}),support.getElementsByTagName=assert(function(el){return el.appendChild(document.createComment('')),!el.getElementsByTagName('*').length;}),support.getElementsByClassName=rnative.test(document.getElementsByClassName),support.getById=assert(function(el){return docElem.appendChild(el).id=expando,!document.getElementsByName||!document.getElementsByName(expando).length;}),support.getById?(Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute('id')===attrId;};},Expr.find.ID=function(id,context){if(context.getElementById!==void 0&&documentIsHTML){var elem=context.getElementById(id);return elem?[elem]:[];}}):(Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=elem.getAttributeNode!==void 0&&elem.getAttributeNode('id');return node&&node.value===attrId;};},Expr.find.ID=function(id,context){if(context.getElementById!==void 0&&documentIsHTML){var node,i,elems,elem=context.getElementById(id);if(elem){if(node=elem.getAttributeNode('id'),node&&node.value===id)return[elem];elems=context.getElementsByName(id),i=0;while(elem=elems[i++])if(node=elem.getAttributeNode('id'),node&&node.value===id)return[elem];}return[];}}),Expr.find.TAG=support.getElementsByTagName?function(tag,context){if(context.getElementsByTagName!==void 0)return context.getElementsByTagName(tag);else if(support.qsa)return context.querySelectorAll(tag);}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if(tag==='*'){while(elem=results[i++])elem.nodeType===1&&tmp.push(elem);return tmp;}return results;},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){return context.getElementsByClassName!==void 0&&documentIsHTML?context.getElementsByClassName(className):void 0;},rbuggyMatches=[],rbuggyQSA=[],(support.qsa=rnative.test(document.querySelectorAll))&&(assert(function(el){docElem.appendChild(el).innerHTML="<a id='"+expando+"'></a>"+"<select id='"+expando+"-\r\\' msallowcapture=''>"+"<option selected=''></option></select>",el.querySelectorAll("[msallowcapture^='']").length&&rbuggyQSA.push('[*^$]='+whitespace+'*(?:\'\'|"")'),el.querySelectorAll('[selected]').length||rbuggyQSA.push('\\['+whitespace+'*(?:value|'+booleans+')'),el.querySelectorAll('[id~='+expando+'-]').length||rbuggyQSA.push('~='),el.querySelectorAll(':checked').length||rbuggyQSA.push(':checked'),el.querySelectorAll('a#'+expando+'+*').length||rbuggyQSA.push('.#.+[+~]');}),assert(function(el){el.innerHTML="<a href='' disabled='disabled'></a>"+"<select disabled='disabled'><option/></select>";var input=document.createElement('input');input.setAttribute('type','hidden'),el.appendChild(input).setAttribute('name','D'),el.querySelectorAll('[name=d]').length&&rbuggyQSA.push('name'+whitespace+'*[*^$|!~]?='),el.querySelectorAll(':enabled').length!==2&&rbuggyQSA.push(':enabled',':disabled'),docElem.appendChild(el).disabled=!0,el.querySelectorAll(':disabled').length!==2&&rbuggyQSA.push(':enabled',':disabled'),el.querySelectorAll('*,:x'),rbuggyQSA.push(',.*:');})),(support.matchesSelector=rnative.test(matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(el){support.disconnectedMatch=matches.call(el,'*'),matches.call(el,"[s!='']:x"),rbuggyMatches.push('!=',pseudos);}),rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join('|')),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join('|')),hasCompare=rnative.test(docElem.compareDocumentPosition),contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=a.nodeType===9?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!!(bup&&bup.nodeType===1&&(adown.contains?adown.contains(bup):a.compareDocumentPosition&&a.compareDocumentPosition(bup)&16));}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1;},sortOrder=hasCompare?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;return compare?compare:(compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,compare&1||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===document||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)?-1:b===document||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0:compare&4?-1:1);}:function(a,b){if(a===b)return hasDuplicate=!0,0;var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!(aup&&bup))return a===document?-1:b===document?1:aup?-1:bup?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0;else if(aup===bup)return siblingCheck(a,b);cur=a;while(cur=cur.parentNode)ap.unshift(cur);cur=b;while(cur=cur.parentNode)bp.unshift(cur);while(ap[i]===bp[i])i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0;},document);},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements);},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),support.matchesSelector&&documentIsHTML&&!compilerCache[expr+' ']&&!(rbuggyMatches&&rbuggyMatches.test(expr))&&!(rbuggyQSA&&rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&elem.document.nodeType!==11)return ret;}catch(e){}return Sizzle(expr,document,null,[elem]).length>0;},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains(context,elem);},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;return val!==undefined?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null;},Sizzle.escape=function(sel){return(sel+'').replace(rcssescape,fcssescape);},Sizzle.error=function(msg){throw new Error('Syntax error, unrecognized expression: '+msg);},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){while(elem=results[i++])elem===results[i]&&(j=duplicates.push(i));while(j--)results.splice(duplicates[j],1);}return sortInput=null,results;},getText=Sizzle.getText=function(elem){var node,ret='',i=0,nodeType=elem.nodeType;if(!nodeType)while(node=elem[i++])ret+=getText(node);else if(nodeType===1||nodeType===9||nodeType===11)if(typeof elem.textContent==='string')return elem.textContent;else for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem);else if(nodeType===3||nodeType===4)return elem.nodeValue;return ret;},Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{'>':{dir:'parentNode',first:!0},' ':{dir:'parentNode'},'+':{dir:'previousSibling',first:!0},'~':{dir:'previousSibling'}},preFilter:{ATTR:function ATTR(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[3]||match[4]||match[5]||'').replace(runescape,funescape),match[2]==='~='&&(match[3]=' '+match[3]+' '),match.slice(0,4);},CHILD:function CHILD(match){return match[1]=match[1].toLowerCase(),match[1].slice(0,3)==='nth'?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*(match[3]==='even'||match[3]==='odd')),match[5]=+(match[7]+match[8]||match[3]==='odd')):match[3]&&Sizzle.error(match[0]),match;},PSEUDO:function PSEUDO(match){var excess,unquoted=!match[6]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]?match[2]=match[4]||match[5]||'':unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(')',unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3));}},filter:{TAG:function TAG(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return nodeNameSelector==='*'?function(){return!0;}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName;};},CLASS:function CLASS(className){var pattern=classCache[className+' '];return pattern||(pattern=new RegExp('(^|'+whitespace+')'+className+'('+whitespace+'|$)'))&&classCache(className,function(elem){return pattern.test(typeof elem.className==='string'&&elem.className||elem.getAttribute!==void 0&&elem.getAttribute('class')||'');});},ATTR:function ATTR(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return result==null?operator==='!=':operator?(result+='',operator==='='?result===check:operator==='!='?result!==check:operator==='^='?check&&result.indexOf(check)===0:operator==='*='?check&&result.indexOf(check)>-1:operator==='$='?check&&result.slice(-check.length)===check:operator==='~='?(' '+result.replace(rwhitespace,' ')+' ').indexOf(check)>-1:operator==='|='?result===check||result.slice(0,check.length+1)===check+'-':!1):!0;};},CHILD:function CHILD(type,what,argument,first,last){var simple=type.slice(0,3)!=='nth',forward=type.slice(-4)!=='last',ofType=what==='of-type';return first===1&&last===0?function(elem){return!!elem.parentNode;}:function(elem,context,xml){var cache,uniqueCache,outerCache,node,nodeIndex,start,dir=simple!==forward?'nextSibling':'previousSibling',parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType,diff=!1;if(parent){if(simple){while(dir){node=elem;while(node=node[dir])if(ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)return!1;start=dir=type==='only'&&!start&&'nextSibling';}return!0;}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){node=parent,outerCache=node[expando]||(node[expando]={}),uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={}),cache=uniqueCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=nodeIndex&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];while(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())if(node.nodeType===1&&++diff&&node===elem){uniqueCache[type]=[dirruns,nodeIndex,diff];break;}}else if(useCache&&(node=elem,outerCache=node[expando]||(node[expando]={}),uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={}),cache=uniqueCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=nodeIndex),diff===!1)while(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())if((ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)&&++diff&&(useCache&&(outerCache=node[expando]||(node[expando]={}),uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={}),uniqueCache[type]=[dirruns,diff]),node===elem))break;return diff-=last,diff===first||diff%first===0&&diff/first>=0;}};},PSEUDO:function PSEUDO(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error('unsupported pseudo: '+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,'',argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){var idx,matched=fn(seed,argument),i=matched.length;while(i--)idx=indexOf(seed,matched[i]),seed[idx]=!(matches[idx]=matched[i]);}):function(elem){return fn(elem,0,args);}):fn;}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,'$1'));return matcher[expando]?markFunction(function(seed,matches,context,xml){var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;while(i--)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem));}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),input[0]=null,!results.pop();};}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0;};}),contains:markFunction(function(text){return text=text.replace(runescape,funescape),function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1;};}),lang:markFunction(function(lang){return ridentifier.test(lang||'')||Sizzle.error('unsupported lang: '+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do if(elemLang=documentIsHTML?elem.lang:elem.getAttribute('xml:lang')||elem.getAttribute('lang'))return elemLang=elemLang.toLowerCase(),elemLang===lang||elemLang.indexOf(lang+'-')===0;while((elem=elem.parentNode)&&elem.nodeType===1);return!1;};}),target:function target(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id;},root:function root(elem){return elem===docElem;},focus:function focus(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex);},enabled:createDisabledPseudo(!1),disabled:createDisabledPseudo(!0),checked:function checked(elem){var nodeName=elem.nodeName.toLowerCase();return nodeName==='input'&&!!elem.checked||nodeName==='option'&&!!elem.selected;},selected:function selected(elem){return elem.parentNode&&elem.parentNode.selectedIndex,elem.selected===!0;},empty:function empty(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeType<6)return!1;return!0;},parent:function parent(elem){return!Expr.pseudos.empty(elem);},header:function header(elem){return rheader.test(elem.nodeName);},input:function input(elem){return rinputs.test(elem.nodeName);},button:function button(elem){var name=elem.nodeName.toLowerCase();return name==='input'&&elem.type==='button'||name==='button';},text:function text(elem){var attr;return elem.nodeName.toLowerCase()==='input'&&elem.type==='text'&&((attr=elem.getAttribute('type'))==null||attr.toLowerCase()==='text');},first:createPositionalPseudo(function(){return[0];}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1];}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument];}),even:createPositionalPseudo(function(matchIndexes,length){var i=0;for(;i<length;i+=2)matchIndexes.push(i);return matchIndexes;}),odd:createPositionalPseudo(function(matchIndexes,length){var i=1;for(;i<length;i+=2)matchIndexes.push(i);return matchIndexes;}),lt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;--i>=0;)matchIndexes.push(i);return matchIndexes;}),gt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;++i<length;)matchIndexes.push(i);return matchIndexes;})}},Expr.pseudos.nth=Expr.pseudos.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=createInputPseudo(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=createButtonPseudo(i);return setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters(),tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+' '];if(cached)return parseOnly?0:cached.slice(0);soFar=selector,groups=[],preFilters=Expr.preFilter;while(soFar){(!matched||(match=rcomma.exec(soFar)))&&(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim,' ')}),soFar=soFar.slice(matched.length));for(type in Expr.filter)(match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match)))&&(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break;}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0);},compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+' '];if(!cached){match||(match=tokenize(selector)),i=match.length;while(i--)cached=matcherFromTokens(match[i]),cached[expando]?setMatchers.push(cached):elementMatchers.push(cached);cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers)),cached.selector=selector;}return cached;},select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled=typeof selector==='function'&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);if(results=results||[],match.length===1){if(tokens=match[0]=match[0].slice(0),tokens.length>2&&(token=tokens[0]).type==='ID'&&context.nodeType===9&&documentIsHTML&&Expr.relative[tokens[1].type]){if(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0],!context)return results;else compiled&&(context=context.parentNode);selector=selector.slice(tokens.shift().value.length);}i=matchExpr.needsContext.test(selector)?0:tokens.length;while(i--){if(token=tokens[i],Expr.relative[type=token.type])break;if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){if(tokens.splice(i,1),selector=seed.length&&toSelector(tokens),!selector)return push.apply(results,seed),results;break;}}}return(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,!context||rsibling.test(selector)&&testContext(context.parentNode)||context),results;},support.sortStable=expando.split('').sort(sortOrder).join('')===expando,support.detectDuplicates=!!hasDuplicate,setDocument(),support.sortDetached=assert(function(el){return el.compareDocumentPosition(document.createElement('fieldset'))&1;}),assert(function(el){return el.innerHTML="<a href='#'></a>",el.firstChild.getAttribute('href')==='#';})||addHandle('type|href|height|width',function(elem,name,isXML){return isXML?void 0:elem.getAttribute(name,name.toLowerCase()==='type'?1:2);}),support.attributes&&assert(function(el){return el.innerHTML='<input/>',el.firstChild.setAttribute('value',''),el.firstChild.getAttribute('value')==='';})||addHandle('value',function(elem,name,isXML){return!isXML&&elem.nodeName.toLowerCase()==='input'?elem.defaultValue:void 0;}),assert(function(el){return el.getAttribute('disabled')==null;})||addHandle(booleans,function(elem,name,isXML){var val;return isXML?void 0:elem[name]===!0?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null;}),Sizzle;}(window);jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[':']=jQuery.expr.pseudos,jQuery.uniqueSort=jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains,jQuery.escapeSelector=Sizzle.escape;var dir=function dir(elem,_dir,until){var matched=[],truncate=until!==undefined;while((elem=elem[_dir])&&elem.nodeType!==9)if(elem.nodeType===1){if(truncate&&jQuery(elem).is(until))break;matched.push(elem);}return matched;};var _siblings=function _siblings(n,elem){var matched=[];for(;n;n=n.nextSibling)n.nodeType===1&&n!==elem&&matched.push(n);return matched;};var rneedsContext=jQuery.expr.match.needsContext;var rsingleTag=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;jQuery.filter=function(expr,elems,not){var elem=elems[0];return not&&(expr=':not('+expr+')'),elems.length===1&&elem.nodeType===1?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return elem.nodeType===1;}));},jQuery.fn.extend({find:function find(selector){var i,ret,len=this.length,self=this;if(typeof selector!=='string')return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++)if(jQuery.contains(self[i],this))return!0;}));for(ret=this.pushStack([]),i=0;i<len;i++)jQuery.find(selector,self[i],ret);return len>1?jQuery.uniqueSort(ret):ret;},filter:function filter(selector){return this.pushStack(winnow(this,selector||[],!1));},not:function not(selector){return this.pushStack(winnow(this,selector||[],!0));},is:function is(selector){return!!winnow(this,typeof selector==='string'&&rneedsContext.test(selector)?jQuery(selector):selector||[],!1).length;}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,init=jQuery.fn.init=function(selector,context,root){var match,elem;if(!selector)return this;if(root=root||rootjQuery,typeof selector==='string')if(selector[0]==='<'&&selector[selector.length-1]==='>'&&selector.length>=3?match=[null,selector,null]:match=rquickExpr.exec(selector),match&&(match[1]||!context))if(match[1]){if(context=context instanceof jQuery?context[0]:context,jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0)),rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)isFunction(this[match])?this[match](context[match]):this.attr(match,context[match]);return this;}else return elem=document.getElementById(match[2]),elem&&(this[0]=elem,this.length=1),this;else return!context||context.jquery?(context||root).find(selector):this.constructor(context).find(selector);else if(selector.nodeType)return this[0]=selector,this.length=1,this;else if(isFunction(selector))return root.ready!==undefined?root.ready(selector):selector(jQuery);return jQuery.makeArray(selector,this);};init.prototype=jQuery.fn,rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.fn.extend({has:function has(target){var targets=jQuery(target,this),l=targets.length;return this.filter(function(){var i=0;for(;i<l;i++)if(jQuery.contains(this,targets[i]))return!0;});},closest:function closest(selectors,context){var cur,i=0,l=this.length,matched=[],targets=typeof selectors!=='string'&&jQuery(selectors);if(!rneedsContext.test(selectors))for(;i<l;i++)for(cur=this[i];cur&&cur!==context;cur=cur.parentNode)if(cur.nodeType<11&&(targets?targets.index(cur)>-1:cur.nodeType===1&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break;}return this.pushStack(matched.length>1?jQuery.uniqueSort(matched):matched);},index:function index(elem){return elem?typeof elem==='string'?indexOf.call(jQuery(elem),this[0]):indexOf.call(this,elem.jquery?elem[0]:elem):this[0]&&this[0].parentNode?this.first().prevAll().length:-1;},add:function add(selector,context){return this.pushStack(jQuery.uniqueSort(jQuery.merge(this.get(),jQuery(selector,context))));},addBack:function addBack(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector));}}),jQuery.each({parent:function parent(elem){var parent=elem.parentNode;return parent&&parent.nodeType!==11?parent:null;},parents:function parents(elem){return dir(elem,'parentNode');},parentsUntil:function parentsUntil(elem,i,until){return dir(elem,'parentNode',until);},next:function next(elem){return sibling(elem,'nextSibling');},prev:function prev(elem){return sibling(elem,'previousSibling');},nextAll:function nextAll(elem){return dir(elem,'nextSibling');},prevAll:function prevAll(elem){return dir(elem,'previousSibling');},nextUntil:function nextUntil(elem,i,until){return dir(elem,'nextSibling',until);},prevUntil:function prevUntil(elem,i,until){return dir(elem,'previousSibling',until);},siblings:function siblings(elem){return _siblings((elem.parentNode||{}).firstChild,elem);},children:function children(elem){return _siblings(elem.firstChild);},contents:function contents(elem){return nodeName(elem,'iframe')?elem.contentDocument:(nodeName(elem,'template')&&(elem=elem.content||elem),jQuery.merge([],elem.childNodes));}},function(name,fn){jQuery.fn[name]=function(until,selector){var matched=jQuery.map(this,fn,until);return name.slice(-5)!=='Until'&&(selector=until),selector&&typeof selector==='string'&&(matched=jQuery.filter(selector,matched)),this.length>1&&(guaranteedUnique[name]||jQuery.uniqueSort(matched),rparentsprev.test(name)&&matched.reverse()),this.pushStack(matched);};});var rnothtmlwhite=/[^\x20\t\r\n\f]+/g;jQuery.Callbacks=function(options){options=typeof options==='string'?createOptions(options):jQuery.extend({},options);var firing,memory,_fired,_locked,list=[],queue=[],firingIndex=-1,fire=function fire(){for(_locked=_locked||options.once,_fired=firing=!0;queue.length;firingIndex=-1){memory=queue.shift();while(++firingIndex<list.length)list[firingIndex].apply(memory[0],memory[1])===!1&&options.stopOnFalse&&(firingIndex=list.length,memory=!1);}options.memory||(memory=!1),firing=!1,_locked&&(memory?list=[]:list='');},self={add:function add(){return list&&(memory&&!firing&&(firingIndex=list.length-1,queue.push(memory)),function add(args){jQuery.each(args,function(_,arg){isFunction(arg)?options.unique&&self.has(arg)||list.push(arg):arg&&arg.length&&toType(arg)!=='string'&&add(arg);});}(arguments),memory&&!firing&&fire()),this;},remove:function remove(){return jQuery.each(arguments,function(_,arg){var index;while((index=jQuery.inArray(arg,list,index))>-1)list.splice(index,1),index<=firingIndex&&firingIndex--;}),this;},has:function has(fn){return fn?jQuery.inArray(fn,list)>-1:list.length>0;},empty:function empty(){return list&&(list=[]),this;},disable:function disable(){return _locked=queue=[],list=memory='',this;},disabled:function disabled(){return!list;},lock:function lock(){return _locked=queue=[],memory||firing||(list=memory=''),this;},locked:function locked(){return!!_locked;},fireWith:function fireWith(context,args){return _locked||(args=args||[],args=[context,args.slice?args.slice():args],queue.push(args),firing||fire()),this;},fire:function fire(){return self.fireWith(this,arguments),this;},fired:function fired(){return!!_fired;}};return self;},jQuery.extend({Deferred:function Deferred(func){var tuples=[['notify','progress',jQuery.Callbacks('memory'),jQuery.Callbacks('memory'),2],['resolve','done',jQuery.Callbacks('once memory'),jQuery.Callbacks('once memory'),0,'resolved'],['reject','fail',jQuery.Callbacks('once memory'),jQuery.Callbacks('once memory'),1,'rejected']],_state='pending',_promise={state:function state(){return _state;},always:function always(){return deferred.done(arguments).fail(arguments),this;},'catch':function _catch(fn){return _promise.then(null,fn);},pipe:function pipe(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=isFunction(fns[tuple[4]])&&fns[tuple[4]];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);returned&&isFunction(returned.promise)?returned.promise().progress(newDefer.notify).done(newDefer.resolve).fail(newDefer.reject):newDefer[tuple[0]+'With'](this,fn?[returned]:arguments);});}),fns=null;}).promise();},then:function then(onFulfilled,onRejected,onProgress){function resolve(depth,deferred,handler,special){return function(){var that=this,args=arguments,mightThrow=function mightThrow(){var returned,then;if(depth<maxDepth)return;if(returned=handler.apply(that,args),returned===deferred.promise())throw new TypeError('Thenable self-resolution');then=returned&&((returned===void 0?'undefined':_typeof(returned))==='object'||typeof returned==='function')&&returned.then,isFunction(then)?special?then.call(returned,resolve(maxDepth,deferred,Identity,special),resolve(maxDepth,deferred,Thrower,special)):(maxDepth++,then.call(returned,resolve(maxDepth,deferred,Identity,special),resolve(maxDepth,deferred,Thrower,special),resolve(maxDepth,deferred,Identity,deferred.notifyWith))):(handler!==Identity&&(that=undefined,args=[returned]),(special||deferred.resolveWith)(that,args));},process=special?mightThrow:function(){try{mightThrow();}catch(e){if(jQuery.Deferred.exceptionHook){jQuery.Deferred.exceptionHook(e,process.stackTrace);}if(depth+1>=maxDepth){if(handler!==Thrower){that=undefined;args=[e];}deferred.rejectWith(that,args);}}};depth?process():(jQuery.Deferred.getStackHook&&(process.stackTrace=jQuery.Deferred.getStackHook()),window.setTimeout(process));};}var maxDepth=0;return jQuery.Deferred(function(newDefer){tuples[0][3].add(resolve(0,newDefer,isFunction(onProgress)?onProgress:Identity,newDefer.notifyWith)),tuples[1][3].add(resolve(0,newDefer,isFunction(onFulfilled)?onFulfilled:Identity)),tuples[2][3].add(resolve(0,newDefer,isFunction(onRejected)?onRejected:Thrower));}).promise();},promise:function promise(obj){return obj!=null?jQuery.extend(obj,_promise):_promise;}},deferred={};return jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[5];_promise[tuple[1]]=list.add,stateString&&list.add(function(){_state=stateString;},tuples[3-i][2].disable,tuples[3-i][3].disable,tuples[0][2].lock,tuples[0][3].lock),list.add(tuple[3].fire),deferred[tuple[0]]=function(){return deferred[tuple[0]+'With'](this===deferred?undefined:this,arguments),this;},deferred[tuple[0]+'With']=list.fireWith;}),_promise.promise(deferred),func&&func.call(deferred,deferred),deferred;},when:function when(singleValue){var remaining=arguments.length,i=remaining,resolveContexts=Array(i),resolveValues=_slice.call(arguments),master=jQuery.Deferred(),updateFunc=function updateFunc(i){return function(value){resolveContexts[i]=this,resolveValues[i]=arguments.length>1?_slice.call(arguments):value,--remaining||master.resolveWith(resolveContexts,resolveValues);};};if(remaining<=1&&(adoptValue(singleValue,master.done(updateFunc(i)).resolve,master.reject,!remaining),master.state()==='pending'||isFunction(resolveValues[i]&&resolveValues[i].then)))return master.then();while(i--)adoptValue(resolveValues[i],updateFunc(i),master.reject);return master.promise();}});var rerrorNames=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;jQuery.Deferred.exceptionHook=function(error,stack){window.console&&window.console.warn&&error&&rerrorNames.test(error.name)&&window.console.warn('jQuery.Deferred exception: '+error.message,error.stack,stack);},jQuery.readyException=function(error){window.setTimeout(function(){throw error;});};var readyList=jQuery.Deferred();jQuery.fn.ready=function(fn){return readyList.then(fn).catch(function(error){jQuery.readyException(error);}),this;},jQuery.extend({isReady:!1,readyWait:1,ready:function ready(wait){if(wait===!0?--jQuery.readyWait:jQuery.isReady)return;if(jQuery.isReady=!0,wait!==!0&&--jQuery.readyWait>0)return;readyList.resolveWith(document,[jQuery]);}}),jQuery.ready.then=readyList.then,document.readyState==='complete'||document.readyState!=='loading'&&!document.documentElement.doScroll?window.setTimeout(jQuery.ready):(document.addEventListener('DOMContentLoaded',completed),window.addEventListener('load',completed));var access=function access(elems,fn,key,value,chainable,emptyGet,raw){var i=0,len=elems.length,bulk=key==null;if(toType(key)==='object'){chainable=!0;for(i in key)access(elems,fn,i,key[i],!0,emptyGet,raw);}else if(value!==undefined&&(chainable=!0,isFunction(value)||(raw=!0),bulk&&(raw?(fn.call(elems,value),fn=null):(bulk=fn,fn=function fn(elem,key,value){return bulk.call(jQuery(elem),value);})),fn))for(;i<len;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));return chainable?elems:bulk?fn.call(elems):len?fn(elems[0],key):emptyGet;};var rmsPrefix=/^-ms-/,rdashAlpha=/-([a-z])/g;var acceptData=function acceptData(owner){return owner.nodeType===1||owner.nodeType===9||!+owner.nodeType;};Data.uid=1,Data.prototype={cache:function cache(owner){var value=owner[this.expando];return value||(value={},acceptData(owner)&&(owner.nodeType?owner[this.expando]=value:Object.defineProperty(owner,this.expando,{value:value,configurable:!0}))),value;},set:function set(owner,data,value){var prop,cache=this.cache(owner);if(typeof data==='string')cache[camelCase(data)]=value;else for(prop in data)cache[camelCase(prop)]=data[prop];return cache;},get:function get(owner,key){return key===undefined?this.cache(owner):owner[this.expando]&&owner[this.expando][camelCase(key)];},access:function access(owner,key,value){return key===undefined||key&&typeof key==='string'&&value===undefined?this.get(owner,key):(this.set(owner,key,value),value!==undefined?value:key);},remove:function remove(owner,key){var i,cache=owner[this.expando];if(cache===undefined)return;if(key!==undefined){Array.isArray(key)?key=key.map(camelCase):(key=camelCase(key),key=key in cache?[key]:key.match(rnothtmlwhite)||[]),i=key.length;while(i--)delete cache[key[i]];}(key===undefined||jQuery.isEmptyObject(cache))&&(owner.nodeType?owner[this.expando]=undefined:delete owner[this.expando]);},hasData:function hasData(owner){var cache=owner[this.expando];return cache!==undefined&&!jQuery.isEmptyObject(cache);}};var dataPriv=new Data();var dataUser=new Data();var rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/[A-Z]/g;jQuery.extend({hasData:function hasData(elem){return dataUser.hasData(elem)||dataPriv.hasData(elem);},data:function data(elem,name,_data){return dataUser.access(elem,name,_data);},removeData:function removeData(elem,name){dataUser.remove(elem,name);},_data:function _data(elem,name,data){return dataPriv.access(elem,name,data);},_removeData:function _removeData(elem,name){dataPriv.remove(elem,name);}}),jQuery.fn.extend({data:function data(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(key===undefined){if(this.length&&(data=dataUser.get(elem),elem.nodeType===1&&!dataPriv.get(elem,'hasDataAttrs'))){i=attrs.length;while(i--)attrs[i]&&(name=attrs[i].name,name.indexOf('data-')===0&&(name=camelCase(name.slice(5)),dataAttr(elem,name,data[name])));dataPriv.set(elem,'hasDataAttrs',!0);}return data;}return(key===void 0?'undefined':_typeof(key))==='object'?this.each(function(){dataUser.set(this,key);}):access(this,function(value){var data;if(elem&&value===undefined)return data=dataUser.get(elem,key),data!==undefined?data:(data=dataAttr(elem,key),data!==undefined?data:void 0);this.each(function(){dataUser.set(this,key,value);});},null,value,arguments.length>1,null,!0);},removeData:function removeData(key){return this.each(function(){dataUser.remove(this,key);});}}),jQuery.extend({queue:function queue(elem,type,data){var queue;return elem?(type=(type||'fx')+'queue',queue=dataPriv.get(elem,type),data&&(!queue||Array.isArray(data)?queue=dataPriv.access(elem,type,jQuery.makeArray(data)):queue.push(data)),queue||[]):void 0;},dequeue:function dequeue(elem,type){type=type||'fx';var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function next(){jQuery.dequeue(elem,type);};fn==='inprogress'&&(fn=queue.shift(),startLength--),fn&&(type==='fx'&&queue.unshift('inprogress'),delete hooks.stop,fn.call(elem,next,hooks)),!startLength&&hooks&&hooks.empty.fire();},_queueHooks:function _queueHooks(elem,type){var key=type+'queueHooks';return dataPriv.get(elem,key)||dataPriv.access(elem,key,{empty:jQuery.Callbacks('once memory').add(function(){dataPriv.remove(elem,[type+'queue',key]);})});}}),jQuery.fn.extend({queue:function queue(type,data){var setter=2;return typeof type!=='string'&&(data=type,type='fx',setter--),arguments.length<setter?jQuery.queue(this[0],type):data===undefined?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type),type==='fx'&&queue[0]!=='inprogress'&&jQuery.dequeue(this,type);});},dequeue:function dequeue(type){return this.each(function(){jQuery.dequeue(this,type);});},clearQueue:function clearQueue(type){return this.queue(type||'fx',[]);},promise:function promise(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function resolve(){--count||defer.resolveWith(elements,[elements]);};typeof type!=='string'&&(obj=type,type=undefined),type=type||'fx';while(i--)tmp=dataPriv.get(elements[i],type+'queueHooks'),tmp&&tmp.empty&&(count++,tmp.empty.add(resolve));return resolve(),defer.promise(obj);}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source;var rcssNum=new RegExp('^(?:([+-])=|)('+pnum+')([a-z%]*)$','i');var cssExpand=['Top','Right','Bottom','Left'];var isHiddenWithinTree=function isHiddenWithinTree(elem,el){return elem=el||elem,elem.style.display==='none'||elem.style.display===''&&jQuery.contains(elem.ownerDocument,elem)&&jQuery.css(elem,'display')==='none';};var swap=function swap(elem,options,callback,args){var ret,name,old={};for(name in options)old[name]=elem.style[name],elem.style[name]=options[name];ret=callback.apply(elem,args||[]);for(name in options)elem.style[name]=old[name];return ret;};var defaultDisplayMap={};jQuery.fn.extend({show:function show(){return showHide(this,!0);},hide:function hide(){return showHide(this);},toggle:function toggle(state){return typeof state==='boolean'?state?this.show():this.hide():this.each(function(){isHiddenWithinTree(this)?jQuery(this).show():jQuery(this).hide();});}});var rcheckableType=/^(?:checkbox|radio)$/i;var rtagName=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i;var rscriptType=/^$|^module$|\/(?:java|ecma)script/i;var wrapMap={option:[1,"<select multiple='multiple'>",'</select>'],thead:[1,'<table>','</table>'],col:[2,'<table><colgroup>','</colgroup></table>'],tr:[2,'<table><tbody>','</tbody></table>'],td:[3,'<table><tbody><tr>','</tr></tbody></table>'],_default:[0,'','']};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td;var rhtml=/<|&#?\w+;/;(function(fragment,div,input){fragment=document.createDocumentFragment(),div=fragment.appendChild(document.createElement('div')),input=document.createElement('input'),input.setAttribute('type','radio'),input.setAttribute('checked','checked'),input.setAttribute('name','t'),div.appendChild(input),support.checkClone=div.cloneNode(!0).cloneNode(!0).lastChild.checked,div.innerHTML='<textarea>x</textarea>',support.noCloneChecked=!!div.cloneNode(!0).lastChild.defaultValue;}());var documentElement=document.documentElement;var rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,rtypenamespace=/^([^.]*)(?:\.(.+)|)/;jQuery.event={global:{},add:function add(elem,types,handler,data,selector){var handleObjIn,eventHandle,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.get(elem);if(!elemData)return;handler.handler&&(handleObjIn=handler,handler=handleObjIn.handler,selector=handleObjIn.selector),selector&&jQuery.find.matchesSelector(documentElement,selector),handler.guid||(handler.guid=jQuery.guid++),(events=elemData.events)||(events=elemData.events={}),(eventHandle=elemData.handle)||(eventHandle=elemData.handle=function(e){return jQuery!==void 0&&jQuery.event.triggered!==e.type?jQuery.event.dispatch.apply(elem,arguments):undefined;}),types=(types||'').match(rnothtmlwhite)||[''],t=types.length;while(t--){if(tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||'').split('.').sort(),!type)continue;special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,special=jQuery.event.special[type]||{},handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join('.')},handleObjIn),(handlers=events[type])||(handlers=events[type]=[],handlers.delegateCount=0,(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===!1)&&elem.addEventListener&&elem.addEventListener(type,eventHandle)),special.add&&(special.add.call(elem,handleObj),handleObj.handler.guid||(handleObj.handler.guid=handler.guid)),selector?handlers.splice(handlers.delegateCount++,0,handleObj):handlers.push(handleObj),jQuery.event.global[type]=!0;}},remove:function remove(elem,types,handler,selector,mappedTypes){var j,origCount,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.hasData(elem)&&dataPriv.get(elem);if(!(elemData&&(events=elemData.events)))return;types=(types||'').match(rnothtmlwhite)||[''],t=types.length;while(t--){if(tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||'').split('.').sort(),!type){for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,!0);continue;}special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,handlers=events[type]||[],tmp=tmp[2]&&new RegExp('(^|\\.)'+namespaces.join('\\.(?:.*\\.|)')+'(\\.|$)'),origCount=j=handlers.length;while(j--)handleObj=handlers[j],(mappedTypes||origType===handleObj.origType)&&(!handler||handler.guid===handleObj.guid)&&(!tmp||tmp.test(handleObj.namespace))&&(!selector||selector===handleObj.selector||selector==='**'&&handleObj.selector)&&(handlers.splice(j,1),handleObj.selector&&handlers.delegateCount--,special.remove&&special.remove.call(elem,handleObj));origCount&&!handlers.length&&((!special.teardown||special.teardown.call(elem,namespaces,elemData.handle)===!1)&&jQuery.removeEvent(elem,type,elemData.handle),delete events[type]);}jQuery.isEmptyObject(events)&&dataPriv.remove(elem,'handle events');},dispatch:function dispatch(nativeEvent){var event=jQuery.event.fix(nativeEvent);var i,j,ret,matched,handleObj,handlerQueue,args=new Array(arguments.length),handlers=(dataPriv.get(this,'events')||{})[event.type]||[],special=jQuery.event.special[event.type]||{};for(args[0]=event,i=1;i<arguments.length;i++)args[i]=arguments[i];if(event.delegateTarget=this,special.preDispatch&&special.preDispatch.call(this,event)===!1)return;handlerQueue=jQuery.event.handlers.call(this,event,handlers),i=0;while((matched=handlerQueue[i++])&&!event.isPropagationStopped()){event.currentTarget=matched.elem,j=0;while((handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped())(!event.rnamespace||event.rnamespace.test(handleObj.namespace))&&(event.handleObj=handleObj,event.data=handleObj.data,ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args),ret!==undefined&&(event.result=ret)===!1&&(event.preventDefault(),event.stopPropagation()));}return special.postDispatch&&special.postDispatch.call(this,event),event.result;},handlers:function handlers(event,_handlers){var i,handleObj,sel,matchedHandlers,matchedSelectors,handlerQueue=[],delegateCount=_handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&!(event.type==='click'&&event.button>=1))for(;cur!==this;cur=cur.parentNode||this)if(cur.nodeType===1&&!(event.type==='click'&&cur.disabled===!0)){for(matchedHandlers=[],matchedSelectors={},i=0;i<delegateCount;i++)handleObj=_handlers[i],sel=handleObj.selector+' ',matchedSelectors[sel]===undefined&&(matchedSelectors[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>-1:jQuery.find(sel,this,null,[cur]).length),matchedSelectors[sel]&&matchedHandlers.push(handleObj);matchedHandlers.length&&handlerQueue.push({elem:cur,handlers:matchedHandlers});}return cur=this,delegateCount<_handlers.length&&handlerQueue.push({elem:cur,handlers:_handlers.slice(delegateCount)}),handlerQueue;},addProp:function addProp(name,hook){Object.defineProperty(jQuery.Event.prototype,name,{enumerable:!0,configurable:!0,get:isFunction(hook)?function(){return this.originalEvent?hook(this.originalEvent):void 0;}:function(){return this.originalEvent?this.originalEvent[name]:void 0;},set:function set(value){Object.defineProperty(this,name,{enumerable:!0,configurable:!0,writable:!0,value:value});}});},fix:function fix(originalEvent){return originalEvent[jQuery.expando]?originalEvent:new jQuery.Event(originalEvent);},special:{load:{noBubble:!0},focus:{trigger:function trigger(){return this!==safeActiveElement()&&this.focus?(this.focus(),!1):void 0;},delegateType:'focusin'},blur:{trigger:function trigger(){return this===safeActiveElement()&&this.blur?(this.blur(),!1):void 0;},delegateType:'focusout'},click:{trigger:function trigger(){return this.type==='checkbox'&&this.click&&nodeName(this,'input')?(this.click(),!1):void 0;},_default:function _default(event){return nodeName(event.target,'a');}},beforeunload:{postDispatch:function postDispatch(event){event.result!==undefined&&event.originalEvent&&(event.originalEvent.returnValue=event.result);}}}},jQuery.removeEvent=function(elem,type,handle){elem.removeEventListener&&elem.removeEventListener(type,handle);},jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event))return new jQuery.Event(src,props);src&&src.type?(this.originalEvent=src,this.type=src.type,this.isDefaultPrevented=src.defaultPrevented||src.defaultPrevented===undefined&&src.returnValue===!1?returnTrue:returnFalse,this.target=src.target&&src.target.nodeType===3?src.target.parentNode:src.target,this.currentTarget=src.currentTarget,this.relatedTarget=src.relatedTarget):this.type=src,props&&jQuery.extend(this,props),this.timeStamp=src&&src.timeStamp||Date.now(),this[jQuery.expando]=!0;},jQuery.Event.prototype={constructor:jQuery.Event,isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,isSimulated:!1,preventDefault:function preventDefault(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&!this.isSimulated&&e.preventDefault();},stopPropagation:function stopPropagation(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&!this.isSimulated&&e.stopPropagation();},stopImmediatePropagation:function stopImmediatePropagation(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation();}},jQuery.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function which(event){var button=event.button;return event.which==null&&rkeyEvent.test(event.type)?event.charCode!=null?event.charCode:event.keyCode:!event.which&&button!==undefined&&rmouseEvent.test(event.type)?button&1?1:button&2?3:button&4?2:0:event.which;}},jQuery.event.addProp),jQuery.each({mouseenter:'mouseover',mouseleave:'mouseout',pointerenter:'pointerover',pointerleave:'pointerout'},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function handle(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;return(!related||related!==target&&!jQuery.contains(target,related))&&(event.type=handleObj.origType,ret=handleObj.handler.apply(this,arguments),event.type=fix),ret;}};}),jQuery.fn.extend({on:function on(types,selector,data,fn){return _on(this,types,selector,data,fn);},one:function one(types,selector,data,fn){return _on(this,types,selector,data,fn,1);},off:function off(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj)return handleObj=types.handleObj,jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+'.'+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler),this;if((types===void 0?'undefined':_typeof(types))==='object'){for(type in types)this.off(type,selector,types[type]);return this;}return(selector===!1||typeof selector==='function')&&(fn=selector,selector=undefined),fn===!1&&(fn=returnFalse),this.each(function(){jQuery.event.remove(this,types,fn,selector);});}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,rnoInnerhtml=/<script|<style|<link/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;jQuery.extend({htmlPrefilter:function htmlPrefilter(html){return html.replace(rxhtmlTag,'<$1></$2>');},clone:function clone(elem,dataAndEvents,deepDataAndEvents){var i,l,srcElements,destElements,clone=elem.cloneNode(!0),inPage=jQuery.contains(elem.ownerDocument,elem);if(!support.noCloneChecked&&(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem))for(destElements=getAll(clone),srcElements=getAll(elem),i=0,l=srcElements.length;i<l;i++)fixInput(srcElements[i],destElements[i]);if(dataAndEvents)if(deepDataAndEvents)for(srcElements=srcElements||getAll(elem),destElements=destElements||getAll(clone),i=0,l=srcElements.length;i<l;i++)cloneCopyEvent(srcElements[i],destElements[i]);else cloneCopyEvent(elem,clone);return destElements=getAll(clone,'script'),destElements.length>0&&setGlobalEval(destElements,!inPage&&getAll(elem,'script')),clone;},cleanData:function cleanData(elems){var data,elem,type,special=jQuery.event.special,i=0;for(;(elem=elems[i])!==undefined;i++)if(acceptData(elem)){if(data=elem[dataPriv.expando]){if(data.events)for(type in data.events)special[type]?jQuery.event.remove(elem,type):jQuery.removeEvent(elem,type,data.handle);elem[dataPriv.expando]=undefined;}elem[dataUser.expando]&&(elem[dataUser.expando]=undefined);}}}),jQuery.fn.extend({detach:function detach(selector){return _remove(this,selector,!0);},remove:function remove(selector){return _remove(this,selector);},text:function text(value){return access(this,function(value){return value===undefined?jQuery.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=value);});},null,value,arguments.length);},append:function append(){return domManip(this,arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.appendChild(elem);}});},prepend:function prepend(){return domManip(this,arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild);}});},before:function before(){return domManip(this,arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this);});},after:function after(){return domManip(this,arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this.nextSibling);});},empty:function empty(){var elem,i=0;for(;(elem=this[i])!=null;i++)elem.nodeType===1&&(jQuery.cleanData(getAll(elem,!1)),elem.textContent='');return this;},clone:function clone(dataAndEvents,deepDataAndEvents){return dataAndEvents=dataAndEvents==null?!1:dataAndEvents,deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents,this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents);});},html:function html(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(value===undefined&&elem.nodeType===1)return elem.innerHTML;if(typeof value==='string'&&!rnoInnerhtml.test(value)&&!wrapMap[(rtagName.exec(value)||['',''])[1].toLowerCase()]){value=jQuery.htmlPrefilter(value);try{for(;i<l;i++)elem=this[i]||{},elem.nodeType===1&&(jQuery.cleanData(getAll(elem,!1)),elem.innerHTML=value);elem=0;}catch(e){}}elem&&this.empty().append(value);},null,value,arguments.length);},replaceWith:function replaceWith(){var ignored=[];return domManip(this,arguments,function(elem){var parent=this.parentNode;jQuery.inArray(this,ignored)<0&&(jQuery.cleanData(getAll(this)),parent&&parent.replaceChild(elem,this));},ignored);}}),jQuery.each({appendTo:'append',prependTo:'prepend',insertBefore:'before',insertAfter:'after',replaceAll:'replaceWith'},function(name,original){jQuery.fn[name]=function(selector){var elems,ret=[],insert=jQuery(selector),last=insert.length-1,i=0;for(;i<=last;i++)elems=i===last?this:this.clone(!0),jQuery(insert[i])[original](elems),push.apply(ret,elems.get());return this.pushStack(ret);};});var rnumnonpx=new RegExp('^('+pnum+')(?!px)[a-z%]+$','i');var getStyles=function getStyles(elem){var view=elem.ownerDocument.defaultView;return view&&view.opener||(view=window),view.getComputedStyle(elem);};var rboxStyle=new RegExp(cssExpand.join('|'),'i');(function(pixelPositionVal,boxSizingReliableVal,scrollboxSizeVal,pixelBoxStylesVal,reliableMarginLeftVal,container,div){function computeStyleTests(){if(!div)return;container.style.cssText='position:absolute;left:-11111px;width:60px;'+'margin-top:1px;padding:0;border:0',div.style.cssText='position:relative;display:block;box-sizing:border-box;overflow:scroll;'+'margin:auto;border:1px;padding:1px;'+'width:60%;top:1%',documentElement.appendChild(container).appendChild(div);var divStyle=window.getComputedStyle(div);pixelPositionVal=divStyle.top!=='1%',reliableMarginLeftVal=roundPixelMeasures(divStyle.marginLeft)===12,div.style.right='60%',pixelBoxStylesVal=roundPixelMeasures(divStyle.right)===36,boxSizingReliableVal=roundPixelMeasures(divStyle.width)===36,div.style.position='absolute',scrollboxSizeVal=div.offsetWidth===36||'absolute',documentElement.removeChild(container),div=null;}function roundPixelMeasures(measure){return Math.round(parseFloat(measure));}if(container=document.createElement('div'),div=document.createElement('div'),!div.style)return;div.style.backgroundClip='content-box',div.cloneNode(!0).style.backgroundClip='',support.clearCloneStyle=div.style.backgroundClip==='content-box',jQuery.extend(support,{boxSizingReliable:function boxSizingReliable(){return computeStyleTests(),boxSizingReliableVal;},pixelBoxStyles:function pixelBoxStyles(){return computeStyleTests(),pixelBoxStylesVal;},pixelPosition:function pixelPosition(){return computeStyleTests(),pixelPositionVal;},reliableMarginLeft:function reliableMarginLeft(){return computeStyleTests(),reliableMarginLeftVal;},scrollboxSize:function scrollboxSize(){return computeStyleTests(),scrollboxSizeVal;}});}());var rdisplayswap=/^(none|table(?!-c[ea]).+)/,rcustomProp=/^--/,cssShow={position:'absolute',visibility:'hidden',display:'block'},cssNormalTransform={letterSpacing:'0',fontWeight:'400'},cssPrefixes=['Webkit','Moz','ms'],emptyStyle=document.createElement('div').style;jQuery.extend({cssHooks:{opacity:{get:function get(elem,computed){if(computed){var ret=curCSS(elem,'opacity');return ret===''?'1':ret;}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function style(elem,name,value,extra){if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style)return;var ret,type,hooks,origName=camelCase(name),isCustomProp=rcustomProp.test(name),style=elem.style;if(isCustomProp||(name=finalPropName(origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],value!==undefined){if(type=value===void 0?'undefined':_typeof(value),type==='string'&&(ret=rcssNum.exec(value))&&ret[1]&&(value=adjustCSS(elem,name,ret),type='number'),value==null||value!==value)return;type==='number'&&(value+=ret&&ret[3]||(jQuery.cssNumber[origName]?'':'px')),!support.clearCloneStyle&&value===''&&name.indexOf('background')===0&&(style[name]='inherit'),(!(hooks&&'set'in hooks)||(value=hooks.set(elem,value,extra))!==undefined)&&(isCustomProp?style.setProperty(name,value):style[name]=value);}else return hooks&&'get'in hooks&&(ret=hooks.get(elem,!1,extra))!==undefined?ret:style[name];},css:function css(elem,name,extra,styles){var val,num,hooks,origName=camelCase(name),isCustomProp=rcustomProp.test(name);return isCustomProp||(name=finalPropName(origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],hooks&&'get'in hooks&&(val=hooks.get(elem,!0,extra)),val===undefined&&(val=curCSS(elem,name,styles)),val==='normal'&&name in cssNormalTransform&&(val=cssNormalTransform[name]),extra===''||extra?(num=parseFloat(val),extra===!0||isFinite(num)?num||0:val):val;}}),jQuery.each(['height','width'],function(i,dimension){jQuery.cssHooks[dimension]={get:function get(elem,computed,extra){return computed?rdisplayswap.test(jQuery.css(elem,'display'))&&!(elem.getClientRects().length&&elem.getBoundingClientRect().width)?swap(elem,cssShow,function(){return getWidthOrHeight(elem,dimension,extra);}):getWidthOrHeight(elem,dimension,extra):void 0;},set:function set(elem,value,extra){var matches,styles=getStyles(elem),isBorderBox=jQuery.css(elem,'boxSizing',!1,styles)==='border-box',subtract=extra&&boxModelAdjustment(elem,dimension,extra,isBorderBox,styles);return isBorderBox&&support.scrollboxSize()===styles.position&&(subtract-=Math.ceil(elem['offset'+dimension[0].toUpperCase()+dimension.slice(1)]-parseFloat(styles[dimension])-boxModelAdjustment(elem,dimension,'border',!1,styles)-0.5)),subtract&&(matches=rcssNum.exec(value))&&(matches[3]||'px')!=='px'&&(elem.style[dimension]=value,value=jQuery.css(elem,dimension)),setPositiveNumber(elem,value,subtract);}};}),jQuery.cssHooks.marginLeft=addGetHookIf(support.reliableMarginLeft,function(elem,computed){return computed?(parseFloat(curCSS(elem,'marginLeft'))||elem.getBoundingClientRect().left-swap(elem,{marginLeft:0},function(){return elem.getBoundingClientRect().left;}))+'px':void 0;}),jQuery.each({margin:'',padding:'',border:'Width'},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function expand(value){var i=0,expanded={},parts=typeof value==='string'?value.split(' '):[value];for(;i<4;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded;}},prefix!=='margin'&&(jQuery.cssHooks[prefix+suffix].set=setPositiveNumber);}),jQuery.fn.extend({css:function css(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(Array.isArray(name)){for(styles=getStyles(elem),len=name.length;i<len;i++)map[name[i]]=jQuery.css(elem,name[i],!1,styles);return map;}return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name);},name,value,arguments.length>1);}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function init(elem,options,prop,end,easing,unit){this.elem=elem,this.prop=prop,this.easing=easing||jQuery.easing._default,this.options=options,this.start=this.now=this.cur(),this.end=end,this.unit=unit||(jQuery.cssNumber[prop]?'':'px');},cur:function cur(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this);},run:function run(percent){var eased,hooks=Tween.propHooks[this.prop];return this.options.duration?this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration):this.pos=eased=percent,this.now=(this.end-this.start)*eased+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),hooks&&hooks.set?hooks.set(this):Tween.propHooks._default.set(this),this;}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function get(tween){var result;return tween.elem.nodeType!==1||tween.elem[tween.prop]!=null&&tween.elem.style[tween.prop]==null?tween.elem[tween.prop]:(result=jQuery.css(tween.elem,tween.prop,''),!result||result==='auto'?0:result);},set:function set(tween){jQuery.fx.step[tween.prop]?jQuery.fx.step[tween.prop](tween):tween.elem.nodeType===1&&(tween.elem.style[jQuery.cssProps[tween.prop]]!=null||jQuery.cssHooks[tween.prop])?jQuery.style(tween.elem,tween.prop,tween.now+tween.unit):tween.elem[tween.prop]=tween.now;}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function set(tween){tween.elem.nodeType&&tween.elem.parentNode&&(tween.elem[tween.prop]=tween.now);}},jQuery.easing={linear:function linear(p){return p;},swing:function swing(p){return 0.5-Math.cos(p*Math.PI)/2;},_default:'swing'},jQuery.fx=Tween.prototype.init,jQuery.fx.step={};var fxNow,inProgress,rfxtypes=/^(?:toggle|show|hide)$/,rrun=/queueHooks$/;jQuery.Animation=jQuery.extend(Animation,{tweeners:{'*':[function(prop,value){var tween=this.createTween(prop,value);return adjustCSS(tween.elem,prop,rcssNum.exec(value),tween),tween;}]},tweener:function tweener(props,callback){isFunction(props)?(callback=props,props=['*']):props=props.match(rnothtmlwhite);var prop,index=0,length=props.length;for(;index<length;index++)prop=props[index],Animation.tweeners[prop]=Animation.tweeners[prop]||[],Animation.tweeners[prop].unshift(callback);},prefilters:[defaultPrefilter],prefilter:function prefilter(callback,prepend){prepend?Animation.prefilters.unshift(callback):Animation.prefilters.push(callback);}}),jQuery.speed=function(speed,easing,fn){var opt=speed&&(speed===void 0?'undefined':_typeof(speed))==='object'?jQuery.extend({},speed):{complete:fn||!fn&&easing||isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!isFunction(easing)&&easing};return jQuery.fx.off?opt.duration=0:typeof opt.duration!=='number'&&(opt.duration in jQuery.fx.speeds?opt.duration=jQuery.fx.speeds[opt.duration]:opt.duration=jQuery.fx.speeds._default),(opt.queue==null||opt.queue===!0)&&(opt.queue='fx'),opt.old=opt.complete,opt.complete=function(){isFunction(opt.old)&&opt.old.call(this),opt.queue&&jQuery.dequeue(this,opt.queue);},opt;},jQuery.fn.extend({fadeTo:function fadeTo(speed,to,easing,callback){return this.filter(isHiddenWithinTree).css('opacity',0).show().end().animate({opacity:to},speed,easing,callback);},animate:function animate(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function doAnimation(){var anim=Animation(this,jQuery.extend({},prop),optall);(empty||dataPriv.get(this,'finish'))&&anim.stop(!0);};return doAnimation.finish=doAnimation,empty||optall.queue===!1?this.each(doAnimation):this.queue(optall.queue,doAnimation);},stop:function stop(type,clearQueue,gotoEnd){var stopQueue=function stopQueue(hooks){var stop=hooks.stop;delete hooks.stop,stop(gotoEnd);};return typeof type!=='string'&&(gotoEnd=clearQueue,clearQueue=type,type=undefined),clearQueue&&type!==!1&&this.queue(type||'fx',[]),this.each(function(){var dequeue=!0,index=type!=null&&type+'queueHooks',timers=jQuery.timers,data=dataPriv.get(this);if(index)data[index]&&data[index].stop&&stopQueue(data[index]);else for(index in data)data[index]&&data[index].stop&&rrun.test(index)&&stopQueue(data[index]);for(index=timers.length;index--;)timers[index].elem===this&&(type==null||timers[index].queue===type)&&(timers[index].anim.stop(gotoEnd),dequeue=!1,timers.splice(index,1));(dequeue||!gotoEnd)&&jQuery.dequeue(this,type);});},finish:function finish(type){return type!==!1&&(type=type||'fx'),this.each(function(){var index,data=dataPriv.get(this),queue=data[type+'queue'],hooks=data[type+'queueHooks'],timers=jQuery.timers,length=queue?queue.length:0;for(data.finish=!0,jQuery.queue(this,type,[]),hooks&&hooks.stop&&hooks.stop.call(this,!0),index=timers.length;index--;)timers[index].elem===this&&timers[index].queue===type&&(timers[index].anim.stop(!0),timers.splice(index,1));for(index=0;index<length;index++)queue[index]&&queue[index].finish&&queue[index].finish.call(this);delete data.finish;});}}),jQuery.each(['toggle','show','hide'],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return speed==null||typeof speed==='boolean'?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback);};}),jQuery.each({slideDown:genFx('show'),slideUp:genFx('hide'),slideToggle:genFx('toggle'),fadeIn:{opacity:'show'},fadeOut:{opacity:'hide'},fadeToggle:{opacity:'toggle'}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback);};}),jQuery.timers=[],jQuery.fx.tick=function(){var timer,i=0,timers=jQuery.timers;for(fxNow=Date.now();i<timers.length;i++)timer=timers[i],!timer()&&timers[i]===timer&&timers.splice(i--,1);timers.length||jQuery.fx.stop(),fxNow=undefined;},jQuery.fx.timer=function(timer){jQuery.timers.push(timer),jQuery.fx.start();},jQuery.fx.interval=13,jQuery.fx.start=function(){if(inProgress)return;inProgress=!0,schedule();},jQuery.fx.stop=function(){inProgress=null;},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fn.delay=function(time,type){return time=jQuery.fx?jQuery.fx.speeds[time]||time:time,type=type||'fx',this.queue(type,function(next,hooks){var timeout=window.setTimeout(next,time);hooks.stop=function(){window.clearTimeout(timeout);};});},function(input,select,opt){input=document.createElement('input'),select=document.createElement('select'),opt=select.appendChild(document.createElement('option')),input.type='checkbox',support.checkOn=input.value!=='',support.optSelected=opt.selected,input=document.createElement('input'),input.value='t',input.type='radio',support.radioValue=input.value==='t';}();var boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function attr(name,value){return access(this,jQuery.attr,name,value,arguments.length>1);},removeAttr:function removeAttr(name){return this.each(function(){jQuery.removeAttr(this,name);});}}),jQuery.extend({attr:function attr(elem,name,value){var ret,hooks,nType=elem.nodeType;if(nType===3||nType===8||nType===2)return;if(elem.getAttribute===void 0)return jQuery.prop(elem,name,value);if((nType!==1||!jQuery.isXMLDoc(elem))&&(hooks=jQuery.attrHooks[name.toLowerCase()]||(jQuery.expr.match.bool.test(name)?boolHook:undefined)),value!==undefined){if(value===null){jQuery.removeAttr(elem,name);return;}return hooks&&'set'in hooks&&(ret=hooks.set(elem,value,name))!==undefined?ret:(elem.setAttribute(name,value+''),value);}return hooks&&'get'in hooks&&(ret=hooks.get(elem,name))!==null?ret:(ret=jQuery.find.attr(elem,name),ret==null?undefined:ret);},attrHooks:{type:{set:function set(elem,value){if(!support.radioValue&&value==='radio'&&nodeName(elem,'input')){var val=elem.value;return elem.setAttribute('type',value),val&&(elem.value=val),value;}}}},removeAttr:function removeAttr(elem,value){var name,i=0,attrNames=value&&value.match(rnothtmlwhite);if(attrNames&&elem.nodeType===1)while(name=attrNames[i++])elem.removeAttribute(name);}}),boolHook={set:function set(elem,value,name){return value===!1?jQuery.removeAttr(elem,name):elem.setAttribute(name,name),name;}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=function(elem,name,isXML){var ret,handle,lowercaseName=name.toLowerCase();return isXML||(handle=attrHandle[lowercaseName],attrHandle[lowercaseName]=ret,ret=getter(elem,name,isXML)!=null?lowercaseName:null,attrHandle[lowercaseName]=handle),ret;};});var rfocusable=/^(?:input|select|textarea|button)$/i,rclickable=/^(?:a|area)$/i;jQuery.fn.extend({prop:function prop(name,value){return access(this,jQuery.prop,name,value,arguments.length>1);},removeProp:function removeProp(name){return this.each(function(){delete this[jQuery.propFix[name]||name];});}}),jQuery.extend({prop:function prop(elem,name,value){var ret,hooks,nType=elem.nodeType;return nType===3||nType===8||nType===2?void 0:((nType!==1||!jQuery.isXMLDoc(elem))&&(name=jQuery.propFix[name]||name,hooks=jQuery.propHooks[name]),value!==undefined?hooks&&'set'in hooks&&(ret=hooks.set(elem,value,name))!==undefined?ret:elem[name]=value:hooks&&'get'in hooks&&(ret=hooks.get(elem,name))!==null?ret:elem[name]);},propHooks:{tabIndex:{get:function get(elem){var tabindex=jQuery.find.attr(elem,'tabindex');return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1;}}},propFix:{'for':'htmlFor','class':'className'}}),support.optSelected||(jQuery.propHooks.selected={get:function get(elem){var parent=elem.parentNode;return parent&&parent.parentNode&&parent.parentNode.selectedIndex,null;},set:function set(elem){var parent=elem.parentNode;parent&&(parent.selectedIndex,parent.parentNode&&parent.parentNode.selectedIndex);}}),jQuery.each(['tabIndex','readOnly','maxLength','cellSpacing','cellPadding','rowSpan','colSpan','useMap','frameBorder','contentEditable'],function(){jQuery.propFix[this.toLowerCase()]=this;}),jQuery.fn.extend({addClass:function addClass(value){var classes,elem,cur,curValue,clazz,j,finalValue,i=0;if(isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,getClass(this)));});if(classes=classesToArray(value),classes.length)while(elem=this[i++])if(curValue=getClass(elem),cur=elem.nodeType===1&&' '+stripAndCollapse(curValue)+' ',cur){j=0;while(clazz=classes[j++])cur.indexOf(' '+clazz+' ')<0&&(cur+=clazz+' ');finalValue=stripAndCollapse(cur),curValue!==finalValue&&elem.setAttribute('class',finalValue);}return this;},removeClass:function removeClass(value){var classes,elem,cur,curValue,clazz,j,finalValue,i=0;if(isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,getClass(this)));});if(!arguments.length)return this.attr('class','');if(classes=classesToArray(value),classes.length)while(elem=this[i++])if(curValue=getClass(elem),cur=elem.nodeType===1&&' '+stripAndCollapse(curValue)+' ',cur){j=0;while(clazz=classes[j++])while(cur.indexOf(' '+clazz+' ')>-1)cur=cur.replace(' '+clazz+' ',' ');finalValue=stripAndCollapse(cur),curValue!==finalValue&&elem.setAttribute('class',finalValue);}return this;},toggleClass:function toggleClass(value,stateVal){var type=value===void 0?'undefined':_typeof(value),isValidValue=type==='string'||Array.isArray(value);return typeof stateVal==='boolean'&&isValidValue?stateVal?this.addClass(value):this.removeClass(value):isFunction(value)?this.each(function(i){jQuery(this).toggleClass(value.call(this,i,getClass(this),stateVal),stateVal);}):this.each(function(){var className,i,self,classNames;if(isValidValue){i=0,self=jQuery(this),classNames=classesToArray(value);while(className=classNames[i++])self.hasClass(className)?self.removeClass(className):self.addClass(className);}else(value===undefined||type==='boolean')&&(className=getClass(this),className&&dataPriv.set(this,'__className__',className),this.setAttribute&&this.setAttribute('class',className||value===!1?'':dataPriv.get(this,'__className__')||''));});},hasClass:function hasClass(selector){var className,elem,i=0;className=' '+selector+' ';while(elem=this[i++])if(elem.nodeType===1&&(' '+stripAndCollapse(getClass(elem))+' ').indexOf(className)>-1)return!0;return!1;}});var rreturn=/\r/g;jQuery.fn.extend({val:function val(value){var hooks,ret,valueIsFunction,elem=this[0];return arguments.length?(valueIsFunction=isFunction(value),this.each(function(i){var val;if(this.nodeType!==1)return;valueIsFunction?val=value.call(this,i,jQuery(this).val()):val=value,val==null?val='':typeof val==='number'?val+='':Array.isArray(val)&&(val=jQuery.map(val,function(value){return value==null?'':value+'';})),hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()],(!(hooks&&'set'in hooks)||hooks.set(this,val,'value')===undefined)&&(this.value=val);})):elem?(hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()],hooks&&'get'in hooks&&(ret=hooks.get(elem,'value'))!==undefined?ret:(ret=elem.value,typeof ret==='string'?ret.replace(rreturn,''):ret==null?'':ret)):void 0;}}),jQuery.extend({valHooks:{option:{get:function get(elem){var val=jQuery.find.attr(elem,'value');return val!=null?val:stripAndCollapse(jQuery.text(elem));}},select:{get:function get(elem){var value,option,i,options=elem.options,index=elem.selectedIndex,one=elem.type==='select-one',values=one?null:[],max=one?index+1:options.length;for(index<0?i=max:i=one?index:0;i<max;i++)if(option=options[i],(option.selected||i===index)&&!option.disabled&&!(option.parentNode.disabled&&nodeName(option.parentNode,'optgroup'))){if(value=jQuery(option).val(),one)return value;values.push(value);}return values;},set:function set(elem,value){var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;while(i--)option=options[i],(option.selected=jQuery.inArray(jQuery.valHooks.option.get(option),values)>-1)&&(optionSet=!0);return optionSet||(elem.selectedIndex=-1),values;}}}}),jQuery.each(['radio','checkbox'],function(){jQuery.valHooks[this]={set:function set(elem,value){return Array.isArray(value)?elem.checked=jQuery.inArray(jQuery(elem).val(),value)>-1:void 0;}},support.checkOn||(jQuery.valHooks[this].get=function(elem){return elem.getAttribute('value')===null?'on':elem.value;});}),support.focusin='onfocusin'in window;var rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,stopPropagationCallback=function stopPropagationCallback(e){e.stopPropagation();};jQuery.extend(jQuery.event,{trigger:function trigger(event,data,elem,onlyHandlers){var i,cur,tmp,bubbleType,ontype,handle,special,lastElement,eventPath=[elem||document],type=hasOwn.call(event,'type')?event.type:event,namespaces=hasOwn.call(event,'namespace')?event.namespace.split('.'):[];if(cur=lastElement=tmp=elem=elem||document,elem.nodeType===3||elem.nodeType===8)return;if(rfocusMorph.test(type+jQuery.event.triggered))return;if(type.indexOf('.')>-1&&(namespaces=type.split('.'),type=namespaces.shift(),namespaces.sort()),ontype=type.indexOf(':')<0&&'on'+type,event=event[jQuery.expando]?event:new jQuery.Event(type,(event===void 0?'undefined':_typeof(event))==='object'&&event),event.isTrigger=onlyHandlers?2:3,event.namespace=namespaces.join('.'),event.rnamespace=event.namespace?new RegExp('(^|\\.)'+namespaces.join('\\.(?:.*\\.|)')+'(\\.|$)'):null,event.result=undefined,event.target||(event.target=elem),data=data==null?[event]:jQuery.makeArray(data,[event]),special=jQuery.event.special[type]||{},!onlyHandlers&&special.trigger&&special.trigger.apply(elem,data)===!1)return;if(!(onlyHandlers||special.noBubble||isWindow(elem))){for(bubbleType=special.delegateType||type,rfocusMorph.test(bubbleType+type)||(cur=cur.parentNode);cur;cur=cur.parentNode)eventPath.push(cur),tmp=cur;tmp===(elem.ownerDocument||document)&&eventPath.push(tmp.defaultView||tmp.parentWindow||window);}i=0;while((cur=eventPath[i++])&&!event.isPropagationStopped())lastElement=cur,event.type=i>1?bubbleType:special.bindType||type,handle=(dataPriv.get(cur,'events')||{})[event.type]&&dataPriv.get(cur,'handle'),handle&&handle.apply(cur,data),handle=ontype&&cur[ontype],handle&&handle.apply&&acceptData(cur)&&(event.result=handle.apply(cur,data),event.result===!1&&event.preventDefault());return event.type=type,!(onlyHandlers||event.isDefaultPrevented())&&(!special._default||special._default.apply(eventPath.pop(),data)===!1)&&acceptData(elem)&&ontype&&isFunction(elem[type])&&!isWindow(elem)&&(tmp=elem[ontype],tmp&&(elem[ontype]=null),jQuery.event.triggered=type,event.isPropagationStopped()&&lastElement.addEventListener(type,stopPropagationCallback),elem[type](),event.isPropagationStopped()&&lastElement.removeEventListener(type,stopPropagationCallback),jQuery.event.triggered=undefined,tmp&&(elem[ontype]=tmp)),event.result;},simulate:function simulate(type,elem,event){var e=jQuery.extend(new jQuery.Event(),event,{type:type,isSimulated:!0});jQuery.event.trigger(e,null,elem);}}),jQuery.fn.extend({trigger:function trigger(type,data){return this.each(function(){jQuery.event.trigger(type,data,this);});},triggerHandler:function triggerHandler(type,data){var elem=this[0];return elem?jQuery.event.trigger(type,data,elem,!0):void 0;}}),support.focusin||jQuery.each({focus:'focusin',blur:'focusout'},function(orig,fix){var handler=function handler(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event));};jQuery.event.special[fix]={setup:function setup(){var doc=this.ownerDocument||this,attaches=dataPriv.access(doc,fix);attaches||doc.addEventListener(orig,handler,!0),dataPriv.access(doc,fix,(attaches||0)+1);},teardown:function teardown(){var doc=this.ownerDocument||this,attaches=dataPriv.access(doc,fix)-1;attaches?dataPriv.access(doc,fix,attaches):(doc.removeEventListener(orig,handler,!0),dataPriv.remove(doc,fix));}};});var location=window.location;var nonce=Date.now();var rquery=/\?/;jQuery.parseXML=function(data){var xml;if(!data||typeof data!=='string')return null;try{xml=new window.DOMParser().parseFromString(data,'text/xml');}catch(e){xml=undefined;}return(!xml||xml.getElementsByTagName('parsererror').length)&&jQuery.error('Invalid XML: '+data),xml;};var rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.param=function(a,traditional){var prefix,s=[],add=function add(key,valueOrFunction){var value=isFunction(valueOrFunction)?valueOrFunction():valueOrFunction;s[s.length]=encodeURIComponent(key)+'='+encodeURIComponent(value==null?'':value);};if(Array.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value);});else for(prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join('&');},jQuery.fn.extend({serialize:function serialize(){return jQuery.param(this.serializeArray());},serializeArray:function serializeArray(){return this.map(function(){var elements=jQuery.prop(this,'elements');return elements?jQuery.makeArray(elements):this;}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(':disabled')&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type));}).map(function(i,elem){var val=jQuery(this).val();return val==null?null:Array.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,'\r\n')};}):{name:elem.name,value:val.replace(rCRLF,'\r\n')};}).get();}});var r20=/%20/g,rhash=/#.*$/,rantiCache=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,prefilters={},transports={},allTypes='*/'.concat('*'),originAnchor=document.createElement('a');originAnchor.href=location.href,jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:location.href,type:'GET',isLocal:rlocalProtocol.test(location.protocol),global:!0,processData:!0,async:!0,contentType:'application/x-www-form-urlencoded; charset=UTF-8',accepts:{'*':allTypes,text:'text/plain',html:'text/html',xml:'application/xml, text/xml',json:'application/json, text/javascript'},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:'responseXML',text:'responseText',json:'responseJSON'},converters:{'* text':String,'text html':!0,'text json':JSON.parse,'text xml':jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function ajaxSetup(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target);},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function ajax(url,options){function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;if(completed)return;completed=!0,timeoutTimer&&window.clearTimeout(timeoutTimer),transport=undefined,responseHeadersString=headers||'',jqXHR.readyState=status>0?4:0,isSuccess=status>=200&&status<300||status===304,responses&&(response=ajaxHandleResponses(s,jqXHR,responses)),response=ajaxConvert(s,response,jqXHR,isSuccess),isSuccess?(s.ifModified&&(modified=jqXHR.getResponseHeader('Last-Modified'),modified&&(jQuery.lastModified[cacheURL]=modified),modified=jqXHR.getResponseHeader('etag'),modified&&(jQuery.etag[cacheURL]=modified)),status===204||s.type==='HEAD'?statusText='nocontent':status===304?statusText='notmodified':(statusText=response.state,success=response.data,error=response.error,isSuccess=!error)):(error=statusText,(status||!statusText)&&(statusText='error',status<0&&(status=0))),jqXHR.status=status,jqXHR.statusText=(nativeStatusText||statusText)+'',isSuccess?deferred.resolveWith(callbackContext,[success,statusText,jqXHR]):deferred.rejectWith(callbackContext,[jqXHR,statusText,error]),jqXHR.statusCode(_statusCode),_statusCode=undefined,fireGlobals&&globalEventContext.trigger(isSuccess?'ajaxSuccess':'ajaxError',[jqXHR,s,isSuccess?success:error]),completeDeferred.fireWith(callbackContext,[jqXHR,statusText]),fireGlobals&&(globalEventContext.trigger('ajaxComplete',[jqXHR,s]),--jQuery.active||jQuery.event.trigger('ajaxStop'));}(url===void 0?'undefined':_typeof(url))==='object'&&(options=url,url=undefined),options=options||{};var transport,cacheURL,responseHeadersString,responseHeaders,timeoutTimer,urlAnchor,completed,fireGlobals,i,uncached,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks('once memory'),_statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},strAbort='canceled',jqXHR={readyState:0,getResponseHeader:function getResponseHeader(key){var match;if(completed){if(!responseHeaders){responseHeaders={};while(match=rheaders.exec(responseHeadersString))responseHeaders[match[1].toLowerCase()]=match[2];}match=responseHeaders[key.toLowerCase()];}return match==null?null:match;},getAllResponseHeaders:function getAllResponseHeaders(){return completed?responseHeadersString:null;},setRequestHeader:function setRequestHeader(name,value){return completed==null&&(name=requestHeadersNames[name.toLowerCase()]=requestHeadersNames[name.toLowerCase()]||name,requestHeaders[name]=value),this;},overrideMimeType:function overrideMimeType(type){return completed==null&&(s.mimeType=type),this;},statusCode:function statusCode(map){var code;if(map)if(completed)jqXHR.always(map[jqXHR.status]);else for(code in map)_statusCode[code]=[_statusCode[code],map[code]];return this;},abort:function abort(statusText){var finalText=statusText||strAbort;return transport&&transport.abort(finalText),done(0,finalText),this;}};if(deferred.promise(jqXHR),s.url=((url||s.url||location.href)+'').replace(rprotocol,location.protocol+'//'),s.type=options.method||options.type||s.method||s.type,s.dataTypes=(s.dataType||'*').toLowerCase().match(rnothtmlwhite)||[''],s.crossDomain==null){urlAnchor=document.createElement('a');try{urlAnchor.href=s.url,urlAnchor.href=urlAnchor.href,s.crossDomain=originAnchor.protocol+'//'+originAnchor.host!==urlAnchor.protocol+'//'+urlAnchor.host;}catch(e){s.crossDomain=true;}}if(s.data&&s.processData&&typeof s.data!=='string'&&(s.data=jQuery.param(s.data,s.traditional)),inspectPrefiltersOrTransports(prefilters,s,options,jqXHR),completed)return jqXHR;fireGlobals=jQuery.event&&s.global,fireGlobals&&jQuery.active++===0&&jQuery.event.trigger('ajaxStart'),s.type=s.type.toUpperCase(),s.hasContent=!rnoContent.test(s.type),cacheURL=s.url.replace(rhash,''),s.hasContent?s.data&&s.processData&&(s.contentType||'').indexOf('application/x-www-form-urlencoded')===0&&(s.data=s.data.replace(r20,'+')):(uncached=s.url.slice(cacheURL.length),s.data&&(s.processData||typeof s.data==='string')&&(cacheURL+=(rquery.test(cacheURL)?'&':'?')+s.data,delete s.data),s.cache===!1&&(cacheURL=cacheURL.replace(rantiCache,'$1'),uncached=(rquery.test(cacheURL)?'&':'?')+'_='+nonce++ +uncached),s.url=cacheURL+uncached),s.ifModified&&(jQuery.lastModified[cacheURL]&&jqXHR.setRequestHeader('If-Modified-Since',jQuery.lastModified[cacheURL]),jQuery.etag[cacheURL]&&jqXHR.setRequestHeader('If-None-Match',jQuery.etag[cacheURL])),(s.data&&s.hasContent&&s.contentType!==!1||options.contentType)&&jqXHR.setRequestHeader('Content-Type',s.contentType),jqXHR.setRequestHeader('Accept',s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=='*'?', '+allTypes+'; q=0.01':''):s.accepts['*']);for(i in s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===!1||completed))return jqXHR.abort();if(strAbort='abort',completeDeferred.add(s.complete),jqXHR.done(s.success),jqXHR.fail(s.error),transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR),!transport)done(-1,'No Transport');else{if(jqXHR.readyState=1,fireGlobals&&globalEventContext.trigger('ajaxSend',[jqXHR,s]),completed)return jqXHR;s.async&&s.timeout>0&&(timeoutTimer=window.setTimeout(function(){jqXHR.abort('timeout');},s.timeout));try{completed=!1,transport.send(requestHeaders,done);}catch(e){if(completed){throw e;}done(-1,e);}}return jqXHR;},getJSON:function getJSON(url,data,callback){return jQuery.get(url,data,callback,'json');},getScript:function getScript(url,callback){return jQuery.get(url,undefined,callback,'script');}}),jQuery.each(['get','post'],function(i,method){jQuery[method]=function(url,data,callback,type){return isFunction(data)&&(type=type||callback,callback=data,data=undefined),jQuery.ajax(jQuery.extend({url:url,type:method,dataType:type,data:data,success:callback},jQuery.isPlainObject(url)&&url));};}),jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:'GET',dataType:'script',cache:!0,async:!1,global:!1,throws:!0});},jQuery.fn.extend({wrapAll:function wrapAll(html){var wrap;return this[0]&&(isFunction(html)&&(html=html.call(this[0])),wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&wrap.insertBefore(this[0]),wrap.map(function(){var elem=this;while(elem.firstElementChild)elem=elem.firstElementChild;return elem;}).append(this)),this;},wrapInner:function wrapInner(html){return isFunction(html)?this.each(function(i){jQuery(this).wrapInner(html.call(this,i));}):this.each(function(){var self=jQuery(this),contents=self.contents();contents.length?contents.wrapAll(html):self.append(html);});},wrap:function wrap(html){var htmlIsFunction=isFunction(html);return this.each(function(i){jQuery(this).wrapAll(htmlIsFunction?html.call(this,i):html);});},unwrap:function unwrap(selector){return this.parent(selector).not('body').each(function(){jQuery(this).replaceWith(this.childNodes);}),this;}}),jQuery.expr.pseudos.hidden=function(elem){return!jQuery.expr.pseudos.visible(elem);},jQuery.expr.pseudos.visible=function(elem){return!!(elem.offsetWidth||elem.offsetHeight||elem.getClientRects().length);},jQuery.ajaxSettings.xhr=function(){try{return new window.XMLHttpRequest();}catch(e){}};var xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();support.cors=!!xhrSupported&&'withCredentials'in xhrSupported,support.ajax=xhrSupported=!!xhrSupported,jQuery.ajaxTransport(function(options){var _callback,errorCallback;return support.cors||xhrSupported&&!options.crossDomain?{send:function send(headers,complete){var i,xhr=options.xhr();if(xhr.open(options.type,options.url,options.async,options.username,options.password),options.xhrFields)for(i in options.xhrFields)xhr[i]=options.xhrFields[i];options.mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(options.mimeType),options.crossDomain||headers['X-Requested-With']||(headers['X-Requested-With']='XMLHttpRequest');for(i in headers)xhr.setRequestHeader(i,headers[i]);_callback=function callback(type){return function(){_callback&&(_callback=errorCallback=xhr.onload=xhr.onerror=xhr.onabort=xhr.ontimeout=xhr.onreadystatechange=null,type==='abort'?xhr.abort():type==='error'?typeof xhr.status!=='number'?complete(0,'error'):complete(xhr.status,xhr.statusText):complete(xhrSuccessStatus[xhr.status]||xhr.status,xhr.statusText,(xhr.responseType||'text')!=='text'||typeof xhr.responseText!=='string'?{binary:xhr.response}:{text:xhr.responseText},xhr.getAllResponseHeaders()));};},xhr.onload=_callback(),errorCallback=xhr.onerror=xhr.ontimeout=_callback('error'),xhr.onabort!==undefined?xhr.onabort=errorCallback:xhr.onreadystatechange=function(){xhr.readyState===4&&window.setTimeout(function(){_callback&&errorCallback();});},_callback=_callback('abort');try{xhr.send(options.hasContent&&options.data||null);}catch(e){if(_callback){throw e;}}},abort:function abort(){_callback&&_callback();}}:void 0;}),jQuery.ajaxPrefilter(function(s){s.crossDomain&&(s.contents.script=!1);}),jQuery.ajaxSetup({accepts:{script:'text/javascript, application/javascript, '+'application/ecmascript, application/x-ecmascript'},contents:{script:/\b(?:java|ecma)script\b/},converters:{'text script':function textScript(text){return jQuery.globalEval(text),text;}}}),jQuery.ajaxPrefilter('script',function(s){s.cache===undefined&&(s.cache=!1),s.crossDomain&&(s.type='GET');}),jQuery.ajaxTransport('script',function(s){if(s.crossDomain){var script,_callback2;return{send:function send(_,complete){script=jQuery('<script>').prop({charset:s.scriptCharset,src:s.url}).on('load error',_callback2=function callback(evt){script.remove(),_callback2=null,evt&&complete(evt.type==='error'?404:200,evt.type);}),document.head.appendChild(script[0]);},abort:function abort(){_callback2&&_callback2();}};}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:'callback',jsonpCallback:function jsonpCallback(){var callback=oldCallbacks.pop()||jQuery.expando+'_'+nonce++;return this[callback]=!0,callback;}}),jQuery.ajaxPrefilter('json jsonp',function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==!1&&(rjsonp.test(s.url)?'url':typeof s.data==='string'&&(s.contentType||'').indexOf('application/x-www-form-urlencoded')===0&&rjsonp.test(s.data)&&'data');return jsonProp||s.dataTypes[0]==='jsonp'?(callbackName=s.jsonpCallback=isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,jsonProp?s[jsonProp]=s[jsonProp].replace(rjsonp,'$1'+callbackName):s.jsonp!==!1&&(s.url+=(rquery.test(s.url)?'&':'?')+s.jsonp+'='+callbackName),s.converters['script json']=function(){return responseContainer||jQuery.error(callbackName+' was not called'),responseContainer[0];},s.dataTypes[0]='json',overwritten=window[callbackName],window[callbackName]=function(){responseContainer=arguments;},jqXHR.always(function(){overwritten===undefined?jQuery(window).removeProp(callbackName):window[callbackName]=overwritten,s[callbackName]&&(s.jsonpCallback=originalSettings.jsonpCallback,oldCallbacks.push(callbackName)),responseContainer&&isFunction(overwritten)&&overwritten(responseContainer[0]),responseContainer=overwritten=undefined;}),'script'):void 0;}),support.createHTMLDocument=function(body){return body=document.implementation.createHTMLDocument('').body,body.innerHTML='<form></form><form></form>',body.childNodes.length===2;}(),jQuery.parseHTML=function(data,context,keepScripts){if(typeof data!=='string')return[];typeof context==='boolean'&&(keepScripts=context,context=!1);var base,parsed,scripts;return context||(support.createHTMLDocument?(context=document.implementation.createHTMLDocument(''),base=context.createElement('base'),base.href=document.location.href,context.head.appendChild(base)):context=document),parsed=rsingleTag.exec(data),scripts=!keepScripts&&[],parsed?[context.createElement(parsed[1])]:(parsed=buildFragment([data],context,scripts),scripts&&scripts.length&&jQuery(scripts).remove(),jQuery.merge([],parsed.childNodes));},jQuery.fn.load=function(url,params,callback){var selector,type,response,self=this,off=url.indexOf(' ');return off>-1&&(selector=stripAndCollapse(url.slice(off)),url=url.slice(0,off)),isFunction(params)?(callback=params,params=undefined):params&&(params===void 0?'undefined':_typeof(params))==='object'&&(type='POST'),self.length>0&&jQuery.ajax({url:url,type:type||'GET',dataType:'html',data:params}).done(function(responseText){response=arguments,self.html(selector?jQuery('<div>').append(jQuery.parseHTML(responseText)).find(selector):responseText);}).always(callback&&function(jqXHR,status){self.each(function(){callback.apply(this,response||[jqXHR.responseText,status,jqXHR]);});}),this;},jQuery.each(['ajaxStart','ajaxStop','ajaxComplete','ajaxError','ajaxSuccess','ajaxSend'],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn);};}),jQuery.expr.pseudos.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem;}).length;},jQuery.offset={setOffset:function setOffset(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,'position'),curElem=jQuery(elem),props={};position==='static'&&(elem.style.position='relative'),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,'top'),curCSSLeft=jQuery.css(elem,'left'),calculatePosition=(position==='absolute'||position==='fixed')&&(curCSSTop+curCSSLeft).indexOf('auto')>-1,calculatePosition?(curPosition=curElem.position(),curTop=curPosition.top,curLeft=curPosition.left):(curTop=parseFloat(curCSSTop)||0,curLeft=parseFloat(curCSSLeft)||0),isFunction(options)&&(options=options.call(elem,i,jQuery.extend({},curOffset))),options.top!=null&&(props.top=options.top-curOffset.top+curTop),options.left!=null&&(props.left=options.left-curOffset.left+curLeft),'using'in options?options.using.call(elem,props):curElem.css(props);}},jQuery.fn.extend({offset:function offset(options){if(arguments.length)return options===undefined?this:this.each(function(i){jQuery.offset.setOffset(this,options,i);});var rect,win,elem=this[0];return elem?elem.getClientRects().length?(rect=elem.getBoundingClientRect(),win=elem.ownerDocument.defaultView,{top:rect.top+win.pageYOffset,left:rect.left+win.pageXOffset}):{top:0,left:0}:void 0;},position:function position(){if(!this[0])return;var offsetParent,offset,doc,elem=this[0],parentOffset={top:0,left:0};if(jQuery.css(elem,'position')==='fixed')offset=elem.getBoundingClientRect();else{offset=this.offset(),doc=elem.ownerDocument,offsetParent=elem.offsetParent||doc.documentElement;while(offsetParent&&(offsetParent===doc.body||offsetParent===doc.documentElement)&&jQuery.css(offsetParent,'position')==='static')offsetParent=offsetParent.parentNode;offsetParent&&offsetParent!==elem&&offsetParent.nodeType===1&&(parentOffset=jQuery(offsetParent).offset(),parentOffset.top+=jQuery.css(offsetParent,'borderTopWidth',!0),parentOffset.left+=jQuery.css(offsetParent,'borderLeftWidth',!0));}return{top:offset.top-parentOffset.top-jQuery.css(elem,'marginTop',!0),left:offset.left-parentOffset.left-jQuery.css(elem,'marginLeft',!0)};},offsetParent:function offsetParent(){return this.map(function(){var offsetParent=this.offsetParent;while(offsetParent&&jQuery.css(offsetParent,'position')==='static')offsetParent=offsetParent.offsetParent;return offsetParent||documentElement;});}}),jQuery.each({scrollLeft:'pageXOffset',scrollTop:'pageYOffset'},function(method,prop){var top='pageYOffset'===prop;jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win;if(isWindow(elem)?win=elem:elem.nodeType===9&&(win=elem.defaultView),val===undefined)return win?win[prop]:elem[method];win?win.scrollTo(top?win.pageXOffset:val,top?val:win.pageYOffset):elem[method]=val;},method,val,arguments.length);};}),jQuery.each(['top','left'],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){return computed?(computed=curCSS(elem,prop),rnumnonpx.test(computed)?jQuery(elem).position()[prop]+'px':computed):void 0;});}),jQuery.each({Height:'height',Width:'width'},function(name,type){jQuery.each({padding:'inner'+name,content:type,'':'outer'+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||typeof margin!=='boolean'),extra=defaultExtra||(margin===!0||value===!0?'margin':'border');return access(this,function(elem,type,value){var doc;return isWindow(elem)?funcName.indexOf('outer')===0?elem['inner'+name]:elem.document.documentElement['client'+name]:elem.nodeType===9?(doc=elem.documentElement,Math.max(elem.body['scroll'+name],doc['scroll'+name],elem.body['offset'+name],doc['offset'+name],doc['client'+name])):value===undefined?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra);},type,chainable?margin:undefined,chainable);};});}),jQuery.each(('blur focus focusin focusout resize scroll click dblclick '+'mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave '+'change select submit keydown keypress keyup contextmenu').split(' '),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name);};}),jQuery.fn.extend({hover:function hover(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver);}}),jQuery.fn.extend({bind:function bind(types,data,fn){return this.on(types,null,data,fn);},unbind:function unbind(types,fn){return this.off(types,null,fn);},delegate:function delegate(selector,types,data,fn){return this.on(types,selector,data,fn);},undelegate:function undelegate(selector,types,fn){return arguments.length===1?this.off(selector,'**'):this.off(types,selector||'**',fn);}}),jQuery.proxy=function(fn,context){var tmp,args,proxy;return typeof context==='string'&&(tmp=fn[context],context=fn,fn=tmp),isFunction(fn)?(args=_slice.call(arguments,2),proxy=function proxy(){return fn.apply(context||this,args.concat(_slice.call(arguments)));},proxy.guid=fn.guid=fn.guid||jQuery.guid++,proxy):undefined;},jQuery.holdReady=function(hold){hold?jQuery.readyWait++:jQuery.ready(!0);},jQuery.isArray=Array.isArray,jQuery.parseJSON=JSON.parse,jQuery.nodeName=nodeName,jQuery.isFunction=isFunction,jQuery.isWindow=isWindow,jQuery.camelCase=camelCase,jQuery.type=toType,jQuery.now=Date.now,jQuery.isNumeric=function(obj){var type=jQuery.type(obj);return(type==='number'||type==='string')&&!isNaN(obj-parseFloat(obj));},typeof define==='function'&&define.amd&&define('jquery',[],function(){return jQuery;});var _jQuery=window.jQuery,_$=window.$;return jQuery.noConflict=function(deep){return window.$===jQuery&&(window.$=_$),deep&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery;},noGlobal||(window.jQuery=window.$=jQuery),jQuery;}));},{}],352:[function(require,module,exports){'use strict';function flattenDeep(array){var length=array?array.length:0;return length?baseFlatten(array,!0):[];}var baseFlatten=require('../internal/baseFlatten');module.exports=flattenDeep;},{'../internal/baseFlatten':379}],353:[function(require,module,exports){'use strict';function last(array){var length=array?array.length:0;return length?array[length-1]:undefined;}module.exports=last;},{}],354:[function(require,module,exports){'use strict';function xor(){var index=-1,length=arguments.length;while(++index<length){var array=arguments[index];if(isArrayLike(array))var result=result?arrayPush(baseDifference(result,array),baseDifference(array,result)):array;}return result?baseUniq(result):[];}var arrayPush=require('../internal/arrayPush'),baseDifference=require('../internal/baseDifference'),baseUniq=require('../internal/baseUniq'),isArrayLike=require('../internal/isArrayLike');module.exports=xor;},{'../internal/arrayPush':367,'../internal/baseDifference':374,'../internal/baseUniq':394,'../internal/isArrayLike':412}],355:[function(require,module,exports){'use strict';function filter(collection,predicate,thisArg){var func=isArray(collection)?arrayFilter:baseFilter;return predicate=baseCallback(predicate,thisArg,3),func(collection,predicate);}var arrayFilter=require('../internal/arrayFilter'),baseCallback=require('../internal/baseCallback'),baseFilter=require('../internal/baseFilter'),isArray=require('../lang/isArray');module.exports=filter;},{'../internal/arrayFilter':365,'../internal/baseCallback':371,'../internal/baseFilter':376,'../lang/isArray':423}],356:[function(require,module,exports){'use strict';var baseEach=require('../internal/baseEach'),createFind=require('../internal/createFind');var find=createFind(baseEach);module.exports=find;},{'../internal/baseEach':375,'../internal/createFind':403}],357:[function(require,module,exports){'use strict';var arrayEach=require('../internal/arrayEach'),baseEach=require('../internal/baseEach'),createForEach=require('../internal/createForEach');var forEach=createForEach(arrayEach,baseEach);module.exports=forEach;},{'../internal/arrayEach':364,'../internal/baseEach':375,'../internal/createForEach':404}],358:[function(require,module,exports){'use strict';var createAggregator=require('../internal/createAggregator');var indexBy=createAggregator(function(result,value,key){result[key]=value;});module.exports=indexBy;},{'../internal/createAggregator':398}],359:[function(require,module,exports){'use strict';function map(collection,iteratee,thisArg){var func=isArray(collection)?arrayMap:baseMap;return iteratee=baseCallback(iteratee,thisArg,3),func(collection,iteratee);}var arrayMap=require('../internal/arrayMap'),baseCallback=require('../internal/baseCallback'),baseMap=require('../internal/baseMap'),isArray=require('../lang/isArray');module.exports=map;},{'../internal/arrayMap':366,'../internal/baseCallback':371,'../internal/baseMap':387,'../lang/isArray':423}],360:[function(require,module,exports){'use strict';var getNative=require('../internal/getNative');var nativeNow=getNative(Date,'now');var now=nativeNow||function(){return new Date().getTime();};module.exports=now;},{'../internal/getNative':410}],361:[function(require,module,exports){'use strict';function debounce(func,wait,options){function cancel(){timeoutId&&clearTimeout(timeoutId),maxTimeoutId&&clearTimeout(maxTimeoutId),lastCalled=0,maxTimeoutId=timeoutId=trailingCall=undefined;}function complete(isCalled,id){id&&clearTimeout(id),maxTimeoutId=timeoutId=trailingCall=undefined,isCalled&&(lastCalled=now(),result=func.apply(thisArg,args),timeoutId||maxTimeoutId||(args=thisArg=undefined));}function delayed(){var remaining=wait-(now()-stamp);remaining<=0||remaining>wait?complete(trailingCall,maxTimeoutId):timeoutId=setTimeout(delayed,remaining);}function maxDelayed(){complete(trailing,timeoutId);}function debounced(){if(args=arguments,stamp=now(),thisArg=this,trailingCall=trailing&&(timeoutId||!leading),maxWait===!1)var leadingCall=leading&&!timeoutId;else{maxTimeoutId||leading||(lastCalled=stamp);var remaining=maxWait-(stamp-lastCalled),isCalled=remaining<=0||remaining>maxWait;isCalled?(maxTimeoutId&&(maxTimeoutId=clearTimeout(maxTimeoutId)),lastCalled=stamp,result=func.apply(thisArg,args)):maxTimeoutId||(maxTimeoutId=setTimeout(maxDelayed,remaining));}return isCalled&&timeoutId?timeoutId=clearTimeout(timeoutId):!timeoutId&&wait!==maxWait&&(timeoutId=setTimeout(delayed,wait)),leadingCall&&(isCalled=!0,result=func.apply(thisArg,args)),isCalled&&!timeoutId&&!maxTimeoutId&&(args=thisArg=undefined),result;}var args,maxTimeoutId,result,stamp,thisArg,timeoutId,trailingCall,lastCalled=0,maxWait=!1,trailing=!0;if(typeof func!='function')throw new TypeError(FUNC_ERROR_TEXT);if(wait=wait<0?0:+wait||0,options===!0){var leading=!0;trailing=!1;}else isObject(options)&&(leading=!!options.leading,maxWait='maxWait'in options&&nativeMax(+options.maxWait||0,wait),trailing='trailing'in options?!!options.trailing:trailing);return debounced.cancel=cancel,debounced;}var isObject=require('../lang/isObject'),now=require('../date/now');var FUNC_ERROR_TEXT='Expected a function';var nativeMax=Math.max;module.exports=debounce;},{'../date/now':360,'../lang/isObject':427}],362:[function(require,module,exports){'use strict';function restParam(func,start){if(typeof func!='function')throw new TypeError(FUNC_ERROR_TEXT);return start=nativeMax(start===undefined?func.length-1:+start||0,0),function(){var args=arguments,index=-1,length=nativeMax(args.length-start,0),rest=Array(length);while(++index<length)rest[index]=args[start+index];switch(start){case 0:return func.call(this,rest);case 1:return func.call(this,args[0],rest);case 2:return func.call(this,args[0],args[1],rest);}var otherArgs=Array(start+1);index=-1;while(++index<start)otherArgs[index]=args[index];return otherArgs[start]=rest,func.apply(this,otherArgs);};}var FUNC_ERROR_TEXT='Expected a function';var nativeMax=Math.max;module.exports=restParam;},{}],363:[function(require,module,exports){(function(global){'use strict';function SetCache(values){var length=values?values.length:0;this.data={hash:nativeCreate(null),set:new Set()};while(length--)this.push(values[length]);}var cachePush=require('./cachePush'),getNative=require('./getNative');var Set=getNative(global,'Set');var nativeCreate=getNative(Object,'create');SetCache.prototype.push=cachePush,module.exports=SetCache;}.call(this,typeof global!=='undefined'?global:typeof self!=='undefined'?self:typeof window!=='undefined'?window:{}));},{'./cachePush':397,'./getNative':410}],364:[function(require,module,exports){'use strict';function arrayEach(array,iteratee){var index=-1,length=array.length;while(++index<length)if(iteratee(array[index],index,array)===!1)break;return array;}module.exports=arrayEach;},{}],365:[function(require,module,exports){'use strict';function arrayFilter(array,predicate){var index=-1,length=array.length,resIndex=-1,result=[];while(++index<length){var value=array[index];predicate(value,index,array)&&(result[++resIndex]=value);}return result;}module.exports=arrayFilter;},{}],366:[function(require,module,exports){'use strict';function arrayMap(array,iteratee){var index=-1,length=array.length,result=Array(length);while(++index<length)result[index]=iteratee(array[index],index,array);return result;}module.exports=arrayMap;},{}],367:[function(require,module,exports){'use strict';function arrayPush(array,values){var index=-1,length=values.length,offset=array.length;while(++index<length)array[offset+index]=values[index];return array;}module.exports=arrayPush;},{}],368:[function(require,module,exports){'use strict';function arraySome(array,predicate){var index=-1,length=array.length;while(++index<length)if(predicate(array[index],index,array))return!0;return!1;}module.exports=arraySome;},{}],369:[function(require,module,exports){'use strict';function assignWith(object,source,customizer){var index=-1,props=keys(source),length=props.length;while(++index<length){var key=props[index],value=object[key],result=customizer(value,source[key],key,object,source);((result===result?result!==value:value===value)||value===undefined&&!(key in object))&&(object[key]=result);}return object;}var keys=require('../object/keys');module.exports=assignWith;},{'../object/keys':432}],370:[function(require,module,exports){'use strict';function baseAssign(object,source){return source==null?object:baseCopy(source,keys(source),object);}var baseCopy=require('./baseCopy'),keys=require('../object/keys');module.exports=baseAssign;},{'../object/keys':432,'./baseCopy':372}],371:[function(require,module,exports){'use strict';function baseCallback(func,thisArg,argCount){var type=func===void 0?'undefined':_typeof(func);return type=='function'?thisArg===undefined?func:bindCallback(func,thisArg,argCount):func==null?identity:type=='object'?baseMatches(func):thisArg===undefined?property(func):baseMatchesProperty(func,thisArg);}var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj;};var baseMatches=require('./baseMatches'),baseMatchesProperty=require('./baseMatchesProperty'),bindCallback=require('./bindCallback'),identity=require('../utility/identity'),property=require('../utility/property');module.exports=baseCallback;},{'../utility/identity':436,'../utility/property':437,'./baseMatches':388,'./baseMatchesProperty':389,'./bindCallback':395}],372:[function(require,module,exports){'use strict';function baseCopy(source,props,object){object||(object={});var index=-1,length=props.length;while(++index<length){var key=props[index];object[key]=source[key];}return object;}module.exports=baseCopy;},{}],373:[function(require,module,exports){'use strict';var isObject=require('../lang/isObject');var baseCreate=function(){function object(){}return function(prototype){if(isObject(prototype)){object.prototype=prototype;var result=new object();object.prototype=undefined;}return result||{};};}();module.exports=baseCreate;},{'../lang/isObject':427}],374:[function(require,module,exports){'use strict';function baseDifference(array,values){var length=array?array.length:0,result=[];if(!length)return result;var index=-1,indexOf=baseIndexOf,isCommon=!0,cache=isCommon&&values.length>=LARGE_ARRAY_SIZE?createCache(values):null,valuesLength=values.length;cache&&(indexOf=cacheIndexOf,isCommon=!1,values=cache);outer:while(++index<length){var value=array[index];if(isCommon&&value===value){var valuesIndex=valuesLength;while(valuesIndex--)if(values[valuesIndex]===value)continue outer;result.push(value);}else indexOf(values,value,0)<0&&result.push(value);}return result;}var baseIndexOf=require('./baseIndexOf'),cacheIndexOf=require('./cacheIndexOf'),createCache=require('./createCache');var LARGE_ARRAY_SIZE=200;module.exports=baseDifference;},{'./baseIndexOf':383,'./cacheIndexOf':396,'./createCache':402}],375:[function(require,module,exports){'use strict';var baseForOwn=require('./baseForOwn'),createBaseEach=require('./createBaseEach');var baseEach=createBaseEach(baseForOwn);module.exports=baseEach;},{'./baseForOwn':381,'./createBaseEach':400}],376:[function(require,module,exports){'use strict';function baseFilter(collection,predicate){var result=[];return baseEach(collection,function(value,index,collection){predicate(value,index,collection)&&result.push(value);}),result;}var baseEach=require('./baseEach');module.exports=baseFilter;},{'./baseEach':375}],377:[function(require,module,exports){'use strict';function baseFind(collection,predicate,eachFunc,retKey){var result;return eachFunc(collection,function(value,key,collection){return predicate(value,key,collection)?(result=retKey?key:value,!1):void 0;}),result;}module.exports=baseFind;},{}],378:[function(require,module,exports){'use strict';function baseFindIndex(array,predicate,fromRight){var length=array.length,index=fromRight?length:-1;while(fromRight?index--:++index<length)if(predicate(array[index],index,array))return index;return-1;}module.exports=baseFindIndex;},{}],379:[function(require,module,exports){'use strict';function baseFlatten(array,isDeep,isStrict,result){result||(result=[]);var index=-1,length=array.length;while(++index<length){var value=array[index];isObjectLike(value)&&isArrayLike(value)&&(isStrict||isArray(value)||isArguments(value))?isDeep?baseFlatten(value,isDeep,isStrict,result):arrayPush(result,value):isStrict||(result[result.length]=value);}return result;}var arrayPush=require('./arrayPush'),isArguments=require('../lang/isArguments'),isArray=require('../lang/isArray'),isArrayLike=require('./isArrayLike'),isObjectLike=require('./isObjectLike');module.exports=baseFlatten;},{'../lang/isArguments':422,'../lang/isArray':423,'./arrayPush':367,'./isArrayLike':412,'./isObjectLike':417}],380:[function(require,module,exports){'use strict';var createBaseFor=require('./createBaseFor');var baseFor=createBaseFor();module.exports=baseFor;},{'./createBaseFor':401}],381:[function(require,module,exports){'use strict';function baseForOwn(object,iteratee){return baseFor(object,iteratee,keys);}var baseFor=require('./baseFor'),keys=require('../object/keys');module.exports=baseForOwn;},{'../object/keys':432,'./baseFor':380}],382:[function(require,module,exports){'use strict';function baseGet(object,path,pathKey){if(object==null)return;pathKey!==undefined&&pathKey in toObject(object)&&(path=[pathKey]);var index=0,length=path.length;while(object!=null&&index<length)object=object[path[index++]];return index&&index==length?object:undefined;}var toObject=require('./toObject');module.exports=baseGet;},{'./toObject':420}],383:[function(require,module,exports){'use strict';function baseIndexOf(array,value,fromIndex){if(value!==value)return indexOfNaN(array,fromIndex);var index=fromIndex-1,length=array.length;while(++index<length)if(array[index]===value)return index;return-1;}var indexOfNaN=require('./indexOfNaN');module.exports=baseIndexOf;},{'./indexOfNaN':411}],384:[function(require,module,exports){'use strict';function baseIsEqual(value,other,customizer,isLoose,stackA,stackB){return value===other?!0:value==null||other==null||!(isObject(value)||isObjectLike(other))?value!==value&&other!==other:baseIsEqualDeep(value,other,baseIsEqual,customizer,isLoose,stackA,stackB);}var baseIsEqualDeep=require('./baseIsEqualDeep'),isObject=require('../lang/isObject'),isObjectLike=require('./isObjectLike');module.exports=baseIsEqual;},{'../lang/isObject':427,'./baseIsEqualDeep':385,'./isObjectLike':417}],385:[function(require,module,exports){'use strict';function baseIsEqualDeep(object,other,equalFunc,customizer,isLoose,stackA,stackB){var objIsArr=isArray(object),othIsArr=isArray(other),objTag=arrayTag,othTag=arrayTag;objIsArr||(objTag=objToString.call(object),objTag==argsTag?objTag=objectTag:objTag!=objectTag&&(objIsArr=isTypedArray(object))),othIsArr||(othTag=objToString.call(other),othTag==argsTag?othTag=objectTag:othTag!=objectTag&&(othIsArr=isTypedArray(other)));var objIsObj=objTag==objectTag,othIsObj=othTag==objectTag,isSameTag=objTag==othTag;if(isSameTag&&!(objIsArr||objIsObj))return equalByTag(object,other,objTag);if(!isLoose){var objIsWrapped=objIsObj&&hasOwnProperty.call(object,'__wrapped__'),othIsWrapped=othIsObj&&hasOwnProperty.call(other,'__wrapped__');if(objIsWrapped||othIsWrapped)return equalFunc(objIsWrapped?object.value():object,othIsWrapped?other.value():other,customizer,isLoose,stackA,stackB);}if(!isSameTag)return!1;stackA||(stackA=[]),stackB||(stackB=[]);var length=stackA.length;while(length--)if(stackA[length]==object)return stackB[length]==other;stackA.push(object),stackB.push(other);var result=(objIsArr?equalArrays:equalObjects)(object,other,equalFunc,customizer,isLoose,stackA,stackB);return stackA.pop(),stackB.pop(),result;}var equalArrays=require('./equalArrays'),equalByTag=require('./equalByTag'),equalObjects=require('./equalObjects'),isArray=require('../lang/isArray'),isTypedArray=require('../lang/isTypedArray');var argsTag='[object Arguments]',arrayTag='[object Array]',objectTag='[object Object]';var objectProto=Object.prototype;var hasOwnProperty=objectProto.hasOwnProperty;var objToString=objectProto.toString;module.exports=baseIsEqualDeep;},{'../lang/isArray':423,'../lang/isTypedArray':429,'./equalArrays':405,'./equalByTag':406,'./equalObjects':407}],386:[function(require,module,exports){'use strict';function baseIsMatch(object,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(object==null)return!length;object=toObject(object);while(index--){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object))return!1;}while(++index<length){data=matchData[index];var key=data[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(objValue===undefined&&!(key in object))return!1;}else{var result=customizer?customizer(objValue,srcValue,key):undefined;if(!(result===undefined?baseIsEqual(srcValue,objValue,customizer,!0):result))return!1;}}return!0;}var baseIsEqual=require('./baseIsEqual'),toObject=require('./toObject');module.exports=baseIsMatch;},{'./baseIsEqual':384,'./toObject':420}],387:[function(require,module,exports){'use strict';function baseMap(collection,iteratee){var index=-1,result=isArrayLike(collection)?Array(collection.length):[];return baseEach(collection,function(value,key,collection){result[++index]=iteratee(value,key,collection);}),result;}var baseEach=require('./baseEach'),isArrayLike=require('./isArrayLike');module.exports=baseMap;},{'./baseEach':375,'./isArrayLike':412}],388:[function(require,module,exports){'use strict';function baseMatches(source){var matchData=getMatchData(source);if(matchData.length==1&&matchData[0][2]){var key=matchData[0][0],value=matchData[0][1];return function(object){return object==null?!1:object[key]===value&&(value!==undefined||key in toObject(object));};}return function(object){return baseIsMatch(object,matchData);};}var baseIsMatch=require('./baseIsMatch'),getMatchData=require('./getMatchData'),toObject=require('./toObject');module.exports=baseMatches;},{'./baseIsMatch':386,'./getMatchData':409,'./toObject':420}],389:[function(require,module,exports){'use strict';function baseMatchesProperty(path,srcValue){var isArr=isArray(path),isCommon=isKey(path)&&isStrictComparable(srcValue),pathKey=path+'';return path=toPath(path),function(object){if(object==null)return!1;var key=pathKey;if(object=toObject(object),(isArr||!isCommon)&&!(key in object)){if(object=path.length==1?object:baseGet(object,baseSlice(path,0,-1)),object==null)return!1;key=last(path),object=toObject(object);}return object[key]===srcValue?srcValue!==undefined||key in object:baseIsEqual(srcValue,object[key],undefined,!0);};}var baseGet=require('./baseGet'),baseIsEqual=require('./baseIsEqual'),baseSlice=require('./baseSlice'),isArray=require('../lang/isArray'),isKey=require('./isKey'),isStrictComparable=require('./isStrictComparable'),last=require('../array/last'),toObject=require('./toObject'),toPath=require('./toPath');module.exports=baseMatchesProperty;},{'../array/last':353,'../lang/isArray':423,'./baseGet':382,'./baseIsEqual':384,'./baseSlice':392,'./isKey':415,'./isStrictComparable':418,'./toObject':420,'./toPath':421}],390:[function(require,module,exports){'use strict';function baseProperty(key){return function(object){return object==null?undefined:object[key];};}module.exports=baseProperty;},{}],391:[function(require,module,exports){'use strict';function basePropertyDeep(path){var pathKey=path+'';return path=toPath(path),function(object){return baseGet(object,path,pathKey);};}var baseGet=require('./baseGet'),toPath=require('./toPath');module.exports=basePropertyDeep;},{'./baseGet':382,'./toPath':421}],392:[function(require,module,exports){'use strict';function baseSlice(array,start,end){var index=-1,length=array.length;start=start==null?0:+start||0,start<0&&(start=-start>length?0:length+start),end=end===undefined||end>length?length:+end||0,end<0&&(end+=length),length=start>end?0:end-start>>>0,start>>>=0;var result=Array(length);while(++index<length)result[index]=array[index+start];return result;}module.exports=baseSlice;},{}],393:[function(require,module,exports){'use strict';function baseToString(value){return value==null?'':value+'';}module.exports=baseToString;},{}],394:[function(require,module,exports){'use strict';function baseUniq(array,iteratee){var index=-1,indexOf=baseIndexOf,length=array.length,isCommon=!0,isLarge=isCommon&&length>=LARGE_ARRAY_SIZE,seen=isLarge?createCache():null,result=[];seen?(indexOf=cacheIndexOf,isCommon=!1):(isLarge=!1,seen=iteratee?[]:result);outer:while(++index<length){var value=array[index],computed=iteratee?iteratee(value,index,array):value;if(isCommon&&value===value){var seenIndex=seen.length;while(seenIndex--)if(seen[seenIndex]===computed)continue outer;iteratee&&seen.push(computed),result.push(value);}else indexOf(seen,computed,0)<0&&((iteratee||isLarge)&&seen.push(computed),result.push(value));}return result;}var baseIndexOf=require('./baseIndexOf'),cacheIndexOf=require('./cacheIndexOf'),createCache=require('./createCache');var LARGE_ARRAY_SIZE=200;module.exports=baseUniq;},{'./baseIndexOf':383,'./cacheIndexOf':396,'./createCache':402}],395:[function(require,module,exports){'use strict';function bindCallback(func,thisArg,argCount){if(typeof func!='function')return identity;if(thisArg===undefined)return func;switch(argCount){case 1:return function(value){return func.call(thisArg,value);};case 3:return function(value,index,collection){return func.call(thisArg,value,index,collection);};case 4:return function(accumulator,value,index,collection){return func.call(thisArg,accumulator,value,index,collection);};case 5:return function(value,other,key,object,source){return func.call(thisArg,value,other,key,object,source);};}return function(){return func.apply(thisArg,arguments);};}var identity=require('../utility/identity');module.exports=bindCallback;},{'../utility/identity':436}],396:[function(require,module,exports){'use strict';function cacheIndexOf(cache,value){var data=cache.data,result=typeof value=='string'||isObject(value)?data.set.has(value):data.hash[value];return result?0:-1;}var isObject=require('../lang/isObject');module.exports=cacheIndexOf;},{'../lang/isObject':427}],397:[function(require,module,exports){'use strict';function cachePush(value){var data=this.data;typeof value=='string'||isObject(value)?data.set.add(value):data.hash[value]=!0;}var isObject=require('../lang/isObject');module.exports=cachePush;},{'../lang/isObject':427}],398:[function(require,module,exports){'use strict';function createAggregator(setter,initializer){return function(collection,iteratee,thisArg){var result=initializer?initializer():{};if(iteratee=baseCallback(iteratee,thisArg,3),isArray(collection)){var index=-1,length=collection.length;while(++index<length){var value=collection[index];setter(result,value,iteratee(value,index,collection),collection);}}else baseEach(collection,function(value,key,collection){setter(result,value,iteratee(value,key,collection),collection);});return result;};}var baseCallback=require('./baseCallback'),baseEach=require('./baseEach'),isArray=require('../lang/isArray');module.exports=createAggregator;},{'../lang/isArray':423,'./baseCallback':371,'./baseEach':375}],399:[function(require,module,exports){'use strict';function createAssigner(assigner){return restParam(function(object,sources){var index=-1,length=object==null?0:sources.length,customizer=length>2?sources[length-2]:undefined,guard=length>2?sources[2]:undefined,thisArg=length>1?sources[length-1]:undefined;typeof customizer=='function'?(customizer=bindCallback(customizer,thisArg,5),length-=2):(customizer=typeof thisArg=='function'?thisArg:undefined,length-=customizer?1:0),guard&&isIterateeCall(sources[0],sources[1],guard)&&(customizer=length<3?undefined:customizer,length=1);while(++index<length){var source=sources[index];source&&assigner(object,source,customizer);}return object;});}var bindCallback=require('./bindCallback'),isIterateeCall=require('./isIterateeCall'),restParam=require('../function/restParam');module.exports=createAssigner;},{'../function/restParam':362,'./bindCallback':395,'./isIterateeCall':414}],400:[function(require,module,exports){'use strict';function createBaseEach(eachFunc,fromRight){return function(collection,iteratee){var length=collection?getLength(collection):0;if(!isLength(length))return eachFunc(collection,iteratee);var index=fromRight?length:-1,iterable=toObject(collection);while(fromRight?index--:++index<length)if(iteratee(iterable[index],index,iterable)===!1)break;return collection;};}var getLength=require('./getLength'),isLength=require('./isLength'),toObject=require('./toObject');module.exports=createBaseEach;},{'./getLength':408,'./isLength':416,'./toObject':420}],401:[function(require,module,exports){'use strict';function createBaseFor(fromRight){return function(object,iteratee,keysFunc){var iterable=toObject(object),props=keysFunc(object),length=props.length,index=fromRight?length:-1;while(fromRight?index--:++index<length){var key=props[index];if(iteratee(iterable[key],key,iterable)===!1)break;}return object;};}var toObject=require('./toObject');module.exports=createBaseFor;},{'./toObject':420}],402:[function(require,module,exports){(function(global){'use strict';function createCache(values){return nativeCreate&&Set?new SetCache(values):null;}var SetCache=require('./SetCache'),getNative=require('./getNative');var Set=getNative(global,'Set');var nativeCreate=getNative(Object,'create');module.exports=createCache;}.call(this,typeof global!=='undefined'?global:typeof self!=='undefined'?self:typeof window!=='undefined'?window:{}));},{'./SetCache':363,'./getNative':410}],403:[function(require,module,exports){'use strict';function createFind(eachFunc,fromRight){return function(collection,predicate,thisArg){if(predicate=baseCallback(predicate,thisArg,3),isArray(collection)){var index=baseFindIndex(collection,predicate,fromRight);return index>-1?collection[index]:undefined;}return baseFind(collection,predicate,eachFunc);};}var baseCallback=require('./baseCallback'),baseFind=require('./baseFind'),baseFindIndex=require('./baseFindIndex'),isArray=require('../lang/isArray');module.exports=createFind;},{'../lang/isArray':423,'./baseCallback':371,'./baseFind':377,'./baseFindIndex':378}],404:[function(require,module,exports){'use strict';function createForEach(arrayFunc,eachFunc){return function(collection,iteratee,thisArg){return typeof iteratee=='function'&&thisArg===undefined&&isArray(collection)?arrayFunc(collection,iteratee):eachFunc(collection,bindCallback(iteratee,thisArg,3));};}var bindCallback=require('./bindCallback'),isArray=require('../lang/isArray');module.exports=createForEach;},{'../lang/isArray':423,'./bindCallback':395}],405:[function(require,module,exports){'use strict';function equalArrays(array,other,equalFunc,customizer,isLoose,stackA,stackB){var index=-1,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isLoose&&othLength>arrLength))return!1;while(++index<arrLength){var arrValue=array[index],othValue=other[index],result=customizer?customizer(isLoose?othValue:arrValue,isLoose?arrValue:othValue,index):undefined;if(result!==undefined){if(result)continue;return!1;}if(isLoose){if(!arraySome(other,function(othValue){return arrValue===othValue||equalFunc(arrValue,othValue,customizer,isLoose,stackA,stackB);}))return!1;}else if(!(arrValue===othValue||equalFunc(arrValue,othValue,customizer,isLoose,stackA,stackB)))return!1;}return!0;}var arraySome=require('./arraySome');module.exports=equalArrays;},{'./arraySome':368}],406:[function(require,module,exports){'use strict';function equalByTag(object,other,tag){switch(tag){case boolTag:case dateTag:return+object==+other;case errorTag:return object.name==other.name&&object.message==other.message;case numberTag:return object!=+object?other!=+other:object==+other;case regexpTag:case stringTag:return object==other+'';}return!1;}var boolTag='[object Boolean]',dateTag='[object Date]',errorTag='[object Error]',numberTag='[object Number]',regexpTag='[object RegExp]',stringTag='[object String]';module.exports=equalByTag;},{}],407:[function(require,module,exports){'use strict';function equalObjects(object,other,equalFunc,customizer,isLoose,stackA,stackB){var objProps=keys(object),objLength=objProps.length,othProps=keys(other),othLength=othProps.length;if(objLength!=othLength&&!isLoose)return!1;var index=objLength;while(index--){var key=objProps[index];if(!(isLoose?key in other:hasOwnProperty.call(other,key)))return!1;}var skipCtor=isLoose;while(++index<objLength){key=objProps[index];var objValue=object[key],othValue=other[key],result=customizer?customizer(isLoose?othValue:objValue,isLoose?objValue:othValue,key):undefined;if(!(result===undefined?equalFunc(objValue,othValue,customizer,isLoose,stackA,stackB):result))return!1;skipCtor||(skipCtor=key=='constructor');}if(!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;if(objCtor!=othCtor&&'constructor'in object&&'constructor'in other&&!(typeof objCtor=='function'&&objCtor instanceof objCtor&&typeof othCtor=='function'&&othCtor instanceof othCtor))return!1;}return!0;}var keys=require('../object/keys');var objectProto=Object.prototype;var hasOwnProperty=objectProto.hasOwnProperty;module.exports=equalObjects;},{'../object/keys':432}],408:[function(require,module,exports){'use strict';var baseProperty=require('./baseProperty');var getLength=baseProperty('length');module.exports=getLength;},{'./baseProperty':390}],409:[function(require,module,exports){'use strict';function getMatchData(object){var result=pairs(object),length=result.length;while(length--)result[length][2]=isStrictComparable(result[length][1]);return result;}var isStrictComparable=require('./isStrictComparable'),pairs=require('../object/pairs');module.exports=getMatchData;},{'../object/pairs':434,'./isStrictComparable':418}],410:[function(require,module,exports){'use strict';function getNative(object,key){var value=object==null?undefined:object[key];return isNative(value)?value:undefined;}var isNative=require('../lang/isNative');module.exports=getNative;},{'../lang/isNative':426}],411:[function(require,module,exports){'use strict';function indexOfNaN(array,fromIndex,fromRight){var length=array.length,index=fromIndex+(fromRight?0:-1);while(fromRight?index--:++index<length){var other=array[index];if(other!==other)return index;}return-1;}module.exports=indexOfNaN;},{}],412:[function(require,module,exports){'use strict';function isArrayLike(value){return value!=null&&isLength(getLength(value));}var getLength=require('./getLength'),isLength=require('./isLength');module.exports=isArrayLike;},{'./getLength':408,'./isLength':416}],413:[function(require,module,exports){'use strict';function isIndex(value,length){return value=typeof value=='number'||reIsUint.test(value)?+value:-1,length=length==null?MAX_SAFE_INTEGER:length,value>-1&&value%1==0&&value<length;}var reIsUint=/^\d+$/;var MAX_SAFE_INTEGER=9007199254740991;module.exports=isIndex;},{}],414:[function(require,module,exports){'use strict';function isIterateeCall(value,index,object){if(!isObject(object))return!1;var type=index===void 0?'undefined':_typeof(index);if(type=='number'?isArrayLike(object)&&isIndex(index,object.length):type=='string'&&index in object){var other=object[index];return value===value?value===other:other!==other;}return!1;}var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj;};var isArrayLike=require('./isArrayLike'),isIndex=require('./isIndex'),isObject=require('../lang/isObject');module.exports=isIterateeCall;},{'../lang/isObject':427,'./isArrayLike':412,'./isIndex':413}],415:[function(require,module,exports){'use strict';function isKey(value,object){var type=value===void 0?'undefined':_typeof(value);if(type=='string'&&reIsPlainProp.test(value)||type=='number')return!0;if(isArray(value))return!1;var result=!reIsDeepProp.test(value);return result||object!=null&&value in toObject(object);}var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj;};var isArray=require('../lang/isArray'),toObject=require('./toObject');var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;module.exports=isKey;},{'../lang/isArray':423,'./toObject':420}],416:[function(require,module,exports){'use strict';function isLength(value){return typeof value=='number'&&value>-1&&value%1==0&&value<=MAX_SAFE_INTEGER;}var MAX_SAFE_INTEGER=9007199254740991;module.exports=isLength;},{}],417:[function(require,module,exports){'use strict';function isObjectLike(value){return!!value&&(value===void 0?'undefined':_typeof(value))=='object';}var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj;};module.exports=isObjectLike;},{}],418:[function(require,module,exports){'use strict';function isStrictComparable(value){return value===value&&!isObject(value);}var isObject=require('../lang/isObject');module.exports=isStrictComparable;},{'../lang/isObject':427}],419:[function(require,module,exports){'use strict';function shimKeys(object){var props=keysIn(object),propsLength=props.length,length=propsLength&&object.length;var allowIndexes=!!length&&isLength(length)&&(isArray(object)||isArguments(object));var index=-1,result=[];while(++index<propsLength){var key=props[index];(allowIndexes&&isIndex(key,length)||hasOwnProperty.call(object,key))&&result.push(key);}return result;}var isArguments=require('../lang/isArguments'),isArray=require('../lang/isArray'),isIndex=require('./isIndex'),isLength=require('./isLength'),keysIn=require('../object/keysIn');var objectProto=Object.prototype;var hasOwnProperty=objectProto.hasOwnProperty;module.exports=shimKeys;},{'../lang/isArguments':422,'../lang/isArray':423,'../object/keysIn':433,'./isIndex':413,'./isLength':416}],420:[function(require,module,exports){'use strict';function toObject(value){return isObject(value)?value:Object(value);}var isObject=require('../lang/isObject');module.exports=toObject;},{'../lang/isObject':427}],421:[function(require,module,exports){'use strict';function toPath(value){if(isArray(value))return value;var result=[];return baseToString(value).replace(rePropName,function(match,number,quote,string){result.push(quote?string.replace(reEscapeChar,'$1'):number||match);}),result;}var baseToString=require('./baseToString'),isArray=require('../lang/isArray');var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g;var reEscapeChar=/\\(\\)?/g;module.exports=toPath;},{'../lang/isArray':423,'./baseToString':393}],422:[function(require,module,exports){'use strict';function isArguments(value){return isObjectLike(value)&&isArrayLike(value)&&hasOwnProperty.call(value,'callee')&&!propertyIsEnumerable.call(value,'callee');}var isArrayLike=require('../internal/isArrayLike'),isObjectLike=require('../internal/isObjectLike');var objectProto=Object.prototype;var hasOwnProperty=objectProto.hasOwnProperty;var propertyIsEnumerable=objectProto.propertyIsEnumerable;module.exports=isArguments;},{'../internal/isArrayLike':412,'../internal/isObjectLike':417}],423:[function(require,module,exports){'use strict';var getNative=require('../internal/getNative'),isLength=require('../internal/isLength'),isObjectLike=require('../internal/isObjectLike');var arrayTag='[object Array]';var objectProto=Object.prototype;var objToString=objectProto.toString;var nativeIsArray=getNative(Array,'isArray');var isArray=nativeIsArray||function(value){return isObjectLike(value)&&isLength(value.length)&&objToString.call(value)==arrayTag;};module.exports=isArray;},{'../internal/getNative':410,'../internal/isLength':416,'../internal/isObjectLike':417}],424:[function(require,module,exports){'use strict';function isEmpty(value){return value==null?!0:isArrayLike(value)&&(isArray(value)||isString(value)||isArguments(value)||isObjectLike(value)&&isFunction(value.splice))?!value.length:!keys(value).length;}var isArguments=require('./isArguments'),isArray=require('./isArray'),isArrayLike=require('../internal/isArrayLike'),isFunction=require('./isFunction'),isObjectLike=require('../internal/isObjectLike'),isString=require('./isString'),keys=require('../object/keys');module.exports=isEmpty;},{'../internal/isArrayLike':412,'../internal/isObjectLike':417,'../object/keys':432,'./isArguments':422,'./isArray':423,'./isFunction':425,'./isString':428}],425:[function(require,module,exports){'use strict';function isFunction(value){return isObject(value)&&objToString.call(value)==funcTag;}var isObject=require('./isObject');var funcTag='[object Function]';var objectProto=Object.prototype;var objToString=objectProto.toString;module.exports=isFunction;},{'./isObject':427}],426:[function(require,module,exports){'use strict';function isNative(value){return value==null?!1:isFunction(value)?reIsNative.test(fnToString.call(value)):isObjectLike(value)&&reIsHostCtor.test(value);}var isFunction=require('./isFunction'),isObjectLike=require('../internal/isObjectLike');var reIsHostCtor=/^\[object .+?Constructor\]$/;var objectProto=Object.prototype;var fnToString=Function.prototype.toString;var hasOwnProperty=objectProto.hasOwnProperty;var reIsNative=RegExp('^'+fnToString.call(hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,'\\$&').replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,'$1.*?')+'$');module.exports=isNative;},{'../internal/isObjectLike':417,'./isFunction':425}],427:[function(require,module,exports){'use strict';function isObject(value){var type=value===void 0?'undefined':_typeof(value);return!!value&&(type=='object'||type=='function');}var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj;};module.exports=isObject;},{}],428:[function(require,module,exports){'use strict';function isString(value){return typeof value=='string'||isObjectLike(value)&&objToString.call(value)==stringTag;}var isObjectLike=require('../internal/isObjectLike');var stringTag='[object String]';var objectProto=Object.prototype;var objToString=objectProto.toString;module.exports=isString;},{'../internal/isObjectLike':417}],429:[function(require,module,exports){'use strict';function isTypedArray(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[objToString.call(value)];}var isLength=require('../internal/isLength'),isObjectLike=require('../internal/isObjectLike');var argsTag='[object Arguments]',arrayTag='[object Array]',boolTag='[object Boolean]',dateTag='[object Date]',errorTag='[object Error]',funcTag='[object Function]',mapTag='[object Map]',numberTag='[object Number]',objectTag='[object Object]',regexpTag='[object RegExp]',setTag='[object Set]',stringTag='[object String]',weakMapTag='[object WeakMap]';var arrayBufferTag='[object ArrayBuffer]',float32Tag='[object Float32Array]',float64Tag='[object Float64Array]',int8Tag='[object Int8Array]',int16Tag='[object Int16Array]',int32Tag='[object Int32Array]',uint8Tag='[object Uint8Array]',uint8ClampedTag='[object Uint8ClampedArray]',uint16Tag='[object Uint16Array]',uint32Tag='[object Uint32Array]';var typedArrayTags={};typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;var objectProto=Object.prototype;var objToString=objectProto.toString;module.exports=isTypedArray;},{'../internal/isLength':416,'../internal/isObjectLike':417}],430:[function(require,module,exports){'use strict';var assignWith=require('../internal/assignWith'),baseAssign=require('../internal/baseAssign'),createAssigner=require('../internal/createAssigner');var assign=createAssigner(function(object,source,customizer){return customizer?assignWith(object,source,customizer):baseAssign(object,source);});module.exports=assign;},{'../internal/assignWith':369,'../internal/baseAssign':370,'../internal/createAssigner':399}],431:[function(require,module,exports){'use strict';function get(object,path,defaultValue){var result=object==null?undefined:baseGet(object,toPath(path),path+'');return result===undefined?defaultValue:result;}var baseGet=require('../internal/baseGet'),toPath=require('../internal/toPath');module.exports=get;},{'../internal/baseGet':382,'../internal/toPath':421}],432:[function(require,module,exports){'use strict';var getNative=require('../internal/getNative'),isArrayLike=require('../internal/isArrayLike'),isObject=require('../lang/isObject'),shimKeys=require('../internal/shimKeys');var nativeKeys=getNative(Object,'keys');var keys=nativeKeys?function(object){var Ctor=object==null?undefined:object.constructor;return typeof Ctor=='function'&&Ctor.prototype===object||typeof object!='function'&&isArrayLike(object)?shimKeys(object):isObject(object)?nativeKeys(object):[];}:shimKeys;module.exports=keys;},{'../internal/getNative':410,'../internal/isArrayLike':412,'../internal/shimKeys':419,'../lang/isObject':427}],433:[function(require,module,exports){'use strict';function keysIn(object){if(object==null)return[];isObject(object)||(object=Object(object));var length=object.length;length=length&&isLength(length)&&(isArray(object)||isArguments(object))&&length||0;var Ctor=object.constructor,index=-1,isProto=typeof Ctor=='function'&&Ctor.prototype===object,result=Array(length),skipIndexes=length>0;while(++index<length)result[index]=index+'';for(var key in object)skipIndexes&&isIndex(key,length)||key=='constructor'&&(isProto||!hasOwnProperty.call(object,key))||result.push(key);return result;}var isArguments=require('../lang/isArguments'),isArray=require('../lang/isArray'),isIndex=require('../internal/isIndex'),isLength=require('../internal/isLength'),isObject=require('../lang/isObject');var objectProto=Object.prototype;var hasOwnProperty=objectProto.hasOwnProperty;module.exports=keysIn;},{'../internal/isIndex':413,'../internal/isLength':416,'../lang/isArguments':422,'../lang/isArray':423,'../lang/isObject':427}],434:[function(require,module,exports){'use strict';function pairs(object){object=toObject(object);var index=-1,props=keys(object),length=props.length,result=Array(length);while(++index<length){var key=props[index];result[index]=[key,object[key]];}return result;}var keys=require('./keys'),toObject=require('../internal/toObject');module.exports=pairs;},{'../internal/toObject':420,'./keys':432}],435:[function(require,module,exports){'use strict';function transform(object,iteratee,accumulator,thisArg){var isArr=isArray(object)||isTypedArray(object);if(iteratee=baseCallback(iteratee,thisArg,4),accumulator==null)if(isArr||isObject(object)){var Ctor=object.constructor;isArr?accumulator=isArray(object)?new Ctor():[]:accumulator=baseCreate(isFunction(Ctor)?Ctor.prototype:undefined);}else accumulator={};return(isArr?arrayEach:baseForOwn)(object,function(value,index,object){return iteratee(accumulator,value,index,object);}),accumulator;}var arrayEach=require('../internal/arrayEach'),baseCallback=require('../internal/baseCallback'),baseCreate=require('../internal/baseCreate'),baseForOwn=require('../internal/baseForOwn'),isArray=require('../lang/isArray'),isFunction=require('../lang/isFunction'),isObject=require('../lang/isObject'),isTypedArray=require('../lang/isTypedArray');module.exports=transform;},{'../internal/arrayEach':364,'../internal/baseCallback':371,'../internal/baseCreate':373,'../internal/baseForOwn':381,'../lang/isArray':423,'../lang/isFunction':425,'../lang/isObject':427,'../lang/isTypedArray':429}],436:[function(require,module,exports){'use strict';function identity(value){return value;}module.exports=identity;},{}],437:[function(require,module,exports){'use strict';function property(path){return isKey(path)?baseProperty(path):basePropertyDeep(path);}var baseProperty=require('../internal/baseProperty'),basePropertyDeep=require('../internal/basePropertyDeep'),isKey=require('../internal/isKey');module.exports=property;},{'../internal/baseProperty':390,'../internal/basePropertyDeep':391,'../internal/isKey':415}],438:[function(require,module,exports){'use strict';function flatten(arr){return Array.prototype.concat.apply([],arr);}function isUndefined(obj){return obj===null||obj===undefined;}function isDefined(obj){return obj!==null||obj!==undefined;}function isArray(obj){return nativeToString.call(obj)==='[object Array]';}function isObject(obj){return nativeToString.call(obj)==='[object Object]';}function isNumber(obj){return nativeToString.call(obj)==='[object Number]';}function isFunction(obj){return nativeToString.call(obj)==='[object Function]';}function isString(obj){return nativeToString.call(obj)==='[object String]';}function ensureArray(obj){if(isArray(obj))return;throw new Error('must supply array');}function has(target,key){return nativeHasOwnProperty.call(target,key);}function find(collection,matcher){matcher=toMatcher(matcher);var match;return forEach(collection,function(val,key){return matcher(val,key)?(match=val,!1):void 0;}),match;}function findIndex(collection,matcher){matcher=toMatcher(matcher);var idx=isArray(collection)?-1:undefined;return forEach(collection,function(val,key){return matcher(val,key)?(idx=key,!1):void 0;}),idx;}function filter(collection,matcher){var result=[];return forEach(collection,function(val,key){matcher(val,key)&&result.push(val);}),result;}function forEach(collection,iterator){if(isUndefined(collection))return;var convertKey=isArray(collection)?toNum:identity;for(var key in collection)if(has(collection,key)){var val=collection[key];var result=iterator(val,convertKey(key));if(result===!1)return;}}function without(arr,matcher){return isUndefined(arr)?[]:(ensureArray(arr),matcher=toMatcher(matcher),arr.filter(function(el,idx){return!matcher(el,idx);}));}function reduce(collection,iterator,result){return forEach(collection,function(value,idx){result=iterator(result,value,idx);}),result;}function every(collection,matcher){return reduce(collection,function(matches,val,key){return matches&&matcher(val,key);},!0);}function some(collection,matcher){return!!find(collection,matcher);}function map(collection,fn){var result=[];return forEach(collection,function(val,key){result.push(fn(val,key));}),result;}function keys(collection){return collection&&Object.keys(collection)||[];}function size(collection){return keys(collection).length;}function values(collection){return map(collection,function(val){return val;});}function groupBy(collection,extractor){var grouped=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return extractor=toExtractor(extractor),forEach(collection,function(val){var discriminator=extractor(val)||'_';var group=grouped[discriminator];group||(group=grouped[discriminator]=[]),group.push(val);}),grouped;}function uniqueBy(extractor){extractor=toExtractor(extractor);var grouped={};for(var _len=arguments.length,collections=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)collections[_key-1]=arguments[_key];forEach(collections,function(c){return groupBy(c,extractor,grouped);});var result=map(grouped,function(val,key){return val[0];});return result;}function sortBy(collection,extractor){extractor=toExtractor(extractor);var sorted=[];return forEach(collection,function(value,key){var disc=extractor(value,key);var entry={d:disc,v:value};for(var idx=0;idx<sorted.length;idx++){var d=sorted[idx].d;if(disc<d){sorted.splice(idx,0,entry);return;}}sorted.push(entry);}),map(sorted,function(e){return e.v;});}function matchPattern(pattern){return function(el){return every(pattern,function(val,key){return el[key]===val;});};}function toExtractor(extractor){return isFunction(extractor)?extractor:function(e){return e[extractor];};}function toMatcher(matcher){return isFunction(matcher)?matcher:function(e){return e===matcher;};}function identity(arg){return arg;}function toNum(arg){return Number(arg);}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2;}else return Array.from(arr);}function debounce(fn,timeout){var timer;return function(){var args=slice.call(arguments);timer&&clearTimeout(timer),timer=setTimeout(function(){fn.apply(undefined,_toConsumableArray(args));},timeout);};}function bind(fn,target){return fn.bind(target);}function assign(target){for(var _len=arguments.length,others=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)others[_key-1]=arguments[_key];return _extends.apply(undefined,[target].concat(others));}function pick(target,properties){var result={};var obj=Object(target);return forEach(properties,function(prop){prop in obj&&(result[prop]=target[prop]);}),result;}function omit(target,properties){var result={};var obj=Object(target);return forEach(obj,function(prop,key){properties.indexOf(key)===-1&&(result[key]=prop);}),result;}function merge(target){for(var _len2=arguments.length,sources=Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++)sources[_key2-1]=arguments[_key2];return sources.length?(forEach(sources,function(source){if(!(source&&isObject(source)))return;forEach(source,function(sourceVal,key){var targetVal=target[key];isObject(sourceVal)?(isObject(targetVal)||(targetVal={}),target[key]=merge(targetVal,sourceVal)):target[key]=sourceVal;});}),target):target;}Object.defineProperty(exports,'__esModule',{value:!0});var nativeToString=Object.prototype.toString;var nativeHasOwnProperty=Object.prototype.hasOwnProperty;var unionBy=uniqueBy;var slice=Array.prototype.slice;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key]);}return target;};exports.flatten=flatten,exports.find=find,exports.findIndex=findIndex,exports.filter=filter,exports.forEach=forEach,exports.without=without,exports.reduce=reduce,exports.every=every,exports.some=some,exports.map=map,exports.keys=keys,exports.size=size,exports.values=values,exports.groupBy=groupBy,exports.uniqueBy=uniqueBy,exports.unionBy=unionBy,exports.sortBy=sortBy,exports.matchPattern=matchPattern,exports.debounce=debounce,exports.bind=bind,exports.isUndefined=isUndefined,exports.isDefined=isDefined,exports.isArray=isArray,exports.isObject=isObject,exports.isNumber=isNumber,exports.isFunction=isFunction,exports.isString=isString,exports.ensureArray=ensureArray,exports.has=has,exports.assign=assign,exports.pick=pick,exports.omit=omit,exports.merge=merge;},{}],439:[function(require,module,exports){'use strict';function attr(el,name,val){return arguments.length==2?el.getAttribute(name):val===null?el.removeAttribute(name):(el.setAttribute(name,val),el);}function classes(el){return new ClassList(el);}function ClassList(el){if(!(el&&el.nodeType))throw new Error('A DOM element reference is required');this.el=el,this.list=el.classList;}function clear(el){var c;while(el.childNodes.length)c=el.childNodes[0],el.removeChild(c);return el;}function match(el,selector){if(vendor)return vendor.call(el,selector);var nodes=el.parentNode.querySelectorAll(selector);for(var i=0;i<nodes.length;++i)if(nodes[i]==el)return!0;return!1;}function parse(html,doc){if('string'!=typeof html)throw new TypeError('String expected');doc||(doc=document);var m=/<([\w:]+)/.exec(html);if(!m)return doc.createTextNode(html);html=html.replace(/^\s+|\s+$/g,'');var tag=m[1];if(tag=='body'){var el=doc.createElement('html');return el.innerHTML=html,el.removeChild(el.lastChild);}var wrap=map[tag]||map._default;var depth=wrap[0];var prefix=wrap[1];var suffix=wrap[2];var el=doc.createElement('div');el.innerHTML=prefix+html+suffix;while(depth--)el=el.lastChild;if(el.firstChild==el.lastChild)return el.removeChild(el.firstChild);var fragment=doc.createDocumentFragment();while(el.firstChild)fragment.appendChild(el.removeChild(el.firstChild));return fragment;}function match$1(el,selector){if(!el||el.nodeType!==1)return!1;if(vendor$1)return vendor$1.call(el,selector);var nodes=el.parentNode.querySelectorAll(selector);for(var i=0;i<nodes.length;i++)if(nodes[i]==el)return!0;return!1;}function query(selector,el){return el=el||document,el.querySelector(selector);}function all(selector,el){return el=el||document,el.querySelectorAll(selector);}function remove(el){el.parentNode&&el.parentNode.removeChild(el);}Object.defineProperty(exports,'__esModule',{value:!0});var indexOf=[].indexOf;var indexof=function indexof(arr,obj){if(indexOf)return arr.indexOf(obj);for(var i=0;i<arr.length;++i)if(arr[i]===obj)return i;return-1;};var re=/\s+/;var toString=Object.prototype.toString;ClassList.prototype.add=function(name){if(this.list)return this.list.add(name),this;var arr=this.array();var i=indexof(arr,name);return~i||arr.push(name),this.el.className=arr.join(' '),this;},ClassList.prototype.remove=function(name){if('[object RegExp]'==toString.call(name))return this.removeMatching(name);if(this.list)return this.list.remove(name),this;var arr=this.array();var i=indexof(arr,name);return~i&&arr.splice(i,1),this.el.className=arr.join(' '),this;},ClassList.prototype.removeMatching=function(re){var arr=this.array();for(var i=0;i<arr.length;i++)re.test(arr[i])&&this.remove(arr[i]);return this;},ClassList.prototype.toggle=function(name,force){return this.list?(void 0!==force?force!==this.list.toggle(name,force)&&this.list.toggle(name):this.list.toggle(name),this):(void 0!==force?force?this.add(name):this.remove(name):this.has(name)?this.remove(name):this.add(name),this);},ClassList.prototype.array=function(){var className=this.el.getAttribute('class')||'';var str=className.replace(/^\s+|\s+$/g,'');var arr=str.split(re);return''===arr[0]&&arr.shift(),arr;},ClassList.prototype.has=ClassList.prototype.contains=function(name){return this.list?this.list.contains(name):!!~indexof(this.array(),name);};var proto=Element.prototype;var vendor=proto.matchesSelector||proto.webkitMatchesSelector||proto.mozMatchesSelector||proto.msMatchesSelector||proto.oMatchesSelector;var matchesSelector=match;var closest=function closest(element,selector,checkYoSelf){var parent=checkYoSelf?element:element.parentNode;while(parent&&parent!==document){if(matchesSelector(parent,selector))return parent;parent=parent.parentNode;}};var bind=window.addEventListener?'addEventListener':'attachEvent',unbind=window.removeEventListener?'removeEventListener':'detachEvent',prefix=bind!=='addEventListener'?'on':'';var bind_1=function bind_1(el,type,fn,capture){return el[bind](prefix+type,fn,capture||!1),fn;};var unbind_1=function unbind_1(el,type,fn,capture){return el[unbind](prefix+type,fn,capture||!1),fn;};var componentEvent={bind:bind_1,unbind:unbind_1};var forceCaptureEvents=['focus','blur'];var bind$1=function bind$1(el,selector,type,fn,capture){return forceCaptureEvents.indexOf(type)!==-1&&(capture=!0),componentEvent.bind(el,type,function(e){var target=e.target||e.srcElement;e.delegateTarget=closest(target,selector,!0,el),e.delegateTarget&&fn.call(el,e);},capture);};var unbind$1=function unbind$1(el,type,fn,capture){forceCaptureEvents.indexOf(type)!==-1&&(capture=!0),componentEvent.unbind(el,type,fn,capture);};var delegateEvents={bind:bind$1,unbind:unbind$1};var domify=parse;var innerHTMLBug=!1;var bugTestDiv;typeof document!=='undefined'&&(bugTestDiv=document.createElement('div'),bugTestDiv.innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',innerHTMLBug=!bugTestDiv.getElementsByTagName('link').length,bugTestDiv=undefined);var map={legend:[1,'<fieldset>','</fieldset>'],tr:[2,'<table><tbody>','</tbody></table>'],col:[2,'<table><tbody></tbody><colgroup>','</colgroup></table>'],_default:innerHTMLBug?[1,'X<div>','</div>']:[0,'','']};map.td=map.th=[3,'<table><tbody><tr>','</tr></tbody></table>'],map.option=map.optgroup=[1,'<select multiple="multiple">','</select>'],map.thead=map.tbody=map.colgroup=map.caption=map.tfoot=[1,'<table>','</table>'],map.polyline=map.ellipse=map.polygon=map.circle=map.text=map.line=map.path=map.rect=map.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">','</svg>'];var proto$1=typeof Element!=='undefined'?Element.prototype:{};var vendor$1=proto$1.matches||proto$1.matchesSelector||proto$1.webkitMatchesSelector||proto$1.mozMatchesSelector||proto$1.msMatchesSelector||proto$1.oMatchesSelector;var matchesSelector$1=match$1;exports.attr=attr,exports.classes=classes,exports.clear=clear,exports.closest=closest,exports.delegate=delegateEvents,exports.domify=domify,exports.event=componentEvent,exports.matches=matchesSelector$1,exports.query=query,exports.queryAll=all,exports.remove=remove;},{}],440:[function(require,module,exports){'use strict';Object.defineProperty(exports,'__esModule',{value:!0});var _read=require('./lib/read');Object.defineProperty(exports,'Reader',{enumerable:!0,get:function get(){return _read.Reader;}});var _write=require('./lib/write');Object.defineProperty(exports,'Writer',{enumerable:!0,get:function get(){return _write.Writer;}});},{'./lib/read':442,'./lib/write':443}],441:[function(require,module,exports){'use strict';function hasLowerCaseAlias(pkg){return pkg.xml&&pkg.xml.tagAlias==='lowerCase';}function serializeFormat(element){return element.xml&&element.xml.serialize;}function serializeAsType(element){return serializeFormat(element)===XSI_TYPE;}function serializeAsProperty(element){return serializeFormat(element)==='property';}Object.defineProperty(exports,'__esModule',{value:!0}),exports.hasLowerCaseAlias=hasLowerCaseAlias,exports.serializeAsType=serializeAsType,exports.serializeAsProperty=serializeAsProperty;var DEFAULT_NS_MAP=exports.DEFAULT_NS_MAP={xsi:'http://www.w3.org/2001/XMLSchema-instance'};var XSI_TYPE=exports.XSI_TYPE='xsi:type';},{}],442:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function capitalize(str){return str.charAt(0).toUpperCase()+str.slice(1);}function aliasToName(aliasNs,pkg){return(0,_common.hasLowerCaseAlias)(pkg)?aliasNs.prefix+':'+capitalize(aliasNs.localName):aliasNs.name;}function prefixedToName(nameNs,pkg){var name=nameNs.name,localName=nameNs.localName;var typePrefix=pkg.xml&&pkg.xml.typePrefix;return typePrefix&&localName.indexOf(typePrefix)===0?nameNs.prefix+':'+localName.slice(typePrefix.length):name;}function normalizeXsiTypeName(name,model){var nameNs=(0,_ns.parseName)(name);var pkg=model.getPackage(nameNs.prefix);return prefixedToName(nameNs,pkg);}function error(message){return new Error(message);}function getModdleDescriptor(element){return element.$descriptor;}function defer(fn){setTimeout(fn,0);}function Context(options){(0,_minDash.assign)(this,options),this.elementsById={},this.references=[],this.warnings=[],this.addReference=function(reference){this.references.push(reference);},this.addElement=function(element){if(!element)throw error('expected element');var elementsById=this.elementsById;var descriptor=getModdleDescriptor(element);var idProperty=descriptor.idProperty,id;if(idProperty&&(id=element.get(idProperty.name),id)){if(elementsById[id])throw error('duplicate ID <'+id+'>');elementsById[id]=element;}},this.addWarning=function(warning){this.warnings.push(warning);};}function BaseHandler(){}function NoopHandler(){}function BodyHandler(){}function ReferenceHandler(property,context){this.property=property,this.context=context;}function ValueHandler(propertyDesc,element){this.element=element,this.propertyDesc=propertyDesc;}function BaseElementHandler(){}function ElementHandler(model,typeName,context){this.model=model,this.type=model.getType(typeName),this.context=context;}function RootElementHandler(model,typeName,context){ElementHandler.call(this,model,typeName,context);}function GenericElementHandler(model,typeName,context){this.model=model,this.context=context;}function Reader(options){options instanceof _moddle2.default&&(options={model:options}),(0,_minDash.assign)(this,{lax:!1},options);}Object.defineProperty(exports,'__esModule',{value:!0}),exports.Context=Context,exports.ElementHandler=ElementHandler,exports.Reader=Reader;var _minDash=require('min-dash');var _tinyStack=require('tiny-stack');var _tinyStack2=_interopRequireDefault(_tinyStack);var _saxen=require('saxen');var _moddle=require('moddle');var _moddle2=_interopRequireDefault(_moddle);var _ns=require('moddle/lib/ns');var _types=require('moddle/lib/types');var _common=require('./common');BaseHandler.prototype.handleEnd=function(){},BaseHandler.prototype.handleText=function(){},BaseHandler.prototype.handleNode=function(){},NoopHandler.prototype=Object.create(BaseHandler.prototype),NoopHandler.prototype.handleNode=function(){return this;},BodyHandler.prototype=Object.create(BaseHandler.prototype),BodyHandler.prototype.handleText=function(text){this.body=(this.body||'')+text;},ReferenceHandler.prototype=Object.create(BodyHandler.prototype),ReferenceHandler.prototype.handleNode=function(node){if(this.element)throw error('expected no sub nodes');else this.element=this.createReference(node);return this;},ReferenceHandler.prototype.handleEnd=function(){this.element.id=this.body;},ReferenceHandler.prototype.createReference=function(node){return{property:this.property.ns.name,id:''};},ValueHandler.prototype=Object.create(BodyHandler.prototype),ValueHandler.prototype.handleEnd=function(){var value=this.body||'',element=this.element,propertyDesc=this.propertyDesc;value=(0,_types.coerceType)(propertyDesc.type,value),propertyDesc.isMany?element.get(propertyDesc.name).push(value):element.set(propertyDesc.name,value);},BaseElementHandler.prototype=Object.create(BodyHandler.prototype),BaseElementHandler.prototype.handleNode=function(node){var parser=this,element=this.element;return element?parser=this.handleChild(node):(element=this.element=this.createElement(node),this.context.addElement(element)),parser;},ElementHandler.prototype=Object.create(BaseElementHandler.prototype),ElementHandler.prototype.addReference=function(reference){this.context.addReference(reference);},ElementHandler.prototype.handleEnd=function(){var value=this.body,element=this.element,descriptor=getModdleDescriptor(element),bodyProperty=descriptor.bodyProperty;bodyProperty&&value!==undefined&&(value=(0,_types.coerceType)(bodyProperty.type,value),element.set(bodyProperty.name,value));},ElementHandler.prototype.createElement=function(node){var attributes=node.attributes,Type=this.type,descriptor=getModdleDescriptor(Type),context=this.context,instance=new Type({}),model=this.model,propNameNs;return(0,_minDash.forEach)(attributes,function(value,name){var prop=descriptor.propertiesByName[name],values;prop&&prop.isReference?prop.isMany?(values=value.split(' '),(0,_minDash.forEach)(values,function(v){context.addReference({element:instance,property:prop.ns.name,id:v});})):context.addReference({element:instance,property:prop.ns.name,id:value}):(prop?value=(0,_types.coerceType)(prop.type,value):name!=='xmlns'&&(propNameNs=(0,_ns.parseName)(name,descriptor.ns.prefix),model.getPackage(propNameNs.prefix)&&context.addWarning({message:'unknown attribute <'+name+'>',element:instance,property:name,value:value})),instance.set(name,value));}),instance;},ElementHandler.prototype.getPropertyForNode=function(node){var name=node.name;var nameNs=(0,_ns.parseName)(name);var type=this.type,model=this.model,descriptor=getModdleDescriptor(type);var propertyName=nameNs.name,property=descriptor.propertiesByName[propertyName],elementTypeName,elementType;if(property)return(0,_common.serializeAsType)(property)&&(elementTypeName=node.attributes[_common.XSI_TYPE],elementTypeName)?(elementTypeName=normalizeXsiTypeName(elementTypeName,model),elementType=model.getType(elementTypeName),(0,_minDash.assign)({},property,{effectiveType:getModdleDescriptor(elementType).name})):property;var pkg=model.getPackage(nameNs.prefix);if(pkg){if(elementTypeName=aliasToName(nameNs,pkg),elementType=model.getType(elementTypeName),property=(0,_minDash.find)(descriptor.properties,function(p){return!p.isVirtual&&!p.isReference&&!p.isAttribute&&elementType.hasType(p.type);}),property)return(0,_minDash.assign)({},property,{effectiveType:getModdleDescriptor(elementType).name});}else if(property=(0,_minDash.find)(descriptor.properties,function(p){return!p.isReference&&!p.isAttribute&&p.type==='Element';}),property)return property;throw error('unrecognized element <'+nameNs.name+'>');},ElementHandler.prototype.toString=function(){return'ElementDescriptor['+getModdleDescriptor(this.type).name+']';},ElementHandler.prototype.valueHandler=function(propertyDesc,element){return new ValueHandler(propertyDesc,element);},ElementHandler.prototype.referenceHandler=function(propertyDesc){return new ReferenceHandler(propertyDesc,this.context);},ElementHandler.prototype.handler=function(type){return type==='Element'?new GenericElementHandler(this.model,type,this.context):new ElementHandler(this.model,type,this.context);},ElementHandler.prototype.handleChild=function(node){var propertyDesc,type,element,childHandler;if(propertyDesc=this.getPropertyForNode(node),element=this.element,type=propertyDesc.effectiveType||propertyDesc.type,(0,_types.isSimple)(type))return this.valueHandler(propertyDesc,element);propertyDesc.isReference?childHandler=this.referenceHandler(propertyDesc).handleNode(node):childHandler=this.handler(type).handleNode(node);var newElement=childHandler.element;return newElement!==undefined&&(propertyDesc.isMany?element.get(propertyDesc.name).push(newElement):element.set(propertyDesc.name,newElement),propertyDesc.isReference?((0,_minDash.assign)(newElement,{element:element}),this.context.addReference(newElement)):newElement.$parent=element),childHandler;},RootElementHandler.prototype=Object.create(ElementHandler.prototype),RootElementHandler.prototype.createElement=function(node){var name=node.name,nameNs=(0,_ns.parseName)(name),model=this.model,type=this.type,pkg=model.getPackage(nameNs.prefix),typeName=pkg&&aliasToName(nameNs,pkg)||name;if(!type.hasType(typeName))throw error('unexpected element <'+node.originalName+'>');return ElementHandler.prototype.createElement.call(this,node);},GenericElementHandler.prototype=Object.create(BaseElementHandler.prototype),GenericElementHandler.prototype.createElement=function(node){var name=node.name,ns=(0,_ns.parseName)(name),prefix=ns.prefix,uri=node.ns[prefix+'$uri'],attributes=node.attributes;return this.model.createAny(name,uri,attributes);},GenericElementHandler.prototype.handleChild=function(node){var handler=new GenericElementHandler(this.model,'Element',this.context).handleNode(node),element=this.element;var newElement=handler.element,children;return newElement!==undefined&&(children=element.$children=element.$children||[],children.push(newElement),newElement.$parent=element),handler;},GenericElementHandler.prototype.handleText=function(text){this.body=this.body||''+text;},GenericElementHandler.prototype.handleEnd=function(){this.body&&(this.element.$body=this.body);},Reader.prototype.fromXML=function(xml,options,done){function handleError(err,getContext,lax){var ctx=getContext();var line=ctx.line,column=ctx.column,data=ctx.data;data.charAt(0)==='<'&&data.indexOf(' ')!==-1&&(data=data.slice(0,data.indexOf(' '))+'>');var message='unparsable content '+(data?data+' ':'')+'detected\n\t'+'line: '+line+'\n\t'+'column: '+column+'\n\t'+'nested error: '+err.message;if(lax)return context.addWarning({message:message,error:err}),console.warn('could not parse node'),console.warn(err),!0;else throw console.error('could not parse document'),console.error(err),error(message);}function handleWarning(err,getContext){return handleError(err,getContext,!0);}function resolveReferences(){var elementsById=context.elementsById;var references=context.references;var i,r;for(i=0;r=references[i];i++){var element=r.element;var reference=elementsById[r.id];var property=getModdleDescriptor(element).propertiesByName[r.property];if(reference||context.addWarning({message:'unresolved reference <'+r.id+'>',element:r.element,property:r.property,value:r.id}),property.isMany){var collection=element.get(property.name),idx=collection.indexOf(r);idx===-1&&(idx=collection.length),reference?collection[idx]=reference:collection.splice(idx,1);}else element.set(property.name,reference);}}function handleClose(){stack.pop().handleEnd();}function handleQuestion(question){if(!PREAMBLE_START_PATTERN.test(question))return;var match=ENCODING_PATTERN.exec(question);var encoding=match&&match[1];if(!encoding||UTF_8_PATTERN.test(encoding))return;context.addWarning({message:'unsupported document encoding <'+encoding+'>, '+'falling back to UTF-8'});}function handleOpen(node,getContext){var handler=stack.peek();try{stack.push(handler.handleNode(node));}catch(err){if(handleError(err,getContext,lax)){stack.push(new NoopHandler());}}}function handleCData(text){stack.peek().handleText(text);}function handleText(text){if(text=text.trim(),!text)return;stack.peek().handleText(text);}var rootHandler=options.rootHandler;options instanceof ElementHandler?(rootHandler=options,options={}):typeof options==='string'?(rootHandler=this.handler(options),options={}):typeof rootHandler==='string'&&(rootHandler=this.handler(rootHandler));var model=this.model,lax=this.lax;var context=new Context((0,_minDash.assign)({},options,{rootHandler:rootHandler})),parser=new _saxen.Parser({proxy:!0}),stack=new _tinyStack2.default();rootHandler.context=context,stack.push(rootHandler);var PREAMBLE_START_PATTERN=/^<\?xml /i;var ENCODING_PATTERN=/ encoding="([^"]+)"/i;var UTF_8_PATTERN=/^utf-8$/i;var uriMap=model.getPackages().reduce(function(uriMap,p){return uriMap[p.uri]=p.prefix,uriMap;},{});parser.ns(uriMap).on('openTag',function(obj,decodeStr,selfClosing,getContext){var attrs=obj.attrs||{};var decodedAttrs=Object.keys(attrs).reduce(function(d,key){var value=decodeStr(attrs[key]);return d[key]=value,d;},{});var node={name:obj.name,originalName:obj.originalName,attributes:decodedAttrs,ns:obj.ns};handleOpen(node,getContext);}).on('question',handleQuestion).on('closeTag',handleClose).on('cdata',handleCData).on('text',function(text,decodeEntities){handleText(decodeEntities(text));}).on('error',handleError).on('warn',handleWarning),defer(function(){var err;try{parser.parse(xml),resolveReferences();}catch(e){err=e;}var element=rootHandler.element;err||element||(err=error('failed to parse document as <'+rootHandler.type.$descriptor.name+'>')),done(err,err?undefined:element,context);});},Reader.prototype.handler=function(name){return new RootElementHandler(this.model,name);};},{'./common':441,'min-dash':438,moddle:444,'moddle/lib/ns':449,'moddle/lib/types':452,saxen:457,'tiny-stack':467}],443:[function(require,module,exports){'use strict';function Namespaces(parent){var prefixMap={};var uriMap={};var used={};var wellknown=[];var custom=[];this.byUri=function(uri){return uriMap[uri]||parent&&parent.byUri(uri);},this.add=function(ns,isWellknown){uriMap[ns.uri]=ns,isWellknown?wellknown.push(ns):custom.push(ns),this.mapPrefix(ns.prefix,ns.uri);},this.uriByPrefix=function(prefix){return prefixMap[prefix||'xmlns'];},this.mapPrefix=function(prefix,uri){prefixMap[prefix||'xmlns']=uri;},this.logUsed=function(ns){var uri=ns.uri;used[uri]=this.byUri(uri);},this.getUsed=function(ns){function isUsed(ns){return used[ns.uri];}var allNs=[].concat(wellknown,custom);return allNs.filter(isUsed);};}function lower(string){return string.charAt(0).toLowerCase()+string.slice(1);}function nameToAlias(name,pkg){return(0,_common.hasLowerCaseAlias)(pkg)?lower(name):name;}function inherits(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}});}function nsName(ns){return(0,_minDash.isString)(ns)?ns:(ns.prefix?ns.prefix+':':'')+ns.localName;}function getNsAttrs(namespaces){return(0,_minDash.map)(namespaces.getUsed(),function(ns){var name='xmlns'+(ns.prefix?':'+ns.prefix:'');return{name:name,value:ns.uri};});}function getElementNs(ns,descriptor){return descriptor.isGeneric?(0,_minDash.assign)({localName:descriptor.ns.localName},ns):(0,_minDash.assign)({localName:nameToAlias(descriptor.ns.localName,descriptor.$pkg)},ns);}function getPropertyNs(ns,descriptor){return(0,_minDash.assign)({localName:descriptor.ns.localName},ns);}function getSerializableProperties(element){var descriptor=element.$descriptor;return(0,_minDash.filter)(descriptor.properties,function(p){var name=p.name;if(p.isVirtual)return!1;if(!element.hasOwnProperty(name))return!1;var value=element[name];return value===p.default?!1:value===null?!1:p.isMany?value.length:!0;});}function escape(str,charPattern,replaceMap){return str=(0,_minDash.isString)(str)?str:''+str,str.replace(charPattern,function(s){return'&'+replaceMap[s]+';';});}function escapeAttr(str){return escape(str,ESCAPE_ATTR_CHARS,ESCAPE_ATTR_MAP);}function escapeBody(str){return escape(str,ESCAPE_CHARS,ESCAPE_MAP);}function filterAttributes(props){return(0,_minDash.filter)(props,function(p){return p.isAttr;});}function filterContained(props){return(0,_minDash.filter)(props,function(p){return!p.isAttr;});}function ReferenceSerializer(tagName){this.tagName=tagName;}function BodySerializer(){}function ValueSerializer(tagName){this.tagName=tagName;}function ElementSerializer(parent,propertyDescriptor){this.body=[],this.attrs=[],this.parent=parent,this.propertyDescriptor=propertyDescriptor;}function TypeSerializer(parent,propertyDescriptor){ElementSerializer.call(this,parent,propertyDescriptor);}function SavingWriter(){this.value='',this.write=function(str){this.value+=str;};}function FormatingWriter(out,format){var indent=[''];this.append=function(str){return out.write(str),this;},this.appendNewLine=function(){return format&&out.write('\n'),this;},this.appendIndent=function(){return format&&out.write(indent.join('  ')),this;},this.indent=function(){return indent.push(''),this;},this.unindent=function(){return indent.pop(),this;};}function Writer(options){function toXML(tree,writer){var internalWriter=writer||new SavingWriter();var formatingWriter=new FormatingWriter(internalWriter,options.format);return options.preamble&&formatingWriter.append(XML_PREAMBLE),new ElementSerializer().build(tree).serializeTo(formatingWriter),writer?void 0:internalWriter.value;}return options=(0,_minDash.assign)({format:!1,preamble:!0},options||{}),{toXML:toXML};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.Namespaces=Namespaces,exports.Writer=Writer;var _minDash=require('min-dash');var _types=require('moddle/lib/types');var _ns=require('moddle/lib/ns');var _common=require('./common');var XML_PREAMBLE='<?xml version="1.0" encoding="UTF-8"?>\n';var ESCAPE_ATTR_CHARS=/<|>|'|"|&|\n\r|\n/g;var ESCAPE_CHARS=/<|>|&/g;var ESCAPE_ATTR_MAP={'\n':'#10','\n\r':'#10','"':'#34',"'":'#39','<':'#60','>':'#62','&':'#38'};var ESCAPE_MAP={'<':'lt','>':'gt','&':'amp'};ReferenceSerializer.prototype.build=function(element){return this.element=element,this;},ReferenceSerializer.prototype.serializeTo=function(writer){writer.appendIndent().append('<'+this.tagName+'>'+this.element.id+'</'+this.tagName+'>').appendNewLine();},BodySerializer.prototype.serializeValue=BodySerializer.prototype.serializeTo=function(writer){writer.append(this.escape?escapeBody(this.value):this.value);},BodySerializer.prototype.build=function(prop,value){return this.value=value,prop.type==='String'&&value.search(ESCAPE_CHARS)!==-1&&(this.escape=!0),this;},inherits(ValueSerializer,BodySerializer),ValueSerializer.prototype.serializeTo=function(writer){writer.appendIndent().append('<'+this.tagName+'>'),this.serializeValue(writer),writer.append('</'+this.tagName+'>').appendNewLine();},ElementSerializer.prototype.build=function(element){this.element=element;var elementDescriptor=element.$descriptor,propertyDescriptor=this.propertyDescriptor;var otherAttrs,properties;var isGeneric=elementDescriptor.isGeneric;return isGeneric?otherAttrs=this.parseGeneric(element):otherAttrs=this.parseNsAttributes(element),propertyDescriptor?this.ns=this.nsPropertyTagName(propertyDescriptor):this.ns=this.nsTagName(elementDescriptor),this.tagName=this.addTagName(this.ns),isGeneric||(properties=getSerializableProperties(element),this.parseAttributes(filterAttributes(properties)),this.parseContainments(filterContained(properties))),this.parseGenericAttributes(element,otherAttrs),this;},ElementSerializer.prototype.nsTagName=function(descriptor){var effectiveNs=this.logNamespaceUsed(descriptor.ns);return getElementNs(effectiveNs,descriptor);},ElementSerializer.prototype.nsPropertyTagName=function(descriptor){var effectiveNs=this.logNamespaceUsed(descriptor.ns);return getPropertyNs(effectiveNs,descriptor);},ElementSerializer.prototype.isLocalNs=function(ns){return ns.uri===this.ns.uri;},ElementSerializer.prototype.nsAttributeName=function(element){var ns;if((0,_minDash.isString)(element)?ns=(0,_ns.parseName)(element):ns=element.ns,element.inherited)return{localName:ns.localName};var effectiveNs=this.logNamespaceUsed(ns);return this.getNamespaces().logUsed(effectiveNs),this.isLocalNs(effectiveNs)?{localName:ns.localName}:(0,_minDash.assign)({localName:ns.localName},effectiveNs);},ElementSerializer.prototype.parseGeneric=function(element){var self=this,body=this.body;var attributes=[];return(0,_minDash.forEach)(element,function(val,key){var nonNsAttr;key==='$body'?body.push(new BodySerializer().build({type:'String'},val)):key==='$children'?(0,_minDash.forEach)(val,function(child){body.push(new ElementSerializer(self).build(child));}):key.indexOf('$')!==0&&(nonNsAttr=self.parseNsAttribute(element,key,val),nonNsAttr&&attributes.push({name:key,value:val}));}),attributes;},ElementSerializer.prototype.parseNsAttribute=function(element,name,value){var model=element.$model;var nameNs=(0,_ns.parseName)(name);var ns;if(nameNs.prefix==='xmlns'&&(ns={prefix:nameNs.localName,uri:value}),!nameNs.prefix&&nameNs.localName==='xmlns'&&(ns={uri:value}),!ns)return{name:name,value:value};if(model&&model.getPackage(value))this.logNamespace(ns,!0,!0);else{var actualNs=this.logNamespaceUsed(ns,!0);this.getNamespaces().logUsed(actualNs);}},ElementSerializer.prototype.parseNsAttributes=function(element,attrs){var self=this;var genericAttrs=element.$attrs;var attributes=[];return(0,_minDash.forEach)(genericAttrs,function(value,name){var nonNsAttr=self.parseNsAttribute(element,name,value);nonNsAttr&&attributes.push(nonNsAttr);}),attributes;},ElementSerializer.prototype.parseGenericAttributes=function(element,attributes){var self=this;(0,_minDash.forEach)(attributes,function(attr){if(attr.name===_common.XSI_TYPE)return;try{self.addAttribute(self.nsAttributeName(attr.name),attr.value);}catch(e){console.warn('missing namespace information for ',attr.name,'=',attr.value,'on',element,e);}});},ElementSerializer.prototype.parseContainments=function(properties){var self=this,body=this.body,element=this.element;(0,_minDash.forEach)(properties,function(p){var value=element.get(p.name),isReference=p.isReference,isMany=p.isMany;if(isMany||(value=[value]),p.isBody)body.push(new BodySerializer().build(p,value[0]));else if((0,_types.isSimple)(p.type))(0,_minDash.forEach)(value,function(v){body.push(new ValueSerializer(self.addTagName(self.nsPropertyTagName(p))).build(p,v));});else if(isReference)(0,_minDash.forEach)(value,function(v){body.push(new ReferenceSerializer(self.addTagName(self.nsPropertyTagName(p))).build(v));});else{var asType=(0,_common.serializeAsType)(p),asProperty=(0,_common.serializeAsProperty)(p);(0,_minDash.forEach)(value,function(v){var serializer;asType?serializer=new TypeSerializer(self,p):asProperty?serializer=new ElementSerializer(self,p):serializer=new ElementSerializer(self),body.push(serializer.build(v));});}});},ElementSerializer.prototype.getNamespaces=function(local){var namespaces=this.namespaces,parent=this.parent,parentNamespaces;return namespaces||(parentNamespaces=parent&&parent.getNamespaces(),local||!parentNamespaces?this.namespaces=namespaces=new Namespaces(parentNamespaces):namespaces=parentNamespaces),namespaces;},ElementSerializer.prototype.logNamespace=function(ns,wellknown,local){var namespaces=this.getNamespaces(local);var nsUri=ns.uri,nsPrefix=ns.prefix;var existing=namespaces.byUri(nsUri);return existing||namespaces.add(ns,wellknown),namespaces.mapPrefix(nsPrefix,nsUri),ns;},ElementSerializer.prototype.logNamespaceUsed=function(ns,local){var element=this.element,model=element.$model,namespaces=this.getNamespaces(local);var prefix=ns.prefix,uri=ns.uri,newPrefix,idx,wellknownUri;if(!(prefix||uri))return{localName:ns.localName};if(wellknownUri=_common.DEFAULT_NS_MAP[prefix]||model&&(model.getPackage(prefix)||{}).uri,uri=uri||wellknownUri||namespaces.uriByPrefix(prefix),!uri)throw new Error('no namespace uri given for prefix <'+prefix+'>');if(ns=namespaces.byUri(uri),!ns){newPrefix=prefix,idx=1;while(namespaces.uriByPrefix(newPrefix))newPrefix=prefix+'_'+idx++;ns=this.logNamespace({prefix:newPrefix,uri:uri},wellknownUri===uri);}return prefix&&namespaces.mapPrefix(prefix,uri),ns;},ElementSerializer.prototype.parseAttributes=function(properties){var self=this,element=this.element;(0,_minDash.forEach)(properties,function(p){var value=element.get(p.name);if(p.isReference)if(!p.isMany)value=value.id;else{var values=[];(0,_minDash.forEach)(value,function(v){values.push(v.id);}),value=values.join(' ');}self.addAttribute(self.nsAttributeName(p),value);});},ElementSerializer.prototype.addTagName=function(nsTagName){var actualNs=this.logNamespaceUsed(nsTagName);return this.getNamespaces().logUsed(actualNs),nsName(nsTagName);},ElementSerializer.prototype.addAttribute=function(name,value){var attrs=this.attrs;(0,_minDash.isString)(value)&&(value=escapeAttr(value)),attrs.push({name:name,value:value});},ElementSerializer.prototype.serializeAttributes=function(writer){var attrs=this.attrs,namespaces=this.namespaces;namespaces&&(attrs=getNsAttrs(namespaces).concat(attrs)),(0,_minDash.forEach)(attrs,function(a){writer.append(' ').append(nsName(a.name)).append('="').append(a.value).append('"');});},ElementSerializer.prototype.serializeTo=function(writer){var firstBody=this.body[0],indent=firstBody&&firstBody.constructor!==BodySerializer;writer.appendIndent().append('<'+this.tagName),this.serializeAttributes(writer),writer.append(firstBody?'>':' />'),firstBody&&(indent&&writer.appendNewLine().indent(),(0,_minDash.forEach)(this.body,function(b){b.serializeTo(writer);}),indent&&writer.unindent().appendIndent(),writer.append('</'+this.tagName+'>')),writer.appendNewLine();},inherits(TypeSerializer,ElementSerializer),TypeSerializer.prototype.parseNsAttributes=function(element){var attributes=ElementSerializer.prototype.parseNsAttributes.call(this,element);var descriptor=element.$descriptor;if(descriptor.name===this.propertyDescriptor.type)return attributes;var typeNs=this.typeNs=this.nsTagName(descriptor);this.getNamespaces().logUsed(this.typeNs);var pkg=element.$model.getPackage(typeNs.uri),typePrefix=pkg.xml&&pkg.xml.typePrefix||'';return this.addAttribute(this.nsAttributeName(_common.XSI_TYPE),(typeNs.prefix?typeNs.prefix+':':'')+typePrefix+descriptor.ns.localName),attributes;},TypeSerializer.prototype.isLocalNs=function(ns){return ns.uri===(this.typeNs||this.ns).uri;};},{'./common':441,'min-dash':438,'moddle/lib/ns':449,'moddle/lib/types':452}],444:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}Object.defineProperty(exports,'__esModule',{value:!0});var _moddle=require('./lib/moddle');Object.defineProperty(exports,'default',{enumerable:!0,get:function get(){return _interopRequireDefault(_moddle).default;}});},{'./lib/moddle':448}],445:[function(require,module,exports){'use strict';function Base(){}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=Base,Base.prototype.get=function(name){return this.$model.properties.get(this,name);},Base.prototype.set=function(name,value){this.$model.properties.set(this,name,value);};},{}],446:[function(require,module,exports){'use strict';function DescriptorBuilder(nameNs){this.ns=nameNs,this.name=nameNs.name,this.allTypes=[],this.allTypesByName={},this.properties=[],this.propertiesByName={};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=DescriptorBuilder;var _minDash=require('min-dash');var _ns=require('./ns');DescriptorBuilder.prototype.build=function(){return(0,_minDash.pick)(this,['ns','name','allTypes','allTypesByName','properties','propertiesByName','bodyProperty','idProperty']);},DescriptorBuilder.prototype.addProperty=function(p,idx,validate){typeof idx==='boolean'&&(validate=idx,idx=undefined),this.addNamedProperty(p,validate!==!1);var properties=this.properties;idx!==undefined?properties.splice(idx,0,p):properties.push(p);},DescriptorBuilder.prototype.replaceProperty=function(oldProperty,newProperty,replace){var oldNameNs=oldProperty.ns;var props=this.properties,propertiesByName=this.propertiesByName,rename=oldProperty.name!==newProperty.name;if(oldProperty.isId){if(!newProperty.isId)throw new Error('property <'+newProperty.ns.name+'> must be id property '+'to refine <'+oldProperty.ns.name+'>');this.setIdProperty(newProperty,!1);}if(oldProperty.isBody){if(!newProperty.isBody)throw new Error('property <'+newProperty.ns.name+'> must be body property '+'to refine <'+oldProperty.ns.name+'>');this.setBodyProperty(newProperty,!1);}var idx=props.indexOf(oldProperty);if(idx===-1)throw new Error('property <'+oldNameNs.name+'> not found in property list');props.splice(idx,1),this.addProperty(newProperty,replace?undefined:idx,rename),propertiesByName[oldNameNs.name]=propertiesByName[oldNameNs.localName]=newProperty;},DescriptorBuilder.prototype.redefineProperty=function(p,targetPropertyName,replace){var nsPrefix=p.ns.prefix;var parts=targetPropertyName.split('#');var name=(0,_ns.parseName)(parts[0],nsPrefix);var attrName=(0,_ns.parseName)(parts[1],name.prefix).name;var redefinedProperty=this.propertiesByName[attrName];if(!redefinedProperty)throw new Error('refined property <'+attrName+'> not found');else this.replaceProperty(redefinedProperty,p,replace);delete p.redefines;},DescriptorBuilder.prototype.addNamedProperty=function(p,validate){var ns=p.ns,propsByName=this.propertiesByName;validate&&(this.assertNotDefined(p,ns.name),this.assertNotDefined(p,ns.localName)),propsByName[ns.name]=propsByName[ns.localName]=p;},DescriptorBuilder.prototype.removeNamedProperty=function(p){var ns=p.ns,propsByName=this.propertiesByName;delete propsByName[ns.name],delete propsByName[ns.localName];},DescriptorBuilder.prototype.setBodyProperty=function(p,validate){if(validate&&this.bodyProperty)throw new Error('body property defined multiple times '+'(<'+this.bodyProperty.ns.name+'>, <'+p.ns.name+'>)');this.bodyProperty=p;},DescriptorBuilder.prototype.setIdProperty=function(p,validate){if(validate&&this.idProperty)throw new Error('id property defined multiple times '+'(<'+this.idProperty.ns.name+'>, <'+p.ns.name+'>)');this.idProperty=p;},DescriptorBuilder.prototype.assertNotDefined=function(p,name){var propertyName=p.name,definedProperty=this.propertiesByName[propertyName];if(definedProperty)throw new Error('property <'+propertyName+'> already defined; '+'override of <'+definedProperty.definedBy.ns.name+'#'+definedProperty.ns.name+'> by '+'<'+p.definedBy.ns.name+'#'+p.ns.name+'> not allowed without redefines');},DescriptorBuilder.prototype.hasProperty=function(name){return this.propertiesByName[name];},DescriptorBuilder.prototype.addTrait=function(t,inherited){var typesByName=this.allTypesByName,types=this.allTypes;var typeName=t.name;if(typeName in typesByName)return;(0,_minDash.forEach)(t.properties,(0,_minDash.bind)(function(p){p=(0,_minDash.assign)({},p,{name:p.ns.localName,inherited:inherited}),Object.defineProperty(p,'definedBy',{value:t});var replaces=p.replaces,redefines=p.redefines;replaces||redefines?this.redefineProperty(p,replaces||redefines,replaces):(p.isBody&&this.setBodyProperty(p),p.isId&&this.setIdProperty(p),this.addProperty(p));},this)),types.push(t),typesByName[typeName]=t;};},{'./ns':449,'min-dash':438}],447:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function Factory(model,properties){this.model=model,this.properties=properties;}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=Factory;var _minDash=require('min-dash');var _base=require('./base');var _base2=_interopRequireDefault(_base);Factory.prototype.createType=function(descriptor){function ModdleElement(attrs){props.define(this,'$type',{value:name,enumerable:!0}),props.define(this,'$attrs',{value:{}}),props.define(this,'$parent',{writable:!0}),(0,_minDash.forEach)(attrs,(0,_minDash.bind)(function(val,key){this.set(key,val);},this));}var model=this.model;var props=this.properties,prototype=Object.create(_base2.default.prototype);(0,_minDash.forEach)(descriptor.properties,function(p){!p.isMany&&p.default!==undefined&&(prototype[p.name]=p.default);}),props.defineModel(prototype,model),props.defineDescriptor(prototype,descriptor);var name=descriptor.ns.name;return ModdleElement.prototype=prototype,ModdleElement.hasType=prototype.$instanceOf=this.model.hasType,props.defineModel(ModdleElement,model),props.defineDescriptor(ModdleElement,descriptor),ModdleElement;};},{'./base':445,'min-dash':438}],448:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function Moddle(packages){this.properties=new _properties2.default(this),this.factory=new _factory2.default(this,this.properties),this.registry=new _registry2.default(packages,this.properties),this.typeCache={};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=Moddle;var _minDash=require('min-dash');var _factory=require('./factory');var _factory2=_interopRequireDefault(_factory);var _registry=require('./registry');var _registry2=_interopRequireDefault(_registry);var _properties=require('./properties');var _properties2=_interopRequireDefault(_properties);var _ns=require('./ns');Moddle.prototype.create=function(descriptor,attrs){var Type=this.getType(descriptor);if(!Type)throw new Error('unknown type <'+descriptor+'>');return new Type(attrs);},Moddle.prototype.getType=function(descriptor){var cache=this.typeCache;var name=(0,_minDash.isString)(descriptor)?descriptor:descriptor.ns.name;var type=cache[name];return type||(descriptor=this.registry.getEffectiveDescriptor(name),type=cache[name]=this.factory.createType(descriptor)),type;},Moddle.prototype.createAny=function(name,nsUri,properties){var nameNs=(0,_ns.parseName)(name);var element={$type:name,$instanceOf:function $instanceOf(type){return type===this.$type;}};var descriptor={name:name,isGeneric:!0,ns:{prefix:nameNs.prefix,localName:nameNs.localName,uri:nsUri}};return this.properties.defineDescriptor(element,descriptor),this.properties.defineModel(element,this),this.properties.define(element,'$parent',{enumerable:!1,writable:!0}),(0,_minDash.forEach)(properties,function(a,key){(0,_minDash.isObject)(a)&&a.value!==undefined?element[a.name]=a.value:element[key]=a;}),element;},Moddle.prototype.getPackage=function(uriOrPrefix){return this.registry.getPackage(uriOrPrefix);},Moddle.prototype.getPackages=function(){return this.registry.getPackages();},Moddle.prototype.getElementDescriptor=function(element){return element.$descriptor;},Moddle.prototype.hasType=function(element,type){type===undefined&&(type=element,element=this);var descriptor=element.$model.getElementDescriptor(element);return type in descriptor.allTypesByName;},Moddle.prototype.getPropertyDescriptor=function(element,property){return this.getElementDescriptor(element).propertiesByName[property];},Moddle.prototype.getTypeDescriptor=function(type){return this.registry.typeMap[type];};},{'./factory':447,'./ns':449,'./properties':450,'./registry':451,'min-dash':438}],449:[function(require,module,exports){'use strict';function parseName(name,defaultPrefix){var parts=name.split(/:/),localName,prefix;if(parts.length===1)localName=name,prefix=defaultPrefix;else if(parts.length===2)localName=parts[1],prefix=parts[0];else throw new Error('expected <prefix:localName> or <localName>, got '+name);return name=(prefix?prefix+':':'')+localName,{name:name,prefix:prefix,localName:localName};}Object.defineProperty(exports,'__esModule',{value:!0}),exports.parseName=parseName;},{}],450:[function(require,module,exports){'use strict';function Properties(model){this.model=model;}function isUndefined(val){return val===void 0;}function defineProperty(target,property,value){Object.defineProperty(target,property.name,{enumerable:!property.isReference,writable:!0,value:value,configurable:!0});}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=Properties,Properties.prototype.set=function(target,name,value){var property=this.model.getPropertyDescriptor(target,name);var propertyName=property&&property.name;isUndefined(value)?property?delete target[propertyName]:delete target.$attrs[name]:property?propertyName in target?target[propertyName]=value:defineProperty(target,property,value):target.$attrs[name]=value;},Properties.prototype.get=function(target,name){var property=this.model.getPropertyDescriptor(target,name);if(!property)return target.$attrs[name];var propertyName=property.name;return!target[propertyName]&&property.isMany&&defineProperty(target,property,[]),target[propertyName];},Properties.prototype.define=function(target,name,options){Object.defineProperty(target,name,options);},Properties.prototype.defineDescriptor=function(target,descriptor){this.define(target,'$descriptor',{value:descriptor});},Properties.prototype.defineModel=function(target,model){this.define(target,'$model',{value:model});};},{}],451:[function(require,module,exports){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function Registry(packages,properties){this.packageMap={},this.typeMap={},this.packages=[],this.properties=properties,(0,_minDash.forEach)(packages,(0,_minDash.bind)(this.registerPackage,this));}function ensureAvailable(packageMap,pkg,identifierKey){var value=pkg[identifierKey];if(value in packageMap)throw new Error('package with '+identifierKey+' <'+value+'> already defined');}Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=Registry;var _minDash=require('min-dash');var _types=require('./types');var _descriptorBuilder=require('./descriptor-builder');var _descriptorBuilder2=_interopRequireDefault(_descriptorBuilder);var _ns=require('./ns');Registry.prototype.getPackage=function(uriOrPrefix){return this.packageMap[uriOrPrefix];},Registry.prototype.getPackages=function(){return this.packages;},Registry.prototype.registerPackage=function(pkg){pkg=(0,_minDash.assign)({},pkg);var pkgMap=this.packageMap;ensureAvailable(pkgMap,pkg,'prefix'),ensureAvailable(pkgMap,pkg,'uri'),(0,_minDash.forEach)(pkg.types,(0,_minDash.bind)(function(descriptor){this.registerType(descriptor,pkg);},this)),pkgMap[pkg.uri]=pkgMap[pkg.prefix]=pkg,this.packages.push(pkg);},Registry.prototype.registerType=function(type,pkg){type=(0,_minDash.assign)({},type,{superClass:(type.superClass||[]).slice(),extends:(type.extends||[]).slice(),properties:(type.properties||[]).slice(),meta:(0,_minDash.assign)(type.meta||{})});var ns=(0,_ns.parseName)(type.name,pkg.prefix),name=ns.name,propertiesByName={};(0,_minDash.forEach)(type.properties,(0,_minDash.bind)(function(p){var propertyNs=(0,_ns.parseName)(p.name,ns.prefix),propertyName=propertyNs.name;(0,_types.isBuiltIn)(p.type)||(p.type=(0,_ns.parseName)(p.type,propertyNs.prefix).name),(0,_minDash.assign)(p,{ns:propertyNs,name:propertyName}),propertiesByName[propertyName]=p;},this)),(0,_minDash.assign)(type,{ns:ns,name:name,propertiesByName:propertiesByName}),(0,_minDash.forEach)(type.extends,(0,_minDash.bind)(function(extendsName){var extended=this.typeMap[extendsName];extended.traits=extended.traits||[],extended.traits.push(name);},this)),this.definePackage(type,pkg),this.typeMap[name]=type;},Registry.prototype.mapTypes=function(nsName,iterator,trait){function traverseTrait(cls){return traverseSuper(cls,!0);}function traverseSuper(cls,trait){var parentNs=(0,_ns.parseName)(cls,(0,_types.isBuiltIn)(cls)?'':nsName.prefix);self.mapTypes(parentNs,iterator,trait);}var type=(0,_types.isBuiltIn)(nsName.name)?{name:nsName.name}:this.typeMap[nsName.name];var self=this;if(!type)throw new Error('unknown type <'+nsName.name+'>');(0,_minDash.forEach)(type.superClass,trait?traverseTrait:traverseSuper),iterator(type,!trait),(0,_minDash.forEach)(type.traits,traverseTrait);},Registry.prototype.getEffectiveDescriptor=function(name){var nsName=(0,_ns.parseName)(name);var builder=new _descriptorBuilder2.default(nsName);this.mapTypes(nsName,function(type,inherited){builder.addTrait(type,inherited);});var descriptor=builder.build();return this.definePackage(descriptor,descriptor.allTypes[descriptor.allTypes.length-1].$pkg),descriptor;},Registry.prototype.definePackage=function(target,pkg){this.properties.define(target,'$pkg',{value:pkg});};},{'./descriptor-builder':446,'./ns':449,'./types':452,'min-dash':438}],452:[function(require,module,exports){'use strict';function coerceType(type,value){var converter=TYPE_CONVERTERS[type];return converter?converter(value):value;}function isBuiltIn(type){return!!BUILTINS[type];}function isSimple(type){return!!TYPE_CONVERTERS[type];}Object.defineProperty(exports,'__esModule',{value:!0}),exports.coerceType=coerceType,exports.isBuiltIn=isBuiltIn,exports.isSimple=isSimple;var BUILTINS={String:!0,Boolean:!0,Integer:!0,Real:!0,Element:!0};var TYPE_CONVERTERS={String:function String(s){return s;},Boolean:function Boolean(s){return s==='true';},Integer:function Integer(s){return parseInt(s,10);},Real:function Real(s){return parseFloat(s,10);}};},{}],453:[function(require,module,exports){'use strict';module.exports=require('./lib/refs'),module.exports.Collection=require('./lib/collection');},{'./lib/collection':454,'./lib/refs':455}],454:[function(require,module,exports){'use strict';function extend(collection,refs,property,target){var inverseProperty=property.inverse;return Object.defineProperty(collection,'remove',{value:function value(element){var idx=this.indexOf(element);return idx!==-1&&(this.splice(idx,1),refs.unset(element,inverseProperty,target)),element;}}),Object.defineProperty(collection,'contains',{value:function value(element){return this.indexOf(element)!==-1;}}),Object.defineProperty(collection,'add',{value:function value(element,idx){var currentIdx=this.indexOf(element);if(idx===void 0){if(currentIdx!==-1)return;idx=this.length;}currentIdx!==-1&&this.splice(currentIdx,1),this.splice(idx,0,element),currentIdx===-1&&refs.set(element,inverseProperty,target);}}),Object.defineProperty(collection,'__refs_collection',{value:!0}),collection;}function isExtended(collection){return collection.__refs_collection===!0;}module.exports.extend=extend,module.exports.isExtended=isExtended;},{}],455:[function(require,module,exports){'use strict';function hasOwnProperty(e,property){return Object.prototype.hasOwnProperty.call(e,property.name||property);}function defineCollectionProperty(ref,property,target){var collection=Collection.extend(target[property.name]||[],ref,property,target);Object.defineProperty(target,property.name,{enumerable:property.enumerable,value:collection}),collection.length&&collection.forEach(function(o){ref.set(o,property.inverse,target);});}function defineProperty(ref,property,target){var inverseProperty=property.inverse;var _value=target[property.name];Object.defineProperty(target,property.name,{configurable:property.configurable,enumerable:property.enumerable,get:function get(){return _value;},set:function set(value){if(value===_value)return;var old=_value;_value=null,old&&ref.unset(old,inverseProperty,target),_value=value,ref.set(_value,inverseProperty,target);}});}function Refs(a,b){if(!(this instanceof Refs))return new Refs(a,b);a.inverse=b,b.inverse=a,this.props={},this.props[a.name]=a,this.props[b.name]=b;}var Collection=require('./collection');Refs.prototype.bind=function(target,property){if(typeof property==='string'){if(!this.props[property])throw new Error('no property <'+property+'> in ref');property=this.props[property];}property.collection?defineCollectionProperty(this,property,target):defineProperty(this,property,target);},Refs.prototype.ensureRefsCollection=function(target,property){var collection=target[property.name];return Collection.isExtended(collection)||defineCollectionProperty(this,property,target),collection;},Refs.prototype.ensureBound=function(target,property){hasOwnProperty(target,property)||this.bind(target,property);},Refs.prototype.unset=function(target,property,value){target&&(this.ensureBound(target,property),property.collection?this.ensureRefsCollection(target,property).remove(value):target[property.name]=undefined);},Refs.prototype.set=function(target,property,value){target&&(this.ensureBound(target,property),property.collection?this.ensureRefsCollection(target,property).add(value):target[property.name]=value);},module.exports=Refs;},{'./collection':454}],456:[function(require,module,exports){'use strict';function is(o,type){return type=String.prototype.toLowerCase.call(type),type=='finite'?isFinite(o):type=='array'&&(o instanceof Array||Array.isArray&&Array.isArray(o))?!0:type=='null'&&o===null||type==(o===void 0?'undefined':_typeof(o))&&o!==null||type=='object'&&o===Object(o)||Object.prototype.toString.call(o).slice(8,-1).toLowerCase()==type;}function clone(obj){if(typeof obj=='function'||Object(obj)!==obj)return obj;var res=new obj.constructor();for(var key in obj)obj[has](key)&&(res[key]=clone(obj[key]));return res;}function repush(array,item){for(var i=0,ii=array.length;i<ii;i++)if(array[i]===item)return array.push(array.splice(i,1)[0]);}function cacher(f,scope,postprocessor){function newf(){var arg=Array.prototype.slice.call(arguments,0),args=arg.join('\u2400'),cache=newf.cache=newf.cache||{},count=newf.count=newf.count||[];return cache[has](args)?(repush(count,args),postprocessor?postprocessor(cache[args]):cache[args]):(count.length>=1000&&delete cache[count.shift()],count.push(args),cache[args]=f.apply(scope,arg),postprocessor?postprocessor(cache[args]):cache[args]);}return newf;}function parsePathString(pathString){if(!pathString)return null;var pth=paths(pathString);if(pth.arr)return clone(pth.arr);var paramCounts={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},data=[];return is(pathString,'array')&&is(pathString[0],'array')&&(data=clone(pathString)),data.length||String(pathString).replace(pathCommand,function(a,b,c){var params=[],name=b.toLowerCase();if(c.replace(pathValues,function(a,b){b&&params.push(+b);}),name=='m'&&params.length>2&&(data.push([b].concat(params.splice(0,2))),name='l',b=b=='m'?'l':'L'),name=='o'&&params.length==1&&data.push([b,params[0]]),name=='r')data.push([b].concat(params));else while(params.length>=paramCounts[name])if(data.push([b].concat(params.splice(0,paramCounts[name]))),!paramCounts[name])break;}),data.toString=paths.toString,pth.arr=clone(data),data;}function paths(ps){var p=paths.ps=paths.ps||{};return p[ps]?p[ps].sleep=100:p[ps]={sleep:100},setTimeout(function(){for(var key in p)p[has](key)&&key!=ps&&(p[key].sleep--,p[key].sleep||delete p[key]);}),p[ps];}function box(x,y,width,height){return x==null&&(x=y=width=height=0),y==null&&(y=x.y,width=x.width,height=x.height,x=x.x),{x:x,y:y,width:width,w:width,height:height,h:height,x2:x+width,y2:y+height,cx:x+width/2,cy:y+height/2,r1:math.min(width,height)/2,r2:math.max(width,height)/2,r0:math.sqrt(width*width+height*height)/2,path:rectPath(x,y,width,height),vb:[x,y,width,height].join(' ')};}function pathToString(){return this.join(',').replace(p2s,'$1');}function pathClone(pathArray){var res=clone(pathArray);return res.toString=pathToString,res;}function findDotsAtSegment(p1x,p1y,c1x,c1y,c2x,c2y,p2x,p2y,t){var t1=1-t,t13=pow(t1,3),t12=pow(t1,2),t2=t*t,t3=t2*t,x=t13*p1x+t12*3*t*c1x+t1*3*t*t*c2x+t3*p2x,y=t13*p1y+t12*3*t*c1y+t1*3*t*t*c2y+t3*p2y,mx=p1x+2*t*(c1x-p1x)+t2*(c2x-2*c1x+p1x),my=p1y+2*t*(c1y-p1y)+t2*(c2y-2*c1y+p1y),nx=c1x+2*t*(c2x-c1x)+t2*(p2x-2*c2x+c1x),ny=c1y+2*t*(c2y-c1y)+t2*(p2y-2*c2y+c1y),ax=t1*p1x+t*c1x,ay=t1*p1y+t*c1y,cx=t1*c2x+t*p2x,cy=t1*c2y+t*p2y,alpha=90-math.atan2(mx-nx,my-ny)*180/PI;return{x:x,y:y,m:{x:mx,y:my},n:{x:nx,y:ny},start:{x:ax,y:ay},end:{x:cx,y:cy},alpha:alpha};}function bezierBBox(p1x,p1y,c1x,c1y,c2x,c2y,p2x,p2y){is(p1x,'array')||(p1x=[p1x,p1y,c1x,c1y,c2x,c2y,p2x,p2y]);var bbox=curveBBox.apply(null,p1x);return box(bbox.min.x,bbox.min.y,bbox.max.x-bbox.min.x,bbox.max.y-bbox.min.y);}function isPointInsideBBox(bbox,x,y){return x>=bbox.x&&x<=bbox.x+bbox.width&&y>=bbox.y&&y<=bbox.y+bbox.height;}function isBBoxIntersect(bbox1,bbox2){return bbox1=box(bbox1),bbox2=box(bbox2),isPointInsideBBox(bbox2,bbox1.x,bbox1.y)||isPointInsideBBox(bbox2,bbox1.x2,bbox1.y)||isPointInsideBBox(bbox2,bbox1.x,bbox1.y2)||isPointInsideBBox(bbox2,bbox1.x2,bbox1.y2)||isPointInsideBBox(bbox1,bbox2.x,bbox2.y)||isPointInsideBBox(bbox1,bbox2.x2,bbox2.y)||isPointInsideBBox(bbox1,bbox2.x,bbox2.y2)||isPointInsideBBox(bbox1,bbox2.x2,bbox2.y2)||(bbox1.x<bbox2.x2&&bbox1.x>bbox2.x||bbox2.x<bbox1.x2&&bbox2.x>bbox1.x)&&(bbox1.y<bbox2.y2&&bbox1.y>bbox2.y||bbox2.y<bbox1.y2&&bbox2.y>bbox1.y);}function base3(t,p1,p2,p3,p4){var t1=-3*p1+9*p2-9*p3+3*p4,t2=t*t1+6*p1-12*p2+6*p3;return t*t2-3*p1+3*p2;}function bezlen(x1,y1,x2,y2,x3,y3,x4,y4,z){z==null&&(z=1),z=z>1?1:z<0?0:z;var z2=z/2,n=12,Tvalues=[-0.1252,0.1252,-0.3678,0.3678,-0.5873,0.5873,-0.7699,0.7699,-0.9041,0.9041,-0.9816,0.9816],Cvalues=[0.2491,0.2491,0.2335,0.2335,0.2032,0.2032,0.1601,0.1601,0.1069,0.1069,0.0472,0.0472],sum=0;for(var i=0;i<n;i++){var ct=z2*Tvalues[i]+z2,xbase=base3(ct,x1,x2,x3,x4),ybase=base3(ct,y1,y2,y3,y4),comb=xbase*xbase+ybase*ybase;sum+=Cvalues[i]*math.sqrt(comb);}return z2*sum;}function intersectLines(x1,y1,x2,y2,x3,y3,x4,y4){if(mmax(x1,x2)<mmin(x3,x4)||mmin(x1,x2)>mmax(x3,x4)||mmax(y1,y2)<mmin(y3,y4)||mmin(y1,y2)>mmax(y3,y4))return;var nx=(x1*y2-y1*x2)*(x3-x4)-(x1-x2)*(x3*y4-y3*x4),ny=(x1*y2-y1*x2)*(y3-y4)-(y1-y2)*(x3*y4-y3*x4),denominator=(x1-x2)*(y3-y4)-(y1-y2)*(x3-x4);if(!denominator)return;var px=nx/denominator,py=ny/denominator,px2=+px.toFixed(2),py2=+py.toFixed(2);return px2<+mmin(x1,x2).toFixed(2)||px2>+mmax(x1,x2).toFixed(2)||px2<+mmin(x3,x4).toFixed(2)||px2>+mmax(x3,x4).toFixed(2)||py2<+mmin(y1,y2).toFixed(2)||py2>+mmax(y1,y2).toFixed(2)||py2<+mmin(y3,y4).toFixed(2)||py2>+mmax(y3,y4).toFixed(2)?void 0:{x:px,y:py};}function findBezierIntersections(bez1,bez2,justCount){var bbox1=bezierBBox(bez1),bbox2=bezierBBox(bez2);if(!isBBoxIntersect(bbox1,bbox2))return justCount?0:[];var l1=bezlen.apply(0,bez1),l2=bezlen.apply(0,bez2),n1=~~(l1/5),n2=~~(l2/5),dots1=[],dots2=[],xy={},res=justCount?0:[];for(var i=0;i<n1+1;i++){var p=findDotsAtSegment.apply(0,bez1.concat(i/n1));dots1.push({x:p.x,y:p.y,t:i/n1});}for(i=0;i<n2+1;i++)p=findDotsAtSegment.apply(0,bez2.concat(i/n2)),dots2.push({x:p.x,y:p.y,t:i/n2});for(i=0;i<n1;i++)for(var j=0;j<n2;j++){var di=dots1[i],di1=dots1[i+1],dj=dots2[j],dj1=dots2[j+1],ci=abs(di1.x-di.x)<0.01?'y':'x',cj=abs(dj1.x-dj.x)<0.01?'y':'x',is=intersectLines(di.x,di.y,di1.x,di1.y,dj.x,dj.y,dj1.x,dj1.y);if(is){if(xy[is.x.toFixed(0)]==is.y.toFixed(0))continue;xy[is.x.toFixed(0)]=is.y.toFixed(0);var t1=di.t+abs((is[ci]-di[ci])/(di1[ci]-di[ci]))*(di1.t-di.t),t2=dj.t+abs((is[cj]-dj[cj])/(dj1[cj]-dj[cj]))*(dj1.t-dj.t);t1>=0&&t1<=1&&t2>=0&&t2<=1&&(justCount?res++:res.push({x:is.x,y:is.y,t1:t1,t2:t2}));}}return res;}function findPathIntersections(path1,path2,justCount){path1=pathToCurve(path1),path2=pathToCurve(path2);var x1,y1,x2,y2,x1m,y1m,x2m,y2m,bez1,bez2,res=justCount?0:[];for(var i=0,ii=path1.length;i<ii;i++){var pi=path1[i];if(pi[0]=='M')x1=x1m=pi[1],y1=y1m=pi[2];else{pi[0]=='C'?(bez1=[x1,y1].concat(pi.slice(1)),x1=bez1[6],y1=bez1[7]):(bez1=[x1,y1,x1,y1,x1m,y1m,x1m,y1m],x1=x1m,y1=y1m);for(var j=0,jj=path2.length;j<jj;j++){var pj=path2[j];if(pj[0]=='M')x2=x2m=pj[1],y2=y2m=pj[2];else{pj[0]=='C'?(bez2=[x2,y2].concat(pj.slice(1)),x2=bez2[6],y2=bez2[7]):(bez2=[x2,y2,x2,y2,x2m,y2m,x2m,y2m],x2=x2m,y2=y2m);var intr=findBezierIntersections(bez1,bez2,justCount);if(justCount)res+=intr;else{for(var k=0,kk=intr.length;k<kk;k++)intr[k].segment1=i,intr[k].segment2=j,intr[k].bez1=bez1,intr[k].bez2=bez2;res=res.concat(intr);}}}}}return res;}function rectPath(x,y,w,h,r){if(r)return[['M',+x+ +r,y],['l',w-r*2,0],['a',r,r,0,0,1,r,r],['l',0,h-r*2],['a',r,r,0,0,1,-r,r],['l',r*2-w,0],['a',r,r,0,0,1,-r,-r],['l',0,r*2-h],['a',r,r,0,0,1,r,-r],['z']];var res=[['M',x,y],['l',w,0],['l',0,h],['l',-w,0],['z']];return res.toString=pathToString,res;}function ellipsePath(x,y,rx,ry,a){if(a==null&&ry==null&&(ry=rx),x=+x,y=+y,rx=+rx,ry=+ry,a!=null)var rad=Math.PI/180,x1=x+rx*Math.cos(-ry*rad),x2=x+rx*Math.cos(-a*rad),y1=y+rx*Math.sin(-ry*rad),y2=y+rx*Math.sin(-a*rad),res=[['M',x1,y1],['A',rx,rx,0,+(a-ry>180),0,x2,y2]];else res=[['M',x,y],['m',0,-ry],['a',rx,ry,0,1,1,0,2*ry],['a',rx,ry,0,1,1,0,-2*ry],['z']];return res.toString=pathToString,res;}function pathToAbsolute(pathArray){var pth=paths(pathArray);if(pth.abs)return pathClone(pth.abs);if(is(pathArray,'array')&&is(pathArray&&pathArray[0],'array')||(pathArray=parsePathString(pathArray)),!(pathArray&&pathArray.length))return[['M',0,0]];var res=[],x=0,y=0,mx=0,my=0,start=0,pa0;pathArray[0][0]=='M'&&(x=+pathArray[0][1],y=+pathArray[0][2],mx=x,my=y,start++,res[0]=['M',x,y]);var crz=pathArray.length==3&&pathArray[0][0]=='M'&&pathArray[1][0].toUpperCase()=='R'&&pathArray[2][0].toUpperCase()=='Z';for(var r,pa,i=start,ii=pathArray.length;i<ii;i++){if(res.push(r=[]),pa=pathArray[i],pa0=pa[0],pa0!=pa0.toUpperCase()){r[0]=pa0.toUpperCase();switch(r[0]){case'A':r[1]=pa[1];r[2]=pa[2];r[3]=pa[3];r[4]=pa[4];r[5]=pa[5];r[6]=+pa[6]+x;r[7]=+pa[7]+y;break;case'V':r[1]=+pa[1]+y;break;case'H':r[1]=+pa[1]+x;break;case'R':var dots=[x,y].concat(pa.slice(1));for(var j=2,jj=dots.length;j<jj;j++)dots[j]=+dots[j]+x,dots[++j]=+dots[j]+y;res.pop();res=res.concat(catmulRomToBezier(dots,crz));break;case'O':res.pop();dots=ellipsePath(x,y,pa[1],pa[2]);dots.push(dots[0]);res=res.concat(dots);break;case'U':res.pop();res=res.concat(ellipsePath(x,y,pa[1],pa[2],pa[3]));r=['U'].concat(res[res.length-1].slice(-2));break;case'M':mx=+pa[1]+x;my=+pa[2]+y;default:for(j=1,jj=pa.length;j<jj;j++)r[j]=+pa[j]+(j%2?x:y);}}else if(pa0=='R')dots=[x,y].concat(pa.slice(1)),res.pop(),res=res.concat(catmulRomToBezier(dots,crz)),r=['R'].concat(pa.slice(-2));else if(pa0=='O')res.pop(),dots=ellipsePath(x,y,pa[1],pa[2]),dots.push(dots[0]),res=res.concat(dots);else if(pa0=='U')res.pop(),res=res.concat(ellipsePath(x,y,pa[1],pa[2],pa[3])),r=['U'].concat(res[res.length-1].slice(-2));else for(var k=0,kk=pa.length;k<kk;k++)r[k]=pa[k];if(pa0=pa0.toUpperCase(),pa0!='O')switch(r[0]){case'Z':x=+mx;y=+my;break;case'H':x=r[1];break;case'V':y=r[1];break;case'M':mx=r[r.length-2];my=r[r.length-1];default:x=r[r.length-2];y=r[r.length-1];}}return res.toString=pathToString,pth.abs=pathClone(res),res;}function lineToCurve(x1,y1,x2,y2){return[x1,y1,x2,y2,x2,y2];}function qubicToCurve(x1,y1,ax,ay,x2,y2){var _13=1/3,_23=2/3;return[_13*x1+_23*ax,_13*y1+_23*ay,_13*x2+_23*ax,_13*y2+_23*ay,x2,y2];}function arcToCurve(x1,y1,rx,ry,angle,large_arc_flag,sweep_flag,x2,y2,recursive){var _120=PI*120/180,rad=PI/180*(+angle||0),res=[],xy,rotate=cacher(function(x,y,rad){var X=x*math.cos(rad)-y*math.sin(rad),Y=x*math.sin(rad)+y*math.cos(rad);return{x:X,y:Y};});if(!recursive){xy=rotate(x1,y1,-rad),x1=xy.x,y1=xy.y,xy=rotate(x2,y2,-rad),x2=xy.x,y2=xy.y;var x=(x1-x2)/2,y=(y1-y2)/2;var h=x*x/(rx*rx)+y*y/(ry*ry);h>1&&(h=math.sqrt(h),rx=h*rx,ry=h*ry);var rx2=rx*rx,ry2=ry*ry,k=(large_arc_flag==sweep_flag?-1:1)*math.sqrt(abs((rx2*ry2-rx2*y*y-ry2*x*x)/(rx2*y*y+ry2*x*x))),cx=k*rx*y/ry+(x1+x2)/2,cy=k*-ry*x/rx+(y1+y2)/2,f1=math.asin(((y1-cy)/ry).toFixed(9)),f2=math.asin(((y2-cy)/ry).toFixed(9));f1=x1<cx?PI-f1:f1,f2=x2<cx?PI-f2:f2,f1<0&&(f1=PI*2+f1),f2<0&&(f2=PI*2+f2),sweep_flag&&f1>f2&&(f1-=PI*2),!sweep_flag&&f2>f1&&(f2-=PI*2);}else f1=recursive[0],f2=recursive[1],cx=recursive[2],cy=recursive[3];var df=f2-f1;if(abs(df)>_120){var f2old=f2,x2old=x2,y2old=y2;f2=f1+_120*(sweep_flag&&f2>f1?1:-1),x2=cx+rx*math.cos(f2),y2=cy+ry*math.sin(f2),res=arcToCurve(x2,y2,rx,ry,angle,0,sweep_flag,x2old,y2old,[f2,f2old,cx,cy]);}df=f2-f1;var c1=math.cos(f1),s1=math.sin(f1),c2=math.cos(f2),s2=math.sin(f2),t=math.tan(df/4),hx=4/3*rx*t,hy=4/3*ry*t,m1=[x1,y1],m2=[x1+hx*s1,y1-hy*c1],m3=[x2+hx*s2,y2-hy*c2],m4=[x2,y2];if(m2[0]=2*m1[0]-m2[0],m2[1]=2*m1[1]-m2[1],recursive)return[m2,m3,m4].concat(res);else{res=[m2,m3,m4].concat(res).join().split(',');var newres=[];for(var i=0,ii=res.length;i<ii;i++)newres[i]=i%2?rotate(res[i-1],res[i],rad).y:rotate(res[i],res[i+1],rad).x;return newres;}}function catmulRomToBezier(crp,z){var d=[];for(var i=0,iLen=crp.length;iLen-2*!z>i;i+=2){var p=[{x:+crp[i-2],y:+crp[i-1]},{x:+crp[i],y:+crp[i+1]},{x:+crp[i+2],y:+crp[i+3]},{x:+crp[i+4],y:+crp[i+5]}];z?i?iLen-4==i?p[3]={x:+crp[0],y:+crp[1]}:iLen-2==i&&(p[2]={x:+crp[0],y:+crp[1]},p[3]={x:+crp[2],y:+crp[3]}):p[0]={x:+crp[iLen-2],y:+crp[iLen-1]}:iLen-4==i?p[3]=p[2]:i||(p[0]={x:+crp[i],y:+crp[i+1]}),d.push(['C',(-p[0].x+6*p[1].x+p[2].x)/6,(-p[0].y+6*p[1].y+p[2].y)/6,(p[1].x+6*p[2].x-p[3].x)/6,(p[1].y+6*p[2].y-p[3].y)/6,p[2].x,p[2].y]);}return d;}function curveBBox(x0,y0,x1,y1,x2,y2,x3,y3){var tvalues=[],bounds=[[],[]],a,b,c,t,t1,t2,b2ac,sqrtb2ac;for(var i=0;i<2;++i){if(i==0?(b=6*x0-12*x1+6*x2,a=-3*x0+9*x1-9*x2+3*x3,c=3*x1-3*x0):(b=6*y0-12*y1+6*y2,a=-3*y0+9*y1-9*y2+3*y3,c=3*y1-3*y0),abs(a)<1e-12){if(abs(b)<1e-12)continue;t=-c/b,0<t&&t<1&&tvalues.push(t);continue;}if(b2ac=b*b-4*c*a,sqrtb2ac=math.sqrt(b2ac),b2ac<0)continue;t1=(-b+sqrtb2ac)/(2*a),0<t1&&t1<1&&tvalues.push(t1),t2=(-b-sqrtb2ac)/(2*a),0<t2&&t2<1&&tvalues.push(t2);}var j=tvalues.length,jlen=j,mt;while(j--)t=tvalues[j],mt=1-t,bounds[0][j]=mt*mt*mt*x0+3*mt*mt*t*x1+3*mt*t*t*x2+t*t*t*x3,bounds[1][j]=mt*mt*mt*y0+3*mt*mt*t*y1+3*mt*t*t*y2+t*t*t*y3;return bounds[0][jlen]=x0,bounds[1][jlen]=y0,bounds[0][jlen+1]=x3,bounds[1][jlen+1]=y3,bounds[0].length=bounds[1].length=jlen+2,{min:{x:mmin.apply(0,bounds[0]),y:mmin.apply(0,bounds[1])},max:{x:mmax.apply(0,bounds[0]),y:mmax.apply(0,bounds[1])}};}function pathToCurve(path,path2){var pth=!path2&&paths(path);if(!path2&&pth.curve)return pathClone(pth.curve);var p=pathToAbsolute(path),p2=path2&&pathToAbsolute(path2),attrs={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},attrs2={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},processPath=function processPath(path,d,pcom){var nx,ny;if(!path)return['C',d.x,d.y,d.x,d.y,d.x,d.y];path[0]in{T:1,Q:1}||(d.qx=d.qy=null);switch(path[0]){case'M':d.X=path[1];d.Y=path[2];break;case'A':path=['C'].concat(arcToCurve.apply(0,[d.x,d.y].concat(path.slice(1))));break;case'S':pcom=='C'||pcom=='S'?(nx=d.x*2-d.bx,ny=d.y*2-d.by):(nx=d.x,ny=d.y);path=['C',nx,ny].concat(path.slice(1));break;case'T':pcom=='Q'||pcom=='T'?(d.qx=d.x*2-d.qx,d.qy=d.y*2-d.qy):(d.qx=d.x,d.qy=d.y);path=['C'].concat(qubicToCurve(d.x,d.y,d.qx,d.qy,path[1],path[2]));break;case'Q':d.qx=path[1];d.qy=path[2];path=['C'].concat(qubicToCurve(d.x,d.y,path[1],path[2],path[3],path[4]));break;case'L':path=['C'].concat(lineToCurve(d.x,d.y,path[1],path[2]));break;case'H':path=['C'].concat(lineToCurve(d.x,d.y,path[1],d.y));break;case'V':path=['C'].concat(lineToCurve(d.x,d.y,d.x,path[1]));break;case'Z':path=['C'].concat(lineToCurve(d.x,d.y,d.X,d.Y));break;}return path;},fixArc=function fixArc(pp,i){if(pp[i].length>7){pp[i].shift();var pi=pp[i];while(pi.length)pcoms1[i]='A',p2&&(pcoms2[i]='A'),pp.splice(i++,0,['C'].concat(pi.splice(0,6)));pp.splice(i,1),ii=mmax(p.length,p2&&p2.length||0);}},fixM=function fixM(path1,path2,a1,a2,i){path1&&path2&&path1[i][0]=='M'&&path2[i][0]!='M'&&(path2.splice(i,0,['M',a2.x,a2.y]),a1.bx=0,a1.by=0,a1.x=path1[i][1],a1.y=path1[i][2],ii=mmax(p.length,p2&&p2.length||0));},pcoms1=[],pcoms2=[],pfirst='',pcom='';for(var i=0,ii=mmax(p.length,p2&&p2.length||0);i<ii;i++){p[i]&&(pfirst=p[i][0]),pfirst!='C'&&(pcoms1[i]=pfirst,i&&(pcom=pcoms1[i-1])),p[i]=processPath(p[i],attrs,pcom),pcoms1[i]!='A'&&pfirst=='C'&&(pcoms1[i]='C'),fixArc(p,i),p2&&(p2[i]&&(pfirst=p2[i][0]),pfirst!='C'&&(pcoms2[i]=pfirst,i&&(pcom=pcoms2[i-1])),p2[i]=processPath(p2[i],attrs2,pcom),pcoms2[i]!='A'&&pfirst=='C'&&(pcoms2[i]='C'),fixArc(p2,i)),fixM(p,p2,attrs,attrs2,i),fixM(p2,p,attrs2,attrs,i);var seg=p[i],seg2=p2&&p2[i],seglen=seg.length,seg2len=p2&&seg2.length;attrs.x=seg[seglen-2],attrs.y=seg[seglen-1],attrs.bx=toFloat(seg[seglen-4])||attrs.x,attrs.by=toFloat(seg[seglen-3])||attrs.y,attrs2.bx=p2&&(toFloat(seg2[seg2len-4])||attrs2.x),attrs2.by=p2&&(toFloat(seg2[seg2len-3])||attrs2.y),attrs2.x=p2&&seg2[seg2len-2],attrs2.y=p2&&seg2[seg2len-1];}return p2||(pth.curve=pathClone(p)),p2?[p,p2]:p;}var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj;};var has='hasOwnProperty',p2s=/,?([a-z]),?/gi,toFloat=parseFloat,math=Math,PI=math.PI,mmin=math.min,mmax=math.max,pow=math.pow,abs=math.abs,pathCommand=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?[\s]*,?[\s]*)+)/gi,pathValues=/(-?\d*\.?\d*(?:e[-+]?\\d+)?)[\s]*,?[\s]*/gi;module.exports=findPathIntersections;},{}],457:[function(require,module,exports){'use strict';function replaceEntities(_,d,x,z){return z?hasOwnProperty.call(ENTITY_MAPPING,z)?ENTITY_MAPPING[z]:'&'+z+';':d?fromCharCode(d):fromCharCode(parseInt(x,16));}function decodeEntities(s){return s.length>3&&s.indexOf('&')!==-1?s.replace(ENTITY_PATTERN,replaceEntities):s;}function error(msg){return new Error(msg);}function missingNamespaceForPrefix(prefix){return'missing namespace for prefix <'+prefix+'>';}function getter(getFn){return{get:getFn,enumerable:!0};}function cloneNsMatrix(nsMatrix){var clone={},key;for(key in nsMatrix)clone[key]=nsMatrix[key];return clone;}function uriPrefix(prefix){return prefix+'$uri';}function buildNsMatrix(nsUriToPrefix){var nsMatrix={},uri,prefix;for(uri in nsUriToPrefix)prefix=nsUriToPrefix[uri],nsMatrix[prefix]=prefix,nsMatrix[uriPrefix(prefix)]=uri;return nsMatrix;}function noopGetContext(){return{line:0,column:0};}function throwFunc(err){throw err;}function Parser(options){function handleError(err){err instanceof Error||(err=error(err)),returnError=err,onError(err,getContext);}function handleWarning(err){if(!onWarning)return;err instanceof Error||(err=error(err)),onWarning(err,getContext);}function parse(xml){function getAttrs(){if(cachedAttrs!==null)return cachedAttrs;var nsUri,nsUriPrefix,nsName,defaultAlias=isNamespace&&nsMatrix.xmlns,attrList=isNamespace&&maybeNS?[]:null,i=attrsStart,s=attrsString,l=s.length,hasNewMatrix,newalias,value,alias,name,attrs={},seenAttrs={},skipAttr,w,j;parseAttr:for(;i<l;i++){if(skipAttr=!1,w=s.charCodeAt(i),w===32||w<14&&w>8)continue;for((w<65||w>122||w>90&&w<97)&&w!==95&&w!==58&&(handleWarning('illegal first char attribute name'),skipAttr=!0),j=i+1;j<l;j++){if(w=s.charCodeAt(j),w>96&&w<123||w>64&&w<91||w>47&&w<59||w===46||w===45||w===95)continue;if(w===32||w<14&&w>8){handleWarning('missing attribute value'),i=j;continue parseAttr;}if(w===61)break;handleWarning('illegal attribute name char'),skipAttr=!0;}if(name=s.substring(i,j),name==='xmlns:xmlns'&&(handleWarning('illegal declaration of xmlns'),skipAttr=!0),w=s.charCodeAt(j+1),w===34)j=s.indexOf('"',i=j+2),j===-1&&(j=s.indexOf("'",i),j!==-1&&(handleWarning('attribute value quote missmatch'),skipAttr=!0));else if(w===39)j=s.indexOf("'",i=j+2),j===-1&&(j=s.indexOf('"',i),j!==-1&&(handleWarning('attribute value quote missmatch'),skipAttr=!0));else for(handleWarning('missing attribute value quotes'),skipAttr=!0,j+=1;j<l;j++)if(w=s.charCodeAt(j+1),w===32||w<14&&w>8)break;for(j===-1&&(handleWarning('missing closing quotes'),j=l,skipAttr=!0),skipAttr||(value=s.substring(i,j)),i=j;j+1<l;j++){if(w=s.charCodeAt(j+1),w===32||w<14&&w>8)break;i===j&&(handleWarning('illegal character after attribute end'),skipAttr=!0);}if(i=j+1,skipAttr)continue parseAttr;if(name in seenAttrs){handleWarning('attribute <'+name+'> already defined');continue;}if(seenAttrs[name]=!0,!isNamespace){attrs[name]=value;continue;}if(maybeNS){if(newalias=name==='xmlns'?'xmlns':name.charCodeAt(0)===120&&name.substr(0,6)==='xmlns:'?name.substr(6):null,newalias!==null){if(nsUri=decodeEntities(value),nsUriPrefix=uriPrefix(newalias),alias=nsUriToPrefix[nsUri],!alias){if(newalias==='xmlns'||nsUriPrefix in nsMatrix&&nsMatrix[nsUriPrefix]!==nsUri)do alias='ns'+anonymousNsCount++;while(nsMatrix[alias]!==void 0);else alias=newalias;nsUriToPrefix[nsUri]=alias;}nsMatrix[newalias]!==alias&&(hasNewMatrix||(nsMatrix=cloneNsMatrix(nsMatrix),hasNewMatrix=!0),nsMatrix[newalias]=alias,newalias==='xmlns'&&(nsMatrix[uriPrefix(alias)]=nsUri,defaultAlias=alias),nsMatrix[nsUriPrefix]=nsUri),attrs[name]=value;continue;}attrList.push(name,value);continue;}if(w=name.indexOf(':'),w===-1){attrs[name]=value;continue;}if(!(nsName=nsMatrix[name.substring(0,w)])){handleWarning(missingNamespaceForPrefix(name.substring(0,w)));continue;}name=defaultAlias===nsName?name.substr(w+1):nsName+name.substr(w),name===XSI_TYPE&&(w=value.indexOf(':'),w!==-1?(nsName=value.substring(0,w),nsName=nsMatrix[nsName]||nsName,value=nsName+value.substring(w)):value=defaultAlias+':'+value),attrs[name]=value;}if(maybeNS)for(i=0,l=attrList.length;i<l;i++){if(name=attrList[i++],value=attrList[i],w=name.indexOf(':'),w!==-1){if(!(nsName=nsMatrix[name.substring(0,w)])){handleWarning(missingNamespaceForPrefix(name.substring(0,w)));continue;}name=defaultAlias===nsName?name.substr(w+1):nsName+name.substr(w),name===XSI_TYPE&&(w=value.indexOf(':'),w!==-1?(nsName=value.substring(0,w),nsName=nsMatrix[nsName]||nsName,value=nsName+value.substring(w)):value=defaultAlias+':'+value);}attrs[name]=value;}return cachedAttrs=attrs;}function getParseContext(){var splitsRe=/(\r\n|\r|\n)/g;var line=0;var column=0;var startOfLine=0;var endOfLine=j;var match;var data;while(i>=startOfLine){if(match=splitsRe.exec(xml),!match)break;if(endOfLine=match[0].length+match.index,endOfLine>i)break;line+=1,startOfLine=endOfLine;}return i==-1?(column=endOfLine,data=''):(column=i-startOfLine,data=j==-1?xml.substring(i):xml.substring(i,j+1)),{data:data,line:line,column:column};}var nsMatrixStack=isNamespace?[]:null,nsMatrix=isNamespace?buildNsMatrix(nsUriToPrefix):null,_nsMatrix,nodeStack=[],anonymousNsCount=0,tagStart=!1,tagEnd=!1,i=0,j=0,x,y,q,w,xmlns,elementName,_elementName,elementProxy;var attrsString='',attrsStart=0,cachedAttrs;getContext=getParseContext,proxy&&(elementProxy=Object.create({},{name:getter(function(){return elementName;}),originalName:getter(function(){return _elementName;}),attrs:getter(getAttrs),ns:getter(function(){return nsMatrix;})}));while(j!==-1){if(xml.charCodeAt(j)===60?i=j:i=xml.indexOf('<',j),i===-1)return nodeStack.length?handleError('unexpected end of file'):j===0?handleError('missing start tag'):void 0;if(j!==i&&onText&&(onText(xml.substring(j,i),decodeEntities,getContext),parseStop))return;if(w=xml.charCodeAt(i+1),w===33){if(w=xml.charCodeAt(i+2),w===91&&xml.substr(i+3,6)==='CDATA['){if(j=xml.indexOf(']]>',i),j===-1)return handleError('unclosed cdata');if(onCDATA&&(onCDATA(xml.substring(i+9,j),getContext),parseStop))return;j+=3;continue;}if(w===45&&xml.charCodeAt(i+3)===45){if(j=xml.indexOf('-->',i),j===-1)return handleError('unclosed comment');if(onComment&&(onComment(xml.substring(i+4,j),decodeEntities,getContext),parseStop))return;j+=3;continue;}if(j=xml.indexOf('>',i+1),j===-1)return handleError('unclosed tag');if(onAttention&&(onAttention(xml.substring(i,j+1),decodeEntities,getContext),parseStop))return;j+=1;continue;}if(w===63){if(j=xml.indexOf('?>',i),j===-1)return handleError('unclosed question');if(onQuestion&&(onQuestion(xml.substring(i,j+2),getContext),parseStop))return;j+=2;continue;}if(j=xml.indexOf('>',i+1),j==-1)return handleError('unclosed tag');if(cachedAttrs={},w===47){if(tagStart=!1,tagEnd=!0,!nodeStack.length)return handleError('missing open tag');if(x=elementName=nodeStack.pop(),q=i+2+x.length,xml.substring(i+2,q)!==x)return handleError('closing tag mismatch');for(;q<j;q++){if(w=xml.charCodeAt(q),w===32||w>8&&w<14)continue;return handleError('close tag');}}else{if(xml.charCodeAt(j-1)===47?(x=elementName=xml.substring(i+1,j-1),tagStart=!0,tagEnd=!0):(x=elementName=xml.substring(i+1,j),tagStart=!0,tagEnd=!1),!(w>96&&w<123||w>64&&w<91||w===95||w===58))return handleError('illegal first char nodeName');for(q=1,y=x.length;q<y;q++){if(w=x.charCodeAt(q),w>96&&w<123||w>64&&w<91||w>47&&w<59||w===45||w===95)continue;if(w===32||w<14&&w>8){elementName=x.substring(0,q),cachedAttrs=null;break;}return handleError('invalid nodeName');}tagEnd||nodeStack.push(elementName);}if(isNamespace){if(_nsMatrix=nsMatrix,tagStart&&(tagEnd||nsMatrixStack.push(_nsMatrix),cachedAttrs===null&&(maybeNS=x.indexOf('xmlns',q)!==-1)&&(attrsStart=q,attrsString=x,getAttrs(),maybeNS=!1)),_elementName=elementName,w=elementName.indexOf(':'),w!==-1){if(xmlns=nsMatrix[elementName.substring(0,w)],!xmlns)return handleError('missing namespace on <'+_elementName+'>');elementName=elementName.substr(w+1);}else xmlns=nsMatrix.xmlns;xmlns&&(elementName=xmlns+':'+elementName);}if(tagStart&&(attrsStart=q,attrsString=x,onOpenTag)&&(proxy?onOpenTag(elementProxy,decodeEntities,tagEnd,getContext):onOpenTag(elementName,getAttrs,decodeEntities,tagEnd,getContext),parseStop))return;if(tagEnd){if(onCloseTag&&(onCloseTag(proxy?elementProxy:elementName,decodeEntities,tagStart,getContext),parseStop))return;isNamespace&&(tagStart?nsMatrix=_nsMatrix:nsMatrix=nsMatrixStack.pop());}j+=1;}}if(!this)return new Parser(options);var proxy=options&&options.proxy;var onText,onOpenTag,onCloseTag,onCDATA,onError=throwFunc,onWarning,onComment,onQuestion,onAttention;var getContext=noopGetContext;var maybeNS=!1;var isNamespace=!1;var returnError=null;var parseStop=!1;var nsUriToPrefix;this.on=function(name,cb){if(typeof cb!=='function')throw error('required args <name, cb>');switch(name){case'openTag':onOpenTag=cb;break;case'text':onText=cb;break;case'closeTag':onCloseTag=cb;break;case'error':onError=cb;break;case'warn':onWarning=cb;break;case'cdata':onCDATA=cb;break;case'attention':onAttention=cb;break;case'question':onQuestion=cb;break;case'comment':onComment=cb;break;default:throw error('unsupported event: '+name);}return this;},this.ns=function(nsMap){if(nsMap===void 0&&(nsMap={}),(nsMap===void 0?'undefined':_typeof(nsMap))!=='object')throw error('required args <nsMap={}>');var _nsUriToPrefix={},k;for(k in nsMap)_nsUriToPrefix[k]=nsMap[k];return _nsUriToPrefix[XSI_URI]=XSI_PREFIX,isNamespace=!0,nsUriToPrefix=_nsUriToPrefix,this;},this.parse=function(xml){if(typeof xml!=='string')throw error('required args <xml=string>');return returnError=null,parse(xml),getContext=noopGetContext,parseStop=!1,returnError;},this.stop=function(){parseStop=!0;};}var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj;};Object.defineProperty(exports,'__esModule',{value:!0});var fromCharCode=String.fromCharCode;var hasOwnProperty=Object.prototype.hasOwnProperty;var ENTITY_PATTERN=/&#(\d+);|&#x([0-9a-f]+);|&(\w+);/gi;var ENTITY_MAPPING={amp:'&',apos:"'",gt:'>',lt:'<',quot:'"'};Object.keys(ENTITY_MAPPING).forEach(function(k){ENTITY_MAPPING[k.toUpperCase()]=ENTITY_MAPPING[k];});var XSI_URI='http://www.w3.org/2001/XMLSchema-instance';var XSI_PREFIX='xsi';var XSI_TYPE='xsi:type';exports.Parser=Parser,exports.decode=decodeEntities;},{}],458:[function(require,module,exports){'use strict';function ScrollTabs($el,options){EventEmitter.call(this),this.options=options=assign({},DEFAULT_OPTIONS,options),this.container=$el,this._createScrollButtons($el,options),this._bindEvents($el);}function create($el,options){var scrollTabs=get($el);return scrollTabs||(scrollTabs=new ScrollTabs($el,options),$el.__scrollTabs=scrollTabs),scrollTabs;}function get($el){return $el.__scrollTabs;}var domify=require('min-dom/lib/domify'),domClasses=require('min-dom/lib/classes'),domMatches=require('min-dom/lib/matches'),domDelegate=require('min-dom/lib/delegate'),domQuery=require('min-dom/lib/query'),domEvent=require('min-dom/lib/event'),domAttr=require('min-dom/lib/attr');var filter=require('lodash/collection/filter'),assign=require('lodash/object/assign');var inherits=require('inherits');var EventEmitter=require('events');var DEFAULT_OPTIONS={scrollSymbolLeft:'\u2039',scrollSymbolRight:'\u203A'};inherits(ScrollTabs,EventEmitter),ScrollTabs.prototype._createButton=function(parentNode,options){var className=options.className,direction=options.direction;var button=domQuery('.'+className,parentNode);return button||(button=domify('<span class="scroll-tabs-button '+className+'">'+options.label+'</span>'),parentNode.insertBefore(button,parentNode.childNodes[0])),domAttr(button,'data-direction',direction),button;},ScrollTabs.prototype._createScrollButtons=function(parentNode,options){this._createButton(parentNode,{className:'scroll-tabs-left',label:options.scrollSymbolLeft,direction:-1}),this._createButton(parentNode,{className:'scroll-tabs-right',label:options.scrollSymbolRight,direction:1});},ScrollTabs.prototype.getActiveTabNode=function(){return domQuery(this.options.selectors.active,this.container);},ScrollTabs.prototype.getTabsContainerNode=function(){return domQuery(this.options.selectors.tabsContainer,this.container);},ScrollTabs.prototype.getAllTabNodes=function(){return domQuery.all(this.options.selectors.tab,this.container);},ScrollTabs.prototype.getVisibleTabs=function(){var allTabs=this.getAllTabNodes();var ignore=this.options.selectors.ignore;return filter(allTabs,function(tabNode){return!domMatches(tabNode,ignore);});},ScrollTabs.prototype.getAdjacentTab=function(referenceTabNode,n){var visibleTabs=this.getVisibleTabs();var index=visibleTabs.indexOf(referenceTabNode);return visibleTabs[index+n];},ScrollTabs.prototype._bindEvents=function(node){this._bindWheelEvent(node),this._bindTabClickEvents(node),this._bindScrollButtonEvents(node);},ScrollTabs.prototype._bindTabClickEvents=function(node){var selector=this.options.selectors.tab;var self=this;domDelegate.bind(node,selector,'click',function onClick(event){self.scrollToTabNode(event.delegateTarget);});},ScrollTabs.prototype._bindWheelEvent=function(node){var self=this;domEvent.bind(node,'wheel',function(e){var direction=Math.sign(e.deltaY);var oldActiveTab=self.getActiveTabNode();var newActiveTab=self.getAdjacentTab(oldActiveTab,direction);newActiveTab&&(self.scrollToTabNode(newActiveTab),self.emit('scroll',newActiveTab,oldActiveTab,direction)),e.preventDefault();});},ScrollTabs.prototype._bindScrollButtonEvents=function(node){var self=this;domDelegate.bind(node,'.scroll-tabs-button','click',function(event){var target=event.delegateTarget;var direction=parseInt(domAttr(target,'data-direction'),10);var oldActiveTabNode=self.getActiveTabNode();var newActiveTabNode=self.getAdjacentTab(oldActiveTabNode,direction);newActiveTabNode&&(self.scrollToTabNode(newActiveTabNode),self.emit('scroll',newActiveTabNode,oldActiveTabNode,direction)),event.preventDefault();});},ScrollTabs.prototype.scrollToTabNode=function(tabNode){if(!tabNode)return;var tabsContainerNode=tabNode.parentNode;var tabWidth=tabNode.offsetWidth,tabOffsetLeft=tabNode.offsetLeft,tabOffsetRight=tabOffsetLeft+tabWidth,containerWidth=tabsContainerNode.offsetWidth,containerScrollLeft=tabsContainerNode.scrollLeft;containerScrollLeft>tabOffsetLeft?tabsContainerNode.scrollLeft=0:tabOffsetRight>containerWidth&&(tabsContainerNode.scrollLeft=tabOffsetRight-containerWidth);},ScrollTabs.prototype.update=function(){var tabsContainerNode=this.getTabsContainerNode();var overflow=tabsContainerNode.scrollWidth>tabsContainerNode.offsetWidth;var overflowClass='scroll-tabs-overflow';domClasses(this.container).toggle(overflowClass,overflow),overflow&&this.scrollToTabNode(this.getActiveTabNode());},module.exports=create,module.exports.get=get;},{events:171,inherits:350,'lodash/collection/filter':355,'lodash/object/assign':430,'min-dom/lib/attr':459,'min-dom/lib/classes':460,'min-dom/lib/delegate':461,'min-dom/lib/domify':462,'min-dom/lib/event':463,'min-dom/lib/matches':464,'min-dom/lib/query':465}],459:[function(require,module,exports){arguments[4][50][0].apply(exports,arguments);},{dup:50}],460:[function(require,module,exports){arguments[4][51][0].apply(exports,arguments);},{'component-classes':172,dup:51}],461:[function(require,module,exports){arguments[4][54][0].apply(exports,arguments);},{'component-delegate':174,dup:54}],462:[function(require,module,exports){arguments[4][55][0].apply(exports,arguments);},{domify:346,dup:55}],463:[function(require,module,exports){'use strict';module.exports=require('component-event');},{'component-event':175}],464:[function(require,module,exports){arguments[4][56][0].apply(exports,arguments);},{'component-matches-selector':177,dup:56}],465:[function(require,module,exports){arguments[4][57][0].apply(exports,arguments);},{'component-query':178,dup:57}],466:[function(require,module,exports){'use strict';function calculateUpdate(currentSelection,currentValue,newValue){var currentCursor=currentSelection.start,newCursor=currentCursor,diff=newValue.length-currentValue.length,idx;var lengthDelta=newValue.length-currentValue.length;var currentTail=currentValue.substring(currentCursor);newValue.lastIndexOf(currentTail)===newValue.length-currentTail.length&&(currentValue=currentValue.substring(0,currentValue.length-currentTail.length),newValue=newValue.substring(0,newValue.length-currentTail.length));var diff=createDiff(currentValue,newValue);return diff&&(diff.type==='remove'?newCursor=diff.newStart:newCursor=diff.newEnd),range(newCursor);}function createDiff(currentValue,newValue){var insert;var l_str,l_char,l_idx=0,s_str,s_char,s_idx=0;newValue.length>currentValue.length?(l_str=newValue,s_str=currentValue):(l_str=currentValue,s_str=newValue);while(l_idx<l_str.length)l_char=l_str.charAt(l_idx),s_char=s_str.charAt(s_idx),l_char!==s_char?(insert||(insert={l_start:l_idx,s_start:s_idx}),l_idx++):(insert&&!insert.complete&&(insert.l_end=l_idx,insert.s_end=s_idx,insert.complete=!0),s_idx++,l_idx++);return insert&&!insert.complete&&(insert.complete=!0,insert.s_end=s_str.length,insert.l_end=l_str.length),insert?newValue.length>currentValue.length?{newStart:insert.l_start,newEnd:insert.l_end,type:'add'}:{newStart:insert.s_start,newEnd:insert.s_end,type:newValue.length<currentValue.length?'remove':'replace'}:void 0;}function range(start,end){return{start:start,end:end===undefined?start:end};}function splitStr(str,position){return{before:str.substring(0,position),after:str.substring(position)};}module.exports=calculateUpdate,module.exports.range=range;},{}],467:[function(require,module,exports){'use strict';(function(global){'use strict';function TinyStack(){this.data=[null],this.top=0;}function factory(){return new TinyStack();}TinyStack.prototype.clear=function clear(){return this.data=[null],this.top=0,this;},TinyStack.prototype.length=function length(){return this.top;},TinyStack.prototype.empty=function empty(){return this.top===0;},TinyStack.prototype.peek=function peek(){return this.data[this.top];},TinyStack.prototype.pop=function pop(){return this.top>0?(this.top--,this.data.pop()):undefined;},TinyStack.prototype.push=function push(arg){return this.data[++this.top]=arg,this;},TinyStack.prototype.search=function search(arg){var index=this.data.indexOf(arg);return index===-1?-1:this.data.length-index;},exports!==void 0?module.exports=factory:typeof define=='function'?define(function(){return factory;}):global.stack=factory;}(undefined));},{}],468:[function(require,module,exports){'use strict';function ensureImported(element,target){if(element.ownerDocument!==target.ownerDocument)try{return target.ownerDocument.importNode(element,!0);}catch(e){}return element;}function appendTo(element,target){return target.appendChild(ensureImported(element,target)),element;}function append(element,node){return appendTo(node,element),element;}function getAttribute(node,name){return CSS_PROPERTIES[name]?node.style[name]:node.getAttributeNS(null,name);}function setAttribute(node,name,value){var hyphenated=name.replace(/([a-z])([A-Z])/g,'$1-$2').toLowerCase();var type=CSS_PROPERTIES[hyphenated];type?(type===LENGTH_ATTR&&typeof value==='number'&&(value=String(value)+'px'),node.style[hyphenated]=value):node.setAttributeNS(null,name,value);}function setAttributes(node,attrs){var names=Object.keys(attrs),i,name;for(i=0,name;name=names[i];i++)setAttribute(node,name,attrs[name]);}function attr(node,name,value){if(typeof name==='string')if(value!==undefined)setAttribute(node,name,value);else return getAttribute(node,name);else setAttributes(node,name);return node;}function index(arr,obj){if(arr.indexOf)return arr.indexOf(obj);for(var i=0;i<arr.length;++i)if(arr[i]===obj)return i;return-1;}function defined(o){return o!==void 0;}function classes(el){return new ClassList(el);}function ClassList(el){if(!(el&&el.nodeType))throw new Error('A DOM element reference is required');this.el=el,this.list=el.classList;}function remove(element){var parent=element.parentNode;return parent&&parent.removeChild(element),element;}function clear(element){var child;while(child=element.firstChild)remove(child);return element;}function clone(element){return element.cloneNode(!0);}function parse(svg){return svg.substring(0,4)==='<svg'?svg.indexOf(ns.svg)===-1&&(svg=SVG_START+svg.substring(4)):svg=SVG_START+'>'+svg+'</svg>',parseDocument(svg);}function parseDocument(svg){var parser;return parser=new DOMParser(),parser.async=!1,parser.parseFromString(svg,'text/xml');}function create(name,attrs){var element;return name.charAt(0)==='<'?(element=parse(name).firstChild,element=document.importNode(element,!0)):element=document.createElementNS(ns.svg,name),attrs&&attr(element,attrs),element;}function on(node,event,listener,useCapture){node.addEventListener(event,listener,useCapture);}function off(node,event,listener,useCapture){node.removeEventListener(event,listener,useCapture);}function extend(object,props){var i,k,keys=Object.keys(props);for(i=0;k=keys[i];i++)object[k]=props[k];return object;}function createPoint(x,y){var point=node.createSVGPoint();switch(arguments.length){case 0:return point;case 2:x={x:x,y:y};break;}return extend(point,x);}function createMatrix(a,b,c,d,e,f){var matrix=node.createSVGMatrix();switch(arguments.length){case 0:return matrix;case 6:a={a:a,b:b,c:c,d:d,e:e,f:f};break;}return extend(matrix,a);}function createTransform(matrix){return matrix?node.createSVGTransformFromMatrix(matrix):node.createSVGTransform();}function escape(str,pattern){function replaceFn(match,entity){return ENTITY_REPLACEMENT[entity]||entity;}return str.replace(pattern,replaceFn);}function serialize(node,output){var i,len,attrMap,attrNode,childNodes;switch(node.nodeType){case 3:output.push(escape(node.textContent,TEXT_ENTITIES));break;case 1:output.push('<',node.tagName);if(node.hasAttributes())for(attrMap=node.attributes,i=0,len=attrMap.length;i<len;++i)attrNode=attrMap.item(i),output.push(' ',attrNode.name,'="',escape(attrNode.value,ATTR_ENTITIES),'"');if(node.hasChildNodes()){for(output.push('>'),childNodes=node.childNodes,i=0,len=childNodes.length;i<len;++i)serialize(childNodes.item(i),output);output.push('</',node.tagName,'>');}else output.push('/>');break;case 8:output.push('<!--',escape(node.nodeValue,TEXT_ENTITIES),'-->');break;case 4:output.push('<![CDATA[',node.nodeValue,']]>');break;default:throw new Error('unable to handle node '+node.nodeType);}return output;}function set(element,svg){var node,documentElement=parse(svg).documentElement;if(clear(element),!svg)return;node=documentElement.firstChild;while(node)appendTo(node,element),node=node.nextSibling;}function get(element){var child=element.firstChild,output=[];while(child)serialize(child,output),child=child.nextSibling;return output.join('');}function innerSVG(element,svg){if(svg!==undefined){try{set(element,svg);}catch(e){throw new Error('error parsing SVG: '+e.message);}return element;}else return get(element);}function select(node,selector){return node.querySelector(selector);}function selectAll(node,selector){var nodes=node.querySelectorAll(selector);return[].map.call(nodes,function(element){return element;});}function replace(element,replacement){return element.parentNode.replaceChild(ensureImported(replacement,element),element),replacement;}function wrapMatrix(transformList,transform){return transform instanceof SVGMatrix?transformList.createSVGTransformFromMatrix(transform):transform;}function setTransforms(transformList,transforms){var i,t;for(transformList.clear(),i=0;t=transforms[i];i++)transformList.appendItem(wrapMatrix(transformList,t));transformList.consolidate();}function transform(node,transforms){var transformList=node.transform.baseVal;if(arguments.length===1)return transformList.consolidate();else transforms.length?setTransforms(transformList,transforms):transformList.initialize(wrapMatrix(transformList,transforms));}Object.defineProperty(exports,'__esModule',{value:!0});var LENGTH_ATTR=2;var CSS_PROPERTIES={'alignment-baseline':1,'baseline-shift':1,clip:1,'clip-path':1,'clip-rule':1,color:1,'color-interpolation':1,'color-interpolation-filters':1,'color-profile':1,'color-rendering':1,cursor:1,direction:1,display:1,'dominant-baseline':1,'enable-background':1,fill:1,'fill-opacity':1,'fill-rule':1,filter:1,'flood-color':1,'flood-opacity':1,font:1,'font-family':1,'font-size':LENGTH_ATTR,'font-size-adjust':1,'font-stretch':1,'font-style':1,'font-variant':1,'font-weight':1,'glyph-orientation-horizontal':1,'glyph-orientation-vertical':1,'image-rendering':1,kerning:1,'letter-spacing':1,'lighting-color':1,marker:1,'marker-end':1,'marker-mid':1,'marker-start':1,mask:1,opacity:1,overflow:1,'pointer-events':1,'shape-rendering':1,'stop-color':1,'stop-opacity':1,stroke:1,'stroke-dasharray':1,'stroke-dashoffset':1,'stroke-linecap':1,'stroke-linejoin':1,'stroke-miterlimit':1,'stroke-opacity':1,'stroke-width':LENGTH_ATTR,'text-anchor':1,'text-decoration':1,'text-rendering':1,'unicode-bidi':1,visibility:1,'word-spacing':1,'writing-mode':1};var re=/\s+/;var toString=Object.prototype.toString;ClassList.prototype.add=function(name){if(this.list)return this.list.add(name),this;var arr=this.array();var i=index(arr,name);return~i||arr.push(name),defined(this.el.className.baseVal)?this.el.className.baseVal=arr.join(' '):this.el.className=arr.join(' '),this;},ClassList.prototype.remove=function(name){if('[object RegExp]'===toString.call(name))return this.removeMatching(name);if(this.list)return this.list.remove(name),this;var arr=this.array();var i=index(arr,name);return~i&&arr.splice(i,1),this.el.className.baseVal=arr.join(' '),this;},ClassList.prototype.removeMatching=function(re){var arr=this.array();for(var i=0;i<arr.length;i++)re.test(arr[i])&&this.remove(arr[i]);return this;},ClassList.prototype.toggle=function(name,force){return this.list?(defined(force)?force!==this.list.toggle(name,force)&&this.list.toggle(name):this.list.toggle(name),this):(defined(force)?force?this.add(name):this.remove(name):this.has(name)?this.remove(name):this.add(name),this);},ClassList.prototype.array=function(){var className=this.el.getAttribute('class')||'';var str=className.replace(/^\s+|\s+$/g,'');var arr=str.split(re);return''===arr[0]&&arr.shift(),arr;},ClassList.prototype.has=ClassList.prototype.contains=function(name){return this.list?this.list.contains(name):!!~index(this.array(),name);};var ns={svg:'http://www.w3.org/2000/svg'};var SVG_START='<svg xmlns="'+ns.svg+'"';var node=create('svg');var TEXT_ENTITIES=/([&<>]{1})/g;var ATTR_ENTITIES=/([\n\r"]{1})/g;var ENTITY_REPLACEMENT={'&':'&amp;','<':'&lt;','>':'&gt;','"':"'"};exports.append=append,exports.appendTo=appendTo,exports.attr=attr,exports.classes=classes,exports.clear=clear,exports.clone=clone,exports.create=create,exports.innerSVG=innerSVG,exports.remove=remove,exports.replace=replace,exports.transform=transform,exports.on=on,exports.off=off,exports.createPoint=createPoint,exports.createMatrix=createMatrix,exports.createTransform=createTransform,exports.select=select,exports.selectAll=selectAll;},{}],469:[function(require,module,exports){module.exports='<?xml version="1.0" encoding="UTF-8"?>\n<bpmn2:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn2="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xsi:schemaLocation="http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd" id="sample-diagram" targetNamespace="http://bpmn.io/schema/bpmn">\n  <bpmn2:process id="Process_1" isExecutable="false">\n    <bpmn2:startEvent id="StartEvent_1"/>\n  </bpmn2:process>\n  <bpmndi:BPMNDiagram id="BPMNDiagram_1">\n    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1">\n      <bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1">\n        <dc:Bounds height="36.0" width="36.0" x="412.0" y="240.0"/>\n      </bpmndi:BPMNShape>\n    </bpmndi:BPMNPlane>\n  </bpmndi:BPMNDiagram>\n</bpmn2:definitions>';},{}]},{},[2,4,5,6,3]));
