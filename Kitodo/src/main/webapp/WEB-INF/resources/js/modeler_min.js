/**
 * (c) Kitodo. Key to digital objects e. V. <contact@kitodo.org>
 *
 * This file is part of the Kitodo project.
 *
 * It is licensed under MIT License by camunda Services GmbH
 *
 * For the full copyright and license information, please read the
 * Camunda-License.txt file that was distributed with this source code.
*/


!function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}({1:[function(require,module,exports){"use strict";module.exports=require("./lib")},{"./lib":30}],2:[function(require,module,exports){"use strict";function PropertiesActivator(eventBus,priority){var self=this;priority=priority||1e3,eventBus.on("propertiesPanel.isEntryVisible",priority,function(context){var element=context.element,entry=context.entry,group=context.group,tab=context.tab;return self.isEntryVisible(element,entry,group,tab)}),eventBus.on("propertiesPanel.isPropertyEditable",priority,function(context){var element=context.element,entry=context.entry,group=context.group,propertyName=context.propertyName,tab=context.tab;return self.isPropertyEditable(propertyName,element,entry,group,tab)})}PropertiesActivator.$inject=["eventBus"],(module.exports=PropertiesActivator).prototype.isEntryVisible=function(element,entry,group,tab){return!0},PropertiesActivator.prototype.isPropertyEditable=function(propertyName,element,entry,group,tab){return!0}},{}],3:[function(require,module,exports){"use strict";var createDropdown=require("./Utils").createDropdown,escapeHTML=require("./Utils").escapeHTML,domify=require("min-dom").domify,domQuery=require("min-dom").query,domQueryAll=require("min-dom").queryAll,domRemove=require("min-dom").remove,domClasses=require("min-dom").classes,domClosest=require("min-dom").closest,domAttr=require("min-dom").attr,domDelegate=require("min-dom").delegate,domMatches=require("min-dom").matches,forEach=require("lodash/forEach"),filter=require("lodash/filter"),get=require("lodash/get"),keys=require("lodash/keys"),isEmpty=require("lodash/isEmpty"),isArray=require("lodash/isArray"),isFunction=require("lodash/isFunction"),isObject=require("lodash/isObject"),xor=require("lodash/xor"),debounce=require("lodash/debounce"),flattenDeep=require("lodash/flattenDeep"),keyBy=require("lodash/keyBy"),map=require("lodash/map"),reduce=require("lodash/reduce"),updateSelection=require("selection-update"),scrollTabs=require("scroll-tabs").default,getBusinessObject=require("bpmn-js/lib/util/ModelUtil").getBusinessObject,HIDE_CLASS="bpp-hidden";function isToggle(node){return"checkbox"===node.type||"radio"===node.type}function isContentEditable(node){return domAttr(node,"contenteditable")}function getFormControls(node,all){var controls=domQueryAll("input[name], textarea[name], select[name], [contenteditable]",node);return controls&&controls.length||(controls=domMatches(node,"option")?[node]:controls),all||(controls=filter(controls,function(node){return!domClosest(node,"."+HIDE_CLASS)})),controls}function getFormControlValuesInScope(entryNode){var values={},controlNodes=getFormControls(entryNode);return forEach(controlNodes,function(controlNode){var value=controlNode.value,name=domAttr(controlNode,"name")||domAttr(controlNode,"data-name");isToggle(controlNode)?value=controlNode.checked?!domAttr(controlNode,"value")||controlNode.value:null:isContentEditable(controlNode)&&(value=controlNode.innerText),null!==value&&(values[name]=value)}),values}function getFormControlValues(entryNode){var values,listNodes,listContainer=domQuery("[data-list-entry-container]",entryNode);return listContainer?(values=[],listNodes=listContainer.children||[],forEach(listNodes,function(listNode){values.push(getFormControlValuesInScope(listNode))})):values=getFormControlValuesInScope(entryNode),values}function valueEqual(value,oldValue){return!(value&&!oldValue)&&keys(value).concat(keys(oldValue)).every(function(key){return value[key]===oldValue[key]})}function extractEntries(tabs){return keyBy(flattenDeep(map(flattenDeep(map(tabs,"groups")),"entries")),"id")}function PropertiesPanel(config,eventBus,modeling,propertiesProvider,commandStack,canvas){this._eventBus=eventBus,this._modeling=modeling,this._commandStack=commandStack,this._canvas=canvas,this._propertiesProvider=propertiesProvider,this._init(config)}function isImplicitRoot(element){return"__implicitroot"===element.id}PropertiesPanel.$inject=["config.propertiesPanel","eventBus","modeling","propertiesProvider","commandStack","canvas"],(module.exports=PropertiesPanel).prototype._init=function(config){var canvas=this._canvas,eventBus=this._eventBus,self=this;eventBus.on("root.added",function(e){var element=e.element;isImplicitRoot(element)||self.update(element)}),eventBus.on("selection.changed",function(e){var newElement=e.newSelection[0];isImplicitRoot(canvas.getRootElement())||self.update(newElement)}),eventBus.on(["propertiesPanel.changed","propertiesPanel.resized"],function(event){var scroller,tabBarNode=domQuery(".bpp-properties-tab-bar",self._container);tabBarNode&&((scroller=scrollTabs.get(tabBarNode))||(scroller=scrollTabs(tabBarNode,{selectors:{tabsContainer:".bpp-properties-tabs-links",tab:".bpp-properties-tabs-links li",ignore:".bpp-hidden",active:".bpp-active"}})).on("scroll",function(newActiveNode,oldActiveNode,direction){var linkNode=domQuery("[data-tab-target]",newActiveNode),tabId=domAttr(linkNode,"data-tab-target");self.activateTab(tabId)}),scroller.update())}),eventBus.on("elements.changed",function(e){var current=self._current,element=current&&current.element;element&&-1!==e.elements.indexOf(element)&&self.update(element)}),eventBus.on("elementTemplates.changed",function(){var current=self._current,element=current&&current.element;element&&self.update(element)}),eventBus.on("diagram.destroy",function(){self.detach()}),this._container=domify('<div class="bpp-properties-panel"></div>'),this._bindListeners(this._container),config&&config.parent&&this.attachTo(config.parent)},PropertiesPanel.prototype.attachTo=function(parentNode){if(!parentNode)throw new Error("parentNode required");this.detach(),parentNode.get&&parentNode.constructor.prototype.jquery&&(parentNode=parentNode.get(0)),"string"==typeof parentNode&&(parentNode=domQuery(parentNode));var container=this._container;parentNode.appendChild(container),this._emit("attach")},PropertiesPanel.prototype.detach=function(){var container=this._container,parentNode=container.parentNode;parentNode&&(this._emit("detach"),parentNode.removeChild(container))},PropertiesPanel.prototype.activateTab=function(tabId){isObject(tabId)&&(tabId=tabId.id);var tabs=domQueryAll(".bpp-properties-tab",this._current.panel),tabLinks=domQueryAll(".bpp-properties-tab-link",this._current.panel);forEach(tabs,function(tab){domClasses(tab).remove("bpp-active")}),forEach(tabLinks,function(tabLink){domClasses(tabLink).remove("bpp-active")});var visibleTabs=filter(tabs,function(tab){return!domClasses(tab).has(HIDE_CLASS)}),activeTab=reduce(visibleTabs,function(activeTab,tab){return domAttr(tab,"data-tab")===tabId?tab:activeTab},visibleTabs[0]);activeTab&&domClasses(activeTab).add("bpp-active");var visibleTabLinks=filter(tabLinks,function(tabLink){return!domClasses(tabLink).has(HIDE_CLASS)}),activeTabLink=reduce(visibleTabLinks,function(activeTabLink,tabLink){return domAttr(domQuery("a[data-tab-target]",tabLink),"data-tab-target")===tabId?tabLink:activeTabLink},visibleTabLinks[0]);activeTabLink&&domClasses(activeTabLink).add("bpp-active")},PropertiesPanel.prototype.update=function(element){element=element||this._canvas.getRootElement();var activeTabId,activeTabNode,tabs=this._propertiesProvider.getTabs(element);this._current&&(activeTabNode=domQuery(".bpp-properties-tab.bpp-active",this._current.panel))&&(activeTabId=domAttr(activeTabNode,"data-tab")),this._current&&this._current.element===element&&!this._entriesChanged(this._current.entries,extractEntries(tabs))||(this._current&&domRemove(this._current.panel),this._current=this._create(element,tabs)),this._updateActivation(this._current),activeTabId?this.activateTab(activeTabId):this.activateTab(this._current.tabs[0]),this._emit("changed")},PropertiesPanel.prototype._entriesChanged=function(prevEntries,entries){var prevEntryIds=keys(prevEntries),entryIds=keys(entries);return!isEmpty(xor(prevEntryIds,entryIds))},PropertiesPanel.prototype._emit=function(event){this._eventBus.fire("propertiesPanel."+event,{panel:this,current:this._current})},PropertiesPanel.prototype._bindListeners=function(container){var self=this,handleChange=function(event){var entryId,entry,inputNode=event.delegateTarget,entryNode=domClosest(inputNode,"[data-entry]");if(entryNode){entryId=domAttr(entryNode,"data-entry"),entry=self.getEntry(entryId);var values=getFormControlValues(entryNode);if("change"===event.type){var onChangeAction=domAttr(inputNode,"data-on-change");if(onChangeAction)if(!self.executeAction(entry,entryNode,onChangeAction,event))return self.update(self._current.element)}self.applyChanges(entry,values,entryNode),self.updateState(entry,entryNode)}};domDelegate.bind(container,"input, textarea, [contenteditable]","input",debounce(handleChange,300)),domDelegate.bind(container,"input, textarea, select, [contenteditable]","change",handleChange),domDelegate.bind(container,"[contenteditable]","paste",function(event){var text=(event.clipboardData||window.clipboardData).getData("text");document.execCommand("insertText",!1,text),event.preventDefault()}),domDelegate.bind(container,"select","keydown",function(e){46===e.keyCode&&(e.stopPropagation(),e.preventDefault())}),domDelegate.bind(container,"[data-auto-suggest]","input",function(event){var action,entryId,entry,inputNode=event.delegateTarget,entryNode=domClosest(inputNode,"[data-entry]");entryNode&&(action=domAttr(inputNode,"data-auto-suggest"),entryId=domAttr(entryNode,"data-entry"),entry=self.getEntry(entryId),self.executeAction(entry,entryNode,action,event))},!0),domDelegate.bind(container,"[data-action]","click",function(event){var inputNode=event.delegateTarget,entryNode=domClosest(inputNode,"[data-entry]"),actionId=domAttr(inputNode,"data-action"),entryId=domAttr(entryNode,"data-entry"),entry=self.getEntry(entryId);if(!self.executeAction(entry,entryNode,actionId,event))return self.update(self._current.element);var values=getFormControlValues(entryNode);self.applyChanges(entry,values,entryNode),self.updateState(entry,entryNode)}),domDelegate.bind(container,"[data-blur]","blur",function(event,element){var eventHandlerId,entryId,entry,values,inputNode=event.delegateTarget,entryNode=domClosest(inputNode,"[data-entry]");entryNode&&(eventHandlerId=domAttr(inputNode,"data-blur"),entryId=domAttr(entryNode,"data-entry"),entry=self.getEntry(entryId),self.executeAction(entry,entryNode,eventHandlerId,event)&&(values=getFormControlValues(entryNode),self.applyChanges(entry,values,entryNode)),self.updateState(entry,entryNode))},!0),domDelegate.bind(container,".bpp-properties-tabs-links [data-tab-target]","click",function(event){event.preventDefault();var delegateTarget=event.delegateTarget,tabId=domAttr(delegateTarget,"data-tab-target");self.activateTab(tabId)})},PropertiesPanel.prototype.updateState=function(entry,entryNode){this.updateShow(entry,entryNode),this.updateDisable(entry,entryNode)},PropertiesPanel.prototype.updateShow=function(entry,node){var showNodes,current=this._current;current&&(showNodes=domQueryAll("[data-show]",node)||[],forEach(showNodes,function(showNode){var scope,expr=domAttr(showNode,"data-show"),fn=get(entry,expr);fn&&(scope=domClosest(showNode,"[data-scope]")||node,fn(current.element,node,showNode,scope)||!1?domClasses(showNode).remove(HIDE_CLASS):domClasses(showNode).add(HIDE_CLASS))}))},PropertiesPanel.prototype.updateDisable=function(entry,node){var nodes,current=this._current;current&&(nodes=domQueryAll("[data-disable]",node)||[],forEach(nodes,function(currentNode){var scope,shouldDisable,expr=domAttr(currentNode,"data-disable"),fn=get(entry,expr);fn&&(scope=domClosest(currentNode,"[data-scope]")||node,shouldDisable=fn(current.element,node,currentNode,scope)||!1,domAttr(currentNode,"disabled",shouldDisable?"":null))}))},PropertiesPanel.prototype.executeAction=function(entry,entryNode,actionId,event){var current=this._current;if(current){var fn=get(entry,actionId);if(fn){var scopeNode=domClosest(event.target,"[data-scope]")||entryNode;return fn.apply(entry,[current.element,entryNode,event,scopeNode])}}},PropertiesPanel.prototype.applyChanges=function(entry,values,containerElement){var command,commandToExecute,element=this._current.element;!function(values,oldValues){return isArray(values)?values.length===oldValues.length&&values.every(function(v,idx){return valueEqual(v,oldValues[idx])}):valueEqual(values,oldValues)}(values,entry.oldValues)&&(command=entry.set(element,values,containerElement),isArray(command)?command.length&&(commandToExecute={cmd:"properties-panel.multi-command-executor",context:flattenDeep(command)}):commandToExecute=command,commandToExecute?this._commandStack.execute(commandToExecute.cmd,commandToExecute.context||{element:element}):this.update(element))},PropertiesPanel.prototype.applyValidationErrors=function(validationErrors,entryNode){var valid=!0,controlNodes=getFormControls(entryNode,!0);return forEach(controlNodes,function(controlNode){var name=domAttr(controlNode,"name")||domAttr(controlNode,"data-name"),error=validationErrors&&validationErrors[name],errorMessageNode=domQuery(".bpp-error-message",controlNode.parentNode);error?(valid=!1,errorMessageNode||(errorMessageNode=domify("<div></div>"),domClasses(errorMessageNode).add("bpp-error-message"),controlNode.parentNode.insertBefore(errorMessageNode,controlNode.nextSibling)),errorMessageNode.textContent=error,domClasses(controlNode).add("invalid")):(domClasses(controlNode).remove("invalid"),errorMessageNode&&controlNode.parentNode.removeChild(errorMessageNode))}),valid},PropertiesPanel.prototype.validate=function(entry,values,entryNode){var current=this._current,valid=!0;if(entryNode=entryNode||domQuery('[data-entry="'+entry.id+'"]',current.panel),values instanceof Array)for(var listEntryNodes=domQuery("[data-list-entry-container]",entryNode).children||[],i=0;i<values.length;i++){var validationErrors,listEntryNode,listValue=values[i];entry.validateListItem&&(validationErrors=entry.validateListItem(current.element,listValue,entryNode,i),listEntryNode=listEntryNodes[i],valid=this.applyValidationErrors(validationErrors,listEntryNode)&&valid)}else entry.validate&&(this.validationErrors=entry.validate(current.element,values,entryNode),valid=this.applyValidationErrors(this.validationErrors,entryNode)&&valid);return valid},PropertiesPanel.prototype.getEntry=function(id){return this._current&&this._current.entries[id]},PropertiesPanel.prototype._create=function(element,tabs){if(!element)return null;var containerNode=this._container,panelNode=this._createPanel(element,tabs);containerNode.appendChild(panelNode);var entries=extractEntries(tabs);return{tabs:tabs,groups:function(tabs){return keyBy(flattenDeep(map(tabs,"groups")),"id")}(tabs),entries:entries,element:element,panel:panelNode}},PropertiesPanel.prototype._bindTemplate=function(element,entry,values,entryNode,idx){var eventBus=this._eventBus;var node,selector,placeholders,inputNodes=((placeholders=domQueryAll(selector="input[name], textarea[name], [data-value], [contenteditable]",node=entryNode))&&placeholders.length||!domMatches(node,selector)||(placeholders=[node]),placeholders);forEach(inputNodes,function(node){var name,newValue,editable;"value"in node||"true"===isContentEditable(node)?(name=domAttr(node,"name")||domAttr(node,"data-name"),newValue=values[name],(editable=function(entry,propertyName){return eventBus.fire("propertiesPanel.isPropertyEditable",{entry:entry,propertyName:propertyName,element:element})}(entry,name))&&entry.editable&&(editable=entry.editable(element,entryNode,node,name,newValue,idx)),domAttr(node,"readonly",editable?null:""),domAttr(node,"disabled",editable?null:""),entry.setControlValue?entry.setControlValue(element,entryNode,node,name,newValue,idx):(isToggle(node)?function(node,value){var nodeValue=node.value;node.checked=value===nodeValue||!domAttr(node,"value")&&value}:"select-one"===node.type?function(node,value){void 0!==value&&(node.value=value)}:function(node,value){var selection,contentEditable=isContentEditable(node),oldValue=contentEditable?node.innerText:node.value;void 0===value&&(value="");if(oldValue===value)return;document.activeElement===node&&(selection=updateSelection(function(node){return isContentEditable(node)?function(node){var selection=window.getSelection(),focusNode=selection.focusNode,focusOffset=selection.focusOffset,anchorOffset=selection.anchorOffset;if(!focusNode)throw new Error("not selected");if(node.contains(focusNode))return{start:Math.min(focusOffset,anchorOffset),end:Math.max(focusOffset,anchorOffset)};throw new Error("not selected")}(node):{start:node.selectionStart,end:node.selectionEnd}}(node),oldValue,value));contentEditable?node.innerText=value:node.value=value;selection&&function(node,selection){isContentEditable(node)?function(node,selection){var focusNode,domRange,domSelection;focusNode=node.firstChild||node,(domRange=document.createRange()).setStart(focusNode,selection.start),domRange.setEnd(focusNode,selection.end),(domSelection=window.getSelection()).removeAllRanges(),domSelection.addRange(domRange)}(node,selection):(node.selectionStart=selection.start,node.selectionEnd=selection.end)}(node,selection)})(node,newValue)):(name=domAttr(node,"data-value"),newValue=values[name],entry.setControlValue?entry.setControlValue(element,entryNode,node,name,newValue,idx):function(node,value){node.textContent=value}(node,newValue))})},PropertiesPanel.prototype._updateActivation=function(current){var self=this,eventBus=this._eventBus,element=current.element;function toggleVisible(node,visible){domClasses(node).toggle(HIDE_CLASS,!visible)}function updateLabel(element,selector,text){var labelNode=domQuery(selector,element);labelNode&&(labelNode.textContent=text)}var panelNode=current.panel;forEach(current.tabs,function(tab){var tabNode=domQuery("[data-tab="+tab.id+"]",panelNode),tabLinkNode=domQuery("[data-tab-target="+tab.id+"]",panelNode).parentNode,tabVisible=!1;forEach(tab.groups,function(group){var groupVisible=!1,groupNode=domQuery("[data-group="+group.id+"]",tabNode);forEach(group.entries,function(entry){var entryNode=domQuery('[data-entry="'+entry.id+'"]',groupNode),entryVisible=function(entry,group,tab){return eventBus.fire("propertiesPanel.isEntryVisible",{element:element,entry:entry,group:group,tab:tab})}(entry,group,tab);groupVisible=groupVisible||entryVisible,toggleVisible(entryNode,entryVisible);var values="get"in entry?entry.get(element,entryNode):{};if(values instanceof Array){for(var listEntryContainer=domQuery("[data-list-entry-container]",entryNode),existingElements=listEntryContainer.children||[],i=0;i<values.length;i++){var listValue=values[i],listItemNode=existingElements[i];listItemNode||(listItemNode=domify(entry.createListEntryTemplate(listValue,i,listEntryContainer)),listEntryContainer.appendChild(listItemNode)),domAttr(listItemNode,"data-index",i),self._bindTemplate(element,entry,listValue,listItemNode,i)}for(var entriesToRemove=existingElements.length-values.length,j=0;j<entriesToRemove;j++)listEntryContainer.removeChild(listEntryContainer.lastChild)}else self._bindTemplate(element,entry,values,entryNode);self.updateState(entry,entryNode),self.validate(entry,values,entryNode),entry.oldValues=getFormControlValues(entryNode)}),"function"==typeof group.label&&updateLabel(groupNode,".group-label",group.label(element,groupNode)),groupVisible=groupVisible&&function(group,element,groupNode){return!isFunction(group.enabled)||group.enabled(element,groupNode)}(group,element,groupNode),tabVisible=tabVisible||groupVisible,toggleVisible(groupNode,groupVisible)}),tabVisible=tabVisible&&function(tab,element){return!isFunction(tab.enabled)||tab.enabled(element)}(tab,element),toggleVisible(tabNode,tabVisible),toggleVisible(tabLinkNode,tabVisible)}),updateLabel(panelNode,"[data-label-id]",getBusinessObject(element).id||"")},PropertiesPanel.prototype._createPanel=function(element,tabs){var self=this,panelNode=domify('<div class="bpp-properties"></div>'),headerNode=domify('<div class="bpp-properties-header"><div class="label" data-label-id></div></div>'),tabBarNode=domify('<div class="bpp-properties-tab-bar"></div>'),tabLinksNode=domify('<ul class="bpp-properties-tabs-links"></ul>'),tabContainerNode=domify('<div class="bpp-properties-tabs-container"></div>');return panelNode.appendChild(headerNode),forEach(tabs,function(tab,tabIndex){if(!tab.id)throw new Error("tab must have an id");var tabNode=domify('<div class="bpp-properties-tab" data-tab="'+escapeHTML(tab.id)+'"></div>'),tabLinkNode=domify('<li class="bpp-properties-tab-link"><a href data-tab-target="'+escapeHTML(tab.id)+'">'+escapeHTML(tab.label)+"</a></li>"),groups=tab.groups;forEach(groups,function(group){if(!group.id)throw new Error("group must have an id");var groupNode=domify('<div class="bpp-properties-group" data-group="'+escapeHTML(group.id)+'"><span class="group-toggle"></span><div class="group-header"><span class="group-label">'+escapeHTML(group.label)+"</span></div></div>");group.dropdown&&domQuery(".group-header",groupNode).appendChild(createDropdown(group.dropdown)),groupNode.querySelector(".group-toggle").addEventListener("click",function(evt){domClasses(groupNode).toggle("group-closed"),evt.preventDefault(),evt.stopPropagation()}),groupNode.addEventListener("click",function(evt){!evt.defaultPrevented&&domClasses(groupNode).has("group-closed")&&domClasses(groupNode).remove("group-closed")}),forEach(group.entries,function(entry){if(!entry.id)throw new Error("entry must have an id");var html=entry.html;"string"==typeof html&&(html=domify(html)),html.get&&html.constructor.prototype.jquery&&(html=html.get(0));var entryNode=domify('<div class="bpp-properties-entry" data-entry="'+escapeHTML(entry.id)+'"></div>');forEach(entry.cssClasses||[],function(cssClass){domClasses(entryNode).add(cssClass)}),entryNode.appendChild(html),groupNode.appendChild(entryNode),self.updateState(entry,entryNode)}),tabNode.appendChild(groupNode)}),tabLinksNode.appendChild(tabLinkNode),tabContainerNode.appendChild(tabNode)}),tabBarNode.appendChild(tabLinksNode),panelNode.appendChild(tabBarNode),panelNode.appendChild(tabContainerNode),panelNode}},{"./Utils":4,"bpmn-js/lib/util/ModelUtil":177,"lodash/debounce":555,"lodash/filter":557,"lodash/flattenDeep":560,"lodash/forEach":561,"lodash/get":562,"lodash/isArray":566,"lodash/isEmpty":570,"lodash/isFunction":571,"lodash/isObject":573,"lodash/keyBy":577,"lodash/keys":578,"lodash/map":579,"lodash/reduce":584,"lodash/xor":593,"min-dom":48,"scroll-tabs":604,"selection-update":605}],4:[function(require,module,exports){"use strict";var domQuery=require("min-dom").query,domClear=require("min-dom").clear,domClasses=require("min-dom").classes,is=require("bpmn-js/lib/util/ModelUtil").is,forEach=require("lodash/forEach"),domify=require("min-dom").domify,Ids=require("ids").default,SPACE_REGEX=/\s/,QNAME_REGEX=/^([a-z][\w-.]*:)?[a-z_][\w-.]*$/i,ID_REGEX=/^[a-z_][\w-.]*$/i,HTML_ESCAPE_MAP={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function selectedOption(selectBox){if(0<=selectBox.selectedIndex)return selectBox.options[selectBox.selectedIndex].value}function getRoot(businessObject){for(var parent=businessObject;parent.$parent;)parent=parent.$parent;return parent}function filterElementsByType(objectList,type){var result=[];return forEach(objectList||[],function(obj){is(obj,type)&&result.push(obj)}),result}function findRootElementsByType(businessObject,referencedType){return filterElementsByType(getRoot(businessObject).rootElements,referencedType)}function addEmptyParameter(list){return list.push({label:"",value:"",name:""})}function refreshOptionsModel(businessObject,referencedType){var model=[],referableObjects=findRootElementsByType(businessObject,referencedType);return forEach(referableObjects,function(obj){model.push({label:(obj.name||"")+" (id="+obj.id+")",value:obj.id,name:obj.name})}),model}function validateId(idValue,translate){return containsSpace(idValue)?translate("Id must not contain spaces."):ID_REGEX.test(idValue)?void 0:QNAME_REGEX.test(idValue)?translate("Id must not contain prefix."):translate("Id must be a valid QName.")}function containsSpace(value){return SPACE_REGEX.test(value)}function escapeHTML(str){return(str=""+str)&&str.replace(/[&<>"']/g,function(match){return HTML_ESCAPE_MAP[match]})}module.exports.selectedOption=selectedOption,module.exports.selectedType=function(elementSyntax,inputNode){return selectedOption(domQuery(elementSyntax,inputNode))},module.exports.getRoot=getRoot,module.exports.filterElementsByType=filterElementsByType,module.exports.findRootElementsByType=findRootElementsByType,module.exports.removeAllChildren=function(domElement){for(;domElement.firstChild;)domElement.removeChild(domElement.firstChild)},module.exports.addEmptyParameter=addEmptyParameter,module.exports.refreshOptionsModel=refreshOptionsModel,module.exports.updateOptionsDropDown=function(domSelector,businessObject,referencedType,entryNode){var options=refreshOptionsModel(businessObject,referencedType);addEmptyParameter(options);var selectBox=domQuery(domSelector,entryNode);return domClear(selectBox),forEach(options,function(option){var optionEntry=domify('<option value="'+escapeHTML(option.value)+'">'+escapeHTML(option.label)+"</option>");selectBox.appendChild(optionEntry)}),options},module.exports.isIdValid=function(bo,idValue,translate){var assigned=bo.$model.ids.assigned(idValue);return!idValue||assigned&&assigned!==bo?translate("Element must have an unique id."):validateId(idValue,translate)},module.exports.validateId=validateId,module.exports.containsSpace=containsSpace,module.exports.nextId=function(prefix){return new Ids([32,32,1]).nextPrefixed(prefix)},module.exports.triggerClickEvent=function(element){var evt;if(document.createEvent){try{evt=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0})}catch(e){(evt=document.createEvent("MouseEvent")).initEvent("click",!0,!0)}return element.dispatchEvent(evt)}return evt=document.createEventObject(),element.fireEvent("onclick",evt)},module.exports.escapeHTML=escapeHTML,module.exports.createDropdown=function(dropdown){var _onGlobalClick,menu=dropdown.menu,dropdownNode=domify('<div class="group__dropdown"><button class="group__dropdown-button"><svg width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 192 512"><path fill="currentColor" d="M96 184c39.8 0 72 32.2 72 72s-32.2 72-72 72-72-32.2-72-72 32.2-72 72-72zM24 80c0 39.8 32.2 72 72 72s72-32.2 72-72S135.8 8 96 8 24 40.2 24 80zm0 352c0 39.8 32.2 72 72 72s72-32.2 72-72-32.2-72-72-72-72 32.2-72 72z"></path></svg></button><div class="group__dropdown-menu"></div></div>'),buttonNode=domQuery(".group__dropdown-button",dropdownNode),menuNode=domQuery(".group__dropdown-menu",dropdownNode);return buttonNode.addEventListener("click",function(event){domClasses(dropdownNode).toggle("group__dropdown--open"),function(_event){function onGlobalClick(event){var target;event!==_event&&(target=event.target,menuNode===target||menuNode.contains(target)||(domClasses(dropdownNode).remove("group__dropdown--open"),document.removeEventListener("click",onGlobalClick)))}_onGlobalClick&&document.removeEventListener("click",_onGlobalClick);document.addEventListener("click",onGlobalClick),_onGlobalClick=onGlobalClick}(event)}),forEach(menu,function(menuItem){var menuItemNode=domify('<div class="group__dropdown-menu-item" data-dropdown-action="'+menuItem.id+'">'+escapeHTML(menuItem.label)+"</div>");menuItemNode.addEventListener("click",function(){menuItem.onClick(),domClasses(dropdownNode).remove("group__dropdown--open")}),menuNode.appendChild(menuItemNode)}),dropdownNode}},{"bpmn-js/lib/util/ModelUtil":177,ids:384,"lodash/forEach":561,"min-dom":48}],5:[function(require,module,exports){"use strict";var elementHelper=require("../helper/ElementHelper");function CreateAndReferenceElementHandler(elementRegistry,bpmnFactory){this._elementRegistry=elementRegistry,this._bpmnFactory=bpmnFactory}function ensureNotNull(prop,name){if(!prop)throw new Error(name+" required");return prop}CreateAndReferenceElementHandler.$inject=["elementRegistry","bpmnFactory"],(module.exports=CreateAndReferenceElementHandler).prototype.execute=function(context){var referencingObject=ensureNotNull(context.referencingObject,"referencingObject"),referenceProperty=ensureNotNull(context.referenceProperty,"referenceProperty"),newObject=ensureNotNull(context.newObject,"newObject"),newObjectContainer=ensureNotNull(context.newObjectContainer,"newObjectContainer"),newObjectParent=ensureNotNull(context.newObjectParent,"newObjectParent"),changed=[context.element],referencedObject=elementHelper.createElement(newObject.type,newObject.properties,newObjectParent,this._bpmnFactory);return context.referencedObject=referencedObject,newObjectContainer.push(referencedObject),context.previousReference=referencingObject[referenceProperty],referencingObject[referenceProperty]=referencedObject,context.changed=changed},CreateAndReferenceElementHandler.prototype.revert=function(context){var referencingObject=context.referencingObject,referenceProperty=context.referenceProperty,previousReference=context.previousReference,referencedObject=context.referencedObject,newObjectContainer=context.newObjectContainer;return referencingObject.set(referenceProperty,previousReference),newObjectContainer.splice(newObjectContainer.indexOf(referencedObject),1),context.changed}},{"../helper/ElementHelper":27}],6:[function(require,module,exports){"use strict";var forEach=require("lodash/forEach"),elementHelper=require("../helper/ElementHelper");function CreateBusinessObjectListHandler(elementRegistry,bpmnFactory){this._elementRegistry=elementRegistry,this._bpmnFactory=bpmnFactory}function ensureNotNull(prop,name){if(!prop)throw new Error(name+" required");return prop}CreateBusinessObjectListHandler.$inject=["elementRegistry","bpmnFactory"],(module.exports=CreateBusinessObjectListHandler).prototype.execute=function(context){var currentObject=ensureNotNull(context.currentObject,"currentObject"),propertyName=ensureNotNull(context.propertyName,"propertyName"),newObjects=function(prop,name){if(!prop||"[object Array]"!==Object.prototype.toString.call(prop))throw new Error(name+" needs to be a list");return prop}(context.newObjects,"newObjects"),changed=[context.element],childObjects=[],self=this;return forEach(newObjects,function(obj){var element=elementHelper.createElement(obj.type,obj.properties,currentObject,self._bpmnFactory);childObjects.push(element)}),context.childObject=childObjects,context.previousChilds=currentObject[propertyName],currentObject[propertyName]=childObjects,context.changed=changed},CreateBusinessObjectListHandler.prototype.revert=function(context){var currentObject=context.currentObject,propertyName=context.propertyName,previousChilds=context.previousChilds;return currentObject.set(propertyName,previousChilds),context.changed}},{"../helper/ElementHelper":27,"lodash/forEach":561}],7:[function(require,module,exports){"use strict";var forEach=require("lodash/forEach");function MultiCommandHandler(commandStack){this._commandStack=commandStack}MultiCommandHandler.$inject=["commandStack"],(module.exports=MultiCommandHandler).prototype.preExecute=function(context){var commandStack=this._commandStack;forEach(context,function(command){commandStack.execute(command.cmd,command.context)})}},{"lodash/forEach":561}],8:[function(require,module,exports){"use strict";var reduce=require("lodash/transform"),is=require("bpmn-js/lib/util/ModelUtil").is,keys=require("lodash/keys"),forEach=require("lodash/forEach");function UpdateBusinessObjectHandler(elementRegistry){this._elementRegistry=elementRegistry}function setProperties(businessObject,properties){forEach(properties,function(value,key){businessObject.set(key,value)})}UpdateBusinessObjectHandler.$inject=["elementRegistry"],(module.exports=UpdateBusinessObjectHandler).prototype.execute=function(context){var element=context.element,businessObject=context.businessObject,rootElements=function(businessObject){for(var parent=businessObject;parent.$parent;)parent=parent.$parent;return parent}(businessObject).rootElements,referenceType=context.referenceType,referenceProperty=context.referenceProperty,changed=[element];if(!element)throw new Error("element required");if(!businessObject)throw new Error("businessObject required");var properties=context.properties,oldProperties=context.oldProperties||function(businessObject,propertyNames){return reduce(propertyNames,function(result,key){return result[key]=businessObject.get(key),result},{})}(businessObject,keys(properties));return void 0!==referenceType&&void 0!==referenceProperty&&forEach(rootElements,function(rootElement){is(rootElement,referenceType)&&rootElement.id===properties[referenceProperty]&&(properties[referenceProperty]=rootElement)}),setProperties(businessObject,properties),context.oldProperties=oldProperties,context.changed=changed},UpdateBusinessObjectHandler.prototype.revert=function(context){var oldProperties=context.oldProperties;return setProperties(context.businessObject,oldProperties),context.changed}},{"bpmn-js/lib/util/ModelUtil":177,"lodash/forEach":561,"lodash/keys":578,"lodash/transform":591}],9:[function(require,module,exports){"use strict";var forEach=require("lodash/forEach");function UpdateBusinessObjectListHandler(elementRegistry,bpmnFactory){this._elementRegistry=elementRegistry,this._bpmnFactory=bpmnFactory}function ensureNotNull(prop,name){if(!prop)throw new Error(name+"required");return prop}UpdateBusinessObjectListHandler.$inject=["elementRegistry","bpmnFactory"],(module.exports=UpdateBusinessObjectListHandler).prototype.execute=function(context){var referencePropertyName,currentObject=ensureNotNull(context.currentObject,"currentObject"),propertyName=ensureNotNull(context.propertyName,"propertyName"),updatedObjectList=context.updatedObjectList,objectsToRemove=context.objectsToRemove||[],objectsToAdd=context.objectsToAdd||[],objectsToPrepend=context.objectsToPrepend||[],changed=[context.element];context.referencePropertyName&&(referencePropertyName=context.referencePropertyName);var listCopy,objectList=currentObject[propertyName];return context.previousList=currentObject[propertyName],updatedObjectList?currentObject[propertyName]=updatedObjectList:(listCopy=objectsToPrepend.slice(),forEach(objectList,function(object){-1==objectsToRemove.indexOf(object)&&listCopy.push(object)}),0<(listCopy=listCopy.concat(objectsToAdd)).length||!referencePropertyName?currentObject[propertyName]=listCopy:referencePropertyName&&currentObject.$parent.set(referencePropertyName,void 0)),context.changed=changed},UpdateBusinessObjectListHandler.prototype.revert=function(context){var currentObject=context.currentObject,propertyName=context.propertyName,previousList=context.previousList,parentObject=currentObject.$parent;return context.referencePropertyName&&parentObject.set(context.referencePropertyName,currentObject),currentObject.set(propertyName,previousList),context.changed}},{"lodash/forEach":561}],10:[function(require,module,exports){"use strict";var forEach=require("lodash/forEach"),HANDLERS={"properties-panel.update-businessobject":require("./UpdateBusinessObjectHandler"),"properties-panel.create-and-reference":require("./CreateAndReferenceHandler"),"properties-panel.create-businessobject-list":require("./CreateBusinessObjectListHandler"),"properties-panel.update-businessobject-list":require("./UpdateBusinessObjectListHandler"),"properties-panel.multi-command-executor":require("./MultiCommandHandler")};function CommandInitializer(eventBus,commandStack){eventBus.on("diagram.init",function(){forEach(HANDLERS,function(handler,id){commandStack.registerHandler(id,handler)})})}CommandInitializer.$inject=["eventBus","commandStack"],module.exports={__init__:[CommandInitializer]}},{"./CreateAndReferenceHandler":5,"./CreateBusinessObjectListHandler":6,"./MultiCommandHandler":7,"./UpdateBusinessObjectHandler":8,"./UpdateBusinessObjectListHandler":9,"lodash/forEach":561}],11:[function(require,module,exports){"use strict";var domClasses=require("min-dom").classes,domify=require("min-dom").domify,domQuery=require("min-dom").query,assign=require("min-dash").assign,find=require("min-dash").find,forEach=require("min-dash").forEach,debounce=require("min-dash").debounce,escapeHTML=require("../Utils").escapeHTML,entryFieldDescription=require("./EntryFieldDescription"),CLASS_ACTIVE="active",noop=function(){};function getSelectionRange(){var selection=document.getSelection();return{range:selection.getRangeAt(0),focusNode:selection.focusNode}}function hideSuggestionList(entryNode){var listNode=domQuery(".bpp-autosuggest-list",entryNode);domClasses(listNode).remove(CLASS_ACTIVE)}function clearSuggestionList(entryNode){for(var listNode=domQuery(".bpp-autosuggest-list",entryNode);listNode.firstChild;)listNode.removeChild(listNode.firstChild)}module.exports=function(translate,options,defaultParameters){var resource=defaultParameters,label=options.label||resource.id,canBeShown=!!options.show&&"function"==typeof options.show,description=options.description;function getSuggestionListPosition(listNode,container){var cursorBounds=getSelectionRange().range.getBoundingClientRect(),clientBounds=container.getBoundingClientRect(),listBounds=listNode.getBoundingClientRect(),coordinates={"top-left":{x:cursorBounds.right-listBounds.width,y:cursorBounds.top-listBounds.height},"top-right":{x:cursorBounds.right,y:cursorBounds.top-listBounds.height},"bottom-left":{x:cursorBounds.right-listBounds.width,y:cursorBounds.top+15},"bottom-right":{x:cursorBounds.right,y:cursorBounds.top+15}},orientation="",orientation=cursorBounds.top+15+listBounds.height>clientBounds.height+clientBounds.top?"top-":"bottom-";return cursorBounds.right+listBounds.width>clientBounds.width+clientBounds.left?orientation+="left":orientation+="right",{orientation:orientation,position:coordinates[orientation]}}return resource.html=domify('<label for="camunda-'+escapeHTML(resource.id)+'" '+(canBeShown?'data-show="isShown"':"")+">"+label+'</label><div class="bpp-field-wrapper" '+(canBeShown?'data-show="isShown"':"")+'><div contenteditable="true"id="camunda-'+escapeHTML(resource.id)+'" name="'+escapeHTML(options.modelProperty)+'" data-auto-suggest="suggestItems"data-blur="handleFocusLeave"></div><div class="bpp-autosuggest-list"></div></div>'),description&&domQuery(".bpp-field-wrapper",resource.html).appendChild(entryFieldDescription(translate,description)),canBeShown&&(resource.isShown=function(){return options.show.apply(resource,arguments)}),resource.handleFocusLeave=debounce(function(element,entryNode){clearSuggestionList(entryNode),hideSuggestionList(entryNode)},"150"),resource.suggestItems=function(element,entryNode,event){var editorNode=event.delegateTarget,range=getSelectionRange(),focusNode=range.focusNode,caretPosition=range.range.startOffset,canSuggest=options.canSuggest||noop,getItems=options.getItems;function handleItemClick(event){var value=event.target.innerText,wordIndex=currentWord.index,end=wordIndex+currentWord[0].length;!function(focusNode,start,end){var range=document.createRange(),selection=window.getSelection();range.setStart(focusNode,start),range.setEnd(focusNode,end),selection.removeAllRanges(),selection.addRange(range)}(focusNode,wordIndex,end),document.execCommand("insertText",!1,value),clearSuggestionList(entryNode),hideSuggestionList(entryNode)}hideSuggestionList(entryNode);var node,currentCursorPositon,allWords,items,results,value,currentWord=(currentCursorPositon=caretPosition,allWords=function(value){return function(value,regex){var match,regexp=RegExp(regex),matches=[];for(;null!==(match=regexp.exec(value));)matches.push(match);return matches}(value,/[^\s\r\(\)\,\+\-\*\/\{\}]+/g)}("#text"===(node=focusNode).nodeName?node.wholeText:node.innerText),find(allWords,function(word){var matchValue=word[0],wordStart=word.index,wordEnd=wordStart+matchValue.length-1;return wordStart<=currentCursorPositon-1&&currentCursorPositon-1<=wordEnd})||[]);currentWord&&canSuggest(currentWord,editorNode,focusNode)&&(items=getItems(element,entryNode),results=[],value=currentWord[0],forEach(items,function(item){var itemLowerCase=item.toLowerCase(),valueLowerCase=value&&value.toLowerCase();0===itemLowerCase.indexOf(valueLowerCase)&&results.push(item)}),forEach(items,function(item){var itemLowerCase=item.toLowerCase(item),valueLowerCase=value&&value.toLowerCase();1<=itemLowerCase.indexOf(valueLowerCase)&&results.push(item)}),function(items){var position,el,x,y,listNode=domQuery(".bpp-autosuggest-list",entryNode);clearSuggestionList(entryNode),items.length&&(domClasses(listNode).add(CLASS_ACTIVE),forEach(items,function(item){var parentNode,value,itemNode;parentNode=listNode,value=item,(itemNode=domify('<div class="bpp-autosuggest-item"></div>')).innerText=escapeHTML(value),parentNode.appendChild(itemNode),itemNode.addEventListener("click",handleItemClick)}),position=getSuggestionListPosition(listNode,document.body).position,el=listNode,x=position.x,y=position.y,assign(el.style,{left:x+"px",top:y+"px"}))}(results))},resource.getSuggestionListPosition=getSuggestionListPosition,resource.cssClasses=["bpp-autosuggest-textbox"],resource}},{"../Utils":4,"./EntryFieldDescription":16,"min-dash":594,"min-dom":48}],12:[function(require,module,exports){"use strict";var domify=require("min-dom").domify,getBusinessObject=require("bpmn-js/lib/util/ModelUtil").getBusinessObject,cmdHelper=require("../helper/CmdHelper"),escapeHTML=require("../Utils").escapeHTML,entryFieldDescription=require("./EntryFieldDescription");module.exports=function(translate,options,defaultParameters){var resource=defaultParameters,id=resource.id,label=options.label||id,canBeDisabled=!!options.disabled&&"function"==typeof options.disabled,canBeHidden=!!options.hidden&&"function"==typeof options.hidden,description=options.description;return resource.html=domify('<input id="camunda-'+escapeHTML(id)+'" type="checkbox" name="'+escapeHTML(options.modelProperty)+'" '+(canBeDisabled?'data-disable="isDisabled"':"")+(canBeHidden?'data-show="isHidden"':"")+' /><label for="camunda-'+escapeHTML(id)+'" '+(canBeDisabled?'data-disable="isDisabled"':"")+(canBeHidden?'data-show="isHidden"':"")+">"+escapeHTML(label)+"</label>"),description&&resource.html.appendChild(entryFieldDescription(translate,description,{show:canBeHidden&&"isHidden"})),resource.get=function(element){var bo=getBusinessObject(element),res={};return res[options.modelProperty]=bo.get(options.modelProperty),res},resource.set=function(element,values){var res={};return res[options.modelProperty]=!!values[options.modelProperty],cmdHelper.updateProperties(element,res)},"function"==typeof options.set&&(resource.set=options.set),"function"==typeof options.get&&(resource.get=options.get),canBeDisabled&&(resource.isDisabled=function(){return options.disabled.apply(resource,arguments)}),canBeHidden&&(resource.isHidden=function(){return!options.hidden.apply(resource,arguments)}),resource.cssClasses=["bpp-checkbox"],resource}},{"../Utils":4,"../helper/CmdHelper":26,"./EntryFieldDescription":16,"bpmn-js/lib/util/ModelUtil":177,"min-dom":48}],13:[function(require,module,exports){"use strict";var escapeHTML=require("../Utils").escapeHTML,domQuery=require("min-dom").query;function noop(){}module.exports=function(options){var id=options.id,title=options.title||"",description=options.description||"",open=!!options.open||!1,onToggle=options.onToggle||noop,onRemove=options.onRemove,cssClasses=options.cssClasses||[],collapsibleEntry={id:id,toggle:function(element,entryNode,event,scope){var value=!open;setOpen(value,entryNode),onToggle(value,entryNode)},isOpen:function(){return open},set:function(){var commands=this._commands;if(commands)return delete this._commands,commands},setOpen:setOpen,get:function(element,entryNode){if(options.get)return options.get(element,entryNode);return{title:title||"",description:description||""}}};function setOpen(value,entryNode){open=value,entryNode.classList.toggle("bpp-collapsible--collapsed",!value)}return"function"==typeof onRemove&&(collapsibleEntry.onRemove=function(entry,entryNode,actionId,event){var commands=onRemove(entry,entryNode,actionId,event);if(commands)return function(commands,entryNode){collapsibleEntry._commands=commands,domQuery('input[type="hidden"]',entryNode).value=1}(commands,entryNode),!0}),collapsibleEntry.html='<div class="bpp-field-wrapper" data-action="toggle"><input name="hidden" type="hidden"><span class="bpp-collapsible__icon"></span><label class="bpp-collapsible__title" data-value="title">'+escapeHTML(title)+'</label><label class="bpp-collapsible__description" data-value="description">'+escapeHTML(description)+"</label>"+(onRemove?'<button class="bpp-collapsible__remove action-button clear" data-action="onRemove"></button>':"")+"</div>",collapsibleEntry.cssClasses=cssClasses.concat(open?["bpp-collapsible"]:["bpp-collapsible","bpp-collapsible--collapsed"]),collapsibleEntry}},{"../Utils":4,"min-dom":48}],14:[function(require,module,exports){"use strict";var assign=require("lodash/assign"),find=require("lodash/find"),domify=require("min-dom").domify,domQuery=require("min-dom").query,escapeHTML=require("../Utils").escapeHTML,selectEntryFactory=require("./SelectEntryFactory"),entryFieldDescription=require("./EntryFieldDescription");module.exports=function(translate,options){var selectOptions=options.selectOptions,modelProperty=options.modelProperty,customValue=options.customValue||"custom",customName=options.customName||"custom "+modelProperty,description=options.description,comboOptions=assign({},options);comboOptions.showCustomInput=function(element,node){var selectBox=domQuery('[data-entry="'+options.id+'"] select',node.parentNode);return!!selectBox&&selectBox.value===customValue},comboOptions.get=function(element,node){var value=options.get(element,node),modifiedValues={};return function(value){return void 0!==value[modelProperty]&&!find(selectOptions,function(option){return value[modelProperty]===option.value})}(value)?(modifiedValues[modelProperty]=customValue,modifiedValues["custom-"+modelProperty]=value[modelProperty]):modifiedValues[modelProperty]=value[modelProperty]||"",modifiedValues},comboOptions.set=function(element,values,node){var modifiedValues={};return values[modelProperty]===customValue?modifiedValues[modelProperty]=values["custom-"+modelProperty]||"":options.emptyParameter&&""===values[modelProperty]?modifiedValues[modelProperty]=void 0:modifiedValues[modelProperty]=values[modelProperty],options.set(element,modifiedValues,node)},comboOptions.selectOptions.push({name:customName,value:customValue});var comboBoxEntry=assign({},selectEntryFactory(translate,comboOptions,comboOptions)),fragment=document.createDocumentFragment();return fragment.appendChild(comboBoxEntry.html),comboBoxEntry.html=fragment,comboBoxEntry.html.appendChild(domify('<div class="bpp-field-wrapper bpp-combo-input" data-show="showCustomInput"><input id="camunda-'+escapeHTML(options.id)+'-input" type="text" name="custom-'+escapeHTML(modelProperty)+'"  /></div>')),description&&comboBoxEntry.html.appendChild(entryFieldDescription(translate,description,{show:"showCustomInput"})),comboBoxEntry}},{"../Utils":4,"./EntryFieldDescription":16,"./SelectEntryFactory":19,"lodash/assign":552,"lodash/find":558,"min-dom":48}],15:[function(require,module,exports){"use strict";var getBusinessObject=require("bpmn-js/lib/util/ModelUtil").getBusinessObject,textInputField=require("./TextInputEntryFactory"),checkboxField=require("./CheckboxEntryFactory"),selectBoxField=require("./SelectEntryFactory"),comboBoxField=require("./ComboEntryFactory"),textBoxField=require("./TextBoxEntryFactory"),validationAwareTextInputField=require("./ValidationAwareTextInput"),tableField=require("./TableEntryFactory"),labelEntry=require("./LabelFactory"),link=require("./LinkEntryFactory"),autoSuggestTextBoxField=require("./AutoSuggestTextBoxFactory"),collapsible=require("./CollapsibleEntryFactory"),toggleSwitch=require("./ToggleSwitchEntryFactory"),cmdHelper=require("../helper/CmdHelper");function ensureNotNull(prop){if(!prop)throw new Error(prop+" must be set.");return prop}var setDefaultParameters=function(options){return{id:options.id,description:options.description||"",get:options.get||function(element){var bo=getBusinessObject(element),res={},prop=ensureNotNull(options.modelProperty);return res[prop]=bo.get(prop),res},set:options.set||function(element,values){var res={},prop=ensureNotNull(options.modelProperty);return""!==values[prop]?res[prop]=values[prop]:res[prop]=void 0,cmdHelper.updateProperties(element,res)},validate:options.validate||function(){return{}},html:""}};function EntryFactory(){}EntryFactory.textField=function(translate,options){return textInputField(translate,options,setDefaultParameters(options))},EntryFactory.validationAwareTextField=function(translate,options){return validationAwareTextInputField(translate,options,setDefaultParameters(options))},EntryFactory.checkbox=function(translate,options){return checkboxField(translate,options,setDefaultParameters(options))},EntryFactory.textBox=function(translate,options){return textBoxField(translate,options,setDefaultParameters(options))},EntryFactory.selectBox=function(translate,options){return selectBoxField(translate,options,setDefaultParameters(options))},EntryFactory.comboBox=function(translate,options){return comboBoxField(translate,options)},EntryFactory.table=function(translate,options){return tableField(translate,options)},EntryFactory.label=function(options){return labelEntry(options)},EntryFactory.link=function(translate,options){return link(translate,options)},EntryFactory.autoSuggest=function(translate,options){return autoSuggestTextBoxField(translate,options,setDefaultParameters(options))},EntryFactory.collapsible=function(options){return collapsible(options)},EntryFactory.toggleSwitch=function(translate,options){return toggleSwitch(translate,options,setDefaultParameters(options))},module.exports=EntryFactory},{"../helper/CmdHelper":26,"./AutoSuggestTextBoxFactory":11,"./CheckboxEntryFactory":12,"./CollapsibleEntryFactory":13,"./ComboEntryFactory":14,"./LabelFactory":17,"./LinkEntryFactory":18,"./SelectEntryFactory":19,"./TableEntryFactory":20,"./TextBoxEntryFactory":21,"./TextInputEntryFactory":22,"./ToggleSwitchEntryFactory":23,"./ValidationAwareTextInput":24,"bpmn-js/lib/util/ModelUtil":177}],16:[function(require,module,exports){"use strict";var domify=require("min-dom").domify,domClasses=require("min-dom").classes,domEvent=require("min-dom").event,escapeHTML=require("../Utils").escapeHTML;function escapeText(text){for(var match,index=0,escaped=[],pattern=/<br\s*\/?>/gi;match=pattern.exec(text);)match.index>index&&escaped.push(escapeHTML(text.substring(index,match.index))),escaped.push("<br />"),index=match.index+match[0].length;return index<text.length&&escaped.push(escapeHTML(text.substring(index))),escaped.join("")}module.exports=function(translate,description,options){for(var match,link,text,show=options&&options.show,escaped=[],pattern=/(?:\[([^\]]+)\]\((https?:\/\/[^)]+)\))|(?:<a href="(https?:\/\/[^"]+)">(.+?(?=<\/))<\/a>)/gi,index=0;match=pattern.exec(description);)match.index>index&&escaped.push(escapeText(description.substring(index,match.index))),link=match[2]&&encodeURI(match[2])||match[3],text=match[1]||match[4],escaped.push('<a href="'+link+'" target="_blank">'+escapeText(text)+"</a>"),index=match.index+match[0].length;index<description.length&&escaped.push(escapeText(description.substring(index))),description=escaped.join("");var html=domify('<div class="bpp-field-description description description--expanded"'+(show?'data-show="'+show+'">':">")+"</div>"),descriptionText=domify('<span class="description__text">'+description+"</span>");function toggleExpanded(expanded){expanded?(domClasses(html).add("description--expanded"),descriptionText.textContent=description+" ",expand.textContent=translate("Less")):(domClasses(html).remove("description--expanded"),descriptionText.textContent=descriptionShortened+" ... ",expand.textContent=translate("More"))}html.appendChild(descriptionText);var descriptionShortened,expand,expanded=!1;return 200<description.length&&(descriptionShortened=description.slice(0,200),expand=domify('<span class="bpp-entry-link description__expand">'+translate("More")+"</span>"),domEvent.bind(expand,"click",function(){toggleExpanded(expanded=!expanded)}),html.appendChild(expand),toggleExpanded(expanded)),html}},{"../Utils":4,"min-dom":48}],17:[function(require,module,exports){"use strict";module.exports=function(options){return{id:options.id,html:'<label data-value="label" data-show="showLabel" class="entry-label'+(options.divider?" divider":"")+'"></label>',get:function(element,node){return"function"==typeof options.get?options.get(element,node):{label:options.labelText}},showLabel:function(element,node){return"function"!=typeof options.showLabel||options.showLabel(element,node)}}}},{}],18:[function(require,module,exports){"use strict";var domify=require("min-dom").domify,escapeHTML=require("../Utils").escapeHTML,entryFieldDescription=require("./EntryFieldDescription"),bind=require("lodash/bind");module.exports=function(translate,options){var id=options.id,buttonLabel=options.buttonLabel||id,showLink=options.showLink,handleClick=options.handleClick,description=options.description,label=options.label;if(showLink&&"function"!=typeof showLink)throw new Error("options.showLink must be a function");if("function"!=typeof handleClick)throw new Error("options.handleClick must be a function");var resource={id:id,html:document.createDocumentFragment()};return label&&resource.html.appendChild(domify('<label for="camunda-'+escapeHTML(id)+'" '+(showLink?'data-show="showLink" ':"")+">"+escapeHTML(label)+"</label>")),resource.html.appendChild(domify('<div class="bpp-field-wrapper"><a data-action="handleClick" '+(showLink?'data-show="showLink" ':"")+'class="bpp-entry-link'+(options.cssClasses?" "+escapeHTML(options.cssClasses):"")+'">'+escapeHTML(buttonLabel)+"</a></div>")),description&&resource.html.appendChild(entryFieldDescription(translate,description,{show:"showLink"})),resource.handleClick=bind(handleClick,resource),"function"==typeof showLink&&(resource.showLink=function(){return showLink.apply(resource,arguments)}),resource}},{"../Utils":4,"./EntryFieldDescription":16,"lodash/bind":553,"min-dom":48}],19:[function(require,module,exports){"use strict";var escapeHTML=require("../Utils").escapeHTML,domify=require("min-dom").domify,domQuery=require("min-dom").query,forEach=require("lodash/forEach"),entryFieldDescription=require("./EntryFieldDescription");module.exports=function(translate,options,defaultParameters){var resource=defaultParameters,label=options.label||resource.id,selectOptions=options.selectOptions||[{name:"",value:""}],modelProperty=options.modelProperty,emptyParameter=options.emptyParameter,canBeDisabled=!!options.disabled&&"function"==typeof options.disabled,canBeHidden=!!options.hidden&&"function"==typeof options.hidden,description=options.description;emptyParameter&&(selectOptions=selectOptions.concat([{name:"",value:""}])),resource.html=domify('<label for="camunda-'+escapeHTML(resource.id)+'"'+(canBeDisabled?'data-disable="isDisabled" ':"")+(canBeHidden?'data-show="isHidden" ':"")+">"+escapeHTML(label)+'</label><select id="camunda-'+escapeHTML(resource.id)+'-select" name="'+escapeHTML(modelProperty)+'"'+(canBeDisabled?'data-disable="isDisabled" ':"")+(canBeHidden?'data-show="isHidden" ':"")+" data-value></select>");var select=domQuery("select",resource.html);return function(list){return!(!list||"[object Array]"!==Object.prototype.toString.call(list))}(selectOptions)&&forEach(selectOptions,function(option){select.appendChild(domify('<option value="'+escapeHTML(option.value)+(option.title?'" title="'+escapeHTML(option.title):"")+'">'+(option.name?escapeHTML(option.name):"")+"</option>"))}),description&&"function"!=typeof options.showCustomInput&&resource.html.appendChild(entryFieldDescription(translate,description,{show:canBeHidden&&"isHidden"})),resource.setControlValue=function(element,entryNode,inputNode,inputName,newValue){if("function"==typeof selectOptions){var options=selectOptions(element,inputNode);if(options){for(;inputNode.firstChild;)inputNode.removeChild(inputNode.firstChild);forEach(options,function(option){var template=domify(function(option){return'<option value="'+option.value+'">'+option.name+"</option>"}(option));inputNode.appendChild(template)})}}void 0!==newValue&&(inputNode.value=newValue)},canBeDisabled&&(resource.isDisabled=function(){return options.disabled.apply(resource,arguments)}),canBeHidden&&(resource.isHidden=function(){return!options.hidden.apply(resource,arguments)}),resource.cssClasses=["bpp-dropdown"],resource}},{"../Utils":4,"./EntryFieldDescription":16,"lodash/forEach":561,"min-dom":48}],20:[function(require,module,exports){"use strict";var escapeHTML=require("../Utils").escapeHTML,cmdHelper=require("../helper/CmdHelper"),domQuery=require("min-dom").query,domAttr=require("min-dom").attr,domClosest=require("min-dom").closest,filter=require("lodash/filter"),forEach=require("lodash/forEach"),keys=require("lodash/keys"),domify=require("min-dom").domify,entryFieldDescription=require("./EntryFieldDescription"),updateSelection=require("selection-update");function createInputRowTemplate(properties,canRemove){var template='<div class="bpp-field-wrapper bpp-table-row">';return template+=function(properties,canRemove){var columns=properties.length,template="";return forEach(properties,function(prop){template+='<input class="bpp-table-row-columns-'+columns+" "+(canRemove?"bpp-table-row-removable":"")+'" id="camunda-table-row-cell-input-value" type="text" name="'+escapeHTML(prop)+'" />'}),template}(properties,canRemove),template+=canRemove?'<button class="action-button clear" data-action="deleteElement"><span>X</span></button>':"",template+="</div>"}function createLabelRowTemplate(labels){var template='<div class="bpp-field-wrapper bpp-table-row">';return template+=function(labels){var columns=labels.length,template="";return forEach(labels,function(label){template+='<label class="bpp-table-row-columns-'+columns+'">'+escapeHTML(label)+"</label>"}),template}(labels),template+="</div>"}function diff(element,node,values,oldValues,editable){return filter(values,function(value,idx){return!function(element,node,value,oldValue,editable,idx){return!(value&&!oldValue)&&keys(value).concat(keys(oldValue)).every(function(key){var n=value[key]||void 0,o=oldValue[key]||void 0;return!editable(element,node,key,idx)||n===o})}(element,node,value,oldValues[idx],editable,idx)})}function getEntryNode(node){return domClosest(node,"[data-entry]",!0)}function getContainer(node){return domQuery("div[data-list-entry-container]",node)}module.exports=function(translate,options){var id=options.id,modelProperties=options.modelProperties,labels=options.labels,description=options.description,labelRow=createLabelRowTemplate(labels),getElements=options.getElements,removeElement=options.removeElement,canRemove="function"==typeof removeElement,addElement=options.addElement,canAdd="function"==typeof addElement,addLabel=options.addLabel||"Add Value",updateElement=options.updateElement,canUpdate="function"==typeof updateElement,_editable=options.editable||function(){return!0},setControlValue=options.setControlValue,_show=options.show,canBeShown="function"==typeof _show,elements=function(element,node){return function(elements,properties){return(elements||[]).map(function(elem){var newElement={};return forEach(properties,function(prop){newElement[prop]=elem[prop]||""}),newElement})}(getElements(element,node),modelProperties)},html=domify((canAdd?'<div class="bpp-table-add-row" '+(canBeShown?'data-show="show"':"")+"><label>"+escapeHTML(addLabel)+'</label><button class="action-button add" data-action="addElement"><span>+</span></button></div>':"")+'<div class="bpp-table" data-show="showTable"><div class="bpp-field-wrapper bpp-table-row">'+labelRow+"</div><div data-list-entry-container></div></div>");description&&html.appendChild(entryFieldDescription(translate,description,{show:"showTable"}));var factory={id:id,html:html,get:function(element,node){var boElements=elements(element,node,this.__invalidValues),invalidValues=this.__invalidValues;return delete this.__invalidValues,forEach(invalidValues,function(value,idx){var element=boElements[idx];forEach(modelProperties,function(prop){element[prop]=value[prop]})}),boElements},set:function(element,values,node){var action=this.__action||{};if(delete this.__action,"delete-element"===action.id)return removeElement(element,node,action.idx);if("add-element"===action.id)return addElement(element,node);if(canUpdate){var commands=[],valuesToValidate=values;"function"!=typeof options.validate&&(valuesToValidate=diff(element,node,values,elements(element,node),_editable));var self=this;return forEach(valuesToValidate,function(value){var validationError,cmd,idx=values.indexOf(value);"function"==typeof options.validate&&(validationError=options.validate(element,value,node,idx)),validationError?(self.__invalidValues=self.__invalidValues||{},self.__invalidValues[idx]=value,commands.push(cmdHelper.updateProperties(element,{}))):(cmd=updateElement(element,value,node,idx))&&commands.push(cmd)}),commands}},createListEntryTemplate:function(){return createInputRowTemplate(modelProperties,canRemove)},addElement:function(element,node){var template=domify(createInputRowTemplate(modelProperties,canRemove));return getContainer(node).appendChild(template),this.__action={id:"add-element"},!0},deleteElement:function(element,node,event){var container=getContainer(node),rowToDelete=event.delegateTarget.parentNode,idx=parseInt(domAttr(rowToDelete,"data-index"),10);return container.removeChild(rowToDelete),this.__action={id:"delete-element",idx:idx},!0},editable:function(element,rowNode,input,prop,value,idx){var entryNode=domClosest(rowNode,"[data-entry]");return _editable(element,entryNode,prop,idx)},show:function(element,entryNode,node,scopeNode){return entryNode=getEntryNode(entryNode),_show(element,entryNode,node,scopeNode)},showTable:function(element,entryNode,node,scopeNode){entryNode=getEntryNode(entryNode);var elems=elements(element,entryNode);return elems&&elems.length&&(!canBeShown||_show(element,entryNode,node,scopeNode))},validateListItem:function(element,value,node,idx){if("function"==typeof options.validate)return options.validate(element,value,node,idx)}};return setControlValue&&(factory.setControlValue=function(element,rowNode,input,prop,value,idx){var selection,node,entryNode=getEntryNode(rowNode),isReadOnly=domAttr(input,"readonly"),oldValue=input.value;void 0===value&&(value=""),isReadOnly&&oldValue===value||(document.activeElement===input&&(selection=updateSelection({start:(node=input).selectionStart,end:node.selectionEnd},oldValue,value)),setControlValue(element,entryNode,input,prop,value,idx),selection&&function(node,selection){node.selectionStart=selection.start,node.selectionEnd=selection.end}(input,selection))}),factory}},{"../Utils":4,"../helper/CmdHelper":26,"./EntryFieldDescription":16,"lodash/filter":557,"lodash/forEach":561,"lodash/keys":578,"min-dom":48,"selection-update":605}],21:[function(require,module,exports){"use strict";var domify=require("min-dom").domify,escapeHTML=require("../Utils").escapeHTML,entryFieldDescription=require("./EntryFieldDescription");module.exports=function(translate,options,defaultParameters){var resource=defaultParameters,label=options.label||resource.id,canBeShown=!!options.show&&"function"==typeof options.show,description=options.description;return resource.html=domify('<label for="camunda-'+escapeHTML(resource.id)+'" '+(canBeShown?'data-show="isShown"':"")+">"+label+'</label><div class="bpp-field-wrapper" '+(canBeShown?'data-show="isShown"':"")+'><div contenteditable="true" id="camunda-'+escapeHTML(resource.id)+'" name="'+escapeHTML(options.modelProperty)+'" /></div>'),description&&resource.html.appendChild(entryFieldDescription(translate,description,{show:canBeShown&&"isShown"})),canBeShown&&(resource.isShown=function(){return options.show.apply(resource,arguments)}),resource.cssClasses=["bpp-textbox"],resource}},{"../Utils":4,"./EntryFieldDescription":16,"min-dom":48}],22:[function(require,module,exports){"use strict";var escapeHTML=require("../Utils").escapeHTML,domify=require("min-dom").domify,domQuery=require("min-dom").query,entryFieldDescription=require("./EntryFieldDescription");module.exports=function(translate,options,defaultParameters){var resource=defaultParameters,label=options.label||resource.id,dataValueLabel=options.dataValueLabel,buttonLabel=options.buttonLabel||"X",actionName=void 0!==options.buttonAction?options.buttonAction.name:"clear",actionMethod=void 0!==options.buttonAction?options.buttonAction.method:function(element,inputNode){return!(domQuery('input[name="'+options.modelProperty+'"]',inputNode).value="")},showName=void 0!==options.buttonShow?options.buttonShow.name:"canClear",showMethod=void 0!==options.buttonShow?options.buttonShow.method:function(element,inputNode){return""!==domQuery('input[name="'+options.modelProperty+'"]',inputNode).value},canBeDisabled=!!options.disabled&&"function"==typeof options.disabled,canBeHidden=!!options.hidden&&"function"==typeof options.hidden,description=options.description;return resource.html=domify('<label for="camunda-'+escapeHTML(resource.id)+'" '+(canBeDisabled?'data-disable="isDisabled" ':"")+(canBeHidden?'data-show="isHidden" ':"")+(dataValueLabel?'data-value="'+escapeHTML(dataValueLabel)+'"':"")+">"+escapeHTML(label)+'</label><div class="bpp-field-wrapper" '+(canBeDisabled?'data-disable="isDisabled"':"")+(canBeHidden?'data-show="isHidden"':"")+'><input id="camunda-'+escapeHTML(resource.id)+'" type="text" name="'+escapeHTML(options.modelProperty)+'" '+(canBeDisabled?'data-disable="isDisabled"':"")+(canBeHidden?'data-show="isHidden"':"")+' /><button class="action-button '+escapeHTML(actionName)+'" data-action="'+escapeHTML(actionName)+'" data-show="'+escapeHTML(showName)+'" '+(canBeDisabled?'data-disable="isDisabled"':"")+(canBeHidden?' data-show="isHidden"':"")+"><span>"+escapeHTML(buttonLabel)+"</span></button></div>"),description&&resource.html.appendChild(entryFieldDescription(translate,description,{show:canBeHidden&&"isHidden"})),resource[actionName]=actionMethod,resource[showName]=showMethod,canBeDisabled&&(resource.isDisabled=function(){return options.disabled.apply(resource,arguments)}),canBeHidden&&(resource.isHidden=function(){return!options.hidden.apply(resource,arguments)}),resource.cssClasses=["bpp-textfield"],resource}},{"../Utils":4,"./EntryFieldDescription":16,"min-dom":48}],23:[function(require,module,exports){"use strict";var getBusinessObject=require("bpmn-js/lib/util/ModelUtil").getBusinessObject,cmdHelper=require("../helper/CmdHelper"),escapeHTML=require("../Utils").escapeHTML,entryFieldDescription=require("./EntryFieldDescription"),domify=require("min-dom").domify;module.exports=function(translate,options,defaultParameters){var resource=defaultParameters,id=resource.id,label=options.label||id,canBeHidden=!!options.hidden&&"function"==typeof options.hidden,isOn=options.isOn,descriptionOn=options.descriptionOn,descriptionOff=options.descriptionOff,labelOn=options.labelOn,labelOff=options.labelOff;return resource.html=document.createDocumentFragment(),resource.html.appendChild(domify('<label for="'+escapeHTML(id)+'" '+(canBeHidden?'data-show="shouldShow"':"")+">"+escapeHTML(label)+'</label><div class="bpp-field-wrapper"'+(canBeHidden?'data-show="shouldShow"':"")+'><label class="bpp-toggle-switch__switcher"><input id="'+escapeHTML(id)+'" type="checkbox" name="'+escapeHTML(options.modelProperty)+'" /><span class="bpp-toggle-switch__slider"></span></label><p class="bpp-toggle-switch__label" data-show="isOn">'+escapeHTML(labelOn)+'</p><p class="bpp-toggle-switch__label" data-show="isOff">'+escapeHTML(labelOff)+"</p></div>")),descriptionOn&&resource.html.appendChild(entryFieldDescription(translate,descriptionOn,{show:"isOn"})),descriptionOff&&resource.html.appendChild(entryFieldDescription(translate,descriptionOff,{show:"isOff"})),resource.get=function(element){var bo=getBusinessObject(element),res={};return res[options.modelProperty]=bo.get(options.modelProperty),res},resource.set=function(element,values){var res={};return res[options.modelProperty]=!!values[options.modelProperty],cmdHelper.updateProperties(element,res)},"function"==typeof options.set&&(resource.set=options.set),"function"==typeof options.get&&(resource.get=options.get),canBeHidden&&(resource.shouldShow=function(){return!options.hidden.apply(resource,arguments)}),resource.isOn=function(){return!(canBeHidden&&!resource.shouldShow())&&isOn.apply(resource,arguments)},resource.isOff=function(){return!(canBeHidden&&!resource.shouldShow())&&!resource.isOn()},resource.cssClasses=["bpp-toggle-switch"],resource}},{"../Utils":4,"../helper/CmdHelper":26,"./EntryFieldDescription":16,"bpmn-js/lib/util/ModelUtil":177,"min-dom":48}],24:[function(require,module,exports){"use strict";var textField=require("./TextInputEntryFactory");module.exports=function(translate,options,defaultParameters){var modelProperty=options.modelProperty;defaultParameters.get=function(element,node){var value=this.__lastInvalidValue;delete this.__lastInvalidValue;var properties={};return properties[modelProperty]=void 0!==value?value:options.getProperty(element,node),properties},defaultParameters.set=function(element,values,node){var validationErrors=validate.apply(this,[element,values,node]),propertyValue=values[modelProperty];if(validationErrors&&validationErrors[modelProperty])return this.__lastInvalidValue=propertyValue,options.setProperty(element,{},node);var properties={};return properties[modelProperty]=propertyValue,options.setProperty(element,properties,node)};var validate=defaultParameters.validate=function(element,values,node){var value=values[modelProperty]||this.__lastInvalidValue,property={};return property[modelProperty]=value,options.validate(element,property,node)};return textField(translate,options,defaultParameters)}},{"./TextInputEntryFactory":22}],25:[function(require,module,exports){"use strict";var collectionAdd=require("diagram-js/lib/util/Collections").add,getBusinessObject=require("bpmn-js/lib/util/ModelUtil").getBusinessObject,CategoryHelper={};(module.exports=CategoryHelper).createCategoryValue=function(definitions,bpmnFactory){var categoryValue=bpmnFactory.create("bpmn:CategoryValue"),category=bpmnFactory.create("bpmn:Category",{categoryValue:[categoryValue]});return collectionAdd(definitions.get("rootElements"),category),getBusinessObject(category).$parent=definitions,getBusinessObject(categoryValue).$parent=category,categoryValue}},{"bpmn-js/lib/util/ModelUtil":177,"diagram-js/lib/util/Collections":377}],26:[function(require,module,exports){"use strict";var CmdHelper={};(module.exports=CmdHelper).updateProperties=function(element,properties){return{cmd:"element.updateProperties",context:{element:element,properties:properties}}},CmdHelper.updateBusinessObject=function(element,businessObject,newProperties){return{cmd:"properties-panel.update-businessobject",context:{element:element,businessObject:businessObject,properties:newProperties}}},CmdHelper.addElementsTolist=function(element,businessObject,listPropertyName,objectsToAdd,objectsToPrepend){return{cmd:"properties-panel.update-businessobject-list",context:{element:element,currentObject:businessObject,propertyName:listPropertyName,objectsToPrepend:objectsToPrepend,objectsToAdd:objectsToAdd}}},CmdHelper.removeElementsFromList=function(element,businessObject,listPropertyName,referencePropertyName,objectsToRemove){return{cmd:"properties-panel.update-businessobject-list",context:{element:element,currentObject:businessObject,propertyName:listPropertyName,referencePropertyName:referencePropertyName,objectsToRemove:objectsToRemove}}},CmdHelper.addAndRemoveElementsFromList=function(element,businessObject,listPropertyName,referencePropertyName,objectsToAdd,objectsToRemove){return{cmd:"properties-panel.update-businessobject-list",context:{element:element,currentObject:businessObject,propertyName:listPropertyName,referencePropertyName:referencePropertyName,objectsToAdd:objectsToAdd,objectsToRemove:objectsToRemove}}},CmdHelper.setList=function(element,businessObject,listPropertyName,updatedObjectList){return{cmd:"properties-panel.update-businessobject-list",context:{element:element,currentObject:businessObject,propertyName:listPropertyName,updatedObjectList:updatedObjectList}}}},{}],27:[function(require,module,exports){"use strict";var ElementHelper={};(module.exports=ElementHelper).createElement=function(elementType,properties,parent,factory){var element=factory.create(elementType,properties);return element.$parent=parent,element}},{}],28:[function(require,module,exports){"use strict";var getBusinessObject=require("bpmn-js/lib/util/ModelUtil").getBusinessObject,is=require("bpmn-js/lib/util/ModelUtil").is,forEach=require("lodash/forEach"),EventDefinitionHelper={};(module.exports=EventDefinitionHelper).getEventDefinition=function(element,eventType){var bo=getBusinessObject(element),eventDefinition=null;return bo.eventDefinitions&&forEach(bo.eventDefinitions,function(event){is(event,eventType)&&(eventDefinition=event)}),eventDefinition},EventDefinitionHelper.getTimerEventDefinition=function(element){return this.getEventDefinition(element,"bpmn:TimerEventDefinition")},EventDefinitionHelper.getMessageEventDefinition=function(element){return this.getEventDefinition(element,"bpmn:MessageEventDefinition")},EventDefinitionHelper.getSignalEventDefinition=function(element){return this.getEventDefinition(element,"bpmn:SignalEventDefinition")},EventDefinitionHelper.getErrorEventDefinition=function(element){return this.getEventDefinition(element,"bpmn:ErrorEventDefinition")},EventDefinitionHelper.getEscalationEventDefinition=function(element){return this.getEventDefinition(element,"bpmn:EscalationEventDefinition")},EventDefinitionHelper.getCompensateEventDefinition=function(element){return this.getEventDefinition(element,"bpmn:CompensateEventDefinition")},EventDefinitionHelper.getLinkEventDefinition=function(element){return this.getEventDefinition(element,"bpmn:LinkEventDefinition")},EventDefinitionHelper.getConditionalEventDefinition=function(element){return this.getEventDefinition(element,"bpmn:ConditionalEventDefinition")}},{"bpmn-js/lib/util/ModelUtil":177,"lodash/forEach":561}],29:[function(require,module,exports){"use strict";var is=require("bpmn-js/lib/util/ModelUtil").is,getBusinessObject=require("bpmn-js/lib/util/ModelUtil").getBusinessObject,cmdHelper=require("./CmdHelper"),ParticipantHelper={};(module.exports=ParticipantHelper).modifyProcessBusinessObject=function(element,property,values){if(!is(element,"bpmn:Participant"))return{};var bo=getBusinessObject(element).get("processRef"),properties={};return properties[property]=values[property],cmdHelper.updateBusinessObject(element,bo,properties)},ParticipantHelper.getProcessBusinessObject=function(element,propertyName){if(!is(element,"bpmn:Participant"))return{};var bo=getBusinessObject(element).get("processRef"),properties={};return properties[propertyName]=bo.get(propertyName),properties}},{"./CmdHelper":26,"bpmn-js/lib/util/ModelUtil":177}],30:[function(require,module,exports){"use strict";module.exports={__depends__:[require("./cmd"),require("diagram-js/lib/i18n/translate").default],__init__:["propertiesPanel"],propertiesPanel:["type",require("./PropertiesPanel")]}},{"./PropertiesPanel":3,"./cmd":10,"diagram-js/lib/i18n/translate":375}],31:[function(require,module,exports){"use strict";var is=require("bpmn-js/lib/util/ModelUtil").is,isAny=require("bpmn-js/lib/features/modeling/util/ModelingUtil").isAny,getBusinessObject=require("bpmn-js/lib/util/ModelUtil").getBusinessObject,eventDefinitionHelper=require("../../../helper/EventDefinitionHelper"),forEach=require("lodash/forEach"),message=require("./implementation/MessageEventDefinition"),signal=require("./implementation/SignalEventDefinition"),error=require("./implementation/ErrorEventDefinition"),escalation=require("./implementation/EscalationEventDefinition"),timer=require("./implementation/TimerEventDefinition"),compensation=require("./implementation/CompensateEventDefinition"),condition=require("./implementation/ConditionalEventDefinition");module.exports=function(group,element,bpmnFactory,elementRegistry,translate){forEach(["bpmn:StartEvent","bpmn:EndEvent","bpmn:IntermediateThrowEvent","bpmn:BoundaryEvent","bpmn:IntermediateCatchEvent"],function(event){var messageEventDefinition,signalEventDefinition;is(element,event)&&(messageEventDefinition=eventDefinitionHelper.getMessageEventDefinition(element),signalEventDefinition=eventDefinitionHelper.getSignalEventDefinition(element),messageEventDefinition&&message(group,element,bpmnFactory,messageEventDefinition,translate),signalEventDefinition&&signal(group,element,bpmnFactory,signalEventDefinition,translate))}),is(element,"bpmn:ReceiveTask")&&message(group,element,bpmnFactory,getBusinessObject(element),translate);forEach(["bpmn:StartEvent","bpmn:BoundaryEvent","bpmn:EndEvent"],function(event){var errorEventDefinition;!is(element,event)||(errorEventDefinition=eventDefinitionHelper.getErrorEventDefinition(element))&&error(group,element,bpmnFactory,errorEventDefinition,translate)});forEach(["bpmn:StartEvent","bpmn:BoundaryEvent","bpmn:IntermediateThrowEvent","bpmn:EndEvent"],function(event){var showEscalationCodeVariable,escalationEventDefinition;is(element,event)&&(showEscalationCodeVariable=is(element,"bpmn:StartEvent")||is(element,"bpmn:BoundaryEvent"),(escalationEventDefinition=eventDefinitionHelper.getEscalationEventDefinition(element))&&escalation(group,element,bpmnFactory,escalationEventDefinition,showEscalationCodeVariable,translate))});forEach(["bpmn:StartEvent","bpmn:BoundaryEvent","bpmn:IntermediateCatchEvent"],function(event){var timerEventDefinition;!is(element,event)||(timerEventDefinition=eventDefinitionHelper.getTimerEventDefinition(element))&&timer(group,element,bpmnFactory,timerEventDefinition,translate)});forEach(["bpmn:EndEvent","bpmn:IntermediateThrowEvent"],function(event){var compensateEventDefinition;!is(element,event)||(compensateEventDefinition=eventDefinitionHelper.getCompensateEventDefinition(element))&&compensation(group,element,bpmnFactory,compensateEventDefinition,elementRegistry,translate)});var conditionalEventDefinition;!isAny(element,["bpmn:StartEvent","bpmn:BoundaryEvent","bpmn:IntermediateThrowEvent","bpmn:IntermediateCatchEvent"])||(conditionalEventDefinition=eventDefinitionHelper.getConditionalEventDefinition(element))&&condition(group,element,bpmnFactory,conditionalEventDefinition,elementRegistry,translate)}},{"../../../helper/EventDefinitionHelper":28,"./implementation/CompensateEventDefinition":36,"./implementation/ConditionalEventDefinition":37,"./implementation/ErrorEventDefinition":39,"./implementation/EscalationEventDefinition":40,"./implementation/MessageEventDefinition":42,"./implementation/SignalEventDefinition":44,"./implementation/TimerEventDefinition":45,"bpmn-js/lib/features/modeling/util/ModelingUtil":148,"bpmn-js/lib/util/ModelUtil":177,"lodash/forEach":561}],32:[function(require,module,exports){"use strict";var entryFactory=require("../../../factory/EntryFactory"),getBusinessObject=require("bpmn-js/lib/util/ModelUtil").getBusinessObject,utils=require("../../../Utils"),cmdHelper=require("../../../helper/CmdHelper");module.exports=function(group,element,translate,options){var description=(options=options||{})&&options.description;group.entries.push(entryFactory.validationAwareTextField(translate,{id:options.id||"id",label:translate("Id"),description:description&&translate(description),modelProperty:"id",getProperty:function(element){return getBusinessObject(element).id},setProperty:function(element,properties){return element=element.labelTarget||element,cmdHelper.updateProperties(element,properties)},validate:function(element,values){var idValue=values.id,bo=getBusinessObject(element),idError=utils.isIdValid(bo,idValue,translate);return idError?{id:idError}:{}}}))}},{"../../../Utils":4,"../../../factory/EntryFactory":15,"../../../helper/CmdHelper":26,"bpmn-js/lib/util/ModelUtil":177}],33:[function(require,module,exports){"use strict";var is=require("bpmn-js/lib/util/ModelUtil").is,getBusinessObject=require("bpmn-js/lib/util/ModelUtil").getBusinessObject,entryFactory=require("../../../factory/EntryFactory"),cmdHelper=require("../../../helper/CmdHelper"),forEach=require("lodash/forEach");module.exports=function(group,element,translate){forEach(["bpmn:IntermediateThrowEvent","bpmn:IntermediateCatchEvent"],function(event){var linkEventDefinition,entry;!is(element,event)||(linkEventDefinition=function(element){var bo=getBusinessObject(element),linkEventDefinition=null;return bo.eventDefinitions&&forEach(bo.eventDefinitions,function(eventDefinition){is(eventDefinition,"bpmn:LinkEventDefinition")&&(linkEventDefinition=eventDefinition)}),linkEventDefinition}(element))&&((entry=entryFactory.textField(translate,{id:"link-event",label:translate("Link Name"),modelProperty:"link-name"})).get=function(){return{"link-name":linkEventDefinition.get("name")}},entry.set=function(element,values){var newProperties={name:values["link-name"]};return cmdHelper.updateBusinessObject(element,linkEventDefinition,newProperties)},group.entries.push(entry))})}},{"../../../factory/EntryFactory":15,"../../../helper/CmdHelper":26,"bpmn-js/lib/util/ModelUtil":177,"lodash/forEach":561}],34:[function(require,module,exports){"use strict";var nameEntryFactory=require("./implementation/Name"),createCategoryValue=require("../../../helper/CategoryHelper").createCategoryValue,is=require("bpmn-js/lib/util/ModelUtil").is,getBusinessObject=require("bpmn-js/lib/util/ModelUtil").getBusinessObject;module.exports=function(group,element,bpmnFactory,canvas,translate,options){var nameOptions;options=options||{},is(element,"bpmn:Collaboration")||(nameOptions={id:options.id},is(element,"bpmn:TextAnnotation")?(nameOptions.modelProperty="text",nameOptions.label=translate("Text")):is(element,"bpmn:Group")&&(nameOptions.modelProperty="categoryValue",nameOptions.label=translate("Category Value"),nameOptions.get=function(element){return{categoryValue:(getBusinessObject(element).categoryValueRef||{}).value}},nameOptions.set=function(element,values){var semantic,rootElement,definitions,categoryValue,bo=getBusinessObject(element);return bo.categoryValueRef||(semantic=bo,rootElement=canvas.getRootElement(),definitions=getBusinessObject(rootElement).$parent,categoryValue=createCategoryValue(definitions,bpmnFactory),semantic.categoryValueRef=categoryValue),{cmd:"element.updateLabel",context:{element:element,newLabel:values.categoryValue}}}),group.entries=group.entries.concat(nameEntryFactory(element,nameOptions,translate)))}},{"../../../helper/CategoryHelper":25,"./implementation/Name":43,"bpmn-js/lib/util/ModelUtil":177}],35:[function(require,module,exports){"use strict";var is=require("bpmn-js/lib/util/ModelUtil").is,entryFactory=require("../../../factory/EntryFactory"),participantHelper=require("../../../helper/ParticipantHelper"),getBusinessObject=require("bpmn-js/lib/util/ModelUtil").getBusinessObject,nameEntryFactory=require("./implementation/Name"),utils=require("../../../Utils");module.exports=function(group,element,translate,options){var idEntry,processNameEntry,businessObject=getBusinessObject(element),processIdDescription=options&&options.processIdDescription;(is(element,"bpmn:Process")||is(element,"bpmn:Participant")&&businessObject.get("processRef"))&&is(element,"bpmn:Participant")&&((idEntry=entryFactory.validationAwareTextField(translate,{id:"process-id",label:translate("Process Id"),description:processIdDescription&&translate(processIdDescription),modelProperty:"processId"})).get=function(element){return{processId:participantHelper.getProcessBusinessObject(element,"id").id}},idEntry.set=function(element,values){return participantHelper.modifyProcessBusinessObject(element,"id",{id:values.processId})},idEntry.validate=function(element,values){var idValue=values.processId,bo=getBusinessObject(element),processIdError=utils.isIdValid(bo.processRef,idValue,translate);return processIdError?{processId:processIdError}:{}},group.entries.push(idEntry),(processNameEntry=nameEntryFactory(element,{id:"process-name",label:translate("Process Name")})[0]).get=function(element){return participantHelper.getProcessBusinessObject(element,"name")},processNameEntry.set=function(element,values){return participantHelper.modifyProcessBusinessObject(element,"name",values)},group.entries.push(processNameEntry))}},{"../../../Utils":4,"../../../factory/EntryFactory":15,"../../../helper/ParticipantHelper":29,"./implementation/Name":43,"bpmn-js/lib/util/ModelUtil":177}],36:[function(require,module,exports){"use strict";var entryFactory=require("../../../../factory/EntryFactory"),cmdHelper=require("../../../../helper/CmdHelper"),eventDefinitionHelper=require("../../../../helper/EventDefinitionHelper"),utils=require("../../../../Utils"),getBusinessObject=require("bpmn-js/lib/util/ModelUtil").getBusinessObject,is=require("bpmn-js/lib/util/ModelUtil").is,forEach=require("lodash/forEach"),find=require("lodash/find"),filter=require("lodash/filter");function getFlowElements(element,type){return utils.filterElementsByType(element.flowElements,type)}function canActivityBeCompensated(activity,boundaryEvents){return is(activity,"bpmn:SubProcess")&&!activity.triggeredByEvent||is(activity,"bpmn:CallActivity")||function(activity,boundaryEvents){var activityId=activity.id;return!!find(boundaryEvents,function(boundaryEvent){var compensateEventDefinition=eventDefinitionHelper.getCompensateEventDefinition(boundaryEvent),attachedToRef=boundaryEvent.attachedToRef;return compensateEventDefinition&&attachedToRef&&attachedToRef.id===activityId})}(activity,boundaryEvents)}function getActivitiesForCompensation(element){var boundaryEvents=function(element){return getFlowElements(element,"bpmn:BoundaryEvent")}(element);return filter(function(element){return getFlowElements(element,"bpmn:Activity")}(element),function(activity){return canActivityBeCompensated(activity,boundaryEvents)})}function createActivityRefOptions(element){var options=[{value:""}],activities=function(element){var parent=getBusinessObject(element).$parent,activitiesForActivityRef=getActivitiesForCompensation(parent);return is(parent,"bpmn:SubProcess")&&parent.triggeredByEvent&&(parent=parent.$parent)&&(activitiesForActivityRef=activitiesForActivityRef.concat(getActivitiesForCompensation(parent))),activitiesForActivityRef}(element);return forEach(activities,function(activity){var activityId=activity.id,name=(activity.name?activity.name+" ":"")+"(id="+activityId+")";options.push({value:activityId,name:name})}),options}module.exports=function(group,element,bpmnFactory,compensateEventDefinition,elementRegistry,translate){group.entries.push(entryFactory.checkbox(translate,{id:"wait-for-completion",label:translate("Wait for Completion"),modelProperty:"waitForCompletion",get:function(){return{waitForCompletion:compensateEventDefinition.waitForCompletion}},set:function(element,values){return values.waitForCompletion=values.waitForCompletion||!1,cmdHelper.updateBusinessObject(element,compensateEventDefinition,values)}})),group.entries.push(entryFactory.selectBox(translate,{id:"activity-ref",label:translate("Activity Ref"),selectOptions:createActivityRefOptions(element),modelProperty:"activityRef",get:function(){var activityRef=compensateEventDefinition.activityRef;return{activityRef:(activityRef=activityRef&&activityRef.id)||""}},set:function(element,values){var activityRef=(activityRef=values.activityRef||void 0)&&getBusinessObject(elementRegistry.get(activityRef));return cmdHelper.updateBusinessObject(element,compensateEventDefinition,{activityRef:activityRef})}}))}},{"../../../../Utils":4,"../../../../factory/EntryFactory":15,"../../../../helper/CmdHelper":26,"../../../../helper/EventDefinitionHelper":28,"bpmn-js/lib/util/ModelUtil":177,"lodash/filter":557,"lodash/find":558,"lodash/forEach":561}],37:[function(require,module,exports){"use strict";var entryFactory=require("../../../../factory/EntryFactory"),cmdHelper=require("../../../../helper/CmdHelper"),is=require("bpmn-js/lib/util/ModelUtil").is,isEventSubProcess=require("bpmn-js/lib/util/DiUtil").isEventSubProcess;module.exports=function(group,element,bpmnFactory,conditionalEventDefinition,elementRegistry,translate){var getValue=function(modelProperty){return function(element){var modelPropertyValue=conditionalEventDefinition.get("camunda:"+modelProperty),value={};return value[modelProperty]=modelPropertyValue,value}},setValue=function(modelProperty){return function(element,values){var props={};return props["camunda:"+modelProperty]=values[modelProperty]||void 0,cmdHelper.updateBusinessObject(element,conditionalEventDefinition,props)}};group.entries.push(entryFactory.textField(translate,{id:"variableName",label:translate("Variable Name"),modelProperty:"variableName",get:getValue("variableName"),set:setValue("variableName")})),is(element,"bpmn:StartEvent")&&!isEventSubProcess(element.parent)||group.entries.push(entryFactory.textField(translate,{id:"variableEvents",label:translate("Variable Events"),description:translate("Specify more than one variable change event as a comma separated list."),modelProperty:"variableEvents",get:getValue("variableEvents"),set:setValue("variableEvents")}))}},{"../../../../factory/EntryFactory":15,"../../../../helper/CmdHelper":26,"bpmn-js/lib/util/DiUtil":175,"bpmn-js/lib/util/ModelUtil":177}],38:[function(require,module,exports){"use strict";var entryFactory=require("../../../../factory/EntryFactory"),cmdHelper=require("../../../../helper/CmdHelper");module.exports=function(element,definition,bpmnFactory,translate,options){var id=options.id||"element-property",label=options.label,referenceProperty=options.referenceProperty,modelProperty=options.modelProperty||"name",shouldValidate=options.shouldValidate||!1,entry=entryFactory.textField(translate,{id:id,label:label,modelProperty:modelProperty,get:function(){var reference=definition.get(referenceProperty),props={};return props[modelProperty]=reference&&reference.get(modelProperty),props},set:function(element,values){var reference=definition.get(referenceProperty),props={};return props[modelProperty]=values[modelProperty]||void 0,cmdHelper.updateBusinessObject(element,reference,props)},hidden:function(){return!definition.get(referenceProperty)}});return shouldValidate&&(entry.validate=function(element,values,node){if(definition.get(referenceProperty)&&!values[modelProperty]){var validationErrors={};return validationErrors[modelProperty]="Must provide a value",validationErrors}}),[entry]}},{"../../../../factory/EntryFactory":15,"../../../../helper/CmdHelper":26}],39:[function(require,module,exports){"use strict";var eventDefinitionReference=require("./EventDefinitionReference"),elementReferenceProperty=require("./ElementReferenceProperty");module.exports=function(group,element,bpmnFactory,errorEventDefinition,translate){group.entries=group.entries.concat(eventDefinitionReference(element,errorEventDefinition,bpmnFactory,{label:translate("Error"),elementName:"error",elementType:"bpmn:Error",referenceProperty:"errorRef",newElementIdPrefix:"Error_"})),group.entries=group.entries.concat(elementReferenceProperty(element,errorEventDefinition,bpmnFactory,translate,{id:"error-element-name",label:translate("Error Name"),referenceProperty:"errorRef",modelProperty:"name",shouldValidate:!0})),group.entries=group.entries.concat(elementReferenceProperty(element,errorEventDefinition,bpmnFactory,translate,{id:"error-element-code",label:translate("Error Code"),referenceProperty:"errorRef",modelProperty:"errorCode"}))}},{"./ElementReferenceProperty":38,"./EventDefinitionReference":41}],40:[function(require,module,exports){"use strict";var entryFactory=require("../../../../factory/EntryFactory"),cmdHelper=require("../../../../helper/CmdHelper"),eventDefinitionReference=require("./EventDefinitionReference"),elementReferenceProperty=require("./ElementReferenceProperty");module.exports=function(group,element,bpmnFactory,escalationEventDefinition,showEscalationCodeVariable,translate){group.entries=group.entries.concat(eventDefinitionReference(element,escalationEventDefinition,bpmnFactory,{label:translate("Escalation"),elementName:"escalation",elementType:"bpmn:Escalation",referenceProperty:"escalationRef",newElementIdPrefix:"Escalation_"})),group.entries=group.entries.concat(elementReferenceProperty(element,escalationEventDefinition,bpmnFactory,translate,{id:"escalation-element-name",label:translate("Escalation Name"),referenceProperty:"escalationRef",modelProperty:"name",shouldValidate:!0})),group.entries=group.entries.concat(elementReferenceProperty(element,escalationEventDefinition,bpmnFactory,translate,{id:"escalation-element-code",label:translate("Escalation Code"),referenceProperty:"escalationRef",modelProperty:"escalationCode"})),showEscalationCodeVariable&&group.entries.push(entryFactory.textField(translate,{id:"escalationCodeVariable",label:translate("Escalation Code Variable"),modelProperty:"escalationCodeVariable",get:function(){return{escalationCodeVariable:escalationEventDefinition.get("camunda:escalationCodeVariable")}},set:function(element,values){return cmdHelper.updateBusinessObject(element,escalationEventDefinition,{"camunda:escalationCodeVariable":values.escalationCodeVariable||void 0})}}))}},{"../../../../factory/EntryFactory":15,"../../../../helper/CmdHelper":26,"./ElementReferenceProperty":38,"./EventDefinitionReference":41}],41:[function(require,module,exports){"use strict";var cmdHelper=require("../../../../helper/CmdHelper"),domQuery=require("min-dom").query,domify=require("min-dom").domify,domAttr=require("min-dom").attr,forEach=require("lodash/forEach"),find=require("lodash/find"),elementHelper=require("../../../../helper/ElementHelper"),utils=require("../../../../Utils"),escapeHTML=utils.escapeHTML,selector="select[name=selectedElement]";module.exports=function(element,definition,bpmnFactory,options){var elementName=options.elementName||"",elementType=options.elementType,referenceProperty=options.referenceProperty,newElementIdPrefix=options.newElementIdPrefix||"elem_",label=options.label||"",description=options.description||"",entries=[];return entries.push({id:"event-definitions-"+elementName,description:description,html:'<div class="bpp-row bpp-select"><label for="camunda-'+escapeHTML(elementName)+'">'+escapeHTML(label)+'</label><div class="bpp-field-wrapper"><select id="camunda-'+escapeHTML(elementName)+'" name="selectedElement" data-value></select><button class="action-button add" id="addElement" data-action="addElement"><span>+</span></button></div></div>',get:function(element,entryNode){utils.updateOptionsDropDown(selector,definition,elementType,entryNode);var reference=definition.get(referenceProperty);return{selectedElement:reference&&reference.id||""}},set:function(element,values){var selection=values.selectedElement,props={};if(!selection||void 0===selection)return props[referenceProperty]=void 0,cmdHelper.updateBusinessObject(element,definition,props);var eventDefinition,type,id,elements,root,commands=[],selectedElement=(eventDefinition=definition,type=elementType,id=selection,elements=utils.findRootElementsByType(eventDefinition,type),find(elements,function(element){return element.id===id}));return selectedElement||(root=utils.getRoot(definition),selectedElement=elementHelper.createElement(elementType,{name:selection},root,bpmnFactory),commands.push(cmdHelper.addAndRemoveElementsFromList(element,root,"rootElements",null,[selectedElement]))),props[referenceProperty]=selectedElement,commands.push(cmdHelper.updateBusinessObject(element,definition,props)),commands},addElement:function(element,inputNode){var id=utils.nextId(newElementIdPrefix),optionTemplate=domify('<option value="'+escapeHTML(id)+'"> (id='+escapeHTML(id)+")</option>"),selectBox=domQuery(selector,inputNode.parentElement);return selectBox.insertBefore(optionTemplate,selectBox.firstChild),forEach(selectBox,function(option){option.value===id?domAttr(option,"selected","selected"):domAttr(option,"selected",null)}),!0}}),entries}},{"../../../../Utils":4,"../../../../helper/CmdHelper":26,"../../../../helper/ElementHelper":27,"lodash/find":558,"lodash/forEach":561,"min-dom":48}],42:[function(require,module,exports){"use strict";var eventDefinitionReference=require("./EventDefinitionReference"),elementReferenceProperty=require("./ElementReferenceProperty");module.exports=function(group,element,bpmnFactory,messageEventDefinition,translate){group.entries=group.entries.concat(eventDefinitionReference(element,messageEventDefinition,bpmnFactory,{label:translate("Message"),elementName:"message",elementType:"bpmn:Message",referenceProperty:"messageRef",newElementIdPrefix:"Message_"})),group.entries=group.entries.concat(elementReferenceProperty(element,messageEventDefinition,bpmnFactory,translate,{id:"message-element-name",label:translate("Message Name"),referenceProperty:"messageRef",modelProperty:"name",shouldValidate:!0}))}},{"./ElementReferenceProperty":38,"./EventDefinitionReference":41}],43:[function(require,module,exports){"use strict";var entryFactory=require("../../../../factory/EntryFactory");module.exports=function(element,options,translate){var id=(options=options||{}).id||"name",label=options.label||translate("Name"),modelProperty=options.modelProperty||"name";return[entryFactory.textBox(translate,{id:id,label:label,modelProperty:modelProperty,get:options.get,set:options.set})]}},{"../../../../factory/EntryFactory":15}],44:[function(require,module,exports){"use strict";var eventDefinitionReference=require("./EventDefinitionReference"),elementReferenceProperty=require("./ElementReferenceProperty");module.exports=function(group,element,bpmnFactory,signalEventDefinition,translate){group.entries=group.entries.concat(eventDefinitionReference(element,signalEventDefinition,bpmnFactory,{label:translate("Signal"),elementName:"signal",elementType:"bpmn:Signal",referenceProperty:"signalRef",newElementIdPrefix:"Signal_"})),group.entries=group.entries.concat(elementReferenceProperty(element,signalEventDefinition,bpmnFactory,translate,{id:"signal-element-name",label:translate("Signal Name"),referenceProperty:"signalRef",modelProperty:"name",shouldValidate:!0}))}},{"./ElementReferenceProperty":38,"./EventDefinitionReference":41}],45:[function(require,module,exports){"use strict";var elementHelper=require("../../../../helper/ElementHelper"),cmdHelper=require("../../../../helper/CmdHelper"),entryFactory=require("../../../../factory/EntryFactory");function getTimerDefinitionType(timer){if(timer)return void 0!==timer.get("timeDate")?"timeDate":void 0!==timer.get("timeCycle")?"timeCycle":void 0!==timer.get("timeDuration")?"timeDuration":void 0}function getTimerDefinition(timerOrFunction,element,node){return"function"==typeof timerOrFunction?timerOrFunction(element,node):timerOrFunction}module.exports=function(group,element,bpmnFactory,timerEventDefinition,translate,options){var selectOptions=[{value:"timeDate",name:translate("Date")},{value:"timeDuration",name:translate("Duration")},{value:"timeCycle",name:translate("Cycle")}],prefix=options&&options.idPrefix,createTimerEventDefinition=options&&options.createTimerEventDefinition;group.entries.push(entryFactory.selectBox(translate,{id:prefix+"timer-event-definition-type",label:translate("Timer Definition Type"),selectOptions:selectOptions,emptyParameter:!0,modelProperty:"timerDefinitionType",get:function(element,node){return{timerDefinitionType:getTimerDefinitionType(getTimerDefinition(timerEventDefinition,element,node))||""}},set:function(element,values,node){var oldType,value,props={timeDuration:void 0,timeDate:void 0,timeCycle:void 0},timerDefinition=getTimerDefinition(timerEventDefinition,element,node),newType=values.timerDefinitionType;return timerDefinition||"function"!=typeof createTimerEventDefinition||(timerDefinition=createTimerEventDefinition(element,node)),values.timerDefinitionType&&((oldType=getTimerDefinitionType(timerDefinition))&&(value=timerDefinition.get(oldType).get("body")),props[newType]=function(parent,body,bpmnFactory){return body=body||void 0,elementHelper.createElement("bpmn:FormalExpression",{body:body},parent,bpmnFactory)}(timerDefinition,value,bpmnFactory)),cmdHelper.updateBusinessObject(element,timerDefinition,props)},hidden:function(element,node){return void 0===getTimerDefinition(timerEventDefinition,element,node)}})),group.entries.push(entryFactory.textField(translate,{id:prefix+"timer-event-definition",label:translate("Timer Definition"),modelProperty:"timerDefinition",get:function(element,node){var timerDefinition=getTimerDefinition(timerEventDefinition,element,node),type=getTimerDefinitionType(timerDefinition),definition=type&&timerDefinition.get(type);return{timerDefinition:definition&&definition.get("body")}},set:function(element,values,node){var timerDefinition=getTimerDefinition(timerEventDefinition,element,node),type=getTimerDefinitionType(timerDefinition),definition=type&&timerDefinition.get(type);if(definition)return cmdHelper.updateBusinessObject(element,definition,{body:values.timerDefinition||void 0})},validate:function(element,node){var timerDefinition=getTimerDefinition(timerEventDefinition,element,node),type=getTimerDefinitionType(timerDefinition),definition=type&&timerDefinition.get(type);if(definition&&!definition.get("body"))return{timerDefinition:translate("Must provide a value")}},hidden:function(element,node){return!getTimerDefinitionType(getTimerDefinition(timerEventDefinition,element,node))}}))}},{"../../../../factory/EntryFactory":15,"../../../../helper/CmdHelper":26,"../../../../helper/ElementHelper":27}],46:[function(require,module,exports){"use strict";var is=require("bpmn-js/lib/util/ModelUtil").is,isAny=require("bpmn-js/lib/features/modeling/util/ModelingUtil").isAny,getBusinessObject=require("bpmn-js/lib/util/ModelUtil").getBusinessObject,escapeHTML=require("../../../Utils").escapeHTML,domQuery=require("min-dom").query,cmdHelper=require("../../../helper/CmdHelper"),elementHelper=require("../../../helper/ElementHelper"),eventDefinitionHelper=require("../../../helper/EventDefinitionHelper"),scriptImplementation=require("./implementation/Script");module.exports=function(group,element,bpmnFactory,translate){var conditionalEventDefinition,script,bo=getBusinessObject(element);bo&&(conditionalEventDefinition=eventDefinitionHelper.getConditionalEventDefinition(element),(is(element,"bpmn:SequenceFlow")&&function(element){return isAny(element,CONDITIONAL_SOURCES)}(element.source)||conditionalEventDefinition)&&(script=scriptImplementation("language","body",!0,translate),group.entries.push({id:"condition",label:translate("Condition"),html:'<div class="bpp-row"><label for="cam-condition-type">'+escapeHTML(translate("Condition Type"))+'</label><div class="bpp-field-wrapper"><select id="cam-condition-type" name="conditionType" data-value><option value="expression">'+escapeHTML(translate("Expression"))+'</option><option value="script">'+escapeHTML(translate("Script"))+'</option><option value="" selected></option></select></div></div><div class="bpp-row"><label for="cam-condition" data-show="isExpression">'+escapeHTML(translate("Expression"))+'</label><div class="bpp-field-wrapper" data-show="isExpression"><input id="cam-condition" type="text" name="condition" /><button class="action-button clear" data-action="clear" data-show="canClear"><span>X</span></button></div><div data-show="isScript">'+script.template+"</div></div>",get:function(element){var conditionalEventDefinition=eventDefinitionHelper.getConditionalEventDefinition(element),conditionExpression=conditionalEventDefinition?conditionalEventDefinition.condition:bo.conditionExpression,values={},conditionType="";return conditionExpression&&(void 0!==conditionExpression.language?(conditionType="script",values=script.get(element,conditionExpression)):(conditionType="expression",values.condition=conditionExpression.get("body"))),values.conditionType=conditionType,values},set:function(element,values,containerElement){var condition,conditionOrConditionExpression,source,conditionType=values.conditionType,commands=[],conditionProps={body:void 0};"script"===conditionType?conditionProps=script.set(element,values,containerElement):(condition=values.condition,conditionProps.body=condition),conditionType&&(conditionOrConditionExpression=elementHelper.createElement("bpmn:FormalExpression",conditionProps,conditionalEventDefinition||bo,bpmnFactory),(source=element.source)&&source.businessObject.default===bo&&commands.push(cmdHelper.updateProperties(source,{default:void 0})));var update=conditionalEventDefinition?{condition:conditionOrConditionExpression}:{conditionExpression:conditionOrConditionExpression};return commands.push(cmdHelper.updateBusinessObject(element,conditionalEventDefinition||bo,update)),commands},validate:function(element,values){var validationResult={};return values.condition||"expression"!==values.conditionType?"script"===values.conditionType&&(validationResult=script.validate(element,values)):validationResult.condition=translate("Must provide a value"),validationResult},isExpression:function(element,inputNode){var conditionType=domQuery("select[name=conditionType]",inputNode);if(0<=conditionType.selectedIndex)return"expression"===conditionType.options[conditionType.selectedIndex].value},isScript:function(element,inputNode){var conditionType=domQuery("select[name=conditionType]",inputNode);if(0<=conditionType.selectedIndex)return"script"===conditionType.options[conditionType.selectedIndex].value},clear:function(element,inputNode){return!(domQuery("input[name=condition]",inputNode).value="")},canClear:function(element,inputNode){return""!==domQuery("input[name=condition]",inputNode).value},script:script,cssClasses:["bpp-textfield"]})))};var CONDITIONAL_SOURCES=["bpmn:Activity","bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:ComplexGateway"]},{"../../../Utils":4,"../../../helper/CmdHelper":26,"../../../helper/ElementHelper":27,"../../../helper/EventDefinitionHelper":28,"./implementation/Script":47,"bpmn-js/lib/features/modeling/util/ModelingUtil":148,"bpmn-js/lib/util/ModelUtil":177,"min-dom":48}],47:[function(require,module,exports){"use strict";var domQuery=require("min-dom").query,escapeHTML=require("../../../../Utils").escapeHTML,utils=require("../../../../Utils");function getScriptType(node){return utils.selectedType("select[name=scriptType]",node.parentElement)}module.exports=function(scriptLanguagePropName,scriptValuePropName,isFormatRequired,translate,options){var idPrefix=options&&options.idPrefix||"";return{template:'<div class="bpp-row bpp-textfield"><label for="'+idPrefix+'cam-script-format">'+escapeHTML(translate("Script Format"))+'</label><div class="bpp-field-wrapper"><input id="'+idPrefix+'cam-script-format" type="text" name="scriptFormat" /><button class="action-button clear" data-action="script.clearScriptFormat" data-show="script.canClearScriptFormat"><span>X</span></button></div></div><div class="bpp-row"><label for="'+idPrefix+'cam-script-type">'+escapeHTML(translate("Script Type"))+'</label><div class="bpp-field-wrapper"><select id="'+idPrefix+'cam-script-type" name="scriptType" data-value><option value="script" selected>'+escapeHTML(translate("Inline Script"))+'</option><option value="scriptResource">'+escapeHTML(translate("External Resource"))+'</option></select></div></div><div class="bpp-row bpp-textfield"><label for="'+idPrefix+'cam-script-resource-val" data-show="script.isScriptResource">'+escapeHTML(translate("Resource"))+'</label><div class="bpp-field-wrapper" data-show="script.isScriptResource"><input id="'+idPrefix+'cam-script-resource-val" type="text" name="scriptResourceValue" /><button class="action-button clear" data-action="script.clearScriptResource" data-show="script.canClearScriptResource"><span>X</span></button></div></div><div class="bpp-row"><label for="'+idPrefix+'cam-script-val" data-show="script.isScript">'+escapeHTML(translate("Script"))+'</label><div class="bpp-field-wrapper" data-show="script.isScript"><textarea id="'+idPrefix+'cam-script-val" type="text" name="scriptValue"></textarea></div></div>',get:function(element,bo){var values={},boScriptResource=bo.get("camunda:resource"),boScript=bo.get(scriptValuePropName),boScriptFormat=bo.get(scriptLanguagePropName);return void 0!==boScriptResource?(values.scriptResourceValue=boScriptResource,values.scriptType="scriptResource"):(values.scriptValue=boScript,values.scriptType="script"),values.scriptFormat=boScriptFormat,values},set:function(element,values){var scriptFormat=values.scriptFormat,scriptType=values.scriptType,scriptResourceValue=values.scriptResourceValue,scriptValue=values.scriptValue,update={"camunda:resource":void 0};return update[scriptValuePropName]=void 0,update[scriptLanguagePropName]=void 0,isFormatRequired?update[scriptLanguagePropName]=scriptFormat||"":""!==scriptFormat&&(update[scriptLanguagePropName]=scriptFormat),"scriptResource"===scriptType?update["camunda:resource"]=scriptResourceValue||"":update[scriptValuePropName]=scriptValue||"",update},validate:function(element,values){var validationResult={};return"script"!==values.scriptType||values.scriptValue||(validationResult.scriptValue=translate("Must provide a value")),"scriptResource"!==values.scriptType||values.scriptResourceValue||(validationResult.scriptResourceValue=translate("Must provide a value")),!isFormatRequired||values.scriptFormat&&0!==values.scriptFormat.length||(validationResult.scriptFormat=translate("Must provide a value")),validationResult},clearScriptFormat:function(element,inputNode,btnNode,scopeNode){return!(domQuery("input[name=scriptFormat]",scopeNode).value="")},canClearScriptFormat:function(element,inputNode,btnNode,scopeNode){return""!==domQuery("input[name=scriptFormat]",scopeNode).value},clearScriptResource:function(element,inputNode,btnNode,scopeNode){return!(domQuery("input[name=scriptResourceValue]",scopeNode).value="")},canClearScriptResource:function(element,inputNode,btnNode,scopeNode){return""!==domQuery("input[name=scriptResourceValue]",scopeNode).value},clearScript:function(element,inputNode,btnNode,scopeNode){return!(domQuery("textarea[name=scriptValue]",scopeNode).value="")},canClearScript:function(element,inputNode,btnNode,scopeNode){return""!==domQuery("textarea[name=scriptValue]",scopeNode).value},isScriptResource:function(element,inputNode,btnNode,scopeNode){return"scriptResource"===getScriptType(scopeNode)},isScript:function(element,inputNode,btnNode,scopeNode){return"script"===getScriptType(scopeNode)}}}},{"../../../../Utils":4,"min-dom":48}],48:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var indexOf=[].indexOf,indexof=function(arr,obj){if(indexOf)return arr.indexOf(obj);for(var i=0;i<arr.length;++i)if(arr[i]===obj)return i;return-1},re=/\s+/,toString=Object.prototype.toString;function ClassList(el){if(!el||!el.nodeType)throw new Error("A DOM element reference is required");this.el=el,this.list=el.classList}ClassList.prototype.add=function(name){if(this.list)return this.list.add(name),this;var arr=this.array();return~indexof(arr,name)||arr.push(name),this.el.className=arr.join(" "),this},ClassList.prototype.remove=function(name){if("[object RegExp]"==toString.call(name))return this.removeMatching(name);if(this.list)return this.list.remove(name),this;var arr=this.array(),i=indexof(arr,name);return~i&&arr.splice(i,1),this.el.className=arr.join(" "),this},ClassList.prototype.removeMatching=function(re){for(var arr=this.array(),i=0;i<arr.length;i++)re.test(arr[i])&&this.remove(arr[i]);return this},ClassList.prototype.toggle=function(name,force){return this.list?void 0!==force&&force===this.list.toggle(name,force)||this.list.toggle(name):void 0!==force?force?this.add(name):this.remove(name):this.has(name)?this.remove(name):this.add(name),this},ClassList.prototype.array=function(){var arr=(this.el.getAttribute("class")||"").replace(/^\s+|\s+$/g,"").split(re);return""===arr[0]&&arr.shift(),arr},ClassList.prototype.has=ClassList.prototype.contains=function(name){return this.list?this.list.contains(name):!!~indexof(this.array(),name)};var proto="undefined"!=typeof Element?Element.prototype:{},vendor=proto.matches||proto.matchesSelector||proto.webkitMatchesSelector||proto.mozMatchesSelector||proto.msMatchesSelector||proto.oMatchesSelector,matchesSelector=function(el,selector){if(!el||1!==el.nodeType)return!1;if(vendor)return vendor.call(el,selector);for(var nodes=el.parentNode.querySelectorAll(selector),i=0;i<nodes.length;i++)if(nodes[i]==el)return!0;return!1};function closest(element,selector,checkYourSelf){for(var currentElem=checkYourSelf?element:element.parentNode;currentElem&&currentElem.nodeType!==document.DOCUMENT_NODE&&currentElem.nodeType!==document.DOCUMENT_FRAGMENT_NODE;){if(matchesSelector(currentElem,selector))return currentElem;currentElem=currentElem.parentNode}return matchesSelector(currentElem,selector)?currentElem:null}var bind=window.addEventListener?"addEventListener":"attachEvent",unbind=window.removeEventListener?"removeEventListener":"detachEvent",prefix="addEventListener"!=bind?"on":"",componentEvent={bind:function(el,type,fn,capture){return el[bind](prefix+type,fn,capture||!1),fn},unbind:function(el,type,fn,capture){return el[unbind](prefix+type,fn,capture||!1),fn}},forceCaptureEvents=["focus","blur"];function domify(html,doc){if("string"!=typeof html)throw new TypeError("String expected");doc=doc||document;var m=/<([\w:]+)/.exec(html);if(!m)return doc.createTextNode(html);html=html.replace(/^\s+|\s+$/g,"");var tag=m[1];if("body"==tag){return(el=doc.createElement("html")).innerHTML=html,el.removeChild(el.lastChild)}var el,wrap=map[tag]||map._default,depth=wrap[0],prefix=wrap[1],suffix=wrap[2];for((el=doc.createElement("div")).innerHTML=prefix+html+suffix;depth--;)el=el.lastChild;if(el.firstChild==el.lastChild)return el.removeChild(el.firstChild);for(var fragment=doc.createDocumentFragment();el.firstChild;)fragment.appendChild(el.removeChild(el.firstChild));return fragment}var bugTestDiv,delegate={bind:function(el,selector,type,fn,capture){return-1!==forceCaptureEvents.indexOf(type)&&(capture=!0),componentEvent.bind(el,type,function(e){var target=e.target||e.srcElement;e.delegateTarget=closest(target,selector,!0),e.delegateTarget&&fn.call(el,e)},capture)},unbind:function(el,type,fn,capture){return-1!==forceCaptureEvents.indexOf(type)&&(capture=!0),componentEvent.unbind(el,type,fn,capture)}},innerHTMLBug=!1;"undefined"!=typeof document&&((bugTestDiv=document.createElement("div")).innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',innerHTMLBug=!bugTestDiv.getElementsByTagName("link").length,bugTestDiv=void 0);var map={legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:innerHTMLBug?[1,"X<div>","</div>"]:[0,"",""]};map.td=map.th=[3,"<table><tbody><tr>","</tr></tbody></table>"],map.option=map.optgroup=[1,'<select multiple="multiple">',"</select>"],map.thead=map.tbody=map.colgroup=map.caption=map.tfoot=[1,"<table>","</table>"],map.polyline=map.ellipse=map.polygon=map.circle=map.text=map.line=map.path=map.rect=map.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"],exports.attr=function(el,name,val){return 2==arguments.length?el.getAttribute(name):null===val?el.removeAttribute(name):(el.setAttribute(name,val),el)},exports.classes=function(el){return new ClassList(el)},exports.clear=function(el){for(var c;el.childNodes.length;)c=el.childNodes[0],el.removeChild(c);return el},exports.closest=closest,exports.delegate=delegate,exports.domify=domify,exports.event=componentEvent,exports.matches=matchesSelector,exports.query=function(selector,el){return(el=el||document).querySelector(selector)},exports.queryAll=function(selector,el){return(el=el||document).querySelectorAll(selector)},exports.remove=function(el){el.parentNode&&el.parentNode.removeChild(el)}},{}],49:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BaseModeler;var _inherits2=_interopRequireDefault(require("inherits")),_ids2=_interopRequireDefault(require("ids")),_BaseViewer2=_interopRequireDefault(require("./BaseViewer"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function BaseModeler(options){_BaseViewer2.default.call(this,options),this.on("import.parse.complete",function(event){event.error||this._collectIds(event.definitions,event.elementsById)},this),this.on("diagram.destroy",function(){this.get("moddle").ids.clear()},this)}(0,_inherits2.default)(BaseModeler,_BaseViewer2.default),BaseModeler.prototype._createModdle=function(options){var moddle=_BaseViewer2.default.prototype._createModdle.call(this,options);return moddle.ids=new _ids2.default([32,36,1]),moddle},BaseModeler.prototype._collectIds=function(definitions,elementsById){var id,ids=definitions.$model.ids;for(id in ids.clear(),elementsById)ids.claim(id,elementsById[id])}},{"./BaseViewer":50,ids:384,inherits:385}],50:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BaseViewer;var _minDash=require("min-dash"),_minDom=require("min-dom"),_tinySvg=require("tiny-svg"),_diagramJs2=_interopRequireDefault(require("diagram-js")),_bpmnModdle2=_interopRequireDefault(require("bpmn-moddle")),_inherits2=_interopRequireDefault(require("inherits")),_Importer=require("./import/Importer"),_CompatibilityUtil=require("./util/CompatibilityUtil"),_PoweredByUtil=require("./util/PoweredByUtil");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function BaseViewer(options){var container,img,linkMarkup,linkElement;options=(0,_minDash.assign)({},DEFAULT_OPTIONS,options),this._moddle=this._createModdle(options),this._container=this._createContainer(options),container=this._container,img=_PoweredByUtil.BPMNIO_IMG,linkMarkup='<a href="http://bpmn.io" target="_blank" class="bjs-powered-by" title="Powered by bpmn.io" style="position: absolute; bottom: 15px; right: 15px; z-index: 100; '+_PoweredByUtil.LINK_STYLES+'">'+img+"</a>",linkElement=(0,_minDom.domify)(linkMarkup),container.appendChild(linkElement),_minDom.event.bind(linkElement,"click",function(event){(0,_PoweredByUtil.open)(),event.preventDefault()}),this._init(this._container,this._moddle,options)}function addWarningsToError(err,warningsAry){return err.warnings=warningsAry,err}(0,_inherits2.default)(BaseViewer,_diagramJs2.default),BaseViewer.prototype.importXML=(0,_CompatibilityUtil.wrapForCompatibility)(function(xml,bpmnDiagram){var self=this;return new Promise(function(resolve,reject){xml=self._emit("import.parse.start",{xml:xml})||xml,self._moddle.fromXML(xml,"bpmn:Definitions").then(function(result){var data,event,definitions=result.rootElement,references=result.references,parseWarnings=result.warnings,elementsById=result.elementsById,definitions=self._emit("import.parse.complete",(data={error:null,definitions:definitions,elementsById:elementsById,references:references,warnings:parseWarnings},event=self.get("eventBus").createEvent(data),Object.defineProperty(event,"context",{enumerable:!0,get:function(){return console.warn(new Error("import.parse.complete <context> is deprecated and will be removed in future library versions")),{warnings:data.warnings,references:data.references,elementsById:data.elementsById}}}),event))||definitions;self.importDefinitions(definitions,bpmnDiagram).then(function(result){var allWarnings=[].concat(parseWarnings,result.warnings||[]);return self._emit("import.done",{error:null,warnings:allWarnings}),resolve({warnings:allWarnings})}).catch(function(err){var allWarnings=[].concat(parseWarnings,err.warnings||[]);return self._emit("import.done",{error:err,warnings:allWarnings}),reject(addWarningsToError(err,allWarnings))})}).catch(function(err){return self._emit("import.parse.complete",{error:err}),err=function(err){var match=/unparsable content <([^>]+)> detected([\s\S]*)$/.exec(err.message);match&&(err.message="unparsable content <"+match[1]+"> detected; this may indicate an invalid BPMN 2.0 diagram file"+match[2]);return err}(err),self._emit("import.done",{error:err,warnings:err.warnings}),reject(err)})})}),BaseViewer.prototype.importDefinitions=(0,_CompatibilityUtil.wrapForCompatibility)(function(definitions,bpmnDiagram){var self=this;return new Promise(function(resolve,reject){self._setDefinitions(definitions),self.open(bpmnDiagram).then(function(result){var warnings=result.warnings;return resolve({warnings:warnings})}).catch(function(err){return reject(err)})})}),BaseViewer.prototype.open=(0,_CompatibilityUtil.wrapForCompatibility)(function(bpmnDiagramOrId){var definitions=this._definitions,bpmnDiagram=bpmnDiagramOrId,self=this;return new Promise(function(resolve,reject){if(!definitions){var err1=new Error("no XML imported");return reject(addWarningsToError(err1,[]))}if("string"==typeof bpmnDiagramOrId&&!(bpmnDiagram=function(definitions,diagramId){return diagramId&&(0,_minDash.find)(definitions.diagrams,function(element){return element.id===diagramId})||null}(definitions,bpmnDiagramOrId))){var err2=new Error("BPMNDiagram <"+bpmnDiagramOrId+"> not found");return reject(addWarningsToError(err2,[]))}try{self.clear()}catch(error){return reject(addWarningsToError(error,[]))}(0,_Importer.importBpmnDiagram)(self,definitions,bpmnDiagram).then(function(result){var warnings=result.warnings;return resolve({warnings:warnings})}).catch(function(err){return reject(err)})})}),BaseViewer.prototype.saveXML=(0,_CompatibilityUtil.wrapForCompatibility)(function(options){options=options||{};var self=this,definitions=this._definitions;return new Promise(function(resolve,reject){if(!definitions){var err=new Error("no definitions loaded");return reject(err)}definitions=self._emit("saveXML.start",{definitions:definitions})||definitions,self._moddle.toXML(definitions,options).then(function(result){var xml=result.xml;try{xml=self._emit("saveXML.serialized",{error:null,xml:xml})||xml,self._emit("saveXML.done",{error:null,xml:xml})}catch(e){console.error("error in saveXML life-cycle listener",e)}return resolve({xml:xml})}).catch(function(err){return reject(err)})})}),BaseViewer.prototype.saveSVG=(0,_CompatibilityUtil.wrapForCompatibility)(function(){var self=this;return new Promise(function(resolve,reject){var err;self._emit("saveSVG.start");try{var canvas=self.get("canvas"),contentNode=canvas.getDefaultLayer(),defsNode=(0,_minDom.query)("defs",canvas._svg),contents=(0,_tinySvg.innerSVG)(contentNode),defs=defsNode?"<defs>"+(0,_tinySvg.innerSVG)(defsNode)+"</defs>":"",bbox=contentNode.getBBox(),svg='<?xml version="1.0" encoding="utf-8"?>\n\x3c!-- created with bpmn-js / http://bpmn.io --\x3e\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+bbox.width+'" height="'+bbox.height+'" viewBox="'+bbox.x+" "+bbox.y+" "+bbox.width+" "+bbox.height+'" version="1.1">'+defs+contents+"</svg>"}catch(e){err=e}return self._emit("saveSVG.done",{error:err,svg:svg}),err?reject(err):resolve({svg:svg})})}),BaseViewer.prototype._setDefinitions=function(definitions){this._definitions=definitions},BaseViewer.prototype.getModules=function(){return this._modules},BaseViewer.prototype.clear=function(){this.getDefinitions()&&(this.get("elementRegistry").forEach(function(element){var bo=element.businessObject;bo&&bo.di&&delete bo.di}),_diagramJs2.default.prototype.clear.call(this))},BaseViewer.prototype.destroy=function(){_diagramJs2.default.prototype.destroy.call(this),(0,_minDom.remove)(this._container)},BaseViewer.prototype.on=function(event,priority,callback,target){return this.get("eventBus").on(event,priority,callback,target)},BaseViewer.prototype.off=function(event,callback){this.get("eventBus").off(event,callback)},BaseViewer.prototype.attachTo=function(parentNode){if(!parentNode)throw new Error("parentNode required");this.detach(),parentNode.get&&parentNode.constructor.prototype.jquery&&(parentNode=parentNode.get(0)),"string"==typeof parentNode&&(parentNode=(0,_minDom.query)(parentNode)),parentNode.appendChild(this._container),this._emit("attach",{}),this.get("canvas").resized()},BaseViewer.prototype.getDefinitions=function(){return this._definitions},BaseViewer.prototype.detach=function(){var container=this._container,parentNode=container.parentNode;parentNode&&(this._emit("detach",{}),parentNode.removeChild(container))},BaseViewer.prototype._init=function(container,moddle,options){var baseModules=options.modules||this.getModules(),additionalModules=options.additionalModules||[],diagramModules=[].concat([{bpmnjs:["value",this],moddle:["value",moddle]}],baseModules,additionalModules),diagramOptions=(0,_minDash.assign)((0,_minDash.omit)(options,["additionalModules"]),{canvas:(0,_minDash.assign)({},options.canvas,{container:container}),modules:diagramModules});_diagramJs2.default.call(this,diagramOptions),options&&options.container&&this.attachTo(options.container)},BaseViewer.prototype._emit=function(type,event){return this.get("eventBus").fire(type,event)},BaseViewer.prototype._createContainer=function(options){var container=(0,_minDom.domify)('<div class="bjs-container"></div>');return(0,_minDash.assign)(container.style,{width:ensureUnit(options.width),height:ensureUnit(options.height),position:options.position}),container},BaseViewer.prototype._createModdle=function(options){var moddleOptions=(0,_minDash.assign)({},this._moddleExtensions,options.moddleExtensions);return new _bpmnModdle2.default(moddleOptions)},BaseViewer.prototype._modules=[];var DEFAULT_OPTIONS={width:"100%",height:"100%",position:"relative"};function ensureUnit(val){return val+((0,_minDash.isNumber)(val)?"px":"")}},{"./import/Importer":171,"./util/CompatibilityUtil":174,"./util/PoweredByUtil":178,"bpmn-moddle":366,"diagram-js":179,inherits:385,"min-dash":594,"min-dom":595,"tiny-svg":606}],51:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=Modeler;var _inherits2=_interopRequireDefault(require("inherits")),_BaseModeler2=_interopRequireDefault(require("./BaseModeler")),_Viewer2=_interopRequireDefault(require("./Viewer")),_NavigatedViewer2=_interopRequireDefault(require("./NavigatedViewer")),_keyboardMove2=_interopRequireDefault(require("diagram-js/lib/navigation/keyboard-move")),_movecanvas2=_interopRequireDefault(require("diagram-js/lib/navigation/movecanvas")),_touch2=_interopRequireDefault(require("diagram-js/lib/navigation/touch")),_zoomscroll2=_interopRequireDefault(require("diagram-js/lib/navigation/zoomscroll")),_alignElements2=_interopRequireDefault(require("diagram-js/lib/features/align-elements")),_autoPlace2=_interopRequireDefault(require("./features/auto-place")),_autoResize2=_interopRequireDefault(require("./features/auto-resize")),_autoScroll2=_interopRequireDefault(require("diagram-js/lib/features/auto-scroll")),_bendpoints2=_interopRequireDefault(require("diagram-js/lib/features/bendpoints")),_connect2=_interopRequireDefault(require("diagram-js/lib/features/connect")),_connectionPreview2=_interopRequireDefault(require("diagram-js/lib/features/connection-preview")),_contextPad2=_interopRequireDefault(require("./features/context-pad")),_copyPaste2=_interopRequireDefault(require("./features/copy-paste")),_create2=_interopRequireDefault(require("diagram-js/lib/features/create")),_distributeElements2=_interopRequireDefault(require("./features/distribute-elements")),_editorActions2=_interopRequireDefault(require("./features/editor-actions")),_gridSnapping2=_interopRequireDefault(require("./features/grid-snapping")),_interactionEvents2=_interopRequireDefault(require("./features/interaction-events")),_keyboard2=_interopRequireDefault(require("./features/keyboard")),_keyboardMoveSelection2=_interopRequireDefault(require("diagram-js/lib/features/keyboard-move-selection")),_labelEditing2=_interopRequireDefault(require("./features/label-editing")),_modeling2=_interopRequireDefault(require("./features/modeling")),_move2=_interopRequireDefault(require("diagram-js/lib/features/move")),_palette2=_interopRequireDefault(require("./features/palette")),_replacePreview2=_interopRequireDefault(require("./features/replace-preview")),_resize2=_interopRequireDefault(require("diagram-js/lib/features/resize")),_snapping2=_interopRequireDefault(require("./features/snapping")),_search2=_interopRequireDefault(require("./features/search")),_CompatibilityUtil=require("./util/CompatibilityUtil");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function Modeler(options){_BaseModeler2.default.call(this,options)}(0,_inherits2.default)(Modeler,_BaseModeler2.default),Modeler.Viewer=_Viewer2.default,Modeler.NavigatedViewer=_NavigatedViewer2.default,Modeler.prototype.createDiagram=(0,_CompatibilityUtil.wrapForCompatibility)(function(){return this.importXML('<?xml version="1.0" encoding="UTF-8"?><bpmn:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" targetNamespace="http://bpmn.io/schema/bpmn" id="Definitions_1"><bpmn:process id="Process_1" isExecutable="false"><bpmn:startEvent id="StartEvent_1"/></bpmn:process><bpmndi:BPMNDiagram id="BPMNDiagram_1"><bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1"><bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1"><dc:Bounds height="36.0" width="36.0" x="173.0" y="102.0"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></bpmn:definitions>')}),Modeler.prototype._interactionModules=[_keyboardMove2.default,_movecanvas2.default,_touch2.default,_zoomscroll2.default],Modeler.prototype._modelingModules=[_alignElements2.default,_autoPlace2.default,_autoScroll2.default,_autoResize2.default,_bendpoints2.default,_connect2.default,_connectionPreview2.default,_contextPad2.default,_copyPaste2.default,_create2.default,_distributeElements2.default,_editorActions2.default,_gridSnapping2.default,_interactionEvents2.default,_keyboard2.default,_keyboardMoveSelection2.default,_labelEditing2.default,_modeling2.default,_move2.default,_palette2.default,_replacePreview2.default,_resize2.default,_snapping2.default,_search2.default],Modeler.prototype._modules=[].concat(_Viewer2.default.prototype._modules,Modeler.prototype._interactionModules,Modeler.prototype._modelingModules)},{"./BaseModeler":49,"./NavigatedViewer":52,"./Viewer":53,"./features/auto-place":62,"./features/auto-resize":65,"./features/context-pad":67,"./features/copy-paste":70,"./features/distribute-elements":74,"./features/editor-actions":76,"./features/grid-snapping":82,"./features/interaction-events":84,"./features/keyboard":86,"./features/label-editing":91,"./features/modeling":146,"./features/palette":152,"./features/replace-preview":157,"./features/search":164,"./features/snapping":168,"./util/CompatibilityUtil":174,"diagram-js/lib/features/align-elements":195,"diagram-js/lib/features/auto-scroll":205,"diagram-js/lib/features/bendpoints":212,"diagram-js/lib/features/connect":219,"diagram-js/lib/features/connection-preview":221,"diagram-js/lib/features/create":228,"diagram-js/lib/features/keyboard-move-selection":249,"diagram-js/lib/features/move":287,"diagram-js/lib/features/resize":305,"diagram-js/lib/navigation/keyboard-move":340,"diagram-js/lib/navigation/movecanvas":342,"diagram-js/lib/navigation/touch":343,"diagram-js/lib/navigation/zoomscroll":346,inherits:385}],52:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=NavigatedViewer;var _inherits2=_interopRequireDefault(require("inherits")),_Viewer2=_interopRequireDefault(require("./Viewer")),_keyboardMove2=_interopRequireDefault(require("diagram-js/lib/navigation/keyboard-move")),_movecanvas2=_interopRequireDefault(require("diagram-js/lib/navigation/movecanvas")),_zoomscroll2=_interopRequireDefault(require("diagram-js/lib/navigation/zoomscroll"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function NavigatedViewer(options){_Viewer2.default.call(this,options)}(0,_inherits2.default)(NavigatedViewer,_Viewer2.default),NavigatedViewer.prototype._navigationModules=[_keyboardMove2.default,_movecanvas2.default,_zoomscroll2.default],NavigatedViewer.prototype._modules=[].concat(_Viewer2.default.prototype._modules,NavigatedViewer.prototype._navigationModules)},{"./Viewer":53,"diagram-js/lib/navigation/keyboard-move":340,"diagram-js/lib/navigation/movecanvas":342,"diagram-js/lib/navigation/zoomscroll":346,inherits:385}],53:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=Viewer;var _inherits2=_interopRequireDefault(require("inherits")),_core2=_interopRequireDefault(require("./core")),_translate2=_interopRequireDefault(require("diagram-js/lib/i18n/translate")),_selection2=_interopRequireDefault(require("diagram-js/lib/features/selection")),_overlays2=_interopRequireDefault(require("diagram-js/lib/features/overlays")),_BaseViewer2=_interopRequireDefault(require("./BaseViewer"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function Viewer(options){_BaseViewer2.default.call(this,options)}(0,_inherits2.default)(Viewer,_BaseViewer2.default),Viewer.prototype._modules=[_core2.default,_translate2.default,_selection2.default,_overlays2.default],Viewer.prototype._moddleExtensions={}},{"./BaseViewer":50,"./core":54,"diagram-js/lib/features/overlays":292,"diagram-js/lib/features/selection":314,"diagram-js/lib/i18n/translate":332,inherits:385}],54:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _draw2=_interopRequireDefault(require("../draw")),_import2=_interopRequireDefault(require("../import"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_draw2.default,_import2.default]}},{"../draw":59,"../import":173}],55:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isTypedEvent=function(event,eventDefinitionType,filter){return(0,_minDash.some)(event.eventDefinitions,function(definition){return definition.$type===eventDefinitionType&&function(definition,filter){return(0,_minDash.every)(filter,function(val,key){return definition[key]==val})}(event,filter)})},exports.isThrowEvent=function(event){return"bpmn:IntermediateThrowEvent"===event.$type||"bpmn:EndEvent"===event.$type},exports.isCollection=function(element){var dataObject=element.dataObjectRef;return element.isCollection||dataObject&&dataObject.isCollection},exports.getDi=getDi,exports.getSemantic=function(element){return element.businessObject},exports.getFillColor=function(element,defaultColor){return getDi(element).get("bioc:fill")||defaultColor||"white"},exports.getStrokeColor=function(element,defaultColor){return getDi(element).get("bioc:stroke")||defaultColor||"black"},exports.getCirclePath=function(shape){var cx=shape.x+shape.width/2,cy=shape.y+shape.height/2,radius=shape.width/2,circlePath=[["M",cx,cy],["m",0,-radius],["a",radius,radius,0,1,1,0,2*radius],["a",radius,radius,0,1,1,0,-2*radius],["z"]];return(0,_RenderUtil.componentsToPath)(circlePath)},exports.getRoundRectPath=function(shape,borderRadius){var x=shape.x,y=shape.y,width=shape.width,height=shape.height,roundRectPath=[["M",x+borderRadius,y],["l",width-2*borderRadius,0],["a",borderRadius,borderRadius,0,0,1,borderRadius,borderRadius],["l",0,height-2*borderRadius],["a",borderRadius,borderRadius,0,0,1,-borderRadius,borderRadius],["l",2*borderRadius-width,0],["a",borderRadius,borderRadius,0,0,1,-borderRadius,-borderRadius],["l",0,2*borderRadius-height],["a",borderRadius,borderRadius,0,0,1,borderRadius,-borderRadius],["z"]];return(0,_RenderUtil.componentsToPath)(roundRectPath)},exports.getDiamondPath=function(shape){var width=shape.width,height=shape.height,x=shape.x,y=shape.y,halfWidth=width/2,halfHeight=height/2,diamondPath=[["M",x+halfWidth,y],["l",halfWidth,halfHeight],["l",-halfWidth,halfHeight],["l",-halfWidth,-halfHeight],["z"]];return(0,_RenderUtil.componentsToPath)(diamondPath)},exports.getRectPath=function(shape){var x=shape.x,y=shape.y,width=shape.width,height=shape.height,rectPath=[["M",x,y],["l",width,0],["l",0,height],["l",-width,0],["z"]];return(0,_RenderUtil.componentsToPath)(rectPath)};var _minDash=require("min-dash"),_RenderUtil=require("diagram-js/lib/util/RenderUtil");function getDi(element){return element.businessObject.di}},{"diagram-js/lib/util/RenderUtil":363,"min-dash":594}],56:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BpmnRenderer;var _inherits2=_interopRequireDefault(require("inherits")),_minDash=require("min-dash"),_BaseRenderer2=_interopRequireDefault(require("diagram-js/lib/draw/BaseRenderer")),_DiUtil=require("../util/DiUtil"),_LabelUtil=require("../features/label-editing/LabelUtil"),_ModelUtil=require("../util/ModelUtil"),_RenderUtil=require("diagram-js/lib/util/RenderUtil"),_BpmnRenderUtil=require("./BpmnRenderUtil"),_minDom=require("min-dom"),_tinySvg=require("tiny-svg"),_SvgTransformUtil=require("diagram-js/lib/util/SvgTransformUtil");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var RENDERER_IDS=new(_interopRequireDefault(require("ids")).default),TASK_BORDER_RADIUS=10,INNER_OUTER_DIST=3,DEFAULT_FILL_OPACITY=.95,HIGH_FILL_OPACITY=.35;function BpmnRenderer(config,eventBus,styles,pathMap,canvas,textRenderer,priority){_BaseRenderer2.default.call(this,eventBus,priority);var defaultFillColor=config&&config.defaultFillColor,defaultStrokeColor=config&&config.defaultStrokeColor,rendererId=RENDERER_IDS.next(),markers={},computeStyle=styles.computeStyle;function addMarker(id,options){var attrs=(0,_minDash.assign)({fill:"black",strokeWidth:1,strokeLinecap:"round",strokeDasharray:"none"},options.attrs),ref=options.ref||{x:0,y:0},scale=options.scale||1;"none"===attrs.strokeDasharray&&(attrs.strokeDasharray=[1e4,1]);var marker=(0,_tinySvg.create)("marker");(0,_tinySvg.attr)(options.element,attrs),(0,_tinySvg.append)(marker,options.element),(0,_tinySvg.attr)(marker,{id:id,viewBox:"0 0 20 20",refX:ref.x,refY:ref.y,markerWidth:20*scale,markerHeight:20*scale,orient:"auto"});var defs=(0,_minDom.query)("defs",canvas._svg);defs||(defs=(0,_tinySvg.create)("defs"),(0,_tinySvg.append)(canvas._svg,defs)),(0,_tinySvg.append)(defs,marker),markers[id]=marker}function colorEscape(str){return str.replace(/[^0-9a-zA-z]+/g,"_")}function marker(type,fill,stroke){var id=type+"-"+colorEscape(fill)+"-"+colorEscape(stroke)+"-"+rendererId;return markers[id]||function(id,type,fill,stroke){{var sequenceflowEnd;"sequenceflow-end"===type&&(sequenceflowEnd=(0,_tinySvg.create)("path"),(0,_tinySvg.attr)(sequenceflowEnd,{d:"M 1 5 L 11 10 L 1 15 Z"}),addMarker(id,{element:sequenceflowEnd,ref:{x:11,y:10},scale:.5,attrs:{fill:stroke,stroke:stroke}}))}{var messageflowStart;"messageflow-start"===type&&(messageflowStart=(0,_tinySvg.create)("circle"),(0,_tinySvg.attr)(messageflowStart,{cx:6,cy:6,r:3.5}),addMarker(id,{element:messageflowStart,attrs:{fill:fill,stroke:stroke},ref:{x:6,y:6}}))}{var messageflowEnd;"messageflow-end"===type&&(messageflowEnd=(0,_tinySvg.create)("path"),(0,_tinySvg.attr)(messageflowEnd,{d:"m 1 5 l 0 -3 l 7 3 l -7 3 z"}),addMarker(id,{element:messageflowEnd,attrs:{fill:fill,stroke:stroke,strokeLinecap:"butt"},ref:{x:8.5,y:5}}))}{var associationStart;"association-start"===type&&(associationStart=(0,_tinySvg.create)("path"),(0,_tinySvg.attr)(associationStart,{d:"M 11 5 L 1 10 L 11 15"}),addMarker(id,{element:associationStart,attrs:{fill:"none",stroke:stroke,strokeWidth:1.5},ref:{x:1,y:10},scale:.5}))}{var associationEnd;"association-end"===type&&(associationEnd=(0,_tinySvg.create)("path"),(0,_tinySvg.attr)(associationEnd,{d:"M 1 5 L 11 10 L 1 15"}),addMarker(id,{element:associationEnd,attrs:{fill:"none",stroke:stroke,strokeWidth:1.5},ref:{x:12,y:10},scale:.5}))}{var conditionalflowMarker;"conditional-flow-marker"===type&&(conditionalflowMarker=(0,_tinySvg.create)("path"),(0,_tinySvg.attr)(conditionalflowMarker,{d:"M 0 10 L 8 6 L 16 10 L 8 14 Z"}),addMarker(id,{element:conditionalflowMarker,attrs:{fill:fill,stroke:stroke},ref:{x:-1,y:10},scale:.5}))}{var conditionaldefaultflowMarker;"conditional-default-flow-marker"===type&&(conditionaldefaultflowMarker=(0,_tinySvg.create)("path"),(0,_tinySvg.attr)(conditionaldefaultflowMarker,{d:"M 6 4 L 10 16"}),addMarker(id,{element:conditionaldefaultflowMarker,attrs:{stroke:stroke},ref:{x:0,y:10},scale:.5}))}}(id,type,fill,stroke),"url(#"+id+")"}function drawCircle(parentGfx,width,height,offset,attrs){(0,_minDash.isObject)(offset)&&(attrs=offset,offset=0),offset=offset||0,"none"===(attrs=computeStyle(attrs,{stroke:"black",strokeWidth:2,fill:"white"})).fill&&delete attrs.fillOpacity;var cx=width/2,cy=height/2,circle=(0,_tinySvg.create)("circle");return(0,_tinySvg.attr)(circle,{cx:cx,cy:cy,r:Math.round((width+height)/4-offset)}),(0,_tinySvg.attr)(circle,attrs),(0,_tinySvg.append)(parentGfx,circle),circle}function drawRect(parentGfx,width,height,r,offset,attrs){(0,_minDash.isObject)(offset)&&(attrs=offset,offset=0),offset=offset||0,attrs=computeStyle(attrs,{stroke:"black",strokeWidth:2,fill:"white"});var rect=(0,_tinySvg.create)("rect");return(0,_tinySvg.attr)(rect,{x:offset,y:offset,width:width-2*offset,height:height-2*offset,rx:r,ry:r}),(0,_tinySvg.attr)(rect,attrs),(0,_tinySvg.append)(parentGfx,rect),rect}function drawLine(parentGfx,waypoints,attrs){attrs=computeStyle(attrs,["no-fill"],{stroke:"black",strokeWidth:2,fill:"none"});var line=(0,_RenderUtil.createLine)(waypoints,attrs);return(0,_tinySvg.append)(parentGfx,line),line}function drawPath(parentGfx,d,attrs){attrs=computeStyle(attrs,["no-fill"],{strokeWidth:2,stroke:"black"});var path=(0,_tinySvg.create)("path");return(0,_tinySvg.attr)(path,{d:d}),(0,_tinySvg.attr)(path,attrs),(0,_tinySvg.append)(parentGfx,path),path}function drawMarker(type,parentGfx,path,attrs){return drawPath(parentGfx,path,(0,_minDash.assign)({"data-marker":type},attrs))}function as(type){return function(parentGfx,element){return handlers[type](parentGfx,element)}}function renderer(type){return handlers[type]}function renderEventContent(element,parentGfx){var event=(0,_BpmnRenderUtil.getSemantic)(element),isThrowing=(0,_BpmnRenderUtil.isThrowEvent)(event);return event.eventDefinitions&&1<event.eventDefinitions.length?(event.parallelMultiple?renderer("bpmn:ParallelMultipleEventDefinition"):renderer("bpmn:MultipleEventDefinition"))(parentGfx,element,isThrowing):(0,_BpmnRenderUtil.isTypedEvent)(event,"bpmn:MessageEventDefinition")?renderer("bpmn:MessageEventDefinition")(parentGfx,element,isThrowing):(0,_BpmnRenderUtil.isTypedEvent)(event,"bpmn:TimerEventDefinition")?renderer("bpmn:TimerEventDefinition")(parentGfx,element,isThrowing):(0,_BpmnRenderUtil.isTypedEvent)(event,"bpmn:ConditionalEventDefinition")?renderer("bpmn:ConditionalEventDefinition")(parentGfx,element):(0,_BpmnRenderUtil.isTypedEvent)(event,"bpmn:SignalEventDefinition")?renderer("bpmn:SignalEventDefinition")(parentGfx,element,isThrowing):(0,_BpmnRenderUtil.isTypedEvent)(event,"bpmn:EscalationEventDefinition")?renderer("bpmn:EscalationEventDefinition")(parentGfx,element,isThrowing):(0,_BpmnRenderUtil.isTypedEvent)(event,"bpmn:LinkEventDefinition")?renderer("bpmn:LinkEventDefinition")(parentGfx,element,isThrowing):(0,_BpmnRenderUtil.isTypedEvent)(event,"bpmn:ErrorEventDefinition")?renderer("bpmn:ErrorEventDefinition")(parentGfx,element,isThrowing):(0,_BpmnRenderUtil.isTypedEvent)(event,"bpmn:CancelEventDefinition")?renderer("bpmn:CancelEventDefinition")(parentGfx,element,isThrowing):(0,_BpmnRenderUtil.isTypedEvent)(event,"bpmn:CompensateEventDefinition")?renderer("bpmn:CompensateEventDefinition")(parentGfx,element,isThrowing):(0,_BpmnRenderUtil.isTypedEvent)(event,"bpmn:TerminateEventDefinition")&&renderer("bpmn:TerminateEventDefinition")(parentGfx,element,isThrowing)}function renderLabel(parentGfx,label,options){options=(0,_minDash.assign)({size:{width:100}},options);var text=textRenderer.createText(label||"",options);return(0,_tinySvg.classes)(text).add("djs-label"),(0,_tinySvg.append)(parentGfx,text),text}function renderEmbeddedLabel(parentGfx,element,align){return renderLabel(parentGfx,(0,_BpmnRenderUtil.getSemantic)(element).name,{box:element,align:align,padding:5,style:{fill:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)}})}function renderLaneLabel(parentGfx,text,element){var textBox=renderLabel(parentGfx,text,{box:{height:30,width:element.height},align:"center-middle",style:{fill:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)}}),top=-1*element.height;(0,_SvgTransformUtil.transform)(textBox,0,-top,270)}function createPathFromConnection(connection){for(var waypoints=connection.waypoints,pathData="m  "+waypoints[0].x+","+waypoints[0].y,i=1;i<waypoints.length;i++)pathData+="L"+waypoints[i].x+","+waypoints[i].y+" ";return pathData}var handlers=this.handlers={"bpmn:Event":function(parentGfx,element,attrs){return"fillOpacity"in attrs||(attrs.fillOpacity=DEFAULT_FILL_OPACITY),drawCircle(parentGfx,element.width,element.height,attrs)},"bpmn:StartEvent":function(parentGfx,element){var attrs={fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)};(0,_BpmnRenderUtil.getSemantic)(element).isInterrupting||(attrs={strokeDasharray:"6",strokeLinecap:"round",fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)});var circle=renderer("bpmn:Event")(parentGfx,element,attrs);return renderEventContent(element,parentGfx),circle},"bpmn:MessageEventDefinition":function(parentGfx,element,isThrowing){return drawPath(parentGfx,pathMap.getScaledPath("EVENT_MESSAGE",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:element.width,containerHeight:element.height,position:{mx:.235,my:.315}}),{strokeWidth:1,fill:isThrowing?(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor):(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke:isThrowing?(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor):(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)})},"bpmn:TimerEventDefinition":function(parentGfx,element){var circle=drawCircle(parentGfx,element.width,element.height,.2*element.height,{strokeWidth:2,fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)});drawPath(parentGfx,pathMap.getScaledPath("EVENT_TIMER_WH",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:element.width,containerHeight:element.height,position:{mx:.5,my:.5}}),{strokeWidth:2,strokeLinecap:"square",stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)});for(var i=0;i<12;i++){var linePathData=pathMap.getScaledPath("EVENT_TIMER_LINE",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:element.width,containerHeight:element.height,position:{mx:.5,my:.5}}),width=element.width/2;drawPath(parentGfx,linePathData,{strokeWidth:1,strokeLinecap:"square",transform:"rotate("+30*i+","+element.height/2+","+width+")",stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)})}return circle},"bpmn:EscalationEventDefinition":function(parentGfx,event,isThrowing){return drawPath(parentGfx,pathMap.getScaledPath("EVENT_ESCALATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:event.width,containerHeight:event.height,position:{mx:.5,my:.2}}),{strokeWidth:1,fill:isThrowing?(0,_BpmnRenderUtil.getStrokeColor)(event,defaultStrokeColor):"none",stroke:(0,_BpmnRenderUtil.getStrokeColor)(event,defaultStrokeColor)})},"bpmn:ConditionalEventDefinition":function(parentGfx,event){return drawPath(parentGfx,pathMap.getScaledPath("EVENT_CONDITIONAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:event.width,containerHeight:event.height,position:{mx:.5,my:.222}}),{strokeWidth:1,stroke:(0,_BpmnRenderUtil.getStrokeColor)(event,defaultStrokeColor)})},"bpmn:LinkEventDefinition":function(parentGfx,event,isThrowing){return drawPath(parentGfx,pathMap.getScaledPath("EVENT_LINK",{xScaleFactor:1,yScaleFactor:1,containerWidth:event.width,containerHeight:event.height,position:{mx:.57,my:.263}}),{strokeWidth:1,fill:isThrowing?(0,_BpmnRenderUtil.getStrokeColor)(event,defaultStrokeColor):"none",stroke:(0,_BpmnRenderUtil.getStrokeColor)(event,defaultStrokeColor)})},"bpmn:ErrorEventDefinition":function(parentGfx,event,isThrowing){return drawPath(parentGfx,pathMap.getScaledPath("EVENT_ERROR",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:event.width,containerHeight:event.height,position:{mx:.2,my:.722}}),{strokeWidth:1,fill:isThrowing?(0,_BpmnRenderUtil.getStrokeColor)(event,defaultStrokeColor):"none",stroke:(0,_BpmnRenderUtil.getStrokeColor)(event,defaultStrokeColor)})},"bpmn:CancelEventDefinition":function(parentGfx,event,isThrowing){var path=drawPath(parentGfx,pathMap.getScaledPath("EVENT_CANCEL_45",{xScaleFactor:1,yScaleFactor:1,containerWidth:event.width,containerHeight:event.height,position:{mx:.638,my:-.055}}),{strokeWidth:1,fill:isThrowing?(0,_BpmnRenderUtil.getStrokeColor)(event,defaultStrokeColor):"none",stroke:(0,_BpmnRenderUtil.getStrokeColor)(event,defaultStrokeColor)});return(0,_SvgTransformUtil.rotate)(path,45),path},"bpmn:CompensateEventDefinition":function(parentGfx,event,isThrowing){return drawPath(parentGfx,pathMap.getScaledPath("EVENT_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:event.width,containerHeight:event.height,position:{mx:.22,my:.5}}),{strokeWidth:1,fill:isThrowing?(0,_BpmnRenderUtil.getStrokeColor)(event,defaultStrokeColor):"none",stroke:(0,_BpmnRenderUtil.getStrokeColor)(event,defaultStrokeColor)})},"bpmn:SignalEventDefinition":function(parentGfx,event,isThrowing){return drawPath(parentGfx,pathMap.getScaledPath("EVENT_SIGNAL",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:event.width,containerHeight:event.height,position:{mx:.5,my:.2}}),{strokeWidth:1,fill:isThrowing?(0,_BpmnRenderUtil.getStrokeColor)(event,defaultStrokeColor):"none",stroke:(0,_BpmnRenderUtil.getStrokeColor)(event,defaultStrokeColor)})},"bpmn:MultipleEventDefinition":function(parentGfx,event,isThrowing){return drawPath(parentGfx,pathMap.getScaledPath("EVENT_MULTIPLE",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:event.width,containerHeight:event.height,position:{mx:.222,my:.36}}),{strokeWidth:1,fill:isThrowing?(0,_BpmnRenderUtil.getStrokeColor)(event,defaultStrokeColor):"none"})},"bpmn:ParallelMultipleEventDefinition":function(parentGfx,event){return drawPath(parentGfx,pathMap.getScaledPath("EVENT_PARALLEL_MULTIPLE",{xScaleFactor:1.2,yScaleFactor:1.2,containerWidth:event.width,containerHeight:event.height,position:{mx:.458,my:.194}}),{strokeWidth:1,fill:(0,_BpmnRenderUtil.getStrokeColor)(event,defaultStrokeColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(event,defaultStrokeColor)})},"bpmn:EndEvent":function(parentGfx,element){var circle=renderer("bpmn:Event")(parentGfx,element,{strokeWidth:4,fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)});return renderEventContent(element,parentGfx),circle},"bpmn:TerminateEventDefinition":function(parentGfx,element){return drawCircle(parentGfx,element.width,element.height,8,{strokeWidth:4,fill:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)})},"bpmn:IntermediateEvent":function(parentGfx,element){var outer=renderer("bpmn:Event")(parentGfx,element,{strokeWidth:1,fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)});return drawCircle(parentGfx,element.width,element.height,INNER_OUTER_DIST,{strokeWidth:1,fill:(0,_BpmnRenderUtil.getFillColor)(element,"none"),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)}),renderEventContent(element,parentGfx),outer},"bpmn:IntermediateCatchEvent":as("bpmn:IntermediateEvent"),"bpmn:IntermediateThrowEvent":as("bpmn:IntermediateEvent"),"bpmn:Activity":function(parentGfx,element,attrs){return"fillOpacity"in(attrs=attrs||{})||(attrs.fillOpacity=DEFAULT_FILL_OPACITY),drawRect(parentGfx,element.width,element.height,TASK_BORDER_RADIUS,attrs)},"bpmn:Task":function(parentGfx,element){var attrs={fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)},rect=renderer("bpmn:Activity")(parentGfx,element,attrs);return renderEmbeddedLabel(parentGfx,element,"center-middle"),attachTaskMarkers(parentGfx,element),rect},"bpmn:ServiceTask":function(parentGfx,element){var task=renderer("bpmn:Task")(parentGfx,element);return drawPath(parentGfx,pathMap.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:12,y:18}}),{strokeWidth:1,fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)}),drawPath(parentGfx,pathMap.getScaledPath("TASK_TYPE_SERVICE_FILL",{abspos:{x:17.2,y:18}}),{strokeWidth:0,fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor)}),drawPath(parentGfx,pathMap.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:17,y:22}}),{strokeWidth:1,fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)}),task},"bpmn:UserTask":function(parentGfx,element){var task=renderer("bpmn:Task")(parentGfx,element);return drawPath(parentGfx,pathMap.getScaledPath("TASK_TYPE_USER_1",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)}),drawPath(parentGfx,pathMap.getScaledPath("TASK_TYPE_USER_2",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)}),drawPath(parentGfx,pathMap.getScaledPath("TASK_TYPE_USER_3",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)}),task},"bpmn:ManualTask":function(parentGfx,element){var task=renderer("bpmn:Task")(parentGfx,element);return drawPath(parentGfx,pathMap.getScaledPath("TASK_TYPE_MANUAL",{abspos:{x:17,y:15}}),{strokeWidth:.5,fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)}),task},"bpmn:SendTask":function(parentGfx,element){var task=renderer("bpmn:Task")(parentGfx,element);return drawPath(parentGfx,pathMap.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:1,yScaleFactor:1,containerWidth:21,containerHeight:14,position:{mx:.285,my:.357}}),{strokeWidth:1,fill:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor),stroke:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor)}),task},"bpmn:ReceiveTask":function(parentGfx,element){var semantic=(0,_BpmnRenderUtil.getSemantic)(element),task=renderer("bpmn:Task")(parentGfx,element),pathData=semantic.instantiate?(drawCircle(parentGfx,28,28,4.4,{strokeWidth:1}),pathMap.getScaledPath("TASK_TYPE_INSTANTIATING_SEND",{abspos:{x:7.77,y:9.52}})):pathMap.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:21,containerHeight:14,position:{mx:.3,my:.4}});return drawPath(parentGfx,pathData,{strokeWidth:1,fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)}),task},"bpmn:ScriptTask":function(parentGfx,element){var task=renderer("bpmn:Task")(parentGfx,element);return drawPath(parentGfx,pathMap.getScaledPath("TASK_TYPE_SCRIPT",{abspos:{x:15,y:20}}),{strokeWidth:1,stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)}),task},"bpmn:BusinessRuleTask":function(parentGfx,element){var task=renderer("bpmn:Task")(parentGfx,element),businessHeaderPath=drawPath(parentGfx,pathMap.getScaledPath("TASK_TYPE_BUSINESS_RULE_HEADER",{abspos:{x:8,y:8}}));(0,_tinySvg.attr)(businessHeaderPath,{strokeWidth:1,fill:(0,_BpmnRenderUtil.getFillColor)(element,"#aaaaaa"),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)});var businessPath=drawPath(parentGfx,pathMap.getScaledPath("TASK_TYPE_BUSINESS_RULE_MAIN",{abspos:{x:8,y:8}}));return(0,_tinySvg.attr)(businessPath,{strokeWidth:1,stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)}),task},"bpmn:SubProcess":function(parentGfx,element,attrs){attrs=(0,_minDash.assign)({fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)},attrs);var rect=renderer("bpmn:Activity")(parentGfx,element,attrs),expanded=(0,_DiUtil.isExpanded)(element);return(0,_DiUtil.isEventSubProcess)(element)&&(0,_tinySvg.attr)(rect,{strokeDasharray:"1,2"}),renderEmbeddedLabel(parentGfx,element,expanded?"center-top":"center-middle"),expanded?attachTaskMarkers(parentGfx,element):attachTaskMarkers(parentGfx,element,["SubProcessMarker"]),rect},"bpmn:AdHocSubProcess":function(parentGfx,element){return renderer("bpmn:SubProcess")(parentGfx,element)},"bpmn:Transaction":function(parentGfx,element){var outer=renderer("bpmn:SubProcess")(parentGfx,element),innerAttrs=styles.style(["no-fill","no-events"],{stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)});return drawRect(parentGfx,element.width,element.height,TASK_BORDER_RADIUS-2,INNER_OUTER_DIST,innerAttrs),outer},"bpmn:CallActivity":function(parentGfx,element){return renderer("bpmn:SubProcess")(parentGfx,element,{strokeWidth:5})},"bpmn:Participant":function(parentGfx,element){var attrs={fillOpacity:DEFAULT_FILL_OPACITY,fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)},lane=renderer("bpmn:Lane")(parentGfx,element,attrs);return(0,_DiUtil.isExpanded)(element)?(drawLine(parentGfx,[{x:30,y:0},{x:30,y:element.height}],{stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)}),renderLaneLabel(parentGfx,(0,_BpmnRenderUtil.getSemantic)(element).name,element)):renderLabel(parentGfx,(0,_BpmnRenderUtil.getSemantic)(element).name,{box:element,align:"center-middle",style:{fill:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)}}),!(0,_BpmnRenderUtil.getSemantic)(element).participantMultiplicity||(0,handlers.ParticipantMultiplicityMarker)(parentGfx,element),lane},"bpmn:Lane":function(parentGfx,element,attrs){var rect=drawRect(parentGfx,element.width,element.height,0,(0,_minDash.assign)({fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),fillOpacity:HIGH_FILL_OPACITY,stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)},attrs)),semantic=(0,_BpmnRenderUtil.getSemantic)(element);return"bpmn:Lane"===semantic.$type&&renderLaneLabel(parentGfx,semantic.name,element),rect},"bpmn:InclusiveGateway":function(parentGfx,element){var diamond=renderer("bpmn:Gateway")(parentGfx,element);return drawCircle(parentGfx,element.width,element.height,.24*element.height,{strokeWidth:2.5,fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)}),diamond},"bpmn:ExclusiveGateway":function(parentGfx,element){var diamond=renderer("bpmn:Gateway")(parentGfx,element),pathData=pathMap.getScaledPath("GATEWAY_EXCLUSIVE",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:element.width,containerHeight:element.height,position:{mx:.32,my:.3}});return(0,_BpmnRenderUtil.getDi)(element).isMarkerVisible&&drawPath(parentGfx,pathData,{strokeWidth:1,fill:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)}),diamond},"bpmn:ComplexGateway":function(parentGfx,element){var diamond=renderer("bpmn:Gateway")(parentGfx,element);return drawPath(parentGfx,pathMap.getScaledPath("GATEWAY_COMPLEX",{xScaleFactor:.5,yScaleFactor:.5,containerWidth:element.width,containerHeight:element.height,position:{mx:.46,my:.26}}),{strokeWidth:1,fill:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)}),diamond},"bpmn:ParallelGateway":function(parentGfx,element){var diamond=renderer("bpmn:Gateway")(parentGfx,element);return drawPath(parentGfx,pathMap.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.6,yScaleFactor:.6,containerWidth:element.width,containerHeight:element.height,position:{mx:.46,my:.2}}),{strokeWidth:1,fill:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)}),diamond},"bpmn:EventBasedGateway":function(parentGfx,element){var semantic=(0,_BpmnRenderUtil.getSemantic)(element),diamond=renderer("bpmn:Gateway")(parentGfx,element);drawCircle(parentGfx,element.width,element.height,.2*element.height,{strokeWidth:1,fill:"none",stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)});var pathData,parallelPath,innerCircle,type=semantic.eventGatewayType,instantiate=!!semantic.instantiate;return"Parallel"===type?(pathData=pathMap.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:element.width,containerHeight:element.height,position:{mx:.474,my:.296}}),parallelPath=drawPath(parentGfx,pathData),(0,_tinySvg.attr)(parallelPath,{strokeWidth:1,fill:"none"})):"Exclusive"===type&&(instantiate||(innerCircle=drawCircle(parentGfx,element.width,element.height,.26*element.height),(0,_tinySvg.attr)(innerCircle,{strokeWidth:1,fill:"none",stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)})),function(){var pathData=pathMap.getScaledPath("GATEWAY_EVENT_BASED",{xScaleFactor:.18,yScaleFactor:.18,containerWidth:element.width,containerHeight:element.height,position:{mx:.36,my:.44}}),attrs={strokeWidth:2,fill:(0,_BpmnRenderUtil.getFillColor)(element,"none"),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)};drawPath(parentGfx,pathData,attrs)}()),diamond},"bpmn:Gateway":function(parentGfx,element){var attrs={fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),fillOpacity:DEFAULT_FILL_OPACITY,stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)};return function(parentGfx,width,height,attrs){var x_2=width/2,y_2=height/2,pointsString=[{x:x_2,y:0},{x:width,y:y_2},{x:x_2,y:height},{x:0,y:y_2}].map(function(point){return point.x+","+point.y}).join(" ");attrs=computeStyle(attrs,{stroke:"black",strokeWidth:2,fill:"white"});var polygon=(0,_tinySvg.create)("polygon");return(0,_tinySvg.attr)(polygon,{points:pointsString}),(0,_tinySvg.attr)(polygon,attrs),(0,_tinySvg.append)(parentGfx,polygon),polygon}(parentGfx,element.width,element.height,attrs)},"bpmn:SequenceFlow":function(parentGfx,element){var source,pathData=createPathFromConnection(element),fill=(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke=(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor),path=drawPath(parentGfx,pathData,{strokeLinejoin:"round",markerEnd:marker("sequenceflow-end",fill,stroke),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)}),sequenceFlow=(0,_BpmnRenderUtil.getSemantic)(element);return element.source&&(source=element.source.businessObject,sequenceFlow.conditionExpression&&source.$instanceOf("bpmn:Activity")&&(0,_tinySvg.attr)(path,{markerStart:marker("conditional-flow-marker",fill,stroke)}),source.default&&(source.$instanceOf("bpmn:Gateway")||source.$instanceOf("bpmn:Activity"))&&source.default===sequenceFlow&&(0,_tinySvg.attr)(path,{markerStart:marker("conditional-default-flow-marker",fill,stroke)})),path},"bpmn:Association":function(parentGfx,element,attrs){var semantic=(0,_BpmnRenderUtil.getSemantic)(element),fill=(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke=(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor);return attrs=(0,_minDash.assign)({strokeDasharray:"0.5, 5",strokeLinecap:"round",strokeLinejoin:"round",stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)},attrs||{}),"One"!==semantic.associationDirection&&"Both"!==semantic.associationDirection||(attrs.markerEnd=marker("association-end",fill,stroke)),"Both"===semantic.associationDirection&&(attrs.markerStart=marker("association-start",fill,stroke)),drawLine(parentGfx,element.waypoints,attrs)},"bpmn:DataInputAssociation":function(parentGfx,element){var fill=(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke=(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor);return renderer("bpmn:Association")(parentGfx,element,{markerEnd:marker("association-end",fill,stroke)})},"bpmn:DataOutputAssociation":function(parentGfx,element){var fill=(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke=(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor);return renderer("bpmn:Association")(parentGfx,element,{markerEnd:marker("association-end",fill,stroke)})},"bpmn:MessageFlow":function(parentGfx,element){var midPoint,markerPathData,messageAttrs,semantic=(0,_BpmnRenderUtil.getSemantic)(element),di=(0,_BpmnRenderUtil.getDi)(element),fill=(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke=(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor),path=drawPath(parentGfx,createPathFromConnection(element),{markerEnd:marker("messageflow-end",fill,stroke),markerStart:marker("messageflow-start",fill,stroke),strokeDasharray:"10, 12",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5px",stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)});return semantic.messageRef&&(midPoint=path.getPointAtLength(path.getTotalLength()/2),markerPathData=pathMap.getScaledPath("MESSAGE_FLOW_MARKER",{abspos:{x:midPoint.x,y:midPoint.y}}),messageAttrs={strokeWidth:1},"initiating"===di.messageVisibleKind?(messageAttrs.fill="white",messageAttrs.stroke="black"):(messageAttrs.fill="#888",messageAttrs.stroke="white"),drawPath(parentGfx,markerPathData,messageAttrs)),path},"bpmn:DataObject":function(parentGfx,element){var elementObject=drawPath(parentGfx,pathMap.getScaledPath("DATA_OBJECT_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:.474,my:.296}}),{fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),fillOpacity:DEFAULT_FILL_OPACITY,stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)}),semantic=(0,_BpmnRenderUtil.getSemantic)(element);return(0,_BpmnRenderUtil.isCollection)(semantic)&&function(parentGfx,element){var yPosition=(element.height-16)/element.height,pathData=pathMap.getScaledPath("DATA_OBJECT_COLLECTION_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:.451,my:yPosition}});drawPath(parentGfx,pathData,{strokeWidth:2})}(parentGfx,element),elementObject},"bpmn:DataObjectReference":as("bpmn:DataObject"),"bpmn:DataInput":function(parentGfx,element){var arrowPathData=pathMap.getRawPath("DATA_ARROW"),elementObject=renderer("bpmn:DataObject")(parentGfx,element);return drawPath(parentGfx,arrowPathData,{strokeWidth:1}),elementObject},"bpmn:DataOutput":function(parentGfx,element){var arrowPathData=pathMap.getRawPath("DATA_ARROW"),elementObject=renderer("bpmn:DataObject")(parentGfx,element);return drawPath(parentGfx,arrowPathData,{strokeWidth:1,fill:"black"}),elementObject},"bpmn:DataStoreReference":function(parentGfx,element){return drawPath(parentGfx,pathMap.getScaledPath("DATA_STORE",{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:0,my:.133}}),{strokeWidth:2,fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),fillOpacity:DEFAULT_FILL_OPACITY,stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)})},"bpmn:BoundaryEvent":function(parentGfx,element){var cancel=(0,_BpmnRenderUtil.getSemantic)(element).cancelActivity,attrs={strokeWidth:1,fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)};cancel||(attrs.strokeDasharray="6",attrs.strokeLinecap="round");var outerAttrs=(0,_minDash.assign)({},attrs,{fillOpacity:1}),innerAttrs=(0,_minDash.assign)({},attrs,{fill:"none"}),outer=renderer("bpmn:Event")(parentGfx,element,outerAttrs);return drawCircle(parentGfx,element.width,element.height,INNER_OUTER_DIST,innerAttrs),renderEventContent(element,parentGfx),outer},"bpmn:Group":function(parentGfx,element){return drawRect(parentGfx,element.width,element.height,TASK_BORDER_RADIUS,{stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor),strokeWidth:1,strokeDasharray:"8,3,1,3",fill:"none",pointerEvents:"none"})},label:function(parentGfx,element){var box={width:90,height:30,x:element.width/2+element.x,y:element.height/2+element.y};return renderLabel(parentGfx,(0,_LabelUtil.getLabel)(element),{box:box,fitBox:!0,style:(0,_minDash.assign)({},textRenderer.getExternalStyle(),{fill:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)})})},"bpmn:TextAnnotation":function(parentGfx,element){var textElement=drawRect(parentGfx,element.width,element.height,0,0,{fill:"none",stroke:"none"});return drawPath(parentGfx,pathMap.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:0,my:0}}),{stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)}),renderLabel(parentGfx,(0,_BpmnRenderUtil.getSemantic)(element).text||"",{box:element,align:"left-top",padding:5,style:{fill:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)}}),textElement},ParticipantMultiplicityMarker:function(parentGfx,element){drawMarker("participant-multiplicity",parentGfx,pathMap.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:element.width/2/element.width,my:(element.height-15)/element.height}}),{strokeWidth:1,fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)})},SubProcessMarker:function(parentGfx,element){var markerRect=drawRect(parentGfx,14,14,0,{strokeWidth:1,fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)});(0,_SvgTransformUtil.translate)(markerRect,element.width/2-7.5,element.height-20),drawMarker("sub-process",parentGfx,pathMap.getScaledPath("MARKER_SUB_PROCESS",{xScaleFactor:1.5,yScaleFactor:1.5,containerWidth:element.width,containerHeight:element.height,position:{mx:(element.width/2-7.5)/element.width,my:(element.height-20)/element.height}}),{fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)})},ParallelMarker:function(parentGfx,element,position){drawMarker("parallel",parentGfx,pathMap.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:(element.width/2+position.parallel)/element.width,my:(element.height-20)/element.height}}),{fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)})},SequentialMarker:function(parentGfx,element,position){drawMarker("sequential",parentGfx,pathMap.getScaledPath("MARKER_SEQUENTIAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:(element.width/2+position.seq)/element.width,my:(element.height-19)/element.height}}),{fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)})},CompensationMarker:function(parentGfx,element,position){drawMarker("compensation",parentGfx,pathMap.getScaledPath("MARKER_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:(element.width/2+position.compensation)/element.width,my:(element.height-13)/element.height}}),{strokeWidth:1,fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)})},LoopMarker:function(parentGfx,element,position){drawMarker("loop",parentGfx,pathMap.getScaledPath("MARKER_LOOP",{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:(element.width/2+position.loop)/element.width,my:(element.height-7)/element.height}}),{strokeWidth:1,fill:(0,_BpmnRenderUtil.getFillColor)(element,defaultFillColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor),strokeLinecap:"round",strokeMiterlimit:.5})},AdhocMarker:function(parentGfx,element,position){drawMarker("adhoc",parentGfx,pathMap.getScaledPath("MARKER_ADHOC",{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:(element.width/2+position.adhoc)/element.width,my:(element.height-15)/element.height}}),{strokeWidth:1,fill:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor),stroke:(0,_BpmnRenderUtil.getStrokeColor)(element,defaultStrokeColor)})}};function attachTaskMarkers(parentGfx,element,taskMarkers){var obj=(0,_BpmnRenderUtil.getSemantic)(element),position=taskMarkers&&-1!==taskMarkers.indexOf("SubProcessMarker")?{seq:-21,parallel:-22,compensation:-42,loop:-18,adhoc:10}:{seq:-3,parallel:-6,compensation:-27,loop:0,adhoc:10};(0,_minDash.forEach)(taskMarkers,function(marker){renderer(marker)(parentGfx,element,position)}),obj.isForCompensation&&(0,handlers.CompensationMarker)(parentGfx,element,position),"bpmn:AdHocSubProcess"===obj.$type&&(0,handlers.AdhocMarker)(parentGfx,element,position);var loopCharacteristics=obj.loopCharacteristics,isSequential=loopCharacteristics&&loopCharacteristics.isSequential;loopCharacteristics&&(void 0===isSequential&&(0,handlers.LoopMarker)(parentGfx,element,position),!1===isSequential&&(0,handlers.ParallelMarker)(parentGfx,element,position),!0===isSequential&&(0,handlers.SequentialMarker)(parentGfx,element,position))}this._drawPath=drawPath}(0,_inherits2.default)(BpmnRenderer,_BaseRenderer2.default),BpmnRenderer.$inject=["config.bpmnRenderer","eventBus","styles","pathMap","canvas","textRenderer"],BpmnRenderer.prototype.canRender=function(element){return(0,_ModelUtil.is)(element,"bpmn:BaseElement")},BpmnRenderer.prototype.drawShape=function(parentGfx,element){var type=element.type;return(0,this.handlers[type])(parentGfx,element)},BpmnRenderer.prototype.drawConnection=function(parentGfx,element){var type=element.type;return(0,this.handlers[type])(parentGfx,element)},BpmnRenderer.prototype.getShapePath=function(element){return(0,_ModelUtil.is)(element,"bpmn:Event")?(0,_BpmnRenderUtil.getCirclePath)(element):(0,_ModelUtil.is)(element,"bpmn:Activity")?(0,_BpmnRenderUtil.getRoundRectPath)(element,TASK_BORDER_RADIUS):((0,_ModelUtil.is)(element,"bpmn:Gateway")?(0,_BpmnRenderUtil.getDiamondPath):(0,_BpmnRenderUtil.getRectPath))(element)}},{"../features/label-editing/LabelUtil":89,"../util/DiUtil":175,"../util/ModelUtil":177,"./BpmnRenderUtil":55,"diagram-js/lib/draw/BaseRenderer":190,"diagram-js/lib/util/RenderUtil":363,"diagram-js/lib/util/SvgTransformUtil":364,ids:384,inherits:385,"min-dash":594,"min-dom":595,"tiny-svg":606}],57:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(){this.pathMap={EVENT_MESSAGE:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:36,width:36,heightElements:[6,14],widthElements:[10.5,21]},EVENT_SIGNAL:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x1},0 Z",height:36,width:36,heightElements:[18],widthElements:[10,20]},EVENT_ESCALATION:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x0},-{e.y1} l -{e.x0},{e.y1} Z",height:36,width:36,heightElements:[20,7],widthElements:[8]},EVENT_CONDITIONAL:{d:"M {e.x0},{e.y0} l {e.x1},0 l 0,{e.y2} l -{e.x1},0 Z M {e.x2},{e.y3} l {e.x0},0 M {e.x2},{e.y4} l {e.x0},0 M {e.x2},{e.y5} l {e.x0},0 M {e.x2},{e.y6} l {e.x0},0 M {e.x2},{e.y7} l {e.x0},0 M {e.x2},{e.y8} l {e.x0},0 ",height:36,width:36,heightElements:[8.5,14.5,18,11.5,14.5,17.5,20.5,23.5,26.5],widthElements:[10.5,14.5,12.5]},EVENT_LINK:{d:"m {mx},{my} 0,{e.y0} -{e.x1},0 0,{e.y1} {e.x1},0 0,{e.y0} {e.x0},-{e.y2} -{e.x0},-{e.y2} z",height:36,width:36,heightElements:[4.4375,6.75,7.8125],widthElements:[9.84375,13.5]},EVENT_ERROR:{d:"m {mx},{my} {e.x0},-{e.y0} {e.x1},-{e.y1} {e.x2},{e.y2} {e.x3},-{e.y3} -{e.x4},{e.y4} -{e.x5},-{e.y5} z",height:36,width:36,heightElements:[.023,8.737,8.151,16.564,10.591,8.714],widthElements:[.085,6.672,6.97,4.273,5.337,6.636]},EVENT_CANCEL_45:{d:"m {mx},{my} -{e.x1},0 0,{e.x0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:36,width:36,heightElements:[4.75,8.5],widthElements:[4.75,8.5]},EVENT_COMPENSATION:{d:"m {mx},{my} {e.x0},-{e.y0} 0,{e.y1} z m {e.x1},-{e.y2} {e.x2},-{e.y3} 0,{e.y1} -{e.x2},-{e.y3} z",height:36,width:36,heightElements:[6.5,13,.4,6.1],widthElements:[9,9.3,8.7]},EVENT_TIMER_WH:{d:"M {mx},{my} l {e.x0},-{e.y0} m -{e.x0},{e.y0} l {e.x1},{e.y1} ",height:36,width:36,heightElements:[10,2],widthElements:[3,7]},EVENT_TIMER_LINE:{d:"M {mx},{my} m {e.x0},{e.y0} l -{e.x1},{e.y1} ",height:36,width:36,heightElements:[10,3],widthElements:[0,0]},EVENT_MULTIPLE:{d:"m {mx},{my} {e.x1},-{e.y0} {e.x1},{e.y0} -{e.x0},{e.y1} -{e.x2},0 z",height:36,width:36,heightElements:[6.28099,12.56199],widthElements:[3.1405,9.42149,12.56198]},EVENT_PARALLEL_MULTIPLE:{d:"m {mx},{my} {e.x0},0 0,{e.y1} {e.x1},0 0,{e.y0} -{e.x1},0 0,{e.y1} -{e.x0},0 0,-{e.y1} -{e.x1},0 0,-{e.y0} {e.x1},0 z",height:36,width:36,heightElements:[2.56228,7.68683],widthElements:[2.56228,7.68683]},GATEWAY_EXCLUSIVE:{d:"m {mx},{my} {e.x0},{e.y0} {e.x1},{e.y0} {e.x2},0 {e.x4},{e.y2} {e.x4},{e.y1} {e.x2},0 {e.x1},{e.y3} {e.x0},{e.y3} {e.x3},0 {e.x5},{e.y1} {e.x5},{e.y2} {e.x3},0 z",height:17.5,width:17.5,heightElements:[8.5,6.5312,-6.5312,-8.5],widthElements:[6.5,-6.5,3,-3,5,-5]},GATEWAY_PARALLEL:{d:"m {mx},{my} 0,{e.y1} -{e.x1},0 0,{e.y0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:30,width:30,heightElements:[5,12.5],widthElements:[5,12.5]},GATEWAY_EVENT_BASED:{d:"m {mx},{my} {e.x0},{e.y0} {e.x0},{e.y1} {e.x1},{e.y2} {e.x2},0 z",height:11,width:11,heightElements:[-6,6,12,-12],widthElements:[9,-3,-12]},GATEWAY_COMPLEX:{d:"m {mx},{my} 0,{e.y0} -{e.x0},-{e.y1} -{e.x1},{e.y2} {e.x0},{e.y1} -{e.x2},0 0,{e.y3} {e.x2},0  -{e.x0},{e.y1} l {e.x1},{e.y2} {e.x0},-{e.y1} 0,{e.y0} {e.x3},0 0,-{e.y0} {e.x0},{e.y1} {e.x1},-{e.y2} -{e.x0},-{e.y1} {e.x2},0 0,-{e.y3} -{e.x2},0 {e.x0},-{e.y1} -{e.x1},-{e.y2} -{e.x0},{e.y1} 0,-{e.y0} -{e.x3},0 z",height:17.125,width:17.125,heightElements:[4.875,3.4375,2.125,3],widthElements:[3.4375,2.125,4.875,3]},DATA_OBJECT_PATH:{d:"m 0,0 {e.x1},0 {e.x0},{e.y0} 0,{e.y1} -{e.x2},0 0,-{e.y2} {e.x1},0 0,{e.y0} {e.x0},0",height:61,width:51,heightElements:[10,50,60],widthElements:[10,40,50,60]},DATA_OBJECT_COLLECTION_PATH:{d:"m {mx}, {my} m  0 15  l 0 -15 m  4 15  l 0 -15 m  4 15  l 0 -15 ",height:61,width:51,heightElements:[12],widthElements:[1,6,12,15]},DATA_ARROW:{d:"m 5,9 9,0 0,-3 5,5 -5,5 0,-3 -9,0 z",height:61,width:51,heightElements:[],widthElements:[]},DATA_STORE:{d:"m  {mx},{my} l  0,{e.y2} c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 l  0,-{e.y2} c -{e.x0},-{e.y1} -{e.x1},-{e.y1} -{e.x2},0c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1} {e.x2},0m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0",height:61,width:61,heightElements:[7,10,45],widthElements:[2,58,60]},TEXT_ANNOTATION:{d:"m {mx}, {my} m 10,0 l -10,0 l 0,{e.y0} l 10,0",height:30,width:10,heightElements:[30],widthElements:[10]},MARKER_SUB_PROCESS:{d:"m{mx},{my} m 7,2 l 0,10 m -5,-5 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_PARALLEL:{d:"m{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10",height:10,width:10,heightElements:[],widthElements:[]},MARKER_SEQUENTIAL:{d:"m{mx},{my} m 0,3 l 10,0 m -10,3 l 10,0 m -10,3 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_COMPENSATION:{d:"m {mx},{my} 7,-5 0,10 z m 7.1,-0.3 6.9,-4.7 0,10 -6.9,-4.7 z",height:10,width:21,heightElements:[],widthElements:[]},MARKER_LOOP:{d:"m {mx},{my} c 3.526979,0 6.386161,-2.829858 6.386161,-6.320661 0,-3.490806 -2.859182,-6.320661 -6.386161,-6.320661 -3.526978,0 -6.38616,2.829855 -6.38616,6.320661 0,1.745402 0.714797,3.325567 1.870463,4.469381 0.577834,0.571908 1.265885,1.034728 2.029916,1.35457 l -0.718163,-3.909793 m 0.718163,3.909793 -3.885211,0.802902",height:13.9,width:13.7,heightElements:[],widthElements:[]},MARKER_ADHOC:{d:"m {mx},{my} m 0.84461,2.64411 c 1.05533,-1.23780996 2.64337,-2.07882 4.29653,-1.97997996 2.05163,0.0805 3.85579,1.15803 5.76082,1.79107 1.06385,0.34139996 2.24454,0.1438 3.18759,-0.43767 0.61743,-0.33642 1.2775,-0.64078 1.7542,-1.17511 0,0.56023 0,1.12046 0,1.6807 -0.98706,0.96237996 -2.29792,1.62393996 -3.6918,1.66181996 -1.24459,0.0927 -2.46671,-0.2491 -3.59505,-0.74812 -1.35789,-0.55965 -2.75133,-1.33436996 -4.27027,-1.18121996 -1.37741,0.14601 -2.41842,1.13685996 -3.44288,1.96782996 z",height:4,width:15,heightElements:[],widthElements:[]},TASK_TYPE_SEND:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:14,width:21,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_SCRIPT:{d:"m {mx},{my} c 9.966553,-6.27276 -8.000926,-7.91932 2.968968,-14.938 l -8.802728,0 c -10.969894,7.01868 6.997585,8.66524 -2.968967,14.938 z m -7,-12 l 5,0 m -4.5,3 l 4.5,0 m -3,3 l 5,0m -4,3 l 5,0",height:15,width:12.6,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_USER_1:{d:"m {mx},{my} c 0.909,-0.845 1.594,-2.049 1.594,-3.385 0,-2.554 -1.805,-4.62199999 -4.357,-4.62199999 -2.55199998,0 -4.28799998,2.06799999 -4.28799998,4.62199999 0,1.348 0.974,2.562 1.89599998,3.405 -0.52899998,0.187 -5.669,2.097 -5.794,4.7560005 v 6.718 h 17 v -6.718 c 0,-2.2980005 -5.5279996,-4.5950005 -6.0509996,-4.7760005 zm -8,6 l 0,5.5 m 11,0 l 0,-5"},TASK_TYPE_USER_2:{d:"m {mx},{my} m 2.162,1.009 c 0,2.4470005 -2.158,4.4310005 -4.821,4.4310005 -2.66499998,0 -4.822,-1.981 -4.822,-4.4310005 "},TASK_TYPE_USER_3:{d:"m {mx},{my} m -6.9,-3.80 c 0,0 2.25099998,-2.358 4.27399998,-1.177 2.024,1.181 4.221,1.537 4.124,0.965 -0.098,-0.57 -0.117,-3.79099999 -4.191,-4.13599999 -3.57499998,0.001 -4.20799998,3.36699999 -4.20699998,4.34799999 z"},TASK_TYPE_MANUAL:{d:"m {mx},{my} c 0.234,-0.01 5.604,0.008 8.029,0.004 0.808,0 1.271,-0.172 1.417,-0.752 0.227,-0.898 -0.334,-1.314 -1.338,-1.316 -2.467,-0.01 -7.886,-0.004 -8.108,-0.004 -0.014,-0.079 0.016,-0.533 0,-0.61 0.195,-0.042 8.507,0.006 9.616,0.002 0.877,-0.007 1.35,-0.438 1.353,-1.208 0.003,-0.768 -0.479,-1.09 -1.35,-1.091 -2.968,-0.002 -9.619,-0.013 -9.619,-0.013 v -0.591 c 0,0 5.052,-0.016 7.225,-0.016 0.888,-0.002 1.354,-0.416 1.351,-1.193 -0.006,-0.761 -0.492,-1.196 -1.361,-1.196 -3.473,-0.005 -10.86,-0.003 -11.0829995,-0.003 -0.022,-0.047 -0.045,-0.094 -0.069,-0.139 0.3939995,-0.319 2.0409995,-1.626 2.4149995,-2.017 0.469,-0.4870005 0.519,-1.1650005 0.162,-1.6040005 -0.414,-0.511 -0.973,-0.5 -1.48,-0.236 -1.4609995,0.764 -6.5999995,3.6430005 -7.7329995,4.2710005 -0.9,0.499 -1.516,1.253 -1.882,2.19 -0.37000002,0.95 -0.17,2.01 -0.166,2.979 0.004,0.718 -0.27300002,1.345 -0.055,2.063 0.629,2.087 2.425,3.312 4.859,3.318 4.6179995,0.014 9.2379995,-0.139 13.8569995,-0.158 0.755,-0.004 1.171,-0.301 1.182,-1.033 0.012,-0.754 -0.423,-0.969 -1.183,-0.973 -1.778,-0.01 -5.824,-0.004 -6.04,-0.004 10e-4,-0.084 0.003,-0.586 10e-4,-0.67 z"},TASK_TYPE_INSTANTIATING_SEND:{d:"m {mx},{my} l 0,8.4 l 12.6,0 l 0,-8.4 z l 6.3,3.6 l 6.3,-3.6"},TASK_TYPE_SERVICE:{d:"m {mx},{my} v -1.71335 c 0.352326,-0.0705 0.703932,-0.17838 1.047628,-0.32133 0.344416,-0.14465 0.665822,-0.32133 0.966377,-0.52145 l 1.19431,1.18005 1.567487,-1.57688 -1.195028,-1.18014 c 0.403376,-0.61394 0.683079,-1.29908 0.825447,-2.01824 l 1.622133,-0.01 v -2.2196 l -1.636514,0.01 c -0.07333,-0.35153 -0.178319,-0.70024 -0.323564,-1.04372 -0.145244,-0.34406 -0.321407,-0.6644 -0.522735,-0.96217 l 1.131035,-1.13631 -1.583305,-1.56293 -1.129598,1.13589 c -0.614052,-0.40108 -1.302883,-0.68093 -2.022633,-0.82247 l 0.0093,-1.61852 h -2.241173 l 0.0042,1.63124 c -0.353763,0.0736 -0.705369,0.17977 -1.049785,0.32371 -0.344415,0.14437 -0.665102,0.32092 -0.9635006,0.52046 l -1.1698628,-1.15823 -1.5667691,1.5792 1.1684265,1.15669 c -0.4026573,0.61283 -0.68308,1.29797 -0.8247287,2.01713 l -1.6588041,0.003 v 2.22174 l 1.6724648,-0.006 c 0.073327,0.35077 0.1797598,0.70243 0.3242851,1.04472 0.1452428,0.34448 0.3214064,0.6644 0.5227339,0.96066 l -1.1993431,1.19723 1.5840256,1.56011 1.1964668,-1.19348 c 0.6140517,0.40346 1.3028827,0.68232 2.0233517,0.82331 l 7.19e-4,1.69892 h 2.226848 z m 0.221462,-3.9957 c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_SERVICE_FILL:{d:"m {mx},{my} c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_BUSINESS_RULE_HEADER:{d:"m {mx},{my} 0,4 20,0 0,-4 z"},TASK_TYPE_BUSINESS_RULE_MAIN:{d:"m {mx},{my} 0,12 20,0 0,-12 zm 0,8 l 20,0 m -13,-4 l 0,8"},MESSAGE_FLOW_MARKER:{d:"m {mx},{my} m -10.5 ,-7 l 0,14 l 21,0 l 0,-14 z l 10.5,6 l 10.5,-6"}},this.getRawPath=function(pathId){return this.pathMap[pathId].d},this.getScaledPath=function(pathId,param){var mx,str,obj,rawPath=this.pathMap[pathId],my=param.abspos?(mx=param.abspos.x,param.abspos.y):(mx=param.containerWidth*param.position.mx,param.containerHeight*param.position.my),coordinates={};if(param.position){for(var heightRatio=param.containerHeight/rawPath.height*param.yScaleFactor,widthRatio=param.containerWidth/rawPath.width*param.xScaleFactor,heightIndex=0;heightIndex<rawPath.heightElements.length;heightIndex++)coordinates["y"+heightIndex]=rawPath.heightElements[heightIndex]*heightRatio;for(var widthIndex=0;widthIndex<rawPath.widthElements.length;widthIndex++)coordinates["x"+widthIndex]=rawPath.widthElements[widthIndex]*widthRatio}return str=rawPath.d,obj={mx:mx,my:my,e:coordinates},String(str).replace(tokenRegex,function(all,key){return function(all,key,obj){var res=obj;return key.replace(objNotationRegex,function(all,name,quote,quotedName,isFunc){name=name||quotedName,res&&(name in res&&(res=res[name]),"function"==typeof res&&isFunc&&(res=res()))}),res=(null==res||res==obj?all:res)+""}(all,key,obj)})}};var tokenRegex=/\{([^}]+)\}/g,objNotationRegex=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g},{}],58:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=TextRenderer;var obj,_minDash=require("min-dash"),_Text=require("diagram-js/lib/util/Text"),_Text2=(obj=_Text)&&obj.__esModule?obj:{default:obj};var DEFAULT_FONT_SIZE=12,LINE_HEIGHT_RATIO=1.2,MIN_TEXT_ANNOTATION_HEIGHT=30;function TextRenderer(config){var defaultStyle=(0,_minDash.assign)({fontFamily:"Arial, sans-serif",fontSize:DEFAULT_FONT_SIZE,fontWeight:"normal",lineHeight:LINE_HEIGHT_RATIO},config&&config.defaultStyle||{}),fontSize=parseInt(defaultStyle.fontSize,10)-1,externalStyle=(0,_minDash.assign)({},defaultStyle,{fontSize:fontSize},config&&config.externalStyle||{}),textUtil=new _Text2.default({style:defaultStyle});this.getExternalLabelBounds=function(bounds,text){var layoutedDimensions=textUtil.getDimensions(text,{box:{width:90,height:30,x:bounds.width/2+bounds.x,y:bounds.height/2+bounds.y},style:externalStyle});return{x:Math.round(bounds.x+bounds.width/2-layoutedDimensions.width/2),y:Math.round(bounds.y),width:Math.ceil(layoutedDimensions.width),height:Math.ceil(layoutedDimensions.height)}},this.getTextAnnotationBounds=function(bounds,text){var layoutedDimensions=textUtil.getDimensions(text,{box:bounds,style:defaultStyle,align:"left-top",padding:5});return{x:bounds.x,y:bounds.y,width:bounds.width,height:Math.max(MIN_TEXT_ANNOTATION_HEIGHT,Math.round(layoutedDimensions.height))}},this.createText=function(text,options){return textUtil.createText(text,options||{})},this.getDefaultStyle=function(){return defaultStyle},this.getExternalStyle=function(){return externalStyle}}TextRenderer.$inject=["config.textRenderer"]},{"diagram-js/lib/util/Text":365,"min-dash":594}],59:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _BpmnRenderer2=_interopRequireDefault(require("./BpmnRenderer")),_TextRenderer2=_interopRequireDefault(require("./TextRenderer")),_PathMap2=_interopRequireDefault(require("./PathMap"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__init__:["bpmnRenderer"],bpmnRenderer:["type",_BpmnRenderer2.default],textRenderer:["type",_TextRenderer2.default],pathMap:["type",_PathMap2.default]}},{"./BpmnRenderer":56,"./PathMap":57,"./TextRenderer":58}],60:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=AutoPlace;var _BpmnAutoPlaceUtil=require("./BpmnAutoPlaceUtil");function AutoPlace(eventBus){eventBus.on("autoPlace",function(context){var shape=context.shape,source=context.source;return(0,_BpmnAutoPlaceUtil.getNewShapePosition)(source,shape)})}AutoPlace.$inject=["eventBus"]},{"./BpmnAutoPlaceUtil":61}],61:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getNewShapePosition=function(source,element){if((0,_ModelUtil.is)(element,"bpmn:TextAnnotation"))return getTextAnnotationPosition(source,element);if((0,_ModelingUtil.isAny)(element,["bpmn:DataObjectReference","bpmn:DataStoreReference"]))return getDataElementPosition(source,element);if((0,_ModelUtil.is)(element,"bpmn:FlowNode"))return getFlowNodePosition(source,element)},exports.getFlowNodePosition=getFlowNodePosition,exports.getTextAnnotationPosition=getTextAnnotationPosition,exports.getDataElementPosition=getDataElementPosition;var _ModelUtil=require("../../util/ModelUtil"),_ModelingUtil=require("../modeling/util/ModelingUtil"),_LayoutUtil=require("diagram-js/lib/layout/LayoutUtil"),_AutoPlaceUtil=require("diagram-js/lib/features/auto-place/AutoPlaceUtil");function getFlowNodePosition(source,element){var sourceTrbl=(0,_LayoutUtil.asTRBL)(source),sourceMid=(0,_LayoutUtil.getMid)(source),horizontalDistance=(0,_AutoPlaceUtil.getConnectedDistance)(source,{filter:function(connection){return(0,_ModelUtil.is)(connection,"bpmn:SequenceFlow")}}),margin=30,orientation="left";(0,_ModelUtil.is)(source,"bpmn:BoundaryEvent")&&-1!==(orientation=(0,_LayoutUtil.getOrientation)(source,source.host,-25)).indexOf("top")&&(margin*=-1);var position={x:sourceTrbl.right+horizontalDistance+element.width/2,y:sourceMid.y+function(orientation,minDistance){return-1!=orientation.indexOf("top")?-1*minDistance:-1!=orientation.indexOf("bottom")?minDistance:0}(orientation,80)},nextPositionDirection={y:{margin:margin,minDistance:80}};return(0,_AutoPlaceUtil.findFreePosition)(source,element,position,(0,_AutoPlaceUtil.generateGetNextPosition)(nextPositionDirection))}function getTextAnnotationPosition(source,element){var sourceTrbl=(0,_LayoutUtil.asTRBL)(source),position={x:sourceTrbl.right+element.width/2,y:sourceTrbl.top-50-element.height/2};return(0,_AutoPlaceUtil.findFreePosition)(source,element,position,(0,_AutoPlaceUtil.generateGetNextPosition)({y:{margin:-30,minDistance:20}}))}function getDataElementPosition(source,element){var sourceTrbl=(0,_LayoutUtil.asTRBL)(source),position={x:sourceTrbl.right-10+element.width/2,y:sourceTrbl.bottom+40+element.width/2};return(0,_AutoPlaceUtil.findFreePosition)(source,element,position,(0,_AutoPlaceUtil.generateGetNextPosition)({x:{margin:30,minDistance:30}}))}},{"../../util/ModelUtil":177,"../modeling/util/ModelingUtil":148,"diagram-js/lib/features/auto-place/AutoPlaceUtil":200,"diagram-js/lib/layout/LayoutUtil":336}],62:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _autoPlace2=_interopRequireDefault(require("diagram-js/lib/features/auto-place")),_BpmnAutoPlace2=_interopRequireDefault(require("./BpmnAutoPlace"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_autoPlace2.default],__init__:["bpmnAutoPlace"],bpmnAutoPlace:["type",_BpmnAutoPlace2.default]}},{"./BpmnAutoPlace":60,"diagram-js/lib/features/auto-place":201}],63:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BpmnAutoResize;var _AutoResize2=_interopRequireDefault(require("diagram-js/lib/features/auto-resize/AutoResize")),_inherits2=_interopRequireDefault(require("inherits")),_ModelUtil=require("../../util/ModelUtil");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function BpmnAutoResize(injector){injector.invoke(_AutoResize2.default,this)}BpmnAutoResize.$inject=["injector"],(0,_inherits2.default)(BpmnAutoResize,_AutoResize2.default),BpmnAutoResize.prototype.resize=function(target,newBounds,hints){(0,_ModelUtil.is)(target,"bpmn:Participant")?this._modeling.resizeLane(target,newBounds,null,hints):this._modeling.resizeShape(target,newBounds,null,hints)}},{"../../util/ModelUtil":177,"diagram-js/lib/features/auto-resize/AutoResize":202,inherits:385}],64:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BpmnAutoResizeProvider;var _ModelUtil=require("../../util/ModelUtil"),_inherits2=_interopRequireDefault(require("inherits")),_minDash=require("min-dash"),_AutoResizeProvider2=_interopRequireDefault(require("diagram-js/lib/features/auto-resize/AutoResizeProvider"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function BpmnAutoResizeProvider(eventBus,modeling){_AutoResizeProvider2.default.call(this,eventBus),this._modeling=modeling}(0,_inherits2.default)(BpmnAutoResizeProvider,_AutoResizeProvider2.default),BpmnAutoResizeProvider.$inject=["eventBus","modeling"],BpmnAutoResizeProvider.prototype.canResize=function(elements,target){if(!(0,_ModelUtil.is)(target,"bpmn:Participant")&&!(0,_ModelUtil.is)(target,"bpmn:Lane")&&!(0,_ModelUtil.is)(target,"bpmn:SubProcess"))return!1;var canResize=!0;return(0,_minDash.forEach)(elements,function(element){((0,_ModelUtil.is)(element,"bpmn:Lane")||element.labelTarget)&&(canResize=!1)}),canResize}},{"../../util/ModelUtil":177,"diagram-js/lib/features/auto-resize/AutoResizeProvider":203,inherits:385,"min-dash":594}],65:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _BpmnAutoResize2=_interopRequireDefault(require("./BpmnAutoResize")),_BpmnAutoResizeProvider2=_interopRequireDefault(require("./BpmnAutoResizeProvider"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__init__:["bpmnAutoResize","bpmnAutoResizeProvider"],bpmnAutoResize:["type",_BpmnAutoResize2.default],bpmnAutoResizeProvider:["type",_BpmnAutoResizeProvider2.default]}},{"./BpmnAutoResize":63,"./BpmnAutoResizeProvider":64}],66:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ContextPadProvider;var _minDash=require("min-dash"),_ModelUtil=require("../../util/ModelUtil"),_DiUtil=require("../../util/DiUtil"),_ModelingUtil=require("../modeling/util/ModelingUtil"),_LaneUtil=require("../modeling/util/LaneUtil"),_Mouse=require("diagram-js/lib/util/Mouse");function ContextPadProvider(config,injector,eventBus,contextPad,modeling,elementFactory,connect,create,popupMenu,canvas,rules,translate){config=config||{},contextPad.registerProvider(this),this._contextPad=contextPad,this._modeling=modeling,this._elementFactory=elementFactory,this._connect=connect,this._create=create,this._popupMenu=popupMenu,this._canvas=canvas,this._rules=rules,this._translate=translate,!1!==config.autoPlace&&(this._autoPlace=injector.get("autoPlace",!1)),eventBus.on("create.end",250,function(event){var entries,shape=event.context.shape;(0,_Mouse.hasPrimaryModifier)(event)&&contextPad.isOpen(shape)&&((entries=contextPad.getEntries(shape)).replace&&entries.replace.action.click(event,shape))})}function isEventType(eventBo,type,definition){var isType=eventBo.$instanceOf(type),isDefinition=!1,definitions=eventBo.eventDefinitions||[];return(0,_minDash.forEach)(definitions,function(def){def.$type===definition&&(isDefinition=!0)}),isType&&isDefinition}ContextPadProvider.$inject=["config.contextPad","injector","eventBus","contextPad","modeling","elementFactory","connect","create","popupMenu","canvas","rules","translate"],ContextPadProvider.prototype.getContextPadEntries=function(element){var contextPad=this._contextPad,modeling=this._modeling,elementFactory=this._elementFactory,connect=this._connect,create=this._create,popupMenu=this._popupMenu,canvas=this._canvas,rules=this._rules,autoPlace=this._autoPlace,translate=this._translate,actions={};if("label"===element.type)return actions;var childLanes,businessObject=element.businessObject;function startConnect(event,element){connect.start(event,element)}function appendAction(type,className,title,options){function appendStart(event,element){var shape=elementFactory.createShape((0,_minDash.assign)({type:type},options));create.start(event,shape,{source:element})}return"string"!=typeof title&&(options=title,title=translate("Append {type}",{type:type.replace(/^bpmn:/,"")})),{group:"model",className:className,title:title,action:{dragstart:appendStart,click:autoPlace?function(event,element){var shape=elementFactory.createShape((0,_minDash.assign)({type:type},options));autoPlace.append(element,shape)}:appendStart}}}function splitLaneHandler(count){return function(event,element){modeling.splitLane(element,count),contextPad.open(element,!0)}}(0,_ModelingUtil.isAny)(businessObject,["bpmn:Lane","bpmn:Participant"])&&(0,_DiUtil.isExpanded)(businessObject)&&(childLanes=(0,_LaneUtil.getChildLanes)(element),(0,_minDash.assign)(actions,{"lane-insert-above":{group:"lane-insert-above",className:"bpmn-icon-lane-insert-above",title:translate("Add Lane above"),action:{click:function(event,element){modeling.addLane(element,"top")}}}}),childLanes.length<2&&(120<=element.height&&(0,_minDash.assign)(actions,{"lane-divide-two":{group:"lane-divide",className:"bpmn-icon-lane-divide-two",title:translate("Divide into two Lanes"),action:{click:splitLaneHandler(2)}}}),180<=element.height&&(0,_minDash.assign)(actions,{"lane-divide-three":{group:"lane-divide",className:"bpmn-icon-lane-divide-three",title:translate("Divide into three Lanes"),action:{click:splitLaneHandler(3)}}})),(0,_minDash.assign)(actions,{"lane-insert-below":{group:"lane-insert-below",className:"bpmn-icon-lane-insert-below",title:translate("Add Lane below"),action:{click:function(event,element){modeling.addLane(element,"bottom")}}}})),(0,_ModelUtil.is)(businessObject,"bpmn:FlowNode")&&((0,_ModelUtil.is)(businessObject,"bpmn:EventBasedGateway")?(0,_minDash.assign)(actions,{"append.receive-task":appendAction("bpmn:ReceiveTask","bpmn-icon-receive-task",translate("Append ReceiveTask")),"append.message-intermediate-event":appendAction("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-message",translate("Append MessageIntermediateCatchEvent"),{eventDefinitionType:"bpmn:MessageEventDefinition"}),"append.timer-intermediate-event":appendAction("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-timer",translate("Append TimerIntermediateCatchEvent"),{eventDefinitionType:"bpmn:TimerEventDefinition"}),"append.condition-intermediate-event":appendAction("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-condition",translate("Append ConditionIntermediateCatchEvent"),{eventDefinitionType:"bpmn:ConditionalEventDefinition"}),"append.signal-intermediate-event":appendAction("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-signal",translate("Append SignalIntermediateCatchEvent"),{eventDefinitionType:"bpmn:SignalEventDefinition"})}):isEventType(businessObject,"bpmn:BoundaryEvent","bpmn:CompensateEventDefinition")?(0,_minDash.assign)(actions,{"append.compensation-activity":appendAction("bpmn:Task","bpmn-icon-task",translate("Append compensation activity"),{isForCompensation:!0})}):(0,_ModelUtil.is)(businessObject,"bpmn:EndEvent")||businessObject.isForCompensation||isEventType(businessObject,"bpmn:IntermediateThrowEvent","bpmn:LinkEventDefinition")||(0,_DiUtil.isEventSubProcess)(businessObject)||(0,_minDash.assign)(actions,{"append.end-event":appendAction("bpmn:EndEvent","bpmn-icon-end-event-none",translate("Append EndEvent")),"append.gateway":appendAction("bpmn:ExclusiveGateway","bpmn-icon-gateway-none",translate("Append Gateway")),"append.append-task":appendAction("bpmn:Task","bpmn-icon-task",translate("Append Task")),"append.intermediate-event":appendAction("bpmn:IntermediateThrowEvent","bpmn-icon-intermediate-event-none",translate("Append Intermediate/Boundary Event"))})),popupMenu.isEmpty(element,"bpmn-replace")||(0,_minDash.assign)(actions,{replace:{group:"edit",className:"bpmn-icon-screw-wrench",title:translate("Change type"),action:{click:function(event,element){var position=(0,_minDash.assign)(function(element){var diagramContainer=canvas.getContainer(),pad=contextPad.getPad(element).html,diagramRect=diagramContainer.getBoundingClientRect(),padRect=pad.getBoundingClientRect(),top=padRect.top-diagramRect.top;return{x:padRect.left-diagramRect.left,y:top+padRect.height+5}}(element),{cursor:{x:event.x,y:event.y}});popupMenu.open(element,"bpmn-replace",position)}}}}),(0,_ModelingUtil.isAny)(businessObject,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference"])&&(0,_minDash.assign)(actions,{"append.text-annotation":appendAction("bpmn:TextAnnotation","bpmn-icon-text-annotation"),connect:{group:"connect",className:"bpmn-icon-connection-multi",title:translate("Connect using "+(businessObject.isForCompensation?"":"Sequence/MessageFlow or ")+"Association"),action:{click:startConnect,dragstart:startConnect}}}),(0,_ModelingUtil.isAny)(businessObject,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&(0,_minDash.assign)(actions,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:translate("Connect using DataInputAssociation"),action:{click:startConnect,dragstart:startConnect}}}),(0,_ModelUtil.is)(businessObject,"bpmn:Group")&&(0,_minDash.assign)(actions,{"append.text-annotation":appendAction("bpmn:TextAnnotation","bpmn-icon-text-annotation")});var deleteAllowed=rules.allowed("elements.delete",{elements:[element]});return(0,_minDash.isArray)(deleteAllowed)&&(deleteAllowed=deleteAllowed[0]===element),deleteAllowed&&(0,_minDash.assign)(actions,{delete:{group:"edit",className:"bpmn-icon-trash",title:translate("Remove"),action:{click:function(e){modeling.removeElements([element])}}}}),actions}},{"../../util/DiUtil":175,"../../util/ModelUtil":177,"../modeling/util/LaneUtil":147,"../modeling/util/ModelingUtil":148,"diagram-js/lib/util/Mouse":359,"min-dash":594}],67:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _diagramJsDirectEditing2=_interopRequireDefault(require("diagram-js-direct-editing")),_contextPad2=_interopRequireDefault(require("diagram-js/lib/features/context-pad")),_selection2=_interopRequireDefault(require("diagram-js/lib/features/selection")),_connect2=_interopRequireDefault(require("diagram-js/lib/features/connect")),_create2=_interopRequireDefault(require("diagram-js/lib/features/create")),_popupMenu2=_interopRequireDefault(require("../popup-menu")),_ContextPadProvider2=_interopRequireDefault(require("./ContextPadProvider"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_diagramJsDirectEditing2.default,_contextPad2.default,_selection2.default,_connect2.default,_create2.default,_popupMenu2.default],__init__:["contextPadProvider"],contextPadProvider:["type",_ContextPadProvider2.default]}},{"../popup-menu":154,"./ContextPadProvider":66,"diagram-js-direct-editing":368,"diagram-js/lib/features/connect":219,"diagram-js/lib/features/context-pad":223,"diagram-js/lib/features/create":228,"diagram-js/lib/features/selection":314}],68:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BpmnCopyPaste;var _ModelUtil=require("../../util/ModelUtil"),_minDash=require("min-dash");function copyProperties(source,target,properties){(0,_minDash.isArray)(properties)||(properties=[properties]),(0,_minDash.forEach)(properties,function(property){(0,_minDash.isUndefined)(source[property])||(target[property]=source[property])})}var LOW_PRIORITY=750;function BpmnCopyPaste(bpmnFactory,eventBus,moddleCopy){var references;eventBus.on("copyPaste.copyElement",LOW_PRIORITY,function(context){var descriptor=context.descriptor,element=context.element,businessObject=descriptor.oldBusinessObject=(0,_ModelUtil.getBusinessObject)(element);if(descriptor.type=element.type,copyProperties(businessObject,descriptor,"name"),descriptor.di={},copyProperties(businessObject.di,descriptor.di,["fill","stroke"]),copyProperties(businessObject.di,descriptor,"isExpanded"),isLabel(descriptor))return descriptor;businessObject.default&&(descriptor.default=businessObject.default.id)}),eventBus.on("moddleCopy.canCopyProperty",function(context){var bpmnProcess,parent=context.parent,property=context.property;if("processRef"===context.propertyName&&(0,_ModelUtil.is)(parent,"bpmn:Participant")&&(0,_ModelUtil.is)(property,"bpmn:Process"))return bpmnProcess=bpmnFactory.create("bpmn:Process"),moddleCopy.copyElement(property,bpmnProcess)}),eventBus.on("copyPaste.pasteElements",function(){references={}}),eventBus.on("copyPaste.pasteElement",function(context){var element,properties,newBusinessObject,cache=context.cache,descriptor=context.descriptor,oldBusinessObject=descriptor.oldBusinessObject;isLabel(descriptor)?descriptor.businessObject=(0,_ModelUtil.getBusinessObject)(cache[descriptor.labelTarget]):(newBusinessObject=bpmnFactory.create(oldBusinessObject.$type),descriptor.businessObject=moddleCopy.copyElement(oldBusinessObject,newBusinessObject),function(descriptor,cache){var businessObject=(0,_ModelUtil.getBusinessObject)(descriptor);descriptor.default&&(references[descriptor.default]={element:businessObject,property:"default"}),descriptor.host&&((0,_ModelUtil.getBusinessObject)(descriptor).attachedToRef=(0,_ModelUtil.getBusinessObject)(cache[descriptor.host])),references=(0,_minDash.omit)(references,(0,_minDash.reduce)(references,function(array,reference,key){var element=reference.element,property=reference.property;return key===descriptor.id&&(element[property]=businessObject,array.push(descriptor.id)),array},[]))}(descriptor,cache),copyProperties(descriptor,newBusinessObject,["isExpanded","name"]),element=descriptor,properties="oldBusinessObject",(0,_minDash.isArray)(properties)||(properties=[properties]),(0,_minDash.forEach)(properties,function(property){element[property]&&delete element[property]}))})}function isLabel(element){return element.labelTarget}BpmnCopyPaste.$inject=["bpmnFactory","eventBus","moddleCopy"]},{"../../util/ModelUtil":177,"min-dash":594}],69:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ModdleCopy,exports.getPropertyNames=getPropertyNames;var _minDash=require("min-dash"),DISALLOWED_PROPERTIES=["artifacts","dataInputAssociations","dataOutputAssociations","default","flowElements","lanes","incoming","outgoing"];function ModdleCopy(eventBus,bpmnFactory,moddle){this._bpmnFactory=bpmnFactory,this._eventBus=eventBus,this._moddle=moddle,eventBus.on("moddleCopy.canCopyProperties",function(context){var propertyNames=context.propertyNames;if(propertyNames&&propertyNames.length)return(0,_minDash.sortBy)(propertyNames,function(propertyName){return"extensionElements"===propertyName})}),eventBus.on("moddleCopy.canCopyProperty",function(context){var parent=context.parent,parentDescriptor=(0,_minDash.isObject)(parent)&&parent.$descriptor,propertyName=context.propertyName;return(!propertyName||-1===DISALLOWED_PROPERTIES.indexOf(propertyName))&&(!(propertyName&&parentDescriptor&&!(0,_minDash.find)(parentDescriptor.properties,(0,_minDash.matchPattern)({name:propertyName})))&&void 0)}),eventBus.on("moddleCopy.canSetCopiedProperty",function(context){var element,type,property=context.property;if(type="bpmn:ExtensionElements",(element=property)&&"function"==typeof element.$instanceOf&&element.$instanceOf(type)&&(!property.values||!property.values.length))return!1})}function getPropertyNames(descriptor,keepDefaultProperties){return(0,_minDash.reduce)(descriptor.properties,function(properties,property){return keepDefaultProperties&&property.default?properties:properties.concat(property.name)},[])}ModdleCopy.$inject=["eventBus","bpmnFactory","moddle"],ModdleCopy.prototype.copyElement=function(sourceElement,targetElement,propertyNames){var self=this;propertyNames&&!(0,_minDash.isArray)(propertyNames)&&(propertyNames=[propertyNames]),propertyNames=propertyNames||getPropertyNames(sourceElement.$descriptor);var canCopyProperties=this._eventBus.fire("moddleCopy.canCopyProperties",{propertyNames:propertyNames,sourceElement:sourceElement,targetElement:targetElement});return!1===canCopyProperties||((0,_minDash.isArray)(canCopyProperties)&&(propertyNames=canCopyProperties),(0,_minDash.forEach)(propertyNames,function(propertyName){var sourceProperty;(0,_minDash.has)(sourceElement,propertyName)&&(sourceProperty=sourceElement.get(propertyName));var copiedProperty=self.copyProperty(sourceProperty,targetElement,propertyName);!1!==self._eventBus.fire("moddleCopy.canSetCopiedProperty",{parent:targetElement,property:copiedProperty,propertyName:propertyName})&&(0,_minDash.isDefined)(copiedProperty)&&targetElement.set(propertyName,copiedProperty)})),targetElement},ModdleCopy.prototype.copyProperty=function(property,parent,propertyName){var self=this,copiedProperty=this._eventBus.fire("moddleCopy.canCopyProperty",{parent:parent,property:property,propertyName:propertyName});if(!1!==copiedProperty){if(copiedProperty)return(0,_minDash.isObject)(copiedProperty)&&copiedProperty.$type&&!copiedProperty.$parent&&(copiedProperty.$parent=parent),copiedProperty;var propertyDescriptor=this._moddle.getPropertyDescriptor(parent,propertyName);if(!propertyDescriptor.isId&&!propertyDescriptor.isReference){if((0,_minDash.isArray)(property))return(0,_minDash.reduce)(property,function(childProperties,childProperty){return(copiedProperty=self.copyProperty(childProperty,parent,propertyName))?(copiedProperty.$parent=parent,childProperties.concat(copiedProperty)):childProperties},[]);if((0,_minDash.isObject)(property)&&property.$type){if(this._moddle.getElementDescriptor(property).isGeneric)return;return(copiedProperty=self._bpmnFactory.create(property.$type)).$parent=parent,copiedProperty=self.copyElement(property,copiedProperty)}return property}}}},{"min-dash":594}],70:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _copyPaste2=_interopRequireDefault(require("diagram-js/lib/features/copy-paste")),_BpmnCopyPaste2=_interopRequireDefault(require("./BpmnCopyPaste")),_ModdleCopy2=_interopRequireDefault(require("./ModdleCopy"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_copyPaste2.default],__init__:["bpmnCopyPaste","moddleCopy"],bpmnCopyPaste:["type",_BpmnCopyPaste2.default],moddleCopy:["type",_ModdleCopy2.default]}},{"./BpmnCopyPaste":68,"./ModdleCopy":69,"diagram-js/lib/features/copy-paste":225}],71:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BpmnDiOrdering;var _BpmnRenderUtil=require("../../draw/BpmnRenderUtil"),_ModelUtil=require("../../util/ModelUtil"),_minDash=require("min-dash"),_Elements=require("diagram-js/lib/util/Elements"),HIGH_PRIORITY=2e3;function BpmnDiOrdering(eventBus,canvas){eventBus.on("saveXML.start",HIGH_PRIORITY,function(){var elements,diElements,root=canvas.getRootElement(),rootDi=(0,_ModelUtil.getBusinessObject)(root).di;elements=(0,_Elements.selfAndAllChildren)([root],!1),elements=(0,_minDash.filter)(elements,function(element){return element!==root&&!element.labelTarget}),diElements=(0,_minDash.map)(elements,_BpmnRenderUtil.getDi),rootDi.set("planeElement",diElements)})}BpmnDiOrdering.$inject=["eventBus","canvas"]},{"../../draw/BpmnRenderUtil":55,"../../util/ModelUtil":177,"diagram-js/lib/util/Elements":351,"min-dash":594}],72:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_BpmnDiOrdering=require("../di-ordering/BpmnDiOrdering"),_BpmnDiOrdering2=(obj=_BpmnDiOrdering)&&obj.__esModule?obj:{default:obj};exports.default={__init__:["bpmnDiOrdering"],bpmnDiOrdering:["type",_BpmnDiOrdering2.default]}},{"../di-ordering/BpmnDiOrdering":71}],73:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BpmnDistributeElements;var _minDash=require("min-dash"),_ModelingUtil=require("../modeling/util/ModelingUtil");function BpmnDistributeElements(distributeElements){distributeElements.registerFilter(function(elements){return(0,_minDash.filter)(elements,function(element){var cannotDistribute=(0,_ModelingUtil.isAny)(element,["bpmn:Association","bpmn:BoundaryEvent","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:Lane","bpmn:MessageFlow","bpmn:Participant","bpmn:SequenceFlow","bpmn:TextAnnotation"]);return!(element.labelTarget||cannotDistribute)})})}BpmnDistributeElements.$inject=["distributeElements"]},{"../modeling/util/ModelingUtil":148,"min-dash":594}],74:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _distributeElements2=_interopRequireDefault(require("diagram-js/lib/features/distribute-elements")),_BpmnDistributeElements2=_interopRequireDefault(require("./BpmnDistributeElements"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_distributeElements2.default],__init__:["bpmnDistributeElements"],bpmnDistributeElements:["type",_BpmnDistributeElements2.default]}},{"./BpmnDistributeElements":73,"diagram-js/lib/features/distribute-elements":230}],75:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BpmnEditorActions;var _inherits2=_interopRequireDefault(require("inherits")),_EditorActions2=_interopRequireDefault(require("diagram-js/lib/features/editor-actions/EditorActions")),_minDash=require("min-dash"),_ModelUtil=require("../../util/ModelUtil"),_Elements=require("diagram-js/lib/util/Elements");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function BpmnEditorActions(injector){injector.invoke(_EditorActions2.default,this)}(0,_inherits2.default)(BpmnEditorActions,_EditorActions2.default),BpmnEditorActions.$inject=["injector"],BpmnEditorActions.prototype._registerDefaultActions=function(injector){_EditorActions2.default.prototype._registerDefaultActions.call(this,injector);var canvas=injector.get("canvas",!1),elementRegistry=injector.get("elementRegistry",!1),selection=injector.get("selection",!1),spaceTool=injector.get("spaceTool",!1),lassoTool=injector.get("lassoTool",!1),handTool=injector.get("handTool",!1),globalConnect=injector.get("globalConnect",!1),distributeElements=injector.get("distributeElements",!1),alignElements=injector.get("alignElements",!1),directEditing=injector.get("directEditing",!1),searchPad=injector.get("searchPad",!1),modeling=injector.get("modeling",!1);canvas&&elementRegistry&&selection&&this._registerAction("selectElements",function(){var rootElement=canvas.getRootElement(),elements=elementRegistry.filter(function(element){return element!==rootElement});return selection.select(elements),elements}),spaceTool&&this._registerAction("spaceTool",function(){spaceTool.toggle()}),lassoTool&&this._registerAction("lassoTool",function(){lassoTool.toggle()}),handTool&&this._registerAction("handTool",function(){handTool.toggle()}),globalConnect&&this._registerAction("globalConnectTool",function(){globalConnect.toggle()}),selection&&distributeElements&&this._registerAction("distributeElements",function(opts){var currentSelection=selection.get(),type=opts.type;currentSelection.length&&distributeElements.trigger(currentSelection,type)}),selection&&alignElements&&this._registerAction("alignElements",function(opts){var aligneableElements,currentSelection=selection.get(),type=opts.type;currentSelection.length&&(aligneableElements=(0,_minDash.filter)(currentSelection,function(element){return!(0,_ModelUtil.is)(element,"bpmn:Lane")}),alignElements.trigger(aligneableElements,type))}),selection&&modeling&&this._registerAction("setColor",function(opts){var currentSelection=selection.get();currentSelection.length&&modeling.setColor(currentSelection,opts)}),selection&&directEditing&&this._registerAction("directEditing",function(){var currentSelection=selection.get();currentSelection.length&&directEditing.activate(currentSelection[0])}),searchPad&&this._registerAction("find",function(){searchPad.toggle()}),canvas&&modeling&&this._registerAction("moveToOrigin",function(){var rootElement=canvas.getRootElement(),elements=(0,_ModelUtil.is)(rootElement,"bpmn:Collaboration")?elementRegistry.filter(function(element){return(0,_ModelUtil.is)(element.parent,"bpmn:Collaboration")}):elementRegistry.filter(function(element){return element!==rootElement&&!(0,_ModelUtil.is)(element.parent,"bpmn:SubProcess")}),boundingBox=(0,_Elements.getBBox)(elements);modeling.moveElements(elements,{x:-boundingBox.x,y:-boundingBox.y},rootElement)})}},{"../../util/ModelUtil":177,"diagram-js/lib/features/editor-actions/EditorActions":234,"diagram-js/lib/util/Elements":351,inherits:385,"min-dash":594}],76:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _editorActions2=_interopRequireDefault(require("diagram-js/lib/features/editor-actions")),_BpmnEditorActions2=_interopRequireDefault(require("./BpmnEditorActions"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_editorActions2.default],editorActions:["type",_BpmnEditorActions2.default]}},{"./BpmnEditorActions":75,"diagram-js/lib/features/editor-actions":235}],77:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BpmnGridSnapping;var _ModelingUtil=require("../modeling/util/ModelingUtil");function BpmnGridSnapping(eventBus){eventBus.on(["create.init","shape.move.init"],function(event){var context=event.context,shape=event.shape;(0,_ModelingUtil.isAny)(shape,["bpmn:Participant","bpmn:SubProcess","bpmn:TextAnnotation"])&&(context.gridSnappingContext||(context.gridSnappingContext={}),context.gridSnappingContext.snapLocation="top-left")})}BpmnGridSnapping.$inject=["eventBus"]},{"../modeling/util/ModelingUtil":148}],78:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=AutoPlaceBehavior;var _BpmnAutoPlaceUtil=require("../../auto-place/BpmnAutoPlaceUtil"),_LayoutUtil=require("diagram-js/lib/layout/LayoutUtil"),_ModelUtil=require("../../../util/ModelUtil"),HIGH_PRIORITY=2e3;function AutoPlaceBehavior(eventBus,gridSnapping){eventBus.on("autoPlace",HIGH_PRIORITY,function(context){var source=context.source,sourceMid=(0,_LayoutUtil.getMid)(source),shape=context.shape,position=(0,_BpmnAutoPlaceUtil.getNewShapePosition)(source,shape);return["x","y"].forEach(function(axis){var options={};position[axis]!==sourceMid[axis]&&(position[axis]>sourceMid[axis]?options.min=position[axis]:options.max=position[axis],(0,_ModelUtil.is)(shape,"bpmn:TextAnnotation")&&(options.offset="x"===axis?-shape.width/2:-shape.height/2),position[axis]=gridSnapping.snapValue(position[axis],options))}),position})}AutoPlaceBehavior.$inject=["eventBus","gridSnapping"]},{"../../../util/ModelUtil":177,"../../auto-place/BpmnAutoPlaceUtil":61,"diagram-js/lib/layout/LayoutUtil":336}],79:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=CreateParticipantBehavior;var _ModelUtil=require("../../../util/ModelUtil"),HIGHER_PRIORITY=1750;function CreateParticipantBehavior(canvas,eventBus,gridSnapping){eventBus.on(["create.start","shape.move.start"],HIGHER_PRIORITY,function(event){var context=event.context,shape=context.shape,rootElement=canvas.getRootElement();(0,_ModelUtil.is)(shape,"bpmn:Participant")&&(0,_ModelUtil.is)(rootElement,"bpmn:Process")&&rootElement.children.length&&context.createConstraints&&(shape.width=gridSnapping.snapValue(shape.width,{min:shape.width}),shape.height=gridSnapping.snapValue(shape.height,{min:shape.height}))})}CreateParticipantBehavior.$inject=["canvas","eventBus","gridSnapping"]},{"../../../util/ModelUtil":177}],80:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=LayoutConnectionBehavior;var _inherits2=_interopRequireDefault(require("inherits")),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_Geometry=require("diagram-js/lib/util/Geometry"),_minDash=require("min-dash");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var HIGH_PRIORITY=3e3;function LayoutConnectionBehavior(eventBus,gridSnapping,modeling){_CommandInterceptor2.default.call(this,eventBus),this._gridSnapping=gridSnapping;var self=this;this.postExecuted(["connection.create","connection.layout"],HIGH_PRIORITY,function(event){var context=event.context,connection=context.connection,hints=context.hints||{},waypoints=connection.waypoints;hints.connectionStart||hints.connectionEnd||!1===hints.createElementsBehavior||3<waypoints.length&&modeling.updateWaypoints(connection,self.snapMiddleSegments(waypoints))})}LayoutConnectionBehavior.$inject=["eventBus","gridSnapping","modeling"],(0,_inherits2.default)(LayoutConnectionBehavior,_CommandInterceptor2.default),LayoutConnectionBehavior.prototype.snapMiddleSegments=function(waypoints){var snapped,gridSnapping=this._gridSnapping;waypoints=waypoints.slice();for(var i=1;i<waypoints.length-2;i++)snapped=function(gridSnapping,segmentStart,segmentEnd){var aligned=(0,_Geometry.pointsAligned)(segmentStart,segmentEnd),snapped={};"h"===aligned&&(snapped.y=gridSnapping.snapValue(segmentStart.y));"v"===aligned&&(snapped.x=gridSnapping.snapValue(segmentStart.x));("x"in snapped||"y"in snapped)&&(segmentStart=(0,_minDash.assign)({},segmentStart,snapped),segmentEnd=(0,_minDash.assign)({},segmentEnd,snapped));return[segmentStart,segmentEnd]}(gridSnapping,waypoints[i],waypoints[i+1]),waypoints[i]=snapped[0],waypoints[i+1]=snapped[1];return waypoints}},{"diagram-js/lib/command/CommandInterceptor":181,"diagram-js/lib/util/Geometry":354,inherits:385,"min-dash":594}],81:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _AutoPlaceBehavior2=_interopRequireDefault(require("./AutoPlaceBehavior")),_CreateParticipantBehavior2=_interopRequireDefault(require("./CreateParticipantBehavior")),_LayoutConnectionBehavior2=_interopRequireDefault(require("./LayoutConnectionBehavior"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__init__:["gridSnappingAutoPlaceBehavior","gridSnappingCreateParticipantBehavior","gridSnappingLayoutConnectionBehavior"],gridSnappingAutoPlaceBehavior:["type",_AutoPlaceBehavior2.default],gridSnappingCreateParticipantBehavior:["type",_CreateParticipantBehavior2.default],gridSnappingLayoutConnectionBehavior:["type",_LayoutConnectionBehavior2.default]}},{"./AutoPlaceBehavior":78,"./CreateParticipantBehavior":79,"./LayoutConnectionBehavior":80}],82:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _BpmnGridSnapping2=_interopRequireDefault(require("./BpmnGridSnapping")),_gridSnapping2=_interopRequireDefault(require("diagram-js/lib/features/grid-snapping")),_behavior2=_interopRequireDefault(require("./behavior"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_gridSnapping2.default,_behavior2.default],__init__:["bpmnGridSnapping"],bpmnGridSnapping:["type",_BpmnGridSnapping2.default]}},{"./BpmnGridSnapping":77,"./behavior":81,"diagram-js/lib/features/grid-snapping":243}],83:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BpmnInteractionEvents;var _ModelUtil=require("../../util/ModelUtil"),_DiUtil=require("../../util/DiUtil");function BpmnInteractionEvents(eventBus,interactionEvents){this._interactionEvents=interactionEvents;var self=this;eventBus.on(["interactionEvents.createHit","interactionEvents.updateHit"],function(context){var element=context.element,gfx=context.gfx;return(0,_ModelUtil.is)(element,"bpmn:Lane")?self.createParticipantHit(element,gfx):(0,_ModelUtil.is)(element,"bpmn:Participant")?(0,_DiUtil.isExpanded)(element)?self.createParticipantHit(element,gfx):self.createDefaultHit(element,gfx):(0,_ModelUtil.is)(element,"bpmn:SubProcess")?(0,_DiUtil.isExpanded)(element)?self.createSubProcessHit(element,gfx):self.createDefaultHit(element,gfx):void 0})}BpmnInteractionEvents.$inject=["eventBus","interactionEvents"],BpmnInteractionEvents.prototype.createDefaultHit=function(element,gfx){return this._interactionEvents.removeHits(gfx),this._interactionEvents.createDefaultHit(element,gfx),!0},BpmnInteractionEvents.prototype.createParticipantHit=function(element,gfx){return this._interactionEvents.removeHits(gfx),this._interactionEvents.createBoxHit(gfx,"click-stroke",{width:element.width,height:element.height}),this._interactionEvents.createBoxHit(gfx,"all",{width:30,height:element.height}),!0},BpmnInteractionEvents.prototype.createSubProcessHit=function(element,gfx){return this._interactionEvents.removeHits(gfx),this._interactionEvents.createBoxHit(gfx,"click-stroke",{width:element.width,height:element.height}),this._interactionEvents.createBoxHit(gfx,"all",{width:element.width,height:30}),!0}},{"../../util/DiUtil":175,"../../util/ModelUtil":177}],84:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_BpmnInteractionEvents=require("./BpmnInteractionEvents"),_BpmnInteractionEvents2=(obj=_BpmnInteractionEvents)&&obj.__esModule?obj:{default:obj};exports.default={__init__:["bpmnInteractionEvents"],bpmnInteractionEvents:["type",_BpmnInteractionEvents2.default]}},{"./BpmnInteractionEvents":83}],85:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BpmnKeyboardBindings;var _inherits2=_interopRequireDefault(require("inherits")),_KeyboardBindings2=_interopRequireDefault(require("diagram-js/lib/features/keyboard/KeyboardBindings"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function BpmnKeyboardBindings(injector){injector.invoke(_KeyboardBindings2.default,this)}(0,_inherits2.default)(BpmnKeyboardBindings,_KeyboardBindings2.default),BpmnKeyboardBindings.$inject=["injector"],BpmnKeyboardBindings.prototype.registerBindings=function(keyboard,editorActions){function addListener(action,fn){editorActions.isRegistered(action)&&keyboard.addListener(fn)}_KeyboardBindings2.default.prototype.registerBindings.call(this,keyboard,editorActions),addListener("selectElements",function(context){var event=context.keyEvent;if(keyboard.isKey(["a","A"],event)&&keyboard.isCmd(event))return editorActions.trigger("selectElements"),!0}),addListener("find",function(context){var event=context.keyEvent;if(keyboard.isKey(["f","F"],event)&&keyboard.isCmd(event))return editorActions.trigger("find"),!0}),addListener("spaceTool",function(context){var event=context.keyEvent;if(!keyboard.hasModifier(event))return keyboard.isKey(["s","S"],event)?(editorActions.trigger("spaceTool"),!0):void 0}),addListener("lassoTool",function(context){var event=context.keyEvent;if(!keyboard.hasModifier(event))return keyboard.isKey(["l","L"],event)?(editorActions.trigger("lassoTool"),!0):void 0}),addListener("handTool",function(context){var event=context.keyEvent;if(!keyboard.hasModifier(event))return keyboard.isKey(["h","H"],event)?(editorActions.trigger("handTool"),!0):void 0}),addListener("globalConnectTool",function(context){var event=context.keyEvent;if(!keyboard.hasModifier(event))return keyboard.isKey(["c","C"],event)?(editorActions.trigger("globalConnectTool"),!0):void 0}),addListener("directEditing",function(context){var event=context.keyEvent;if(!keyboard.hasModifier(event))return keyboard.isKey(["e","E"],event)?(editorActions.trigger("directEditing"),!0):void 0})}},{"diagram-js/lib/features/keyboard/KeyboardBindings":251,inherits:385}],86:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _keyboard2=_interopRequireDefault(require("diagram-js/lib/features/keyboard")),_BpmnKeyboardBindings2=_interopRequireDefault(require("./BpmnKeyboardBindings"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_keyboard2.default],__init__:["keyboardBindings"],keyboardBindings:["type",_BpmnKeyboardBindings2.default]}},{"./BpmnKeyboardBindings":85,"diagram-js/lib/features/keyboard":253}],87:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=LabelEditingPreview;var _tinySvg=require("tiny-svg"),_ModelUtil=require("../../util/ModelUtil"),_SvgTransformUtil=require("diagram-js/lib/util/SvgTransformUtil"),MARKER_HIDDEN="djs-element-hidden",MARKER_LABEL_HIDDEN="djs-label-hidden";function LabelEditingPreview(eventBus,canvas,elementRegistry,pathMap){var element,absoluteElementBBox,gfx,self=this,defaultLayer=canvas.getDefaultLayer();eventBus.on("directEditing.activate",function(context){var textPathData,path,activeProvider=context.active;element=activeProvider.element.label||activeProvider.element,(0,_ModelUtil.is)(element,"bpmn:TextAnnotation")&&(absoluteElementBBox=canvas.getAbsoluteBBox(element),gfx=(0,_tinySvg.create)("g"),textPathData=pathMap.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:element.height,position:{mx:0,my:0}}),path=self.path=(0,_tinySvg.create)("path"),(0,_tinySvg.attr)(path,{d:textPathData,strokeWidth:2,stroke:function(element,defaultColor){return(0,_ModelUtil.getBusinessObject)(element).di.get("stroke")||defaultColor||"black"}(element)}),(0,_tinySvg.append)(gfx,path),(0,_tinySvg.append)(defaultLayer,gfx),(0,_SvgTransformUtil.translate)(gfx,element.x,element.y)),(0,_ModelUtil.is)(element,"bpmn:TextAnnotation")||element.labelTarget?canvas.addMarker(element,MARKER_HIDDEN):((0,_ModelUtil.is)(element,"bpmn:Task")||(0,_ModelUtil.is)(element,"bpmn:CallActivity")||(0,_ModelUtil.is)(element,"bpmn:SubProcess")||(0,_ModelUtil.is)(element,"bpmn:Participant"))&&canvas.addMarker(element,MARKER_LABEL_HIDDEN)}),eventBus.on("directEditing.resize",function(context){var height,dy,newElementHeight,textPathData;(0,_ModelUtil.is)(element,"bpmn:TextAnnotation")&&(height=context.height,dy=context.dy,newElementHeight=Math.max(element.height/absoluteElementBBox.height*(height+dy),0),textPathData=pathMap.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:element.width,containerHeight:newElementHeight,position:{mx:0,my:0}}),(0,_tinySvg.attr)(self.path,{d:textPathData}))}),eventBus.on(["directEditing.complete","directEditing.cancel"],function(context){var activeProvider=context.active;activeProvider&&(canvas.removeMarker(activeProvider.element.label||activeProvider.element,MARKER_HIDDEN),canvas.removeMarker(element,MARKER_LABEL_HIDDEN)),absoluteElementBBox=element=void 0,gfx&&((0,_tinySvg.remove)(gfx),gfx=void 0)})}LabelEditingPreview.$inject=["eventBus","canvas","elementRegistry","pathMap"]},{"../../util/ModelUtil":177,"diagram-js/lib/util/SvgTransformUtil":364,"tiny-svg":606}],88:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=LabelEditingProvider;var _minDash=require("min-dash"),_LabelUtil=require("./LabelUtil"),_ModelUtil=require("../../util/ModelUtil"),_CategoryUtil=require("../modeling/behavior/util/CategoryUtil"),_ModelingUtil=require("../modeling/util/ModelingUtil"),_DiUtil=require("../../util/DiUtil"),_LabelUtil2=require("../../util/LabelUtil");function LabelEditingProvider(eventBus,bpmnFactory,canvas,directEditing,modeling,resizeHandles,textRenderer){function activateDirectEdit(element,force){(force||(0,_ModelingUtil.isAny)(element,["bpmn:Task","bpmn:TextAnnotation","bpmn:Group"])||isCollapsedSubProcess(element))&&directEditing.activate(element)}this._bpmnFactory=bpmnFactory,this._canvas=canvas,this._modeling=modeling,this._textRenderer=textRenderer,directEditing.registerProvider(this),eventBus.on("element.dblclick",function(event){activateDirectEdit(event.element,!0)}),eventBus.on(["autoPlace.start","canvas.viewbox.changing","drag.init","element.mousedown","popupMenu.open"],function(event){directEditing.isActive()&&directEditing.complete()}),eventBus.on(["commandStack.changed"],function(e){directEditing.isActive()&&directEditing.cancel()}),eventBus.on("directEditing.activate",function(event){resizeHandles.removeResizers()}),eventBus.on("create.end",500,function(event){var context=event.context,element=context.shape,canExecute=event.context.canExecute;event.isTouch||canExecute&&(context.hints&&!1===context.hints.createElementsBehavior||activateDirectEdit(element))}),eventBus.on("autoPlace.end",500,function(event){activateDirectEdit(event.shape)})}function isCollapsedSubProcess(element){return(0,_ModelUtil.is)(element,"bpmn:SubProcess")&&!(0,_DiUtil.isExpanded)(element)}LabelEditingProvider.$inject=["eventBus","bpmnFactory","canvas","directEditing","modeling","resizeHandles","textRenderer"],LabelEditingProvider.prototype.activate=function(element){var text=(0,_LabelUtil.getLabel)(element);if(void 0!==text){var context={text:text},bounds=this.getEditingBBox(element);(0,_minDash.assign)(context,bounds);var options={};return((0,_ModelingUtil.isAny)(element,["bpmn:Task","bpmn:Participant","bpmn:Lane","bpmn:CallActivity"])||isCollapsedSubProcess(element))&&(0,_minDash.assign)(options,{centerVertically:!0}),(0,_LabelUtil2.isLabelExternal)(element)&&(0,_minDash.assign)(options,{autoResize:!0}),(0,_ModelUtil.is)(element,"bpmn:TextAnnotation")&&(0,_minDash.assign)(options,{resizable:!0,autoResize:!0}),(0,_minDash.assign)(context,{options:options}),context}},LabelEditingProvider.prototype.getEditingBBox=function(element){var canvas=this._canvas,target=element.label||element,bbox=canvas.getAbsoluteBBox(target),mid_x=bbox.x+bbox.width/2,mid_y=bbox.y+bbox.height/2,bounds={x:bbox.x,y:bbox.y},zoom=canvas.zoom(),defaultStyle=this._textRenderer.getDefaultStyle(),externalStyle=this._textRenderer.getExternalStyle(),externalFontSize=externalStyle.fontSize*zoom,externalLineHeight=externalStyle.lineHeight,defaultFontSize=defaultStyle.fontSize*zoom,defaultLineHeight=defaultStyle.lineHeight,style={fontFamily:this._textRenderer.getDefaultStyle().fontFamily,fontWeight:this._textRenderer.getDefaultStyle().fontWeight};((0,_ModelUtil.is)(element,"bpmn:Lane")||function(element){return(0,_ModelUtil.is)(element,"bpmn:Participant")&&(0,_DiUtil.isExpanded)(element)}(element))&&((0,_minDash.assign)(bounds,{width:bbox.height,height:30*zoom,x:bbox.x-bbox.height/2+15*zoom,y:mid_y-30*zoom/2}),(0,_minDash.assign)(style,{fontSize:defaultFontSize+"px",lineHeight:defaultLineHeight,paddingTop:7*zoom+"px",paddingBottom:7*zoom+"px",paddingLeft:5*zoom+"px",paddingRight:5*zoom+"px",transform:"rotate(-90deg)"})),((0,_ModelingUtil.isAny)(element,["bpmn:Task","bpmn:CallActivity"])||function(element){return(0,_ModelUtil.is)(element,"bpmn:Participant")&&!(0,_DiUtil.isExpanded)(element)}(element)||isCollapsedSubProcess(element))&&((0,_minDash.assign)(bounds,{width:bbox.width,height:bbox.height}),(0,_minDash.assign)(style,{fontSize:defaultFontSize+"px",lineHeight:defaultLineHeight,paddingTop:7*zoom+"px",paddingBottom:7*zoom+"px",paddingLeft:5*zoom+"px",paddingRight:5*zoom+"px"})),function(element){return(0,_ModelUtil.is)(element,"bpmn:SubProcess")&&(0,_DiUtil.isExpanded)(element)}(element)&&((0,_minDash.assign)(bounds,{width:bbox.width,x:bbox.x}),(0,_minDash.assign)(style,{fontSize:defaultFontSize+"px",lineHeight:defaultLineHeight,paddingTop:7*zoom+"px",paddingBottom:7*zoom+"px",paddingLeft:5*zoom+"px",paddingRight:5*zoom+"px"}));var externalLabelMid,absoluteBBox,height,width=90*zoom,paddingTop=7*zoom,paddingBottom=4*zoom;return target.labelTarget&&((0,_minDash.assign)(bounds,{width:width,height:bbox.height+paddingTop+paddingBottom,x:mid_x-width/2,y:bbox.y-paddingTop}),(0,_minDash.assign)(style,{fontSize:externalFontSize+"px",lineHeight:externalLineHeight,paddingTop:paddingTop+"px",paddingBottom:paddingBottom+"px"})),!(0,_LabelUtil2.isLabelExternal)(target)||(0,_LabelUtil2.hasExternalLabel)(target)||(0,_LabelUtil2.isLabel)(target)||(externalLabelMid=(0,_LabelUtil2.getExternalLabelMid)(element),absoluteBBox=canvas.getAbsoluteBBox({x:externalLabelMid.x,y:externalLabelMid.y,width:0,height:0}),height=externalFontSize+paddingTop+paddingBottom,(0,_minDash.assign)(bounds,{width:width,height:height,x:absoluteBBox.x-width/2,y:absoluteBBox.y-height/2}),(0,_minDash.assign)(style,{fontSize:externalFontSize+"px",lineHeight:externalLineHeight,paddingTop:paddingTop+"px",paddingBottom:paddingBottom+"px"})),(0,_ModelUtil.is)(element,"bpmn:TextAnnotation")&&((0,_minDash.assign)(bounds,{width:bbox.width,height:bbox.height,minWidth:30*zoom,minHeight:10*zoom}),(0,_minDash.assign)(style,{textAlign:"left",paddingTop:5*zoom+"px",paddingBottom:7*zoom+"px",paddingLeft:7*zoom+"px",paddingRight:5*zoom+"px",fontSize:defaultFontSize+"px",lineHeight:defaultLineHeight})),{bounds:bounds,style:style}},LabelEditingProvider.prototype.update=function(element,newLabel,activeContextText,bounds){var newBounds,bbox,rootElement,definitions,categoryValue,label;(0,_ModelUtil.is)(element,"bpmn:TextAnnotation")&&(bbox=this._canvas.getAbsoluteBBox(element),newBounds={x:element.x,y:element.y,width:element.width/bbox.width*bounds.width,height:element.height/bbox.height*bounds.height}),(0,_ModelUtil.is)(element,"bpmn:Group")&&((0,_ModelUtil.getBusinessObject)(element).categoryValueRef||(rootElement=this._canvas.getRootElement(),definitions=(0,_ModelUtil.getBusinessObject)(rootElement).$parent,categoryValue=(0,_CategoryUtil.createCategoryValue)(definitions,this._bpmnFactory),(0,_ModelUtil.getBusinessObject)(element).categoryValueRef=categoryValue)),(label=newLabel)&&label.trim()||(newLabel=null),this._modeling.updateLabel(element,newLabel,newBounds)}},{"../../util/DiUtil":175,"../../util/LabelUtil":176,"../../util/ModelUtil":177,"../modeling/behavior/util/CategoryUtil":131,"../modeling/util/ModelingUtil":148,"./LabelUtil":89,"min-dash":594}],89:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getLabel=function(element){var semantic=element.businessObject,attr=getLabelAttr(semantic);if(attr)return"categoryValueRef"===attr?function(semantic){var categoryValueRef=semantic.categoryValueRef;return categoryValueRef&&categoryValueRef.value||""}(semantic):semantic[attr]||""},exports.setLabel=function(element,text,isExternal){var semantic=element.businessObject,attr=getLabelAttr(semantic);attr&&("categoryValueRef"===attr?semantic.categoryValueRef.value=text:semantic[attr]=text);return element};var _ModelUtil=require("../../util/ModelUtil");function getLabelAttr(semantic){return(0,_ModelUtil.is)(semantic,"bpmn:FlowElement")||(0,_ModelUtil.is)(semantic,"bpmn:Participant")||(0,_ModelUtil.is)(semantic,"bpmn:Lane")||(0,_ModelUtil.is)(semantic,"bpmn:SequenceFlow")||(0,_ModelUtil.is)(semantic,"bpmn:MessageFlow")||(0,_ModelUtil.is)(semantic,"bpmn:DataInput")||(0,_ModelUtil.is)(semantic,"bpmn:DataOutput")?"name":(0,_ModelUtil.is)(semantic,"bpmn:TextAnnotation")?"text":(0,_ModelUtil.is)(semantic,"bpmn:Group")?"categoryValueRef":void 0}},{"../../util/ModelUtil":177}],90:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=UpdateLabelHandler;var _LabelUtil=require("../LabelUtil"),_LabelUtil2=require("../../../util/LabelUtil"),_ModelUtil=require("../../../util/ModelUtil"),NULL_DIMENSIONS={width:0,height:0};function UpdateLabelHandler(modeling,textRenderer){function setText(element,text){var label=element.label||element,labelTarget=element.labelTarget||element;return(0,_LabelUtil.setLabel)(label,text,labelTarget!==label),[label,labelTarget]}this.preExecute=function(ctx){var labelCenter,element=ctx.element,businessObject=element.businessObject,newLabel=ctx.newLabel;(0,_LabelUtil2.isLabel)(element)||!(0,_LabelUtil2.isLabelExternal)(element)||(0,_LabelUtil2.hasExternalLabel)(element)||isEmptyText(newLabel)||(labelCenter={x:(labelCenter=(0,_LabelUtil2.getExternalLabelMid)(element)).x,y:labelCenter.y+7},modeling.createLabel(element,labelCenter,{id:businessObject.id+"_label",businessObject:businessObject}))},this.execute=function(ctx){return ctx.oldLabel=(0,_LabelUtil.getLabel)(ctx.element),setText(ctx.element,ctx.newLabel)},this.revert=function(ctx){return setText(ctx.element,ctx.oldLabel)},this.postExecute=function(ctx){var text,element=ctx.element,label=element.label||element,newLabel=ctx.newLabel,newBounds=ctx.newBounds,hints=ctx.hints||{};((0,_LabelUtil2.isLabel)(label)||(0,_ModelUtil.is)(label,"bpmn:TextAnnotation"))&&((0,_LabelUtil2.isLabel)(label)&&isEmptyText(newLabel)?!1!==hints.removeShape&&modeling.removeShape(label,{unsetLabel:!1}):(text=(0,_LabelUtil.getLabel)(label),void 0===newBounds&&(newBounds=textRenderer.getExternalLabelBounds(label,text)),newBounds&&modeling.resizeShape(label,newBounds,NULL_DIMENSIONS)))}}function isEmptyText(label){return!label||!label.trim()}UpdateLabelHandler.$inject=["modeling","textRenderer"]},{"../../../util/LabelUtil":176,"../../../util/ModelUtil":177,"../LabelUtil":89}],91:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _changeSupport2=_interopRequireDefault(require("diagram-js/lib/features/change-support")),_resize2=_interopRequireDefault(require("diagram-js/lib/features/resize")),_diagramJsDirectEditing2=_interopRequireDefault(require("diagram-js-direct-editing")),_LabelEditingProvider2=_interopRequireDefault(require("./LabelEditingProvider")),_LabelEditingPreview2=_interopRequireDefault(require("./LabelEditingPreview"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_changeSupport2.default,_resize2.default,_diagramJsDirectEditing2.default],__init__:["labelEditingProvider","labelEditingPreview"],labelEditingProvider:["type",_LabelEditingProvider2.default],labelEditingPreview:["type",_LabelEditingPreview2.default]}},{"./LabelEditingPreview":87,"./LabelEditingProvider":88,"diagram-js-direct-editing":368,"diagram-js/lib/features/change-support":214,"diagram-js/lib/features/resize":305}],92:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BpmnFactory;var _minDash=require("min-dash"),_ModelingUtil=require("./util/ModelingUtil"),_ModelUtil=require("../../util/ModelUtil");function BpmnFactory(moddle){this._model=moddle}BpmnFactory.$inject=["moddle"],BpmnFactory.prototype._needsId=function(element){return(0,_ModelingUtil.isAny)(element,["bpmn:RootElement","bpmn:FlowElement","bpmn:MessageFlow","bpmn:DataAssociation","bpmn:Artifact","bpmn:Participant","bpmn:Lane","bpmn:LaneSet","bpmn:Process","bpmn:Collaboration","bpmndi:BPMNShape","bpmndi:BPMNEdge","bpmndi:BPMNDiagram","bpmndi:BPMNPlane","bpmn:Property","bpmn:CategoryValue"])},BpmnFactory.prototype._ensureId=function(element){var prefix=(0,_ModelUtil.is)(element,"bpmn:Activity")?"Activity":(0,_ModelUtil.is)(element,"bpmn:Event")?"Event":(0,_ModelUtil.is)(element,"bpmn:Gateway")?"Gateway":(0,_ModelingUtil.isAny)(element,["bpmn:SequenceFlow","bpmn:MessageFlow"])?"Flow":(element.$type||"").replace(/^[^:]*:/g,"");prefix+="_",!element.id&&this._needsId(element)&&(element.id=this._model.ids.nextPrefixed(prefix,element))},BpmnFactory.prototype.create=function(type,attrs){var element=this._model.create(type,attrs||{});return this._ensureId(element),element},BpmnFactory.prototype.createDiLabel=function(){return this.create("bpmndi:BPMNLabel",{bounds:this.createDiBounds()})},BpmnFactory.prototype.createDiShape=function(semantic,bounds,attrs){return this.create("bpmndi:BPMNShape",(0,_minDash.assign)({bpmnElement:semantic,bounds:this.createDiBounds(bounds)},attrs))},BpmnFactory.prototype.createDiBounds=function(bounds){return this.create("dc:Bounds",bounds)},BpmnFactory.prototype.createDiWaypoints=function(waypoints){var self=this;return(0,_minDash.map)(waypoints,function(pos){return self.createDiWaypoint(pos)})},BpmnFactory.prototype.createDiWaypoint=function(point){return this.create("dc:Point",(0,_minDash.pick)(point,["x","y"]))},BpmnFactory.prototype.createDiEdge=function(semantic,waypoints,attrs){return this.create("bpmndi:BPMNEdge",(0,_minDash.assign)({bpmnElement:semantic},attrs))},BpmnFactory.prototype.createDiPlane=function(semantic){return this.create("bpmndi:BPMNPlane",{bpmnElement:semantic})}},{"../../util/ModelUtil":177,"./util/ModelingUtil":148,"min-dash":594}],93:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BpmnLayouter;var _inherits2=_interopRequireDefault(require("inherits")),_minDash=require("min-dash"),_BaseLayouter2=_interopRequireDefault(require("diagram-js/lib/layout/BaseLayouter")),_ManhattanLayout=require("diagram-js/lib/layout/ManhattanLayout"),_LayoutUtil=require("diagram-js/lib/layout/LayoutUtil"),_DiUtil=require("../../util/DiUtil"),_ModelUtil=require("../../util/ModelUtil");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ATTACH_ORIENTATION_PADDING=-10,BOUNDARY_TO_HOST_THRESHOLD=40,oppositeOrientationMapping={top:"bottom","top-right":"bottom-left","top-left":"bottom-right",right:"left",bottom:"top","bottom-right":"top-left","bottom-left":"top-right",left:"right"},orientationDirectionMapping={top:"t",right:"r",bottom:"b",left:"l"};function BpmnLayouter(){}function getConnectionDocking(point,shape){return point?point.original||point:(0,_LayoutUtil.getMid)(shape)}function isCompensationAssociation(source,target){return(0,_ModelUtil.is)(target,"bpmn:Activity")&&(0,_ModelUtil.is)(source,"bpmn:BoundaryEvent")&&target.businessObject.isForCompensation}function isExpandedSubProcess(element){return(0,_ModelUtil.is)(element,"bpmn:SubProcess")&&(0,_DiUtil.isExpanded)(element)}function getHorizontalOrientation(orientation){var matches=/right|left/.exec(orientation);return matches&&matches[0]}function getVerticalOrientation(orientation){var matches=/top|bottom/.exec(orientation);return matches&&matches[0]}function isHorizontalOrientation(orientation){return"right"===orientation||"left"===orientation}function shouldConnectToSameSide(axis,source,target,end){var threshold=BOUNDARY_TO_HOST_THRESHOLD;return!(areCloseOnAxis(axis,end,target,threshold)||areCloseOnAxis(axis,end,{x:target.x+target.width,y:target.y+target.height},threshold)||areCloseOnAxis(axis,end,(0,_LayoutUtil.getMid)(source),threshold))}function areCloseOnAxis(axis,a,b,threshold){return Math.abs(a[axis]-b[axis])<threshold}(0,_inherits2.default)(BpmnLayouter,_BaseLayouter2.default),BpmnLayouter.prototype.layoutConnection=function(connection,hints){var manhattanOptions,updatedWaypoints,source=(hints=hints||{}).source||connection.source,target=hints.target||connection.target,waypoints=hints.waypoints||connection.waypoints,connectionStart=hints.connectionStart,connectionEnd=hints.connectionEnd,connectionStart=connectionStart||getConnectionDocking(waypoints&&waypoints[0],source),connectionEnd=connectionEnd||getConnectionDocking(waypoints&&waypoints[waypoints.length-1],target);return((0,_ModelUtil.is)(connection,"bpmn:Association")||(0,_ModelUtil.is)(connection,"bpmn:DataAssociation"))&&waypoints&&!isCompensationAssociation(source,target)?[].concat([connectionStart],waypoints.slice(1,-1),[connectionEnd]):((0,_ModelUtil.is)(connection,"bpmn:MessageFlow")?manhattanOptions=function(source,target){return{preferredLayouts:["straight","v:v"],preserveDocking:function(source,target){if((0,_ModelUtil.is)(target,"bpmn:Participant"))return"source";if((0,_ModelUtil.is)(source,"bpmn:Participant"))return"target";if(isExpandedSubProcess(target))return"source";if(isExpandedSubProcess(source))return"target";if((0,_ModelUtil.is)(target,"bpmn:Event"))return"target";if((0,_ModelUtil.is)(source,"bpmn:Event"))return"source";return null}(source,target)}}(source,target):((0,_ModelUtil.is)(connection,"bpmn:SequenceFlow")||isCompensationAssociation(source,target))&&(manhattanOptions=source===target?{preferredLayouts:function(source,connection){var waypoints=connection.waypoints,orientation=waypoints&&waypoints.length&&(0,_LayoutUtil.getOrientation)(waypoints[0],source);{if("top"===orientation)return["t:r"];if("right"===orientation)return["r:b"];if("left"===orientation)return["l:t"]}return["b:l"]}(source,connection)}:(0,_ModelUtil.is)(source,"bpmn:BoundaryEvent")?{preferredLayouts:function(source,target,end){var sourceLayout,targetLayout,sourceMid=(0,_LayoutUtil.getMid)(source),targetMid=(0,_LayoutUtil.getMid)(target),attachOrientation=function(attachedElement){var hostElement=attachedElement.host;return(0,_LayoutUtil.getOrientation)((0,_LayoutUtil.getMid)(attachedElement),hostElement,ATTACH_ORIENTATION_PADDING)}(source),isLoop=source.host===target,attachedToSide=function(orientation,orientations){return-1!==orientations.indexOf(orientation)}(attachOrientation,["top","right","bottom","left"]),targetOrientation=(0,_LayoutUtil.getOrientation)(targetMid,sourceMid,{x:source.width/2+target.width/2,y:source.height/2+target.height/2});if(isLoop)return function(attachOrientation,attachedToSide,source,target,end){var targetLayout,orientation=attachedToSide?attachOrientation:getVerticalOrientation(attachOrientation),sourceLayout=orientationDirectionMapping[orientation];targetLayout=attachedToSide?isHorizontalOrientation(attachOrientation)?shouldConnectToSameSide("y",source,target,end)?"h":"b":shouldConnectToSameSide("x",source,target,end)?"v":"l":"v";return[sourceLayout+":"+targetLayout]}(attachOrientation,attachedToSide,source,target,end);return sourceLayout=function(attachOrientation,targetOrientation,attachedToSide){if(attachedToSide)return orientationDirectionMapping[attachOrientation];if(getVerticalOrientation(attachOrientation)===getVerticalOrientation(targetOrientation)||function(a,b){return oppositeOrientationMapping[a]===b}(getHorizontalOrientation(attachOrientation),getHorizontalOrientation(targetOrientation)))return orientationDirectionMapping[getVerticalOrientation(attachOrientation)];return orientationDirectionMapping[getHorizontalOrientation(attachOrientation)]}(attachOrientation,targetOrientation,attachedToSide),targetLayout=function(attachOrientation,targetOrientation,attachedToSide){if(attachedToSide)return isHorizontalOrientation(attachOrientation)?function(a,b){var horizontalOrientation=getHorizontalOrientation(a),oppositeHorizontalOrientation=oppositeOrientationMapping[horizontalOrientation];return-1!==b.indexOf(oppositeHorizontalOrientation)}(attachOrientation,targetOrientation)||attachOrientation===targetOrientation?"h":"v":function(a,b){var verticalOrientation=getVerticalOrientation(a),oppositeVerticalOrientation=oppositeOrientationMapping[verticalOrientation];return-1!==b.indexOf(oppositeVerticalOrientation)}(attachOrientation,targetOrientation)||attachOrientation===targetOrientation?"v":"h";return isHorizontalOrientation(targetOrientation)||getVerticalOrientation(attachOrientation)===getVerticalOrientation(targetOrientation)&&getHorizontalOrientation(targetOrientation)?"h":"v"}(attachOrientation,targetOrientation,attachedToSide),[sourceLayout+":"+targetLayout]}(source,target,connectionEnd)}:isExpandedSubProcess(source)||isExpandedSubProcess(target)?function(source){return{preferredLayouts:["straight","h:h"],preserveDocking:function(source){return isExpandedSubProcess(source)?"target":"source"}(source)}}(source):(0,_ModelUtil.is)(source,"bpmn:Gateway")?{preferredLayouts:["v:h"]}:(0,_ModelUtil.is)(target,"bpmn:Gateway")?{preferredLayouts:["h:v"]}:{preferredLayouts:["h:h"]}),manhattanOptions&&(manhattanOptions=(0,_minDash.assign)(manhattanOptions,hints),updatedWaypoints=(0,_ManhattanLayout.withoutRedundantPoints)((0,_ManhattanLayout.repairConnection)(source,target,connectionStart,connectionEnd,waypoints,manhattanOptions))),updatedWaypoints||[connectionStart,connectionEnd])}},{"../../util/DiUtil":175,"../../util/ModelUtil":177,"diagram-js/lib/layout/BaseLayouter":334,"diagram-js/lib/layout/LayoutUtil":336,"diagram-js/lib/layout/ManhattanLayout":337,inherits:385,"min-dash":594}],94:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BpmnUpdater;var _minDash=require("min-dash"),_inherits2=_interopRequireDefault(require("inherits")),_Collections=require("diagram-js/lib/util/Collections"),_model=require("diagram-js/lib/model"),_ModelUtil=require("../../util/ModelUtil"),_ModelingUtil=require("./util/ModelingUtil"),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function BpmnUpdater(eventBus,bpmnFactory,connectionDocking,translate){_CommandInterceptor2.default.call(this,eventBus),this._bpmnFactory=bpmnFactory,this._translate=translate;var self=this;function updateRoot(event){var children=event.context.oldRoot.children;(0,_minDash.forEach)(children,function(child){(0,_ModelUtil.is)(child,"bpmn:BaseElement")&&self.updateParent(child)})}function updateBounds(e){var shape=e.context.shape;(0,_ModelUtil.is)(shape,"bpmn:BaseElement")&&self.updateBounds(shape)}function updateConnection(e){self.updateConnection(e.context)}function updateConnectionWaypoints(e){self.updateConnectionWaypoints(e.context.connection)}function updateAttachment(e){self.updateAttachment(e.context)}this.executed(["connection.layout","connection.create"],function(e){var connection,context=e.context,hints=context.hints||{};context.cropped||!1===hints.createElementsBehavior||((connection=context.connection).waypoints=connectionDocking.getCroppedWaypoints(connection),context.cropped=!0)}),this.reverted(["connection.layout"],function(e){delete e.context.cropped}),this.executed(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],ifBpmn(function(e){var context=e.context;self.updateParent(context.shape||context.connection,context.oldParent)})),this.reverted(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],ifBpmn(function(e){var context=e.context,element=context.shape||context.connection,oldParent=context.parent||context.newParent;self.updateParent(element,oldParent)})),this.executed(["canvas.updateRoot"],updateRoot),this.reverted(["canvas.updateRoot"],updateRoot),this.executed(["shape.move","shape.create","shape.resize"],ifBpmn(function(event){"label"!==event.context.shape.type&&updateBounds(event)})),this.reverted(["shape.move","shape.create","shape.resize"],ifBpmn(function(event){"label"!==event.context.shape.type&&updateBounds(event)})),eventBus.on("shape.changed",function(event){"label"===event.element.type&&updateBounds({context:{shape:event.element}})}),this.executed(["connection.create","connection.move","connection.delete","connection.reconnect"],ifBpmn(updateConnection)),this.reverted(["connection.create","connection.move","connection.delete","connection.reconnect"],ifBpmn(updateConnection)),this.executed(["connection.layout","connection.move","connection.updateWaypoints"],ifBpmn(updateConnectionWaypoints)),this.reverted(["connection.layout","connection.move","connection.updateWaypoints"],ifBpmn(updateConnectionWaypoints)),this.executed("connection.reconnect",ifBpmn(function(event){var context=event.context,connection=context.connection,oldSource=context.oldSource,newSource=context.newSource,connectionBo=(0,_ModelUtil.getBusinessObject)(connection),oldSourceBo=(0,_ModelUtil.getBusinessObject)(oldSource),newSourceBo=(0,_ModelUtil.getBusinessObject)(newSource);connectionBo.conditionExpression&&!(0,_ModelingUtil.isAny)(newSourceBo,["bpmn:Activity","bpmn:ExclusiveGateway","bpmn:InclusiveGateway"])&&(context.oldConditionExpression=connectionBo.conditionExpression,delete connectionBo.conditionExpression),oldSource!==newSource&&oldSourceBo.default===connectionBo&&(context.oldDefault=oldSourceBo.default,delete oldSourceBo.default)})),this.reverted("connection.reconnect",ifBpmn(function(event){var context=event.context,connection=context.connection,oldSource=context.oldSource,newSource=context.newSource,connectionBo=(0,_ModelUtil.getBusinessObject)(connection),oldSourceBo=(0,_ModelUtil.getBusinessObject)(oldSource),newSourceBo=(0,_ModelUtil.getBusinessObject)(newSource);context.oldConditionExpression&&(connectionBo.conditionExpression=context.oldConditionExpression),context.oldDefault&&(oldSourceBo.default=context.oldDefault,delete newSourceBo.default)})),this.executed(["element.updateAttachment"],ifBpmn(updateAttachment)),this.reverted(["element.updateAttachment"],ifBpmn(updateAttachment))}function ifBpmn(fn){return function(event){var context=event.context,element=context.shape||context.connection;(0,_ModelUtil.is)(element,"bpmn:BaseElement")&&fn(event)}}(0,_inherits2.default)(BpmnUpdater,_CommandInterceptor2.default),BpmnUpdater.$inject=["eventBus","bpmnFactory","connectionDocking","translate"],BpmnUpdater.prototype.updateAttachment=function(context){var shape=context.shape,businessObject=shape.businessObject,host=shape.host;businessObject.attachedToRef=host&&host.businessObject},BpmnUpdater.prototype.updateParent=function(element,oldParent){var parentShape,businessObject,parentBusinessObject,parentDi;element instanceof _model.Label||(0,_ModelUtil.is)(element,"bpmn:DataStoreReference")&&element.parent&&(0,_ModelUtil.is)(element.parent,"bpmn:Collaboration")||(parentShape=element.parent,businessObject=element.businessObject,parentDi=(parentBusinessObject=parentShape&&parentShape.businessObject)&&parentBusinessObject.di,(0,_ModelUtil.is)(element,"bpmn:FlowNode")&&this.updateFlowNodeRefs(businessObject,parentBusinessObject,oldParent&&oldParent.businessObject),(0,_ModelUtil.is)(element,"bpmn:DataOutputAssociation")&&(parentBusinessObject=element.source?element.source.businessObject:null),(0,_ModelUtil.is)(element,"bpmn:DataInputAssociation")&&(parentBusinessObject=element.target?element.target.businessObject:null),this.updateSemanticParent(businessObject,parentBusinessObject),(0,_ModelUtil.is)(element,"bpmn:DataObjectReference")&&businessObject.dataObjectRef&&this.updateSemanticParent(businessObject.dataObjectRef,parentBusinessObject),this.updateDiParent(businessObject.di,parentDi))},BpmnUpdater.prototype.updateBounds=function(shape){var di=shape.businessObject.di,target=shape instanceof _model.Label?this._getLabel(di):di,bounds=target.bounds;bounds||(bounds=this._bpmnFactory.createDiBounds(),target.set("bounds",bounds)),(0,_minDash.assign)(bounds,{x:shape.x,y:shape.y,width:shape.width,height:shape.height})},BpmnUpdater.prototype.updateFlowNodeRefs=function(businessObject,newContainment,oldContainment){var oldRefs,newRefs;oldContainment!==newContainment&&((0,_ModelUtil.is)(oldContainment,"bpmn:Lane")&&(oldRefs=oldContainment.get("flowNodeRef"),(0,_Collections.remove)(oldRefs,businessObject)),(0,_ModelUtil.is)(newContainment,"bpmn:Lane")&&(newRefs=newContainment.get("flowNodeRef"),(0,_Collections.add)(newRefs,businessObject)))},BpmnUpdater.prototype.updateDiConnection=function(di,newSource,newTarget){di.sourceElement&&di.sourceElement.bpmnElement!==newSource&&(di.sourceElement=newSource&&newSource.di),di.targetElement&&di.targetElement.bpmnElement!==newTarget&&(di.targetElement=newTarget&&newTarget.di)},BpmnUpdater.prototype.updateDiParent=function(di,parentDi){var planeElements;parentDi&&!(0,_ModelUtil.is)(parentDi,"bpmndi:BPMNPlane")&&(parentDi=parentDi.$parent),di.$parent!==parentDi&&(planeElements=(parentDi||di.$parent).get("planeElement"),parentDi?(planeElements.push(di),di.$parent=parentDi):((0,_Collections.remove)(planeElements,di),di.$parent=null))},BpmnUpdater.prototype.getLaneSet=function(container){var laneSet,laneSets;return(0,_ModelUtil.is)(container,"bpmn:Lane")?(laneSet=container.childLaneSet)||(laneSet=this._bpmnFactory.create("bpmn:LaneSet"),(container.childLaneSet=laneSet).$parent=container):((0,_ModelUtil.is)(container,"bpmn:Participant")&&(container=container.processRef),(laneSet=(laneSets=container.get("laneSets"))[0])||((laneSet=this._bpmnFactory.create("bpmn:LaneSet")).$parent=container,laneSets.push(laneSet))),laneSet},BpmnUpdater.prototype.updateSemanticParent=function(businessObject,newParent,visualParent){var containment,process,definitions,children,diChildren,translate=this._translate;if(businessObject.$parent!==newParent&&!(((0,_ModelUtil.is)(businessObject,"bpmn:DataInput")||(0,_ModelUtil.is)(businessObject,"bpmn:DataOutput"))&&((0,_ModelUtil.is)(newParent,"bpmn:Participant")&&"processRef"in newParent&&(newParent=newParent.processRef),"ioSpecification"in newParent&&newParent.ioSpecification===businessObject.$parent))){if((0,_ModelUtil.is)(businessObject,"bpmn:Lane"))newParent=newParent&&this.getLaneSet(newParent),containment="lanes";else if((0,_ModelUtil.is)(businessObject,"bpmn:FlowElement")){if(newParent)if((0,_ModelUtil.is)(newParent,"bpmn:Participant"))newParent=newParent.processRef;else if((0,_ModelUtil.is)(newParent,"bpmn:Lane"))for(;newParent=newParent.$parent.$parent,(0,_ModelUtil.is)(newParent,"bpmn:Lane"););containment="flowElements"}else if((0,_ModelUtil.is)(businessObject,"bpmn:Artifact")){for(;newParent&&!(0,_ModelUtil.is)(newParent,"bpmn:Process")&&!(0,_ModelUtil.is)(newParent,"bpmn:SubProcess")&&!(0,_ModelUtil.is)(newParent,"bpmn:Collaboration");){if((0,_ModelUtil.is)(newParent,"bpmn:Participant")){newParent=newParent.processRef;break}newParent=newParent.$parent}containment="artifacts"}else{(0,_ModelUtil.is)(businessObject,"bpmn:MessageFlow")?containment="messageFlows":(0,_ModelUtil.is)(businessObject,"bpmn:Participant")?(containment="participants",(process=businessObject.processRef)&&(definitions=function(element){for(;element&&!(0,_ModelUtil.is)(element,"bpmn:Definitions");)element=element.$parent;return element}(businessObject.$parent||newParent),businessObject.$parent&&((0,_Collections.remove)(definitions.get("rootElements"),process),process.$parent=null),newParent&&((0,_Collections.add)(definitions.get("rootElements"),process),process.$parent=definitions))):(0,_ModelUtil.is)(businessObject,"bpmn:DataOutputAssociation")?containment="dataOutputAssociations":(0,_ModelUtil.is)(businessObject,"bpmn:DataInputAssociation")&&(containment="dataInputAssociations")}if(!containment)throw new Error(translate("no parent for {element} in {parent}",{element:businessObject.id,parent:newParent.id}));businessObject.$parent&&(children=businessObject.$parent.get(containment),(0,_Collections.remove)(children,businessObject)),newParent?((children=newParent.get(containment)).push(businessObject),businessObject.$parent=newParent):businessObject.$parent=null,visualParent&&(diChildren=visualParent.get(containment),(0,_Collections.remove)(children,businessObject),newParent&&(diChildren||(diChildren=[],newParent.set(containment,diChildren)),diChildren.push(businessObject)))}},BpmnUpdater.prototype.updateConnectionWaypoints=function(connection){connection.businessObject.di.set("waypoint",this._bpmnFactory.createDiWaypoints(connection.waypoints))},BpmnUpdater.prototype.updateConnection=function(context){var visualParent,inverseSet,connection=context.connection,businessObject=(0,_ModelUtil.getBusinessObject)(connection),newSource=(0,_ModelUtil.getBusinessObject)(connection.source),newTarget=(0,_ModelUtil.getBusinessObject)(connection.target);(0,_ModelUtil.is)(businessObject,"bpmn:DataAssociation")?(0,_ModelUtil.is)(businessObject,"bpmn:DataInputAssociation")?(businessObject.get("sourceRef")[0]=newSource,visualParent=context.parent||context.newParent||newTarget,this.updateSemanticParent(businessObject,newTarget,visualParent)):(0,_ModelUtil.is)(businessObject,"bpmn:DataOutputAssociation")&&(visualParent=context.parent||context.newParent||newSource,this.updateSemanticParent(businessObject,newSource,visualParent),businessObject.targetRef=newTarget):(inverseSet=(0,_ModelUtil.is)(businessObject,"bpmn:SequenceFlow"),businessObject.sourceRef!==newSource&&(inverseSet&&((0,_Collections.remove)(businessObject.sourceRef&&businessObject.sourceRef.get("outgoing"),businessObject),newSource&&newSource.get("outgoing")&&newSource.get("outgoing").push(businessObject)),businessObject.sourceRef=newSource),businessObject.targetRef!==newTarget&&(inverseSet&&((0,_Collections.remove)(businessObject.targetRef&&businessObject.targetRef.get("incoming"),businessObject),newTarget&&newTarget.get("incoming")&&newTarget.get("incoming").push(businessObject)),businessObject.targetRef=newTarget)),this.updateConnectionWaypoints(connection),this.updateDiConnection(businessObject.di,newSource,newTarget)},BpmnUpdater.prototype._getLabel=function(di){return di.label||(di.label=this._bpmnFactory.createDiLabel()),di.label}},{"../../util/ModelUtil":177,"./util/ModelingUtil":148,"diagram-js/lib/command/CommandInterceptor":181,"diagram-js/lib/model":338,"diagram-js/lib/util/Collections":349,inherits:385,"min-dash":594}],95:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ElementFactory;var _minDash=require("min-dash"),_inherits2=_interopRequireDefault(require("inherits")),_ModelUtil=require("../../util/ModelUtil"),_DiUtil=require("../../util/DiUtil"),_ElementFactory2=_interopRequireDefault(require("diagram-js/lib/core/ElementFactory")),_LabelUtil=require("../../util/LabelUtil");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ElementFactory(bpmnFactory,moddle,translate){_ElementFactory2.default.call(this),this._bpmnFactory=bpmnFactory,this._moddle=moddle,this._translate=translate}function applyAttribute(element,attrs,attributeName){element[attributeName]=attrs[attributeName],delete attrs[attributeName]}(0,_inherits2.default)(ElementFactory,_ElementFactory2.default),ElementFactory.$inject=["bpmnFactory","moddle","translate"],ElementFactory.prototype.baseCreate=_ElementFactory2.default.prototype.create,ElementFactory.prototype.create=function(elementType,attrs){return"label"===elementType?this.baseCreate(elementType,(0,_minDash.assign)({type:"label"},_LabelUtil.DEFAULT_LABEL_SIZE,attrs)):this.createBpmnElement(elementType,attrs)},ElementFactory.prototype.createBpmnElement=function(elementType,attrs){var size,eventDefinitions,newEventDefinition,translate=this._translate,businessObject=(attrs=attrs||{}).businessObject;if(!businessObject){if(!attrs.type)throw new Error(translate("no shape type specified"));businessObject=this._bpmnFactory.create(attrs.type)}return businessObject.di||(businessObject.di="root"===elementType?this._bpmnFactory.createDiPlane(businessObject,[],{id:businessObject.id+"_di"}):"connection"===elementType?this._bpmnFactory.createDiEdge(businessObject,[],{id:businessObject.id+"_di"}):this._bpmnFactory.createDiShape(businessObject,{},{id:businessObject.id+"_di"})),(0,_ModelUtil.is)(businessObject,"bpmn:Group")&&(attrs=(0,_minDash.assign)({isFrame:!0},attrs)),attrs.di&&((0,_minDash.assign)(businessObject.di,attrs.di),delete attrs.di),function(element,attrs,attributeNames){(0,_minDash.forEach)(attributeNames,function(property){void 0!==attrs[property]&&applyAttribute(element,attrs,property)})}(businessObject,attrs,["processRef","isInterrupting","associationDirection","isForCompensation"]),attrs.isExpanded&&applyAttribute(businessObject.di,attrs,"isExpanded"),(0,_ModelUtil.is)(businessObject,"bpmn:ExclusiveGateway")&&(businessObject.di.isMarkerVisible=!0),attrs.eventDefinitionType&&(eventDefinitions=businessObject.get("eventDefinitions")||[],newEventDefinition=this._bpmnFactory.create(attrs.eventDefinitionType,attrs.eventDefinitionAttrs),"bpmn:ConditionalEventDefinition"===attrs.eventDefinitionType&&(newEventDefinition.condition=this._bpmnFactory.create("bpmn:FormalExpression")),eventDefinitions.push(newEventDefinition),(newEventDefinition.$parent=businessObject).eventDefinitions=eventDefinitions,delete attrs.eventDefinitionType),size=this._getDefaultSize(businessObject),attrs=(0,_minDash.assign)({businessObject:businessObject,id:businessObject.id},size,attrs),this.baseCreate(elementType,attrs)},ElementFactory.prototype._getDefaultSize=function(semantic){return(0,_ModelUtil.is)(semantic,"bpmn:SubProcess")?(0,_DiUtil.isExpanded)(semantic)?{width:350,height:200}:{width:100,height:80}:(0,_ModelUtil.is)(semantic,"bpmn:Task")?{width:100,height:80}:(0,_ModelUtil.is)(semantic,"bpmn:Gateway")?{width:50,height:50}:(0,_ModelUtil.is)(semantic,"bpmn:Event")?{width:36,height:36}:(0,_ModelUtil.is)(semantic,"bpmn:Participant")?(0,_DiUtil.isExpanded)(semantic)?{width:600,height:250}:{width:400,height:60}:(0,_ModelUtil.is)(semantic,"bpmn:Lane")?{width:400,height:100}:(0,_ModelUtil.is)(semantic,"bpmn:DataObjectReference")?{width:36,height:50}:(0,_ModelUtil.is)(semantic,"bpmn:DataStoreReference")?{width:50,height:50}:(0,_ModelUtil.is)(semantic,"bpmn:TextAnnotation")?{width:100,height:30}:(0,_ModelUtil.is)(semantic,"bpmn:Group")?{width:300,height:300}:{width:100,height:80}},ElementFactory.prototype.createParticipantShape=function(attrs){return(0,_minDash.isObject)(attrs)||(attrs={isExpanded:attrs}),!1!==(attrs=(0,_minDash.assign)({type:"bpmn:Participant"},attrs||{})).isExpanded&&(attrs.processRef=this._bpmnFactory.create("bpmn:Process")),this.createShape(attrs)}},{"../../util/DiUtil":175,"../../util/LabelUtil":176,"../../util/ModelUtil":177,"diagram-js/lib/core/ElementFactory":185,inherits:385,"min-dash":594}],96:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=Modeling;var _inherits2=_interopRequireDefault(require("inherits")),_Modeling2=_interopRequireDefault(require("diagram-js/lib/features/modeling/Modeling")),_UpdatePropertiesHandler2=_interopRequireDefault(require("./cmd/UpdatePropertiesHandler")),_UpdateCanvasRootHandler2=_interopRequireDefault(require("./cmd/UpdateCanvasRootHandler")),_AddLaneHandler2=_interopRequireDefault(require("./cmd/AddLaneHandler")),_SplitLaneHandler2=_interopRequireDefault(require("./cmd/SplitLaneHandler")),_ResizeLaneHandler2=_interopRequireDefault(require("./cmd/ResizeLaneHandler")),_UpdateFlowNodeRefsHandler2=_interopRequireDefault(require("./cmd/UpdateFlowNodeRefsHandler")),_IdClaimHandler2=_interopRequireDefault(require("./cmd/IdClaimHandler")),_SetColorHandler2=_interopRequireDefault(require("./cmd/SetColorHandler")),_UpdateLabelHandler2=_interopRequireDefault(require("../label-editing/cmd/UpdateLabelHandler"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function Modeling(eventBus,elementFactory,commandStack,bpmnRules){_Modeling2.default.call(this,eventBus,elementFactory,commandStack),this._bpmnRules=bpmnRules}(0,_inherits2.default)(Modeling,_Modeling2.default),Modeling.$inject=["eventBus","elementFactory","commandStack","bpmnRules"],Modeling.prototype.getHandlers=function(){var handlers=_Modeling2.default.prototype.getHandlers.call(this);return handlers["element.updateProperties"]=_UpdatePropertiesHandler2.default,handlers["canvas.updateRoot"]=_UpdateCanvasRootHandler2.default,handlers["lane.add"]=_AddLaneHandler2.default,handlers["lane.resize"]=_ResizeLaneHandler2.default,handlers["lane.split"]=_SplitLaneHandler2.default,handlers["lane.updateRefs"]=_UpdateFlowNodeRefsHandler2.default,handlers["id.updateClaim"]=_IdClaimHandler2.default,handlers["element.setColor"]=_SetColorHandler2.default,handlers["element.updateLabel"]=_UpdateLabelHandler2.default,handlers},Modeling.prototype.updateLabel=function(element,newLabel,newBounds,hints){this._commandStack.execute("element.updateLabel",{element:element,newLabel:newLabel,newBounds:newBounds,hints:hints||{}})},Modeling.prototype.connect=function(source,target,attrs,hints){var bpmnRules=this._bpmnRules;if(attrs=attrs||bpmnRules.canConnect(source,target))return this.createConnection(source,target,attrs,source.parent,hints)},Modeling.prototype.updateProperties=function(element,properties){this._commandStack.execute("element.updateProperties",{element:element,properties:properties})},Modeling.prototype.resizeLane=function(laneShape,newBounds,balanced){this._commandStack.execute("lane.resize",{shape:laneShape,newBounds:newBounds,balanced:balanced})},Modeling.prototype.addLane=function(targetLaneShape,location){var context={shape:targetLaneShape,location:location};return this._commandStack.execute("lane.add",context),context.newLane},Modeling.prototype.splitLane=function(targetLane,count){this._commandStack.execute("lane.split",{shape:targetLane,count:count})},Modeling.prototype.makeCollaboration=function(){var collaborationElement=this._create("root",{type:"bpmn:Collaboration"}),context={newRoot:collaborationElement};return this._commandStack.execute("canvas.updateRoot",context),collaborationElement},Modeling.prototype.updateLaneRefs=function(flowNodeShapes,laneShapes){this._commandStack.execute("lane.updateRefs",{flowNodeShapes:flowNodeShapes,laneShapes:laneShapes})},Modeling.prototype.makeProcess=function(){var context={newRoot:this._create("root",{type:"bpmn:Process"})};this._commandStack.execute("canvas.updateRoot",context)},Modeling.prototype.claimId=function(id,moddleElement){this._commandStack.execute("id.updateClaim",{id:id,element:moddleElement,claiming:!0})},Modeling.prototype.unclaimId=function(id,moddleElement){this._commandStack.execute("id.updateClaim",{id:id,element:moddleElement})},Modeling.prototype.setColor=function(elements,colors){elements.length||(elements=[elements]),this._commandStack.execute("element.setColor",{elements:elements,colors:colors})}},{"../label-editing/cmd/UpdateLabelHandler":90,"./cmd/AddLaneHandler":137,"./cmd/IdClaimHandler":138,"./cmd/ResizeLaneHandler":139,"./cmd/SetColorHandler":140,"./cmd/SplitLaneHandler":141,"./cmd/UpdateCanvasRootHandler":142,"./cmd/UpdateFlowNodeRefsHandler":143,"./cmd/UpdatePropertiesHandler":144,"diagram-js/lib/features/modeling/Modeling":258,inherits:385}],97:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=AdaptiveLabelPositioningBehavior;var _inherits2=_interopRequireDefault(require("inherits")),_LayoutUtil=require("diagram-js/lib/layout/LayoutUtil"),_Math=require("diagram-js/lib/util/Math"),_LabelUtil=require("../../../util/LabelUtil"),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ALIGNMENTS=["top","bottom","left","right"],ELEMENT_LABEL_DISTANCE=10;function AdaptiveLabelPositioningBehavior(eventBus,modeling){function checkLabelAdjustment(element){var optimalPosition;(0,_LabelUtil.hasExternalLabel)(element)&&(optimalPosition=function(element){var labelMid=(0,_LayoutUtil.getMid)(element.label),labelOrientation=getApproximateOrientation((0,_LayoutUtil.getMid)(element),labelMid);if(!function(orientation){return-1!==ALIGNMENTS.indexOf(orientation)}(labelOrientation))return;var takenAlignments=function(element){var elementMid=(0,_LayoutUtil.getMid)(element);return[].concat(element.incoming.map(function(c){return c.waypoints[c.waypoints.length-2]}),element.outgoing.map(function(c){return c.waypoints[1]})).map(function(point){return getApproximateOrientation(elementMid,point)})}(element);{var takenHostAlignments;element.host&&(takenHostAlignments=function(element){var freeAlignments,hostElement=element.host,elementMid=(0,_LayoutUtil.getMid)(element),hostOrientation=(0,_LayoutUtil.getOrientation)(elementMid,hostElement);freeAlignments=0<=hostOrientation.indexOf("-")?hostOrientation.split("-"):[hostOrientation];return ALIGNMENTS.filter(function(alignment){return-1===freeAlignments.indexOf(alignment)})}(element),takenAlignments=takenAlignments.concat(takenHostAlignments))}var freeAlignments=ALIGNMENTS.filter(function(alignment){return-1===takenAlignments.indexOf(alignment)});return-1===freeAlignments.indexOf(labelOrientation)?freeAlignments[0]:void 0}(element))&&function(element,orientation){var elementMid=(0,_LayoutUtil.getMid)(element),label=element.label,labelMid=(0,_LayoutUtil.getMid)(label);if(!label.parent)return;var newLabelMid,elementTrbl=(0,_LayoutUtil.asTRBL)(element);switch(orientation){case"top":newLabelMid={x:elementMid.x,y:elementTrbl.top-ELEMENT_LABEL_DISTANCE-label.height/2};break;case"left":newLabelMid={x:elementTrbl.left-ELEMENT_LABEL_DISTANCE-label.width/2,y:elementMid.y};break;case"bottom":newLabelMid={x:elementMid.x,y:elementTrbl.bottom+ELEMENT_LABEL_DISTANCE+label.height/2};break;case"right":newLabelMid={x:elementTrbl.right+ELEMENT_LABEL_DISTANCE+label.width/2,y:elementMid.y}}var delta=(0,_Math.substract)(newLabelMid,labelMid);modeling.moveShape(label,delta)}(element,optimalPosition)}_CommandInterceptor2.default.call(this,eventBus),this.postExecuted(["connection.create","connection.layout","connection.updateWaypoints"],function(event){var context=event.context,connection=context.connection,source=connection.source,target=connection.target;!1!==(context.hints||{}).createElementsBehavior&&(checkLabelAdjustment(source),checkLabelAdjustment(target))}),this.postExecuted(["label.create"],function(event){var context=event.context,shape=context.shape;!1!==(context.hints||{}).createElementsBehavior&&checkLabelAdjustment(shape.labelTarget)}),this.postExecuted(["elements.create"],function(event){var context=event.context,elements=context.elements;!1!==(context.hints||{}).createElementsBehavior&&elements.forEach(function(element){checkLabelAdjustment(element)})})}function getApproximateOrientation(p0,p1){return(0,_LayoutUtil.getOrientation)(p1,p0,5)}(0,_inherits2.default)(AdaptiveLabelPositioningBehavior,_CommandInterceptor2.default),AdaptiveLabelPositioningBehavior.$inject=["eventBus","modeling"]},{"../../../util/LabelUtil":176,"diagram-js/lib/command/CommandInterceptor":181,"diagram-js/lib/layout/LayoutUtil":336,"diagram-js/lib/util/Math":358,inherits:385}],98:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=AppendBehavior;var _inherits2=_interopRequireDefault(require("inherits")),_ModelUtil=require("../../../util/ModelUtil"),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function AppendBehavior(eventBus,elementFactory,bpmnRules){_CommandInterceptor2.default.call(this,eventBus),this.preExecute("shape.append",function(context){var source=context.source,shape=context.shape;context.position||((0,_ModelUtil.is)(shape,"bpmn:TextAnnotation")?context.position={x:source.x+source.width/2+75,y:source.y-50-shape.height/2}:context.position={x:source.x+source.width+80+shape.width/2,y:source.y+source.height/2})},!0)}(0,_inherits2.default)(AppendBehavior,_CommandInterceptor2.default),AppendBehavior.$inject=["eventBus","elementFactory","bpmnRules"]},{"../../../util/ModelUtil":177,"diagram-js/lib/command/CommandInterceptor":181,inherits:385}],99:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=AssociationBehavior;var _inherits2=_interopRequireDefault(require("inherits")),_ModelUtil=require("../../../util/ModelUtil"),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_minDash=require("min-dash");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function AssociationBehavior(injector,modeling){injector.invoke(_CommandInterceptor2.default,this),this.postExecute("shape.move",function(context){var newParent=context.newParent,shape=context.shape,associations=(0,_minDash.filter)(shape.incoming.concat(shape.outgoing),function(connection){return(0,_ModelUtil.is)(connection,"bpmn:Association")});(0,_minDash.forEach)(associations,function(association){modeling.moveConnection(association,{x:0,y:0},newParent)})},!0)}(0,_inherits2.default)(AssociationBehavior,_CommandInterceptor2.default),AssociationBehavior.$inject=["injector","modeling"]},{"../../../util/ModelUtil":177,"diagram-js/lib/command/CommandInterceptor":181,inherits:385,"min-dash":594}],100:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=AttachEventBehavior;var _inherits2=_interopRequireDefault(require("inherits")),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_ModelUtil=require("../../../util/ModelUtil"),_ModelingUtil=require("../util/ModelingUtil"),_LabelUtil=require("../../../util/LabelUtil");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var LOW_PRIORITY=500;function AttachEventBehavior(bpmnReplace,injector){injector.invoke(_CommandInterceptor2.default,this),this._bpmnReplace=bpmnReplace;var self=this;this.postExecuted("elements.create",LOW_PRIORITY,function(context){var elements=context.elements;1===(elements=elements.filter(function(shape){return shouldReplace(shape,shape.host)})).length&&elements.map(function(element){return elements.indexOf(element)}).forEach(function(index){var host=elements[index];context.elements[index]=self.replaceShape(elements[index],host)})},!0),this.preExecute("elements.move",LOW_PRIORITY,function(context){var shape,shapes=context.shapes,host=context.newHost;1!==shapes.length||shouldReplace(shape=shapes[0],host)&&(context.shapes=[self.replaceShape(shape,host)])},!0)}function shouldReplace(shape,host){return!(0,_LabelUtil.isLabel)(shape)&&(0,_ModelingUtil.isAny)(shape,["bpmn:IntermediateThrowEvent","bpmn:IntermediateCatchEvent"])&&!!host}AttachEventBehavior.$inject=["bpmnReplace","injector"],(0,_inherits2.default)(AttachEventBehavior,_CommandInterceptor2.default),AttachEventBehavior.prototype.replaceShape=function(shape,host){var element,eventDefinitions,eventDefinition=(element=shape,(eventDefinitions=(0,_ModelUtil.getBusinessObject)(element).eventDefinitions)&&eventDefinitions[0]),boundaryEvent={type:"bpmn:BoundaryEvent",host:host};return eventDefinition&&(boundaryEvent.eventDefinitionType=eventDefinition.$type),this._bpmnReplace.replaceElement(shape,boundaryEvent,{layoutConnection:!1})}},{"../../../util/LabelUtil":176,"../../../util/ModelUtil":177,"../util/ModelingUtil":148,"diagram-js/lib/command/CommandInterceptor":181,inherits:385}],101:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BoundaryEventBehavior;var _inherits2=_interopRequireDefault(require("inherits")),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_ModelUtil=require("../../../util/ModelUtil"),_minDash=require("min-dash");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function BoundaryEventBehavior(eventBus,modeling){function getBoundaryEvents(element){return(0,_minDash.filter)(element.attachers,function(attacher){return(0,_ModelUtil.is)(attacher,"bpmn:BoundaryEvent")})}_CommandInterceptor2.default.call(this,eventBus),this.postExecute("connection.create",function(event){var source=event.context.source,target=event.context.target,boundaryEvents=getBoundaryEvents(target);(0,_ModelUtil.is)(source,"bpmn:EventBasedGateway")&&(0,_ModelUtil.is)(target,"bpmn:ReceiveTask")&&0<boundaryEvents.length&&modeling.removeElements(boundaryEvents)}),this.postExecute("connection.reconnect",function(event){var oldSource=event.context.oldSource,newSource=event.context.newSource;(0,_ModelUtil.is)(oldSource,"bpmn:Gateway")&&(0,_ModelUtil.is)(newSource,"bpmn:EventBasedGateway")&&(0,_minDash.forEach)(newSource.outgoing,function(connection){var target=connection.target,attachedboundaryEvents=getBoundaryEvents(target);(0,_ModelUtil.is)(target,"bpmn:ReceiveTask")&&0<attachedboundaryEvents.length&&modeling.removeElements(attachedboundaryEvents)})})}BoundaryEventBehavior.$inject=["eventBus","modeling"],(0,_inherits2.default)(BoundaryEventBehavior,_CommandInterceptor2.default)},{"../../../util/ModelUtil":177,"diagram-js/lib/command/CommandInterceptor":181,inherits:385,"min-dash":594}],102:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=CreateBehavior;var _inherits2=_interopRequireDefault(require("inherits")),_ModelUtil=require("../../../util/ModelUtil"),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_ModelingUtil=require("../util/ModelingUtil");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function CreateBehavior(injector){injector.invoke(_CommandInterceptor2.default,this),this.preExecute("shape.create",1500,function(event){var context=event.context,parent=context.parent,shape=context.shape;(0,_ModelUtil.is)(parent,"bpmn:Lane")&&!(0,_ModelUtil.is)(shape,"bpmn:Lane")&&(context.parent=(0,_ModelingUtil.getParent)(parent,"bpmn:Participant"))})}CreateBehavior.$inject=["injector"],(0,_inherits2.default)(CreateBehavior,_CommandInterceptor2.default)},{"../../../util/ModelUtil":177,"../util/ModelingUtil":148,"diagram-js/lib/command/CommandInterceptor":181,inherits:385}],103:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=CreateDataObjectBehavior;var _inherits2=_interopRequireDefault(require("inherits")),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_ModelUtil=require("../../../util/ModelUtil");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function CreateDataObjectBehavior(eventBus,bpmnFactory,moddle){_CommandInterceptor2.default.call(this,eventBus),this.preExecute("shape.create",function(event){var dataObject,shape=event.context.shape;(0,_ModelUtil.is)(shape,"bpmn:DataObjectReference")&&"label"!==shape.type&&(dataObject=bpmnFactory.create("bpmn:DataObject"),shape.businessObject.dataObjectRef=dataObject)})}CreateDataObjectBehavior.$inject=["eventBus","bpmnFactory","moddle"],(0,_inherits2.default)(CreateDataObjectBehavior,_CommandInterceptor2.default)},{"../../../util/ModelUtil":177,"diagram-js/lib/command/CommandInterceptor":181,inherits:385}],104:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PARTICIPANT_BORDER_WIDTH=void 0,exports.default=CreateParticipantBehavior;var _inherits2=_interopRequireDefault(require("inherits")),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_ModelUtil=require("../../../util/ModelUtil"),_LabelUtil=require("../../../util/LabelUtil"),_Elements=require("diagram-js/lib/util/Elements"),_minDash=require("min-dash"),_LayoutUtil=require("diagram-js/lib/layout/LayoutUtil");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var HORIZONTAL_PARTICIPANT_PADDING=20,VERTICAL_PARTICIPANT_PADDING=20,PARTICIPANT_BORDER_WIDTH=exports.PARTICIPANT_BORDER_WIDTH=30,HIGH_PRIORITY=2e3;function CreateParticipantBehavior(canvas,eventBus,modeling){function ensureCollaboration(context){var collaboration,parent=context.parent,rootElement=canvas.getRootElement();(0,_ModelUtil.is)(rootElement,"bpmn:Collaboration")?collaboration=rootElement:(collaboration=modeling.makeCollaboration(),context.process=parent),context.parent=collaboration}_CommandInterceptor2.default.call(this,eventBus),eventBus.on(["create.start","shape.move.start"],HIGH_PRIORITY,function(event){var children,childrenBBox,participantBounds,context=event.context,shape=context.shape,rootElement=canvas.getRootElement();(0,_ModelUtil.is)(shape,"bpmn:Participant")&&(0,_ModelUtil.is)(rootElement,"bpmn:Process")&&rootElement.children.length&&((children=rootElement.children.filter(function(element){return!(0,_ModelUtil.is)(element,"bpmn:Group")&&!(0,_LabelUtil.isLabel)(element)&&!element.waypoints})).length&&(participantBounds=function(shape,childrenBBox){childrenBBox={width:childrenBBox.width+2*HORIZONTAL_PARTICIPANT_PADDING+PARTICIPANT_BORDER_WIDTH,height:childrenBBox.height+2*VERTICAL_PARTICIPANT_PADDING};var width=Math.max(shape.width,childrenBBox.width),height=Math.max(shape.height,childrenBBox.height);return{x:-width/2,y:-height/2,width:width,height:height}}(shape,childrenBBox=(0,_Elements.getBBox)(children)),(0,_minDash.assign)(shape,participantBounds),context.createConstraints=function(shape,childrenBBox){return{bottom:(childrenBBox=(0,_LayoutUtil.asTRBL)(childrenBBox)).top+shape.height/2-VERTICAL_PARTICIPANT_PADDING,left:childrenBBox.right-shape.width/2+HORIZONTAL_PARTICIPANT_PADDING,top:childrenBBox.bottom-shape.height/2+VERTICAL_PARTICIPANT_PADDING,right:childrenBBox.left+shape.width/2-HORIZONTAL_PARTICIPANT_PADDING-PARTICIPANT_BORDER_WIDTH}}(shape,childrenBBox)))}),eventBus.on("create.start",HIGH_PRIORITY,function(event){var shape=event.context.shape,rootElement=canvas.getRootElement(),rootElementGfx=canvas.getGraphics(rootElement);function ensureHoveringProcess(event){event.element=rootElement,event.gfx=rootElementGfx}(0,_ModelUtil.is)(shape,"bpmn:Participant")&&(0,_ModelUtil.is)(rootElement,"bpmn:Process")&&(eventBus.on("element.hover",HIGH_PRIORITY,ensureHoveringProcess),eventBus.once("create.cleanup",function(){eventBus.off("element.hover",ensureHoveringProcess)}))}),this.preExecute("shape.create",function(context){var parent=context.parent,shape=context.shape;(0,_ModelUtil.is)(shape,"bpmn:Participant")&&(0,_ModelUtil.is)(parent,"bpmn:Process")&&ensureCollaboration(context)},!0),this.execute("shape.create",function(context){var process=context.process,shape=context.shape;process&&(context.oldProcessRef=shape.businessObject.processRef,shape.businessObject.processRef=process.businessObject)},!0),this.revert("shape.create",function(context){var process=context.process,shape=context.shape;process&&(shape.businessObject.processRef=context.oldProcessRef)},!0),this.postExecute("shape.create",function(context){var processChildren,process=context.process,shape=context.shape;process&&(processChildren=process.children.slice(),modeling.moveElements(processChildren,{x:0,y:0},shape))},!0),this.preExecute("elements.create",HIGH_PRIORITY,function(context){var participant,elements=context.elements,parent=context.parent;findParticipant(elements)&&(0,_ModelUtil.is)(parent,"bpmn:Process")&&(ensureCollaboration(context),participant=findParticipant(elements),context.oldProcessRef=participant.businessObject.processRef,participant.businessObject.processRef=parent.businessObject)},!0),this.revert("elements.create",function(context){var elements=context.elements;context.process&&(findParticipant(elements).businessObject.processRef=context.oldProcessRef)},!0),this.postExecute("elements.create",function(context){var participant,processChildren,elements=context.elements,process=context.process;process&&(participant=findParticipant(elements),processChildren=process.children.slice(),modeling.moveElements(processChildren,{x:0,y:0},participant))},!0)}function findParticipant(elements){return(0,_minDash.find)(elements,function(element){return(0,_ModelUtil.is)(element,"bpmn:Participant")})}CreateParticipantBehavior.$inject=["canvas","eventBus","modeling"],(0,_inherits2.default)(CreateParticipantBehavior,_CommandInterceptor2.default)},{"../../../util/LabelUtil":176,"../../../util/ModelUtil":177,"diagram-js/lib/command/CommandInterceptor":181,"diagram-js/lib/layout/LayoutUtil":336,"diagram-js/lib/util/Elements":351,inherits:385,"min-dash":594}],105:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=DataInputAssociationBehavior;var _inherits2=_interopRequireDefault(require("inherits")),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_Collections=require("diagram-js/lib/util/Collections"),_minDash=require("min-dash"),_ModelUtil=require("../../../util/ModelUtil");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var TARGET_REF_PLACEHOLDER_NAME="__targetRef_placeholder";function DataInputAssociationBehavior(eventBus,bpmnFactory){function getTargetRef(element,create){var properties=element.get("properties"),targetRefProp=(0,_minDash.find)(properties,function(p){return p.name===TARGET_REF_PLACEHOLDER_NAME});return!targetRefProp&&create&&(targetRefProp=bpmnFactory.create("bpmn:Property",{name:TARGET_REF_PLACEHOLDER_NAME}),(0,_Collections.add)(properties,targetRefProp)),targetRefProp}function cleanupTargetRef(element,connection){var targetRefProp=getTargetRef(element);targetRefProp&&!function(element,targetRef,removedConnection){var inputAssociations=element.get("dataInputAssociations");return(0,_minDash.find)(inputAssociations,function(association){return association!==removedConnection&&association.targetRef===targetRef})}(element,targetRefProp,connection)&&(0,_Collections.remove)(element.get("properties"),targetRefProp)}function fixTargetRef(event){var targetRefProp,context=event.context,connection=context.connection,connectionBo=connection.businessObject,target=connection.target,targetBo=target&&target.businessObject,newTarget=context.newTarget,newTargetBo=newTarget&&newTarget.businessObject,oldTarget=context.oldTarget||context.target,oldTargetBo=oldTarget&&oldTarget.businessObject,dataAssociation=connection.businessObject;oldTargetBo&&oldTargetBo!==targetBo&&cleanupTargetRef(oldTargetBo,connectionBo),newTargetBo&&newTargetBo!==targetBo&&cleanupTargetRef(newTargetBo,connectionBo),targetBo?(targetRefProp=getTargetRef(targetBo,!0),dataAssociation.targetRef=targetRefProp):dataAssociation.targetRef=null}_CommandInterceptor2.default.call(this,eventBus),this.executed(["connection.create","connection.delete","connection.move","connection.reconnect"],ifDataInputAssociation(fixTargetRef)),this.reverted(["connection.create","connection.delete","connection.move","connection.reconnect"],ifDataInputAssociation(fixTargetRef))}function ifDataInputAssociation(fn){return function(event){var connection=event.context.connection;if((0,_ModelUtil.is)(connection,"bpmn:DataInputAssociation"))return fn(event)}}DataInputAssociationBehavior.$inject=["eventBus","bpmnFactory"],(0,_inherits2.default)(DataInputAssociationBehavior,_CommandInterceptor2.default)},{"../../../util/ModelUtil":177,"diagram-js/lib/command/CommandInterceptor":181,"diagram-js/lib/util/Collections":349,inherits:385,"min-dash":594}],106:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=DataStoreBehavior;var _inherits2=_interopRequireDefault(require("inherits")),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_ModelUtil=require("../../../util/ModelUtil"),_ModelingUtil=require("../util/ModelingUtil"),_UpdateSemanticParentHandler2=_interopRequireDefault(require("../cmd/UpdateSemanticParentHandler"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function DataStoreBehavior(canvas,commandStack,elementRegistry,eventBus){function getDataStores(element){return element.children.filter(function(child){return(0,_ModelUtil.is)(child,"bpmn:DataStoreReference")&&!child.labelTarget})}function updateDataStoreParent(dataStore,newDataStoreParent){var newDataStoreParentBo,dataStoreBo=dataStore.businessObject||dataStore;(newDataStoreParent=newDataStoreParent||elementRegistry.filter(function(element){return(0,_ModelUtil.is)(element,"bpmn:Participant")})[0])&&(newDataStoreParentBo=newDataStoreParent.businessObject||newDataStoreParent,commandStack.execute("dataStore.updateContainment",{dataStoreBo:dataStoreBo,newSemanticParent:newDataStoreParentBo.processRef||newDataStoreParentBo,newDiParent:newDataStoreParentBo.di}))}_CommandInterceptor2.default.call(this,eventBus),commandStack.registerHandler("dataStore.updateContainment",_UpdateSemanticParentHandler2.default),this.preExecute("shape.create",function(event){var context=event.context,shape=context.shape;(0,_ModelUtil.is)(shape,"bpmn:DataStoreReference")&&"label"!==shape.type&&(context.hints||(context.hints={}),context.hints.autoResize=!1)}),this.preExecute("elements.move",function(event){var context=event.context,shapes=context.shapes;shapes.filter(function(shape){return(0,_ModelUtil.is)(shape,"bpmn:DataStoreReference")}).length&&(context.hints||(context.hints={}),context.hints.autoResize=shapes.filter(function(shape){return!(0,_ModelUtil.is)(shape,"bpmn:DataStoreReference")}))}),this.postExecute("shape.create",function(event){var shape=event.context.shape,parent=shape.parent;(0,_ModelUtil.is)(shape,"bpmn:DataStoreReference")&&"label"!==shape.type&&(0,_ModelUtil.is)(parent,"bpmn:Collaboration")&&updateDataStoreParent(shape)}),this.postExecute("shape.move",function(event){var context=event.context,shape=context.shape,oldParent=context.oldParent,parent=shape.parent;(0,_ModelUtil.is)(oldParent,"bpmn:Collaboration")||(0,_ModelUtil.is)(shape,"bpmn:DataStoreReference")&&"label"!==shape.type&&(0,_ModelUtil.is)(parent,"bpmn:Collaboration")&&updateDataStoreParent(shape,(0,_ModelUtil.is)(oldParent,"bpmn:Participant")?oldParent:function(element,type){for(;element.parent;){if((0,_ModelUtil.is)(element.parent,type))return element.parent;element=element.parent}}(oldParent,"bpmn:Participant"))}),this.postExecute("shape.delete",function(event){var shape=event.context.shape,rootElement=canvas.getRootElement();(0,_ModelingUtil.isAny)(shape,["bpmn:Participant","bpmn:SubProcess"])&&(0,_ModelUtil.is)(rootElement,"bpmn:Collaboration")&&getDataStores(rootElement).filter(function(dataStore){return function(descendant,ancestor){var descendantBo=descendant.businessObject||descendant,ancestorBo=ancestor.businessObject||ancestor;for(;descendantBo.$parent;){if(descendantBo.$parent===ancestorBo.processRef||ancestorBo)return!0;descendantBo=descendantBo.$parent}return!1}(dataStore,shape)}).forEach(function(dataStore){updateDataStoreParent(dataStore)})}),this.postExecute("canvas.updateRoot",function(event){var context=event.context,oldRoot=context.oldRoot,newRoot=context.newRoot;getDataStores(oldRoot).forEach(function(dataStore){(0,_ModelUtil.is)(newRoot,"bpmn:Process")&&updateDataStoreParent(dataStore,newRoot)})})}DataStoreBehavior.$inject=["canvas","commandStack","elementRegistry","eventBus"],(0,_inherits2.default)(DataStoreBehavior,_CommandInterceptor2.default)},{"../../../util/ModelUtil":177,"../cmd/UpdateSemanticParentHandler":145,"../util/ModelingUtil":148,"diagram-js/lib/command/CommandInterceptor":181,inherits:385}],107:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=DeleteLaneBehavior;var _inherits2=_interopRequireDefault(require("inherits")),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_ModelUtil=require("../../../util/ModelUtil"),_LaneUtil=require("../util/LaneUtil"),_Elements=require("diagram-js/lib/util/Elements");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var LOW_PRIORITY=500;function DeleteLaneBehavior(eventBus,modeling,spaceTool){_CommandInterceptor2.default.call(this,eventBus),this.postExecuted("shape.delete",LOW_PRIORITY,function(event){var context=event.context,hints=context.hints,shape=context.shape,oldParent=context.oldParent;(0,_ModelUtil.is)(shape,"bpmn:Lane")&&(hints&&hints.nested||function(shape,oldParent){var topAdjustments,bottomAdjustments,offset,siblings=(0,_LaneUtil.getChildLanes)(oldParent),topAffected=[],bottomAffected=[];(0,_Elements.eachElement)(siblings,function(element){return element.y>shape.y?bottomAffected.push(element):topAffected.push(element),element.children}),siblings.length&&(offset=bottomAffected.length&&topAffected.length?shape.height/2:shape.height,topAffected.length&&(topAdjustments=spaceTool.calculateAdjustments(topAffected,"y",offset,shape.y-10),spaceTool.makeSpace(topAdjustments.movingShapes,topAdjustments.resizingShapes,{x:0,y:offset},"s")),bottomAffected.length&&(bottomAdjustments=spaceTool.calculateAdjustments(bottomAffected,"y",-offset,shape.y+shape.height+10),spaceTool.makeSpace(bottomAdjustments.movingShapes,bottomAdjustments.resizingShapes,{x:0,y:-offset},"n")))}(shape,oldParent))})}DeleteLaneBehavior.$inject=["eventBus","modeling","spaceTool"],(0,_inherits2.default)(DeleteLaneBehavior,_CommandInterceptor2.default)},{"../../../util/ModelUtil":177,"../util/LaneUtil":147,"diagram-js/lib/command/CommandInterceptor":181,"diagram-js/lib/util/Elements":351,inherits:385}],108:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=DetachEventBehavior;var _inherits2=_interopRequireDefault(require("inherits")),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_ModelUtil=require("../../../util/ModelUtil"),_LabelUtil=require("../../../util/LabelUtil");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var LOW_PRIORITY=500;function DetachEventBehavior(bpmnReplace,injector){injector.invoke(_CommandInterceptor2.default,this),this._bpmnReplace=bpmnReplace;var self=this;this.postExecuted("elements.create",LOW_PRIORITY,function(context){var elements=context.elements;elements.filter(function(shape){return shouldReplace(shape,shape.host)}).map(function(shape){return elements.indexOf(shape)}).forEach(function(index){context.elements[index]=self.replaceShape(elements[index])})},!0),this.preExecute("elements.move",LOW_PRIORITY,function(context){var shapes=context.shapes,newHost=context.newHost;shapes.forEach(function(shape,index){var item,host=shape.host;shouldReplace(shape,(item=host,-1!==shapes.indexOf(item)?host:newHost))&&(shapes[index]=self.replaceShape(shape))})},!0)}function shouldReplace(shape,host){return!(0,_LabelUtil.isLabel)(shape)&&(0,_ModelUtil.is)(shape,"bpmn:BoundaryEvent")&&!host}DetachEventBehavior.$inject=["bpmnReplace","injector"],(0,_inherits2.default)(DetachEventBehavior,_CommandInterceptor2.default),DetachEventBehavior.prototype.replaceShape=function(shape){var element,eventDefinitions,eventDefinition=(element=shape,(eventDefinitions=(0,_ModelUtil.getBusinessObject)(element).eventDefinitions)&&eventDefinitions[0]),intermediateEvent=eventDefinition?{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:eventDefinition.$type}:{type:"bpmn:IntermediateThrowEvent"};return this._bpmnReplace.replaceElement(shape,intermediateEvent,{layoutConnection:!1})}},{"../../../util/LabelUtil":176,"../../../util/ModelUtil":177,"diagram-js/lib/command/CommandInterceptor":181,inherits:385}],109:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=DropOnFlowBehavior;var _inherits2=_interopRequireDefault(require("inherits")),_minDash=require("min-dash"),_LayoutUtil=require("diagram-js/lib/layout/LayoutUtil"),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_LineIntersection=require("diagram-js/lib/util/LineIntersection");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function DropOnFlowBehavior(eventBus,bpmnRules,modeling){function insertShape(shape,targetFlow,positionOrBounds){var waypointsBefore,waypointsAfter,dockingPoint,source,target,incomingConnection,outgoingConnection,waypoints=targetFlow.waypoints,oldOutgoing=shape.outgoing.slice(),oldIncoming=shape.incoming.slice(),mid=(0,_minDash.isNumber)(positionOrBounds.width)?(0,_LayoutUtil.getMid)(positionOrBounds):positionOrBounds,intersection=(0,_LineIntersection.getApproxIntersection)(waypoints,mid);if(intersection){if(waypointsBefore=waypoints.slice(0,intersection.index),waypointsAfter=waypoints.slice(intersection.index+(intersection.bendpoint?1:0)),!waypointsBefore.length||!waypointsAfter.length)return;dockingPoint=intersection.bendpoint?waypoints[intersection.index]:mid,isPointInsideBBox(shape,waypointsBefore[waypointsBefore.length-1])||waypointsBefore.push(copy(dockingPoint)),isPointInsideBBox(shape,waypointsAfter[0])||waypointsAfter.unshift(copy(dockingPoint))}source=targetFlow.source,target=targetFlow.target,bpmnRules.canConnect(source,shape,targetFlow)&&(modeling.reconnectEnd(targetFlow,shape,waypointsBefore||mid),incomingConnection=targetFlow),bpmnRules.canConnect(shape,target,targetFlow)&&(outgoingConnection=incomingConnection?modeling.connect(shape,target,{type:targetFlow.type,waypoints:waypointsAfter}):(modeling.reconnectStart(targetFlow,shape,waypointsAfter||mid),targetFlow));var duplicateConnections=[].concat(incomingConnection&&(0,_minDash.filter)(oldIncoming,function(connection){return connection.source===incomingConnection.source})||[],outgoingConnection&&(0,_minDash.filter)(oldOutgoing,function(connection){return connection.target===outgoingConnection.target})||[]);duplicateConnections.length&&modeling.removeElements(duplicateConnections)}_CommandInterceptor2.default.call(this,eventBus),this.preExecute("elements.move",function(context){var shapeMid,newShapeMid,connection,newParent=context.newParent,shapes=context.shapes,delta=context.delta,shape=shapes[0];shape&&newParent&&(newParent&&newParent.waypoints&&(context.newParent=newParent=newParent.parent),shapeMid=(0,_LayoutUtil.getMid)(shape),newShapeMid={x:shapeMid.x+delta.x,y:shapeMid.y+delta.y},(connection=(0,_minDash.find)(newParent.children,function(element){return bpmnRules.canInsert(shapes,element)&&(0,_LineIntersection.getApproxIntersection)(element.waypoints,newShapeMid)}))&&(context.targetFlow=connection,context.position=newShapeMid))},!0),this.postExecuted("elements.move",function(context){var shapes=context.shapes,targetFlow=context.targetFlow,position=context.position;targetFlow&&insertShape(shapes[0],targetFlow,position)},!0),this.preExecute("shape.create",function(context){var parent=context.parent,shape=context.shape;bpmnRules.canInsert(shape,parent)&&(context.targetFlow=parent,context.parent=parent.parent)},!0),this.postExecuted("shape.create",function(context){var shape=context.shape,targetFlow=context.targetFlow,positionOrBounds=context.position;targetFlow&&insertShape(shape,targetFlow,positionOrBounds)},!0)}function isPointInsideBBox(bbox,point){var x=point.x,y=point.y;return x>=bbox.x&&x<=bbox.x+bbox.width&&y>=bbox.y&&y<=bbox.y+bbox.height}function copy(obj){return(0,_minDash.assign)({},obj)}(0,_inherits2.default)(DropOnFlowBehavior,_CommandInterceptor2.default),DropOnFlowBehavior.$inject=["eventBus","bpmnRules","modeling"]},{"diagram-js/lib/command/CommandInterceptor":181,"diagram-js/lib/layout/LayoutUtil":336,"diagram-js/lib/util/LineIntersection":357,inherits:385,"min-dash":594}],110:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=EventBasedGatewayBehavior;var _inherits2=_interopRequireDefault(require("inherits")),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_ModelUtil=require("../../../util/ModelUtil");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function EventBasedGatewayBehavior(eventBus,modeling){_CommandInterceptor2.default.call(this,eventBus),this.preExecuted("connection.create",function(event){var context=event.context,source=context.source,target=context.target,existingIncomingConnections=target.incoming.slice();context.hints&&!1===context.hints.createElementsBehavior||(0,_ModelUtil.is)(source,"bpmn:EventBasedGateway")&&target.incoming.length&&existingIncomingConnections.filter(isSequenceFlow).forEach(function(sequenceFlow){modeling.removeConnection(sequenceFlow)})}),this.preExecuted("shape.replace",function(event){var newShape=event.context.newShape;(0,_ModelUtil.is)(newShape,"bpmn:EventBasedGateway")&&newShape.outgoing.filter(isSequenceFlow).map(function(sequenceFlow){return sequenceFlow.target}).reduce(function(sequenceFlows,target){var incomingSequenceFlows=target.incoming.filter(isSequenceFlow);return sequenceFlows.concat(incomingSequenceFlows)},[]).forEach(function(sequenceFlow){sequenceFlow.source!==newShape&&modeling.removeConnection(sequenceFlow)})})}function isSequenceFlow(connection){return(0,_ModelUtil.is)(connection,"bpmn:SequenceFlow")}EventBasedGatewayBehavior.$inject=["eventBus","modeling"],(0,_inherits2.default)(EventBasedGatewayBehavior,_CommandInterceptor2.default)},{"../../../util/ModelUtil":177,"diagram-js/lib/command/CommandInterceptor":181,inherits:385}],111:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=FixHoverBehavior;var _LaneUtil=require("../util/LaneUtil"),_ModelUtil=require("../../../util/ModelUtil"),_ModelingUtil=require("../util/ModelingUtil"),HIGH_PRIORITY=1500,HIGHEST_PRIORITY=2e3;function FixHoverBehavior(elementRegistry,eventBus,canvas){eventBus.on(["create.hover","create.move","create.end","shape.move.hover","shape.move.move","shape.move.end"],HIGH_PRIORITY,function(event){var shape=event.context.shape||event.shape,hover=event.hover;(0,_ModelUtil.is)(hover,"bpmn:Lane")&&!(0,_ModelingUtil.isAny)(shape,["bpmn:Lane","bpmn:Participant"])&&(event.hover=(0,_LaneUtil.getLanesRoot)(hover),event.hoverGfx=elementRegistry.getGraphics(event.hover));var rootElement=canvas.getRootElement();hover!==rootElement&&(shape.labelTarget||(0,_ModelUtil.is)(shape,"bpmn:Group"))&&(event.hover=rootElement,event.hoverGfx=elementRegistry.getGraphics(event.hover))}),eventBus.on(["connect.hover","connect.out","connect.end","connect.cleanup","global-connect.hover","global-connect.out","global-connect.end","global-connect.cleanup"],HIGH_PRIORITY,function(event){var hover=event.hover;(0,_ModelUtil.is)(hover,"bpmn:Lane")&&(event.hover=(0,_LaneUtil.getLanesRoot)(hover)||hover,event.hoverGfx=elementRegistry.getGraphics(event.hover))}),eventBus.on(["bendpoint.move.hover"],HIGH_PRIORITY,function(event){var context=event.context,hover=event.hover,type=context.type;(0,_ModelUtil.is)(hover,"bpmn:Lane")&&/reconnect/.test(type)&&(event.hover=(0,_LaneUtil.getLanesRoot)(hover)||hover,event.hoverGfx=elementRegistry.getGraphics(event.hover))}),eventBus.on(["connect.start"],HIGH_PRIORITY,function(event){var context=event.context,start=context.start;(0,_ModelUtil.is)(start,"bpmn:Lane")&&(context.start=(0,_LaneUtil.getLanesRoot)(start)||start)}),eventBus.on("shape.move.start",HIGHEST_PRIORITY,function(event){var shape=event.shape;(0,_ModelUtil.is)(shape,"bpmn:Lane")&&(event.shape=(0,_LaneUtil.getLanesRoot)(shape)||shape)})}FixHoverBehavior.$inject=["elementRegistry","eventBus","canvas"]},{"../../../util/ModelUtil":177,"../util/LaneUtil":147,"../util/ModelingUtil":148}],112:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=GroupBehavior;var _inherits2=_interopRequireDefault(require("inherits")),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_Collections=require("diagram-js/lib/util/Collections"),_ModelUtil=require("../../../util/ModelUtil"),_CategoryUtil=require("./util/CategoryUtil");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var HIGH_PRIORITY=2e3;function GroupBehavior(bpmnFactory,canvas,elementRegistry,eventBus,injector,moddleCopy){function getDefinitions(){var rootElement=canvas.getRootElement();return(0,_ModelUtil.getBusinessObject)(rootElement).$parent}function removeReferencedCategoryValue(shape){var category,categoryValue=(0,_ModelUtil.getBusinessObject)(shape).categoryValueRef;categoryValue&&(category=categoryValue.$parent,categoryValue&&((0,_Collections.remove)(category.categoryValue,categoryValue),category&&!category.categoryValue.length&&function(category){var definitions=getDefinitions();(0,_Collections.remove)(definitions.get("rootElements"),category)}(category)))}injector.invoke(_CommandInterceptor2.default,this),this.executed("shape.delete",function(event){var categoryValueRef,groupElements,categoryValue,shape=event.context.shape;(0,_ModelUtil.is)(shape,"bpmn:Group")&&(categoryValueRef=(0,_ModelUtil.getBusinessObject)(shape).categoryValueRef,groupElements=elementRegistry.filter(function(e){return(0,_ModelUtil.is)(e,"bpmn:Group")}),categoryValue=categoryValueRef,groupElements.some(function(e){var businessObject=(0,_ModelUtil.getBusinessObject)(e);return businessObject.categoryValueRef&&businessObject.categoryValueRef===categoryValue})||removeReferencedCategoryValue(shape))}),this.reverted("shape.delete",function(event){var categoryValueRef,definitions,category,shape=event.context.shape;(0,_ModelUtil.is)(shape,"bpmn:Group")&&(categoryValueRef=(0,_ModelUtil.getBusinessObject)(shape).categoryValueRef,definitions=getDefinitions(),category=categoryValueRef?categoryValueRef.$parent:null,(0,_Collections.add)(category.get("categoryValue"),categoryValueRef),(0,_Collections.add)(definitions.get("rootElements"),category))}),this.execute("shape.create",function(event){var definitions,categoryValue,shape=event.context.shape,businessObject=(0,_ModelUtil.getBusinessObject)(shape);(0,_ModelUtil.is)(businessObject,"bpmn:Group")&&!businessObject.categoryValueRef&&(definitions=getDefinitions(),categoryValue=(0,_CategoryUtil.createCategoryValue)(definitions,bpmnFactory),businessObject.categoryValueRef=categoryValue)}),this.revert("shape.create",function(event){var shape=event.context.shape;(0,_ModelUtil.is)(shape,"bpmn:Group")&&(removeReferencedCategoryValue(shape),delete(0,_ModelUtil.getBusinessObject)(shape).categoryValueRef)}),eventBus.on("moddleCopy.canCopyProperty",HIGH_PRIORITY,function(context){var categoryValue,property=context.property;if((0,_ModelUtil.is)(property,"bpmn:CategoryValue"))return categoryValue=(0,_CategoryUtil.createCategoryValue)(getDefinitions(),bpmnFactory),moddleCopy.copyElement(property,categoryValue)})}GroupBehavior.$inject=["bpmnFactory","canvas","elementRegistry","eventBus","injector","moddleCopy"],(0,_inherits2.default)(GroupBehavior,_CommandInterceptor2.default)},{"../../../util/ModelUtil":177,"./util/CategoryUtil":131,"diagram-js/lib/command/CommandInterceptor":181,"diagram-js/lib/util/Collections":349,inherits:385}],113:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ImportDockingFix;var obj,_LayoutUtil=require("diagram-js/lib/layout/LayoutUtil"),_LineIntersect=require("./util/LineIntersect"),_LineIntersect2=(obj=_LineIntersect)&&obj.__esModule?obj:{default:obj};function ImportDockingFix(eventBus){function adjustDocking(startPoint,nextPoint,elementMid){var elementTop={x:elementMid.x,y:elementMid.y-50},elementLeft={x:elementMid.x-50,y:elementMid.y},verticalIntersect=(0,_LineIntersect2.default)(startPoint,nextPoint,elementMid,elementTop),horizontalIntersect=(0,_LineIntersect2.default)(startPoint,nextPoint,elementMid,elementLeft),centerIntersect=verticalIntersect&&horizontalIntersect?getDistance(verticalIntersect,elementMid)>getDistance(horizontalIntersect,elementMid)?horizontalIntersect:verticalIntersect:verticalIntersect||horizontalIntersect;startPoint.original=centerIntersect}eventBus.on("bpmnElement.added",function(e){var connection,waypoints,element=e.element;element.waypoints&&(adjustDocking((waypoints=(connection=element).waypoints)[0],waypoints[1],(0,_LayoutUtil.getMid)(connection.source)),adjustDocking(waypoints[waypoints.length-1],waypoints[waypoints.length-2],(0,_LayoutUtil.getMid)(connection.target)))})}function getDistance(p1,p2){return Math.sqrt(Math.pow(p1.x-p2.x,2)+Math.pow(p1.y-p2.y,2))}ImportDockingFix.$inject=["eventBus"]},{"./util/LineIntersect":135,"diagram-js/lib/layout/LayoutUtil":336}],114:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=IsHorizontalFix;var _inherits2=_interopRequireDefault(require("inherits")),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_ModelUtil=require("../../../util/ModelUtil"),_ModelingUtil=require("../util/ModelingUtil");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function IsHorizontalFix(eventBus){_CommandInterceptor2.default.call(this,eventBus);var elementTypesToUpdate=["bpmn:Participant","bpmn:Lane"];this.executed(["shape.move","shape.create","shape.resize"],function(event){var bo=(0,_ModelUtil.getBusinessObject)(event.context.shape);(0,_ModelingUtil.isAny)(bo,elementTypesToUpdate)&&!bo.di.get("isHorizontal")&&bo.di.set("isHorizontal",!0)})}IsHorizontalFix.$inject=["eventBus"],(0,_inherits2.default)(IsHorizontalFix,_CommandInterceptor2.default)},{"../../../util/ModelUtil":177,"../util/ModelingUtil":148,"diagram-js/lib/command/CommandInterceptor":181,inherits:385}],115:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=LabelBehavior,exports.getReferencePointDelta=getReferencePointDelta,exports.getReferencePoint=getReferencePoint,exports.asEdges=asEdges;var _minDash=require("min-dash"),_inherits2=_interopRequireDefault(require("inherits")),_ModelUtil=require("../../../util/ModelUtil"),_LabelUtil=require("../../../util/LabelUtil"),_LabelUtil2=require("../../label-editing/LabelUtil"),_LabelLayoutUtil=require("./util/LabelLayoutUtil"),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_AttachUtil=require("diagram-js/lib/util/AttachUtil"),_LayoutUtil=require("diagram-js/lib/layout/LayoutUtil"),_PositionUtil=require("diagram-js/lib/util/PositionUtil"),_GeometricUtil=require("./util/GeometricUtil");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var DEFAULT_LABEL_DIMENSIONS={width:90,height:20},NAME_PROPERTY="name",TEXT_PROPERTY="text";function LabelBehavior(eventBus,modeling,bpmnFactory,textRenderer){_CommandInterceptor2.default.call(this,eventBus),this.postExecute("element.updateProperties",function(e){var newBounds,context=e.context,element=context.element,properties=context.properties;NAME_PROPERTY in properties&&modeling.updateLabel(element,properties[NAME_PROPERTY]),TEXT_PROPERTY in properties&&(0,_ModelUtil.is)(element,"bpmn:TextAnnotation")&&(newBounds=textRenderer.getTextAnnotationBounds({x:element.x,y:element.y,width:element.width,height:element.height},properties[TEXT_PROPERTY]||""),modeling.updateLabel(element,properties.text,newBounds))}),this.postExecute(["shape.create","connection.create"],function(e){var element,businessObject,labelCenter,labelDimensions,context=e.context;!1!==(context.hints||{}).createElementsBehavior&&(businessObject=(element=context.shape||context.connection).businessObject,!(0,_LabelUtil.isLabel)(element)&&(0,_LabelUtil.isLabelExternal)(element)&&(0,_LabelUtil2.getLabel)(element)&&(labelCenter=(0,_LabelUtil.getExternalLabelMid)(element),labelDimensions=textRenderer.getExternalLabelBounds(DEFAULT_LABEL_DIMENSIONS,(0,_LabelUtil2.getLabel)(element)),modeling.createLabel(element,labelCenter,{id:businessObject.id+"_label",businessObject:businessObject,width:labelDimensions.width,height:labelDimensions.height})))}),this.postExecute("shape.delete",function(event){var context=event.context,labelTarget=context.labelTarget,hints=context.hints||{};labelTarget&&!1!==hints.unsetLabel&&modeling.updateLabel(labelTarget,null,null,{removeShape:!1})}),this.postExecute(["label.create"],function(event){var di,element=event.context.shape;element.labelTarget&&(0,_ModelUtil.is)(element.labelTarget||element,"bpmn:BaseElement")&&((di=element.businessObject.di).label||(di.label=bpmnFactory.create("bpmndi:BPMNLabel",{bounds:bpmnFactory.create("dc:Bounds")})),(0,_minDash.assign)(di.label.bounds,{x:element.x,y:element.y,width:element.width,height:element.height}))}),this.postExecute(["connection.layout","connection.updateWaypoints"],function(event){var label,labelAdjustment,context=event.context;!1===(context.hints||{}).labelBehavior||(label=context.connection.label)&&label.parent&&(labelAdjustment=function(event){var context=event.context,connection=context.connection,label=connection.label,hints=(0,_minDash.assign)({},context.hints),newWaypoints=context.newWaypoints||connection.waypoints,oldWaypoints=context.oldWaypoints;return void 0===hints.startChanged&&(hints.startChanged=!!hints.connectionStart),void 0===hints.endChanged&&(hints.endChanged=!!hints.connectionEnd),(0,_LabelLayoutUtil.getLabelAdjustment)(label,newWaypoints,oldWaypoints,hints)}(event),modeling.moveShape(label,labelAdjustment))}),this.postExecute(["shape.replace"],function(event){var context=event.context,newShape=context.newShape,oldShape=context.oldShape,businessObject=(0,_ModelUtil.getBusinessObject)(newShape);businessObject&&(0,_LabelUtil.isLabelExternal)(businessObject)&&oldShape.label&&newShape.label&&(newShape.label.x=oldShape.label.x,newShape.label.y=oldShape.label.y)}),this.postExecute("shape.resize",function(event){var label,delta,context=event.context,shape=context.shape,newBounds=context.newBounds,oldBounds=context.oldBounds;(0,_LabelUtil.hasExternalLabel)(shape)&&(label=shape.label,delta=getReferencePointDelta(getReferencePoint((0,_LayoutUtil.getMid)(label),asEdges(oldBounds)),oldBounds,newBounds),modeling.moveShape(label,delta))})}function getReferencePointDelta(referencePoint,oldBounds,newBounds){var newReferencePoint=(0,_AttachUtil.getNewAttachPoint)(referencePoint,oldBounds,newBounds);return(0,_LayoutUtil.roundPoint)((0,_PositionUtil.delta)(newReferencePoint,referencePoint))}function getReferencePoint(point,lines){if(lines.length){var nearestLine=function(point,lines){var distances=lines.map(function(l){return{line:l,distance:(0,_GeometricUtil.getDistancePointLine)(point,l)}});return(0,_minDash.sortBy)(distances,"distance")[0].line}(point,lines);return(0,_GeometricUtil.perpendicularFoot)(point,nearestLine)}}function asEdges(bounds){return[[{x:bounds.x,y:bounds.y},{x:bounds.x+(bounds.width||0),y:bounds.y}],[{x:bounds.x+(bounds.width||0),y:bounds.y},{x:bounds.x+(bounds.width||0),y:bounds.y+(bounds.height||0)}],[{x:bounds.x,y:bounds.y+(bounds.height||0)},{x:bounds.x+(bounds.width||0),y:bounds.y+(bounds.height||0)}],[{x:bounds.x,y:bounds.y},{x:bounds.x,y:bounds.y+(bounds.height||0)}]]}(0,_inherits2.default)(LabelBehavior,_CommandInterceptor2.default),LabelBehavior.$inject=["eventBus","modeling","bpmnFactory","textRenderer"]},{"../../../util/LabelUtil":176,"../../../util/ModelUtil":177,"../../label-editing/LabelUtil":89,"./util/GeometricUtil":132,"./util/LabelLayoutUtil":133,"diagram-js/lib/command/CommandInterceptor":181,"diagram-js/lib/layout/LayoutUtil":336,"diagram-js/lib/util/AttachUtil":347,"diagram-js/lib/util/PositionUtil":361,inherits:385,"min-dash":594}],116:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ModelingFeedback;var _ModelUtil=require("../../../util/ModelUtil"),COLLAB_ERR_MSG="flow elements must be children of pools/participants",PROCESS_ERR_MSG="participants cannot be pasted onto a non-empty process diagram";function ModelingFeedback(eventBus,tooltips,translate){function showError(position,message,timeout){tooltips.add({position:{x:position.x+5,y:position.y+5},type:"error",timeout:timeout||2e3,html:"<div>"+message+"</div>"})}eventBus.on(["shape.move.rejected","create.rejected"],function(event){var context=event.context,shape=context.shape,target=context.target;(0,_ModelUtil.is)(target,"bpmn:Collaboration")&&(0,_ModelUtil.is)(shape,"bpmn:FlowNode")&&showError(event,translate(COLLAB_ERR_MSG))}),eventBus.on(["elements.paste.rejected"],function(event){var context=event.context,position=context.position,target=context.target;(0,_ModelUtil.is)(target,"bpmn:Collaboration")&&showError(position,translate(COLLAB_ERR_MSG)),(0,_ModelUtil.is)(target,"bpmn:Process")&&showError(position,translate(PROCESS_ERR_MSG),3e3)})}ModelingFeedback.$inject=["eventBus","tooltips","translate"]},{"../../../util/ModelUtil":177}],117:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=RemoveElementBehavior;var _inherits2=_interopRequireDefault(require("inherits")),_ModelUtil=require("../../../util/ModelUtil"),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_LineIntersect2=_interopRequireDefault(require("./util/LineIntersect"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function RemoveElementBehavior(eventBus,bpmnRules,modeling){_CommandInterceptor2.default.call(this,eventBus),this.preExecute("shape.delete",function(e){var inConnection,outConnection,newWaypoints,inWaypoints,outWaypoints,intersection,shape=e.context.shape;1===shape.incoming.length&&1===shape.outgoing.length&&(inConnection=shape.incoming[0],outConnection=shape.outgoing[0],(0,_ModelUtil.is)(inConnection,"bpmn:SequenceFlow")&&(0,_ModelUtil.is)(outConnection,"bpmn:SequenceFlow")&&bpmnRules.canConnect(inConnection.source,outConnection.target,inConnection)&&(inWaypoints=inConnection.waypoints,outWaypoints=outConnection.waypoints,newWaypoints=(intersection=(0,_LineIntersect2.default)(getDocking(inWaypoints[inWaypoints.length-2]),getDocking(inWaypoints[inWaypoints.length-1]),getDocking(outWaypoints[1]),getDocking(outWaypoints[0])))?[].concat(inWaypoints.slice(0,inWaypoints.length-1),[intersection],outWaypoints.slice(1)):[getDocking(inWaypoints[0]),getDocking(outWaypoints[outWaypoints.length-1])],modeling.reconnectEnd(inConnection,outConnection.target,newWaypoints)))})}function getDocking(point){return point.original||point}(0,_inherits2.default)(RemoveElementBehavior,_CommandInterceptor2.default),RemoveElementBehavior.$inject=["eventBus","bpmnRules","modeling"]},{"../../../util/ModelUtil":177,"./util/LineIntersect":135,"diagram-js/lib/command/CommandInterceptor":181,inherits:385}],118:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=RemoveParticipantBehavior;var _inherits2=_interopRequireDefault(require("inherits")),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_ModelUtil=require("../../../util/ModelUtil");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function RemoveParticipantBehavior(eventBus,modeling){_CommandInterceptor2.default.call(this,eventBus),this.preExecute("shape.delete",function(context){var shape=context.shape,parent=shape.parent;(0,_ModelUtil.is)(shape,"bpmn:Participant")&&(context.collaborationRoot=parent)},!0),this.postExecute("shape.delete",function(context){var collaborationRoot=context.collaborationRoot;collaborationRoot&&!collaborationRoot.businessObject.participants.length&&modeling.makeProcess()},!0)}RemoveParticipantBehavior.$inject=["eventBus","modeling"],(0,_inherits2.default)(RemoveParticipantBehavior,_CommandInterceptor2.default)},{"../../../util/ModelUtil":177,"diagram-js/lib/command/CommandInterceptor":181,inherits:385}],119:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ReplaceConnectionBehavior;var _minDash=require("min-dash"),_inherits2=_interopRequireDefault(require("inherits")),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_ModelUtil=require("../../../util/ModelUtil");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ReplaceConnectionBehavior(eventBus,modeling,bpmnRules,injector){_CommandInterceptor2.default.call(this,eventBus);var dragging=injector.get("dragging",!1);function fixConnection(connection){var replacementType,remove,source=connection.source,target=connection.target;connection.parent&&((0,_ModelUtil.is)(connection,"bpmn:SequenceFlow")&&(bpmnRules.canConnectSequenceFlow(source,target)||(remove=!0),bpmnRules.canConnectMessageFlow(source,target)&&(replacementType="bpmn:MessageFlow")),(0,_ModelUtil.is)(connection,"bpmn:MessageFlow")&&(bpmnRules.canConnectMessageFlow(source,target)||(remove=!0),bpmnRules.canConnectSequenceFlow(source,target)&&(replacementType="bpmn:SequenceFlow")),(0,_ModelUtil.is)(connection,"bpmn:Association")&&!bpmnRules.canConnectAssociation(source,target)&&(remove=!0),remove&&modeling.removeConnection(connection),replacementType&&modeling.connect(source,target,{type:replacementType,waypoints:connection.waypoints.slice()}))}this.postExecuted("elements.move",function(context){var allConnections=context.closure.allConnections;(0,_minDash.forEach)(allConnections,fixConnection)},!0),this.preExecute("connection.reconnect",function(event){var replacement,context=event.context,connection=context.connection,source=context.newSource||connection.source,target=context.newTarget||connection.target,allowed=bpmnRules.canConnect(source,target);allowed&&allowed.type!==connection.type&&(replacement=modeling.connect(source,target,{type:allowed.type,waypoints:connection.waypoints.slice()}),modeling.removeConnection(connection),context.connection=replacement,dragging&&function(oldConnection,newConnection){var index,context=dragging.context(),previousSelection=context&&context.payload.previousSelection;if(!previousSelection||!previousSelection.length)return;if(-1===(index=previousSelection.indexOf(oldConnection)))return;previousSelection.splice(index,1,newConnection)}(connection,replacement))}),this.postExecuted("element.updateProperties",function(event){var connection,context=event.context,properties=context.properties,element=context.element,businessObject=element.businessObject;properties.default&&(connection=(0,_minDash.find)(element.outgoing,(0,_minDash.matchPattern)({id:element.businessObject.default.id})))&&modeling.updateProperties(connection,{conditionExpression:void 0}),properties.conditionExpression&&businessObject.sourceRef.default===businessObject&&modeling.updateProperties(element.source,{default:void 0})})}(0,_inherits2.default)(ReplaceConnectionBehavior,_CommandInterceptor2.default),ReplaceConnectionBehavior.$inject=["eventBus","modeling","bpmnRules","injector"]},{"../../../util/ModelUtil":177,"diagram-js/lib/command/CommandInterceptor":181,inherits:385,"min-dash":594}],120:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ReplaceElementBehaviour;var _inherits2=_interopRequireDefault(require("inherits")),_minDash=require("min-dash"),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_DiUtil=require("../../../util/DiUtil");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ReplaceElementBehaviour(bpmnReplace,bpmnRules,elementRegistry,injector,modeling,selection){injector.invoke(_CommandInterceptor2.default,this),this._bpmnReplace=bpmnReplace,this._elementRegistry=elementRegistry,this._selection=selection,this.postExecuted(["elements.move"],500,function(event){var context=event.context,target=context.newParent,newHost=context.newHost,elements=[];(0,_minDash.forEach)(context.closure.topLevel,function(topLevelElements){elements=(0,_DiUtil.isEventSubProcess)(topLevelElements)?elements.concat(topLevelElements.children):elements.concat(topLevelElements)}),1===elements.length&&newHost&&(target=newHost);var canReplace=bpmnRules.canReplace(elements,target);canReplace&&this.replaceElements(elements,canReplace.replacements,newHost)},this),this.postExecute(["shape.replace"],1500,function(e){var canReplace,context=e.context,oldShape=context.oldShape,newShape=context.newShape,attachers=oldShape.attachers;attachers&&attachers.length&&(canReplace=bpmnRules.canReplace(attachers,newShape),this.replaceElements(attachers,canReplace.replacements))},this),this.postExecuted(["shape.replace"],1500,function(e){var context=e.context,oldShape=context.oldShape,newShape=context.newShape;modeling.unclaimId(oldShape.businessObject.id,oldShape.businessObject),modeling.updateProperties(newShape,{id:oldShape.id})})}(0,_inherits2.default)(ReplaceElementBehaviour,_CommandInterceptor2.default),ReplaceElementBehaviour.prototype.replaceElements=function(elements,newElements){var elementRegistry=this._elementRegistry,bpmnReplace=this._bpmnReplace,selection=this._selection;(0,_minDash.forEach)(newElements,function(replacement){var newElement={type:replacement.newElementType},oldElement=elementRegistry.get(replacement.oldElementId),idx=elements.indexOf(oldElement);elements[idx]=bpmnReplace.replaceElement(oldElement,newElement,{select:!1})}),newElements&&selection.select(elements)},ReplaceElementBehaviour.$inject=["bpmnReplace","bpmnRules","elementRegistry","injector","modeling","selection"]},{"../../../util/DiUtil":175,"diagram-js/lib/command/CommandInterceptor":181,inherits:385,"min-dash":594}],121:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TEXT_ANNOTATION_MIN_DIMENSIONS=exports.SUB_PROCESS_MIN_DIMENSIONS=exports.PARTICIPANT_MIN_DIMENSIONS=exports.LANE_MIN_DIMENSIONS=void 0,exports.default=ResizeBehavior;var _ModelUtil=require("../../../util/ModelUtil"),_DiUtil=require("../../../util/DiUtil"),_ResizeUtil=require("./util/ResizeUtil"),HIGH_PRIORITY=1500,PARTICIPANT_MIN_DIMENSIONS=(exports.LANE_MIN_DIMENSIONS={width:300,height:60},exports.PARTICIPANT_MIN_DIMENSIONS={width:300,height:150}),SUB_PROCESS_MIN_DIMENSIONS=exports.SUB_PROCESS_MIN_DIMENSIONS={width:140,height:120},TEXT_ANNOTATION_MIN_DIMENSIONS=exports.TEXT_ANNOTATION_MIN_DIMENSIONS={width:50,height:30};function ResizeBehavior(eventBus){eventBus.on("resize.start",HIGH_PRIORITY,function(event){var context=event.context,shape=context.shape,direction=context.direction,balanced=context.balanced;((0,_ModelUtil.is)(shape,"bpmn:Lane")||(0,_ModelUtil.is)(shape,"bpmn:Participant"))&&(context.resizeConstraints=(0,_ResizeUtil.getParticipantResizeConstraints)(shape,direction,balanced)),(0,_ModelUtil.is)(shape,"bpmn:Participant")&&(context.minDimensions=PARTICIPANT_MIN_DIMENSIONS),(0,_ModelUtil.is)(shape,"bpmn:SubProcess")&&(0,_DiUtil.isExpanded)(shape)&&(context.minDimensions=SUB_PROCESS_MIN_DIMENSIONS),(0,_ModelUtil.is)(shape,"bpmn:TextAnnotation")&&(context.minDimensions=TEXT_ANNOTATION_MIN_DIMENSIONS)})}ResizeBehavior.$inject=["eventBus"]},{"../../../util/DiUtil":175,"../../../util/ModelUtil":177,"./util/ResizeUtil":136}],122:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ResizeLaneBehavior;var _ModelUtil=require("../../../util/ModelUtil"),_LayoutUtil=require("diagram-js/lib/layout/LayoutUtil"),_Mouse=require("diagram-js/lib/util/Mouse"),SLIGHTLY_HIGHER_PRIORITY=1001;function ResizeLaneBehavior(eventBus,modeling){eventBus.on("resize.start",SLIGHTLY_HIGHER_PRIORITY+500,function(event){var context=event.context,shape=context.shape;((0,_ModelUtil.is)(shape,"bpmn:Lane")||(0,_ModelUtil.is)(shape,"bpmn:Participant"))&&(context.balanced=!(0,_Mouse.hasPrimaryModifier)(event))}),eventBus.on("resize.end",SLIGHTLY_HIGHER_PRIORITY,function(event){var context=event.context,shape=context.shape,canExecute=context.canExecute,newBounds=context.newBounds;if((0,_ModelUtil.is)(shape,"bpmn:Lane")||(0,_ModelUtil.is)(shape,"bpmn:Participant"))return canExecute&&(newBounds=(0,_LayoutUtil.roundBounds)(newBounds),modeling.resizeLane(shape,newBounds,context.balanced)),!1})}ResizeLaneBehavior.$inject=["eventBus","modeling"]},{"../../../util/ModelUtil":177,"diagram-js/lib/layout/LayoutUtil":336,"diagram-js/lib/util/Mouse":359}],123:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=RootElementReferenceBehavior;var _inherits2=_interopRequireDefault(require("inherits")),_minDash=require("min-dash"),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_Collections=require("diagram-js/lib/util/Collections"),_ModelUtil=require("../../../util/ModelUtil"),_ModelingUtil=require("../util/ModelingUtil"),_DiUtil=require("../../../util/DiUtil");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var LOW_PRIORITY=500;function RootElementReferenceBehavior(bpmnjs,eventBus,injector,moddleCopy,bpmnFactory){function canHaveRootElementReference(element){return(0,_ModelingUtil.isAny)(element,["bpmn:ReceiveTask","bpmn:SendTask"])||function(element,types){(0,_minDash.isArray)(types)||(types=[types]);return(0,_minDash.some)(types,function(type){return(0,_DiUtil.hasEventDefinition)(element,type)})}(element,["bpmn:ErrorEventDefinition","bpmn:EscalationEventDefinition","bpmn:MessageEventDefinition","bpmn:SignalEventDefinition"])}function hasRootElement(rootElement){var rootElements=bpmnjs.getDefinitions().get("rootElements");return(0,_minDash.find)(rootElements,(0,_minDash.matchPattern)({id:rootElement.id}))}function getRootElementReferencePropertyName(eventDefinition){return(0,_ModelUtil.is)(eventDefinition,"bpmn:ErrorEventDefinition")?"errorRef":(0,_ModelUtil.is)(eventDefinition,"bpmn:EscalationEventDefinition")?"escalationRef":(0,_ModelUtil.is)(eventDefinition,"bpmn:MessageEventDefinition")?"messageRef":(0,_ModelUtil.is)(eventDefinition,"bpmn:SignalEventDefinition")?"signalRef":void 0}function getRootElement(businessObject){if((0,_ModelingUtil.isAny)(businessObject,["bpmn:ReceiveTask","bpmn:SendTask"]))return businessObject.get("messageRef");var eventDefinition=businessObject.get("eventDefinitions")[0];return eventDefinition.get(getRootElementReferencePropertyName(eventDefinition))}injector.invoke(_CommandInterceptor2.default,this),this.executed("shape.create",function(context){var rootElement,rootElements,shape=context.shape;!canHaveRootElementReference(shape)||(rootElement=getRootElement((0,_ModelUtil.getBusinessObject)(shape)))&&!hasRootElement(rootElement)&&(rootElements=bpmnjs.getDefinitions().get("rootElements"),(0,_Collections.add)(rootElements,rootElement),context.addedRootElement=rootElement)},!0),this.reverted("shape.create",function(context){var rootElements,addedRootElement=context.addedRootElement;addedRootElement&&(rootElements=bpmnjs.getDefinitions().get("rootElements"),(0,_Collections.remove)(rootElements,addedRootElement))},!0),eventBus.on("copyPaste.copyElement",function(context){var rootElement,descriptor=context.descriptor,element=context.element;!canHaveRootElementReference(element)||(rootElement=getRootElement((0,_ModelUtil.getBusinessObject)(element)))&&(descriptor.referencedRootElement=rootElement)}),eventBus.on("copyPaste.pasteElement",LOW_PRIORITY,function(context){var referencedRootElement,descriptor=context.descriptor,businessObject=descriptor.businessObject;canHaveRootElementReference(businessObject)&&(referencedRootElement=descriptor.referencedRootElement)&&(hasRootElement(referencedRootElement)||(referencedRootElement=moddleCopy.copyElement(referencedRootElement,bpmnFactory.create(referencedRootElement.$type))),function(businessObject,rootElement){if((0,_ModelingUtil.isAny)(businessObject,["bpmn:ReceiveTask","bpmn:SendTask"]))return businessObject.set("messageRef",rootElement);var eventDefinition=businessObject.get("eventDefinitions")[0];eventDefinition.set(getRootElementReferencePropertyName(eventDefinition),rootElement)}(businessObject,referencedRootElement))})}RootElementReferenceBehavior.$inject=["bpmnjs","eventBus","injector","moddleCopy","bpmnFactory"],(0,_inherits2.default)(RootElementReferenceBehavior,_CommandInterceptor2.default)},{"../../../util/DiUtil":175,"../../../util/ModelUtil":177,"../util/ModelingUtil":148,"diagram-js/lib/command/CommandInterceptor":181,"diagram-js/lib/util/Collections":349,inherits:385,"min-dash":594}],124:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=SpaceToolBehavior;var _minDash=require("min-dash"),_ModelUtil=require("../../../util/ModelUtil"),_DiUtil=require("../../../util/DiUtil"),_ResizeBehavior=require("./ResizeBehavior"),_LaneUtil=require("../util/LaneUtil"),max=Math.max;function SpaceToolBehavior(eventBus){eventBus.on("spaceTool.getMinDimensions",function(context){var shapes=context.shapes,axis=context.axis,start=context.start,minDimensions={};return(0,_minDash.forEach)(shapes,function(shape){var id=shape.id;(0,_ModelUtil.is)(shape,"bpmn:Participant")&&(minDimensions[id]="x"===axis?_ResizeBehavior.PARTICIPANT_MIN_DIMENSIONS:{width:_ResizeBehavior.PARTICIPANT_MIN_DIMENSIONS.width,height:function(participant,start){var lanesMinHeight;return function(element){return!!(0,_LaneUtil.getChildLanes)(element).length}(participant)?(lanesMinHeight=function(participant,resizeStart){var resizedLane,lanes=(0,_LaneUtil.getChildLanes)(participant);return resizedLane=function findResizedLane(lanes,resizeStart){var i,lane,childLanes;for(i=0;i<lanes.length;i++)if(lane=lanes[i],resizeStart>=lane.y&&resizeStart<=lane.y+lane.height)return(childLanes=(0,_LaneUtil.getChildLanes)(lane)).length?findResizedLane(childLanes,resizeStart):lane}(lanes,resizeStart),participant.height-resizedLane.height+_ResizeBehavior.LANE_MIN_DIMENSIONS.height}(participant,start),max(_ResizeBehavior.PARTICIPANT_MIN_DIMENSIONS.height,lanesMinHeight)):_ResizeBehavior.PARTICIPANT_MIN_DIMENSIONS.height}(shape,start)}),(0,_ModelUtil.is)(shape,"bpmn:SubProcess")&&(0,_DiUtil.isExpanded)(shape)&&(minDimensions[id]=_ResizeBehavior.SUB_PROCESS_MIN_DIMENSIONS),(0,_ModelUtil.is)(shape,"bpmn:TextAnnotation")&&(minDimensions[id]=_ResizeBehavior.TEXT_ANNOTATION_MIN_DIMENSIONS)}),minDimensions})}SpaceToolBehavior.$inject=["eventBus"]},{"../../../util/DiUtil":175,"../../../util/ModelUtil":177,"../util/LaneUtil":147,"./ResizeBehavior":121,"min-dash":594}],125:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=SubProcessStartEventBehavior;var _inherits2=_interopRequireDefault(require("inherits")),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_ModelUtil=require("../../../util/ModelUtil"),_DiUtil=require("../../../util/DiUtil.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function SubProcessStartEventBehavior(injector,modeling){injector.invoke(_CommandInterceptor2.default,this),this.postExecuted("shape.replace",function(event){var position,shape,oldShape=event.context.oldShape,newShape=event.context.newShape;(0,_ModelUtil.is)(newShape,"bpmn:SubProcess")&&(0,_ModelUtil.is)(oldShape,"bpmn:Task")&&(0,_DiUtil.isExpanded)(newShape)&&(position={x:(shape=newShape).x+shape.width/6,y:shape.y+shape.height/2},modeling.createShape({type:"bpmn:StartEvent"},position,newShape))})}SubProcessStartEventBehavior.$inject=["injector","modeling"],(0,_inherits2.default)(SubProcessStartEventBehavior,_CommandInterceptor2.default)},{"../../../util/DiUtil.js":175,"../../../util/ModelUtil":177,"diagram-js/lib/command/CommandInterceptor":181,inherits:385}],126:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ToggleElementCollapseBehaviour;var _inherits2=_interopRequireDefault(require("inherits")),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_ModelUtil=require("../../../util/ModelUtil"),_ResizeUtil=require("diagram-js/lib/features/resize/ResizeUtil");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var LOW_PRIORITY=500;function ToggleElementCollapseBehaviour(eventBus,elementFactory,modeling,resize){function expandedBounds(shape,defaultSize){var visibleBBox,children=shape.children,newBounds=defaultSize,visibleElements=children.filter(function(e){return!e.hidden}).concat([shape]);return(visibleBBox=(0,_ResizeUtil.computeChildrenBBox)(visibleElements))?(newBounds.width=Math.max(visibleBBox.width,newBounds.width),newBounds.height=Math.max(visibleBBox.height,newBounds.height),newBounds.x=visibleBBox.x+(visibleBBox.width-newBounds.width)/2,newBounds.y=visibleBBox.y+(visibleBBox.height-newBounds.height)/2):(newBounds.x=shape.x+(shape.width-newBounds.width)/2,newBounds.y=shape.y+(shape.height-newBounds.height)/2),newBounds}_CommandInterceptor2.default.call(this,eventBus),this.executed(["shape.toggleCollapse"],LOW_PRIORITY,function(e){var children,shape=e.context.shape;(0,_ModelUtil.is)(shape,"bpmn:SubProcess")&&(shape.collapsed?(0,_ModelUtil.getBusinessObject)(shape).di.isExpanded=!1:((children=shape.children).length&&children.forEach(function(child){"label"!==child.type||child.businessObject.name||(child.hidden=!0)}),(0,_ModelUtil.getBusinessObject)(shape).di.isExpanded=!0))}),this.reverted(["shape.toggleCollapse"],LOW_PRIORITY,function(e){var shape=e.context.shape;shape.collapsed?(0,_ModelUtil.getBusinessObject)(shape).di.isExpanded=!1:(0,_ModelUtil.getBusinessObject)(shape).di.isExpanded=!0}),this.postExecuted(["shape.toggleCollapse"],LOW_PRIORITY,function(e){var shape=e.context.shape,defaultSize=elementFactory._getDefaultSize(shape),newBounds=(shape.collapsed?function(shape,defaultSize){return{x:shape.x+(shape.width-defaultSize.width)/2,y:shape.y+(shape.height-defaultSize.height)/2,width:defaultSize.width,height:defaultSize.height}}:expandedBounds)(shape,defaultSize);modeling.resizeShape(shape,newBounds,null,{autoResize:!shape.collapsed&&"nwse"})})}(0,_inherits2.default)(ToggleElementCollapseBehaviour,_CommandInterceptor2.default),ToggleElementCollapseBehaviour.$inject=["eventBus","elementFactory","modeling"]},{"../../../util/ModelUtil":177,"diagram-js/lib/command/CommandInterceptor":181,"diagram-js/lib/features/resize/ResizeUtil":304,inherits:385}],127:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=UnclaimIdBehavior;var _inherits2=_interopRequireDefault(require("inherits")),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_ModelUtil=require("../../../util/ModelUtil"),_DiUtil=require("../../../util/DiUtil"),_LabelUtil=require("../../../util/LabelUtil");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function UnclaimIdBehavior(canvas,injector,moddle,modeling){injector.invoke(_CommandInterceptor2.default,this),this.preExecute("shape.delete",function(event){var shape=event.context.shape,shapeBo=shape.businessObject;(0,_LabelUtil.isLabel)(shape)||((0,_ModelUtil.is)(shape,"bpmn:Participant")&&(0,_DiUtil.isExpanded)(shape)&&moddle.ids.unclaim(shapeBo.processRef.id),modeling.unclaimId(shapeBo.id,shapeBo))}),this.preExecute("connection.delete",function(event){var connectionBo=event.context.connection.businessObject;modeling.unclaimId(connectionBo.id,connectionBo)}),this.preExecute("canvas.updateRoot",function(){var rootElementBo=canvas.getRootElement().businessObject;moddle.ids.unclaim(rootElementBo.id)})}(0,_inherits2.default)(UnclaimIdBehavior,_CommandInterceptor2.default),UnclaimIdBehavior.$inject=["canvas","injector","moddle","modeling"]},{"../../../util/DiUtil":175,"../../../util/LabelUtil":176,"../../../util/ModelUtil":177,"diagram-js/lib/command/CommandInterceptor":181,inherits:385}],128:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=DeleteSequenceFlowBehavior;var _inherits2=_interopRequireDefault(require("inherits")),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_ModelUtil=require("../../../util/ModelUtil");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function DeleteSequenceFlowBehavior(eventBus,modeling){_CommandInterceptor2.default.call(this,eventBus),this.preExecute("connection.delete",function(event){var connection=event.context.connection,source=connection.source;!function(connection,source){if(!(0,_ModelUtil.is)(connection,"bpmn:SequenceFlow"))return!1;var sourceBo=(0,_ModelUtil.getBusinessObject)(source),sequenceFlow=(0,_ModelUtil.getBusinessObject)(connection);return sourceBo.get("default")===sequenceFlow}(connection,source)||modeling.updateProperties(source,{default:null})})}(0,_inherits2.default)(DeleteSequenceFlowBehavior,_CommandInterceptor2.default),DeleteSequenceFlowBehavior.$inject=["eventBus","modeling"]},{"../../../util/ModelUtil":177,"diagram-js/lib/command/CommandInterceptor":181,inherits:385}],129:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=UpdateFlowNodeRefsBehavior;var _inherits2=_interopRequireDefault(require("inherits")),_CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_ModelUtil=require("../../../util/ModelUtil");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var LOW_PRIORITY=500,HIGH_PRIORITY=5e3;function UpdateFlowNodeRefsBehavior(eventBus,modeling,translate){var context;function getContext(){if(!context)throw new Error(translate("out of bounds release"));return context}_CommandInterceptor2.default.call(this,eventBus);var laneRefUpdateEvents=["spaceTool","lane.add","lane.resize","lane.split","elements.create","elements.delete","elements.move","shape.create","shape.delete","shape.move","shape.resize"];this.preExecute(laneRefUpdateEvents,HIGH_PRIORITY,function(event){(context=context||new UpdateContext).enter()}),this.postExecuted(laneRefUpdateEvents,LOW_PRIORITY,function(event){!function(){if(!context)throw new Error(translate("out of bounds release"));var triggerUpdate=context.leave();triggerUpdate&&(modeling.updateLaneRefs(context.flowNodes,context.lanes),context=null)}()}),this.preExecute(["shape.create","shape.move","shape.delete","shape.resize"],function(event){var shape=event.context.shape,updateContext=getContext();shape.labelTarget||((0,_ModelUtil.is)(shape,"bpmn:Lane")&&updateContext.addLane(shape),(0,_ModelUtil.is)(shape,"bpmn:FlowNode")&&updateContext.addFlowNode(shape))})}function UpdateContext(){this.flowNodes=[],this.lanes=[],this.counter=0,this.addLane=function(lane){this.lanes.push(lane)},this.addFlowNode=function(flowNode){this.flowNodes.push(flowNode)},this.enter=function(){this.counter++},this.leave=function(){return this.counter--,!this.counter}}UpdateFlowNodeRefsBehavior.$inject=["eventBus","modeling","translate"],(0,_inherits2.default)(UpdateFlowNodeRefsBehavior,_CommandInterceptor2.default)},{"../../../util/ModelUtil":177,"diagram-js/lib/command/CommandInterceptor":181,inherits:385}],130:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _AdaptiveLabelPositioningBehavior2=_interopRequireDefault(require("./AdaptiveLabelPositioningBehavior")),_AppendBehavior2=_interopRequireDefault(require("./AppendBehavior")),_AssociationBehavior2=_interopRequireDefault(require("./AssociationBehavior")),_AttachEventBehavior2=_interopRequireDefault(require("./AttachEventBehavior")),_BoundaryEventBehavior2=_interopRequireDefault(require("./BoundaryEventBehavior")),_RootElementReferenceBehavior2=_interopRequireDefault(require("./RootElementReferenceBehavior")),_CreateBehavior2=_interopRequireDefault(require("./CreateBehavior")),_FixHoverBehavior2=_interopRequireDefault(require("./FixHoverBehavior")),_CreateDataObjectBehavior2=_interopRequireDefault(require("./CreateDataObjectBehavior")),_CreateParticipantBehavior2=_interopRequireDefault(require("./CreateParticipantBehavior")),_DataInputAssociationBehavior2=_interopRequireDefault(require("./DataInputAssociationBehavior")),_DataStoreBehavior2=_interopRequireDefault(require("./DataStoreBehavior")),_DeleteLaneBehavior2=_interopRequireDefault(require("./DeleteLaneBehavior")),_DetachEventBehavior2=_interopRequireDefault(require("./DetachEventBehavior")),_DropOnFlowBehavior2=_interopRequireDefault(require("./DropOnFlowBehavior")),_EventBasedGatewayBehavior2=_interopRequireDefault(require("./EventBasedGatewayBehavior")),_GroupBehavior2=_interopRequireDefault(require("./GroupBehavior")),_ImportDockingFix2=_interopRequireDefault(require("./ImportDockingFix")),_IsHorizontalFix2=_interopRequireDefault(require("./IsHorizontalFix")),_LabelBehavior2=_interopRequireDefault(require("./LabelBehavior")),_ModelingFeedback2=_interopRequireDefault(require("./ModelingFeedback")),_ReplaceConnectionBehavior2=_interopRequireDefault(require("./ReplaceConnectionBehavior")),_RemoveParticipantBehavior2=_interopRequireDefault(require("./RemoveParticipantBehavior")),_ReplaceElementBehaviour2=_interopRequireDefault(require("./ReplaceElementBehaviour")),_ResizeBehavior2=_interopRequireDefault(require("./ResizeBehavior")),_ResizeLaneBehavior2=_interopRequireDefault(require("./ResizeLaneBehavior")),_RemoveElementBehavior2=_interopRequireDefault(require("./RemoveElementBehavior")),_SpaceToolBehavior2=_interopRequireDefault(require("./SpaceToolBehavior")),_SubProcessStartEventBehavior2=_interopRequireDefault(require("./SubProcessStartEventBehavior")),_ToggleElementCollapseBehaviour2=_interopRequireDefault(require("./ToggleElementCollapseBehaviour")),_UnclaimIdBehavior2=_interopRequireDefault(require("./UnclaimIdBehavior")),_UpdateFlowNodeRefsBehavior2=_interopRequireDefault(require("./UpdateFlowNodeRefsBehavior")),_UnsetDefaultFlowBehavior2=_interopRequireDefault(require("./UnsetDefaultFlowBehavior"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__init__:["adaptiveLabelPositioningBehavior","appendBehavior","associationBehavior","attachEventBehavior","boundaryEventBehavior","rootElementReferenceBehavior","createBehavior","fixHoverBehavior","createDataObjectBehavior","createParticipantBehavior","dataStoreBehavior","dataInputAssociationBehavior","deleteLaneBehavior","detachEventBehavior","dropOnFlowBehavior","eventBasedGatewayBehavior","groupBehavior","importDockingFix","isHorizontalFix","labelBehavior","modelingFeedback","removeElementBehavior","removeParticipantBehavior","replaceConnectionBehavior","replaceElementBehaviour","resizeBehavior","resizeLaneBehavior","toggleElementCollapseBehaviour","spaceToolBehavior","subProcessStartEventBehavior","unclaimIdBehavior","unsetDefaultFlowBehavior","updateFlowNodeRefsBehavior"],adaptiveLabelPositioningBehavior:["type",_AdaptiveLabelPositioningBehavior2.default],appendBehavior:["type",_AppendBehavior2.default],associationBehavior:["type",_AssociationBehavior2.default],attachEventBehavior:["type",_AttachEventBehavior2.default],boundaryEventBehavior:["type",_BoundaryEventBehavior2.default],rootElementReferenceBehavior:["type",_RootElementReferenceBehavior2.default],createBehavior:["type",_CreateBehavior2.default],fixHoverBehavior:["type",_FixHoverBehavior2.default],createDataObjectBehavior:["type",_CreateDataObjectBehavior2.default],createParticipantBehavior:["type",_CreateParticipantBehavior2.default],dataInputAssociationBehavior:["type",_DataInputAssociationBehavior2.default],dataStoreBehavior:["type",_DataStoreBehavior2.default],deleteLaneBehavior:["type",_DeleteLaneBehavior2.default],detachEventBehavior:["type",_DetachEventBehavior2.default],dropOnFlowBehavior:["type",_DropOnFlowBehavior2.default],eventBasedGatewayBehavior:["type",_EventBasedGatewayBehavior2.default],groupBehavior:["type",_GroupBehavior2.default],importDockingFix:["type",_ImportDockingFix2.default],isHorizontalFix:["type",_IsHorizontalFix2.default],labelBehavior:["type",_LabelBehavior2.default],modelingFeedback:["type",_ModelingFeedback2.default],replaceConnectionBehavior:["type",_ReplaceConnectionBehavior2.default],removeParticipantBehavior:["type",_RemoveParticipantBehavior2.default],replaceElementBehaviour:["type",_ReplaceElementBehaviour2.default],resizeBehavior:["type",_ResizeBehavior2.default],resizeLaneBehavior:["type",_ResizeLaneBehavior2.default],removeElementBehavior:["type",_RemoveElementBehavior2.default],toggleElementCollapseBehaviour:["type",_ToggleElementCollapseBehaviour2.default],spaceToolBehavior:["type",_SpaceToolBehavior2.default],subProcessStartEventBehavior:["type",_SubProcessStartEventBehavior2.default],unclaimIdBehavior:["type",_UnclaimIdBehavior2.default],updateFlowNodeRefsBehavior:["type",_UpdateFlowNodeRefsBehavior2.default],unsetDefaultFlowBehavior:["type",_UnsetDefaultFlowBehavior2.default]}},{"./AdaptiveLabelPositioningBehavior":97,"./AppendBehavior":98,"./AssociationBehavior":99,"./AttachEventBehavior":100,"./BoundaryEventBehavior":101,"./CreateBehavior":102,"./CreateDataObjectBehavior":103,"./CreateParticipantBehavior":104,"./DataInputAssociationBehavior":105,"./DataStoreBehavior":106,"./DeleteLaneBehavior":107,"./DetachEventBehavior":108,"./DropOnFlowBehavior":109,"./EventBasedGatewayBehavior":110,"./FixHoverBehavior":111,"./GroupBehavior":112,"./ImportDockingFix":113,"./IsHorizontalFix":114,"./LabelBehavior":115,"./ModelingFeedback":116,"./RemoveElementBehavior":117,"./RemoveParticipantBehavior":118,"./ReplaceConnectionBehavior":119,"./ReplaceElementBehaviour":120,"./ResizeBehavior":121,"./ResizeLaneBehavior":122,"./RootElementReferenceBehavior":123,"./SpaceToolBehavior":124,"./SubProcessStartEventBehavior":125,"./ToggleElementCollapseBehaviour":126,"./UnclaimIdBehavior":127,"./UnsetDefaultFlowBehavior":128,"./UpdateFlowNodeRefsBehavior":129}],131:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createCategoryValue=function(definitions,bpmnFactory){var categoryValue=bpmnFactory.create("bpmn:CategoryValue"),category=bpmnFactory.create("bpmn:Category",{categoryValue:[categoryValue]});return(0,_Collections.add)(definitions.get("rootElements"),category),(0,_ModelUtil.getBusinessObject)(category).$parent=definitions,(0,_ModelUtil.getBusinessObject)(categoryValue).$parent=category,categoryValue};var _Collections=require("diagram-js/lib/util/Collections"),_ModelUtil=require("../../../../util/ModelUtil")},{"../../../../util/ModelUtil":177,"diagram-js/lib/util/Collections":349}],132:[function(require,module,exports){"use strict";function vectorLength(v){return Math.sqrt(Math.pow(v.x,2)+Math.pow(v.y,2))}function perpendicularFoot(point,line){var a=line[0],b=line[1],bd={x:b.x-a.x,y:b.y-a.y},r=function(a,b,c){var system=[{n:a[0]-c[0],lambda:b[0]},{n:a[1]-c[1],lambda:b[1]}];return-(system[0].n*b[0]+system[1].n*b[1])/(system[0].lambda*b[0]+system[1].lambda*b[1])}([a.x,a.y],[bd.x,bd.y],[point.x,point.y]);return{x:a.x+r*bd.x,y:a.y+r*bd.y}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.vectorLength=vectorLength,exports.getAngle=function(line){return Math.atan((line[1].y-line[0].y)/(line[1].x-line[0].x))},exports.rotateVector=function(vector,angle){return angle?{x:Math.cos(angle)*vector.x-Math.sin(angle)*vector.y,y:Math.sin(angle)*vector.x+Math.cos(angle)*vector.y}:vector},exports.perpendicularFoot=perpendicularFoot,exports.getDistancePointLine=function(point,line){var pfPoint=perpendicularFoot(point,line);return vectorLength({x:pfPoint.x-point.x,y:pfPoint.y-point.y})},exports.getDistancePointPoint=function(point1,point2){return vectorLength({x:point1.x-point2.x,y:point1.y-point2.y})}},{}],133:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.findNewLabelLineStartIndex=findNewLabelLineStartIndex,exports.getLabelAdjustment=function(label,newWaypoints,oldWaypoints,hints){var x=0,y=0,labelPosition=function(label){return{x:label.x+label.width/2,y:label.y+label.height/2}}(label),attachment=(0,_LineAttachmentUtil.getAttachment)(labelPosition,oldWaypoints),oldLabelLineIndex=attachment.segmentIndex,newLabelLineIndex=findNewLabelLineStartIndex(oldWaypoints,newWaypoints,attachment,hints);if(null===newLabelLineIndex)return{x:x,y:y};if(newLabelLineIndex<0||newLabelLineIndex>newWaypoints.length-2)return{x:x,y:y};var oldLabelLine=getLine(oldWaypoints,oldLabelLineIndex),newLabelLine=getLine(newWaypoints,newLabelLineIndex),oldFoot=attachment.position,relativeFootPosition=function(line,foot){var length=(0,_GeometricUtil.getDistancePointPoint)(line[0],line[1]),lengthToFoot=(0,_GeometricUtil.getDistancePointPoint)(line[0],foot);return 0===length?0:lengthToFoot/length}(oldLabelLine,oldFoot),angleDelta=function(l1,l2){var a1=(0,_GeometricUtil.getAngle)(l1);return(0,_GeometricUtil.getAngle)(l2)-a1}(oldLabelLine,newLabelLine);if("bendpoint"===attachment.type){var offset=newWaypoints.length-oldWaypoints.length,oldBendpointIndex=attachment.bendpointIndex,oldBendpoint=oldWaypoints[oldBendpointIndex];if(-1!==newWaypoints.indexOf(oldBendpoint))return{x:x,y:y};if(0==offset){var newBendpoint=newWaypoints[oldBendpointIndex];return{x:newBendpoint.x-attachment.position.x,y:newBendpoint.y-attachment.position.y}}offset<0&&0!==oldBendpointIndex&&oldBendpointIndex<oldWaypoints.length-1&&(relativeFootPosition=relativePositionMidWaypoint(oldWaypoints,oldBendpointIndex))}var newFoot_x=(newLabelLine[1].x-newLabelLine[0].x)*relativeFootPosition+newLabelLine[0].x,newFoot_y=(newLabelLine[1].y-newLabelLine[0].y)*relativeFootPosition+newLabelLine[0].y,newLabelVector=(0,_GeometricUtil.rotateVector)({x:labelPosition.x-oldFoot.x,y:labelPosition.y-oldFoot.y},angleDelta);return x=newFoot_x+newLabelVector.x-labelPosition.x,y=newFoot_y+newLabelVector.y-labelPosition.y,(0,_LayoutUtil.roundPoint)({x:x,y:y})};var _GeometricUtil=require("./GeometricUtil"),_LineAttachmentUtil=require("./LineAttachmentUtil"),_LayoutUtil=require("diagram-js/lib/layout/LayoutUtil");function findNewLabelLineStartIndex(oldWaypoints,newWaypoints,attachment,hints){var index=attachment.segmentIndex,offset=newWaypoints.length-oldWaypoints.length;if(hints.segmentMove){var oldSegmentStartIndex=hints.segmentMove.segmentStartIndex,newSegmentStartIndex=hints.segmentMove.newSegmentStartIndex;return index===oldSegmentStartIndex?newSegmentStartIndex:newSegmentStartIndex<=index?index+offset<newSegmentStartIndex?newSegmentStartIndex:index+offset:index}if(hints.bendpointMove){var newIndex,insert=hints.bendpointMove.insert,bendpointIndex=hints.bendpointMove.bendpointIndex;return 0==offset?index:(bendpointIndex<=index&&(newIndex=insert?index+1:index-1),index<bendpointIndex&&(newIndex=index,insert&&"bendpoint"!==attachment.type&&bendpointIndex-1===index&&relativePositionMidWaypoint(newWaypoints,bendpointIndex)<attachment.relativeLocation&&newIndex++),newIndex)}return 0==offset?index:hints.connectionStart?0===index?0:null:hints.connectionEnd&&index===oldWaypoints.length-2?newWaypoints.length-2:null}function relativePositionMidWaypoint(waypoints,idx){var distanceSegment1=(0,_GeometricUtil.getDistancePointPoint)(waypoints[idx-1],waypoints[idx]);return distanceSegment1/(distanceSegment1+(0,_GeometricUtil.getDistancePointPoint)(waypoints[idx],waypoints[idx+1]))}function getLine(waypoints,idx){return[waypoints[idx],waypoints[idx+1]]}},{"./GeometricUtil":132,"./LineAttachmentUtil":134,"diagram-js/lib/layout/LayoutUtil":336}],134:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getAttachment=function(point,line){var segmentStart,segmentEnd,segmentStartDistance,segmentEndDistance,attachmentPosition,minDistance,intersections,attachment,attachmentDistance,closestAttachmentDistance,closestAttachment,idx=0;for(idx=0;idx<line.length-1;idx++){if(segmentStart=line[idx],segmentEnd=line[idx+1],(intersections=pointsEqual(segmentStart,segmentEnd)?[segmentStart]:(segmentStartDistance=getDistance(point,segmentStart),segmentEndDistance=getDistance(point,segmentEnd),minDistance=min(segmentStartDistance,segmentEndDistance),function(s1,s2,cc,cr){var baX=s2.x-s1.x,baY=s2.y-s1.y,caX=cc.x-s1.x,caY=cc.y-s1.y,a=baX*baX+baY*baY,pBy2=(baX*caX+baY*caY)/a,disc=pBy2*pBy2-(caX*caX+caY*caY-cr*cr)/a;disc<0&&-1e-6<disc&&(disc=0);if(disc<0)return[];var tmpSqrt=sqrt(disc),abScalingFactor1=-pBy2+tmpSqrt,abScalingFactor2=-pBy2-tmpSqrt,i1={x:s1.x-baX*abScalingFactor1,y:s1.y-baY*abScalingFactor1};if(0===disc)return[i1];var i2={x:s1.x-baX*abScalingFactor2,y:s1.y-baY*abScalingFactor2};return[i1,i2].filter(function(p){return function(p,segmentStart,segmentEnd){return fenced(p.x,segmentStart.x,segmentEnd.x)&&fenced(p.y,segmentStart.y,segmentEnd.y)}(p,s1,s2)})}(segmentStart,segmentEnd,point,minDistance))).length<1)throw new Error("expected between [1, 2] circle -> line intersections");1===intersections.length&&(attachment={type:"bendpoint",position:intersections[0],segmentIndex:idx,bendpointIndex:pointsEqual(segmentStart,intersections[0])?idx:idx+1}),2===intersections.length&&(attachmentPosition=function(p1,p2){return{x:(p1.x+p2.x)/2,y:(p1.y+p2.y)/2}}(intersections[0],intersections[1]),attachment={type:"segment",position:attachmentPosition,segmentIndex:idx,relativeLocation:getDistance(segmentStart,attachmentPosition)/getDistance(segmentStart,segmentEnd)}),attachmentDistance=getDistance(attachment.position,point),(!closestAttachment||attachmentDistance<closestAttachmentDistance)&&(closestAttachment=attachment,closestAttachmentDistance=attachmentDistance)}return closestAttachment};var sqrt=Math.sqrt,min=Math.min,max=Math.max,abs=Math.abs;function sq(n){return Math.pow(n,2)}function getDistance(p1,p2){return sqrt(sq(p1.x-p2.x)+sq(p1.y-p2.y))}function fenced(n,rangeStart,rangeEnd){return n>=min(rangeStart,rangeEnd)-EQUAL_THRESHOLD&&n<=max(rangeStart,rangeEnd)+EQUAL_THRESHOLD}var EQUAL_THRESHOLD=.1;function pointsEqual(p1,p2){return abs(p1.x-p2.x)<=EQUAL_THRESHOLD&&abs(p1.y-p2.y)<=EQUAL_THRESHOLD}},{}],135:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(l1s,l1e,l2s,l2e){var denominator,a,b,c,numerator;return 0!=(denominator=(l2e.y-l2s.y)*(l1e.x-l1s.x)-(l2e.x-l2s.x)*(l1e.y-l1s.y))?(a=l1s.y-l2s.y,b=l1s.x-l2s.x,numerator=(l2e.x-l2s.x)*a-(l2e.y-l2s.y)*b,c=numerator/denominator,{x:Math.round(l1s.x+c*(l1e.x-l1s.x)),y:Math.round(l1s.y+c*(l1e.y-l1s.y))}):null}},{}],136:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getParticipantResizeConstraints=function(laneShape,resizeDirection,balanced){var lanesRoot=(0,_LaneUtil.getLanesRoot)(laneShape),isFirst=!0,isLast=!0,allLanes=(0,_LaneUtil.collectLanes)(lanesRoot,[lanesRoot]),laneTrbl=(0,_LayoutUtil.asTRBL)(laneShape),maxTrbl={},minTrbl={};/e/.test(resizeDirection)?minTrbl.right=laneTrbl.left+_ResizeBehavior.LANE_MIN_DIMENSIONS.width:/w/.test(resizeDirection)&&(minTrbl.left=laneTrbl.right-_ResizeBehavior.LANE_MIN_DIMENSIONS.width);return allLanes.forEach(function(other){var otherTrbl=(0,_LayoutUtil.asTRBL)(other);/n/.test(resizeDirection)&&(otherTrbl.top<laneTrbl.top-10&&(isFirst=!1),balanced&&abs(laneTrbl.top-otherTrbl.bottom)<10&&addMax(maxTrbl,"top",otherTrbl.top+_ResizeBehavior.LANE_MIN_DIMENSIONS.height),abs(laneTrbl.top-otherTrbl.top)<5&&addMin(minTrbl,"top",otherTrbl.bottom-_ResizeBehavior.LANE_MIN_DIMENSIONS.height)),/s/.test(resizeDirection)&&(otherTrbl.bottom>laneTrbl.bottom+10&&(isLast=!1),balanced&&abs(laneTrbl.bottom-otherTrbl.top)<10&&addMin(maxTrbl,"bottom",otherTrbl.bottom-_ResizeBehavior.LANE_MIN_DIMENSIONS.height),abs(laneTrbl.bottom-otherTrbl.bottom)<5&&addMax(minTrbl,"bottom",otherTrbl.top+_ResizeBehavior.LANE_MIN_DIMENSIONS.height))}),lanesRoot.children.filter(function(s){return!s.hidden&&!s.waypoints&&((0,_ModelUtil.is)(s,"bpmn:FlowElement")||(0,_ModelUtil.is)(s,"bpmn:Artifact"))}).forEach(function(flowElement){var flowElementTrbl=(0,_LayoutUtil.asTRBL)(flowElement);isFirst&&/n/.test(resizeDirection)&&addMin(minTrbl,"top",flowElementTrbl.top-LANE_TOP_PADDING),/e/.test(resizeDirection)&&addMax(minTrbl,"right",flowElementTrbl.right+LANE_RIGHT_PADDING),isLast&&/s/.test(resizeDirection)&&addMax(minTrbl,"bottom",flowElementTrbl.bottom+LANE_BOTTOM_PADDING),/w/.test(resizeDirection)&&addMin(minTrbl,"left",flowElementTrbl.left-LANE_LEFT_PADDING)}),{min:minTrbl,max:maxTrbl}};var _ModelUtil=require("../../../../util/ModelUtil"),_LayoutUtil=require("diagram-js/lib/layout/LayoutUtil"),_LaneUtil=require("../../../modeling/util/LaneUtil"),_ResizeBehavior=require("../ResizeBehavior"),abs=Math.abs,min=Math.min,max=Math.max;function addToTrbl(trbl,attr,value,choice){var current=trbl[attr];trbl[attr]=void 0===current?value:choice(value,current)}function addMin(trbl,attr,value){return addToTrbl(trbl,attr,value,min),0}function addMax(trbl,attr,value){return addToTrbl(trbl,attr,value,max),0}var LANE_RIGHT_PADDING=20,LANE_LEFT_PADDING=50,LANE_TOP_PADDING=20,LANE_BOTTOM_PADDING=20},{"../../../../util/ModelUtil":177,"../../../modeling/util/LaneUtil":147,"../ResizeBehavior":121,"diagram-js/lib/layout/LayoutUtil":336}],137:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=AddLaneHandler;var _minDash=require("min-dash"),_Elements=require("diagram-js/lib/util/Elements"),_LaneUtil=require("../util/LaneUtil");function AddLaneHandler(modeling,spaceTool){this._modeling=modeling,this._spaceTool=spaceTool}AddLaneHandler.$inject=["modeling","spaceTool"],AddLaneHandler.prototype.preExecute=function(context){var spaceTool=this._spaceTool,modeling=this._modeling,shape=context.shape,location=context.location,lanesRoot=(0,_LaneUtil.getLanesRoot)(shape),isRoot=lanesRoot===shape,laneParent=isRoot?shape:shape.parent;(0,_LaneUtil.getChildLanes)(laneParent).length||modeling.createShape({type:"bpmn:Lane"},{x:shape.x+_LaneUtil.LANE_INDENTATION,y:shape.y,width:shape.width-_LaneUtil.LANE_INDENTATION,height:shape.height},laneParent);var allAffected=[];(0,_Elements.eachElement)(lanesRoot,function(element){return allAffected.push(element),element.label&&allAffected.push(element.label),element===shape?[]:(0,_minDash.filter)(element.children,function(c){return c!==shape})});var offset="top"===location?-120:120,lanePosition="top"===location?shape.y:shape.y+shape.height,spacePos=lanePosition+("top"===location?10:-10),direction="top"===location?"n":"s",adjustments=spaceTool.calculateAdjustments(allAffected,"y",offset,spacePos);spaceTool.makeSpace(adjustments.movingShapes,adjustments.resizingShapes,{x:0,y:offset},direction,spacePos),context.newLane=modeling.createShape({type:"bpmn:Lane"},{x:shape.x+(isRoot?_LaneUtil.LANE_INDENTATION:0),y:lanePosition-("top"===location?120:0),width:shape.width-(isRoot?_LaneUtil.LANE_INDENTATION:0),height:120},laneParent)}},{"../util/LaneUtil":147,"diagram-js/lib/util/Elements":351,"min-dash":594}],138:[function(require,module,exports){"use strict";function IdClaimHandler(moddle){this._moddle=moddle}Object.defineProperty(exports,"__esModule",{value:!0}),(exports.default=IdClaimHandler).$inject=["moddle"],IdClaimHandler.prototype.execute=function(context){var ids=this._moddle.ids,id=context.id,element=context.element;context.claiming?ids.claim(id,element):ids.unclaim(id)},IdClaimHandler.prototype.revert=function(context){var ids=this._moddle.ids,id=context.id,element=context.element;context.claiming?ids.unclaim(id):ids.claim(id,element)}},{}],139:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ResizeLaneHandler;var _ModelUtil=require("../../../util/ModelUtil"),_LaneUtil=require("../util/LaneUtil"),_Elements=require("diagram-js/lib/util/Elements"),_LayoutUtil=require("diagram-js/lib/layout/LayoutUtil"),_ResizeUtil=require("diagram-js/lib/features/resize/ResizeUtil");function ResizeLaneHandler(modeling,spaceTool){this._modeling=modeling,this._spaceTool=spaceTool}ResizeLaneHandler.$inject=["modeling","spaceTool"],ResizeLaneHandler.prototype.preExecute=function(context){var shape=context.shape,newBounds=context.newBounds;!1!==context.balanced?this.resizeBalanced(shape,newBounds):this.resizeSpace(shape,newBounds)},ResizeLaneHandler.prototype.resizeBalanced=function(shape,newBounds){var modeling=this._modeling,resizeNeeded=(0,_LaneUtil.computeLanesResize)(shape,newBounds);modeling.resizeShape(shape,newBounds),resizeNeeded.forEach(function(r){modeling.resizeShape(r.shape,r.newBounds)})},ResizeLaneHandler.prototype.resizeSpace=function(shape,newBounds){var change,spacePos,direction,offset,adjustments,spaceTool=this._spaceTool,shapeTrbl=(0,_LayoutUtil.asTRBL)(shape),newTrbl=(0,_LayoutUtil.asTRBL)(newBounds),trblDiff=(0,_ResizeUtil.substractTRBL)(newTrbl,shapeTrbl),lanesRoot=(0,_LaneUtil.getLanesRoot)(shape),allAffected=[],allLanes=[];(0,_Elements.eachElement)(lanesRoot,function(element){return allAffected.push(element),((0,_ModelUtil.is)(element,"bpmn:Lane")||(0,_ModelUtil.is)(element,"bpmn:Participant"))&&allLanes.push(element),element.children}),(trblDiff.bottom||trblDiff.top)&&(change=trblDiff.bottom||trblDiff.top,spacePos=shape.y+(trblDiff.bottom?shape.height:0)+(trblDiff.bottom?-10:10),direction=trblDiff.bottom?"s":"n",offset=0<trblDiff.top||trblDiff.bottom<0?-change:change,adjustments=spaceTool.calculateAdjustments(allAffected,"y",offset,spacePos),spaceTool.makeSpace(adjustments.movingShapes,adjustments.resizingShapes,{x:0,y:change},direction)),(trblDiff.left||trblDiff.right)&&(change=trblDiff.right||trblDiff.left,spacePos=shape.x+(trblDiff.right?shape.width:0)+(trblDiff.right?-10:100),direction=trblDiff.right?"e":"w",offset=0<trblDiff.left||trblDiff.right<0?-change:change,adjustments=spaceTool.calculateAdjustments(allLanes,"x",offset,spacePos),spaceTool.makeSpace(adjustments.movingShapes,adjustments.resizingShapes,{x:change,y:0},direction))}},{"../../../util/ModelUtil":177,"../util/LaneUtil":147,"diagram-js/lib/features/resize/ResizeUtil":304,"diagram-js/lib/layout/LayoutUtil":336,"diagram-js/lib/util/Elements":351}],140:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=SetColorHandler;var _minDash=require("min-dash"),DEFAULT_COLORS={fill:void 0,stroke:void 0};function SetColorHandler(commandStack){this._commandStack=commandStack}SetColorHandler.$inject=["commandStack"],SetColorHandler.prototype.postExecute=function(context){var elements=context.elements,colors=context.colors||DEFAULT_COLORS,self=this,di={};"fill"in colors&&(0,_minDash.assign)(di,{fill:colors.fill}),"stroke"in colors&&(0,_minDash.assign)(di,{stroke:colors.stroke}),(0,_minDash.forEach)(elements,function(element){self._commandStack.execute("element.updateProperties",{element:element,properties:{di:di}})})}},{"min-dash":594}],141:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=SplitLaneHandler;var _LaneUtil=require("../util/LaneUtil");function SplitLaneHandler(modeling,translate){this._modeling=modeling,this._translate=translate}SplitLaneHandler.$inject=["modeling","translate"],SplitLaneHandler.prototype.preExecute=function(context){var modeling=this._modeling,translate=this._translate,shape=context.shape,newLanesCount=context.count,childLanes=(0,_LaneUtil.getChildLanes)(shape),existingLanesCount=childLanes.length;if(newLanesCount<existingLanesCount)throw new Error(translate("more than {count} child lanes",{count:newLanesCount}));for(var laneY,laneHeight,laneBounds,newLaneAttrs,newLanesHeight=Math.round(shape.height/newLanesCount),idx=0;idx<newLanesCount;idx++)laneY=shape.y+idx*newLanesHeight,laneHeight=idx===newLanesCount-1?shape.height-newLanesHeight*idx:newLanesHeight,laneBounds={x:shape.x+_LaneUtil.LANE_INDENTATION,y:laneY,width:shape.width-_LaneUtil.LANE_INDENTATION,height:laneHeight},idx<existingLanesCount?modeling.resizeShape(childLanes[idx],laneBounds):(newLaneAttrs={type:"bpmn:Lane"},modeling.createShape(newLaneAttrs,laneBounds,shape))}},{"../util/LaneUtil":147}],142:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=UpdateCanvasRootHandler;var _Collections=require("diagram-js/lib/util/Collections");function UpdateCanvasRootHandler(canvas,modeling){this._canvas=canvas,this._modeling=modeling}UpdateCanvasRootHandler.$inject=["canvas","modeling"],UpdateCanvasRootHandler.prototype.execute=function(context){var canvas=this._canvas,newRoot=context.newRoot,newRootBusinessObject=newRoot.businessObject,oldRoot=canvas.getRootElement(),oldRootBusinessObject=oldRoot.businessObject,bpmnDefinitions=oldRootBusinessObject.$parent,diPlane=oldRootBusinessObject.di;canvas.setRootElement(newRoot,!0),(0,_Collections.add)(bpmnDefinitions.rootElements,newRootBusinessObject),newRootBusinessObject.$parent=bpmnDefinitions,(0,_Collections.remove)(bpmnDefinitions.rootElements,oldRootBusinessObject),oldRootBusinessObject.$parent=null,oldRootBusinessObject.di=null,(diPlane.bpmnElement=newRootBusinessObject).di=diPlane,context.oldRoot=oldRoot},UpdateCanvasRootHandler.prototype.revert=function(context){var canvas=this._canvas,newRootBusinessObject=context.newRoot.businessObject,oldRoot=context.oldRoot,oldRootBusinessObject=oldRoot.businessObject,bpmnDefinitions=newRootBusinessObject.$parent,diPlane=newRootBusinessObject.di;canvas.setRootElement(oldRoot,!0),(0,_Collections.remove)(bpmnDefinitions.rootElements,newRootBusinessObject),(newRootBusinessObject.$parent=null,_Collections.add)(bpmnDefinitions.rootElements,oldRootBusinessObject),oldRootBusinessObject.$parent=bpmnDefinitions,newRootBusinessObject.di=null,(diPlane.bpmnElement=oldRootBusinessObject).di=diPlane}},{"diagram-js/lib/util/Collections":349}],143:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=UpdateFlowNodeRefsHandler;var _LaneUtil=require("../util/LaneUtil"),_ModelUtil=require("../../../util/ModelUtil"),_Collections=require("diagram-js/lib/util/Collections"),_LayoutUtil=require("diagram-js/lib/layout/LayoutUtil");function UpdateFlowNodeRefsHandler(elementRegistry){this._elementRegistry=elementRegistry}UpdateFlowNodeRefsHandler.$inject=["elementRegistry"],UpdateFlowNodeRefsHandler.prototype.computeUpdates=function(flowNodeShapes,laneShapes){var handledNodes=[],updates=[],participantCache={},allFlowNodeShapes=[];function addFlowNodeShape(flowNodeShape){-1===handledNodes.indexOf(flowNodeShape)&&(allFlowNodeShapes.push(flowNodeShape),handledNodes.push(flowNodeShape))}function getNewLanes(flowNodeShape){return flowNodeShape.parent?function(flowNodeShape){var root=(0,_LaneUtil.getLanesRoot)(flowNodeShape);return participantCache[root.id]||(participantCache[root.id]=(0,_LaneUtil.collectLanes)(root)),participantCache[root.id]}(flowNodeShape).filter(function(l){return element=flowNodeShape,laneShape=l,laneTrbl=(0,_LayoutUtil.asTRBL)(laneShape),elementMid_x=element.x+element.width/2,elementMid_y=element.y+element.height/2,elementMid_x>laneTrbl.left&&elementMid_x<laneTrbl.right&&elementMid_y>laneTrbl.top&&elementMid_y<laneTrbl.bottom;var element,laneShape,laneTrbl,elementMid_x,elementMid_y}).map(function(shape){return shape.businessObject}):[]}return laneShapes.forEach(function(laneShape){var root=(0,_LaneUtil.getLanesRoot)(laneShape);root&&-1===handledNodes.indexOf(root)&&(root.children.filter(function(c){return(0,_ModelUtil.is)(c,"bpmn:FlowNode")}).forEach(addFlowNodeShape),handledNodes.push(root))}),flowNodeShapes.forEach(addFlowNodeShape),allFlowNodeShapes.forEach(function(flowNodeShape){var flowNode=flowNodeShape.businessObject,remove=flowNode.get("lanes").slice(),add=getNewLanes(flowNodeShape);updates.push({flowNode:flowNode,remove:remove,add:add})}),laneShapes.forEach(function(laneShape){var lane=laneShape.businessObject;laneShape.parent||lane.get("flowNodeRef").forEach(function(flowNode){updates.push({flowNode:flowNode,remove:[lane],add:[]})})}),updates},UpdateFlowNodeRefsHandler.prototype.execute=function(context){(context.updates||(context.updates=this.computeUpdates(context.flowNodeShapes,context.laneShapes))).forEach(function(update){var flowNode=update.flowNode,lanes=flowNode.get("lanes");update.remove.forEach(function(oldLane){(0,_Collections.remove)(lanes,oldLane),(0,_Collections.remove)(oldLane.get("flowNodeRef"),flowNode)}),update.add.forEach(function(newLane){(0,_Collections.add)(lanes,newLane),(0,_Collections.add)(newLane.get("flowNodeRef"),flowNode)})})},UpdateFlowNodeRefsHandler.prototype.revert=function(context){context.updates.forEach(function(update){var flowNode=update.flowNode,lanes=flowNode.get("lanes");update.add.forEach(function(newLane){(0,_Collections.remove)(lanes,newLane),(0,_Collections.remove)(newLane.get("flowNodeRef"),flowNode)}),update.remove.forEach(function(oldLane){(0,_Collections.add)(lanes,oldLane),(0,_Collections.add)(oldLane.get("flowNodeRef"),flowNode)})})}},{"../../../util/ModelUtil":177,"../util/LaneUtil":147,"diagram-js/lib/layout/LayoutUtil":336,"diagram-js/lib/util/Collections":349}],144:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=UpdatePropertiesHandler;var _minDash=require("min-dash"),_ModelUtil=require("../../../util/ModelUtil"),ID="id",NULL_DIMENSIONS={width:0,height:0};function UpdatePropertiesHandler(elementRegistry,moddle,translate,modeling,textRenderer){this._elementRegistry=elementRegistry,this._moddle=moddle,this._translate=translate,this._modeling=modeling,this._textRenderer=textRenderer}function isIdChange(properties,businessObject){return ID in properties&&properties.id!==businessObject.id}function setProperties(businessObject,properties){(0,_minDash.forEach)(properties,function(value,key){var di,properties;"di"!==key?businessObject.set(key,value):businessObject.di&&(di=businessObject.di,properties=value,(0,_minDash.forEach)(properties,function(value,key){di.set(key,value)}))})}UpdatePropertiesHandler.$inject=["elementRegistry","moddle","translate","modeling","textRenderer"],UpdatePropertiesHandler.prototype.execute=function(context){var element=context.element,changed=[element],translate=this._translate;if(!element)throw new Error(translate("element required"));var elementRegistry=this._elementRegistry,ids=this._moddle.ids,businessObject=element.businessObject,properties=function(properties){var unwrappedProps=(0,_minDash.assign)({},properties);return referencePropertyNames.forEach(function(name){name in properties&&(unwrappedProps[name]=(0,_ModelUtil.getBusinessObject)(unwrappedProps[name]))}),unwrappedProps}(context.properties),oldProperties=context.oldProperties||function(businessObject,properties){var propertyNames=(0,_minDash.keys)(properties);return(0,_minDash.reduce)(propertyNames,function(result,key){var di,propertyNames;return result[key]="di"!==key?businessObject.get(key):(di=businessObject.di,propertyNames=(0,_minDash.keys)(properties.di),(0,_minDash.reduce)(propertyNames,function(result,key){return result[key]=di.get(key),result},{})),result},{})}(businessObject,properties);return isIdChange(properties,businessObject)&&(ids.unclaim(businessObject.id),elementRegistry.updateId(element,properties.id),ids.claim(properties.id,businessObject)),"default"in properties&&(properties.default&&changed.push(elementRegistry.get(properties.default.id)),businessObject.default&&changed.push(elementRegistry.get(businessObject.default.id))),setProperties(businessObject,properties),context.oldProperties=oldProperties,context.changed=changed},UpdatePropertiesHandler.prototype.postExecute=function(context){var newLabelBounds,label=context.element.label,text=label&&(0,_ModelUtil.getBusinessObject)(label).name;text&&(newLabelBounds=this._textRenderer.getExternalLabelBounds(label,text),this._modeling.resizeShape(label,newLabelBounds,NULL_DIMENSIONS))},UpdatePropertiesHandler.prototype.revert=function(context){var element=context.element,properties=context.properties,oldProperties=context.oldProperties,businessObject=element.businessObject,elementRegistry=this._elementRegistry,ids=this._moddle.ids;return setProperties(businessObject,oldProperties),isIdChange(properties,businessObject)&&(ids.unclaim(properties.id),elementRegistry.updateId(element,oldProperties.id),ids.claim(oldProperties.id,businessObject)),context.changed};var referencePropertyNames=["default"]},{"../../../util/ModelUtil":177,"min-dash":594}],145:[function(require,module,exports){"use strict";function UpdateSemanticParentHandler(bpmnUpdater){this._bpmnUpdater=bpmnUpdater}Object.defineProperty(exports,"__esModule",{value:!0}),(exports.default=UpdateSemanticParentHandler).$inject=["bpmnUpdater"],UpdateSemanticParentHandler.prototype.execute=function(context){var dataStoreBo=context.dataStoreBo,newSemanticParent=context.newSemanticParent,newDiParent=context.newDiParent;context.oldSemanticParent=dataStoreBo.$parent,context.oldDiParent=dataStoreBo.di.$parent,this._bpmnUpdater.updateSemanticParent(dataStoreBo,newSemanticParent),this._bpmnUpdater.updateDiParent(dataStoreBo.di,newDiParent)},UpdateSemanticParentHandler.prototype.revert=function(context){var dataStoreBo=context.dataStoreBo,oldSemanticParent=context.oldSemanticParent,oldDiParent=context.oldDiParent;this._bpmnUpdater.updateSemanticParent(dataStoreBo,oldSemanticParent),this._bpmnUpdater.updateDiParent(dataStoreBo.di,oldDiParent)}},{}],146:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _behavior2=_interopRequireDefault(require("./behavior")),_rules2=_interopRequireDefault(require("../rules")),_diOrdering2=_interopRequireDefault(require("../di-ordering")),_ordering2=_interopRequireDefault(require("../ordering")),_replace2=_interopRequireDefault(require("../replace")),_command2=_interopRequireDefault(require("diagram-js/lib/command")),_tooltips2=_interopRequireDefault(require("diagram-js/lib/features/tooltips")),_labelSupport2=_interopRequireDefault(require("diagram-js/lib/features/label-support")),_attachSupport2=_interopRequireDefault(require("diagram-js/lib/features/attach-support")),_selection2=_interopRequireDefault(require("diagram-js/lib/features/selection")),_changeSupport2=_interopRequireDefault(require("diagram-js/lib/features/change-support")),_spaceTool2=_interopRequireDefault(require("diagram-js/lib/features/space-tool")),_BpmnFactory2=_interopRequireDefault(require("./BpmnFactory")),_BpmnUpdater2=_interopRequireDefault(require("./BpmnUpdater")),_ElementFactory2=_interopRequireDefault(require("./ElementFactory")),_Modeling2=_interopRequireDefault(require("./Modeling")),_BpmnLayouter2=_interopRequireDefault(require("./BpmnLayouter")),_CroppingConnectionDocking2=_interopRequireDefault(require("diagram-js/lib/layout/CroppingConnectionDocking"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__init__:["modeling","bpmnUpdater"],__depends__:[_behavior2.default,_rules2.default,_diOrdering2.default,_ordering2.default,_replace2.default,_command2.default,_tooltips2.default,_labelSupport2.default,_attachSupport2.default,_selection2.default,_changeSupport2.default,_spaceTool2.default],bpmnFactory:["type",_BpmnFactory2.default],bpmnUpdater:["type",_BpmnUpdater2.default],elementFactory:["type",_ElementFactory2.default],modeling:["type",_Modeling2.default],layouter:["type",_BpmnLayouter2.default],connectionDocking:["type",_CroppingConnectionDocking2.default]}},{"../di-ordering":72,"../ordering":150,"../replace":160,"../rules":162,"./BpmnFactory":92,"./BpmnLayouter":93,"./BpmnUpdater":94,"./ElementFactory":95,"./Modeling":96,"./behavior":130,"diagram-js/lib/command":183,"diagram-js/lib/features/attach-support":197,"diagram-js/lib/features/change-support":214,"diagram-js/lib/features/label-support":255,"diagram-js/lib/features/selection":314,"diagram-js/lib/features/space-tool":324,"diagram-js/lib/features/tooltips":328,"diagram-js/lib/layout/CroppingConnectionDocking":335}],147:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LANE_INDENTATION=void 0,exports.collectLanes=collectLanes,exports.getChildLanes=function(shape){return shape.children.filter(function(c){return(0,_ModelUtil.is)(c,"bpmn:Lane")})},exports.getLanesRoot=getLanesRoot,exports.computeLanesResize=function(shape,newBounds){var rootElement=getLanesRoot(shape),initialShapes=(0,_ModelUtil.is)(rootElement,"bpmn:Process")?[]:[rootElement],allLanes=collectLanes(rootElement,initialShapes),shapeTrbl=(0,_LayoutUtil.asTRBL)(shape),shapeNewTrbl=(0,_LayoutUtil.asTRBL)(newBounds),trblResize=function(oldBounds,newBounds){return(0,_ResizeUtil.substractTRBL)((0,_LayoutUtil.asTRBL)(newBounds),(0,_LayoutUtil.asTRBL)(oldBounds))}(shape,newBounds),resizeNeeded=[];return allLanes.forEach(function(other){var topResize,rightResize,bottomResize,leftResize,otherTrbl;other!==shape&&(topResize=0,rightResize=trblResize.right,bottomResize=0,leftResize=trblResize.left,otherTrbl=(0,_LayoutUtil.asTRBL)(other),trblResize.top&&(abs(otherTrbl.bottom-shapeTrbl.top)<10&&(bottomResize=shapeNewTrbl.top-otherTrbl.bottom),abs(otherTrbl.top-shapeTrbl.top)<5&&(topResize=shapeNewTrbl.top-otherTrbl.top)),trblResize.bottom&&(abs(otherTrbl.top-shapeTrbl.bottom)<10&&(topResize=shapeNewTrbl.bottom-otherTrbl.top),abs(otherTrbl.bottom-shapeTrbl.bottom)<5&&(bottomResize=shapeNewTrbl.bottom-otherTrbl.bottom)),(topResize||rightResize||bottomResize||leftResize)&&resizeNeeded.push({shape:other,newBounds:(0,_ResizeUtil.resizeTRBL)(other,{top:topResize,right:rightResize,bottom:bottomResize,left:leftResize})}))}),resizeNeeded};var _ModelUtil=require("../../../util/ModelUtil"),_ModelingUtil=require("./ModelingUtil"),_LayoutUtil=require("diagram-js/lib/layout/LayoutUtil"),_ResizeUtil=require("diagram-js/lib/features/resize/ResizeUtil"),abs=Math.abs;var LANE_PARENTS=["bpmn:Participant","bpmn:Process","bpmn:SubProcess"];exports.LANE_INDENTATION=30;function collectLanes(shape,collectedShapes){return collectedShapes=collectedShapes||[],shape.children.filter(function(s){(0,_ModelUtil.is)(s,"bpmn:Lane")&&(collectLanes(s,collectedShapes),collectedShapes.push(s))}),collectedShapes}function getLanesRoot(shape){return(0,_ModelingUtil.getParent)(shape,LANE_PARENTS)||shape}},{"../../../util/ModelUtil":177,"./ModelingUtil":148,"diagram-js/lib/features/resize/ResizeUtil":304,"diagram-js/lib/layout/LayoutUtil":336}],148:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isAny=isAny,exports.getParent=function(element,anyType){"string"==typeof anyType&&(anyType=[anyType]);for(;element=element.parent;)if(isAny(element,anyType))return element;return null};var _minDash=require("min-dash"),_ModelUtil=require("../../../util/ModelUtil");function isAny(element,types){return(0,_minDash.some)(types,function(t){return(0,_ModelUtil.is)(element,t)})}},{"../../../util/ModelUtil":177,"min-dash":594}],149:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BpmnOrderingProvider;var _inherits2=_interopRequireDefault(require("inherits")),_OrderingProvider2=_interopRequireDefault(require("diagram-js/lib/features/ordering/OrderingProvider")),_ModelingUtil=require("../modeling/util/ModelingUtil"),_minDash=require("min-dash");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function BpmnOrderingProvider(eventBus,canvas,translate){_OrderingProvider2.default.call(this,eventBus);var orders=[{type:"bpmn:SubProcess",order:{level:6}},{type:"bpmn:SequenceFlow",order:{level:3,containers:["bpmn:Participant","bpmn:FlowElementsContainer"]}},{type:"bpmn:DataAssociation",order:{level:9,containers:["bpmn:Collaboration","bpmn:Process"]}},{type:"bpmn:MessageFlow",order:{level:9,containers:["bpmn:Collaboration"]}},{type:"bpmn:Association",order:{level:6,containers:["bpmn:Participant","bpmn:FlowElementsContainer","bpmn:Collaboration"]}},{type:"bpmn:BoundaryEvent",order:{level:8}},{type:"bpmn:Group",order:{level:10,containers:["bpmn:Collaboration","bpmn:Process"]}},{type:"bpmn:FlowElement",order:{level:5}},{type:"bpmn:Participant",order:{level:-2}},{type:"bpmn:Lane",order:{level:-1}}];function getOrder(element){var order=element.order;return order||(element.order=order=function(element){if(element.labelTarget)return{level:10};var entry=(0,_minDash.find)(orders,function(o){return(0,_ModelingUtil.isAny)(element,[o.type])});return entry&&entry.order||{level:1}}(element)),order}this.getOrdering=function(element,newParent){if(element.labelTarget)return{parent:canvas.getRootElement(),index:-1};var elementOrder=getOrder(element);elementOrder.containers&&(newParent=function(element,newParent,containers){for(var actualParent=newParent;actualParent&&!(0,_ModelingUtil.isAny)(actualParent,containers);)actualParent=actualParent.parent;if(!actualParent)throw new Error(translate("no parent for {element} in {parent}",{element:element.id,parent:newParent.id}));return actualParent}(element,newParent,elementOrder.containers));var currentIndex=newParent.children.indexOf(element),insertIndex=(0,_minDash.findIndex)(newParent.children,function(child){return!(!element.labelTarget&&child.labelTarget)&&elementOrder.level<getOrder(child).level});return-1!==insertIndex&&-1!==currentIndex&&currentIndex<insertIndex&&--insertIndex,{index:insertIndex,parent:newParent}}}BpmnOrderingProvider.$inject=["eventBus","canvas","translate"],(0,_inherits2.default)(BpmnOrderingProvider,_OrderingProvider2.default)},{"../modeling/util/ModelingUtil":148,"diagram-js/lib/features/ordering/OrderingProvider":288,inherits:385,"min-dash":594}],150:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _translate2=_interopRequireDefault(require("diagram-js/lib/i18n/translate")),_BpmnOrderingProvider2=_interopRequireDefault(require("./BpmnOrderingProvider"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_translate2.default],__init__:["bpmnOrderingProvider"],bpmnOrderingProvider:["type",_BpmnOrderingProvider2.default]}},{"./BpmnOrderingProvider":149,"diagram-js/lib/i18n/translate":332}],151:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=PaletteProvider;var _minDash=require("min-dash");function PaletteProvider(palette,create,elementFactory,spaceTool,lassoTool,handTool,globalConnect,translate){this._palette=palette,this._create=create,this._elementFactory=elementFactory,this._spaceTool=spaceTool,this._lassoTool=lassoTool,this._handTool=handTool,this._globalConnect=globalConnect,this._translate=translate,palette.registerProvider(this)}PaletteProvider.$inject=["palette","create","elementFactory","spaceTool","lassoTool","handTool","globalConnect","translate"],PaletteProvider.prototype.getPaletteEntries=function(element){var actions={},create=this._create,elementFactory=this._elementFactory,spaceTool=this._spaceTool,lassoTool=this._lassoTool,handTool=this._handTool,globalConnect=this._globalConnect,translate=this._translate;function createAction(type,group,className,title,options){function createListener(event){var shape=elementFactory.createShape((0,_minDash.assign)({type:type},options));options&&(shape.businessObject.di.isExpanded=options.isExpanded),create.start(event,shape)}var shortType=type.replace(/^bpmn:/,"");return{group:group,className:className,title:title||translate("Create {type}",{type:shortType}),action:{dragstart:createListener,click:createListener}}}function createSubprocess(event){var subProcess=elementFactory.createShape({type:"bpmn:SubProcess",x:0,y:0,isExpanded:!0}),startEvent=elementFactory.createShape({type:"bpmn:StartEvent",x:40,y:82,parent:subProcess});create.start(event,[subProcess,startEvent],{hints:{autoSelect:[startEvent]}})}function createParticipant(event){create.start(event,elementFactory.createParticipantShape())}return(0,_minDash.assign)(actions,{"hand-tool":{group:"tools",className:"bpmn-icon-hand-tool",title:translate("Activate the hand tool"),action:{click:function(event){handTool.activateHand(event)}}},"lasso-tool":{group:"tools",className:"bpmn-icon-lasso-tool",title:translate("Activate the lasso tool"),action:{click:function(event){lassoTool.activateSelection(event)}}},"space-tool":{group:"tools",className:"bpmn-icon-space-tool",title:translate("Activate the create/remove space tool"),action:{click:function(event){spaceTool.activateSelection(event)}}},"global-connect-tool":{group:"tools",className:"bpmn-icon-connection-multi",title:translate("Activate the global connect tool"),action:{click:function(event){globalConnect.toggle(event)}}},"tool-separator":{group:"tools",separator:!0},"create.start-event":createAction("bpmn:StartEvent","event","bpmn-icon-start-event-none",translate("Create StartEvent")),"create.intermediate-event":createAction("bpmn:IntermediateThrowEvent","event","bpmn-icon-intermediate-event-none",translate("Create Intermediate/Boundary Event")),"create.end-event":createAction("bpmn:EndEvent","event","bpmn-icon-end-event-none",translate("Create EndEvent")),"create.exclusive-gateway":createAction("bpmn:ExclusiveGateway","gateway","bpmn-icon-gateway-none",translate("Create Gateway")),"create.task":createAction("bpmn:Task","activity","bpmn-icon-task",translate("Create Task")),"create.data-object":createAction("bpmn:DataObjectReference","data-object","bpmn-icon-data-object",translate("Create DataObjectReference")),"create.data-store":createAction("bpmn:DataStoreReference","data-store","bpmn-icon-data-store",translate("Create DataStoreReference")),"create.subprocess-expanded":{group:"activity",className:"bpmn-icon-subprocess-expanded",title:translate("Create expanded SubProcess"),action:{dragstart:createSubprocess,click:createSubprocess}},"create.participant-expanded":{group:"collaboration",className:"bpmn-icon-participant",title:translate("Create Pool/Participant"),action:{dragstart:createParticipant,click:createParticipant}},"create.group":createAction("bpmn:Group","artifact","bpmn-icon-group",translate("Create Group"))}),actions}},{"min-dash":594}],152:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _palette2=_interopRequireDefault(require("diagram-js/lib/features/palette")),_create2=_interopRequireDefault(require("diagram-js/lib/features/create")),_spaceTool2=_interopRequireDefault(require("diagram-js/lib/features/space-tool")),_lassoTool2=_interopRequireDefault(require("diagram-js/lib/features/lasso-tool")),_handTool2=_interopRequireDefault(require("diagram-js/lib/features/hand-tool")),_globalConnect2=_interopRequireDefault(require("diagram-js/lib/features/global-connect")),_translate2=_interopRequireDefault(require("diagram-js/lib/i18n/translate")),_PaletteProvider2=_interopRequireDefault(require("./PaletteProvider"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_palette2.default,_create2.default,_spaceTool2.default,_lassoTool2.default,_handTool2.default,_globalConnect2.default,_translate2.default],__init__:["paletteProvider"],paletteProvider:["type",_PaletteProvider2.default]}},{"./PaletteProvider":151,"diagram-js/lib/features/create":228,"diagram-js/lib/features/global-connect":237,"diagram-js/lib/features/hand-tool":245,"diagram-js/lib/features/lasso-tool":257,"diagram-js/lib/features/palette":294,"diagram-js/lib/features/space-tool":324,"diagram-js/lib/i18n/translate":332}],153:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ReplaceMenuProvider;var _ModelUtil=require("../../util/ModelUtil"),_DiUtil=require("../../util/DiUtil"),_TypeUtil=require("./util/TypeUtil"),_minDash=require("min-dash"),replaceOptions=function(obj){{if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}}(require("../replace/ReplaceOptions"));function ReplaceMenuProvider(popupMenu,modeling,moddle,bpmnReplace,rules,translate){this._popupMenu=popupMenu,this._modeling=modeling,this._moddle=moddle,this._bpmnReplace=bpmnReplace,this._rules=rules,this._translate=translate,this.register()}ReplaceMenuProvider.$inject=["popupMenu","modeling","moddle","bpmnReplace","rules","translate"],ReplaceMenuProvider.prototype.register=function(){this._popupMenu.registerProvider("bpmn-replace",this)},ReplaceMenuProvider.prototype.getEntries=function(element){var entries,businessObject=element.businessObject;if(!this._rules.allowed("shape.replace",{element:element}))return[];var differentType=(0,_TypeUtil.isDifferentType)(element);return(0,_ModelUtil.is)(businessObject,"bpmn:StartEvent")&&!(0,_ModelUtil.is)(businessObject.$parent,"bpmn:SubProcess")?(entries=(0,_minDash.filter)(replaceOptions.START_EVENT,differentType),this._createEntries(element,entries)):(0,_ModelUtil.is)(businessObject,"bpmn:Participant")?(entries=(0,_minDash.filter)(replaceOptions.PARTICIPANT,function(entry){return(0,_DiUtil.isExpanded)(businessObject)!==entry.target.isExpanded}),this._createEntries(element,entries)):(0,_ModelUtil.is)(businessObject,"bpmn:StartEvent")&&(0,_DiUtil.isEventSubProcess)(businessObject.$parent)?(entries=(0,_minDash.filter)(replaceOptions.EVENT_SUB_PROCESS_START_EVENT,function(entry){var isInterrupting=!1!==entry.target.isInterrupting,isInterruptingEqual=(0,_ModelUtil.getBusinessObject)(element).isInterrupting===isInterrupting;return differentType(entry)||!differentType(entry)&&!isInterruptingEqual}),this._createEntries(element,entries)):(0,_ModelUtil.is)(businessObject,"bpmn:StartEvent")&&!(0,_DiUtil.isEventSubProcess)(businessObject.$parent)&&(0,_ModelUtil.is)(businessObject.$parent,"bpmn:SubProcess")?(entries=(0,_minDash.filter)(replaceOptions.START_EVENT_SUB_PROCESS,differentType),this._createEntries(element,entries)):(0,_ModelUtil.is)(businessObject,"bpmn:EndEvent")?(entries=(0,_minDash.filter)(replaceOptions.END_EVENT,function(entry){return!("bpmn:CancelEventDefinition"==entry.target.eventDefinitionType&&!(0,_ModelUtil.is)(businessObject.$parent,"bpmn:Transaction"))&&differentType(entry)}),this._createEntries(element,entries)):(0,_ModelUtil.is)(businessObject,"bpmn:BoundaryEvent")?(entries=(0,_minDash.filter)(replaceOptions.BOUNDARY_EVENT,function(entry){var target=entry.target;if("bpmn:CancelEventDefinition"==target.eventDefinition&&!(0,_ModelUtil.is)(businessObject.attachedToRef,"bpmn:Transaction"))return!1;var cancelActivity=!1!==target.cancelActivity,isCancelActivityEqual=businessObject.cancelActivity==cancelActivity;return differentType(entry)||!differentType(entry)&&!isCancelActivityEqual}),this._createEntries(element,entries)):(0,_ModelUtil.is)(businessObject,"bpmn:IntermediateCatchEvent")||(0,_ModelUtil.is)(businessObject,"bpmn:IntermediateThrowEvent")?(entries=(0,_minDash.filter)(replaceOptions.INTERMEDIATE_EVENT,differentType),this._createEntries(element,entries)):(0,_ModelUtil.is)(businessObject,"bpmn:Gateway")?(entries=(0,_minDash.filter)(replaceOptions.GATEWAY,differentType),this._createEntries(element,entries)):(0,_ModelUtil.is)(businessObject,"bpmn:Transaction")?(entries=(0,_minDash.filter)(replaceOptions.TRANSACTION,differentType),this._createEntries(element,entries)):(0,_DiUtil.isEventSubProcess)(businessObject)&&(0,_DiUtil.isExpanded)(businessObject)?(entries=(0,_minDash.filter)(replaceOptions.EVENT_SUB_PROCESS,differentType),this._createEntries(element,entries)):(0,_ModelUtil.is)(businessObject,"bpmn:SubProcess")&&(0,_DiUtil.isExpanded)(businessObject)?(entries=(0,_minDash.filter)(replaceOptions.SUBPROCESS_EXPANDED,differentType),this._createEntries(element,entries)):(0,_ModelUtil.is)(businessObject,"bpmn:AdHocSubProcess")&&!(0,_DiUtil.isExpanded)(businessObject)?(entries=(0,_minDash.filter)(replaceOptions.TASK,function(entry){var target=entry.target,isTargetSubProcess="bpmn:SubProcess"===target.type,isTargetExpanded=!0===target.isExpanded;return(0,_TypeUtil.isDifferentType)(element,target)&&(!isTargetSubProcess||isTargetExpanded)}),this._createEntries(element,entries)):(0,_ModelUtil.is)(businessObject,"bpmn:SequenceFlow")?this._createSequenceFlowEntries(element,replaceOptions.SEQUENCE_FLOW):(0,_ModelUtil.is)(businessObject,"bpmn:FlowNode")?(entries=(0,_minDash.filter)(replaceOptions.TASK,differentType),(0,_ModelUtil.is)(businessObject,"bpmn:SubProcess")&&!(0,_DiUtil.isExpanded)(businessObject)&&(entries=(0,_minDash.filter)(entries,function(entry){return"Sub Process (collapsed)"!==entry.label})),this._createEntries(element,entries)):[]},ReplaceMenuProvider.prototype.getHeaderEntries=function(element){var headerEntries=[];return(0,_ModelUtil.is)(element,"bpmn:Activity")&&!(0,_DiUtil.isEventSubProcess)(element)&&(headerEntries=headerEntries.concat(this._getLoopEntries(element))),!(0,_ModelUtil.is)(element,"bpmn:SubProcess")||(0,_ModelUtil.is)(element,"bpmn:Transaction")||(0,_DiUtil.isEventSubProcess)(element)||headerEntries.push(this._getAdHocEntry(element)),headerEntries},ReplaceMenuProvider.prototype._createEntries=function(element,replaceOptions){var menuEntries=[],self=this;return(0,_minDash.forEach)(replaceOptions,function(definition){var entry=self._createMenuEntry(definition,element);menuEntries.push(entry)}),menuEntries},ReplaceMenuProvider.prototype._createSequenceFlowEntries=function(element,replaceOptions){var businessObject=(0,_ModelUtil.getBusinessObject)(element),menuEntries=[],modeling=this._modeling,moddle=this._moddle,self=this;return(0,_minDash.forEach)(replaceOptions,function(entry){switch(entry.actionName){case"replace-with-default-flow":businessObject.sourceRef.default!==businessObject&&((0,_ModelUtil.is)(businessObject.sourceRef,"bpmn:ExclusiveGateway")||(0,_ModelUtil.is)(businessObject.sourceRef,"bpmn:InclusiveGateway")||(0,_ModelUtil.is)(businessObject.sourceRef,"bpmn:ComplexGateway")||(0,_ModelUtil.is)(businessObject.sourceRef,"bpmn:Activity"))&&menuEntries.push(self._createMenuEntry(entry,element,function(){modeling.updateProperties(element.source,{default:businessObject})}));break;case"replace-with-conditional-flow":!businessObject.conditionExpression&&(0,_ModelUtil.is)(businessObject.sourceRef,"bpmn:Activity")&&menuEntries.push(self._createMenuEntry(entry,element,function(){var conditionExpression=moddle.create("bpmn:FormalExpression",{body:""});modeling.updateProperties(element,{conditionExpression:conditionExpression})}));break;default:if((0,_ModelUtil.is)(businessObject.sourceRef,"bpmn:Activity")&&businessObject.conditionExpression)return menuEntries.push(self._createMenuEntry(entry,element,function(){modeling.updateProperties(element,{conditionExpression:void 0})}));if(((0,_ModelUtil.is)(businessObject.sourceRef,"bpmn:ExclusiveGateway")||(0,_ModelUtil.is)(businessObject.sourceRef,"bpmn:InclusiveGateway")||(0,_ModelUtil.is)(businessObject.sourceRef,"bpmn:ComplexGateway")||(0,_ModelUtil.is)(businessObject.sourceRef,"bpmn:Activity"))&&businessObject.sourceRef.default===businessObject)return menuEntries.push(self._createMenuEntry(entry,element,function(){modeling.updateProperties(element.source,{default:void 0})}))}}),menuEntries},ReplaceMenuProvider.prototype._createMenuEntry=function(definition,element,action){var translate=this._translate,replaceElement=this._bpmnReplace.replaceElement;return action=action||function(){return replaceElement(element,definition.target)},{label:translate(definition.label),className:definition.className,id:definition.actionName,action:action}},ReplaceMenuProvider.prototype._getLoopEntries=function(element){var self=this,translate=this._translate;function toggleLoopEntry(event,entry){var loopCharacteristics;entry.active?loopCharacteristics=void 0:(loopCharacteristics=self._moddle.create(entry.options.loopCharacteristics),entry.options.isSequential&&(loopCharacteristics.isSequential=entry.options.isSequential)),self._modeling.updateProperties(element,{loopCharacteristics:loopCharacteristics})}var isSequential,isLoop,isParallel,loopCharacteristics=(0,_ModelUtil.getBusinessObject)(element).loopCharacteristics;return loopCharacteristics&&(isSequential=loopCharacteristics.isSequential,isLoop=void 0===loopCharacteristics.isSequential,isParallel=void 0!==loopCharacteristics.isSequential&&!loopCharacteristics.isSequential),[{id:"toggle-parallel-mi",className:"bpmn-icon-parallel-mi-marker",title:translate("Parallel Multi Instance"),active:isParallel,action:toggleLoopEntry,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!1}},{id:"toggle-sequential-mi",className:"bpmn-icon-sequential-mi-marker",title:translate("Sequential Multi Instance"),active:isSequential,action:toggleLoopEntry,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!0}},{id:"toggle-loop",className:"bpmn-icon-loop-marker",title:translate("Loop"),active:isLoop,action:toggleLoopEntry,options:{loopCharacteristics:"bpmn:StandardLoopCharacteristics"}}]},ReplaceMenuProvider.prototype._getAdHocEntry=function(element){var translate=this._translate,businessObject=(0,_ModelUtil.getBusinessObject)(element),isAdHoc=(0,_ModelUtil.is)(businessObject,"bpmn:AdHocSubProcess"),replaceElement=this._bpmnReplace.replaceElement;return{id:"toggle-adhoc",className:"bpmn-icon-ad-hoc-marker",title:translate("Ad-hoc"),active:isAdHoc,action:function(){return replaceElement(element,isAdHoc?{type:"bpmn:SubProcess"}:{type:"bpmn:AdHocSubProcess"},{autoResize:!1,layoutConnection:!1})}}}},{"../../util/DiUtil":175,"../../util/ModelUtil":177,"../replace/ReplaceOptions":159,"./util/TypeUtil":155,"min-dash":594}],154:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _popupMenu2=_interopRequireDefault(require("diagram-js/lib/features/popup-menu")),_replace2=_interopRequireDefault(require("../replace")),_ReplaceMenuProvider2=_interopRequireDefault(require("./ReplaceMenuProvider"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_popupMenu2.default,_replace2.default],__init__:["replaceMenuProvider"],replaceMenuProvider:["type",_ReplaceMenuProvider2.default]}},{"../replace":160,"./ReplaceMenuProvider":153,"diagram-js/lib/features/popup-menu":296}],155:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isDifferentType=function(element){return function(entry){var target=entry.target,businessObject=(0,_ModelUtil.getBusinessObject)(element),eventDefinition=businessObject.eventDefinitions&&businessObject.eventDefinitions[0],isTypeEqual=businessObject.$type===target.type,isEventDefinitionEqual=(eventDefinition&&eventDefinition.$type)===target.eventDefinitionType,isTriggeredByEventEqual=businessObject.triggeredByEvent===target.triggeredByEvent,isExpandedEqual=void 0===target.isExpanded||target.isExpanded===(0,_DiUtil.isExpanded)(businessObject);return!(isTypeEqual&&isEventDefinitionEqual&&isTriggeredByEventEqual&&isExpandedEqual)}};var _ModelUtil=require("../../../util/ModelUtil"),_DiUtil=require("../../../util/DiUtil")},{"../../../util/DiUtil":175,"../../../util/ModelUtil":177}],156:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BpmnReplacePreview;var _CommandInterceptor2=_interopRequireDefault(require("diagram-js/lib/command/CommandInterceptor")),_inherits2=_interopRequireDefault(require("inherits")),_css2=_interopRequireDefault(require("css.escape")),_minDash=require("min-dash"),_minDom=require("min-dom"),_tinySvg=require("tiny-svg");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var LOW_PRIORITY=250;function BpmnReplacePreview(eventBus,elementRegistry,elementFactory,canvas,previewSupport){_CommandInterceptor2.default.call(this,eventBus),eventBus.on("shape.move.move",LOW_PRIORITY,function(event){var context=event.context,canExecute=context.canExecute;context.visualReplacements||(context.visualReplacements={}),(canExecute&&canExecute.replacements?function(context){var replacements=context.canExecute.replacements;(0,_minDash.forEach)(replacements,function(replacement){var element,tempShape,gfx,dragger,id=replacement.oldElementId,newElement={type:replacement.newElementType};context.visualReplacements[id]||(element=elementRegistry.get(id),(0,_minDash.assign)(newElement,{x:element.x,y:element.y}),tempShape=elementFactory.createShape(newElement),canvas.addShape(tempShape,element.parent),(gfx=(0,_minDom.query)('[data-element-id="'+(0,_css2.default)(element.id)+'"]',context.dragGroup))&&(0,_tinySvg.attr)(gfx,{display:"none"}),dragger=previewSupport.addDragger(tempShape,context.dragGroup),context.visualReplacements[id]=dragger,canvas.removeShape(tempShape))})}:function(context){var visualReplacements=context.visualReplacements;(0,_minDash.forEach)(visualReplacements,function(dragger,id){var originalGfx=(0,_minDom.query)('[data-element-id="'+(0,_css2.default)(id)+'"]',context.dragGroup);originalGfx&&(0,_tinySvg.attr)(originalGfx,{display:"inline"}),dragger.remove(),visualReplacements[id]&&delete visualReplacements[id]})})(context)})}BpmnReplacePreview.$inject=["eventBus","elementRegistry","elementFactory","canvas","previewSupport"],(0,_inherits2.default)(BpmnReplacePreview,_CommandInterceptor2.default)},{"css.escape":367,"diagram-js/lib/command/CommandInterceptor":181,inherits:385,"min-dash":594,"min-dom":595,"tiny-svg":606}],157:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _previewSupport2=_interopRequireDefault(require("diagram-js/lib/features/preview-support")),_BpmnReplacePreview2=_interopRequireDefault(require("./BpmnReplacePreview"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_previewSupport2.default],__init__:["bpmnReplacePreview"],bpmnReplacePreview:["type",_BpmnReplacePreview2.default]}},{"./BpmnReplacePreview":156,"diagram-js/lib/features/preview-support":298}],158:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BpmnReplace;var _minDash=require("min-dash"),_ModelUtil=require("../../util/ModelUtil"),_ModelingUtil=require("../modeling/util/ModelingUtil"),_DiUtil=require("../../util/DiUtil"),_ModdleCopy=require("../copy-paste/ModdleCopy");var CUSTOM_PROPERTIES=["cancelActivity","instantiate","eventGatewayType","triggeredByEvent","isInterrupting"];function BpmnReplace(bpmnFactory,elementFactory,moddleCopy,modeling,replace,selection){this.replaceElement=function(element,target,hints){hints=hints||{};var type=target.type,oldBusinessObject=element.businessObject;if(isSubProcess(oldBusinessObject)&&"bpmn:SubProcess"===type&&function(element,target){var oldCollapsed=element&&(0,_minDash.has)(element,"collapsed")?element.collapsed:!(0,_DiUtil.isExpanded)(element),targetCollapsed=target&&((0,_minDash.has)(target,"collapsed")||(0,_minDash.has)(target,"isExpanded"))?(0,_minDash.has)(target,"collapsed")?target.collapsed:!target.isExpanded:oldCollapsed;return oldCollapsed!==targetCollapsed?(element.collapsed=oldCollapsed,1):void 0}(element,target))return modeling.toggleCollapse(element),element;var a2,newElement={type:type,businessObject:newBusinessObject=bpmnFactory.create(type)},elementProps=(0,_ModdleCopy.getPropertyNames)(oldBusinessObject.$descriptor),newElementProps=(0,_ModdleCopy.getPropertyNames)(newBusinessObject.$descriptor,!0),copyProps=(a2=newElementProps,elementProps.filter(function(el){return-1!==a2.indexOf(el)}));(0,_minDash.assign)(newBusinessObject,(0,_minDash.pick)(target,CUSTOM_PROPERTIES));var properties=(0,_minDash.filter)(copyProps,function(propertyName){return"eventDefinitions"===propertyName?hasEventDefinition(element,target.eventDefinitionType):"loopCharacteristics"===propertyName?!(0,_DiUtil.isEventSubProcess)(newBusinessObject):!newBusinessObject.hasOwnProperty(propertyName)&&(("processRef"!==propertyName||!1!==target.isExpanded)&&"triggeredByEvent"!==propertyName)}),newBusinessObject=moddleCopy.copyElement(oldBusinessObject,newBusinessObject,properties);return target.eventDefinitionType&&(hasEventDefinition(newBusinessObject,target.eventDefinitionType)||(newElement.eventDefinitionType=target.eventDefinitionType,newElement.eventDefinitionAttrs=target.eventDefinitionAttrs)),(0,_ModelUtil.is)(oldBusinessObject,"bpmn:Activity")&&(isSubProcess(oldBusinessObject)?newElement.isExpanded=(0,_DiUtil.isExpanded)(oldBusinessObject):target&&(0,_minDash.has)(target,"isExpanded")&&(newElement.isExpanded=target.isExpanded),(0,_DiUtil.isExpanded)(oldBusinessObject)&&!(0,_ModelUtil.is)(oldBusinessObject,"bpmn:Task")&&newElement.isExpanded&&(newElement.width=element.width,newElement.height=element.height)),isSubProcess(oldBusinessObject)&&!isSubProcess(newBusinessObject)&&(hints.moveChildren=!1),(0,_ModelUtil.is)(oldBusinessObject,"bpmn:Participant")&&(!0===target.isExpanded?newBusinessObject.processRef=bpmnFactory.create("bpmn:Process"):hints.moveChildren=!1,newElement.width=element.width,newElement.height=elementFactory._getDefaultSize(newBusinessObject).height),newBusinessObject.name=oldBusinessObject.name,(0,_ModelingUtil.isAny)(oldBusinessObject,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&(0,_ModelingUtil.isAny)(newBusinessObject,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&(newBusinessObject.default=oldBusinessObject.default),target.host&&!(0,_ModelUtil.is)(oldBusinessObject,"bpmn:BoundaryEvent")&&(0,_ModelUtil.is)(newBusinessObject,"bpmn:BoundaryEvent")&&(newElement.host=target.host),newElement.di={},function(source,target,properties){(0,_minDash.isArray)(properties)||(properties=[properties]),(0,_minDash.forEach)(properties,function(property){(0,_minDash.isUndefined)(source[property])||(target[property]=source[property])})}(oldBusinessObject.di,newElement.di,["fill","stroke"]),newElement=replace.replaceElement(element,newElement,hints),!1!==hints.select&&selection.select(newElement),newElement}}function isSubProcess(bo){return(0,_ModelUtil.is)(bo,"bpmn:SubProcess")}function hasEventDefinition(element,type){var bo=(0,_ModelUtil.getBusinessObject)(element);return type&&bo.get("eventDefinitions").some(function(definition){return(0,_ModelUtil.is)(definition,type)})}BpmnReplace.$inject=["bpmnFactory","elementFactory","moddleCopy","modeling","replace","selection"]},{"../../util/DiUtil":175,"../../util/ModelUtil":177,"../copy-paste/ModdleCopy":69,"../modeling/util/ModelingUtil":148,"min-dash":594}],159:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.START_EVENT=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message Start Event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Start Event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional Start Event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal Start Event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],exports.START_EVENT_SUB_PROCESS=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}}],exports.INTERMEDIATE_EVENT=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message Intermediate Catch Event",actionName:"replace-with-message-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message Intermediate Throw Event",actionName:"replace-with-message-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-message",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Intermediate Catch Event",actionName:"replace-with-timer-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation Intermediate Throw Event",actionName:"replace-with-escalation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-escalation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional Intermediate Catch Event",actionName:"replace-with-conditional-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Link Intermediate Catch Event",actionName:"replace-with-link-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-link",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Link Intermediate Throw Event",actionName:"replace-with-link-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-link",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Compensation Intermediate Throw Event",actionName:"replace-with-compensation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-compensation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal Intermediate Catch Event",actionName:"replace-with-signal-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal Intermediate Throw Event",actionName:"replace-with-signal-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-signal",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],exports.END_EVENT=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message End Event",actionName:"replace-with-message-end",className:"bpmn-icon-end-event-message",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Escalation End Event",actionName:"replace-with-escalation-end",className:"bpmn-icon-end-event-escalation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Error End Event",actionName:"replace-with-error-end",className:"bpmn-icon-end-event-error",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel End Event",actionName:"replace-with-cancel-end",className:"bpmn-icon-end-event-cancel",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Compensation End Event",actionName:"replace-with-compensation-end",className:"bpmn-icon-end-event-compensation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal End Event",actionName:"replace-with-signal-end",className:"bpmn-icon-end-event-signal",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Terminate End Event",actionName:"replace-with-terminate-end",className:"bpmn-icon-end-event-terminate",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:TerminateEventDefinition"}}],exports.GATEWAY=[{label:"Exclusive Gateway",actionName:"replace-with-exclusive-gateway",className:"bpmn-icon-gateway-xor",target:{type:"bpmn:ExclusiveGateway"}},{label:"Parallel Gateway",actionName:"replace-with-parallel-gateway",className:"bpmn-icon-gateway-parallel",target:{type:"bpmn:ParallelGateway"}},{label:"Inclusive Gateway",actionName:"replace-with-inclusive-gateway",className:"bpmn-icon-gateway-or",target:{type:"bpmn:InclusiveGateway"}},{label:"Complex Gateway",actionName:"replace-with-complex-gateway",className:"bpmn-icon-gateway-complex",target:{type:"bpmn:ComplexGateway"}},{label:"Event based Gateway",actionName:"replace-with-event-based-gateway",className:"bpmn-icon-gateway-eventbased",target:{type:"bpmn:EventBasedGateway",instantiate:!1,eventGatewayType:"Exclusive"}}],exports.SUBPROCESS_EXPANDED=[{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Event Sub Process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}},{label:"Sub Process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}}],exports.TRANSACTION=[{label:"Sub Process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Event Sub Process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}}],exports.EVENT_SUB_PROCESS=[{label:"Sub Process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}}],exports.TASK=[{label:"Task",actionName:"replace-with-task",className:"bpmn-icon-task",target:{type:"bpmn:Task"}},{label:"Send Task",actionName:"replace-with-send-task",className:"bpmn-icon-send",target:{type:"bpmn:SendTask"}},{label:"Receive Task",actionName:"replace-with-receive-task",className:"bpmn-icon-receive",target:{type:"bpmn:ReceiveTask"}},{label:"User Task",actionName:"replace-with-user-task",className:"bpmn-icon-user",target:{type:"bpmn:UserTask"}},{label:"Manual Task",actionName:"replace-with-manual-task",className:"bpmn-icon-manual",target:{type:"bpmn:ManualTask"}},{label:"Business Rule Task",actionName:"replace-with-rule-task",className:"bpmn-icon-business-rule",target:{type:"bpmn:BusinessRuleTask"}},{label:"Service Task",actionName:"replace-with-service-task",className:"bpmn-icon-service",target:{type:"bpmn:ServiceTask"}},{label:"Script Task",actionName:"replace-with-script-task",className:"bpmn-icon-script",target:{type:"bpmn:ScriptTask"}},{label:"Call Activity",actionName:"replace-with-call-activity",className:"bpmn-icon-call-activity",target:{type:"bpmn:CallActivity"}},{label:"Sub Process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}},{label:"Sub Process (expanded)",actionName:"replace-with-expanded-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}}],exports.BOUNDARY_EVENT=[{label:"Message Boundary Event",actionName:"replace-with-message-boundary",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Boundary Event",actionName:"replace-with-timer-boundary",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation Boundary Event",actionName:"replace-with-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional Boundary Event",actionName:"replace-with-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Error Boundary Event",actionName:"replace-with-error-boundary",className:"bpmn-icon-intermediate-event-catch-error",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel Boundary Event",actionName:"replace-with-cancel-boundary",className:"bpmn-icon-intermediate-event-catch-cancel",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Signal Boundary Event",actionName:"replace-with-signal-boundary",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Compensation Boundary Event",actionName:"replace-with-compensation-boundary",className:"bpmn-icon-intermediate-event-catch-compensation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Message Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-message-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!1}},{label:"Timer Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!1}},{label:"Escalation Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!1}},{label:"Conditional Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!1}},{label:"Signal Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!1}}],exports.EVENT_SUB_PROCESS_START_EVENT=[{label:"Message Start Event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Start Event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional Start Event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal Start Event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Error Start Event",actionName:"replace-with-error-start",className:"bpmn-icon-start-event-error",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Escalation Start Event",actionName:"replace-with-escalation-start",className:"bpmn-icon-start-event-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Compensation Start Event",actionName:"replace-with-compensation-start",className:"bpmn-icon-start-event-compensation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Message Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-message-start",className:"bpmn-icon-start-event-non-interrupting-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!1}},{label:"Timer Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-start",className:"bpmn-icon-start-event-non-interrupting-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!1}},{label:"Conditional Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-start",className:"bpmn-icon-start-event-non-interrupting-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!1}},{label:"Signal Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-start",className:"bpmn-icon-start-event-non-interrupting-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!1}},{label:"Escalation Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-start",className:"bpmn-icon-start-event-non-interrupting-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!1}}],exports.SEQUENCE_FLOW=[{label:"Sequence Flow",actionName:"replace-with-sequence-flow",className:"bpmn-icon-connection"},{label:"Default Flow",actionName:"replace-with-default-flow",className:"bpmn-icon-default-flow"},{label:"Conditional Flow",actionName:"replace-with-conditional-flow",className:"bpmn-icon-conditional-flow"}],exports.PARTICIPANT=[{label:"Expanded Pool",actionName:"replace-with-expanded-pool",className:"bpmn-icon-participant",target:{type:"bpmn:Participant",isExpanded:!0}},{label:"Collapsed Pool",actionName:"replace-with-collapsed-pool",className:"bpmn-icon-lane",target:{type:"bpmn:Participant",isExpanded:!1}}]},{}],160:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _copyPaste2=_interopRequireDefault(require("../copy-paste")),_replace2=_interopRequireDefault(require("diagram-js/lib/features/replace")),_selection2=_interopRequireDefault(require("diagram-js/lib/features/selection")),_BpmnReplace2=_interopRequireDefault(require("./BpmnReplace"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_copyPaste2.default,_replace2.default,_selection2.default],bpmnReplace:["type",_BpmnReplace2.default]}},{"../copy-paste":70,"./BpmnReplace":158,"diagram-js/lib/features/replace":300,"diagram-js/lib/features/selection":314}],161:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BpmnRules;var _minDash=require("min-dash"),_inherits2=_interopRequireDefault(require("inherits")),_ModelUtil=require("../../util/ModelUtil"),_ModelingUtil=require("../modeling/util/ModelingUtil"),_LabelUtil=require("../../util/LabelUtil"),_DiUtil=require("../../util/DiUtil"),_RuleProvider2=_interopRequireDefault(require("diagram-js/lib/features/rules/RuleProvider")),_BpmnSnappingUtil=require("../snapping/BpmnSnappingUtil");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function BpmnRules(eventBus){_RuleProvider2.default.call(this,eventBus)}function nonExistingOrLabel(element){return!element||(0,_LabelUtil.isLabel)(element)}function getOrganizationalParent(element){do{if((0,_ModelUtil.is)(element,"bpmn:Process"))return(0,_ModelUtil.getBusinessObject)(element);if((0,_ModelUtil.is)(element,"bpmn:Participant"))return(0,_ModelUtil.getBusinessObject)(element).processRef||(0,_ModelUtil.getBusinessObject)(element)}while(element=element.parent)}function isTextAnnotation(element){return(0,_ModelUtil.is)(element,"bpmn:TextAnnotation")}function isGroup(element){return(0,_ModelUtil.is)(element,"bpmn:Group")&&!element.labelTarget}function isCompensationBoundary(element){return(0,_ModelUtil.is)(element,"bpmn:BoundaryEvent")&&hasEventDefinition(element,"bpmn:CompensateEventDefinition")}function isForCompensation(e){return(0,_ModelUtil.getBusinessObject)(e).isForCompensation}function getScopeParent(element){for(var parent=element;parent=parent.parent;){if((0,_ModelUtil.is)(parent,"bpmn:FlowElementsContainer"))return(0,_ModelUtil.getBusinessObject)(parent);if((0,_ModelUtil.is)(parent,"bpmn:Participant"))return(0,_ModelUtil.getBusinessObject)(parent).processRef}return null}function hasEventDefinition(element,eventDefinition){var bo=(0,_ModelUtil.getBusinessObject)(element);return!!(0,_minDash.find)(bo.eventDefinitions||[],function(definition){return(0,_ModelUtil.is)(definition,eventDefinition)})}function hasEventDefinitionOrNone(element,eventDefinition){return((0,_ModelUtil.getBusinessObject)(element).eventDefinitions||[]).every(function(definition){return(0,_ModelUtil.is)(definition,eventDefinition)})}function isEventBasedTarget(element){return(0,_ModelUtil.is)(element,"bpmn:ReceiveTask")||(0,_ModelUtil.is)(element,"bpmn:IntermediateCatchEvent")&&(hasEventDefinition(element,"bpmn:MessageEventDefinition")||hasEventDefinition(element,"bpmn:TimerEventDefinition")||hasEventDefinition(element,"bpmn:ConditionalEventDefinition")||hasEventDefinition(element,"bpmn:SignalEventDefinition"))}function isParent(possibleParent,element){return-1!==function(element){for(var parents=[];element;)(element=element.parent)&&parents.push(element);return parents}(element).indexOf(possibleParent)}function canConnect(source,target,connection){if(nonExistingOrLabel(source)||nonExistingOrLabel(target))return null;if(!(0,_ModelUtil.is)(connection,"bpmn:DataAssociation")){if(canConnectMessageFlow(source,target))return{type:"bpmn:MessageFlow"};if(canConnectSequenceFlow(source,target))return{type:"bpmn:SequenceFlow"}}var connectDataAssociation=canConnectDataAssociation(source,target);return connectDataAssociation||(isCompensationBoundary(source)&&isForCompensation(target)?{type:"bpmn:Association",associationDirection:"One"}:!!canConnectAssociation(source,target)&&{type:"bpmn:Association"})}function canDrop(element,target,position){return!(!(0,_LabelUtil.isLabel)(element)&&!isGroup(element))||!((0,_ModelUtil.is)(target,"bpmn:Participant")&&!(0,_DiUtil.isExpanded)(target))&&((0,_ModelUtil.is)(element,"bpmn:Participant")?(0,_ModelUtil.is)(target,"bpmn:Process")||(0,_ModelUtil.is)(target,"bpmn:Collaboration"):(0,_ModelingUtil.isAny)(element,["bpmn:DataInput","bpmn:DataOutput"])&&element.parent?target===element.parent:(0,_ModelUtil.is)(element,"bpmn:Lane")?(0,_ModelUtil.is)(target,"bpmn:Participant")||(0,_ModelUtil.is)(target,"bpmn:Lane"):!((0,_ModelUtil.is)(element,"bpmn:BoundaryEvent")&&(event=element,!(0,_ModelUtil.getBusinessObject)(event).cancelActivity||!hasNoEventDefinition(event)&&!hasCommonBoundaryIntermediateEventDefinition(event)))&&((0,_ModelUtil.is)(element,"bpmn:FlowElement")&&!(0,_ModelUtil.is)(element,"bpmn:DataStoreReference")?(0,_ModelUtil.is)(target,"bpmn:FlowElementsContainer")?(0,_DiUtil.isExpanded)(target):(0,_ModelingUtil.isAny)(target,["bpmn:Participant","bpmn:Lane"]):(0,_ModelingUtil.isAny)(element,["bpmn:Artifact","bpmn:DataAssociation","bpmn:DataStoreReference"])?(0,_ModelingUtil.isAny)(target,["bpmn:Collaboration","bpmn:Lane","bpmn:Participant","bpmn:Process","bpmn:SubProcess"]):!!(0,_ModelUtil.is)(element,"bpmn:MessageFlow")&&((0,_ModelUtil.is)(target,"bpmn:Collaboration")||element.source.parent==target||element.target.parent==target)));var event}function isLane(element){return(0,_ModelUtil.is)(element,"bpmn:Lane")}function isBoundaryCandidate(element){return function(element){return!(0,_LabelUtil.isLabel)(element)&&(0,_ModelUtil.is)(element,"bpmn:BoundaryEvent")}(element)||((0,_ModelUtil.is)(element,"bpmn:IntermediateThrowEvent")&&hasNoEventDefinition(element)||(0,_ModelUtil.is)(element,"bpmn:IntermediateCatchEvent")&&hasCommonBoundaryIntermediateEventDefinition(element))}function hasNoEventDefinition(element){var bo=(0,_ModelUtil.getBusinessObject)(element);return bo&&!(bo.eventDefinitions&&bo.eventDefinitions.length)}function hasCommonBoundaryIntermediateEventDefinition(element){return hasOneOfEventDefinitions(element,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])}function hasOneOfEventDefinitions(element,eventDefinitions){return eventDefinitions.some(function(definition){return hasEventDefinition(element,definition)})}function canAttach(elements,target,source,position){if(Array.isArray(elements)||(elements=[elements]),1!==elements.length)return!1;var element=elements[0];return!(0,_LabelUtil.isLabel)(element)&&(!!isBoundaryCandidate(element)&&(!(0,_DiUtil.isEventSubProcess)(target)&&(!(!(0,_ModelUtil.is)(target,"bpmn:Activity")||isForCompensation(target))&&(!(position&&!(0,_BpmnSnappingUtil.getBoundaryAttachment)(position,target))&&(!function(element){return(0,_ModelUtil.is)(element,"bpmn:ReceiveTask")&&(0,_minDash.find)(element.incoming,function(incoming){return(0,_ModelUtil.is)(incoming.source,"bpmn:EventBasedGateway")})}(target)&&"attach")))))}function canReplace(elements,target,position){if(!target)return!1;var canExecute={replacements:[]};return(0,_minDash.forEach)(elements,function(element){(0,_DiUtil.isEventSubProcess)(target)||(0,_ModelUtil.is)(element,"bpmn:StartEvent")&&"label"!==element.type&&canDrop(element,target)&&((0,_DiUtil.isInterrupting)(element)||canExecute.replacements.push({oldElementId:element.id,newElementType:"bpmn:StartEvent"}),((0,_DiUtil.hasErrorEventDefinition)(element)||(0,_DiUtil.hasEscalationEventDefinition)(element)||(0,_DiUtil.hasCompensateEventDefinition)(element))&&canExecute.replacements.push({oldElementId:element.id,newElementType:"bpmn:StartEvent"}),hasOneOfEventDefinitions(element,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])&&(0,_ModelUtil.is)(target,"bpmn:SubProcess")&&canExecute.replacements.push({oldElementId:element.id,newElementType:"bpmn:StartEvent"})),(0,_ModelUtil.is)(target,"bpmn:Transaction")||hasEventDefinition(element,"bpmn:CancelEventDefinition")&&"label"!==element.type&&((0,_ModelUtil.is)(element,"bpmn:EndEvent")&&canDrop(element,target)&&canExecute.replacements.push({oldElementId:element.id,newElementType:"bpmn:EndEvent"}),(0,_ModelUtil.is)(element,"bpmn:BoundaryEvent")&&canAttach(element,target,0,position)&&canExecute.replacements.push({oldElementId:element.id,newElementType:"bpmn:BoundaryEvent"}))}),!!canExecute.replacements.length&&canExecute}function canMove(elements,target){return!(0,_minDash.some)(elements,isLane)&&(!target||elements.every(function(element){return canDrop(element,target)}))}function canCreate(shape,target,source,position){return!!target&&(!(!(0,_LabelUtil.isLabel)(shape)&&!isGroup(shape))||source!==target&&((!source||!isParent(source,target))&&(canDrop(shape,target)||canInsert(shape,target))))}function canResize(shape,newBounds){return(0,_ModelUtil.is)(shape,"bpmn:SubProcess")?(0,_DiUtil.isExpanded)(shape)&&(!newBounds||100<=newBounds.width&&80<=newBounds.height):(0,_ModelUtil.is)(shape,"bpmn:Lane")?!newBounds||130<=newBounds.width&&60<=newBounds.height:(0,_ModelUtil.is)(shape,"bpmn:Participant")?!newBounds||250<=newBounds.width&&50<=newBounds.height:!!isTextAnnotation(shape)||!!isGroup(shape)}function canConnectAssociation(source,target){return!source.waypoints&&!target.waypoints&&(!(!isCompensationBoundary(source)||!isForCompensation(target))||!isParent(target,source)&&!isParent(source,target)&&(!!function(source,target){var sourceTextAnnotation=isTextAnnotation(source),targetTextAnnotation=isTextAnnotation(target);return(sourceTextAnnotation||targetTextAnnotation)&&sourceTextAnnotation!==targetTextAnnotation}(source,target)||!!canConnectDataAssociation(source,target)))}function canConnectMessageFlow(source,target){return!(getRootElement(source)&&!getRootElement(target))&&(element=source,(0,_ModelUtil.is)(element,"bpmn:InteractionNode")&&!(0,_ModelUtil.is)(element,"bpmn:BoundaryEvent")&&(!(0,_ModelUtil.is)(element,"bpmn:Event")||(0,_ModelUtil.is)(element,"bpmn:ThrowEvent")&&hasEventDefinitionOrNone(element,"bpmn:MessageEventDefinition"))&&function(element){return(0,_ModelUtil.is)(element,"bpmn:InteractionNode")&&!isForCompensation(element)&&(!(0,_ModelUtil.is)(element,"bpmn:Event")||(0,_ModelUtil.is)(element,"bpmn:CatchEvent")&&hasEventDefinitionOrNone(element,"bpmn:MessageEventDefinition"))&&!((0,_ModelUtil.is)(element,"bpmn:BoundaryEvent")&&!hasEventDefinition(element,"bpmn:MessageEventDefinition"))}(target)&&(b=target,!(getOrganizationalParent(source)===getOrganizationalParent(b))));var b,element}function canConnectSequenceFlow(source,target){return!(isEventBasedTarget(target)&&0<target.incoming.length&&(target.incoming||[]).some(isOutgoingEventBasedGatewayConnection)&&!(0,_ModelUtil.is)(source,"bpmn:EventBasedGateway"))&&(element=source,(0,_ModelUtil.is)(element,"bpmn:FlowNode")&&!(0,_ModelUtil.is)(element,"bpmn:EndEvent")&&!(0,_DiUtil.isEventSubProcess)(element)&&!((0,_ModelUtil.is)(element,"bpmn:IntermediateThrowEvent")&&hasEventDefinition(element,"bpmn:LinkEventDefinition"))&&!isCompensationBoundary(element)&&!isForCompensation(element)&&function(element){return(0,_ModelUtil.is)(element,"bpmn:FlowNode")&&!(0,_ModelUtil.is)(element,"bpmn:StartEvent")&&!(0,_ModelUtil.is)(element,"bpmn:BoundaryEvent")&&!(0,_DiUtil.isEventSubProcess)(element)&&!((0,_ModelUtil.is)(element,"bpmn:IntermediateCatchEvent")&&hasEventDefinition(element,"bpmn:LinkEventDefinition"))&&!isForCompensation(element)}(target)&&(b=target,getScopeParent(source)===getScopeParent(b))&&!((0,_ModelUtil.is)(source,"bpmn:EventBasedGateway")&&!isEventBasedTarget(target)));var b,element}function canConnectDataAssociation(source,target){return(0,_ModelingUtil.isAny)(source,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&(0,_ModelingUtil.isAny)(target,["bpmn:Activity","bpmn:ThrowEvent"])?{type:"bpmn:DataInputAssociation"}:!(!(0,_ModelingUtil.isAny)(target,["bpmn:DataObjectReference","bpmn:DataStoreReference"])||!(0,_ModelingUtil.isAny)(source,["bpmn:Activity","bpmn:CatchEvent"]))&&{type:"bpmn:DataOutputAssociation"}}function canInsert(shape,flow,position){if(!flow)return!1;if(Array.isArray(shape)){if(1!==shape.length)return!1;shape=shape[0]}return flow.source!==shape&&flow.target!==shape&&((0,_ModelingUtil.isAny)(flow,["bpmn:SequenceFlow","bpmn:MessageFlow"])&&!(0,_LabelUtil.isLabel)(flow)&&(0,_ModelUtil.is)(shape,"bpmn:FlowNode")&&!(0,_ModelUtil.is)(shape,"bpmn:BoundaryEvent")&&canDrop(shape,flow.parent))}function canCopy(elements,element){return!!(0,_LabelUtil.isLabel)(element)||!((0,_ModelUtil.is)(element,"bpmn:Lane")&&!function(elements,element){return elements&&element&&-1!==elements.indexOf(element)}(elements,element.parent))}function isOutgoingEventBasedGatewayConnection(connection){if(connection&&connection.source)return(0,_ModelUtil.is)(connection.source,"bpmn:EventBasedGateway")}function getRootElement(element){return(0,_ModelingUtil.getParent)(element,"bpmn:Process")||(0,_ModelingUtil.getParent)(element,"bpmn:Collaboration")}(0,_inherits2.default)(BpmnRules,_RuleProvider2.default),BpmnRules.$inject=["eventBus"],BpmnRules.prototype.init=function(){this.addRule("connection.start",function(context){return function(element){if(nonExistingOrLabel(element))return null;return(0,_ModelingUtil.isAny)(element,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference","bpmn:Group"])}(context.source)}),this.addRule("connection.create",function(context){var source=context.source,target=context.target,hints=context.hints||{},targetParent=hints.targetParent;if(hints.targetAttach)return!1;targetParent&&(target.parent=targetParent);try{return canConnect(source,target)}finally{targetParent&&(target.parent=null)}}),this.addRule("connection.reconnect",function(context){var connection=context.connection;return canConnect(context.source,context.target,connection)}),this.addRule("connection.updateWaypoints",function(context){return{type:context.connection.type}}),this.addRule("shape.resize",function(context){return canResize(context.shape,context.newBounds)}),this.addRule("elements.create",function(context){var elements=context.elements,position=context.position,target=context.target;return(0,_minDash.every)(elements,function(element){return element.waypoints?canConnect(element.source,element.target,element):element.host?canAttach(element,element.host,0,position):canCreate(element,target,null,position)})}),this.addRule("elements.move",function(context){var target=context.target,shapes=context.shapes,position=context.position;return canAttach(shapes,target,0,position)||canReplace(shapes,target,position)||canMove(shapes,target)||canInsert(shapes,target)}),this.addRule("shape.create",function(context){return canCreate(context.shape,context.target,context.source,context.position)}),this.addRule("shape.attach",function(context){return canAttach(context.shape,context.target,0,context.position)}),this.addRule("element.copy",function(context){var element=context.element;return canCopy(context.elements,element)})},BpmnRules.prototype.canConnectMessageFlow=canConnectMessageFlow,BpmnRules.prototype.canConnectSequenceFlow=canConnectSequenceFlow,BpmnRules.prototype.canConnectDataAssociation=canConnectDataAssociation,BpmnRules.prototype.canConnectAssociation=canConnectAssociation,BpmnRules.prototype.canMove=canMove,BpmnRules.prototype.canAttach=canAttach,BpmnRules.prototype.canReplace=canReplace,BpmnRules.prototype.canDrop=canDrop,BpmnRules.prototype.canInsert=canInsert,BpmnRules.prototype.canCreate=canCreate,BpmnRules.prototype.canConnect=canConnect,BpmnRules.prototype.canResize=canResize,BpmnRules.prototype.canCopy=canCopy},{"../../util/DiUtil":175,"../../util/LabelUtil":176,"../../util/ModelUtil":177,"../modeling/util/ModelingUtil":148,"../snapping/BpmnSnappingUtil":167,"diagram-js/lib/features/rules/RuleProvider":306,inherits:385,"min-dash":594}],162:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _rules2=_interopRequireDefault(require("diagram-js/lib/features/rules")),_BpmnRules2=_interopRequireDefault(require("./BpmnRules"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_rules2.default],__init__:["bpmnRules"],bpmnRules:["type",_BpmnRules2.default]}},{"./BpmnRules":161,"diagram-js/lib/features/rules":308}],163:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BpmnSearchProvider;var _minDash=require("min-dash"),_LabelUtil=require("../label-editing/LabelUtil");function BpmnSearchProvider(elementRegistry,searchPad,canvas){this._elementRegistry=elementRegistry,this._canvas=canvas,searchPad.registerProvider(this)}function hasMatched(tokens){return 0<(0,_minDash.filter)(tokens,function(t){return!!t.matched}).length}function matchAndSplit(text,pattern){var tokens=[],originalText=text;if(!text)return tokens;text=text.toLowerCase(),pattern=pattern.toLowerCase();var i=text.indexOf(pattern);return-1<i?(0!==i&&tokens.push({normal:originalText.substr(0,i)}),tokens.push({matched:originalText.substr(i,pattern.length)}),pattern.length+i<text.length&&tokens.push({normal:originalText.substr(pattern.length+i,text.length)})):tokens.push({normal:originalText}),tokens}BpmnSearchProvider.$inject=["elementRegistry","searchPad","canvas"],BpmnSearchProvider.prototype.find=function(pattern){var rootElement=this._canvas.getRootElement(),elements=this._elementRegistry.filter(function(element){return!element.labelTarget}),elements=(0,_minDash.filter)(elements,function(element){return element!==rootElement});return elements=(0,_minDash.map)(elements,function(element){return{primaryTokens:matchAndSplit((0,_LabelUtil.getLabel)(element),pattern),secondaryTokens:matchAndSplit(element.id,pattern),element:element}}),elements=(0,_minDash.filter)(elements,function(element){return hasMatched(element.primaryTokens)||hasMatched(element.secondaryTokens)}),(0,_minDash.sortBy)(elements,function(element){return(0,_LabelUtil.getLabel)(element.element)+element.element.id})}},{"../label-editing/LabelUtil":89,"min-dash":594}],164:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _searchPad2=_interopRequireDefault(require("diagram-js/lib/features/search-pad")),_BpmnSearchProvider2=_interopRequireDefault(require("./BpmnSearchProvider"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_searchPad2.default],__init__:["bpmnSearch"],bpmnSearch:["type",_BpmnSearchProvider2.default]}},{"./BpmnSearchProvider":163,"diagram-js/lib/features/search-pad":310}],165:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BpmnConnectSnapping;var _SnapUtil=require("diagram-js/lib/features/snapping/SnapUtil"),_KeyboardUtil=require("diagram-js/lib/features/keyboard/KeyboardUtil"),_LayoutUtil=require("diagram-js/lib/layout/LayoutUtil"),_ModelUtil=require("../../util/ModelUtil"),_ModelingUtil=require("../modeling/util/ModelingUtil"),_minDash=require("min-dash"),HIGHER_PRIORITY=1250,BOUNDARY_TO_HOST_THRESHOLD=40,TARGET_BOUNDS_PADDING=20,TASK_BOUNDS_PADDING=10,TARGET_CENTER_PADDING=20,AXES=["x","y"],abs=Math.abs;function BpmnConnectSnapping(eventBus){eventBus.on(["connect.hover","connect.move","connect.end"],HIGHER_PRIORITY,function(event){var attrs,types,context=event.context,canExecute=context.canExecute,start=context.start,hover=context.hover,source=context.source,target=context.target;event.originalEvent&&(0,_KeyboardUtil.isCmd)(event.originalEvent)||(context.initialConnectionStart||(context.initialConnectionStart=context.connectionStart),canExecute&&hover&&function(event,target,padding){AXES.forEach(function(axis){var dimensionForAxis=getDimensionForAxis(axis,target);event[axis]<target[axis]+padding?(0,_SnapUtil.setSnapped)(event,axis,target[axis]+padding):event[axis]>target[axis]+dimensionForAxis-padding&&(0,_SnapUtil.setSnapped)(event,axis,target[axis]+dimensionForAxis-padding)})}(event,hover,function(target){return(0,_ModelUtil.is)(target,"bpmn:Task")?TASK_BOUNDS_PADDING:TARGET_BOUNDS_PADDING}(hover)),hover&&(attrs=canExecute,types=["bpmn:Association","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:SequenceFlow"],(0,_minDash.some)(types,function(type){return isType(attrs,type)}))?(context.connectionStart=(0,_SnapUtil.mid)(start),(0,_ModelingUtil.isAny)(hover,["bpmn:Event","bpmn:Gateway"])&&snapToPosition(event,(0,_SnapUtil.mid)(hover)),(0,_ModelingUtil.isAny)(hover,["bpmn:Task","bpmn:SubProcess"])&&function(event,target){var targetMid=(0,_SnapUtil.mid)(target);AXES.forEach(function(axis){!function(event,target,axis){return event[axis]>target[axis]+TARGET_CENTER_PADDING&&event[axis]<target[axis]+getDimensionForAxis(axis,target)-TARGET_CENTER_PADDING}(event,target,axis)||(0,_SnapUtil.setSnapped)(event,axis,targetMid[axis])})}(event,hover),(0,_ModelUtil.is)(source,"bpmn:BoundaryEvent")&&target===source.host&&function(event){var context=event.context,source=context.source,target=context.target;if(function(context){var hover=context.hover,source=context.source;return hover&&source&&hover===source}(context))return;var sourceMid=(0,_SnapUtil.mid)(source),orientation=(0,_LayoutUtil.getOrientation)(sourceMid,target,-10),axes=[];/top|bottom/.test(orientation)&&axes.push("x");/left|right/.test(orientation)&&axes.push("y");axes.forEach(function(axis){var newCoordinate,coordinate=event[axis];abs(coordinate-sourceMid[axis])<BOUNDARY_TO_HOST_THRESHOLD&&(newCoordinate=coordinate>sourceMid[axis]?sourceMid[axis]+BOUNDARY_TO_HOST_THRESHOLD:sourceMid[axis]-BOUNDARY_TO_HOST_THRESHOLD,(0,_SnapUtil.setSnapped)(event,axis,newCoordinate))})}(event)):isType(canExecute,"bpmn:MessageFlow")?((0,_ModelUtil.is)(start,"bpmn:Event")&&(context.connectionStart=(0,_SnapUtil.mid)(start)),(0,_ModelUtil.is)(hover,"bpmn:Event")&&snapToPosition(event,(0,_SnapUtil.mid)(hover))):context.connectionStart=context.initialConnectionStart)})}function snapToPosition(event,position){(0,_SnapUtil.setSnapped)(event,"x",position.x),(0,_SnapUtil.setSnapped)(event,"y",position.y)}function isType(attrs,type){return attrs&&attrs.type===type}function getDimensionForAxis(axis,element){return"x"===axis?element.width:element.height}BpmnConnectSnapping.$inject=["eventBus"]},{"../../util/ModelUtil":177,"../modeling/util/ModelingUtil":148,"diagram-js/lib/features/keyboard/KeyboardUtil":252,"diagram-js/lib/features/snapping/SnapUtil":318,"diagram-js/lib/layout/LayoutUtil":336,"min-dash":594}],166:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BpmnCreateMoveSnapping;var _inherits2=_interopRequireDefault(require("inherits")),_CreateMoveSnapping2=_interopRequireDefault(require("diagram-js/lib/features/snapping/CreateMoveSnapping")),_SnapUtil=require("diagram-js/lib/features/snapping/SnapUtil"),_DiUtil=require("../../util/DiUtil"),_ModelUtil=require("../../util/ModelUtil"),_LayoutUtil=require("diagram-js/lib/layout/LayoutUtil"),_BpmnSnappingUtil=require("./BpmnSnappingUtil"),_minDash=require("min-dash");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var HIGH_PRIORITY=1500;function BpmnCreateMoveSnapping(eventBus,injector){injector.invoke(_CreateMoveSnapping2.default,this),eventBus.on(["create.move","create.end"],HIGH_PRIORITY,setSnappedIfConstrained),eventBus.on(["create.move","create.end","shape.move.move","shape.move.end"],HIGH_PRIORITY,function(event){var context=event.context,canExecute=context.canExecute,target=context.target;!canExecute||"attach"!==canExecute&&!canExecute.attach||(0,_SnapUtil.isSnapped)(event)||function(event,target){var offset,targetTRBL=(0,_LayoutUtil.asTRBL)(target),direction=(0,_BpmnSnappingUtil.getBoundaryAttachment)(event,target),shape=event.context.shape;offset=shape.parent?{x:0,y:0}:(0,_LayoutUtil.getMid)(shape);/top/.test(direction)?(0,_SnapUtil.setSnapped)(event,"y",targetTRBL.top-offset.y):/bottom/.test(direction)&&(0,_SnapUtil.setSnapped)(event,"y",targetTRBL.bottom-offset.y);/left/.test(direction)?(0,_SnapUtil.setSnapped)(event,"x",targetTRBL.left-offset.x):/right/.test(direction)&&(0,_SnapUtil.setSnapped)(event,"x",targetTRBL.right-offset.x)}(event,target)})}function setSnappedIfConstrained(event){var top,right,bottom,left,createConstraints=event.context.createConstraints;createConstraints&&(top=createConstraints.top,right=createConstraints.right,bottom=createConstraints.bottom,((left=createConstraints.left)&&left>=event.x||right&&right<=event.x)&&(0,_SnapUtil.setSnapped)(event,"x",event.x),(top&&top>=event.y||bottom&&bottom<=event.y)&&(0,_SnapUtil.setSnapped)(event,"y",event.y))}function includes(array,value){return-1!==array.indexOf(value)}function getDockingSnapOrigin(docking,isMove,event){return isMove?{x:docking.x-event.x,y:docking.y-event.y}:{x:docking.x,y:docking.y}}(0,_inherits2.default)(BpmnCreateMoveSnapping,_CreateMoveSnapping2.default),BpmnCreateMoveSnapping.$inject=["eventBus","injector"],BpmnCreateMoveSnapping.prototype.initSnap=function(event){var snapContext=_CreateMoveSnapping2.default.prototype.initSnap.call(this,event),shape=event.shape,isMove=!!this._elementRegistry.get(shape.id);return(0,_minDash.forEach)(shape.outgoing,function(connection){var docking=(docking=connection.waypoints[0]).original||docking;snapContext.setSnapOrigin(connection.id+"-docking",getDockingSnapOrigin(docking,isMove,event))}),(0,_minDash.forEach)(shape.incoming,function(connection){var docking=(docking=connection.waypoints[connection.waypoints.length-1]).original||docking;snapContext.setSnapOrigin(connection.id+"-docking",getDockingSnapOrigin(docking,isMove,event))}),(0,_ModelUtil.is)(shape,"bpmn:Participant")&&snapContext.setSnapLocations(["top-left","bottom-right","mid"]),snapContext},BpmnCreateMoveSnapping.prototype.addSnapTargetPoints=function(snapPoints,shape,target){_CreateMoveSnapping2.default.prototype.addSnapTargetPoints.call(this,snapPoints,shape,target);var snapTargets=this.getSnapTargets(shape,target);(0,_minDash.forEach)(snapTargets,function(snapTarget){var type;(function(element){if((0,_ModelUtil.is)(element,"bpmn:SubProcess")&&(0,_DiUtil.isExpanded)(element))return!0;return(0,_ModelUtil.is)(element,"bpmn:Participant")}(snapTarget)||(type="bpmn:TextAnnotation",[shape,snapTarget].every(function(el){return(0,_ModelUtil.is)(el,type)})))&&(snapPoints.add("top-left",(0,_SnapUtil.topLeft)(snapTarget)),snapPoints.add("bottom-right",(0,_SnapUtil.bottomRight)(snapTarget)))});var elementRegistry=this._elementRegistry;return(0,_minDash.forEach)(shape.incoming,function(connection){var docking;elementRegistry.get(shape.id)&&(includes(snapTargets,connection.source)||snapPoints.add("mid",(0,_LayoutUtil.getMid)(connection.source)),docking=connection.waypoints[0],snapPoints.add(connection.id+"-docking",docking.original||docking))}),(0,_minDash.forEach)(shape.outgoing,function(connection){var docking;elementRegistry.get(shape.id)&&(includes(snapTargets,connection.target)||snapPoints.add("mid",(0,_LayoutUtil.getMid)(connection.target)),docking=connection.waypoints[connection.waypoints.length-1],snapPoints.add(connection.id+"-docking",docking.original||docking))}),(0,_ModelUtil.is)(target,"bpmn:SequenceFlow")&&(snapPoints=this.addSnapTargetPoints(snapPoints,shape,target.parent)),snapPoints},BpmnCreateMoveSnapping.prototype.getSnapTargets=function(shape,target){return _CreateMoveSnapping2.default.prototype.getSnapTargets.call(this,shape,target).filter(function(snapTarget){return!(0,_ModelUtil.is)(snapTarget,"bpmn:Lane")})}},{"../../util/DiUtil":175,"../../util/ModelUtil":177,"./BpmnSnappingUtil":167,"diagram-js/lib/features/snapping/CreateMoveSnapping":315,"diagram-js/lib/features/snapping/SnapUtil":318,"diagram-js/lib/layout/LayoutUtil":336,inherits:385,"min-dash":594}],167:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getBoundaryAttachment=function(position,targetBounds){var orientation=(0,_LayoutUtil.getOrientation)(position,targetBounds,-15);return"intersect"!==orientation?orientation:null};var _LayoutUtil=require("diagram-js/lib/layout/LayoutUtil")},{"diagram-js/lib/layout/LayoutUtil":336}],168:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _BpmnConnectSnapping2=_interopRequireDefault(require("./BpmnConnectSnapping")),_BpmnCreateMoveSnapping2=_interopRequireDefault(require("./BpmnCreateMoveSnapping")),_snapping2=_interopRequireDefault(require("diagram-js/lib/features/snapping"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_snapping2.default],__init__:["connectSnapping","createMoveSnapping"],connectSnapping:["type",_BpmnConnectSnapping2.default],createMoveSnapping:["type",_BpmnCreateMoveSnapping2.default]}},{"./BpmnConnectSnapping":165,"./BpmnCreateMoveSnapping":166,"diagram-js/lib/features/snapping":320}],169:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BpmnImporter;var _minDash=require("min-dash"),_ModelUtil=require("../util/ModelUtil"),_LabelUtil=require("../util/LabelUtil"),_LayoutUtil=require("diagram-js/lib/layout/LayoutUtil"),_DiUtil=require("../util/DiUtil"),_LabelUtil2=require("../features/label-editing/LabelUtil"),_Util=require("./Util");function elementData(semantic,attrs){return(0,_minDash.assign)({id:semantic.id,type:semantic.$type,businessObject:semantic},attrs)}function notYetDrawn(translate,semantic,refSemantic,property){return new Error(translate("element {element} referenced by {referenced}#{property} not yet drawn",{element:(0,_Util.elementToString)(refSemantic),referenced:(0,_Util.elementToString)(semantic),property:property}))}function BpmnImporter(eventBus,canvas,elementFactory,elementRegistry,translate,textRenderer){this._eventBus=eventBus,this._canvas=canvas,this._elementFactory=elementFactory,this._elementRegistry=elementRegistry,this._translate=translate,this._textRenderer=textRenderer}BpmnImporter.$inject=["eventBus","canvas","elementFactory","elementRegistry","translate","textRenderer"],BpmnImporter.prototype.add=function(semantic,parentElement){var parentIndex,bbox,point,x,y,di=semantic.di,translate=this._translate;if((0,_ModelUtil.is)(di,"bpmndi:BPMNPlane"))element=this._elementFactory.createRoot(elementData(semantic)),this._canvas.setRootElement(element);else if((0,_ModelUtil.is)(di,"bpmndi:BPMNShape")){var collapsed=!(0,_DiUtil.isExpanded)(semantic),isFrame=function(semantic){return(0,_ModelUtil.is)(semantic,"bpmn:Group")}(semantic),hidden=parentElement&&(parentElement.hidden||parentElement.collapsed),bounds=semantic.di.bounds,element=this._elementFactory.createShape(elementData(semantic,{collapsed:collapsed,hidden:hidden,x:Math.round(bounds.x),y:Math.round(bounds.y),width:Math.round(bounds.width),height:Math.round(bounds.height),isFrame:isFrame}));(0,_ModelUtil.is)(semantic,"bpmn:BoundaryEvent")&&this._attachBoundary(semantic,element),(0,_ModelUtil.is)(semantic,"bpmn:Lane")&&(parentIndex=0),(0,_ModelUtil.is)(semantic,"bpmn:DataStoreReference")&&(bbox=parentElement,point=(0,_LayoutUtil.getMid)(bounds),x=point.x,y=point.y,x>=bbox.x&&x<=bbox.x+bbox.width&&y>=bbox.y&&y<=bbox.y+bbox.height||(parentElement=this._canvas.getRootElement())),this._canvas.addShape(element,parentElement,parentIndex)}else{if(!(0,_ModelUtil.is)(di,"bpmndi:BPMNEdge"))throw new Error(translate("unknown di {di} for element {semantic}",{di:(0,_Util.elementToString)(di),semantic:(0,_Util.elementToString)(semantic)}));var source=this._getSource(semantic),target=this._getTarget(semantic);hidden=parentElement&&(parentElement.hidden||parentElement.collapsed),element=this._elementFactory.createConnection(elementData(semantic,{hidden:hidden,source:source,target:target,waypoints:function(bo,source,target){var waypoints=bo.di.waypoint;return!waypoints||waypoints.length<2?[(0,_LayoutUtil.getMid)(source),(0,_LayoutUtil.getMid)(target)]:waypoints.map(function(p){return{x:p.x,y:p.y}})}(semantic,source,target)})),(0,_ModelUtil.is)(semantic,"bpmn:DataAssociation")&&(parentElement=null),(0,_ModelUtil.is)(semantic,"bpmn:SequenceFlow")&&(parentIndex=0),this._canvas.addConnection(element,parentElement,parentIndex)}return(0,_LabelUtil.isLabelExternal)(semantic)&&(0,_LabelUtil2.getLabel)(element)&&this.addLabel(semantic,element),this._eventBus.fire("bpmnElement.added",{element:element}),element},BpmnImporter.prototype._attachBoundary=function(boundarySemantic,boundaryElement){var translate=this._translate,hostSemantic=boundarySemantic.attachedToRef;if(!hostSemantic)throw new Error(translate("missing {semantic}#attachedToRef",{semantic:(0,_Util.elementToString)(boundarySemantic)}));var host=this._elementRegistry.get(hostSemantic.id),attachers=host&&host.attachers;if(!host)throw notYetDrawn(translate,boundarySemantic,hostSemantic,"attachedToRef");boundaryElement.host=host,attachers||(host.attachers=attachers=[]),-1===attachers.indexOf(boundaryElement)&&attachers.push(boundaryElement)},BpmnImporter.prototype.addLabel=function(semantic,element){var label,bounds=(0,_LabelUtil.getExternalLabelBounds)(semantic,element),text=(0,_LabelUtil2.getLabel)(element);return text&&(bounds=this._textRenderer.getExternalLabelBounds(bounds,text)),label=this._elementFactory.createLabel(elementData(semantic,{id:semantic.id+"_label",labelTarget:element,type:"label",hidden:element.hidden||!(0,_LabelUtil2.getLabel)(element),x:Math.round(bounds.x),y:Math.round(bounds.y),width:Math.round(bounds.width),height:Math.round(bounds.height)})),this._canvas.addShape(label,element.parent)},BpmnImporter.prototype._getEnd=function(semantic,side){var element,type=semantic.$type,translate=this._translate,refSemantic=semantic[side+"Ref"];if("source"===side&&"bpmn:DataInputAssociation"===type&&(refSemantic=refSemantic&&refSemantic[0]),("source"===side&&"bpmn:DataOutputAssociation"===type||"target"===side&&"bpmn:DataInputAssociation"===type)&&(refSemantic=semantic.$parent),element=refSemantic&&this._getElement(refSemantic))return element;throw refSemantic?notYetDrawn(translate,semantic,refSemantic,side+"Ref"):new Error(translate("{semantic}#{side} Ref not specified",{semantic:(0,_Util.elementToString)(semantic),side:side}))},BpmnImporter.prototype._getSource=function(semantic){return this._getEnd(semantic,"source")},BpmnImporter.prototype._getTarget=function(semantic){return this._getEnd(semantic,"target")},BpmnImporter.prototype._getElement=function(semantic){return this._elementRegistry.get(semantic.id)}},{"../features/label-editing/LabelUtil":89,"../util/DiUtil":175,"../util/LabelUtil":176,"../util/ModelUtil":177,"./Util":172,"diagram-js/lib/layout/LayoutUtil":336,"min-dash":594}],170:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(handler,translate){var handledElements={},deferred=[];function contextual(fn,ctx){return function(e){fn(e,ctx)}}function handled(element){handledElements[element.id]=element}function visitIfDi(element,ctx){try{var gfx=element.di&&function(element,ctx){if(element.gfx)throw new Error(translate("already rendered {element}",{element:(0,_Util.elementToString)(element)}));return handler.element(element,ctx)}(element,ctx);return handled(element),gfx}catch(e){logError(e.message,{element:element,error:e}),console.error(translate("failed to import {element}",{element:(0,_Util.elementToString)(element)})),console.error(e)}}function logError(message,context){handler.error(message,context)}function registerDi(di){var bpmnElement=di.bpmnElement;bpmnElement?bpmnElement.di?logError(translate("multiple DI elements defined for {element}",{element:(0,_Util.elementToString)(bpmnElement)}),{element:bpmnElement}):(diRefs.bind(bpmnElement,"di"),bpmnElement.di=di):logError(translate("no bpmnElement referenced in {element}",{element:(0,_Util.elementToString)(di)}),{element:di})}function handleDiagram(diagram){var plane;registerDi(plane=diagram.plane),(0,_minDash.forEach)(plane.planeElement,handlePlaneElement)}function handlePlaneElement(planeElement){registerDi(planeElement)}function handleDeferred(){for(;deferred.length;)deferred.shift()()}function handleProcess(process,context){handleFlowElementsContainer(process,context),handleIoSpecification(process.ioSpecification,context),handleArtifacts(process.artifacts,context),handled(process)}function handleMessageFlow(messageFlow,context){visitIfDi(messageFlow,context)}function handleDataAssociation(association,context){visitIfDi(association,context)}function handleDataInput(dataInput,context){visitIfDi(dataInput,context)}function handleDataOutput(dataOutput,context){visitIfDi(dataOutput,context)}function handleArtifact(artifact,context){visitIfDi(artifact,context)}function handleArtifacts(artifacts,context){(0,_minDash.forEach)(artifacts,function(e){is(e,"bpmn:Association")?deferred.push(function(){handleArtifact(e,context)}):handleArtifact(e,context)})}function handleIoSpecification(ioSpecification,context){ioSpecification&&((0,_minDash.forEach)(ioSpecification.dataInputs,contextual(handleDataInput,context)),(0,_minDash.forEach)(ioSpecification.dataOutputs,contextual(handleDataOutput,context)))}function handleSubProcess(subProcess,context){handleFlowElementsContainer(subProcess,context),handleArtifacts(subProcess.artifacts,context)}function handleFlowNode(flowNode,context){var childCtx=visitIfDi(flowNode,context);is(flowNode,"bpmn:SubProcess")&&handleSubProcess(flowNode,childCtx||context),is(flowNode,"bpmn:Activity")&&handleIoSpecification(flowNode.ioSpecification,context),deferred.push(function(){(0,_minDash.forEach)(flowNode.dataInputAssociations,contextual(handleDataAssociation,context)),(0,_minDash.forEach)(flowNode.dataOutputAssociations,contextual(handleDataAssociation,context))})}function handleDataElement(dataObject,context){visitIfDi(dataObject,context)}function handleLane(lane,context){deferred.push(function(){var newContext=visitIfDi(lane,context);lane.childLaneSet&&handleLaneSet(lane.childLaneSet,newContext||context),function(lane){(0,_minDash.forEach)(lane.flowNodeRef,function(flowNode){var lanes=flowNode.get("lanes");lanes&&lanes.push(lane)})}(lane)})}function handleLaneSet(laneSet,context){(0,_minDash.forEach)(laneSet.lanes,contextual(handleLane,context))}function handleFlowElementsContainer(container,context){!function(flowElements,context){(0,_minDash.forEach)(flowElements,function(e){is(e,"bpmn:SequenceFlow")?deferred.push(function(){!function(sequenceFlow,context){visitIfDi(sequenceFlow,context)}(e,context)}):is(e,"bpmn:BoundaryEvent")?deferred.unshift(function(){handleFlowNode(e,context)}):is(e,"bpmn:FlowNode")?handleFlowNode(e,context):is(e,"bpmn:DataObject")||(is(e,"bpmn:DataStoreReference")||is(e,"bpmn:DataObjectReference")?handleDataElement(e,context):logError(translate("unrecognized flowElement {element} in context {context}",{element:(0,_Util.elementToString)(e),context:context?(0,_Util.elementToString)(context.businessObject):"null"}),{element:e,context:context}))})}(container.flowElements,context),container.laneSets&&function(laneSets,context){(0,_minDash.forEach)(laneSets,contextual(handleLaneSet,context))}(container.laneSets,context)}function handleParticipant(participant,context){var newCtx=visitIfDi(participant,context),process=participant.processRef;process&&handleProcess(process,newCtx||context)}return{handleDeferred:handleDeferred,handleDefinitions:function(definitions,diagram){var diagrams=definitions.diagrams;if(diagram&&-1===diagrams.indexOf(diagram))throw new Error(translate("diagram not part of bpmn:Definitions"));if(!diagram&&diagrams&&diagrams.length&&(diagram=diagrams[0]),!diagram)throw new Error(translate("no diagram to display"));handleDiagram(diagram);var plane=diagram.plane;if(!plane)throw new Error(translate("no plane for {element}",{element:(0,_Util.elementToString)(diagram)}));var rootElement=plane.bpmnElement;if(!rootElement){if(!(rootElement=function(definitions){return(0,_minDash.find)(definitions.rootElements,function(e){return is(e,"bpmn:Process")||is(e,"bpmn:Collaboration")})}(definitions)))throw new Error(translate("no process or collaboration to display"));logError(translate("correcting missing bpmnElement on {plane} to {rootElement}",{plane:(0,_Util.elementToString)(plane),rootElement:(0,_Util.elementToString)(rootElement)})),plane.bpmnElement=rootElement,registerDi(plane)}var collaboration,ctx=function(element,diagram){return handler.root(element,diagram)}(rootElement,plane);if(is(rootElement,"bpmn:Process"))handleProcess(rootElement,ctx);else{if(!is(rootElement,"bpmn:Collaboration"))throw new Error(translate("unsupported bpmnElement for {plane}: {rootElement}",{plane:(0,_Util.elementToString)(plane),rootElement:(0,_Util.elementToString)(rootElement)}));collaboration=rootElement,(0,_minDash.forEach)(collaboration.participants,contextual(handleParticipant)),handleArtifacts(collaboration.artifacts),deferred.push(function(){var messageFlows,context;messageFlows=collaboration.messageFlows,(0,_minDash.forEach)(messageFlows,contextual(handleMessageFlow,context))}),function(rootElements,ctx){(0,_minDash.filter)(rootElements,function(e){return!handledElements[e.id]&&is(e,"bpmn:Process")&&e.laneSets}).forEach(contextual(handleProcess,ctx))}(definitions.rootElements,ctx)}handleDeferred()},handleSubProcess:handleSubProcess,registerDi:registerDi}};var obj,_minDash=require("min-dash"),_objectRefs=require("object-refs"),_objectRefs2=(obj=_objectRefs)&&obj.__esModule?obj:{default:obj},_Util=require("./Util");var diRefs=new _objectRefs2.default({name:"bpmnElement",enumerable:!0},{name:"di",configurable:!0});function is(element,type){return element.$instanceOf(type)}},{"./Util":172,"min-dash":594,"object-refs":599}],171:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.importBpmnDiagram=function(diagram,definitions,bpmnDiagram){var importer,eventBus,translate,warnings=[];return new Promise(function(resolve,reject){try{return importer=diagram.get("bpmnImporter"),eventBus=diagram.get("eventBus"),translate=diagram.get("translate"),eventBus.fire("import.render.start",{definitions:definitions}),function(definitions,bpmnDiagram){var visitor={root:function(element){return importer.add(element)},element:function(_element,parentShape){return importer.add(_element,parentShape)},error:function(message,context){warnings.push({message:message,context:context})}};new _BpmnTreeWalker2.default(visitor,translate).handleDefinitions(definitions,bpmnDiagram)}(definitions,bpmnDiagram),eventBus.fire("import.render.complete",{error:void 0,warnings:warnings}),resolve({warnings:warnings})}catch(e){return e.warnings=warnings,reject(e)}})};var obj,_BpmnTreeWalker=require("./BpmnTreeWalker"),_BpmnTreeWalker2=(obj=_BpmnTreeWalker)&&obj.__esModule?obj:{default:obj}},{"./BpmnTreeWalker":170}],172:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.elementToString=function(e){return e?"<"+e.$type+(e.id?' id="'+e.id:"")+'" />':"<null>"}},{}],173:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _translate2=_interopRequireDefault(require("diagram-js/lib/i18n/translate")),_BpmnImporter2=_interopRequireDefault(require("./BpmnImporter"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_translate2.default],bpmnImporter:["type",_BpmnImporter2.default]}},{"./BpmnImporter":169,"diagram-js/lib/i18n/translate":332}],174:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.wrapForCompatibility=function(api){return function(){if(!window.Promise)throw new Error("Promises is not supported in this environment. Please polyfill Promise.");var argLen=arguments.length;if(!(1<=argLen&&(0,_minDash.isFunction)(arguments[argLen-1])))return api.apply(this,arguments);var callback=arguments[argLen-1];console.warn(new Error("Passing callbacks to "+api.name+" is deprecated and will be removed in a future major release. Please switch to promises: https://bpmn.io/l/moving-to-promises.html"));var argsWithoutCallback=Array.prototype.slice.call(arguments,0,-1);api.apply(this,argsWithoutCallback).then(function(result){var firstKey=Object.keys(result)[0];return callback(null,result[firstKey])},function(err){return callback(err,err.warnings)})}};var _minDash=require("min-dash")},{"min-dash":594}],175:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isExpanded=function(element){if((0,_ModelUtil.is)(element,"bpmn:CallActivity"))return!1;if((0,_ModelUtil.is)(element,"bpmn:SubProcess"))return!!(0,_ModelUtil.getBusinessObject)(element).di.isExpanded;if((0,_ModelUtil.is)(element,"bpmn:Participant"))return!!(0,_ModelUtil.getBusinessObject)(element).processRef;return!0},exports.isInterrupting=function(element){return element&&!1!==(0,_ModelUtil.getBusinessObject)(element).isInterrupting},exports.isEventSubProcess=function(element){return element&&!!(0,_ModelUtil.getBusinessObject)(element).triggeredByEvent},exports.hasEventDefinition=hasEventDefinition,exports.hasErrorEventDefinition=function(element){return hasEventDefinition(element,"bpmn:ErrorEventDefinition")},exports.hasEscalationEventDefinition=function(element){return hasEventDefinition(element,"bpmn:EscalationEventDefinition")},exports.hasCompensateEventDefinition=function(element){return hasEventDefinition(element,"bpmn:CompensateEventDefinition")};var _ModelUtil=require("./ModelUtil"),_minDash=require("min-dash");function hasEventDefinition(element,eventType){var bo=(0,_ModelUtil.getBusinessObject)(element),hasEventDefinition=!1;return bo.eventDefinitions&&(0,_minDash.forEach)(bo.eventDefinitions,function(event){(0,_ModelUtil.is)(event,eventType)&&(hasEventDefinition=!0)}),hasEventDefinition}},{"./ModelUtil":177,"min-dash":594}],176:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FLOW_LABEL_INDENT=exports.DEFAULT_LABEL_SIZE=void 0,exports.isLabelExternal=function(semantic){return(0,_ModelUtil.is)(semantic,"bpmn:Event")||(0,_ModelUtil.is)(semantic,"bpmn:Gateway")||(0,_ModelUtil.is)(semantic,"bpmn:DataStoreReference")||(0,_ModelUtil.is)(semantic,"bpmn:DataObjectReference")||(0,_ModelUtil.is)(semantic,"bpmn:DataInput")||(0,_ModelUtil.is)(semantic,"bpmn:DataOutput")||(0,_ModelUtil.is)(semantic,"bpmn:SequenceFlow")||(0,_ModelUtil.is)(semantic,"bpmn:MessageFlow")||(0,_ModelUtil.is)(semantic,"bpmn:Group")},exports.hasExternalLabel=function(element){return isLabel(element.label)},exports.getFlowLabelPosition=getFlowLabelPosition,exports.getWaypointsMid=getWaypointsMid,exports.getExternalLabelMid=getExternalLabelMid,exports.getExternalLabelBounds=function(semantic,element){var mid,size,bounds,label=semantic.di.label;label&&label.bounds?(bounds=label.bounds,size={width:Math.max(DEFAULT_LABEL_SIZE.width,bounds.width),height:bounds.height},mid={x:bounds.x+bounds.width/2,y:bounds.y+bounds.height/2}):(mid=getExternalLabelMid(element),size=DEFAULT_LABEL_SIZE);return(0,_minDash.assign)({x:mid.x-size.width/2,y:mid.y-size.height/2},size)},exports.isLabel=isLabel;var _minDash=require("min-dash"),_ModelUtil=require("./ModelUtil"),DEFAULT_LABEL_SIZE=exports.DEFAULT_LABEL_SIZE={width:90,height:20},FLOW_LABEL_INDENT=exports.FLOW_LABEL_INDENT=15;function getFlowLabelPosition(waypoints){var mid=waypoints.length/2-1,first=waypoints[Math.floor(mid)],second=waypoints[Math.ceil(.01+mid)],position=getWaypointsMid(waypoints),angle=Math.atan((second.y-first.y)/(second.x-first.x)),x=position.x,y=position.y;return Math.abs(angle)<Math.PI/2?y-=FLOW_LABEL_INDENT:x+=FLOW_LABEL_INDENT,{x:x,y:y}}function getWaypointsMid(waypoints){var mid=waypoints.length/2-1,first=waypoints[Math.floor(mid)],second=waypoints[Math.ceil(.01+mid)];return{x:first.x+(second.x-first.x)/2,y:first.y+(second.y-first.y)/2}}function getExternalLabelMid(element){return element.waypoints?getFlowLabelPosition(element.waypoints):(0,_ModelUtil.is)(element,"bpmn:Group")?{x:element.x+element.width/2,y:element.y+DEFAULT_LABEL_SIZE.height/2}:{x:element.x+element.width/2,y:element.y+element.height+DEFAULT_LABEL_SIZE.height/2}}function isLabel(element){return element&&!!element.labelTarget}},{"./ModelUtil":177,"min-dash":594}],177:[function(require,module,exports){"use strict";function getBusinessObject(element){return element&&element.businessObject||element}Object.defineProperty(exports,"__esModule",{value:!0}),exports.is=function(element,type){var bo=getBusinessObject(element);return bo&&"function"==typeof bo.$instanceOf&&bo.$instanceOf(type)},exports.getBusinessObject=getBusinessObject},{}],178:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LINK_STYLES=exports.BPMNIO_IMG=void 0,exports.open=function(){lightbox||(lightbox=(0,_minDom.domify)(LIGHTBOX_MARKUP),_minDom.delegate.bind(lightbox,".backdrop","click",function(event){document.body.removeChild(lightbox)}));document.body.appendChild(lightbox)};var _minDom=require("min-dom");exports.BPMNIO_IMG='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14.02 5.57" width="53" height="21" style="vertical-align:middle"><path fill="currentColor" d="M1.88.92v.14c0 .41-.13.68-.4.8.33.14.46.44.46.86v.33c0 .61-.33.95-.95.95H0V0h.95c.65 0 .93.3.93.92zM.63.57v1.06h.24c.24 0 .38-.1.38-.43V.98c0-.28-.1-.4-.32-.4zm0 1.63v1.22h.36c.2 0 .32-.1.32-.39v-.35c0-.37-.12-.48-.4-.48H.63zM4.18.99v.52c0 .64-.31.98-.94.98h-.3V4h-.62V0h.92c.63 0 .94.35.94.99zM2.94.57v1.35h.3c.2 0 .3-.09.3-.37v-.6c0-.29-.1-.38-.3-.38h-.3zm2.89 2.27L6.25 0h.88v4h-.6V1.12L6.1 3.99h-.6l-.46-2.82v2.82h-.55V0h.87zM8.14 1.1V4h-.56V0h.79L9 2.4V0h.56v4h-.64zm2.49 2.29v.6h-.6v-.6zM12.12 1c0-.63.33-1 .95-1 .61 0 .95.37.95 1v2.04c0 .64-.34 1-.95 1-.62 0-.95-.37-.95-1zm.62 2.08c0 .28.13.39.33.39s.32-.1.32-.4V.98c0-.29-.12-.4-.32-.4s-.33.11-.33.4z"/><path fill="currentColor" d="M0 4.53h14.02v1.04H0zM11.08 0h.63v.62h-.63zm.63 4V1h-.63v2.98z"/></svg>';function css(attrs){return attrs.join(";")}var lightbox,LINK_STYLES=exports.LINK_STYLES=css(["color: #404040"]),LIGHTBOX_MARKUP='<div class="bjs-powered-by-lightbox" style="'+css(["z-index: 1001","position: fixed","top: 0","left: 0","right: 0","bottom: 0"])+'"><div class="backdrop" style="'+css(["width: 100%","height: 100%","background: rgba(40,40,40,0.2)"])+'"></div><div class="notice" style="'+css(["position: absolute","left: 50%","top: 40%","transform: translate(-50%)","width: 260px","padding: 10px","background: white","box-shadow: 0 1px 4px rgba(0,0,0,0.3)","font-family: Helvetica, Arial, sans-serif","font-size: 14px","display: flex","line-height: 1.3"])+'"><a href="https://bpmn.io" target="_blank" rel="noopener" style="margin: 15px 20px 15px 10px; align-self: center;'+LINK_STYLES+'"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14.02 5.57" width="53" height="21" style="vertical-align:middle"><path fill="currentColor" d="M1.88.92v.14c0 .41-.13.68-.4.8.33.14.46.44.46.86v.33c0 .61-.33.95-.95.95H0V0h.95c.65 0 .93.3.93.92zM.63.57v1.06h.24c.24 0 .38-.1.38-.43V.98c0-.28-.1-.4-.32-.4zm0 1.63v1.22h.36c.2 0 .32-.1.32-.39v-.35c0-.37-.12-.48-.4-.48H.63zM4.18.99v.52c0 .64-.31.98-.94.98h-.3V4h-.62V0h.92c.63 0 .94.35.94.99zM2.94.57v1.35h.3c.2 0 .3-.09.3-.37v-.6c0-.29-.1-.38-.3-.38h-.3zm2.89 2.27L6.25 0h.88v4h-.6V1.12L6.1 3.99h-.6l-.46-2.82v2.82h-.55V0h.87zM8.14 1.1V4h-.56V0h.79L9 2.4V0h.56v4h-.64zm2.49 2.29v.6h-.6v-.6zM12.12 1c0-.63.33-1 .95-1 .61 0 .95.37.95 1v2.04c0 .64-.34 1-.95 1-.62 0-.95-.37-.95-1zm.62 2.08c0 .28.13.39.33.39s.32-.1.32-.4V.98c0-.29-.12-.4-.32-.4s-.33.11-.33.4z"/><path fill="currentColor" d="M0 4.53h14.02v1.04H0zM11.08 0h.63v.62h-.63zm.63 4V1h-.63v2.98z"/></svg></a><span>Web-based tooling for BPMN, DMN and CMMN diagrams powered by <a href="https://bpmn.io" target="_blank" rel="noopener">bpmn.io</a>.</span></div></div>'},{"min-dom":595}],179:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _Diagram=require("./lib/Diagram");Object.defineProperty(exports,"default",{enumerable:!0,get:function(){return((obj=_Diagram)&&obj.__esModule?obj:{default:obj}).default;var obj}})},{"./lib/Diagram":180}],180:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=Diagram;var obj,_didi=require("didi"),_core=require("./core"),_core2=(obj=_core)&&obj.__esModule?obj:{default:obj};function bootstrap(bootstrapModules){var modules=[],components=[];function hasModule(m){return 0<=modules.indexOf(m)}bootstrapModules.forEach(function visit(m){hasModule(m)||((m.__depends__||[]).forEach(visit),hasModule(m)||(function(m){modules.push(m)}(m),(m.__init__||[]).forEach(function(c){components.push(c)})))});var injector=new _didi.Injector(modules);return components.forEach(function(c){try{injector["string"==typeof c?"get":"invoke"](c)}catch(e){throw console.error("Failed to instantiate component"),console.error(e.stack),e}}),injector}function Diagram(options,injector){this.injector=injector=injector||function(options){return bootstrap([{config:["value",options=options||{}]},_core2.default].concat(options.modules||[]))}(options),this.get=injector.get,this.invoke=injector.invoke,this.get("eventBus").fire("diagram.init")}Diagram.prototype.destroy=function(){this.get("eventBus").fire("diagram.destroy")},Diagram.prototype.clear=function(){this.get("eventBus").fire("diagram.clear")}},{"./core":189,didi:382}],181:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=CommandInterceptor;var _minDash=require("min-dash");function CommandInterceptor(eventBus){this._eventBus=eventBus}CommandInterceptor.$inject=["eventBus"],CommandInterceptor.prototype.on=function(events,hook,priority,handlerFn,unwrap,that){if(((0,_minDash.isFunction)(hook)||(0,_minDash.isNumber)(hook))&&(that=unwrap,unwrap=handlerFn,handlerFn=priority,priority=hook,hook=null),(0,_minDash.isFunction)(priority)&&(that=unwrap,unwrap=handlerFn,handlerFn=priority,priority=1e3),(0,_minDash.isObject)(unwrap)&&(that=unwrap,unwrap=!1),!(0,_minDash.isFunction)(handlerFn))throw new Error("handlerFn must be a function");(0,_minDash.isArray)(events)||(events=[events]);var eventBus=this._eventBus;(0,_minDash.forEach)(events,function(event){var fullEvent=["commandStack",event,hook].filter(function(e){return e}).join(".");eventBus.on(fullEvent,priority,unwrap?function(fn,that){return function(event){return fn.call(that||null,event.context,event.command,event)}}(handlerFn,that):handlerFn,that)})};(0,_minDash.forEach)(["canExecute","preExecute","preExecuted","execute","executed","postExecute","postExecuted","revert","reverted"],function(hook){CommandInterceptor.prototype[hook]=function(events,priority,handlerFn,unwrap,that){((0,_minDash.isFunction)(events)||(0,_minDash.isNumber)(events))&&(that=unwrap,unwrap=handlerFn,handlerFn=priority,priority=events,events=null),this.on(events,hook,priority,handlerFn,unwrap,that)}})},{"min-dash":594}],182:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=CommandStack;var _minDash=require("min-dash");function CommandStack(eventBus,injector){this._handlerMap={},this._stack=[],this._stackIdx=-1,this._currentExecution={actions:[],dirty:[]},this._injector=injector,this._eventBus=eventBus,this._uid=1,eventBus.on(["diagram.destroy","diagram.clear"],function(){this.clear(!1)},this)}CommandStack.$inject=["eventBus","injector"],CommandStack.prototype.execute=function(command,context){if(!command)throw new Error("command required");var action={command:command,context:context};this._pushAction(action),this._internalExecute(action),this._popAction(action)},CommandStack.prototype.canExecute=function(command,context){var action={command:command,context:context},handler=this._getHandler(command),result=this._fire(command,"canExecute",action);if(void 0===result){if(!handler)return!1;handler.canExecute&&(result=handler.canExecute(context))}return result},CommandStack.prototype.clear=function(emit){this._stack.length=0,!(this._stackIdx=-1)!==emit&&this._fire("changed")},CommandStack.prototype.undo=function(){var next,action=this._getUndoAction();if(action){for(this._pushAction(action);action&&(this._internalUndo(action),(next=this._getUndoAction())&&next.id===action.id);)action=next;this._popAction()}},CommandStack.prototype.redo=function(){var next,action=this._getRedoAction();if(action){for(this._pushAction(action);action&&(this._internalExecute(action,!0),(next=this._getRedoAction())&&next.id===action.id);)action=next;this._popAction()}},CommandStack.prototype.register=function(command,handler){this._setHandler(command,handler)},CommandStack.prototype.registerHandler=function(command,handlerCls){if(!command||!handlerCls)throw new Error("command and handlerCls must be defined");var handler=this._injector.instantiate(handlerCls);this.register(command,handler)},CommandStack.prototype.canUndo=function(){return!!this._getUndoAction()},CommandStack.prototype.canRedo=function(){return!!this._getRedoAction()},CommandStack.prototype._getRedoAction=function(){return this._stack[this._stackIdx+1]},CommandStack.prototype._getUndoAction=function(){return this._stack[this._stackIdx]},CommandStack.prototype._internalUndo=function(action){var self=this,command=action.command,context=action.context,handler=this._getHandler(command);this._atomicDo(function(){self._fire(command,"revert",action),handler.revert&&self._markDirty(handler.revert(context)),self._revertedAction(action),self._fire(command,"reverted",action)})},CommandStack.prototype._fire=function(command,qualifier,event){arguments.length<3&&(event=qualifier,qualifier=null);var i,name,result,names=qualifier?[command+"."+qualifier,qualifier]:[command];for(event=this._eventBus.createEvent(event),i=0;(name=names[i])&&(result=this._eventBus.fire("commandStack."+name,event),!event.cancelBubble);i++);return result},CommandStack.prototype._createId=function(){return this._uid++},CommandStack.prototype._atomicDo=function(fn){var execution=this._currentExecution;execution.atomic=!0;try{fn()}finally{execution.atomic=!1}},CommandStack.prototype._internalExecute=function(action,redo){var self=this,command=action.command,context=action.context,handler=this._getHandler(command);if(!handler)throw new Error("no command handler registered for <"+command+">");this._pushAction(action),redo||(this._fire(command,"preExecute",action),handler.preExecute&&handler.preExecute(context),this._fire(command,"preExecuted",action)),this._atomicDo(function(){self._fire(command,"execute",action),handler.execute&&self._markDirty(handler.execute(context)),self._executedAction(action,redo),self._fire(command,"executed",action)}),redo||(this._fire(command,"postExecute",action),handler.postExecute&&handler.postExecute(context),this._fire(command,"postExecuted",action)),this._popAction(action)},CommandStack.prototype._pushAction=function(action){var execution=this._currentExecution,actions=execution.actions,baseAction=actions[0];if(execution.atomic)throw new Error("illegal invocation in <execute> or <revert> phase (action: "+action.command+")");action.id||(action.id=baseAction&&baseAction.id||this._createId()),actions.push(action)},CommandStack.prototype._popAction=function(){var execution=this._currentExecution,actions=execution.actions,dirty=execution.dirty;actions.pop(),actions.length||(this._eventBus.fire("elements.changed",{elements:(0,_minDash.uniqueBy)("id",dirty.reverse())}),dirty.length=0,this._fire("changed"))},CommandStack.prototype._markDirty=function(elements){var execution=this._currentExecution;elements&&(elements=(0,_minDash.isArray)(elements)?elements:[elements],execution.dirty=execution.dirty.concat(elements))},CommandStack.prototype._executedAction=function(action,redo){var stackIdx=++this._stackIdx;redo||this._stack.splice(stackIdx,this._stack.length,action)},CommandStack.prototype._revertedAction=function(action){this._stackIdx--},CommandStack.prototype._getHandler=function(command){return this._handlerMap[command]},CommandStack.prototype._setHandler=function(command,handler){if(!command||!handler)throw new Error("command and handler required");if(this._handlerMap[command])throw new Error("overriding handler for command <"+command+">");this._handlerMap[command]=handler}},{"min-dash":594}],183:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_CommandStack=require("./CommandStack"),_CommandStack2=(obj=_CommandStack)&&obj.__esModule?obj:{default:obj};exports.default={commandStack:["type",_CommandStack2.default]}},{"./CommandStack":182}],184:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};exports.default=Canvas;var _minDash=require("min-dash"),_Collections=require("../util/Collections"),_Elements=require("../util/Elements"),_tinySvg=require("tiny-svg");function round(number,resolution){return Math.round(number*resolution)/resolution}function ensurePx(number){return(0,_minDash.isNumber)(number)?number+"px":number}function createGroup(parent,cls,childIndex){var group=(0,_tinySvg.create)("g");(0,_tinySvg.classes)(group).add(cls);var index=void 0!==childIndex?childIndex:parent.childNodes.length-1;return parent.insertBefore(group,parent.childNodes[index]||null),group}var REQUIRED_MODEL_ATTRS={shape:["x","y","width","height"],connection:["waypoints"]};function Canvas(config,eventBus,graphicsFactory,elementRegistry){this._eventBus=eventBus,this._elementRegistry=elementRegistry,this._graphicsFactory=graphicsFactory,this._init(config||{})}function setCTM(node,m){var mstr="matrix("+m.a+","+m.b+","+m.c+","+m.d+","+m.e+","+m.f+")";node.setAttribute("transform",mstr)}Canvas.$inject=["config.canvas","eventBus","graphicsFactory","elementRegistry"],Canvas.prototype._init=function(config){var eventBus=this._eventBus,container=this._container=function(options){var container=(options=(0,_minDash.assign)({},{width:"100%",height:"100%"},options)).container||document.body,parent=document.createElement("div");return parent.setAttribute("class","djs-container"),(0,_minDash.assign)(parent.style,{position:"relative",overflow:"hidden",width:ensurePx(options.width),height:ensurePx(options.height)}),container.appendChild(parent),parent}(config),svg=this._svg=(0,_tinySvg.create)("svg");(0,_tinySvg.attr)(svg,{width:"100%",height:"100%"}),(0,_tinySvg.append)(container,svg);var viewport=this._viewport=createGroup(svg,"viewport");!(this._layers={})!==config.deferUpdate&&(this._viewboxChanged=(0,_minDash.debounce)((0,_minDash.bind)(this._viewboxChanged,this),300)),eventBus.on("diagram.init",function(){eventBus.fire("canvas.init",{svg:svg,viewport:viewport})},this),eventBus.on(["shape.added","connection.added","shape.removed","connection.removed","elements.changed"],function(){delete this._cachedViewbox},this),eventBus.on("diagram.destroy",500,this._destroy,this),eventBus.on("diagram.clear",500,this._clear,this)},Canvas.prototype._destroy=function(emit){this._eventBus.fire("canvas.destroy",{svg:this._svg,viewport:this._viewport});var parent=this._container.parentNode;parent&&parent.removeChild(this._container),delete this._svg,delete this._container,delete this._layers,delete this._rootElement,delete this._viewport},Canvas.prototype._clear=function(){var self=this;this._elementRegistry.getAll().forEach(function(element){var type=(0,_Elements.getType)(element);"root"===type?self.setRootElement(null,!0):self._removeElement(element,type)}),delete this._cachedViewbox},Canvas.prototype.getDefaultLayer=function(){return this.getLayer("base",0)},Canvas.prototype.getLayer=function(name,index){if(!name)throw new Error("must specify a name");var layer=(layer=this._layers[name])||(this._layers[name]=this._createLayer(name,index));if(void 0!==index&&layer.index!==index)throw new Error("layer <"+name+"> already created at index <"+index+">");return layer.group},Canvas.prototype._createLayer=function(name,index){index=index||0;var childIndex=(0,_minDash.reduce)(this._layers,function(childIndex,layer){return index>=layer.index&&childIndex++,childIndex},0);return{group:createGroup(this._viewport,"layer-"+name,childIndex),index:index}},Canvas.prototype.getContainer=function(){return this._container},Canvas.prototype._updateMarker=function(element,marker,add){var container;element.id||(element=this._elementRegistry.get(element)),(container=this._elementRegistry._elements[element.id])&&((0,_minDash.forEach)([container.gfx,container.secondaryGfx],function(gfx){gfx&&(add?(0,_tinySvg.classes)(gfx).add(marker):(0,_tinySvg.classes)(gfx).remove(marker))}),this._eventBus.fire("element.marker.update",{element:element,gfx:container.gfx,marker:marker,add:!!add}))},Canvas.prototype.addMarker=function(element,marker){this._updateMarker(element,marker,!0)},Canvas.prototype.removeMarker=function(element,marker){this._updateMarker(element,marker,!1)},Canvas.prototype.hasMarker=function(element,marker){element.id||(element=this._elementRegistry.get(element));var gfx=this.getGraphics(element);return(0,_tinySvg.classes)(gfx).has(marker)},Canvas.prototype.toggleMarker=function(element,marker){this.hasMarker(element,marker)?this.removeMarker(element,marker):this.addMarker(element,marker)},Canvas.prototype.getRootElement=function(){return this._rootElement||this.setRootElement({id:"__implicitroot",children:[]}),this._rootElement},Canvas.prototype.setRootElement=function(element,override){element&&this._ensureValid("root",element);var gfx,currentRoot=this._rootElement,elementRegistry=this._elementRegistry,eventBus=this._eventBus;if(currentRoot){if(!override)throw new Error("rootElement already set, need to specify override");eventBus.fire("root.remove",{element:currentRoot}),eventBus.fire("root.removed",{element:currentRoot}),elementRegistry.remove(currentRoot)}return element&&(gfx=this.getDefaultLayer(),eventBus.fire("root.add",{element:element}),elementRegistry.add(element,gfx,this._svg),eventBus.fire("root.added",{element:element,gfx:gfx})),this._rootElement=element},Canvas.prototype._ensureValid=function(type,element){if(!element.id)throw new Error("element must have an id");if(this._elementRegistry.get(element.id))throw new Error("element with id "+element.id+" already exists");var requiredAttrs=REQUIRED_MODEL_ATTRS[type];if(!(0,_minDash.every)(requiredAttrs,function(attr){return void 0!==element[attr]}))throw new Error("must supply { "+requiredAttrs.join(", ")+" } with "+type)},Canvas.prototype._setParent=function(element,parent,parentIndex){(0,_Collections.add)(parent.children,element,parentIndex),element.parent=parent},Canvas.prototype._addElement=function(type,element,parent,parentIndex){parent=parent||this.getRootElement();var eventBus=this._eventBus,graphicsFactory=this._graphicsFactory;this._ensureValid(type,element),eventBus.fire(type+".add",{element:element,parent:parent}),this._setParent(element,parent,parentIndex);var gfx=graphicsFactory.create(type,element,parentIndex);return this._elementRegistry.add(element,gfx),graphicsFactory.update(type,element,gfx),eventBus.fire(type+".added",{element:element,gfx:gfx}),element},Canvas.prototype.addShape=function(shape,parent,parentIndex){return this._addElement("shape",shape,parent,parentIndex)},Canvas.prototype.addConnection=function(connection,parent,parentIndex){return this._addElement("connection",connection,parent,parentIndex)},Canvas.prototype._removeElement=function(element,type){var elementRegistry=this._elementRegistry,graphicsFactory=this._graphicsFactory,eventBus=this._eventBus;if(element=elementRegistry.get(element.id||element))return eventBus.fire(type+".remove",{element:element}),graphicsFactory.remove(element),(0,_Collections.remove)(element.parent&&element.parent.children,element),element.parent=null,eventBus.fire(type+".removed",{element:element}),elementRegistry.remove(element),element},Canvas.prototype.removeShape=function(shape){return this._removeElement(shape,"shape")},Canvas.prototype.removeConnection=function(connection){return this._removeElement(connection,"connection")},Canvas.prototype.getGraphics=function(element,secondary){return this._elementRegistry.getGraphics(element,secondary)},Canvas.prototype._changeViewbox=function(changeFn){this._eventBus.fire("canvas.viewbox.changing"),changeFn.apply(this),this._cachedViewbox=null,this._viewboxChanged()},Canvas.prototype._viewboxChanged=function(){this._eventBus.fire("canvas.viewbox.changed",{viewbox:this.viewbox()})},Canvas.prototype.viewbox=function(box){if(void 0===box&&this._cachedViewbox)return this._cachedViewbox;var innerBox,matrix,transform,scale,x,y,viewport=this._viewport,outerBox=this.getSize();return box?(this._changeViewbox(function(){scale=Math.min(outerBox.width/box.width,outerBox.height/box.height);var matrix=this._svg.createSVGMatrix().scale(scale).translate(-box.x,-box.y);(0,_tinySvg.transform)(viewport,matrix)}),box):(innerBox=this.getDefaultLayer().getBBox(),matrix=(transform=(0,_tinySvg.transform)(viewport))?transform.matrix:(0,_tinySvg.createMatrix)(),scale=round(matrix.a,1e3),x=round(-matrix.e||0,1e3),y=round(-matrix.f||0,1e3),box=this._cachedViewbox={x:x?x/scale:0,y:y?y/scale:0,width:outerBox.width/scale,height:outerBox.height/scale,scale:scale,inner:{width:innerBox.width,height:innerBox.height,x:innerBox.x,y:innerBox.y},outer:outerBox})},Canvas.prototype.scroll=function(delta){var node=this._viewport,matrix=node.getCTM();return delta&&this._changeViewbox(function(){delta=(0,_minDash.assign)({dx:0,dy:0},delta||{}),matrix=this._svg.createSVGMatrix().translate(delta.dx,delta.dy).multiply(matrix),setCTM(node,matrix)}),{x:matrix.e,y:matrix.f}},Canvas.prototype.zoom=function(newScale,center){return newScale?"fit-viewport"===newScale?this._fitViewport(center):(this._changeViewbox(function(){"object"!==(void 0===center?"undefined":_typeof(center))&&(outer=this.viewbox().outer,center={x:outer.width/2,y:outer.height/2}),matrix=this._setZoom(newScale,center)}),round(matrix.a,1e3)):this.viewbox(newScale).scale;var outer,matrix},Canvas.prototype._fitViewport=function(center){var newScale,vbox=this.viewbox(),outer=vbox.outer,inner=vbox.inner,newViewbox=0<=inner.x&&0<=inner.y&&inner.x+inner.width<=outer.width&&inner.y+inner.height<=outer.height&&!center?{x:0,y:0,width:Math.max(inner.width+inner.x,outer.width),height:Math.max(inner.height+inner.y,outer.height)}:(newScale=Math.min(1,outer.width/inner.width,outer.height/inner.height),{x:inner.x+(center?inner.width/2-outer.width/newScale/2:0),y:inner.y+(center?inner.height/2-outer.height/newScale/2:0),width:outer.width/newScale,height:outer.height/newScale});return this.viewbox(newViewbox),this.viewbox(!1).scale},Canvas.prototype._setZoom=function(scale,center){var originalPoint,scaleMatrix,svg=this._svg,viewport=this._viewport,matrix=svg.createSVGMatrix(),point=svg.createSVGPoint(),currentMatrix=viewport.getCTM(),currentScale=currentMatrix.a,newMatrix=center?(originalPoint=(0,_minDash.assign)(point,center).matrixTransform(currentMatrix.inverse()),scaleMatrix=matrix.translate(originalPoint.x,originalPoint.y).scale(1/currentScale*scale).translate(-originalPoint.x,-originalPoint.y),currentMatrix.multiply(scaleMatrix)):matrix.scale(scale);return setCTM(this._viewport,newMatrix),newMatrix},Canvas.prototype.getSize=function(){return{width:this._container.clientWidth,height:this._container.clientHeight}},Canvas.prototype.getAbsoluteBBox=function(element){var bbox,vbox=this.viewbox();return{x:(bbox=element.waypoints?this.getGraphics(element).getBBox():element).x*vbox.scale-vbox.x*vbox.scale,y:bbox.y*vbox.scale-vbox.y*vbox.scale,width:bbox.width*vbox.scale,height:bbox.height*vbox.scale}},Canvas.prototype.resized=function(){delete this._cachedViewbox,this._eventBus.fire("canvas.resized")}},{"../util/Collections":349,"../util/Elements":351,"min-dash":594,"tiny-svg":606}],185:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ElementFactory;var _model=require("../model"),_minDash=require("min-dash");function ElementFactory(){this._uid=12}ElementFactory.prototype.createRoot=function(attrs){return this.create("root",attrs)},ElementFactory.prototype.createLabel=function(attrs){return this.create("label",attrs)},ElementFactory.prototype.createShape=function(attrs){return this.create("shape",attrs)},ElementFactory.prototype.createConnection=function(attrs){return this.create("connection",attrs)},ElementFactory.prototype.create=function(type,attrs){return(attrs=(0,_minDash.assign)({},attrs||{})).id||(attrs.id=type+"_"+this._uid++),(0,_model.create)(type,attrs)}},{"../model":338,"min-dash":594}],186:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ElementRegistry;var _tinySvg=require("tiny-svg"),ELEMENT_ID="data-element-id";function ElementRegistry(eventBus){this._elements={},this._eventBus=eventBus}ElementRegistry.$inject=["eventBus"],ElementRegistry.prototype.add=function(element,gfx,secondaryGfx){var id=element.id;this._validateId(id),(0,_tinySvg.attr)(gfx,ELEMENT_ID,id),secondaryGfx&&(0,_tinySvg.attr)(secondaryGfx,ELEMENT_ID,id),this._elements[id]={element:element,gfx:gfx,secondaryGfx:secondaryGfx}},ElementRegistry.prototype.remove=function(element){var elements=this._elements,id=element.id||element,container=id&&elements[id];container&&((0,_tinySvg.attr)(container.gfx,ELEMENT_ID,""),container.secondaryGfx&&(0,_tinySvg.attr)(container.secondaryGfx,ELEMENT_ID,""),delete elements[id])},ElementRegistry.prototype.updateId=function(element,newId){this._validateId(newId),"string"==typeof element&&(element=this.get(element)),this._eventBus.fire("element.updateId",{element:element,newId:newId});var gfx=this.getGraphics(element),secondaryGfx=this.getGraphics(element,!0);this.remove(element),element.id=newId,this.add(element,gfx,secondaryGfx)},ElementRegistry.prototype.get=function(filter){var id="string"==typeof filter?filter:filter&&(0,_tinySvg.attr)(filter,ELEMENT_ID),container=this._elements[id];return container&&container.element},ElementRegistry.prototype.filter=function(fn){var filtered=[];return this.forEach(function(element,gfx){fn(element,gfx)&&filtered.push(element)}),filtered},ElementRegistry.prototype.find=function(fn){for(var map=this._elements,keys=Object.keys(map),i=0;i<keys.length;i++){var container=map[keys[i]],element=container.element;if(fn(element,container.gfx))return element}},ElementRegistry.prototype.getAll=function(){return this.filter(function(e){return e})},ElementRegistry.prototype.forEach=function(fn){var map=this._elements;Object.keys(map).forEach(function(id){var container=map[id],element=container.element,gfx=container.gfx;return fn(element,gfx)})},ElementRegistry.prototype.getGraphics=function(filter,secondary){var id=filter.id||filter,container=this._elements[id];return container&&(secondary?container.secondaryGfx:container.gfx)},ElementRegistry.prototype._validateId=function(id){if(!id)throw new Error("element must have an id");if(this._elements[id])throw new Error("element with id "+id+" already added")}},{"tiny-svg":606}],187:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};exports.default=EventBus;var _minDash=require("min-dash"),slice=Array.prototype.slice;function EventBus(){this._listeners={},this.on("diagram.destroy",1,this._destroy,this)}function InternalEvent(){}EventBus.prototype.on=function(events,priority,callback,that){if(events=(0,_minDash.isArray)(events)?events:[events],(0,_minDash.isFunction)(priority)&&(that=callback,callback=priority,priority=1e3),!(0,_minDash.isNumber)(priority))throw new Error("priority must be a number");var actualCallback=callback;that&&((actualCallback=(0,_minDash.bind)(callback,that)).__fn=callback.__fn||callback);var self=this;events.forEach(function(e){self._addListener(e,{priority:priority,callback:actualCallback,next:null})})},EventBus.prototype.once=function(event,priority,callback,that){var self=this;if((0,_minDash.isFunction)(priority)&&(that=callback,callback=priority,priority=1e3),!(0,_minDash.isNumber)(priority))throw new Error("priority must be a number");function wrappedCallback(){var result=callback.apply(that,arguments);return self.off(event,wrappedCallback),result}wrappedCallback.__fn=callback,this.on(event,priority,wrappedCallback)},EventBus.prototype.off=function(events,callback){events=(0,_minDash.isArray)(events)?events:[events];var self=this;events.forEach(function(event){self._removeListener(event,callback)})},EventBus.prototype.createEvent=function(data){var event=new InternalEvent;return event.init(data),event},EventBus.prototype.fire=function(type,data){var event,firstListener,returnValue,args=slice.call(arguments);if("object"===(void 0===type?"undefined":_typeof(type))&&(type=(data=type).type),!type)throw new Error("no event type specified");if(firstListener=this._listeners[type]){event=data instanceof InternalEvent?data:this.createEvent(data);var originalType=(args[0]=event).type;type!==originalType&&(event.type=type);try{returnValue=this._invokeListeners(event,args,firstListener)}finally{type!==originalType&&(event.type=originalType)}return void 0===returnValue&&event.defaultPrevented&&(returnValue=!1),returnValue}},EventBus.prototype.handleError=function(error){return!1===this.fire("error",{error:error})},EventBus.prototype._destroy=function(){this._listeners={}},EventBus.prototype._invokeListeners=function(event,args,listener){for(var returnValue;listener&&!event.cancelBubble;)returnValue=this._invokeListener(event,args,listener),listener=listener.next;return returnValue},EventBus.prototype._invokeListener=function(event,args,listener){var returnValue;try{void 0!==(returnValue=function(fn,args){return fn.apply(null,args)}(listener.callback,args))&&(event.returnValue=returnValue,event.stopPropagation()),!1===returnValue&&event.preventDefault()}catch(e){if(!this.handleError(e))throw console.error("unhandled error in event listener"),console.error(e.stack),e}return returnValue},EventBus.prototype._addListener=function(event,newListener){var previousListener,listener=this._getListeners(event);if(listener){for(;listener;){if(listener.priority<newListener.priority)return newListener.next=listener,void(previousListener?previousListener.next=newListener:this._setListeners(event,newListener));listener=(previousListener=listener).next}previousListener.next=newListener}else this._setListeners(event,newListener)},EventBus.prototype._getListeners=function(name){return this._listeners[name]},EventBus.prototype._setListeners=function(name,listener){this._listeners[name]=listener},EventBus.prototype._removeListener=function(event,callback){var nextListener,previousListener,listenerCallback,listener=this._getListeners(event);if(callback)for(;listener;)nextListener=listener.next,(listenerCallback=listener.callback)!==callback&&listenerCallback.__fn!==callback||(previousListener?previousListener.next=nextListener:this._setListeners(event,nextListener)),previousListener=listener,listener=nextListener;else this._setListeners(event,null)},InternalEvent.prototype.stopPropagation=function(){this.cancelBubble=!0},InternalEvent.prototype.preventDefault=function(){this.defaultPrevented=!0},InternalEvent.prototype.init=function(data){(0,_minDash.assign)(this,data||{})}},{"min-dash":594}],188:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=GraphicsFactory;var _minDash=require("min-dash"),_GraphicsUtil=require("../util/GraphicsUtil"),_SvgTransformUtil=require("../util/SvgTransformUtil"),_minDom=require("min-dom"),_tinySvg=require("tiny-svg"),_Elements=require("../util/Elements");function GraphicsFactory(eventBus,elementRegistry){this._eventBus=eventBus,this._elementRegistry=elementRegistry}function prependTo(newNode,parentNode,siblingNode){var node=siblingNode||parentNode.firstChild;newNode!==node&&parentNode.insertBefore(newNode,node)}GraphicsFactory.$inject=["eventBus","elementRegistry"],GraphicsFactory.prototype._getChildrenContainer=function(element){var childrenGfx,gfx=this._elementRegistry.getGraphics(element);return element.parent?(childrenGfx=(0,_GraphicsUtil.getChildren)(gfx))||(childrenGfx=(0,_tinySvg.create)("g"),(0,_tinySvg.classes)(childrenGfx).add("djs-children"),(0,_tinySvg.append)(gfx.parentNode,childrenGfx)):childrenGfx=gfx,childrenGfx},GraphicsFactory.prototype._clear=function(gfx){var visual=(0,_GraphicsUtil.getVisual)(gfx);return(0,_minDom.clear)(visual),visual},GraphicsFactory.prototype._createContainer=function(type,childrenGfx,parentIndex,isFrame){var outerGfx=(0,_tinySvg.create)("g");(0,_tinySvg.classes)(outerGfx).add("djs-group"),void 0!==parentIndex?prependTo(outerGfx,childrenGfx,childrenGfx.childNodes[parentIndex]):(0,_tinySvg.append)(childrenGfx,outerGfx);var gfx=(0,_tinySvg.create)("g");(0,_tinySvg.classes)(gfx).add("djs-element"),(0,_tinySvg.classes)(gfx).add("djs-"+type),isFrame&&(0,_tinySvg.classes)(gfx).add("djs-frame"),(0,_tinySvg.append)(outerGfx,gfx);var visual=(0,_tinySvg.create)("g");return(0,_tinySvg.classes)(visual).add("djs-visual"),(0,_tinySvg.append)(gfx,visual),gfx},GraphicsFactory.prototype.create=function(type,element,parentIndex){var childrenGfx=this._getChildrenContainer(element.parent);return this._createContainer(type,childrenGfx,parentIndex,(0,_Elements.isFrameElement)(element))},GraphicsFactory.prototype.updateContainments=function(elements){var self=this,elementRegistry=this._elementRegistry,parents=(0,_minDash.reduce)(elements,function(map,e){return e.parent&&(map[e.parent.id]=e.parent),map},{});(0,_minDash.forEach)(parents,function(parent){var childrenGfx,children=parent.children;children&&(childrenGfx=self._getChildrenContainer(parent),(0,_minDash.forEach)(children.slice().reverse(),function(child){prependTo(elementRegistry.getGraphics(child).parentNode,childrenGfx)}))})},GraphicsFactory.prototype.drawShape=function(visual,element){return this._eventBus.fire("render.shape",{gfx:visual,element:element})},GraphicsFactory.prototype.getShapePath=function(element){return this._eventBus.fire("render.getShapePath",element)},GraphicsFactory.prototype.drawConnection=function(visual,element){return this._eventBus.fire("render.connection",{gfx:visual,element:element})},GraphicsFactory.prototype.getConnectionPath=function(waypoints){return this._eventBus.fire("render.getConnectionPath",waypoints)},GraphicsFactory.prototype.update=function(type,element,gfx){if(element.parent){var visual=this._clear(gfx);if("shape"===type)this.drawShape(visual,element),(0,_SvgTransformUtil.translate)(gfx,element.x,element.y);else{if("connection"!==type)throw new Error("unknown type: "+type);this.drawConnection(visual,element)}element.hidden?(0,_tinySvg.attr)(gfx,"display","none"):(0,_tinySvg.attr)(gfx,"display","block")}},GraphicsFactory.prototype.remove=function(element){var gfx=this._elementRegistry.getGraphics(element);(0,_tinySvg.remove)(gfx.parentNode)}},{"../util/Elements":351,"../util/GraphicsUtil":355,"../util/SvgTransformUtil":364,"min-dash":594,"min-dom":595,"tiny-svg":606}],189:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _draw2=_interopRequireDefault(require("../draw")),_Canvas2=_interopRequireDefault(require("./Canvas")),_ElementRegistry2=_interopRequireDefault(require("./ElementRegistry")),_ElementFactory2=_interopRequireDefault(require("./ElementFactory")),_EventBus2=_interopRequireDefault(require("./EventBus")),_GraphicsFactory2=_interopRequireDefault(require("./GraphicsFactory"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_draw2.default],__init__:["canvas"],canvas:["type",_Canvas2.default],elementRegistry:["type",_ElementRegistry2.default],elementFactory:["type",_ElementFactory2.default],eventBus:["type",_EventBus2.default],graphicsFactory:["type",_GraphicsFactory2.default]}},{"../draw":193,"./Canvas":184,"./ElementFactory":185,"./ElementRegistry":186,"./EventBus":187,"./GraphicsFactory":188}],190:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BaseRenderer;var DEFAULT_RENDER_PRIORITY=1e3;function BaseRenderer(eventBus,renderPriority){var self=this;renderPriority=renderPriority||DEFAULT_RENDER_PRIORITY,eventBus.on(["render.shape","render.connection"],renderPriority,function(evt,context){var type=evt.type,element=context.element,visuals=context.gfx;if(self.canRender(element))return"render.shape"===type?self.drawShape(visuals,element):self.drawConnection(visuals,element)}),eventBus.on(["render.getShapePath","render.getConnectionPath"],renderPriority,function(evt,element){if(self.canRender(element))return"render.getShapePath"===evt.type?self.getShapePath(element):self.getConnectionPath(element)})}BaseRenderer.prototype.canRender=function(){},BaseRenderer.prototype.drawShape=function(){},BaseRenderer.prototype.drawConnection=function(){},BaseRenderer.prototype.getShapePath=function(){},BaseRenderer.prototype.getConnectionPath=function(){}},{}],191:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=DefaultRenderer;var _inherits2=_interopRequireDefault(require("inherits")),_BaseRenderer2=_interopRequireDefault(require("./BaseRenderer")),_RenderUtil=require("../util/RenderUtil"),_tinySvg=require("tiny-svg"),_Elements=require("../util/Elements");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var DEFAULT_RENDER_PRIORITY=1;function DefaultRenderer(eventBus,styles){_BaseRenderer2.default.call(this,eventBus,DEFAULT_RENDER_PRIORITY),this.CONNECTION_STYLE=styles.style(["no-fill"],{strokeWidth:5,stroke:"fuchsia"}),this.SHAPE_STYLE=styles.style({fill:"white",stroke:"fuchsia",strokeWidth:2}),this.FRAME_STYLE=styles.style(["no-fill"],{stroke:"fuchsia",strokeDasharray:4,strokeWidth:2})}(0,_inherits2.default)(DefaultRenderer,_BaseRenderer2.default),DefaultRenderer.prototype.canRender=function(){return!0},DefaultRenderer.prototype.drawShape=function(visuals,element){var rect=(0,_tinySvg.create)("rect");return(0,_tinySvg.attr)(rect,{x:0,y:0,width:element.width||0,height:element.height||0}),(0,_Elements.isFrameElement)(element)?(0,_tinySvg.attr)(rect,this.FRAME_STYLE):(0,_tinySvg.attr)(rect,this.SHAPE_STYLE),(0,_tinySvg.append)(visuals,rect),rect},DefaultRenderer.prototype.drawConnection=function(visuals,connection){var line=(0,_RenderUtil.createLine)(connection.waypoints,this.CONNECTION_STYLE);return(0,_tinySvg.append)(visuals,line),line},DefaultRenderer.prototype.getShapePath=function(shape){var x=shape.x,y=shape.y,width=shape.width,shapePath=[["M",x,y],["l",width,0],["l",0,shape.height],["l",-width,0],["z"]];return(0,_RenderUtil.componentsToPath)(shapePath)},DefaultRenderer.prototype.getConnectionPath=function(connection){for(var point,waypoints=connection.waypoints,connectionPath=[],idx=0;point=waypoints[idx];idx++)point=point.original||point,connectionPath.push([0===idx?"M":"L",point.x,point.y]);return(0,_RenderUtil.componentsToPath)(connectionPath)},DefaultRenderer.$inject=["eventBus","styles"]},{"../util/Elements":351,"../util/RenderUtil":363,"./BaseRenderer":190,inherits:385,"tiny-svg":606}],192:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(){var defaultTraits={"no-fill":{fill:"none"},"no-border":{strokeOpacity:0},"no-events":{pointerEvents:"none"}},self=this;this.cls=function(className,traits,additionalAttrs){var attrs=this.style(traits,additionalAttrs);return(0,_minDash.assign)(attrs,{class:className})},this.style=function(traits,additionalAttrs){(0,_minDash.isArray)(traits)||additionalAttrs||(additionalAttrs=traits,traits=[]);var attrs=(0,_minDash.reduce)(traits,function(attrs,t){return(0,_minDash.assign)(attrs,defaultTraits[t]||{})},{});return additionalAttrs?(0,_minDash.assign)(attrs,additionalAttrs):attrs},this.computeStyle=function(custom,traits,defaultStyles){return(0,_minDash.isArray)(traits)||(defaultStyles=traits,traits=[]),self.style(traits||[],(0,_minDash.assign)({},defaultStyles,custom||{}))}};var _minDash=require("min-dash")},{"min-dash":594}],193:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _DefaultRenderer2=_interopRequireDefault(require("./DefaultRenderer")),_Styles2=_interopRequireDefault(require("./Styles"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__init__:["defaultRenderer"],defaultRenderer:["type",_DefaultRenderer2.default],styles:["type",_Styles2.default]}},{"./DefaultRenderer":191,"./Styles":192}],194:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=AlignElements;var _minDash=require("min-dash");function last(arr){return arr&&arr[arr.length-1]}function sortTopOrMiddle(element){return element.y}function sortLeftOrCenter(element){return element.x}var ALIGNMENT_SORTING={left:sortLeftOrCenter,center:sortLeftOrCenter,right:function(element){return element.x+element.width},top:sortTopOrMiddle,middle:sortTopOrMiddle,bottom:function(element){return element.y+element.height}};function AlignElements(modeling){this._modeling=modeling}AlignElements.$inject=["modeling"],AlignElements.prototype._getOrientationDetails=function(type){var axis="x",dimension="width";return-1!==["top","bottom","middle"].indexOf(type)&&(axis="y",dimension="height"),{axis:axis,dimension:dimension}},AlignElements.prototype._isType=function(type,types){return-1!==types.indexOf(type)},AlignElements.prototype._alignmentPosition=function(type,sortedElements){var centeredElements,firstElement,lastElement,orientation=this._getOrientationDetails(type),axis=orientation.axis,dimension=orientation.dimension,alignment={},centers={},hasSharedCenters=!1;if(this._isType(type,["left","top"]))alignment[type]=sortedElements[0][axis];else if(this._isType(type,["right","bottom"]))lastElement=last(sortedElements),alignment[type]=lastElement[axis]+lastElement[dimension];else if(this._isType(type,["center","middle"])){if((0,_minDash.forEach)(sortedElements,function(element){var center=element[axis]+Math.round(element[dimension]/2);centers[center]?centers[center].elements.push(element):centers[center]={elements:[element],center:center}}),centeredElements=(0,_minDash.sortBy)(centers,function(center){return 1<center.elements.length&&(hasSharedCenters=!0),center.elements.length}),hasSharedCenters)return alignment[type]=last(centeredElements).center,alignment;firstElement=sortedElements[0],lastElement=last(sortedElements=(0,_minDash.sortBy)(sortedElements,function(element){return element[axis]+element[dimension]})),alignment[type]=function(first,last){return Math.round((first[axis]+last[axis]+last[dimension])/2)}(firstElement,lastElement)}return alignment},AlignElements.prototype.trigger=function(elements,type){var modeling=this._modeling,filteredElements=(0,_minDash.filter)(elements,function(element){return!(element.waypoints||element.host||element.labelTarget)}),sortFn=ALIGNMENT_SORTING[type],sortedElements=(0,_minDash.sortBy)(filteredElements,sortFn),alignment=this._alignmentPosition(type,sortedElements);modeling.alignElements(sortedElements,alignment)}},{"min-dash":594}],195:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_AlignElements=require("./AlignElements"),_AlignElements2=(obj=_AlignElements)&&obj.__esModule?obj:{default:obj};exports.default={__init__:["alignElements"],alignElements:["type",_AlignElements2.default]}},{"./AlignElements":194}],196:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=AttachSupport;var _minDash=require("min-dash"),_Removal=require("../../util/Removal"),_AttachUtil=require("../../util/AttachUtil"),_inherits2=_interopRequireDefault(require("inherits")),_CommandInterceptor2=_interopRequireDefault(require("../../command/CommandInterceptor"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var LOW_PRIORITY=251,HIGH_PRIORITY=1401,MARKER_ATTACH="attach-ok";function AttachSupport(injector,eventBus,canvas,rules,modeling){_CommandInterceptor2.default.call(this,eventBus);var movePreview=injector.get("movePreview",!1);eventBus.on("shape.move.start",HIGH_PRIORITY,function(e){var elements,attachers,context=e.context,shapes=context.shapes,validatedShapes=context.validatedShapes;context.shapes=(attachers=getAttachers(elements=shapes),(0,_minDash.unionBy)("id",elements,attachers)),context.validatedShapes=function(elements){var ids=(0,_minDash.groupBy)(elements,"id");return(0,_minDash.filter)(elements,function(element){for(;element;){if(element.host&&ids[element.host.id])return!1;element=element.parent}return!0})}(validatedShapes)}),movePreview&&eventBus.on("shape.move.start",LOW_PRIORITY,function(e){var context=e.context,attachers=getAttachers(context.shapes);(0,_minDash.forEach)(attachers,function(attacher){movePreview.makeDraggable(context,attacher,!0),(0,_minDash.forEach)(attacher.labels,function(label){movePreview.makeDraggable(context,label,!0)})})}),movePreview&&eventBus.on("shape.move.start",function(event){var host,shapes=event.context.shapes;1!==shapes.length||(host=shapes[0].host)&&(canvas.addMarker(host,MARKER_ATTACH),eventBus.once(["shape.move.out","shape.move.cleanup"],function(){canvas.removeMarker(host,MARKER_ATTACH)}))}),this.preExecuted("elements.move",HIGH_PRIORITY,function(e){var context=e.context,closure=context.closure,attachers=getAttachers(context.shapes);(0,_minDash.forEach)(attachers,function(attacher){closure.add(attacher,closure.topLevel[attacher.host.id])})}),this.postExecuted("elements.move",function(e){var attachers,context=e.context,shapes=context.shapes,newHost=context.newHost;newHost&&1!==shapes.length||(attachers=newHost?shapes:(0,_minDash.filter)(shapes,function(shape){var item,host=shape.host;return!(!shape.host||(item=host,-1!==shapes.indexOf(item)))}),(0,_minDash.forEach)(attachers,function(attacher){modeling.updateAttachment(attacher,newHost)}))}),this.postExecuted("elements.move",function(e){var shapes=e.context.shapes;(0,_minDash.forEach)(shapes,function(shape){(0,_minDash.forEach)(shape.attachers,function(attacher){(0,_minDash.forEach)(attacher.outgoing.slice(),function(connection){rules.allowed("connection.reconnect",{connection:connection,source:connection.source,target:connection.target})||modeling.removeConnection(connection)}),(0,_minDash.forEach)(attacher.incoming.slice(),function(connection){rules.allowed("connection.reconnect",{connection:connection,source:connection.source,target:connection.target})||modeling.removeConnection(connection)})})})}),this.postExecute("shape.create",function(e){var context=e.context,shape=context.shape,host=context.host;host&&modeling.updateAttachment(shape,host)}),this.postExecute("shape.replace",function(e){var context=e.context,oldShape=context.oldShape,newShape=context.newShape;(0,_Removal.saveClear)(oldShape.attachers,function(attacher){"attach"===rules.allowed("elements.move",{target:newShape,shapes:[attacher]})?modeling.updateAttachment(attacher,newShape):modeling.removeShape(attacher)}),newShape.attachers.length&&(0,_minDash.forEach)(newShape.attachers,function(attacher){var delta=(0,_AttachUtil.getNewAttachShapeDelta)(attacher,oldShape,newShape);modeling.moveShape(attacher,delta,attacher.parent)})}),this.postExecute("shape.resize",function(event){var context=event.context,shape=context.shape,oldBounds=context.oldBounds,newBounds=context.newBounds,attachers=shape.attachers;!1!==(context.hints||{}).attachSupport&&(0,_minDash.forEach)(attachers,function(attacher){var delta=(0,_AttachUtil.getNewAttachShapeDelta)(attacher,oldBounds,newBounds);modeling.moveShape(attacher,delta,attacher.parent),(0,_minDash.forEach)(attacher.labels,function(label){modeling.moveShape(label,delta,label.parent)})})}),this.preExecute("shape.delete",function(event){var shape=event.context.shape;(0,_Removal.saveClear)(shape.attachers,function(attacher){modeling.removeShape(attacher)}),shape.host&&modeling.updateAttachment(shape,null)})}function getAttachers(shapes){return(0,_minDash.flatten)((0,_minDash.map)(shapes,function(s){return s.attachers||[]}))}(0,_inherits2.default)(AttachSupport,_CommandInterceptor2.default),AttachSupport.$inject=["injector","eventBus","canvas","rules","modeling"]},{"../../command/CommandInterceptor":181,"../../util/AttachUtil":347,"../../util/Removal":362,inherits:385,"min-dash":594}],197:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _rules2=_interopRequireDefault(require("../rules")),_AttachSupport2=_interopRequireDefault(require("./AttachSupport"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_rules2.default],__init__:["attachSupport"],attachSupport:["type",_AttachSupport2.default]}},{"../rules":308,"./AttachSupport":196}],198:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=AutoPlace;var _LayoutUtil=require("../../layout/LayoutUtil"),_AutoPlaceUtil=require("./AutoPlaceUtil"),LOW_PRIORITY=100;function AutoPlace(eventBus,modeling){eventBus.on("autoPlace",LOW_PRIORITY,function(context){var shape=context.shape;return function(source,element,hints){hints=hints||{};var distance=hints.defaultDistance||_AutoPlaceUtil.DEFAULT_DISTANCE,sourceMid=(0,_LayoutUtil.getMid)(source);return{x:(0,_LayoutUtil.asTRBL)(source).right+distance+element.width/2,y:sourceMid.y}}(context.source,shape)}),this.append=function(source,shape,hints){eventBus.fire("autoPlace.start",{source:source,shape:shape});var position=eventBus.fire("autoPlace",{source:source,shape:shape}),newShape=modeling.appendShape(source,shape,position,source.parent,hints);return eventBus.fire("autoPlace.end",{source:source,shape:newShape}),newShape}}AutoPlace.$inject=["eventBus","modeling"]},{"../../layout/LayoutUtil":336,"./AutoPlaceUtil":200}],199:[function(require,module,exports){"use strict";function AutoPlaceSelectionBehavior(eventBus,selection){eventBus.on("autoPlace.end",500,function(e){selection.select(e.shape)})}Object.defineProperty(exports,"__esModule",{value:!0}),(exports.default=AutoPlaceSelectionBehavior).$inject=["eventBus","selection"]},{}],200:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DEFAULT_DISTANCE=void 0,exports.findFreePosition=function(source,element,position,getNextPosition){var connectedAtPosition;for(;connectedAtPosition=getConnectedAtPosition(source,position,element);)position=getNextPosition(element,position,connectedAtPosition);return position},exports.generateGetNextPosition=function(nextPositionDirection){return function(element,previousPosition,connectedAtPosition){var nextPosition={x:previousPosition.x,y:previousPosition.y};return["x","y"].forEach(function(axis){var dimension,margin,minDistance,nextPositionDirectionForAxis=nextPositionDirection[axis];nextPositionDirectionForAxis&&(dimension="x"===axis?"width":"height",margin=nextPositionDirectionForAxis.margin,minDistance=nextPositionDirectionForAxis.minDistance,nextPosition[axis]=margin<0?Math.min(connectedAtPosition[axis]+margin-element[dimension]/2,previousPosition[axis]-minDistance+margin):Math.max(connectedAtPosition[axis]+connectedAtPosition[dimension]+margin+element[dimension]/2,previousPosition[axis]+minDistance+margin))}),nextPosition}},exports.getConnectedAtPosition=getConnectedAtPosition,exports.getConnectedDistance=function(source,hints){hints=hints||{};var defaultDistance=hints.defaultDistance||DEFAULT_DISTANCE,direction=hints.direction||"e",filter=hints.filter,getWeight=hints.getWeight||function(connection){return connection.source===source?1:-1},maxDistance=hints.maxDistance||DEFAULT_MAX_DISTANCE,reference=hints.reference||"start";filter=filter||noneFilter;function getDistance(a,b){return"n"===direction?"start"===reference?(0,_LayoutUtil.asTRBL)(a).top-(0,_LayoutUtil.asTRBL)(b).bottom:"center"===reference?(0,_LayoutUtil.asTRBL)(a).top-(0,_LayoutUtil.getMid)(b).y:(0,_LayoutUtil.asTRBL)(a).top-(0,_LayoutUtil.asTRBL)(b).top:"w"===direction?"start"===reference?(0,_LayoutUtil.asTRBL)(a).left-(0,_LayoutUtil.asTRBL)(b).right:"center"===reference?(0,_LayoutUtil.asTRBL)(a).left-(0,_LayoutUtil.getMid)(b).x:(0,_LayoutUtil.asTRBL)(a).left-(0,_LayoutUtil.asTRBL)(b).left:"s"===direction?"start"===reference?(0,_LayoutUtil.asTRBL)(b).top-(0,_LayoutUtil.asTRBL)(a).bottom:"center"===reference?(0,_LayoutUtil.getMid)(b).y-(0,_LayoutUtil.asTRBL)(a).bottom:(0,_LayoutUtil.asTRBL)(b).bottom-(0,_LayoutUtil.asTRBL)(a).bottom:"start"===reference?(0,_LayoutUtil.asTRBL)(b).left-(0,_LayoutUtil.asTRBL)(a).right:"center"===reference?(0,_LayoutUtil.getMid)(b).x-(0,_LayoutUtil.asTRBL)(a).right:(0,_LayoutUtil.asTRBL)(b).right-(0,_LayoutUtil.asTRBL)(a).right}var sourcesDistances=source.incoming.filter(filter).map(function(connection){var weight=getWeight(connection),distance=weight<0?getDistance(connection.source,source):getDistance(source,connection.source);return{id:connection.source.id,distance:distance,weight:weight}}),targetsDistances=source.outgoing.filter(filter).map(function(connection){var weight=getWeight(connection),distance=0<weight?getDistance(source,connection.target):getDistance(connection.target,source);return{id:connection.target.id,distance:distance,weight:weight}}),distances=sourcesDistances.concat(targetsDistances).reduce(function(accumulator,currentValue){return accumulator[currentValue.id+"__weight_"+currentValue.weight]=currentValue,accumulator},{});return(0,_minDash.reduce)(distances,function(accumulator,currentValue){var distance=currentValue.distance,weight=currentValue.weight;return distance<0||maxDistance<distance||(accumulator[String(distance)]||(accumulator[String(distance)]=0),accumulator[String(distance)]+=+weight,(!accumulator.distance||accumulator[accumulator.distance]<accumulator[String(distance)])&&(accumulator.distance=distance)),accumulator},{}).distance||defaultDistance};var _LayoutUtil=require("../../layout/LayoutUtil"),_minDash=require("min-dash"),PLACEMENT_DETECTION_PAD=10,DEFAULT_DISTANCE=exports.DEFAULT_DISTANCE=50,DEFAULT_MAX_DISTANCE=250;function getConnectedAtPosition(source,position,element){var bounds={x:position.x-element.width/2,y:position.y-element.height/2,width:element.width,height:element.height},closure=function(source){var allConnected=getConnected(source);source.host&&(allConnected=allConnected.concat(getConnected(source.host)));source.attachers&&(allConnected=allConnected.concat(source.attachers.reduce(function(shapes,attacher){return shapes.concat(getConnected(attacher))},[])));return allConnected}(source);return(0,_minDash.find)(closure,function(target){return target!==element&&"intersect"===(0,_LayoutUtil.getOrientation)(target,bounds,PLACEMENT_DETECTION_PAD)})}function getConnected(element){return element.outgoing.map(function(connection){return connection.target}).concat(function(shape){return shape.incoming.map(function(connection){return connection.source})}(element))}function noneFilter(){return!0}},{"../../layout/LayoutUtil":336,"min-dash":594}],201:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _AutoPlace2=_interopRequireDefault(require("./AutoPlace")),_AutoPlaceSelectionBehavior2=_interopRequireDefault(require("./AutoPlaceSelectionBehavior"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__init__:["autoPlaceSelectionBehavior"],autoPlace:["type",_AutoPlace2.default],autoPlaceSelectionBehavior:["type",_AutoPlaceSelectionBehavior2.default]}},{"./AutoPlace":198,"./AutoPlaceSelectionBehavior":199}],202:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=AutoResize;var _inherits2=_interopRequireDefault(require("inherits")),_Elements=require("../../util/Elements"),_LayoutUtil=require("../../layout/LayoutUtil"),_minDash=require("min-dash"),_CommandInterceptor2=_interopRequireDefault(require("../../command/CommandInterceptor"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function AutoResize(eventBus,elementRegistry,modeling,rules){_CommandInterceptor2.default.call(this,eventBus),this._elementRegistry=elementRegistry,this._modeling=modeling,this._rules=rules;var self=this;this.postExecuted(["shape.create"],function(event){var context=event.context,hints=context.hints||{},shape=context.shape,parent=context.parent||context.newParent;!1!==hints.autoResize&&self._expand([shape],parent)}),this.postExecuted(["elements.move"],function(event){var expandings,context=event.context,elements=(0,_minDash.flatten)((0,_minDash.values)(context.closure.topLevel)),hints=context.hints,autoResize=!hints||hints.autoResize;!1!==autoResize&&(expandings=(0,_minDash.groupBy)(elements,function(element){return element.parent.id}),(0,_minDash.forEach)(expandings,function(elements,parentId){(0,_minDash.isArray)(autoResize)&&(elements=elements.filter(function(element){return(0,_minDash.find)(autoResize,(0,_minDash.matchPattern)({id:element.id}))})),self._expand(elements,parentId)}))}),this.postExecuted(["shape.toggleCollapse"],function(event){var context=event.context,hints=context.hints,shape=context.shape;hints&&!1===hints.autoResize||shape.collapsed||self._expand(shape.children||[],shape)}),this.postExecuted(["shape.resize"],function(event){var context=event.context,hints=context.hints,shape=context.shape,parent=shape.parent;hints&&!1===hints.autoResize||parent&&self._expand([shape],parent)})}AutoResize.$inject=["eventBus","elementRegistry","modeling","rules"],(0,_inherits2.default)(AutoResize,_CommandInterceptor2.default),AutoResize.prototype._getOptimalBounds=function(elements,target){var offset=this.getOffset(target),padding=this.getPadding(target),elementsTrbl=(0,_LayoutUtil.asTRBL)((0,_Elements.getBBox)(elements)),targetTrbl=(0,_LayoutUtil.asTRBL)(target),newTrbl={};return elementsTrbl.top-targetTrbl.top<padding.top&&(newTrbl.top=elementsTrbl.top-offset.top),elementsTrbl.left-targetTrbl.left<padding.left&&(newTrbl.left=elementsTrbl.left-offset.left),targetTrbl.right-elementsTrbl.right<padding.right&&(newTrbl.right=elementsTrbl.right+offset.right),targetTrbl.bottom-elementsTrbl.bottom<padding.bottom&&(newTrbl.bottom=elementsTrbl.bottom+offset.bottom),(0,_LayoutUtil.asBounds)((0,_minDash.assign)({},targetTrbl,newTrbl))},AutoResize.prototype._expand=function(elements,target){var newBounds,resizeDirections,parent;"string"==typeof target&&(target=this._elementRegistry.get(target)),!this._rules.allowed("element.autoResize",{elements:elements,target:target})||function(newBounds,oldBounds){return newBounds.x!==oldBounds.x||newBounds.y!==oldBounds.y||newBounds.width!==oldBounds.width||newBounds.height!==oldBounds.height}(newBounds=this._getOptimalBounds(elements,target),target)&&(resizeDirections=function(oldBounds,newBounds){var directions="";oldBounds=(0,_LayoutUtil.asTRBL)(oldBounds),newBounds=(0,_LayoutUtil.asTRBL)(newBounds),oldBounds.top>newBounds.top&&(directions=directions.concat("n"));oldBounds.right<newBounds.right&&(directions=directions.concat("w"));oldBounds.bottom<newBounds.bottom&&(directions=directions.concat("s"));oldBounds.left>newBounds.left&&(directions=directions.concat("e"));return directions}((0,_minDash.pick)(target,["x","y","width","height"]),newBounds),this.resize(target,newBounds,{autoResize:resizeDirections}),(parent=target.parent)&&this._expand([target],parent))},AutoResize.prototype.getOffset=function(shape){return{top:60,bottom:60,left:100,right:100}},AutoResize.prototype.getPadding=function(shape){return{top:2,bottom:2,left:15,right:15}},AutoResize.prototype.resize=function(shape,newBounds,hints){this._modeling.resizeShape(shape,newBounds,null,hints)}},{"../../command/CommandInterceptor":181,"../../layout/LayoutUtil":336,"../../util/Elements":351,inherits:385,"min-dash":594}],203:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=AutoResizeProvider;var _RuleProvider2=_interopRequireDefault(require("../rules/RuleProvider")),_inherits2=_interopRequireDefault(require("inherits"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function AutoResizeProvider(eventBus){_RuleProvider2.default.call(this,eventBus);var self=this;this.addRule("element.autoResize",function(context){return self.canResize(context.elements,context.target)})}AutoResizeProvider.$inject=["eventBus"],(0,_inherits2.default)(AutoResizeProvider,_RuleProvider2.default),AutoResizeProvider.prototype.canResize=function(elements,target){return!1}},{"../rules/RuleProvider":306,inherits:385}],204:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=AutoScroll;var _minDash=require("min-dash"),_Event=require("../../util/Event");function AutoScroll(config,eventBus,canvas){this._canvas=canvas,this._opts=(0,_minDash.assign)({scrollThresholdIn:[20,20,20,20],scrollThresholdOut:[0,0,0,0],scrollRepeatTimeout:15,scrollStep:10},config);var self=this;eventBus.on("drag.move",function(e){var point=self._toBorderPoint(e);self.startScroll(point)}),eventBus.on(["drag.cleanup"],function(){self.stopScroll()})}AutoScroll.$inject=["config.autoScroll","eventBus","canvas"],AutoScroll.prototype.startScroll=function(point){var canvas=this._canvas,opts=this._opts,self=this,clientRect=canvas.getContainer().getBoundingClientRect(),diff=[point.x,point.y,clientRect.width-point.x,clientRect.height-point.y];this.stopScroll();for(var dx=0,dy=0,i=0;i<4;i++)!function(val,start,end){if(start<val&&val<end)return!0;return!1}(diff[i],opts.scrollThresholdOut[i],opts.scrollThresholdIn[i])||(0===i?dx=opts.scrollStep:1==i?dy=opts.scrollStep:2==i?dx=-opts.scrollStep:3==i&&(dy=-opts.scrollStep));0===dx&&0===dy||(canvas.scroll({dx:dx,dy:dy}),this._scrolling=setTimeout(function(){self.startScroll(point)},opts.scrollRepeatTimeout))},AutoScroll.prototype.stopScroll=function(){clearTimeout(this._scrolling)},AutoScroll.prototype.setOptions=function(options){this._opts=(0,_minDash.assign)({},this._opts,options)},AutoScroll.prototype._toBorderPoint=function(event){var clientRect=this._canvas._container.getBoundingClientRect(),globalPosition=(0,_Event.toPoint)(event.originalEvent);return{x:globalPosition.x-clientRect.left,y:globalPosition.y-clientRect.top}}},{"../../util/Event":353,"min-dash":594}],205:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _dragging2=_interopRequireDefault(require("../dragging")),_AutoScroll2=_interopRequireDefault(require("./AutoScroll"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_dragging2.default],__init__:["autoScroll"],autoScroll:["type",_AutoScroll2.default]}},{"../dragging":233,"./AutoScroll":204}],206:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BendpointMove,exports.isReverse=isReverse;var _LayoutUtil=require("../../layout/LayoutUtil"),round=Math.round,RECONNECT_START="reconnectStart",RECONNECT_END="reconnectEnd",UPDATE_WAYPOINTS="updateWaypoints";function BendpointMove(injector,eventBus,canvas,dragging,rules,modeling){this._injector=injector,this.start=function(event,connection,bendpointIndex,insert){var gfx=canvas.getGraphics(connection),source=connection.source,target=connection.target,waypoints=connection.waypoints,type=insert||0!==bendpointIndex?insert||bendpointIndex!==waypoints.length-1?UPDATE_WAYPOINTS:RECONNECT_END:RECONNECT_START,command=type===UPDATE_WAYPOINTS?"connection.updateWaypoints":"connection.reconnect",allowed=rules.allowed(command,{connection:connection,source:source,target:target});!1===allowed&&(allowed=rules.allowed(command,{connection:connection,source:target,target:source})),!1!==allowed&&dragging.init(event,"bendpoint.move",{data:{connection:connection,connectionGfx:gfx,context:{allowed:allowed,bendpointIndex:bendpointIndex,connection:connection,source:source,target:target,insert:insert,type:type}}})},eventBus.on("bendpoint.move.hover",function(event){var context=event.context,connection=context.connection,source=connection.source,target=connection.target,hover=event.hover,type=context.type;if(context.hover=hover){var allowed,command=type===UPDATE_WAYPOINTS?"connection.updateWaypoints":"connection.reconnect";if(allowed=context.allowed=rules.allowed(command,{connection:connection,source:type===RECONNECT_START?hover:source,target:type===RECONNECT_END?hover:target}))return context.source=type===RECONNECT_START?hover:source,void(context.target=type===RECONNECT_END?hover:target);!1===allowed&&(allowed=context.allowed=rules.allowed(command,{connection:connection,source:type===RECONNECT_END?hover:target,target:type===RECONNECT_START?hover:source})),allowed&&(context.source=type===RECONNECT_END?hover:target,context.target=type===RECONNECT_START?hover:source)}}),eventBus.on(["bendpoint.move.out","bendpoint.move.cleanup"],function(event){var context=event.context;context.hover=null,context.source=null,context.target=null,context.allowed=!1}),eventBus.on("bendpoint.move.end",function(event){var context=event.context,allowed=context.allowed,bendpointIndex=context.bendpointIndex,connection=context.connection,insert=context.insert,newWaypoints=connection.waypoints.slice(),source=context.source,target=context.target,type=context.type,hints=context.hints||{},docking={x:round(event.x),y:round(event.y)};if(!allowed)return!1;type===UPDATE_WAYPOINTS?(insert?newWaypoints.splice(bendpointIndex,0,docking):newWaypoints[bendpointIndex]=docking,hints.bendpointMove={insert:insert,bendpointIndex:bendpointIndex},newWaypoints=this.cropWaypoints(connection,newWaypoints),modeling.updateWaypoints(connection,(0,_LayoutUtil.filterRedundantWaypoints)(newWaypoints),hints)):(type===RECONNECT_START?(hints.docking="source",isReverse(context)&&(hints.docking="target",hints.newWaypoints=newWaypoints.reverse())):type===RECONNECT_END&&(hints.docking="target",isReverse(context)&&(hints.docking="source",hints.newWaypoints=newWaypoints.reverse())),modeling.reconnect(connection,source,target,docking,hints))},this)}function isReverse(context){var hover=context.hover,source=context.source,target=context.target,type=context.type;return type===RECONNECT_START?hover&&target&&hover===target&&source!==target:type===RECONNECT_END?hover&&source&&hover===source&&source!==target:void 0}BendpointMove.$inject=["injector","eventBus","canvas","dragging","rules","modeling"],BendpointMove.prototype.cropWaypoints=function(connection,newWaypoints){var connectionDocking=this._injector.get("connectionDocking",!1);if(!connectionDocking)return newWaypoints;var waypoints=connection.waypoints;return connection.waypoints=newWaypoints,connection.waypoints=connectionDocking.getCroppedWaypoints(connection),newWaypoints=connection.waypoints,connection.waypoints=waypoints,newWaypoints}},{"../../layout/LayoutUtil":336}],207:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BendpointMovePreview;var _tinySvg=require("tiny-svg"),_BendpointUtil=require("./BendpointUtil"),_SvgTransformUtil=require("../../util/SvgTransformUtil"),_BendpointMove=require("./BendpointMove"),RECONNECT_START="reconnectStart",RECONNECT_END="reconnectEnd",UPDATE_WAYPOINTS="updateWaypoints",MARKER_OK="connect-ok",MARKER_NOT_OK="connect-not-ok",MARKER_CONNECT_HOVER="connect-hover",MARKER_CONNECT_UPDATING="djs-updating",MARKER_ELEMENT_HIDDEN="djs-element-hidden",HIGH_PRIORITY=1100;function BendpointMovePreview(bendpointMove,injector,eventBus,canvas){var connectionPreview=(this._injector=injector).get("connectionPreview",!1);eventBus.on("bendpoint.move.start",function(event){var context=event.context,bendpointIndex=context.bendpointIndex,connection=context.connection,insert=context.insert,waypoints=connection.waypoints,newWaypoints=waypoints.slice();context.waypoints=waypoints,insert&&newWaypoints.splice(bendpointIndex,0,{x:event.x,y:event.y}),connection.waypoints=newWaypoints;var draggerGfx=context.draggerGfx=(0,_BendpointUtil.addBendpoint)(canvas.getLayer("overlays"));(0,_tinySvg.classes)(draggerGfx).add("djs-dragging"),canvas.addMarker(connection,MARKER_ELEMENT_HIDDEN),canvas.addMarker(connection,MARKER_CONNECT_UPDATING)}),eventBus.on("bendpoint.move.hover",function(event){var context=event.context,allowed=context.allowed,hover=context.hover,type=context.type;if(hover){if(canvas.addMarker(hover,MARKER_CONNECT_HOVER),type===UPDATE_WAYPOINTS)return;allowed?(canvas.removeMarker(hover,MARKER_NOT_OK),canvas.addMarker(hover,MARKER_OK)):!1===allowed&&(canvas.removeMarker(hover,MARKER_OK),canvas.addMarker(hover,MARKER_NOT_OK))}}),eventBus.on(["bendpoint.move.out","bendpoint.move.cleanup"],HIGH_PRIORITY,function(event){var context=event.context,hover=context.hover,target=context.target;hover&&(canvas.removeMarker(hover,MARKER_CONNECT_HOVER),canvas.removeMarker(hover,target?MARKER_OK:MARKER_NOT_OK))}),eventBus.on("bendpoint.move.move",function(event){var context=event.context,allowed=context.allowed,bendpointIndex=context.bendpointIndex,draggerGfx=context.draggerGfx,hover=context.hover,type=context.type,connection=context.connection,source=connection.source,target=connection.target,newWaypoints=connection.waypoints.slice(),bendpoint={x:event.x,y:event.y},hints=context.hints||{},drawPreviewHints={};connectionPreview&&(hints.connectionStart&&(drawPreviewHints.connectionStart=hints.connectionStart),hints.connectionEnd&&(drawPreviewHints.connectionEnd=hints.connectionEnd),type===RECONNECT_START?(0,_BendpointMove.isReverse)(context)?(drawPreviewHints.connectionEnd=drawPreviewHints.connectionEnd||bendpoint,drawPreviewHints.source=target,drawPreviewHints.target=hover||source,newWaypoints=newWaypoints.reverse()):(drawPreviewHints.connectionStart=drawPreviewHints.connectionStart||bendpoint,drawPreviewHints.source=hover||source,drawPreviewHints.target=target):type===RECONNECT_END?(0,_BendpointMove.isReverse)(context)?(drawPreviewHints.connectionStart=drawPreviewHints.connectionStart||bendpoint,drawPreviewHints.source=hover||target,drawPreviewHints.target=source,newWaypoints=newWaypoints.reverse()):(drawPreviewHints.connectionEnd=drawPreviewHints.connectionEnd||bendpoint,drawPreviewHints.source=source,drawPreviewHints.target=hover||target):(drawPreviewHints.noCropping=!0,drawPreviewHints.noLayout=!0,newWaypoints[bendpointIndex]=bendpoint),type===UPDATE_WAYPOINTS&&(newWaypoints=bendpointMove.cropWaypoints(connection,newWaypoints)),drawPreviewHints.waypoints=newWaypoints,connectionPreview.drawPreview(context,allowed,drawPreviewHints)),(0,_SvgTransformUtil.translate)(draggerGfx,event.x,event.y)},this),eventBus.on(["bendpoint.move.end","bendpoint.move.cancel"],HIGH_PRIORITY,function(event){var context=event.context,connection=context.connection,draggerGfx=context.draggerGfx,hover=context.hover,target=context.target,waypoints=context.waypoints;connection.waypoints=waypoints,(0,_tinySvg.remove)(draggerGfx),canvas.removeMarker(connection,MARKER_CONNECT_UPDATING),canvas.removeMarker(connection,MARKER_ELEMENT_HIDDEN),hover&&(canvas.removeMarker(hover,MARKER_OK),canvas.removeMarker(hover,target?MARKER_OK:MARKER_NOT_OK)),connectionPreview&&connectionPreview.cleanUp(context)})}BendpointMovePreview.$inject=["bendpointMove","injector","eventBus","canvas"]},{"../../util/SvgTransformUtil":364,"./BendpointMove":206,"./BendpointUtil":209,"tiny-svg":606}],208:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BendpointSnapping;var _minDash=require("min-dash"),_SnapUtil=require("../snapping/SnapUtil"),abs=Math.abs,round=Math.round,TOLERANCE=10;function BendpointSnapping(eventBus){function snapTo(values,value){if((0,_minDash.isArray)(values)){for(var i=values.length;i--;)if(abs(values[i]-value)<=TOLERANCE)return values[i]}else{var rem=value%(values=+values);if(rem<TOLERANCE)return value-rem;if(values-TOLERANCE<rem)return value-rem+values}return value}function mid(element){if(element.width)return{x:round(element.width/2+element.x),y:round(element.height/2+element.y)}}eventBus.on("connectionSegment.move.move",1500,function(event){var sx,sy,cx,cy,snapPoints=function(context){var snapPoints=context.snapPoints,connection=context.connection,waypoints=connection.waypoints,segmentStart=context.segmentStart,segmentStartIndex=context.segmentStartIndex,segmentEnd=context.segmentEnd,segmentEndIndex=context.segmentEndIndex,axis=context.axis;if(snapPoints)return snapPoints;var referenceWaypoints=[waypoints[segmentStartIndex-1],segmentStart,segmentEnd,waypoints[segmentEndIndex+1]];return segmentStartIndex<2&&referenceWaypoints.unshift(mid(connection.source)),segmentEndIndex>waypoints.length-3&&referenceWaypoints.unshift(mid(connection.target)),context.snapPoints=snapPoints={horizontal:[],vertical:[]},(0,_minDash.forEach)(referenceWaypoints,function(p){p&&(p=p.original||p,"y"===axis&&snapPoints.horizontal.push(p.y),"x"===axis&&snapPoints.vertical.push(p.x))}),snapPoints}(event.context),x=event.x,y=event.y;snapPoints&&(cx=x-(sx=snapTo(snapPoints.vertical,x)),cy=y-(sy=snapTo(snapPoints.horizontal,y)),(0,_minDash.assign)(event,{dx:event.dx-cx,dy:event.dy-cy,x:sx,y:sy}),!cx&&-1===snapPoints.vertical.indexOf(x)||(0,_SnapUtil.setSnapped)(event,"x",sx),!cy&&-1===snapPoints.horizontal.indexOf(y)||(0,_SnapUtil.setSnapped)(event,"y",sy))}),eventBus.on(["bendpoint.move.move","bendpoint.move.end"],1500,function(event){var sx,sy,cx,cy,context=event.context,snapPoints=function(context){var snapPoints=context.snapPoints,waypoints=context.connection.waypoints,bendpointIndex=context.bendpointIndex;if(snapPoints)return snapPoints;var referenceWaypoints=[waypoints[bendpointIndex-1],waypoints[bendpointIndex+1]];return context.snapPoints=snapPoints={horizontal:[],vertical:[]},(0,_minDash.forEach)(referenceWaypoints,function(p){p&&(p=p.original||p,snapPoints.horizontal.push(p.y),snapPoints.vertical.push(p.x))}),snapPoints}(context),hover=context.hover,hoverMid=hover&&mid(hover),x=event.x,y=event.y;snapPoints&&(cx=x-(sx=snapTo(hoverMid?snapPoints.vertical.concat([hoverMid.x]):snapPoints.vertical,x)),cy=y-(sy=snapTo(hoverMid?snapPoints.horizontal.concat([hoverMid.y]):snapPoints.horizontal,y)),(0,_minDash.assign)(event,{dx:event.dx-cx,dy:event.dy-cy,x:event.x-cx,y:event.y-cy}),!cx&&-1===snapPoints.vertical.indexOf(x)||(0,_SnapUtil.setSnapped)(event,"x",sx),!cy&&-1===snapPoints.horizontal.indexOf(y)||(0,_SnapUtil.setSnapped)(event,"y",sy))})}BendpointSnapping.$inject=["eventBus"]},{"../snapping/SnapUtil":318,"min-dash":594}],209:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SEGMENT_DRAGGER_CLS=exports.BENDPOINT_CLS=void 0,exports.toCanvasCoordinates=toCanvasCoordinates,exports.getConnectionIntersection=function(canvas,waypoints,event){var localPosition=toCanvasCoordinates(canvas,event);return(0,_LineIntersection.getApproxIntersection)(waypoints,localPosition)},exports.addBendpoint=function(parentGfx,cls){var groupGfx=(0,_tinySvg.create)("g");(0,_tinySvg.classes)(groupGfx).add(BENDPOINT_CLS),(0,_tinySvg.append)(parentGfx,groupGfx);var visual=(0,_tinySvg.create)("circle");(0,_tinySvg.attr)(visual,{cx:0,cy:0,r:4}),(0,_tinySvg.classes)(visual).add("djs-visual"),(0,_tinySvg.append)(groupGfx,visual);var hit=(0,_tinySvg.create)("circle");(0,_tinySvg.attr)(hit,{cx:0,cy:0,r:10}),(0,_tinySvg.classes)(hit).add("djs-hit"),(0,_tinySvg.append)(groupGfx,hit),cls&&(0,_tinySvg.classes)(groupGfx).add(cls);return groupGfx},exports.addSegmentDragger=function(parentGfx,segmentStart,segmentEnd){var groupGfx=(0,_tinySvg.create)("g"),mid=(0,_Geometry.getMidPoint)(segmentStart,segmentEnd),alignment=(0,_Geometry.pointsAligned)(segmentStart,segmentEnd);return(0,_tinySvg.append)(parentGfx,groupGfx),function(parentGfx,segmentStart,segmentEnd,alignment){var draggerGfx=(0,_tinySvg.create)("g");(0,_tinySvg.append)(parentGfx,draggerGfx);var hitWidth=function(segmentStart,segmentEnd,alignment){var segmentLengthXAxis=segmentEnd.x-segmentStart.x,segmentLengthYAxis=segmentEnd.y-segmentStart.y;return calculateSegmentMoveRegion("h"===alignment?segmentLengthXAxis:segmentLengthYAxis)}(segmentStart,segmentEnd,alignment),visual=(0,_tinySvg.create)("rect");(0,_tinySvg.attr)(visual,{x:-7,y:-1.5,width:14,height:3}),(0,_tinySvg.classes)(visual).add("djs-visual"),(0,_tinySvg.append)(draggerGfx,visual);var hit=(0,_tinySvg.create)("rect");(0,_tinySvg.attr)(hit,{x:-hitWidth/2,y:-7,width:hitWidth,height:14}),(0,_tinySvg.classes)(hit).add("djs-hit"),(0,_tinySvg.append)(draggerGfx,hit),(0,_SvgTransformUtil.rotate)(draggerGfx,"v"===alignment?90:0,0,0)}(groupGfx,segmentStart,segmentEnd,alignment),(0,_tinySvg.classes)(groupGfx).add(SEGMENT_DRAGGER_CLS),(0,_tinySvg.classes)(groupGfx).add("h"===alignment?"horizontal":"vertical"),(0,_SvgTransformUtil.translate)(groupGfx,mid.x,mid.y),groupGfx},exports.calculateSegmentMoveRegion=calculateSegmentMoveRegion;var _Event=require("../../util/Event"),_Geometry=require("../../util/Geometry"),_tinySvg=require("tiny-svg"),_SvgTransformUtil=require("../../util/SvgTransformUtil"),_LineIntersection=require("../../util/LineIntersection"),BENDPOINT_CLS=exports.BENDPOINT_CLS="djs-bendpoint",SEGMENT_DRAGGER_CLS=exports.SEGMENT_DRAGGER_CLS="djs-segment-dragger";function toCanvasCoordinates(canvas,event){var position=(0,_Event.toPoint)(event),clientRect=canvas._container.getBoundingClientRect(),offset={x:clientRect.left,y:clientRect.top},viewbox=canvas.viewbox();return{x:viewbox.x+(position.x-offset.x)/viewbox.scale,y:viewbox.y+(position.y-offset.y)/viewbox.scale}}function calculateSegmentMoveRegion(segmentLength){return Math.abs(Math.round(2*segmentLength/3))}},{"../../util/Event":353,"../../util/Geometry":354,"../../util/LineIntersection":357,"../../util/SvgTransformUtil":364,"tiny-svg":606}],210:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=Bendpoints;var _minDash=require("min-dash"),_minDom=require("min-dom"),_BendpointUtil=require("./BendpointUtil"),_EscapeUtil=require("../../util/EscapeUtil"),_Geometry=require("../../util/Geometry"),_tinySvg=require("tiny-svg"),_SvgTransformUtil=require("../../util/SvgTransformUtil");function Bendpoints(eventBus,canvas,interactionEvents,bendpointMove,connectionSegmentMove){function activateBendpointMove(event,connection){var waypoints=connection.waypoints,intersection=(0,_BendpointUtil.getConnectionIntersection)(canvas,waypoints,event);if(intersection)return!function(intersection,waypoints,treshold){var p0,p1,mid,aligned,xDelta,yDelta,idx=intersection.index,p=intersection.point;return!(idx<=0||intersection.bendpoint)&&(p0=waypoints[idx-1],p1=waypoints[idx],mid=(0,_Geometry.getMidPoint)(p0,p1),aligned=(0,_Geometry.pointsAligned)(p0,p1),xDelta=Math.abs(p.x-mid.x),yDelta=Math.abs(p.y-mid.y),aligned&&xDelta<=treshold&&yDelta<=treshold)}(intersection,waypoints,function(connection,intersection){var relevantSegment,alignment,segmentLength,waypoints=connection.waypoints;return intersection.index<=0||intersection.bendpoint?null:(relevantSegment={start:waypoints[intersection.index-1],end:waypoints[intersection.index]},(alignment=(0,_Geometry.pointsAligned)(relevantSegment.start,relevantSegment.end))?(segmentLength="h"===alignment?relevantSegment.end.x-relevantSegment.start.x:relevantSegment.end.y-relevantSegment.start.y,(0,_BendpointUtil.calculateSegmentMoveRegion)(segmentLength)/2):null)}(connection,intersection))?bendpointMove.start(event,connection,intersection.index,!intersection.bendpoint):connectionSegmentMove.start(event,connection,intersection.index),!0}function bindInteractionEvents(node,eventName,element){_minDom.event.bind(node,eventName,function(event){interactionEvents.triggerMouseEvent(eventName,event,element),event.stopPropagation()})}function getBendpointsContainer(element,create){var layer=canvas.getLayer("overlays"),gfx=(0,_minDom.query)('.djs-bendpoints[data-element-id="'+(0,_EscapeUtil.escapeCSS)(element.id)+'"]',layer);return!gfx&&create&&(gfx=(0,_tinySvg.create)("g"),(0,_tinySvg.attr)(gfx,{"data-element-id":element.id}),(0,_tinySvg.classes)(gfx).add("djs-bendpoints"),(0,_tinySvg.append)(layer,gfx),bindInteractionEvents(gfx,"mousedown",element),bindInteractionEvents(gfx,"click",element),bindInteractionEvents(gfx,"dblclick",element)),gfx}function getSegmentDragger(idx,parentGfx){return(0,_minDom.query)('.djs-segment-dragger[data-segment-idx="'+idx+'"]',parentGfx)}function createBendpoints(gfx,connection){connection.waypoints.forEach(function(p,idx){var bendpoint=(0,_BendpointUtil.addBendpoint)(gfx);(0,_tinySvg.append)(gfx,bendpoint),(0,_SvgTransformUtil.translate)(bendpoint,p.x,p.y)}),(0,_BendpointUtil.addBendpoint)(gfx,"floating")}function createSegmentDraggers(gfx,connection){for(var segmentStart,segmentEnd,segmentDraggerGfx,waypoints=connection.waypoints,i=1;i<waypoints.length;i++)segmentStart=waypoints[i-1],segmentEnd=waypoints[i],(0,_Geometry.pointsAligned)(segmentStart,segmentEnd)&&(segmentDraggerGfx=(0,_BendpointUtil.addSegmentDragger)(gfx,segmentStart,segmentEnd),(0,_tinySvg.attr)(segmentDraggerGfx,{"data-segment-idx":i}),bindInteractionEvents(segmentDraggerGfx,"mousemove",connection))}function addHandles(connection){var gfx=getBendpointsContainer(connection);return gfx||(createBendpoints(gfx=getBendpointsContainer(connection,!0),connection),createSegmentDraggers(gfx,connection)),gfx}function updateHandles(connection){var gfx=getBendpointsContainer(connection);gfx&&(function(gfx){(0,_minDash.forEach)((0,_minDom.queryAll)("."+_BendpointUtil.SEGMENT_DRAGGER_CLS,gfx),function(node){(0,_tinySvg.remove)(node)})}(gfx),function(gfx){(0,_minDash.forEach)((0,_minDom.queryAll)("."+_BendpointUtil.BENDPOINT_CLS,gfx),function(node){(0,_tinySvg.remove)(node)})}(gfx),createSegmentDraggers(gfx,connection),createBendpoints(gfx,connection))}function updateSegmentDraggerPosition(parentGfx,intersection,waypoints){var draggerVisual,relativePosition,draggerGfx=getSegmentDragger(intersection.index,parentGfx),segmentStart=waypoints[intersection.index-1],segmentEnd=waypoints[intersection.index],point=intersection.point,mid=(0,_Geometry.getMidPoint)(segmentStart,segmentEnd),alignment=(0,_Geometry.pointsAligned)(segmentStart,segmentEnd);draggerGfx&&(draggerVisual=function(draggerGfx){return(0,_minDom.query)(".djs-visual",draggerGfx)}(draggerGfx),relativePosition={x:point.x-mid.x,y:point.y-mid.y},"v"===alignment&&(relativePosition={x:relativePosition.y,y:relativePosition.x}),(0,_SvgTransformUtil.translate)(draggerVisual,relativePosition.x,relativePosition.y))}eventBus.on("connection.changed",function(event){updateHandles(event.element)}),eventBus.on("connection.remove",function(event){var gfx=getBendpointsContainer(event.element);gfx&&(0,_tinySvg.remove)(gfx)}),eventBus.on("element.marker.update",function(event){var bendpointsGfx,element=event.element;element.waypoints&&(bendpointsGfx=addHandles(element),event.add?(0,_tinySvg.classes)(bendpointsGfx).add(event.marker):(0,_tinySvg.classes)(bendpointsGfx).remove(event.marker))}),eventBus.on("element.mousemove",function(event){var bendpointsGfx,intersection,element=event.element,waypoints=element.waypoints;if(waypoints){if(bendpointsGfx=getBendpointsContainer(element,!0),!(intersection=(0,_BendpointUtil.getConnectionIntersection)(canvas,waypoints,event.originalEvent)))return;!function(parentGfx,intersection){var floating=(0,_minDom.query)(".floating",parentGfx),point=intersection.point;floating&&(0,_SvgTransformUtil.translate)(floating,point.x,point.y)}(bendpointsGfx,intersection),intersection.bendpoint||updateSegmentDraggerPosition(bendpointsGfx,intersection,waypoints)}}),eventBus.on("element.mousedown",function(event){var originalEvent=event.originalEvent,element=event.element;if(element.waypoints)return activateBendpointMove(originalEvent,element)}),eventBus.on("selection.changed",function(event){var primary=event.newSelection[0];primary&&primary.waypoints&&addHandles(primary)}),eventBus.on("element.hover",function(event){var element=event.element;element.waypoints&&(addHandles(element),interactionEvents.registerEvent(event.gfx,"mousemove","element.mousemove"))}),eventBus.on("element.out",function(event){interactionEvents.unregisterEvent(event.gfx,"mousemove","element.mousemove")}),eventBus.on("element.updateId",function(context){var bendpointContainer,element=context.element,newId=context.newId;!element.waypoints||(bendpointContainer=getBendpointsContainer(element))&&(0,_tinySvg.attr)(bendpointContainer,{"data-element-id":newId})}),this.addHandles=addHandles,this.updateHandles=updateHandles,this.getBendpointsContainer=getBendpointsContainer,this.getSegmentDragger=getSegmentDragger}Bendpoints.$inject=["eventBus","canvas","interactionEvents","bendpointMove","connectionSegmentMove"]},{"../../util/EscapeUtil":352,"../../util/Geometry":354,"../../util/SvgTransformUtil":364,"./BendpointUtil":209,"min-dash":594,"min-dom":595,"tiny-svg":606}],211:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ConnectionSegmentMove;var _Geometry=require("../../util/Geometry"),_BendpointUtil=require("./BendpointUtil"),_LayoutUtil=require("../../layout/LayoutUtil"),_tinySvg=require("tiny-svg"),_SvgTransformUtil=require("../../util/SvgTransformUtil"),MARKER_CONNECT_HOVER="connect-hover",MARKER_CONNECT_UPDATING="djs-updating";function axisAdd(point,axis,delta){return axisSet(point,axis,point[axis]+delta)}function axisSet(point,axis,value){return{x:"x"===axis?value:point.x,y:"y"===axis?value:point.y}}function flipAxis(axis){return"x"===axis?"y":"x"}function getDocking(point,referenceElement,moveAxis){var referenceMid,inverseAxis;return point.original?point.original:(referenceMid=(0,_LayoutUtil.getMid)(referenceElement),axisSet(point,inverseAxis=flipAxis(moveAxis),referenceMid[inverseAxis]))}function ConnectionSegmentMove(injector,eventBus,canvas,dragging,graphicsFactory,modeling){var connectionDocking=injector.get("connectionDocking",!1);function cropConnection(connection,newWaypoints){if(!connectionDocking)return newWaypoints;var croppedWaypoints,oldWaypoints=connection.waypoints;return connection.waypoints=newWaypoints,croppedWaypoints=connectionDocking.getCroppedWaypoints(connection),connection.waypoints=oldWaypoints,croppedWaypoints}function redrawConnection(data){graphicsFactory.update("connection",data.connection,data.connectionGfx)}function updateDragger(context,segmentOffset,event){var newWaypoints=context.newWaypoints,draggerPosition=function(position,segmentStart,segmentEnd,axis){var maxValue=Math.max(segmentStart[axis],segmentEnd[axis]),minValue=Math.min(segmentStart[axis],segmentEnd[axis]);return axisSet(segmentStart,axis,Math.min(Math.max(minValue+20,position[axis]),maxValue-20))}(event,newWaypoints[context.segmentStartIndex+segmentOffset],newWaypoints[context.segmentEndIndex+segmentOffset],flipAxis(context.axis));(0,_SvgTransformUtil.translate)(context.draggerGfx,draggerPosition.x,draggerPosition.y)}this.start=function(event,connection,idx){var context,axis,dragPosition,gfx=canvas.getGraphics(connection),segmentStartIndex=idx-1,segmentEndIndex=idx,waypoints=connection.waypoints,segmentStart=waypoints[segmentStartIndex],segmentEnd=waypoints[segmentEndIndex],intersection=(0,_BendpointUtil.getConnectionIntersection)(canvas,waypoints,event),direction=(0,_Geometry.pointsAligned)(segmentStart,segmentEnd);direction&&(axis="v"===direction?"x":"y",0==segmentStartIndex&&(segmentStart=getDocking(segmentStart,connection.source,axis)),segmentEndIndex===waypoints.length-1&&(segmentEnd=getDocking(segmentEnd,connection.target,axis)),context={connection:connection,segmentStartIndex:segmentStartIndex,segmentEndIndex:segmentEndIndex,segmentStart:segmentStart,segmentEnd:segmentEnd,axis:axis,dragPosition:dragPosition=intersection?intersection.point:{x:(segmentStart.x+segmentEnd.x)/2,y:(segmentStart.y+segmentEnd.y)/2}},dragging.init(event,dragPosition,"connectionSegment.move",{cursor:"x"==axis?"resize-ew":"resize-ns",data:{connection:connection,connectionGfx:gfx,context:context}}))},eventBus.on("connectionSegment.move.start",function(event){var context=event.context,connection=event.connection,layer=canvas.getLayer("overlays");context.originalWaypoints=connection.waypoints.slice(),context.draggerGfx=(0,_BendpointUtil.addSegmentDragger)(layer,context.segmentStart,context.segmentEnd),(0,_tinySvg.classes)(context.draggerGfx).add("djs-dragging"),canvas.addMarker(connection,MARKER_CONNECT_UPDATING)}),eventBus.on("connectionSegment.move.move",function(event){var sourceToSegmentOrientation,targetToSegmentOrientation,context=event.context,connection=context.connection,segmentStartIndex=context.segmentStartIndex,segmentEndIndex=context.segmentEndIndex,segmentStart=context.segmentStart,segmentEnd=context.segmentEnd,axis=context.axis,newWaypoints=context.originalWaypoints.slice(),newSegmentStart=axisAdd(segmentStart,axis,event["d"+axis]),newSegmentEnd=axisAdd(segmentEnd,axis,event["d"+axis]),waypointCount=newWaypoints.length,segmentOffset=0;newWaypoints[segmentStartIndex]=newSegmentStart,newWaypoints[segmentEndIndex]=newSegmentEnd,segmentStartIndex<2&&(sourceToSegmentOrientation=(0,_LayoutUtil.getOrientation)(connection.source,newSegmentStart),1===segmentStartIndex?"intersect"===sourceToSegmentOrientation&&(newWaypoints.shift(),newWaypoints[0]=newSegmentStart,segmentOffset--):"intersect"!==sourceToSegmentOrientation&&(newWaypoints.unshift(segmentStart),segmentOffset++)),waypointCount-3<segmentEndIndex&&(targetToSegmentOrientation=(0,_LayoutUtil.getOrientation)(connection.target,newSegmentEnd),segmentEndIndex===waypointCount-2?"intersect"===targetToSegmentOrientation&&(newWaypoints.pop(),newWaypoints[newWaypoints.length-1]=newSegmentEnd):"intersect"!==targetToSegmentOrientation&&newWaypoints.push(segmentEnd)),context.newWaypoints=connection.waypoints=cropConnection(connection,newWaypoints),updateDragger(context,segmentOffset,event),context.newSegmentStartIndex=segmentStartIndex+segmentOffset,redrawConnection(event)}),eventBus.on("connectionSegment.move.hover",function(event){event.context.hover=event.hover,canvas.addMarker(event.hover,MARKER_CONNECT_HOVER)}),eventBus.on(["connectionSegment.move.out","connectionSegment.move.cleanup"],function(event){var hover=event.context.hover;hover&&canvas.removeMarker(hover,MARKER_CONNECT_HOVER)}),eventBus.on("connectionSegment.move.cleanup",function(event){var context=event.context,connection=context.connection;context.draggerGfx&&(0,_tinySvg.remove)(context.draggerGfx),canvas.removeMarker(connection,MARKER_CONNECT_UPDATING)}),eventBus.on(["connectionSegment.move.cancel","connectionSegment.move.end"],function(event){var context=event.context;context.connection.waypoints=context.originalWaypoints,redrawConnection(event)}),eventBus.on("connectionSegment.move.end",function(event){var context=event.context,connection=context.connection,newWaypoints=context.newWaypoints,newSegmentStartIndex=context.newSegmentStartIndex,filtered=function(waypoints,segmentStartIndex){var segmentOffset=0;return{waypoints:waypoints.filter(function(r,idx){return!(0,_Geometry.pointsOnLine)(waypoints[idx-1],waypoints[idx+1],r)||(segmentOffset=idx<=segmentStartIndex?segmentOffset-1:segmentOffset,!1)}),segmentOffset:segmentOffset}}(newWaypoints=newWaypoints.map(function(p){return{original:p.original,x:Math.round(p.x),y:Math.round(p.y)}}),newSegmentStartIndex),croppedWaypoints=cropConnection(connection,filtered.waypoints),segmentOffset=filtered.segmentOffset,hints={segmentMove:{segmentStartIndex:context.segmentStartIndex,newSegmentStartIndex:newSegmentStartIndex+segmentOffset}};modeling.updateWaypoints(connection,croppedWaypoints,hints)})}ConnectionSegmentMove.$inject=["injector","eventBus","canvas","dragging","graphicsFactory","modeling"]},{"../../layout/LayoutUtil":336,"../../util/Geometry":354,"../../util/SvgTransformUtil":364,"./BendpointUtil":209,"tiny-svg":606}],212:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _dragging2=_interopRequireDefault(require("../dragging")),_rules2=_interopRequireDefault(require("../rules")),_Bendpoints2=_interopRequireDefault(require("./Bendpoints")),_BendpointMove2=_interopRequireDefault(require("./BendpointMove")),_BendpointMovePreview2=_interopRequireDefault(require("./BendpointMovePreview")),_ConnectionSegmentMove2=_interopRequireDefault(require("./ConnectionSegmentMove")),_BendpointSnapping2=_interopRequireDefault(require("./BendpointSnapping"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_dragging2.default,_rules2.default],__init__:["bendpoints","bendpointSnapping","bendpointMovePreview"],bendpoints:["type",_Bendpoints2.default],bendpointMove:["type",_BendpointMove2.default],bendpointMovePreview:["type",_BendpointMovePreview2.default],connectionSegmentMove:["type",_ConnectionSegmentMove2.default],bendpointSnapping:["type",_BendpointSnapping2.default]}},{"../dragging":233,"../rules":308,"./BendpointMove":206,"./BendpointMovePreview":207,"./BendpointSnapping":208,"./Bendpoints":210,"./ConnectionSegmentMove":211}],213:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ChangeSupport;var _Elements=require("../../util/Elements");function ChangeSupport(eventBus,canvas,elementRegistry,graphicsFactory){eventBus.on("element.changed",function(event){var element=event.element;!element.parent&&element!==canvas.getRootElement()||(event.gfx=elementRegistry.getGraphics(element)),event.gfx&&eventBus.fire((0,_Elements.getType)(element)+".changed",event)}),eventBus.on("elements.changed",function(event){var elements=event.elements;elements.forEach(function(e){eventBus.fire("element.changed",{element:e})}),graphicsFactory.updateContainments(elements)}),eventBus.on("shape.changed",function(event){graphicsFactory.update("shape",event.element,event.gfx)}),eventBus.on("connection.changed",function(event){graphicsFactory.update("connection",event.element,event.gfx)})}ChangeSupport.$inject=["eventBus","canvas","elementRegistry","graphicsFactory"]},{"../../util/Elements":351}],214:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_ChangeSupport=require("./ChangeSupport"),_ChangeSupport2=(obj=_ChangeSupport)&&obj.__esModule?obj:{default:obj};exports.default={__init__:["changeSupport"],changeSupport:["type",_ChangeSupport2.default]}},{"./ChangeSupport":213}],215:[function(require,module,exports){"use strict";function Clipboard(){}Object.defineProperty(exports,"__esModule",{value:!0}),(exports.default=Clipboard).prototype.get=function(){return this._data},Clipboard.prototype.set=function(data){this._data=data},Clipboard.prototype.clear=function(){var data=this._data;return delete this._data,data},Clipboard.prototype.isEmpty=function(){return!this._data}},{}],216:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_Clipboard=require("./Clipboard"),_Clipboard2=(obj=_Clipboard)&&obj.__esModule?obj:{default:obj};exports.default={clipboard:["type",_Clipboard2.default]}},{"./Clipboard":215}],217:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=Connect,exports.isReverse=isReverse;var _LayoutUtil=require("../../layout/LayoutUtil"),_minDash=require("min-dash");function Connect(eventBus,dragging,modeling,rules){function canConnect(source,target){return rules.allowed("connection.create",{source:source,target:target})}eventBus.on("connect.hover",function(event){var context=event.context,start=context.start,hover=event.hover;if(context.hover=hover,canExecute=context.canExecute=canConnect(start,hover),!(0,_minDash.isNil)(canExecute)){if(!1!==canExecute)return context.source=start,void(context.target=hover);var canExecute=context.canExecute=canConnect(hover,start);(0,_minDash.isNil)(canExecute)||!1!==canExecute&&(context.source=hover,context.target=start)}}),eventBus.on(["connect.out","connect.cleanup"],function(event){var context=event.context;context.hover=null,context.source=null,context.target=null,context.canExecute=!1}),eventBus.on("connect.end",function(event){var context=event.context,canExecute=context.canExecute,connectionStart=context.connectionStart,connectionEnd={x:event.x,y:event.y},source=context.source,target=context.target;if(!canExecute)return!1;var attrs=null,hints={connectionStart:isReverse(context)?connectionEnd:connectionStart,connectionEnd:isReverse(context)?connectionStart:connectionEnd};(0,_minDash.isObject)(canExecute)&&(attrs=canExecute),modeling.connect(source,target,attrs,hints)}),this.start=function(event,start,connectionStart,autoActivate){(0,_minDash.isObject)(connectionStart)||(autoActivate=connectionStart,connectionStart=(0,_LayoutUtil.getMid)(start)),dragging.init(event,"connect",{autoActivate:autoActivate,data:{shape:start,context:{start:start,connectionStart:connectionStart}}})}}function isReverse(context){var hover=context.hover,source=context.source,target=context.target;return hover&&source&&hover===source&&source!==target}Connect.$inject=["eventBus","dragging","modeling","rules"]},{"../../layout/LayoutUtil":336,"min-dash":594}],218:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ConnectPreview;var _Connect=require("./Connect"),HIGH_PRIORITY=1100,LOW_PRIORITY=900,MARKER_OK="connect-ok",MARKER_NOT_OK="connect-not-ok";function ConnectPreview(injector,eventBus,canvas){var connectionPreview=injector.get("connectionPreview",!1);connectionPreview&&eventBus.on("connect.move",function(event){var context=event.context,canConnect=context.canExecute,hover=context.hover,source=context.source,start=context.start,startPosition=context.startPosition,connectionStart=context.connectionStart,connectionEnd=context.connectionEnd,target=context.target,connectionStart=connectionStart||((0,_Connect.isReverse)(context)?{x:event.x,y:event.y}:startPosition),connectionEnd=connectionEnd||((0,_Connect.isReverse)(context)?startPosition:{x:event.x,y:event.y});connectionPreview.drawPreview(context,canConnect,{source:source||start,target:target||hover,connectionStart:connectionStart,connectionEnd:connectionEnd})}),eventBus.on("connect.hover",LOW_PRIORITY,function(event){var context=event.context,hover=event.hover,canExecute=context.canExecute;null!==canExecute&&canvas.addMarker(hover,canExecute?MARKER_OK:MARKER_NOT_OK)}),eventBus.on(["connect.out","connect.cleanup"],HIGH_PRIORITY,function(event){var hover=event.hover;hover&&(canvas.removeMarker(hover,MARKER_OK),canvas.removeMarker(hover,MARKER_NOT_OK))}),connectionPreview&&eventBus.on("connect.cleanup",function(event){connectionPreview.cleanUp(event.context)})}ConnectPreview.$inject=["injector","eventBus","canvas"]},{"./Connect":217}],219:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _selection2=_interopRequireDefault(require("../selection")),_rules2=_interopRequireDefault(require("../rules")),_dragging2=_interopRequireDefault(require("../dragging")),_Connect2=_interopRequireDefault(require("./Connect")),_ConnectPreview2=_interopRequireDefault(require("./ConnectPreview"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_selection2.default,_rules2.default,_dragging2.default],__init__:["connectPreview"],connect:["type",_Connect2.default],connectPreview:["type",_ConnectPreview2.default]}},{"../dragging":233,"../rules":308,"../selection":314,"./Connect":217,"./ConnectPreview":218}],220:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ConnectionPreview;var _tinySvg=require("tiny-svg"),_minDash=require("min-dash"),_LayoutUtil=require("../../layout/LayoutUtil");function ConnectionPreview(injector,canvas,graphicsFactory,elementFactory){this._canvas=canvas,this._graphicsFactory=graphicsFactory,this._elementFactory=elementFactory,this._connectionDocking=injector.get("connectionDocking",!1),this._layouter=injector.get("layouter",!1)}ConnectionPreview.$inject=["injector","canvas","graphicsFactory","elementFactory"],ConnectionPreview.prototype.drawPreview=function(context,canConnect,hints){hints=hints||{};var connection,fn,returnValues,connectionPreviewGfx=context.connectionPreviewGfx,getConnection=context.getConnection,source=hints.source,target=hints.target,waypoints=hints.waypoints,connectionStart=hints.connectionStart,connectionEnd=hints.connectionEnd,noLayout=hints.noLayout,noCropping=hints.noCropping,noNoop=hints.noNoop,self=this,connectionPreviewGfx=connectionPreviewGfx||(context.connectionPreviewGfx=this.createConnectionPreviewGfx());(0,_tinySvg.clear)(connectionPreviewGfx),getConnection=getConnection||(context.getConnection=(fn=function(canConnect,source,target){return self.getConnection(canConnect,source,target)},returnValues={},function(firstArgument){var key=JSON.stringify(firstArgument);return returnValues[key]||(returnValues[key]=fn.apply(null,arguments))})),canConnect&&(connection=getConnection(canConnect,source,target)),connection?(connection.waypoints=waypoints||[],this._layouter&&!noLayout&&(connection.waypoints=this._layouter.layoutConnection(connection,{source:source,target:target,connectionStart:connectionStart,connectionEnd:connectionEnd,waypoints:hints.waypoints||connection.waypoints})),connection.waypoints&&connection.waypoints.length||(connection.waypoints=[source?(0,_LayoutUtil.getMid)(source):connectionStart,target?(0,_LayoutUtil.getMid)(target):connectionEnd]),this._connectionDocking&&(source||target)&&!noCropping&&(connection.waypoints=this._connectionDocking.getCroppedWaypoints(connection,source,target)),this._graphicsFactory.drawConnection(connectionPreviewGfx,connection)):noNoop||this.drawNoopPreview(connectionPreviewGfx,hints)},ConnectionPreview.prototype.drawNoopPreview=function(connectionPreviewGfx,hints){var source=hints.source,target=hints.target,start=hints.connectionStart||(0,_LayoutUtil.getMid)(source),end=hints.connectionEnd||(0,_LayoutUtil.getMid)(target),waypoints=this.cropWaypoints(start,end,source,target),connection=this.createNoopConnection(waypoints[0],waypoints[1]);(0,_tinySvg.append)(connectionPreviewGfx,connection)},ConnectionPreview.prototype.cropWaypoints=function(start,end,source,target){var graphicsFactory=this._graphicsFactory,sourcePath=source&&graphicsFactory.getShapePath(source),targetPath=target&&graphicsFactory.getShapePath(target),connectionPath=graphicsFactory.getConnectionPath({waypoints:[start,end]});return[start=source&&(0,_LayoutUtil.getElementLineIntersection)(sourcePath,connectionPath,!0)||start,end=target&&(0,_LayoutUtil.getElementLineIntersection)(targetPath,connectionPath,!1)||end]},ConnectionPreview.prototype.cleanUp=function(context){context&&context.connectionPreviewGfx&&(0,_tinySvg.remove)(context.connectionPreviewGfx)},ConnectionPreview.prototype.getConnection=function(canConnect){var attrs=function(canConnect){return(0,_minDash.isObject)(canConnect)?canConnect:{}}(canConnect);return this._elementFactory.createConnection(attrs)},ConnectionPreview.prototype.createConnectionPreviewGfx=function(){var gfx=(0,_tinySvg.create)("g");return(0,_tinySvg.attr)(gfx,{pointerEvents:"none"}),(0,_tinySvg.classes)(gfx).add("djs-connection-preview"),(0,_tinySvg.append)(this._canvas.getDefaultLayer(),gfx),gfx},ConnectionPreview.prototype.createNoopConnection=function(start,end){var connection=(0,_tinySvg.create)("polyline");return(0,_tinySvg.attr)(connection,{stroke:"#333",strokeDasharray:[1],strokeWidth:2,"pointer-events":"none"}),(0,_tinySvg.attr)(connection,{points:[start.x,start.y,end.x,end.y]}),connection}},{"../../layout/LayoutUtil":336,"min-dash":594,"tiny-svg":606}],221:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_ConnectionPreview=require("./ConnectionPreview"),_ConnectionPreview2=(obj=_ConnectionPreview)&&obj.__esModule?obj:{default:obj};exports.default={__init__:["connectionPreview"],connectionPreview:["type",_ConnectionPreview2.default]}},{"./ConnectionPreview":220}],222:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ContextPad;var _minDash=require("min-dash"),_minDom=require("min-dom");function ContextPad(config,eventBus,overlays){this._eventBus=eventBus,this._overlays=overlays;var scale=(0,_minDash.isDefined)(config&&config.scale)?config.scale:{min:1,max:1.5};this._overlaysConfig={position:{right:-9,top:-6},scale:scale},this._current=null,this._init()}ContextPad.$inject=["config.contextPad","eventBus","overlays"],ContextPad.prototype._init=function(){var eventBus=this._eventBus,self=this;eventBus.on("selection.changed",function(e){var selection=e.newSelection;1===selection.length?self.open(selection[0]):self.close()}),eventBus.on("elements.delete",function(event){var elements=event.elements;(0,_minDash.forEach)(elements,function(e){self.isOpen(e)&&self.close()})}),eventBus.on("element.changed",function(event){var element=event.element,current=self._current;current&&current.element===element&&self.open(element,!0)})},ContextPad.prototype.registerProvider=function(priority,provider){provider||(provider=priority,priority=1e3),this._eventBus.on("contextPad.getProviders",priority,function(event){event.providers.push(provider)})},ContextPad.prototype.getEntries=function(element){var providers=this._getProviders(),entries={};return(0,_minDash.forEach)(providers,function(provider){var entriesOrUpdater=provider.getContextPadEntries(element);(0,_minDash.isFunction)(entriesOrUpdater)?entries=entriesOrUpdater(entries):(0,_minDash.forEach)(entriesOrUpdater,function(entry,id){entries[id]=entry})}),entries},ContextPad.prototype.trigger=function(action,event,autoActivate){var handler,originalEvent,element=this._current.element,entries=this._current.entries,button=event.delegateTarget||event.target;if(!button)return event.preventDefault();if(handler=entries[(0,_minDom.attr)(button,"data-action")].action,originalEvent=event.originalEvent||event,(0,_minDash.isFunction)(handler)){if("click"===action)return handler(originalEvent,element,autoActivate)}else if(handler[action])return handler[action](originalEvent,element,autoActivate);event.preventDefault()},ContextPad.prototype.open=function(element,force){!force&&this.isOpen(element)||(this.close(),this._updateAndOpen(element))},ContextPad.prototype._getProviders=function(id){var event=this._eventBus.createEvent({type:"contextPad.getProviders",providers:[]});return this._eventBus.fire(event),event.providers},ContextPad.prototype._updateAndOpen=function(element){var entries=this.getEntries(element),pad=this.getPad(element),html=pad.html;(0,_minDash.forEach)(entries,function(entry,id){var container,element,classNames,classes,grouping=entry.group||"default",control=(0,_minDom.domify)(entry.html||'<div class="entry" draggable="true"></div>');(0,_minDom.attr)(control,"data-action",id),(container=(0,_minDom.query)("[data-group="+grouping+"]",html))||(container=(0,_minDom.domify)('<div class="group" data-group="'+grouping+'"></div>'),html.appendChild(container)),container.appendChild(control),entry.className&&(element=control,classNames=entry.className,classes=(0,_minDom.classes)(element),((0,_minDash.isArray)(classNames)?classNames:classNames.split(/\s+/g)).forEach(function(cls){classes.add(cls)})),entry.title&&(0,_minDom.attr)(control,"title",entry.title),entry.imageUrl&&control.appendChild((0,_minDom.domify)('<img src="'+entry.imageUrl+'">'))}),(0,_minDom.classes)(html).add("open"),this._current={element:element,pad:pad,entries:entries},this._eventBus.fire("contextPad.open",{current:this._current})},ContextPad.prototype.getPad=function(element){if(this.isOpen())return this._current.pad;var self=this,overlays=this._overlays,html=(0,_minDom.domify)('<div class="djs-context-pad"></div>'),overlaysConfig=(0,_minDash.assign)({html:html},this._overlaysConfig);_minDom.delegate.bind(html,".entry","click",function(event){self.trigger("click",event)}),_minDom.delegate.bind(html,".entry","dragstart",function(event){self.trigger("dragstart",event)}),_minDom.event.bind(html,"mousedown",function(event){event.stopPropagation()}),this._overlayId=overlays.add(element,"context-pad",overlaysConfig);var pad=overlays.get(this._overlayId);return this._eventBus.fire("contextPad.create",{element:element,pad:pad}),pad},ContextPad.prototype.close=function(){this.isOpen()&&(this._overlays.remove(this._overlayId),this._overlayId=null,this._eventBus.fire("contextPad.close",{current:this._current}),this._current=null)},ContextPad.prototype.isOpen=function(element){return!(!this._current||element&&this._current.element!==element)}},{"min-dash":594,"min-dom":595}],223:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _interactionEvents2=_interopRequireDefault(require("../interaction-events")),_overlays2=_interopRequireDefault(require("../overlays")),_ContextPad2=_interopRequireDefault(require("./ContextPad"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_interactionEvents2.default,_overlays2.default],contextPad:["type",_ContextPad2.default]}},{"../interaction-events":247,"../overlays":292,"./ContextPad":222}],224:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=CopyPaste;var _minDash=require("min-dash"),_Elements=require("../../util/Elements");function CopyPaste(canvas,create,clipboard,elementFactory,eventBus,modeling,mouse,rules){this._canvas=canvas,this._create=create,this._clipboard=clipboard,this._elementFactory=elementFactory,this._eventBus=eventBus,this._modeling=modeling,this._mouse=mouse,this._rules=rules,eventBus.on("copyPaste.copyElement",function(context){var descriptor=context.descriptor,element=context.element,elements=context.elements;descriptor.priority=1,descriptor.id=element.id,(0,_minDash.find)(elements,function(e){return e===element.parent})&&(descriptor.parent=element.parent.id),element.host&&(descriptor.priority=2,descriptor.host=element.host.id),element.waypoints&&(descriptor.priority=3,descriptor.source=element.source.id,descriptor.target=element.target.id,descriptor.waypoints=function(element){return(0,_minDash.map)(element.waypoints,function(waypoint){return(waypoint=copyWaypoint(waypoint)).original&&(waypoint.original=copyWaypoint(waypoint.original)),waypoint})}(element)),isLabel(element)&&(descriptor.priority=4,descriptor.labelTarget=element.labelTarget.id),(0,_minDash.forEach)(["x","y","width","height"],function(property){(0,_minDash.isNumber)(element[property])&&(descriptor[property]=element[property])}),descriptor.hidden=element.hidden,descriptor.collapsed=element.collapsed}),eventBus.on("copyPaste.pasteElements",function(context){var hints=context.hints;(0,_minDash.assign)(hints,{createElementsBehavior:!1})})}function isLabel(element){return element.labelTarget}function copyWaypoint(waypoint){return(0,_minDash.assign)({},waypoint)}function removeElement(element,elements){var index=elements.indexOf(element);return-1===index?elements:elements.splice(index,1)}CopyPaste.$inject=["canvas","create","clipboard","elementFactory","eventBus","modeling","mouse","rules"],CopyPaste.prototype.copy=function(elements){var allowed,tree;return(0,_minDash.isArray)(elements)||(elements=elements?[elements]:[]),tree=!1===(allowed=this._eventBus.fire("copyPaste.canCopyElements",{elements:elements}))?{}:this.createTree((0,_minDash.isArray)(allowed)?allowed:elements),this._clipboard.set(tree),this._eventBus.fire("copyPaste.elementsCopied",{elements:elements,tree:tree}),tree},CopyPaste.prototype.paste=function(context){var tree=this._clipboard.get();if(!this._clipboard.isEmpty()){var hints=context&&context.hints||{};this._eventBus.fire("copyPaste.pasteElements",{hints:hints});var elements=this._createElements(tree);if(context&&context.element&&context.point)return this._paste(elements,context.element,context.point,hints);this._create.start(this._mouse.getLastMoveEvent(),elements,{hints:hints||{}})}},CopyPaste.prototype._paste=function(elements,target,position,hints){(0,_minDash.forEach)(elements,function(element){(0,_minDash.isNumber)(element.x)||(element.x=0),(0,_minDash.isNumber)(element.y)||(element.y=0)});var bbox=(0,_Elements.getBBox)(elements);return(0,_minDash.forEach)(elements,function(element){element.waypoints&&(element.waypoints=(0,_minDash.map)(element.waypoints,function(waypoint){return{x:waypoint.x-bbox.x-bbox.width/2,y:waypoint.y-bbox.y-bbox.height/2}})),(0,_minDash.assign)(element,{x:element.x-bbox.x-bbox.width/2,y:element.y-bbox.y-bbox.height/2})}),this._modeling.createElements(elements,position,target,(0,_minDash.assign)({},hints))},CopyPaste.prototype._createElements=function(tree){var self=this,eventBus=this._eventBus,cache={},elements=[];return(0,_minDash.forEach)(tree,function(branch,depth){depth=parseInt(depth,10),branch=(0,_minDash.sortBy)(branch,"priority"),(0,_minDash.forEach)(branch,function(descriptor){var element,attrs=(0,_minDash.assign)({},(0,_minDash.omit)(descriptor,["priority"]));return cache[descriptor.parent]?attrs.parent=cache[descriptor.parent]:delete attrs.parent,eventBus.fire("copyPaste.pasteElement",{cache:cache,descriptor:attrs}),element=attrs.waypoints?(attrs.source=cache[descriptor.source],attrs.target=cache[descriptor.target],cache[descriptor.id]=self.createConnection(attrs)):isLabel(attrs)?(attrs.labelTarget=cache[attrs.labelTarget],cache[descriptor.id]=self.createLabel(attrs)):(attrs.host&&(attrs.host=cache[attrs.host]),cache[descriptor.id]=self.createShape(attrs)),void elements.push(element)})}),elements},CopyPaste.prototype.createConnection=function(attrs){return this._elementFactory.createConnection((0,_minDash.omit)(attrs,["id"]))},CopyPaste.prototype.createLabel=function(attrs){return this._elementFactory.createLabel((0,_minDash.omit)(attrs,["id"]))},CopyPaste.prototype.createShape=function(attrs){return this._elementFactory.createShape((0,_minDash.omit)(attrs,["id"]))},CopyPaste.prototype.hasRelations=function(element,elements){var source,target;return!(element.waypoints&&(source=(0,_minDash.find)(elements,(0,_minDash.matchPattern)({id:element.source.id})),target=(0,_minDash.find)(elements,(0,_minDash.matchPattern)({id:element.target.id})),!source||!target))&&!(isLabel(element)&&!(0,_minDash.find)(elements,(0,_minDash.matchPattern)({id:element.labelTarget.id})))},CopyPaste.prototype.createTree=function(elements){var rules=this._rules,self=this,tree={},elementsData=[],parents=(0,_Elements.getParents)(elements);function addElementData(element,depth){var foundElementData=(0,_minDash.find)(elementsData,function(elementsData){return element===elementsData.element});foundElementData?foundElementData.depth<depth&&(elementsData=function(elementData,elementsData){var index=elementsData.indexOf(elementData);-1!==index&&elementsData.splice(index,1);return elementsData}(foundElementData,elementsData)).push({element:foundElementData.element,depth:depth}):elementsData.push({element:element,depth:depth})}return(0,_Elements.eachElement)(parents,function(element,_index,depth){if(!isLabel(element))return(0,_minDash.forEach)(element.labels,function(label){addElementData(label,depth)}),(0,_minDash.forEach)([element.attachers,element.incoming,element.outgoing],function(elements){elements&&elements.length&&(0,_minDash.forEach)(elements,function(element){(0,_minDash.forEach)(element.labels,function(label){addElementData(label,depth)}),addElementData(element,depth)})}),addElementData(element,depth),element.children}),elements=(0,_minDash.map)(elementsData,function(elementData){return elementData.element}),elementsData=(0,_minDash.map)(elementsData,function(elementData){return elementData.descriptor={},self._eventBus.fire("copyPaste.copyElement",{descriptor:elementData.descriptor,element:elementData.element,elements:elements}),elementData}),elementsData=(0,_minDash.sortBy)(elementsData,function(elementData){return elementData.descriptor.priority}),elements=(0,_minDash.map)(elementsData,function(elementData){return elementData.element}),(0,_minDash.forEach)(elementsData,function(elementData){var depth=elementData.depth;!self.hasRelations(elementData.element,elements)||!function(element,elements){return rules.allowed("element.copy",{element:element,elements:elements})}(elementData.element,elements)?removeElement(elementData.element,elements):(tree[depth]||(tree[depth]=[]),tree[depth].push(elementData.descriptor))}),tree}},{"../../util/Elements":351,"min-dash":594}],225:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _clipboard2=_interopRequireDefault(require("../clipboard")),_create2=_interopRequireDefault(require("../create")),_mouse2=_interopRequireDefault(require("../mouse")),_rules2=_interopRequireDefault(require("../rules")),_CopyPaste2=_interopRequireDefault(require("./CopyPaste"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_clipboard2.default,_create2.default,_mouse2.default,_rules2.default],__init__:["copyPaste"],copyPaste:["type",_CopyPaste2.default]}},{"../clipboard":216,"../create":228,"../mouse":284,"../rules":308,"./CopyPaste":224}],226:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=Create;var _minDash=require("min-dash"),_Elements=require("../../util/Elements"),MARKER_OK="drop-ok",MARKER_NOT_OK="drop-not-ok",MARKER_ATTACH="attach-ok",MARKER_NEW_PARENT="new-parent",PREFIX="create",HIGH_PRIORITY=2e3;function Create(canvas,dragging,eventBus,modeling,rules){function setMarker(element,marker){[MARKER_ATTACH,MARKER_OK,MARKER_NOT_OK,MARKER_NEW_PARENT].forEach(function(m){m===marker?canvas.addMarker(element,m):canvas.removeMarker(element,m)})}function cancel(){var context=dragging.context();context&&context.prefix===PREFIX&&dragging.cancel()}eventBus.on(["create.move","create.hover"],function(event){var context=event.context,elements=context.elements,hover=event.hover,source=context.source,hints=context.hints||{};if(!hover)return context.canExecute=!1,void(context.target=null);ensureConstraints(event);var position={x:event.x,y:event.y},canExecute=context.canExecute=hover&&function(elements,target,position,source,hints){if(!target)return!1;elements=(0,_minDash.filter)(elements,function(element){var labelTarget=element.labelTarget;return!(element.parent||element.labelTarget&&-1!==elements.indexOf(labelTarget))});var shape=(0,_minDash.find)(elements,function(element){return!element.waypoints}),attach=!1,connect=!1,create=!1;isSingleShape(elements)&&(attach=rules.allowed("shape.attach",{position:position,shape:shape,target:target})),attach||(create=isSingleShape(elements)?rules.allowed("shape.create",{position:position,shape:shape,source:source,target:target}):rules.allowed("elements.create",{elements:elements,position:position,target:target}));var connectionTarget=hints.connectionTarget;return create||attach?(shape&&source&&(connect=rules.allowed("connection.create",{source:connectionTarget===source?shape:source,target:connectionTarget===source?source:shape,hints:{targetParent:target,targetAttach:attach}})),{attach:attach,connect:connect}):(null===create||null===attach)&&null}(elements,hover,position,source,hints);hover&&null!==canExecute&&(context.target=hover,canExecute&&canExecute.attach?setMarker(hover,MARKER_ATTACH):setMarker(hover,canExecute?MARKER_NEW_PARENT:MARKER_NOT_OK))}),eventBus.on(["create.end","create.out","create.cleanup"],function(event){var hover=event.hover;hover&&setMarker(hover,null)}),eventBus.on("create.end",function(event){var context=event.context,source=context.source,shape=context.shape,elements=context.elements,target=context.target,canExecute=context.canExecute,attach=canExecute&&canExecute.attach,connect=canExecute&&canExecute.connect,hints=context.hints||{};if(!1===canExecute||!target)return!1;ensureConstraints(event);var position={x:event.x,y:event.y},shape=connect?modeling.appendShape(source,shape,position,target,{attach:attach,connection:!0===connect?{}:connect,connectionTarget:hints.connectionTarget}):(elements=modeling.createElements(elements,position,target,(0,_minDash.assign)({},hints,{attach:attach})),(0,_minDash.find)(elements,function(element){return!element.waypoints}));(0,_minDash.assign)(context,{elements:elements,shape:shape}),(0,_minDash.assign)(event,{elements:elements,shape:shape})}),eventBus.on("create.init",function(){eventBus.on("elements.changed",cancel),eventBus.once(["create.cancel","create.end"],HIGH_PRIORITY,function(){eventBus.off("elements.changed",cancel)})}),this.start=function(event,elements,context){(0,_minDash.isArray)(elements)||(elements=[elements]);var bbox,shape=(0,_minDash.find)(elements,function(element){return!element.waypoints});shape&&(context=(0,_minDash.assign)({elements:elements,hints:{},shape:shape},context||{}),(0,_minDash.forEach)(elements,function(element){(0,_minDash.isNumber)(element.x)||(element.x=0),(0,_minDash.isNumber)(element.y)||(element.y=0)}),bbox=(0,_Elements.getBBox)(elements),(0,_minDash.forEach)(elements,function(element){element.waypoints&&(element.waypoints=(0,_minDash.map)(element.waypoints,function(waypoint){return{x:waypoint.x-bbox.x-bbox.width/2,y:waypoint.y-bbox.y-bbox.height/2}})),(0,_minDash.assign)(element,{x:element.x-bbox.x-bbox.width/2,y:element.y-bbox.y-bbox.height/2})}),dragging.init(event,PREFIX,{cursor:"grabbing",autoActivate:!0,data:{shape:shape,elements:elements,context:context}}))}}function ensureConstraints(event){var createConstraints=event.context.createConstraints;createConstraints&&(createConstraints.left&&(event.x=Math.max(event.x,createConstraints.left)),createConstraints.right&&(event.x=Math.min(event.x,createConstraints.right)),createConstraints.top&&(event.y=Math.max(event.y,createConstraints.top)),createConstraints.bottom&&(event.y=Math.min(event.y,createConstraints.bottom)))}function isSingleShape(elements){return elements&&1===elements.length&&!elements[0].waypoints}Create.$inject=["canvas","dragging","eventBus","modeling","rules"]},{"../../util/Elements":351,"min-dash":594}],227:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=CreatePreview;var _SvgTransformUtil=require("../../util/SvgTransformUtil"),_GraphicsUtil=require("../../util/GraphicsUtil"),_tinySvg=require("tiny-svg"),LOW_PRIORITY=750;function CreatePreview(canvas,eventBus,graphicsFactory,previewSupport,styles){eventBus.on("create.move",LOW_PRIORITY,function(event){var defaultLayer,hover=event.hover,context=event.context,elements=context.elements,dragGroup=(dragGroup=context.dragGroup)||(context.dragGroup=function(elements){var dragGroup=(0,_tinySvg.create)("g");(0,_tinySvg.attr)(dragGroup,styles.cls("djs-drag-group",["no-events"]));var childrenGfx=(0,_tinySvg.create)("g");return elements.forEach(function(element){var gfx;element.hidden||(element.waypoints?(gfx=graphicsFactory._createContainer("connection",childrenGfx),graphicsFactory.drawConnection((0,_GraphicsUtil.getVisual)(gfx),element)):(gfx=graphicsFactory._createContainer("shape",childrenGfx),graphicsFactory.drawShape((0,_GraphicsUtil.getVisual)(gfx),element),(0,_SvgTransformUtil.translate)(gfx,element.x,element.y)),previewSupport.addDragger(element,dragGroup,gfx))}),dragGroup}(elements));hover?(dragGroup.parentNode||(defaultLayer=canvas.getDefaultLayer(),(0,_tinySvg.append)(defaultLayer,dragGroup)),(0,_SvgTransformUtil.translate)(dragGroup,event.x,event.y)):(0,_tinySvg.remove)(dragGroup)}),eventBus.on("create.cleanup",function(event){var dragGroup=event.context.dragGroup;dragGroup&&(0,_tinySvg.remove)(dragGroup)})}CreatePreview.$inject=["canvas","eventBus","graphicsFactory","previewSupport","styles"]},{"../../util/GraphicsUtil":355,"../../util/SvgTransformUtil":364,"tiny-svg":606}],228:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _dragging2=_interopRequireDefault(require("../dragging")),_previewSupport2=_interopRequireDefault(require("../preview-support")),_rules2=_interopRequireDefault(require("../rules")),_selection2=_interopRequireDefault(require("../selection")),_Create2=_interopRequireDefault(require("./Create")),_CreatePreview2=_interopRequireDefault(require("./CreatePreview"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_dragging2.default,_previewSupport2.default,_rules2.default,_selection2.default],__init__:["create","createPreview"],create:["type",_Create2.default],createPreview:["type",_CreatePreview2.default]}},{"../dragging":233,"../preview-support":298,"../rules":308,"../selection":314,"./Create":226,"./CreatePreview":227}],229:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=DistributeElements;var _minDash=require("min-dash"),AXIS_DIMENSIONS={horizontal:["x","width"],vertical:["y","height"]};function DistributeElements(modeling){this._modeling=modeling,this._filters=[],this.registerFilter(function(elements,axis,dimension){var avgDimension,elementsSize=0,numOfShapes=0;return(0,_minDash.forEach)(elements,function(element){element.waypoints||element.labelTarget||(elementsSize+=element[dimension],numOfShapes+=1)}),avgDimension=Math.round(elementsSize/numOfShapes),(0,_minDash.filter)(elements,function(element){return element[dimension]<avgDimension+50})})}DistributeElements.$inject=["modeling"],DistributeElements.prototype.registerFilter=function(filterFn){if("function"!=typeof filterFn)throw new Error("the filter has to be a function");this._filters.push(filterFn)},DistributeElements.prototype.trigger=function(elements,orientation){var groups,distributableElements,modeling=this._modeling;if(!(elements.length<3||(this._setOrientation(orientation),distributableElements=this._filterElements(elements),(groups=this._createGroups(distributableElements)).length<=2)))return modeling.distributeElements(groups,this._axis,this._dimension),groups},DistributeElements.prototype._filterElements=function(elements){var filters=this._filters,axis=this._axis,dimension=this._dimension,distributableElements=[].concat(elements);return filters.length?((0,_minDash.forEach)(filters,function(filterFn){distributableElements=filterFn(distributableElements,axis,dimension)}),distributableElements):elements},DistributeElements.prototype._createGroups=function(elements){var rangeGroups=[],self=this,axis=this._axis,dimension=this._dimension;if(!axis)throw new Error('must have a defined "axis" and "dimension"');var sortedElements=(0,_minDash.sortBy)(elements,axis);return(0,_minDash.forEach)(sortedElements,function(element,idx){var range,elementRange=self._findRange(element,axis,dimension),previous=rangeGroups[rangeGroups.length-1];previous&&self._hasIntersection(previous.range,elementRange)?rangeGroups[rangeGroups.length-1].elements.push(element):(range={range:elementRange,elements:[element]},rangeGroups.push(range))}),rangeGroups},DistributeElements.prototype._setOrientation=function(direction){var orientation=AXIS_DIMENSIONS[direction];this._axis=orientation[0],this._dimension=orientation[1]},DistributeElements.prototype._hasIntersection=function(rangeA,rangeB){return Math.max(rangeA.min,rangeA.max)>=Math.min(rangeB.min,rangeB.max)&&Math.min(rangeA.min,rangeA.max)<=Math.max(rangeB.min,rangeB.max)},DistributeElements.prototype._findRange=function(element){var axis=element[this._axis];return{min:axis+5,max:axis+element[this._dimension]-5}}},{"min-dash":594}],230:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_DistributeElements=require("./DistributeElements"),_DistributeElements2=(obj=_DistributeElements)&&obj.__esModule?obj:{default:obj};exports.default={__init__:["distributeElements"],distributeElements:["type",_DistributeElements2.default]}},{"./DistributeElements":229}],231:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=Dragging;var _minDash=require("min-dash"),_minDom=require("min-dom"),_Event=require("../../util/Event"),_Cursor=require("../../util/Cursor"),_ClickTrap=require("../../util/ClickTrap"),_PositionUtil=require("../../util/PositionUtil"),round=Math.round,DRAG_ACTIVE_CLS="djs-drag-active";function preventDefault(event){event.preventDefault()}function Dragging(eventBus,canvas,selection,elementRegistry){var context,defaultOptions={threshold:5,trapClick:!0};function toLocalPoint(globalPosition){var viewbox=canvas.viewbox(),clientRect=canvas._container.getBoundingClientRect();return{x:viewbox.x+(globalPosition.x-clientRect.left)/viewbox.scale,y:viewbox.y+(globalPosition.y-clientRect.top)/viewbox.scale}}function fire(type,dragContext){dragContext=dragContext||context;var event=eventBus.createEvent((0,_minDash.assign)({},dragContext.payload,dragContext.data,{isTouch:dragContext.isTouch}));return!1!==eventBus.fire("drag."+type,event)&&eventBus.fire(dragContext.prefix+"."+type,event)}function move(event,activate){var point,payload=context.payload,displacement=context.displacement,globalStart=context.globalStart,globalCurrent=(0,_Event.toPoint)(event),globalDelta=(0,_PositionUtil.delta)(globalCurrent,globalStart),localStart=context.localStart,localCurrent=toLocalPoint(globalCurrent),localDelta=(0,_PositionUtil.delta)(localCurrent,localStart);if(!context.active&&(activate||(point=globalDelta,Math.sqrt(Math.pow(point.x,2)+Math.pow(point.y,2))>context.threshold))){if((0,_minDash.assign)(payload,{x:round(localStart.x+displacement.x),y:round(localStart.y+displacement.y),dx:0,dy:0},{originalEvent:event}),!1===fire("start"))return cancel();context.active=!0,context.keepSelection||(payload.previousSelection=selection.get(),selection.select(null)),context.cursor&&(0,_Cursor.set)(context.cursor),canvas.addMarker(canvas.getRootElement(),DRAG_ACTIVE_CLS)}(0,_Event.stopPropagation)(event),context.active&&((0,_minDash.assign)(payload,{x:round(localCurrent.x+displacement.x),y:round(localCurrent.y+displacement.y),dx:round(localDelta.x),dy:round(localDelta.y)},{originalEvent:event}),fire("move"))}function end(event){var returnValue=!0;context.active&&(event&&(context.payload.originalEvent=event,(0,_Event.stopPropagation)(event)),returnValue=fire("end")),!1===returnValue&&fire("rejected"),fire("ended",cleanup(!0!==returnValue))}function checkCancel(event){27===event.which&&(preventDefault(event),cancel())}function trapClickAndEnd(event){var untrap;context.active&&(untrap=(0,_ClickTrap.install)(eventBus),setTimeout(untrap,400),preventDefault(event)),end(event)}function trapTouch(event){move(event)}function hover(event){var payload=context.payload;payload.hoverGfx=event.gfx,payload.hover=event.element,fire("hover")}function out(event){fire("out");var payload=context.payload;payload.hoverGfx=null,payload.hover=null}function cancel(restore){var previousContext,wasActive;context&&((wasActive=context.active)&&fire("cancel"),previousContext=cleanup(restore),wasActive&&fire("canceled",previousContext))}function cleanup(restore){var previousContext,endDrag;fire("cleanup"),(0,_Cursor.unset)(),endDrag=context.trapClick?trapClickAndEnd:end,_minDom.event.unbind(document,"mousemove",move),_minDom.event.unbind(document,"dragstart",preventDefault),_minDom.event.unbind(document,"selectstart",preventDefault),_minDom.event.unbind(document,"mousedown",endDrag,!0),_minDom.event.unbind(document,"mouseup",endDrag,!0),_minDom.event.unbind(document,"keyup",checkCancel),_minDom.event.unbind(document,"touchstart",trapTouch,!0),_minDom.event.unbind(document,"touchcancel",cancel,!0),_minDom.event.unbind(document,"touchmove",move,!0),_minDom.event.unbind(document,"touchend",end,!0),eventBus.off("element.hover",hover),eventBus.off("element.out",out),canvas.removeMarker(canvas.getRootElement(),DRAG_ACTIVE_CLS);var previousSelection=context.payload.previousSelection;return!1!==restore&&previousSelection&&!selection.get().length&&function(previousSelection){var existingSelection=previousSelection.filter(function(element){return elementRegistry.get(element.id)});existingSelection.length&&selection.select(existingSelection)}(previousSelection),previousContext=context,context=null,previousContext}eventBus.on("diagram.destroy",cancel),this.init=function(event,relativeTo,prefix,options){context&&cancel(!1),"string"==typeof relativeTo&&(options=prefix,prefix=relativeTo,relativeTo=null);var originalEvent,globalStart,localStart,isTouch,data=(options=(0,_minDash.assign)({},defaultOptions,options||{})).data||{},endDrag=options.trapClick?trapClickAndEnd:end;event?(originalEvent=(0,_Event.getOriginal)(event)||event,globalStart=(0,_Event.toPoint)(event),(0,_Event.stopPropagation)(event),"dragstart"===originalEvent.type&&preventDefault(originalEvent)):(originalEvent=null,globalStart={x:0,y:0}),localStart=toLocalPoint(globalStart),relativeTo=relativeTo||localStart,isTouch=function(event){return"undefined"!=typeof TouchEvent&&event instanceof TouchEvent}(originalEvent),context=(0,_minDash.assign)({prefix:prefix,data:data,payload:{},globalStart:globalStart,displacement:(0,_PositionUtil.delta)(relativeTo,localStart),localStart:localStart,isTouch:isTouch},options),options.manual||(isTouch?(_minDom.event.bind(document,"touchstart",trapTouch,!0),_minDom.event.bind(document,"touchcancel",cancel,!0),_minDom.event.bind(document,"touchmove",move,!0),_minDom.event.bind(document,"touchend",end,!0)):(_minDom.event.bind(document,"mousemove",move),_minDom.event.bind(document,"dragstart",preventDefault),_minDom.event.bind(document,"selectstart",preventDefault),_minDom.event.bind(document,"mousedown",endDrag,!0),_minDom.event.bind(document,"mouseup",endDrag,!0)),_minDom.event.bind(document,"keyup",checkCancel),eventBus.on("element.hover",hover),eventBus.on("element.out",out)),fire("init"),options.autoActivate&&move(event,!0)},this.move=move,this.hover=hover,this.out=out,this.end=end,this.cancel=cancel,this.context=function(){return context},this.setOptions=function(options){(0,_minDash.assign)(defaultOptions,options)}}Dragging.$inject=["eventBus","canvas","selection","elementRegistry"]},{"../../util/ClickTrap":348,"../../util/Cursor":350,"../../util/Event":353,"../../util/PositionUtil":361,"min-dash":594,"min-dom":595}],232:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=HoverFix;var _minDom=require("min-dom"),_Event=require("../../util/Event"),HIGH_PRIORITY=1500;function HoverFix(eventBus,dragging,elementRegistry){var self=this;eventBus.on("drag.start",function(event){eventBus.once("drag.move",HIGH_PRIORITY,function(event){!function(event){var originalEvent,gfx,element;event.hover||(originalEvent=event.originalEvent,element=(gfx=self._findTargetGfx(originalEvent))&&elementRegistry.get(gfx),gfx&&element&&(event.stopPropagation(),dragging.hover({element:element,gfx:gfx}),dragging.move(originalEvent)))}(event)})}),eventBus.on("drag.init",function(){var hover,hoverGfx;function setDragHover(event){hover=event.hover,hoverGfx=event.hoverGfx}function unsetHover(){hoverGfx=hover=null}function ensureOut(){var element,gfx;hover&&(element=hover,gfx=hoverGfx,hoverGfx=hover=null,dragging.out({element:element,gfx:gfx}))}eventBus.on("drag.hover",setDragHover),eventBus.on("element.out",unsetHover),eventBus.on("element.hover",HIGH_PRIORITY,ensureOut),eventBus.once("drag.cleanup",function(){eventBus.off("drag.hover",setDragHover),eventBus.off("element.out",unsetHover),eventBus.off("element.hover",ensureOut)})}),this._findTargetGfx=function(event){var position;if(event instanceof MouseEvent)return position=(0,_Event.toPoint)(event),function(target){return(0,_minDom.closest)(target,"svg, .djs-element",!0)}(document.elementFromPoint(position.x,position.y))}}HoverFix.$inject=["eventBus","dragging","elementRegistry"]},{"../../util/Event":353,"min-dom":595}],233:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _selection2=_interopRequireDefault(require("../selection")),_Dragging2=_interopRequireDefault(require("./Dragging")),_HoverFix2=_interopRequireDefault(require("./HoverFix"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__init__:["hoverFix"],__depends__:[_selection2.default],dragging:["type",_Dragging2.default],hoverFix:["type",_HoverFix2.default]}},{"../selection":314,"./Dragging":231,"./HoverFix":232}],234:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=EditorActions;var _minDash=require("min-dash");function EditorActions(eventBus,injector){this._actions={};var self=this;eventBus.on("diagram.init",function(){self._registerDefaultActions(injector),eventBus.fire("editorActions.init",{editorActions:self})})}function error(action,message){return new Error(action+" "+message)}EditorActions.$inject=["eventBus","injector"],EditorActions.prototype._registerDefaultActions=function(injector){var commandStack=injector.get("commandStack",!1),modeling=injector.get("modeling",!1),selection=injector.get("selection",!1),zoomScroll=injector.get("zoomScroll",!1),copyPaste=injector.get("copyPaste",!1),canvas=injector.get("canvas",!1),rules=injector.get("rules",!1),keyboardMove=injector.get("keyboardMove",!1),keyboardMoveSelection=injector.get("keyboardMoveSelection",!1);commandStack&&(this.register("undo",function(){commandStack.undo()}),this.register("redo",function(){commandStack.redo()})),copyPaste&&selection&&this.register("copy",function(){var selectedElements=selection.get();copyPaste.copy(selectedElements)}),copyPaste&&this.register("paste",function(){copyPaste.paste()}),zoomScroll&&this.register("stepZoom",function(opts){zoomScroll.stepZoom(opts.value)}),canvas&&this.register("zoom",function(opts){canvas.zoom(opts.value)}),modeling&&selection&&rules&&this.register("removeSelection",function(){var allowed,removableElements,selectedElements=selection.get();!selectedElements.length||!1!==(allowed=rules.allowed("elements.delete",{elements:selectedElements}))&&(removableElements=(0,_minDash.isArray)(allowed)?allowed:selectedElements).length&&modeling.removeElements(removableElements.slice())}),keyboardMove&&this.register("moveCanvas",function(opts){keyboardMove.moveCanvas(opts)}),keyboardMoveSelection&&this.register("moveSelection",function(opts){keyboardMoveSelection.moveSelection(opts.direction,opts.accelerated)})},EditorActions.prototype.trigger=function(action,opts){if(!this._actions[action])throw error(action,"is not a registered action");return this._actions[action](opts)},EditorActions.prototype.register=function(actions,listener){var self=this;if("string"==typeof actions)return this._registerAction(actions,listener);(0,_minDash.forEach)(actions,function(listener,action){self._registerAction(action,listener)})},EditorActions.prototype._registerAction=function(action,listener){if(this.isRegistered(action))throw error(action,"is already registered");this._actions[action]=listener},EditorActions.prototype.unregister=function(action){if(!this.isRegistered(action))throw error(action,"is not a registered action");this._actions[action]=void 0},EditorActions.prototype.getActions=function(){return Object.keys(this._actions)},EditorActions.prototype.isRegistered=function(action){return!!this._actions[action]}},{"min-dash":594}],235:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_EditorActions=require("./EditorActions"),_EditorActions2=(obj=_EditorActions)&&obj.__esModule?obj:{default:obj};exports.default={__init__:["editorActions"],editorActions:["type",_EditorActions2.default]}},{"./EditorActions":234}],236:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=GlobalConnect;var MARKER_OK="connect-ok",MARKER_NOT_OK="connect-not-ok";function GlobalConnect(eventBus,dragging,connect,canvas,toolManager,rules){var self=this;this._dragging=dragging,this._rules=rules,toolManager.registerTool("global-connect",{tool:"global-connect",dragging:"global-connect.drag"}),eventBus.on("global-connect.hover",function(event){var context=event.context,startTarget=event.hover,canStartConnect=context.canStartConnect=self.canStartConnect(startTarget);null!==canStartConnect&&(context.startTarget=startTarget,canvas.addMarker(startTarget,canStartConnect?MARKER_OK:MARKER_NOT_OK))}),eventBus.on(["global-connect.out","global-connect.cleanup"],function(event){var startTarget=event.context.startTarget,canStartConnect=event.context.canStartConnect;startTarget&&canvas.removeMarker(startTarget,canStartConnect?MARKER_OK:MARKER_NOT_OK)}),eventBus.on(["global-connect.ended"],function(event){var startTarget=event.context.startTarget,startPosition={x:event.x,y:event.y};if(self.canStartConnect(startTarget))return eventBus.once("element.out",function(){eventBus.once(["connect.ended","connect.canceled"],function(){eventBus.fire("global-connect.drag.ended")}),connect.start(null,startTarget,startPosition)}),!1})}GlobalConnect.$inject=["eventBus","dragging","connect","canvas","toolManager","rules"],GlobalConnect.prototype.start=function(event){this._dragging.init(event,"global-connect",{trapClick:!1,data:{context:{}}})},GlobalConnect.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.start()},GlobalConnect.prototype.isActive=function(){var context=this._dragging.context();return context&&/^global-connect/.test(context.prefix)},GlobalConnect.prototype.canStartConnect=function(startTarget){return this._rules.allowed("connection.start",{source:startTarget})}},{}],237:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _connect2=_interopRequireDefault(require("../connect")),_rules2=_interopRequireDefault(require("../rules")),_dragging2=_interopRequireDefault(require("../dragging")),_toolManager2=_interopRequireDefault(require("../tool-manager")),_GlobalConnect2=_interopRequireDefault(require("./GlobalConnect"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_connect2.default,_rules2.default,_dragging2.default,_toolManager2.default],globalConnect:["type",_GlobalConnect2.default]}},{"../connect":219,"../dragging":233,"../rules":308,"../tool-manager":326,"./GlobalConnect":236}],238:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=GridSnapping;var _SnapUtil=require("../snapping/SnapUtil"),_KeyboardUtil=require("../keyboard/KeyboardUtil"),_minDash=require("min-dash"),_GridUtil=require("./GridUtil"),LOWER_PRIORITY=1200,LOW_PRIORITY=800;function GridSnapping(elementRegistry,eventBus,config){var active=!config||!1!==config.active;this._eventBus=eventBus;var self=this;eventBus.on("diagram.init",LOW_PRIORITY,function(){self.setActive(active)}),eventBus.on(["create.move","create.end","bendpoint.move.move","bendpoint.move.end","connect.move","connect.end","connectionSegment.move.move","connectionSegment.move.end","resize.move","resize.end","shape.move.move","shape.move.end"],LOWER_PRIORITY,function(event){var context,originalEvent=event.originalEvent;!self.active||originalEvent&&(0,_KeyboardUtil.isCmd)(originalEvent)||((context=event.context).gridSnappingContext||(context.gridSnappingContext={}),["x","y"].forEach(function(axis){var options={},snapOffset=function(event,axis,elementRegistry){var context=event.context,shape=event.shape,gridSnappingContext=context.gridSnappingContext,snapLocation=gridSnappingContext.snapLocation,snapOffset=gridSnappingContext.snapOffset;if(snapOffset&&(0,_minDash.isNumber)(snapOffset[axis]))return snapOffset[axis];snapOffset=snapOffset||(gridSnappingContext.snapOffset={});(0,_minDash.isNumber)(snapOffset[axis])||(snapOffset[axis]=0);if(!shape)return snapOffset[axis];elementRegistry.get(shape.id)||(snapOffset[axis]+="x"===axis?shape[axis]+shape.width/2:shape[axis]+shape.height/2);if(!snapLocation)return snapOffset[axis];"x"===axis?/left/.test(snapLocation)?snapOffset[axis]-=shape.width/2:/right/.test(snapLocation)&&(snapOffset[axis]+=shape.width/2):/top/.test(snapLocation)?snapOffset[axis]-=shape.height/2:/bottom/.test(snapLocation)&&(snapOffset[axis]+=shape.height/2);return snapOffset[axis]}(event,axis,elementRegistry);snapOffset&&(options.offset=snapOffset);var snapConstraints=function(event,axis){var context=event.context,createConstraints=context.createConstraints,resizeConstraints=context.resizeConstraints||{},gridSnappingContext=context.gridSnappingContext,snapConstraints=gridSnappingContext.snapConstraints;if(snapConstraints&&snapConstraints[axis])return snapConstraints[axis];snapConstraints=snapConstraints||(gridSnappingContext.snapConstraints={});snapConstraints[axis]||(snapConstraints[axis]={});var direction=context.direction;createConstraints&&("x"===axis?(snapConstraints.x.min=createConstraints.left,snapConstraints.x.max=createConstraints.right):(snapConstraints.y.min=createConstraints.top,snapConstraints.y.max=createConstraints.bottom));var minResizeConstraints=resizeConstraints.min,maxResizeConstraints=resizeConstraints.max;minResizeConstraints&&("x"===axis?isWest(direction)?snapConstraints.x.max=minResizeConstraints.left:snapConstraints.x.min=minResizeConstraints.right:isNorth(direction)?snapConstraints.y.max=minResizeConstraints.top:snapConstraints.y.min=minResizeConstraints.bottom);maxResizeConstraints&&("x"===axis?isWest(direction)?snapConstraints.x.min=maxResizeConstraints.left:snapConstraints.x.max=maxResizeConstraints.right:isNorth(direction)?snapConstraints.y.min=maxResizeConstraints.top:snapConstraints.y.max=maxResizeConstraints.bottom);return snapConstraints[axis]}(event,axis);snapConstraints&&(0,_minDash.assign)(options,snapConstraints),(0,_SnapUtil.isSnapped)(event,axis)||self.snapEvent(event,axis,options)}))})}function isNorth(direction){return-1!==direction.indexOf("n")}function isWest(direction){return-1!==direction.indexOf("w")}GridSnapping.prototype.snapEvent=function(event,axis,options){var snappedValue=this.snapValue(event[axis],options);(0,_SnapUtil.setSnapped)(event,axis,snappedValue)},GridSnapping.prototype.getGridSpacing=function(){return _GridUtil.SPACING},GridSnapping.prototype.snapValue=function(value,options){var min,max,offset=0;return options&&options.offset&&(offset=options.offset),value+=offset,value=(0,_GridUtil.quantize)(value,_GridUtil.SPACING),options&&options.min&&(min=options.min,(0,_minDash.isNumber)(min)&&(min=(0,_GridUtil.quantize)(min+offset,_GridUtil.SPACING,"ceil"),value=Math.max(value,min))),options&&options.max&&(max=options.max,(0,_minDash.isNumber)(max)&&(max=(0,_GridUtil.quantize)(max+offset,_GridUtil.SPACING,"floor"),value=Math.min(value,max))),value-=offset},GridSnapping.prototype.isActive=function(){return this.active},GridSnapping.prototype.setActive=function(active){this.active=active,this._eventBus.fire("gridSnapping.toggle",{active:active})},GridSnapping.prototype.toggleActive=function(){this.setActive(!this.active)},GridSnapping.$inject=["elementRegistry","eventBus","config.gridSnapping"]},{"../keyboard/KeyboardUtil":252,"../snapping/SnapUtil":318,"./GridUtil":239,"min-dash":594}],239:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.quantize=function(value,quantum,fn){fn=fn||"round";return Math[fn](value/quantum)*quantum};exports.SPACING=10},{}],240:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ResizeBehavior;var _inherits2=_interopRequireDefault(require("inherits")),_CommandInterceptor2=_interopRequireDefault(require("../../../command/CommandInterceptor")),_minDash=require("min-dash");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ResizeBehavior(eventBus,gridSnapping){_CommandInterceptor2.default.call(this,eventBus),this._gridSnapping=gridSnapping;var self=this;this.preExecute("shape.resize",function(event){var shape,newBounds,context=event.context,autoResize=(context.hints||{}).autoResize;autoResize&&(shape=context.shape,newBounds=context.newBounds,(0,_minDash.isString)(autoResize)?context.newBounds=self.snapComplex(newBounds,autoResize):context.newBounds=self.snapSimple(shape,newBounds))})}ResizeBehavior.$inject=["eventBus","gridSnapping","modeling"],(0,_inherits2.default)(ResizeBehavior,_CommandInterceptor2.default),ResizeBehavior.prototype.snapSimple=function(shape,newBounds){var gridSnapping=this._gridSnapping;return newBounds.width=gridSnapping.snapValue(newBounds.width,{min:newBounds.width}),newBounds.height=gridSnapping.snapValue(newBounds.height,{min:newBounds.height}),newBounds.x=shape.x+shape.width/2-newBounds.width/2,newBounds.y=shape.y+shape.height/2-newBounds.height/2,newBounds},ResizeBehavior.prototype.snapComplex=function(newBounds,directions){return/w|e/.test(directions)&&(newBounds=this.snapHorizontally(newBounds,directions)),/n|s/.test(directions)&&(newBounds=this.snapVertically(newBounds,directions)),newBounds},ResizeBehavior.prototype.snapHorizontally=function(newBounds,directions){var gridSnapping=this._gridSnapping,west=/w/.test(directions),east=/e/.test(directions),snappedNewBounds={};return snappedNewBounds.width=gridSnapping.snapValue(newBounds.width,{min:newBounds.width}),east&&(west?(snappedNewBounds.x=gridSnapping.snapValue(newBounds.x,{max:newBounds.x}),snappedNewBounds.width+=gridSnapping.snapValue(newBounds.x-snappedNewBounds.x,{min:newBounds.x-snappedNewBounds.x})):newBounds.x=newBounds.x+newBounds.width-snappedNewBounds.width),(0,_minDash.assign)(newBounds,snappedNewBounds),newBounds},ResizeBehavior.prototype.snapVertically=function(newBounds,directions){var gridSnapping=this._gridSnapping,north=/n/.test(directions),south=/s/.test(directions),snappedNewBounds={};return snappedNewBounds.height=gridSnapping.snapValue(newBounds.height,{min:newBounds.height}),north&&(south?(snappedNewBounds.y=gridSnapping.snapValue(newBounds.y,{max:newBounds.y}),snappedNewBounds.height+=gridSnapping.snapValue(newBounds.y-snappedNewBounds.y,{min:newBounds.y-snappedNewBounds.y})):newBounds.y=newBounds.y+newBounds.height-snappedNewBounds.height),(0,_minDash.assign)(newBounds,snappedNewBounds),newBounds}},{"../../../command/CommandInterceptor":181,inherits:385,"min-dash":594}],241:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=SpaceToolBehavior;var HIGH_PRIORITY=2e3;function SpaceToolBehavior(eventBus,gridSnapping){eventBus.on(["spaceTool.move","spaceTool.end"],HIGH_PRIORITY,function(event){var snapped,context=event.context;context.initialized&&("x"===context.axis?(snapped=gridSnapping.snapValue(event.dx),event.x=event.x+snapped-event.dx,event.dx=snapped):(snapped=gridSnapping.snapValue(event.dy),event.y=event.y+snapped-event.dy,event.dy=snapped))})}SpaceToolBehavior.$inject=["eventBus","gridSnapping"]},{}],242:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _ResizeBehavior2=_interopRequireDefault(require("./ResizeBehavior")),_SpaceToolBehavior2=_interopRequireDefault(require("./SpaceToolBehavior"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__init__:["gridSnappingResizeBehavior","gridSnappingSpaceToolBehavior"],gridSnappingResizeBehavior:["type",_ResizeBehavior2.default],gridSnappingSpaceToolBehavior:["type",_SpaceToolBehavior2.default]}},{"./ResizeBehavior":240,"./SpaceToolBehavior":241}],243:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _GridSnapping2=_interopRequireDefault(require("./GridSnapping")),_behavior2=_interopRequireDefault(require("./behavior"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_behavior2.default],__init__:["gridSnapping"],gridSnapping:["type",_GridSnapping2.default]}},{"./GridSnapping":238,"./behavior":242}],244:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};exports.default=HandTool;var _Mouse=require("../../util/Mouse"),_KeyboardUtil=require("../../features/keyboard/KeyboardUtil"),HIGH_PRIORITY=1500;function HandTool(eventBus,canvas,dragging,injector,toolManager){this._dragging=dragging;var self=this,keyboard=injector.get("keyboard",!1);toolManager.registerTool("hand",{tool:"hand",dragging:"hand.move"}),eventBus.on("element.mousedown",HIGH_PRIORITY,function(event){if((0,_Mouse.hasPrimaryModifier)(event))return this.activateMove(event.originalEvent),!1},this),keyboard&&keyboard.addListener(HIGH_PRIORITY,function(e){function activateMove(event){self.activateMove(event),window.removeEventListener("mousemove",activateMove)}isSpace(e.keyEvent)&&(self.isActive()||(window.addEventListener("mousemove",activateMove),keyboard.addListener(HIGH_PRIORITY,function deactivateMove(e){isSpace(e.keyEvent)&&(window.removeEventListener("mousemove",activateMove),keyboard.removeListener(deactivateMove,"keyboard.keyup"),dragging.cancel())},"keyboard.keyup")))},"keyboard.keydown"),eventBus.on("hand.end",function(event){var target=event.originalEvent.target;if(!(event.hover||target instanceof SVGElement))return!1;eventBus.once("hand.ended",function(){this.activateMove(event.originalEvent,{reactivate:!0})},this)},this),eventBus.on("hand.move.move",function(event){var scale=canvas.viewbox().scale;canvas.scroll({dx:event.dx*scale,dy:event.dy*scale})}),eventBus.on("hand.move.end",function(event){var reactivate=event.context.reactivate;return!(0,_Mouse.hasPrimaryModifier)(event)&&reactivate&&eventBus.once("hand.move.ended",function(event){this.activateHand(event.originalEvent,!0,!0)},this),!1},this)}function isSpace(keyEvent){return(0,_KeyboardUtil.isKey)(" ",keyEvent)}HandTool.$inject=["eventBus","canvas","dragging","injector","toolManager"],HandTool.prototype.activateMove=function(event,autoActivate,context){"object"===(void 0===autoActivate?"undefined":_typeof(autoActivate))&&(context=autoActivate,autoActivate=!1),this._dragging.init(event,"hand.move",{autoActivate:autoActivate,cursor:"grab",data:{context:context||{}}})},HandTool.prototype.activateHand=function(event,autoActivate,reactivate){this._dragging.init(event,"hand",{trapClick:!1,autoActivate:autoActivate,cursor:"grab",data:{context:{reactivate:reactivate}}})},HandTool.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.activateHand()},HandTool.prototype.isActive=function(){var context=this._dragging.context();return!!context&&/^(hand|hand\.move)$/.test(context.prefix)}},{"../../features/keyboard/KeyboardUtil":252,"../../util/Mouse":359}],245:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _toolManager2=_interopRequireDefault(require("../tool-manager")),_HandTool2=_interopRequireDefault(require("./HandTool"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_toolManager2.default],__init__:["handTool"],handTool:["type",_HandTool2.default]}},{"../tool-manager":326,"./HandTool":244}],246:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=InteractionEvents;var _minDash=require("min-dash"),_minDom=require("min-dom"),_Mouse=require("../../util/Mouse"),_tinySvg=require("tiny-svg"),_RenderUtil=require("../../util/RenderUtil");function allowAll(e){return!0}var LOW_PRIORITY=500;function InteractionEvents(eventBus,elementRegistry,styles){var self=this;function fire(type,event,element){var target,gfx;!function(localEventName,event){return!(ignoredFilters[localEventName]||_Mouse.isPrimaryButton)(event)}(type,event)&&(element?gfx=elementRegistry.getGraphics(element):(target=event.delegateTarget||event.target)&&(gfx=target,element=elementRegistry.get(gfx)),gfx&&element&&!1===eventBus.fire(type,{element:element,gfx:gfx,originalEvent:event})&&(event.stopPropagation(),event.preventDefault()))}var handlers={};function mouseHandler(localEventName){return handlers[localEventName]}var bindings={click:"element.click",contextmenu:"element.contextmenu",dblclick:"element.dblclick",mousedown:"element.mousedown",mousemove:"element.mousemove",mouseover:"element.hover",mouseout:"element.out",mouseup:"element.mouseup"},ignoredFilters={"element.contextmenu":allowAll};var ELEMENT_SELECTOR="svg, .djs-element";function registerEvent(node,event,localEvent,ignoredFilter){var handler=handlers[localEvent]=function(event){fire(localEvent,event)};ignoredFilter&&(ignoredFilters[localEvent]=ignoredFilter),handler.$delegate=_minDom.delegate.bind(node,ELEMENT_SELECTOR,event,handler)}function unregisterEvent(node,event,localEvent){var handler=mouseHandler(localEvent);handler&&_minDom.delegate.unbind(node,event,handler.$delegate)}eventBus.on("canvas.destroy",function(event){var svg;svg=event.svg,(0,_minDash.forEach)(bindings,function(val,key){unregisterEvent(svg,key,val)})}),eventBus.on("canvas.init",function(event){var svg;svg=event.svg,(0,_minDash.forEach)(bindings,function(val,key){registerEvent(svg,key,val)})}),eventBus.on(["shape.added","connection.added"],function(event){var element=event.element,gfx=event.gfx;eventBus.fire("interactionEvents.createHit",{element:element,gfx:gfx})}),eventBus.on(["shape.changed","connection.changed"],LOW_PRIORITY,function(event){var element=event.element,gfx=event.gfx;eventBus.fire("interactionEvents.updateHit",{element:element,gfx:gfx})}),eventBus.on("interactionEvents.createHit",LOW_PRIORITY,function(event){var element=event.element,gfx=event.gfx;self.createDefaultHit(element,gfx)}),eventBus.on("interactionEvents.updateHit",function(event){var element=event.element,gfx=event.gfx;self.updateDefaultHit(element,gfx)});var STROKE_HIT_STYLE=createHitStyle("djs-hit djs-hit-stroke"),CLICK_STROKE_HIT_STYLE=createHitStyle("djs-hit djs-hit-click-stroke"),HIT_TYPES={all:createHitStyle("djs-hit djs-hit-all"),"click-stroke":CLICK_STROKE_HIT_STYLE,stroke:STROKE_HIT_STYLE};function createHitStyle(classNames,attrs){return attrs=(0,_minDash.assign)({stroke:"white",strokeWidth:15},attrs||{}),styles.cls(classNames,["no-fill","no-border"],attrs)}function applyStyle(hit,type){var attrs=HIT_TYPES[type];if(!attrs)throw new Error("invalid hit type <"+type+">");return(0,_tinySvg.attr)(hit,attrs),hit}function appendHit(gfx,hit){(0,_tinySvg.append)(gfx,hit)}this.removeHits=function(gfx){var hits=(0,_minDom.queryAll)(".djs-hit",gfx);(0,_minDash.forEach)(hits,_tinySvg.remove)},this.createDefaultHit=function(element,gfx){var boxType,waypoints=element.waypoints,isFrame=element.isFrame;return waypoints?this.createWaypointsHit(gfx,waypoints):(boxType=isFrame?"stroke":"all",this.createBoxHit(gfx,boxType,{width:element.width,height:element.height}))},this.createWaypointsHit=function(gfx,waypoints){var hit=(0,_RenderUtil.createLine)(waypoints);return applyStyle(hit,"stroke"),appendHit(gfx,hit),hit},this.createBoxHit=function(gfx,type,attrs){attrs=(0,_minDash.assign)({x:0,y:0},attrs);var hit=(0,_tinySvg.create)("rect");return applyStyle(hit,type),(0,_tinySvg.attr)(hit,attrs),appendHit(gfx,hit),hit},this.updateDefaultHit=function(element,gfx){var hit=(0,_minDom.query)(".djs-hit",gfx);if(hit)return element.waypoints?(0,_RenderUtil.updateLine)(hit,element.waypoints):(0,_tinySvg.attr)(hit,{width:element.width,height:element.height}),hit},this.fire=fire,this.triggerMouseEvent=function(eventName,event,targetElement){var localEventName=bindings[eventName];if(!localEventName)throw new Error("unmapped DOM event name <"+eventName+">");return fire(localEventName,event,targetElement)},this.mouseHandler=mouseHandler,this.registerEvent=registerEvent,this.unregisterEvent=unregisterEvent}InteractionEvents.$inject=["eventBus","elementRegistry","styles"]},{"../../util/Mouse":359,"../../util/RenderUtil":363,"min-dash":594,"min-dom":595,"tiny-svg":606}],247:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_InteractionEvents=require("./InteractionEvents"),_InteractionEvents2=(obj=_InteractionEvents)&&obj.__esModule?obj:{default:obj};exports.default={__init__:["interactionEvents"],interactionEvents:["type",_InteractionEvents2.default]}},{"./InteractionEvents":246}],248:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=KeyboardMoveSelection;var _minDash=require("min-dash"),DEFAULT_CONFIG={moveSpeed:1,moveSpeedAccelerated:10},HIGHER_PRIORITY=1500,KEY_TO_DIRECTION={ArrowLeft:"left",Left:"left",ArrowUp:"up",Up:"up",ArrowRight:"right",Right:"right",ArrowDown:"down",Down:"down"},DIRECTIONS_DELTA={left:function(speed){return{x:-speed,y:0}},up:function(speed){return{x:0,y:-speed}},right:function(speed){return{x:speed,y:0}},down:function(speed){return{x:0,y:speed}}};function KeyboardMoveSelection(config,keyboard,modeling,rules,selection){var self=this;this._config=(0,_minDash.assign)({},DEFAULT_CONFIG,config||{}),keyboard.addListener(HIGHER_PRIORITY,function(event){var keyEvent=event.keyEvent,direction=KEY_TO_DIRECTION[keyEvent.key];if(direction&&!keyboard.isCmd(keyEvent)){var accelerated=keyboard.isShift(keyEvent);return self.moveSelection(direction,accelerated),!0}}),this.moveSelection=function(direction,accelerated){var speed,delta,selectedElements=selection.get();selectedElements.length&&(speed=this._config[accelerated?"moveSpeedAccelerated":"moveSpeed"],delta=DIRECTIONS_DELTA[direction](speed),rules.allowed("elements.move",{shapes:selectedElements})&&modeling.moveElements(selectedElements,delta))}}KeyboardMoveSelection.$inject=["config.keyboardMoveSelection","keyboard","modeling","rules","selection"]},{"min-dash":594}],249:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _keyboard2=_interopRequireDefault(require("../keyboard")),_selection2=_interopRequireDefault(require("../selection")),_KeyboardMoveSelection2=_interopRequireDefault(require("./KeyboardMoveSelection"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_keyboard2.default,_selection2.default],__init__:["keyboardMoveSelection"],keyboardMoveSelection:["type",_KeyboardMoveSelection2.default]}},{"../keyboard":253,"../selection":314,"./KeyboardMoveSelection":248}],250:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=Keyboard;var _minDash=require("min-dash"),_minDom=require("min-dom"),_KeyboardUtil=require("./KeyboardUtil");function Keyboard(config,eventBus){var self=this;this._config=config||{},this._eventBus=eventBus,this._keydownHandler=this._keydownHandler.bind(this),this._keyupHandler=this._keyupHandler.bind(this),eventBus.on("diagram.destroy",function(){self._fire("destroy"),self.unbind()}),eventBus.on("diagram.init",function(){self._fire("init")}),eventBus.on("attach",function(){config&&config.bindTo&&self.bind(config.bindTo)}),eventBus.on("detach",function(){self.unbind()})}Keyboard.$inject=["config.keyboard","eventBus"],Keyboard.prototype._keydownHandler=function(event){this._keyHandler(event,"keyboard.keydown")},Keyboard.prototype._keyupHandler=function(event){this._keyHandler(event,"keyboard.keyup")},Keyboard.prototype._keyHandler=function(event,type){var context;!function(target){return target&&((0,_minDom.matches)(target,"input, textarea")||"true"===target.contentEditable)}(event.target)&&(context={keyEvent:event},this._eventBus.fire(type||"keyboard.keydown",context)&&event.preventDefault())},Keyboard.prototype.bind=function(node){this.unbind(),this._node=node,_minDom.event.bind(node,"keydown",this._keydownHandler,!0),_minDom.event.bind(node,"keyup",this._keyupHandler,!0),this._fire("bind")},Keyboard.prototype.getBinding=function(){return this._node},Keyboard.prototype.unbind=function(){var node=this._node;node&&(this._fire("unbind"),_minDom.event.unbind(node,"keydown",this._keydownHandler,!0),_minDom.event.unbind(node,"keyup",this._keyupHandler,!0)),this._node=null},Keyboard.prototype._fire=function(event){this._eventBus.fire("keyboard."+event,{node:this._node})},Keyboard.prototype.addListener=function(priority,listener,type){(0,_minDash.isFunction)(priority)&&(type=listener,listener=priority,priority=1e3),this._eventBus.on(type||"keyboard.keydown",priority,listener)},Keyboard.prototype.removeListener=function(listener,type){this._eventBus.off(type||"keyboard.keydown",listener)},Keyboard.prototype.hasModifier=_KeyboardUtil.hasModifier,Keyboard.prototype.isCmd=_KeyboardUtil.isCmd,Keyboard.prototype.isShift=_KeyboardUtil.isShift,Keyboard.prototype.isKey=_KeyboardUtil.isKey},{"./KeyboardUtil":252,"min-dash":594,"min-dom":595}],251:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.KEYS_UNDO=exports.KEYS_REDO=exports.KEYS_PASTE=exports.KEYS_COPY=exports.KEYCODE_Z=exports.KEYCODE_Y=exports.KEYCODE_V=exports.KEYCODE_C=void 0,exports.default=KeyboardBindings;var _KeyboardUtil=require("./KeyboardUtil"),LOW_PRIORITY=500,KEYS_COPY=(exports.KEYCODE_C=67,exports.KEYCODE_V=86,exports.KEYCODE_Y=89,exports.KEYCODE_Z=90,exports.KEYS_COPY=["c","C",67]),KEYS_PASTE=exports.KEYS_PASTE=["v","V",86],KEYS_REDO=exports.KEYS_REDO=["y","Y",89],KEYS_UNDO=exports.KEYS_UNDO=["z","Z",90];function KeyboardBindings(eventBus,keyboard){var self=this;eventBus.on("editorActions.init",LOW_PRIORITY,function(event){var editorActions=event.editorActions;self.registerBindings(keyboard,editorActions)})}KeyboardBindings.$inject=["eventBus","keyboard"],KeyboardBindings.prototype.registerBindings=function(keyboard,editorActions){function addListener(action,fn){editorActions.isRegistered(action)&&keyboard.addListener(fn)}addListener("undo",function(context){var event=context.keyEvent;if((0,_KeyboardUtil.isCmd)(event)&&!(0,_KeyboardUtil.isShift)(event)&&(0,_KeyboardUtil.isKey)(KEYS_UNDO,event))return editorActions.trigger("undo"),!0}),addListener("redo",function(context){var event=context.keyEvent;if((0,_KeyboardUtil.isCmd)(event)&&((0,_KeyboardUtil.isKey)(KEYS_REDO,event)||(0,_KeyboardUtil.isKey)(KEYS_UNDO,event)&&(0,_KeyboardUtil.isShift)(event)))return editorActions.trigger("redo"),!0}),addListener("copy",function(context){var event=context.keyEvent;if((0,_KeyboardUtil.isCmd)(event)&&(0,_KeyboardUtil.isKey)(KEYS_COPY,event))return editorActions.trigger("copy"),!0}),addListener("paste",function(context){var event=context.keyEvent;if((0,_KeyboardUtil.isCmd)(event)&&(0,_KeyboardUtil.isKey)(KEYS_PASTE,event))return editorActions.trigger("paste"),!0}),addListener("stepZoom",function(context){var event=context.keyEvent;if((0,_KeyboardUtil.isKey)(["+","Add","="],event)&&(0,_KeyboardUtil.isCmd)(event))return editorActions.trigger("stepZoom",{value:1}),!0}),addListener("stepZoom",function(context){var event=context.keyEvent;if((0,_KeyboardUtil.isKey)(["-","Subtract"],event)&&(0,_KeyboardUtil.isCmd)(event))return editorActions.trigger("stepZoom",{value:-1}),!0}),addListener("zoom",function(context){var event=context.keyEvent;if((0,_KeyboardUtil.isKey)("0",event)&&(0,_KeyboardUtil.isCmd)(event))return editorActions.trigger("zoom",{value:1}),!0}),addListener("removeSelection",function(context){var event=context.keyEvent;if((0,_KeyboardUtil.isKey)(["Backspace","Delete","Del"],event))return editorActions.trigger("removeSelection"),!0})}},{"./KeyboardUtil":252}],252:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.hasModifier=function(event){return event.ctrlKey||event.metaKey||event.shiftKey||event.altKey},exports.isCmd=function(event){if(event.altKey)return!1;return event.ctrlKey||event.metaKey},exports.isKey=function(keys,event){return-1!==(keys=(0,_minDash.isArray)(keys)?keys:[keys]).indexOf(event.key)||-1!==keys.indexOf(event.keyCode)},exports.isShift=function(event){return event.shiftKey};var _minDash=require("min-dash")},{"min-dash":594}],253:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _Keyboard2=_interopRequireDefault(require("./Keyboard")),_KeyboardBindings2=_interopRequireDefault(require("./KeyboardBindings"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__init__:["keyboard","keyboardBindings"],keyboard:["type",_Keyboard2.default],keyboardBindings:["type",_KeyboardBindings2.default]}},{"./Keyboard":250,"./KeyboardBindings":251}],254:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=LabelSupport;var _minDash=require("min-dash"),_inherits2=_interopRequireDefault(require("inherits")),_Collections=require("../../util/Collections"),_Removal=require("../../util/Removal"),_CommandInterceptor2=_interopRequireDefault(require("../../command/CommandInterceptor"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var LOW_PRIORITY=250,HIGH_PRIORITY=1400;function LabelSupport(injector,eventBus,modeling){_CommandInterceptor2.default.call(this,eventBus);var movePreview=injector.get("movePreview",!1);eventBus.on("shape.move.start",HIGH_PRIORITY,function(e){var context=e.context,shapes=context.shapes,validatedShapes=context.validatedShapes;context.shapes=removeLabels(shapes),context.validatedShapes=removeLabels(validatedShapes)}),movePreview&&eventBus.on("shape.move.start",LOW_PRIORITY,function(e){var context=e.context,shapes=context.shapes,labels=[];(0,_minDash.forEach)(shapes,function(element){(0,_minDash.forEach)(element.labels,function(label){label.hidden||-1!==context.shapes.indexOf(label)||labels.push(label),element.labelTarget&&labels.push(element)})}),(0,_minDash.forEach)(labels,function(label){movePreview.makeDraggable(context,label,!0)})}),this.preExecuted("elements.move",HIGH_PRIORITY,function(e){var closure=e.context.closure,enclosedElements=closure.enclosedElements,enclosedLabels=[];(0,_minDash.forEach)(enclosedElements,function(element){(0,_minDash.forEach)(element.labels,function(label){enclosedElements[label.id]||enclosedLabels.push(label)})}),closure.addAll(enclosedLabels)}),this.preExecute(["connection.delete","shape.delete"],function(e){var context=e.context,element=context.connection||context.shape;(0,_Removal.saveClear)(element.labels,function(label){modeling.removeShape(label,{nested:!0})})}),this.execute("shape.delete",function(e){var context=e.context,shape=context.shape,labelTarget=shape.labelTarget;labelTarget&&(context.labelTargetIndex=(0,_Collections.indexOf)(labelTarget.labels,shape),context.labelTarget=labelTarget,shape.labelTarget=null)}),this.revert("shape.delete",function(e){var context=e.context,shape=context.shape,labelTarget=context.labelTarget,labelTargetIndex=context.labelTargetIndex;labelTarget&&((0,_Collections.add)(labelTarget.labels,shape,labelTargetIndex),shape.labelTarget=labelTarget)})}function removeLabels(elements){return(0,_minDash.filter)(elements,function(element){return-1===elements.indexOf(element.labelTarget)})}(0,_inherits2.default)(LabelSupport,_CommandInterceptor2.default),LabelSupport.$inject=["injector","eventBus","modeling"]},{"../../command/CommandInterceptor":181,"../../util/Collections":349,"../../util/Removal":362,inherits:385,"min-dash":594}],255:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_LabelSupport=require("./LabelSupport"),_LabelSupport2=(obj=_LabelSupport)&&obj.__esModule?obj:{default:obj};exports.default={__init__:["labelSupport"],labelSupport:["type",_LabelSupport2.default]}},{"./LabelSupport":254}],256:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=LassoTool;var _minDash=require("min-dash"),_Elements=require("../../util/Elements"),_Mouse=require("../../util/Mouse"),_tinySvg=require("tiny-svg");function LassoTool(eventBus,canvas,dragging,elementRegistry,selection,toolManager){this._selection=selection,this._dragging=dragging;var self=this,visuals_create=function(context){var container=canvas.getDefaultLayer(),frame=context.frame=(0,_tinySvg.create)("rect");(0,_tinySvg.attr)(frame,{class:"djs-lasso-overlay",width:1,height:1,x:0,y:0}),(0,_tinySvg.append)(container,frame)},visuals_update=function(context){var frame=context.frame,bbox=context.bbox;(0,_tinySvg.attr)(frame,{x:bbox.x,y:bbox.y,width:bbox.width,height:bbox.height})},visuals_remove=function(context){context.frame&&(0,_tinySvg.remove)(context.frame)};toolManager.registerTool("lasso",{tool:"lasso.selection",dragging:"lasso"}),eventBus.on("lasso.selection.end",function(event){var target=event.originalEvent.target;(event.hover||target instanceof SVGElement)&&eventBus.once("lasso.selection.ended",function(){self.activateLasso(event.originalEvent,!0)})}),eventBus.on("lasso.end",function(event){var bbox=toBBox(event),elements=elementRegistry.filter(function(element){return element});self.select(elements,bbox)}),eventBus.on("lasso.start",function(event){var context=event.context;context.bbox=toBBox(event),visuals_create(context)}),eventBus.on("lasso.move",function(event){var context=event.context;context.bbox=toBBox(event),visuals_update(context)}),eventBus.on("lasso.cleanup",function(event){var context=event.context;visuals_remove(context)}),eventBus.on("element.mousedown",1500,function(event){if((0,_Mouse.hasSecondaryModifier)(event))return self.activateLasso(event.originalEvent),!0})}function toBBox(event){var start={x:event.x-event.dx,y:event.y-event.dy},end={x:event.x,y:event.y},bbox=start.x<=end.x&&start.y<end.y||start.x<end.x&&start.y<=end.y?{x:start.x,y:start.y,width:end.x-start.x,height:end.y-start.y}:end.x<=start.x&&start.y<end.y||end.x<start.x&&start.y<=end.y?{x:end.x,y:start.y,width:start.x-end.x,height:end.y-start.y}:start.x<=end.x&&end.y<start.y||start.x<end.x&&end.y<=start.y?{x:start.x,y:end.y,width:end.x-start.x,height:start.y-end.y}:end.x<=start.x&&end.y<start.y||end.x<start.x&&end.y<=start.y?{x:end.x,y:end.y,width:start.x-end.x,height:start.y-end.y}:{x:end.x,y:end.y,width:0,height:0};return bbox}LassoTool.$inject=["eventBus","canvas","dragging","elementRegistry","selection","toolManager"],LassoTool.prototype.activateLasso=function(event,autoActivate){this._dragging.init(event,"lasso",{autoActivate:autoActivate,cursor:"crosshair",data:{context:{}}})},LassoTool.prototype.activateSelection=function(event){this._dragging.init(event,"lasso.selection",{trapClick:!1,cursor:"crosshair",data:{context:{}}})},LassoTool.prototype.select=function(elements,bbox){var selectedElements=(0,_Elements.getEnclosedElements)(elements,bbox);this._selection.select((0,_minDash.values)(selectedElements))},LassoTool.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.activateSelection()},LassoTool.prototype.isActive=function(){var context=this._dragging.context();return context&&/^lasso/.test(context.prefix)}},{"../../util/Elements":351,"../../util/Mouse":359,"min-dash":594,"tiny-svg":606}],257:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _toolManager2=_interopRequireDefault(require("../tool-manager")),_LassoTool2=_interopRequireDefault(require("./LassoTool"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_toolManager2.default],__init__:["lassoTool"],lassoTool:["type",_LassoTool2.default]}},{"../tool-manager":326,"./LassoTool":256}],258:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};exports.default=Modeling;var _minDash=require("min-dash"),_model=require("../../model"),_AlignElementsHandler2=_interopRequireDefault(require("./cmd/AlignElementsHandler")),_AppendShapeHandler2=_interopRequireDefault(require("./cmd/AppendShapeHandler")),_CreateConnectionHandler2=_interopRequireDefault(require("./cmd/CreateConnectionHandler")),_CreateElementsHandler2=_interopRequireDefault(require("./cmd/CreateElementsHandler")),_CreateLabelHandler2=_interopRequireDefault(require("./cmd/CreateLabelHandler")),_CreateShapeHandler2=_interopRequireDefault(require("./cmd/CreateShapeHandler")),_DeleteConnectionHandler2=_interopRequireDefault(require("./cmd/DeleteConnectionHandler")),_DeleteElementsHandler2=_interopRequireDefault(require("./cmd/DeleteElementsHandler")),_DeleteShapeHandler2=_interopRequireDefault(require("./cmd/DeleteShapeHandler")),_DistributeElementsHandler2=_interopRequireDefault(require("./cmd/DistributeElementsHandler")),_LayoutConnectionHandler2=_interopRequireDefault(require("./cmd/LayoutConnectionHandler")),_MoveConnectionHandler2=_interopRequireDefault(require("./cmd/MoveConnectionHandler")),_MoveElementsHandler2=_interopRequireDefault(require("./cmd/MoveElementsHandler")),_MoveShapeHandler2=_interopRequireDefault(require("./cmd/MoveShapeHandler")),_ReconnectConnectionHandler2=_interopRequireDefault(require("./cmd/ReconnectConnectionHandler")),_ReplaceShapeHandler2=_interopRequireDefault(require("./cmd/ReplaceShapeHandler")),_ResizeShapeHandler2=_interopRequireDefault(require("./cmd/ResizeShapeHandler")),_SpaceToolHandler2=_interopRequireDefault(require("./cmd/SpaceToolHandler")),_ToggleShapeCollapseHandler2=_interopRequireDefault(require("./cmd/ToggleShapeCollapseHandler")),_UpdateAttachmentHandler2=_interopRequireDefault(require("./cmd/UpdateAttachmentHandler")),_UpdateWaypointsHandler2=_interopRequireDefault(require("./cmd/UpdateWaypointsHandler"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function Modeling(eventBus,elementFactory,commandStack){this._eventBus=eventBus,this._elementFactory=elementFactory,this._commandStack=commandStack;var self=this;eventBus.on("diagram.init",function(){self.registerHandlers(commandStack)})}Modeling.$inject=["eventBus","elementFactory","commandStack"],Modeling.prototype.getHandlers=function(){return{"shape.append":_AppendShapeHandler2.default,"shape.create":_CreateShapeHandler2.default,"shape.delete":_DeleteShapeHandler2.default,"shape.move":_MoveShapeHandler2.default,"shape.resize":_ResizeShapeHandler2.default,"shape.replace":_ReplaceShapeHandler2.default,"shape.toggleCollapse":_ToggleShapeCollapseHandler2.default,spaceTool:_SpaceToolHandler2.default,"label.create":_CreateLabelHandler2.default,"connection.create":_CreateConnectionHandler2.default,"connection.delete":_DeleteConnectionHandler2.default,"connection.move":_MoveConnectionHandler2.default,"connection.layout":_LayoutConnectionHandler2.default,"connection.updateWaypoints":_UpdateWaypointsHandler2.default,"connection.reconnect":_ReconnectConnectionHandler2.default,"elements.create":_CreateElementsHandler2.default,"elements.move":_MoveElementsHandler2.default,"elements.delete":_DeleteElementsHandler2.default,"elements.distribute":_DistributeElementsHandler2.default,"elements.align":_AlignElementsHandler2.default,"element.updateAttachment":_UpdateAttachmentHandler2.default}},Modeling.prototype.registerHandlers=function(commandStack){(0,_minDash.forEach)(this.getHandlers(),function(handler,id){commandStack.registerHandler(id,handler)})},Modeling.prototype.moveShape=function(shape,delta,newParent,newParentIndex,hints){"object"===(void 0===newParentIndex?"undefined":_typeof(newParentIndex))&&(hints=newParentIndex,newParentIndex=null);var context={shape:shape,delta:delta,newParent:newParent,newParentIndex:newParentIndex,hints:hints||{}};this._commandStack.execute("shape.move",context)},Modeling.prototype.updateAttachment=function(shape,newHost){var context={shape:shape,newHost:newHost};this._commandStack.execute("element.updateAttachment",context)},Modeling.prototype.moveElements=function(shapes,delta,target,hints){var newHost,attach=(hints=hints||{}).attach,newParent=target;!0===attach?newParent=(newHost=target).parent:!1===attach&&(newHost=null);var context={shapes:shapes,delta:delta,newParent:newParent,newHost:newHost,hints:hints};this._commandStack.execute("elements.move",context)},Modeling.prototype.moveConnection=function(connection,delta,newParent,newParentIndex,hints){"object"===(void 0===newParentIndex?"undefined":_typeof(newParentIndex))&&(hints=newParentIndex,newParentIndex=void 0);var context={connection:connection,delta:delta,newParent:newParent,newParentIndex:newParentIndex,hints:hints||{}};this._commandStack.execute("connection.move",context)},Modeling.prototype.layoutConnection=function(connection,hints){var context={connection:connection,hints:hints||{}};this._commandStack.execute("connection.layout",context)},Modeling.prototype.createConnection=function(source,target,parentIndex,connection,parent,hints){"object"===(void 0===parentIndex?"undefined":_typeof(parentIndex))&&(hints=parent,parent=connection,connection=parentIndex,parentIndex=void 0);var context={source:source,target:target,parent:parent,parentIndex:parentIndex,connection:connection=this._create("connection",connection),hints:hints};return this._commandStack.execute("connection.create",context),context.connection},Modeling.prototype.createShape=function(shape,position,target,parentIndex,hints){"number"!=typeof parentIndex&&(hints=parentIndex,parentIndex=void 0);var parent,host,attach=(hints=hints||{}).attach;shape=this._create("shape",shape),attach?(parent=target.parent,host=target):parent=target;var context={position:position,shape:shape,parent:parent,parentIndex:parentIndex,host:host,hints:hints};return this._commandStack.execute("shape.create",context),context.shape},Modeling.prototype.createElements=function(elements,position,parent,parentIndex,hints){(0,_minDash.isArray)(elements)||(elements=[elements]),"number"!=typeof parentIndex&&(hints=parentIndex,parentIndex=void 0);var context={position:position,elements:elements,parent:parent,parentIndex:parentIndex,hints:hints=hints||{}};return this._commandStack.execute("elements.create",context),context.elements},Modeling.prototype.createLabel=function(labelTarget,position,label,parent){label=this._create("label",label);var context={labelTarget:labelTarget,position:position,parent:parent||labelTarget.parent,shape:label};return this._commandStack.execute("label.create",context),context.shape},Modeling.prototype.appendShape=function(source,shape,position,target,hints){hints=hints||{};var context={source:source,position:position,target:target,shape:shape=this._create("shape",shape),connection:hints.connection,connectionParent:hints.connectionParent,hints:hints};return this._commandStack.execute("shape.append",context),context.shape},Modeling.prototype.removeElements=function(elements){var context={elements:elements};this._commandStack.execute("elements.delete",context)},Modeling.prototype.distributeElements=function(groups,axis,dimension){var context={groups:groups,axis:axis,dimension:dimension};this._commandStack.execute("elements.distribute",context)},Modeling.prototype.removeShape=function(shape,hints){var context={shape:shape,hints:hints||{}};this._commandStack.execute("shape.delete",context)},Modeling.prototype.removeConnection=function(connection,hints){var context={connection:connection,hints:hints||{}};this._commandStack.execute("connection.delete",context)},Modeling.prototype.replaceShape=function(oldShape,newShape,hints){var context={oldShape:oldShape,newData:newShape,hints:hints||{}};return this._commandStack.execute("shape.replace",context),context.newShape},Modeling.prototype.alignElements=function(elements,alignment){var context={elements:elements,alignment:alignment};this._commandStack.execute("elements.align",context)},Modeling.prototype.resizeShape=function(shape,newBounds,minBounds,hints){var context={shape:shape,newBounds:newBounds,minBounds:minBounds,hints:hints};this._commandStack.execute("shape.resize",context)},Modeling.prototype.createSpace=function(movingShapes,resizingShapes,delta,direction,start){var context={delta:delta,direction:direction,movingShapes:movingShapes,resizingShapes:resizingShapes,start:start};this._commandStack.execute("spaceTool",context)},Modeling.prototype.updateWaypoints=function(connection,newWaypoints,hints){var context={connection:connection,newWaypoints:newWaypoints,hints:hints||{}};this._commandStack.execute("connection.updateWaypoints",context)},Modeling.prototype.reconnect=function(connection,source,target,dockingOrPoints,hints){var context={connection:connection,newSource:source,newTarget:target,dockingOrPoints:dockingOrPoints,hints:hints||{}};this._commandStack.execute("connection.reconnect",context)},Modeling.prototype.reconnectStart=function(connection,newSource,dockingOrPoints,hints){hints=hints||{},this.reconnect(connection,newSource,connection.target,dockingOrPoints,(0,_minDash.assign)(hints,{docking:"source"}))},Modeling.prototype.reconnectEnd=function(connection,newTarget,dockingOrPoints,hints){hints=hints||{},this.reconnect(connection,connection.source,newTarget,dockingOrPoints,(0,_minDash.assign)(hints,{docking:"target"}))},Modeling.prototype.connect=function(source,target,attrs,hints){return this.createConnection(source,target,attrs||{},source.parent,hints)},Modeling.prototype._create=function(type,attrs){return attrs instanceof _model.Base?attrs:this._elementFactory.create(type,attrs)},Modeling.prototype.toggleCollapse=function(shape,hints){var context={shape:shape,hints:hints||{}};this._commandStack.execute("shape.toggleCollapse",context)}},{"../../model":338,"./cmd/AlignElementsHandler":259,"./cmd/AppendShapeHandler":260,"./cmd/CreateConnectionHandler":261,"./cmd/CreateElementsHandler":262,"./cmd/CreateLabelHandler":263,"./cmd/CreateShapeHandler":264,"./cmd/DeleteConnectionHandler":265,"./cmd/DeleteElementsHandler":266,"./cmd/DeleteShapeHandler":267,"./cmd/DistributeElementsHandler":268,"./cmd/LayoutConnectionHandler":269,"./cmd/MoveConnectionHandler":270,"./cmd/MoveElementsHandler":271,"./cmd/MoveShapeHandler":272,"./cmd/ReconnectConnectionHandler":273,"./cmd/ReplaceShapeHandler":274,"./cmd/ResizeShapeHandler":275,"./cmd/SpaceToolHandler":276,"./cmd/ToggleShapeCollapseHandler":277,"./cmd/UpdateAttachmentHandler":278,"./cmd/UpdateWaypointsHandler":279,"min-dash":594}],259:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=AlignElements;var _minDash=require("min-dash");function AlignElements(modeling,canvas){this._modeling=modeling,this._canvas=canvas}AlignElements.$inject=["modeling","canvas"],AlignElements.prototype.preExecute=function(context){var modeling=this._modeling,elements=context.elements,alignment=context.alignment;(0,_minDash.forEach)(elements,function(element){var delta={x:0,y:0};alignment.left?delta.x=alignment.left-element.x:alignment.right?delta.x=alignment.right-element.width-element.x:alignment.center?delta.x=alignment.center-Math.round(element.width/2)-element.x:alignment.top?delta.y=alignment.top-element.y:alignment.bottom?delta.y=alignment.bottom-element.height-element.y:alignment.middle&&(delta.y=alignment.middle-Math.round(element.height/2)-element.y),modeling.moveElements([element],delta,element.parent)})},AlignElements.prototype.postExecute=function(context){}},{"min-dash":594}],260:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=AppendShapeHandler;var _minDash=require("min-dash");function AppendShapeHandler(modeling){this._modeling=modeling}AppendShapeHandler.$inject=["modeling"],AppendShapeHandler.prototype.preExecute=function(context){var source=context.source;if(!source)throw new Error("source required");var target=context.target||source.parent,shape=context.shape,hints=context.hints||{},shape=context.shape=this._modeling.createShape(shape,context.position,target,{attach:hints.attach});context.shape=shape},AppendShapeHandler.prototype.postExecute=function(context){var source,target,hints=context.hints||{};source=context.source,target=context.shape,(0,_minDash.some)(source.outgoing,function(c){return c.target===target})||(hints.connectionTarget===context.source?this._modeling.connect(context.shape,context.source,context.connection):this._modeling.connect(context.source,context.shape,context.connection))}},{"min-dash":594}],261:[function(require,module,exports){"use strict";function CreateConnectionHandler(canvas,layouter){this._canvas=canvas,this._layouter=layouter}Object.defineProperty(exports,"__esModule",{value:!0}),(exports.default=CreateConnectionHandler).$inject=["canvas","layouter"],CreateConnectionHandler.prototype.execute=function(context){var connection=context.connection,source=context.source,target=context.target,parent=context.parent,parentIndex=context.parentIndex,hints=context.hints;if(!source||!target)throw new Error("source and target required");if(!parent)throw new Error("parent required");return connection.source=source,connection.target=target,connection.waypoints||(connection.waypoints=this._layouter.layoutConnection(connection,hints)),this._canvas.addConnection(connection,parent,parentIndex),connection},CreateConnectionHandler.prototype.revert=function(context){var connection=context.connection;return this._canvas.removeConnection(connection),connection.source=null,connection.target=null,connection}},{}],262:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=CreateElementsHandler;var _minDash=require("min-dash"),_Elements=require("../../../util/Elements"),round=Math.round;function CreateElementsHandler(modeling){this._modeling=modeling}CreateElementsHandler.$inject=["modeling"],CreateElementsHandler.prototype.preExecute=function(context){var elements=context.elements,parent=context.parent,parentIndex=context.parentIndex,position=context.position,hints=context.hints,modeling=this._modeling;(0,_minDash.forEach)(elements,function(element){(0,_minDash.isNumber)(element.x)||(element.x=0),(0,_minDash.isNumber)(element.y)||(element.y=0)});var bbox=(0,_Elements.getBBox)(elements);(0,_minDash.forEach)(elements,function(element){element.waypoints&&(element.waypoints=(0,_minDash.map)(element.waypoints,function(waypoint){return{x:round(waypoint.x-bbox.x-bbox.width/2+position.x),y:round(waypoint.y-bbox.y-bbox.height/2+position.y)}})),(0,_minDash.assign)(element,{x:round(element.x-bbox.x-bbox.width/2+position.x),y:round(element.y-bbox.y-bbox.height/2+position.y)})});var parents=(0,_Elements.getParents)(elements),cache={};(0,_minDash.forEach)(elements,function(element){var createShapeHints;element.waypoints?cache[element.id]=(0,_minDash.isNumber)(parentIndex)?modeling.createConnection(cache[element.source.id],cache[element.target.id],parentIndex,element,element.parent||parent,hints):modeling.createConnection(cache[element.source.id],cache[element.target.id],element,element.parent||parent,hints):(createShapeHints=(0,_minDash.assign)({},hints),-1===parents.indexOf(element)&&(createShapeHints.autoResize=!1),cache[element.id]=(0,_minDash.isNumber)(parentIndex)?modeling.createShape(element,(0,_minDash.pick)(element,["x","y","width","height"]),element.parent||parent,parentIndex,createShapeHints):modeling.createShape(element,(0,_minDash.pick)(element,["x","y","width","height"]),element.parent||parent,createShapeHints))}),context.elements=(0,_minDash.values)(cache)}},{"../../../util/Elements":351,"min-dash":594}],263:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=CreateLabelHandler;var _inherits2=_interopRequireDefault(require("inherits")),_CreateShapeHandler2=_interopRequireDefault(require("./CreateShapeHandler"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function CreateLabelHandler(canvas){_CreateShapeHandler2.default.call(this,canvas)}(0,_inherits2.default)(CreateLabelHandler,_CreateShapeHandler2.default),CreateLabelHandler.$inject=["canvas"];var originalExecute=_CreateShapeHandler2.default.prototype.execute;CreateLabelHandler.prototype.execute=function(context){var label=context.shape;return function(label){["width","height"].forEach(function(prop){void 0===label[prop]&&(label[prop]=0)})}(label),label.labelTarget=context.labelTarget,originalExecute.call(this,context)};var originalRevert=_CreateShapeHandler2.default.prototype.revert;CreateLabelHandler.prototype.revert=function(context){return context.shape.labelTarget=null,originalRevert.call(this,context)}},{"./CreateShapeHandler":264,inherits:385}],264:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=CreateShapeHandler;var _minDash=require("min-dash"),round=Math.round;function CreateShapeHandler(canvas){this._canvas=canvas}CreateShapeHandler.$inject=["canvas"],CreateShapeHandler.prototype.execute=function(context){var shape=context.shape,positionOrBounds=context.position,parent=context.parent,parentIndex=context.parentIndex;if(!parent)throw new Error("parent required");if(!positionOrBounds)throw new Error("position required");return void 0!==positionOrBounds.width?(0,_minDash.assign)(shape,positionOrBounds):(0,_minDash.assign)(shape,{x:positionOrBounds.x-round(shape.width/2),y:positionOrBounds.y-round(shape.height/2)}),this._canvas.addShape(shape,parent,parentIndex),shape},CreateShapeHandler.prototype.revert=function(context){var shape=context.shape;return this._canvas.removeShape(shape),shape}},{"min-dash":594}],265:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=DeleteConnectionHandler;var _Collections=require("../../../util/Collections");function DeleteConnectionHandler(canvas,modeling){this._canvas=canvas,this._modeling=modeling}DeleteConnectionHandler.$inject=["canvas","modeling"],DeleteConnectionHandler.prototype.execute=function(context){var connection=context.connection,parent=connection.parent;return context.parent=parent,context.parentIndex=(0,_Collections.indexOf)(parent.children,connection),context.source=connection.source,context.target=connection.target,this._canvas.removeConnection(connection),connection.source=null,connection.target=null,connection},DeleteConnectionHandler.prototype.revert=function(context){var connection=context.connection,parent=context.parent,parentIndex=context.parentIndex;return connection.source=context.source,connection.target=context.target,(0,_Collections.add)(parent.children,connection,parentIndex),this._canvas.addConnection(connection,parent),connection}},{"../../../util/Collections":349}],266:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=DeleteElementsHandler;var _minDash=require("min-dash");function DeleteElementsHandler(modeling,elementRegistry){this._modeling=modeling,this._elementRegistry=elementRegistry}DeleteElementsHandler.$inject=["modeling","elementRegistry"],DeleteElementsHandler.prototype.postExecute=function(context){var modeling=this._modeling,elementRegistry=this._elementRegistry,elements=context.elements;(0,_minDash.forEach)(elements,function(element){elementRegistry.get(element.id)&&(element.waypoints?modeling.removeConnection(element):modeling.removeShape(element))})}},{"min-dash":594}],267:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=DeleteShapeHandler;var _Collections=require("../../../util/Collections"),_Removal=require("../../../util/Removal");function DeleteShapeHandler(canvas,modeling){this._canvas=canvas,this._modeling=modeling}DeleteShapeHandler.$inject=["canvas","modeling"],DeleteShapeHandler.prototype.preExecute=function(context){var modeling=this._modeling,shape=context.shape;(0,_Removal.saveClear)(shape.incoming,function(connection){modeling.removeConnection(connection,{nested:!0})}),(0,_Removal.saveClear)(shape.outgoing,function(connection){modeling.removeConnection(connection,{nested:!0})}),(0,_Removal.saveClear)(shape.children,function(child){child.waypoints?modeling.removeConnection(child,{nested:!0}):modeling.removeShape(child,{nested:!0})})},DeleteShapeHandler.prototype.execute=function(context){var canvas=this._canvas,shape=context.shape,oldParent=shape.parent;return context.oldParent=oldParent,context.oldParentIndex=(0,_Collections.indexOf)(oldParent.children,shape),canvas.removeShape(shape),shape},DeleteShapeHandler.prototype.revert=function(context){var canvas=this._canvas,shape=context.shape,oldParent=context.oldParent,oldParentIndex=context.oldParentIndex;return(0,_Collections.add)(oldParent.children,shape,oldParentIndex),canvas.addShape(shape,oldParent),shape}},{"../../../util/Collections":349,"../../../util/Removal":362}],268:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=DistributeElements;var _minDash=require("min-dash");function DistributeElements(modeling){this._modeling=modeling}DistributeElements.$inject=["modeling"];var OFF_AXIS={x:"y",y:"x"};DistributeElements.prototype.preExecute=function(context){var modeling=this._modeling,groups=context.groups,axis=context.axis,dimension=context.dimension;function updateRange(group,element){group.range.min=Math.min(element[axis],group.range.min),group.range.max=Math.max(element[axis]+element[dimension],group.range.max)}function center(element){return element[axis]+element[dimension]/2}function lastIdx(arr){return arr.length-1}function rangeDiff(range){return range.max-range.min}var margin,spaceInBetween,firstGroup=groups[0],lastGroupIdx=lastIdx(groups),lastGroup=groups[lastGroupIdx],groupsSize=0;(0,_minDash.forEach)(groups,function(group,idx){var sortedElements,refElem,refCenter;group.elements.length<2?idx&&idx!==groups.length-1&&(updateRange(group,group.elements[0]),groupsSize+=rangeDiff(group.range)):(refElem=(sortedElements=(0,_minDash.sortBy)(group.elements,axis))[0],idx===lastGroupIdx&&(refElem=sortedElements[lastIdx(sortedElements)]),refCenter=center(refElem),(group.range=null,_minDash.forEach)(sortedElements,function(element){!function(refCenter,element){var delta={y:0};delta[axis]=refCenter-center(element),delta[axis]&&(delta[OFF_AXIS[axis]]=0,modeling.moveElements([element],delta,element.parent))}(refCenter,element),null!==group.range?updateRange(group,element):group.range={min:element[axis],max:element[axis]+element[dimension]}}),idx&&idx!==groups.length-1&&(groupsSize+=rangeDiff(group.range)))}),spaceInBetween=Math.abs(lastGroup.range.min-firstGroup.range.max),(margin=Math.round((spaceInBetween-groupsSize)/(groups.length-1)))<groups.length-1||(0,_minDash.forEach)(groups,function(group,groupIdx){var prevGroup,delta={};group!==firstGroup&&group!==lastGroup&&(prevGroup=groups[groupIdx-1],(group.range.max=0,_minDash.forEach)(group.elements,function(element,idx){delta[OFF_AXIS[axis]]=0,delta[axis]=prevGroup.range.max-element[axis]+margin,group.range.min!==element[axis]&&(delta[axis]+=element[axis]-group.range.min),delta[axis]&&modeling.moveElements([element],delta,element.parent),group.range.max=Math.max(element[axis]+element[dimension],idx?group.range.max:0)}))})},DistributeElements.prototype.postExecute=function(context){}},{"min-dash":594}],269:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=LayoutConnectionHandler;var _minDash=require("min-dash");function LayoutConnectionHandler(layouter,canvas){this._layouter=layouter,this._canvas=canvas}LayoutConnectionHandler.$inject=["layouter","canvas"],LayoutConnectionHandler.prototype.execute=function(context){var connection=context.connection,oldWaypoints=connection.waypoints;return(0,_minDash.assign)(context,{oldWaypoints:oldWaypoints}),connection.waypoints=this._layouter.layoutConnection(connection,context.hints),connection},LayoutConnectionHandler.prototype.revert=function(context){var connection=context.connection;return connection.waypoints=context.oldWaypoints,connection}},{"min-dash":594}],270:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=MoveConnectionHandler;var _minDash=require("min-dash"),_Collections=require("../../../util/Collections");function MoveConnectionHandler(){}MoveConnectionHandler.prototype.execute=function(context){var connection=context.connection,delta=context.delta,newParent=context.newParent||connection.parent,newParentIndex=context.newParentIndex,oldParent=connection.parent;return context.oldParent=oldParent,context.oldParentIndex=(0,_Collections.remove)(oldParent.children,connection),(0,_Collections.add)(newParent.children,connection,newParentIndex),connection.parent=newParent,(0,_minDash.forEach)(connection.waypoints,function(p){p.x+=delta.x,p.y+=delta.y,p.original&&(p.original.x+=delta.x,p.original.y+=delta.y)}),connection},MoveConnectionHandler.prototype.revert=function(context){var connection=context.connection,newParent=connection.parent,oldParent=context.oldParent,oldParentIndex=context.oldParentIndex,delta=context.delta;return(0,_Collections.remove)(newParent.children,connection),(0,_Collections.add)(oldParent.children,connection,oldParentIndex),connection.parent=oldParent,(0,_minDash.forEach)(connection.waypoints,function(p){p.x-=delta.x,p.y-=delta.y,p.original&&(p.original.x-=delta.x,p.original.y-=delta.y)}),connection}},{"../../../util/Collections":349,"min-dash":594}],271:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=MoveElementsHandler;var obj,_MoveHelper=require("./helper/MoveHelper"),_MoveHelper2=(obj=_MoveHelper)&&obj.__esModule?obj:{default:obj};function MoveElementsHandler(modeling){this._helper=new _MoveHelper2.default(modeling)}MoveElementsHandler.$inject=["modeling"],MoveElementsHandler.prototype.preExecute=function(context){context.closure=this._helper.getClosure(context.shapes)},MoveElementsHandler.prototype.postExecute=function(context){var primaryShape,hints=context.hints;hints&&hints.primaryShape&&(primaryShape=hints.primaryShape,hints.oldParent=primaryShape.parent),this._helper.moveClosure(context.closure,context.delta,context.newParent,context.newHost,primaryShape)}},{"./helper/MoveHelper":282}],272:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=MoveShapeHandler;var obj,_minDash=require("min-dash"),_MoveHelper=require("./helper/MoveHelper"),_MoveHelper2=(obj=_MoveHelper)&&obj.__esModule?obj:{default:obj},_Collections=require("../../../util/Collections"),_AnchorsHelper=require("./helper/AnchorsHelper");function MoveShapeHandler(modeling){this._modeling=modeling,this._helper=new _MoveHelper2.default(modeling)}MoveShapeHandler.$inject=["modeling"],MoveShapeHandler.prototype.execute=function(context){var shape=context.shape,delta=context.delta,newParent=context.newParent||shape.parent,newParentIndex=context.newParentIndex,oldParent=shape.parent;return context.oldBounds=(0,_minDash.pick)(shape,["x","y","width","height"]),context.oldParent=oldParent,context.oldParentIndex=(0,_Collections.remove)(oldParent.children,shape),(0,_Collections.add)(newParent.children,shape,newParentIndex),(0,_minDash.assign)(shape,{parent:newParent,x:shape.x+delta.x,y:shape.y+delta.y}),shape},MoveShapeHandler.prototype.postExecute=function(context){var shape=context.shape,delta=context.delta,hints=context.hints,modeling=this._modeling;!1!==hints.layout&&((0,_minDash.forEach)(shape.incoming,function(c){modeling.layoutConnection(c,{connectionEnd:(0,_AnchorsHelper.getMovedTargetAnchor)(c,shape,delta)})}),(0,_minDash.forEach)(shape.outgoing,function(c){modeling.layoutConnection(c,{connectionStart:(0,_AnchorsHelper.getMovedSourceAnchor)(c,shape,delta)})})),!1!==hints.recurse&&this.moveChildren(context)},MoveShapeHandler.prototype.revert=function(context){var shape=context.shape,oldParent=context.oldParent,oldParentIndex=context.oldParentIndex,delta=context.delta;return(0,_Collections.add)(oldParent.children,shape,oldParentIndex),(0,_minDash.assign)(shape,{parent:oldParent,x:shape.x-delta.x,y:shape.y-delta.y}),shape},MoveShapeHandler.prototype.moveChildren=function(context){var delta=context.delta,shape=context.shape;this._helper.moveRecursive(shape.children,delta,null)},MoveShapeHandler.prototype.getNewParent=function(context){return context.newParent||context.shape.parent}},{"../../../util/Collections":349,"./helper/AnchorsHelper":280,"./helper/MoveHelper":282,"min-dash":594}],273:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ReconnectConnectionHandler;var _minDash=require("min-dash");function ReconnectConnectionHandler(modeling){this._modeling=modeling}function getDocking(point){return point.original||point}ReconnectConnectionHandler.$inject=["modeling"],ReconnectConnectionHandler.prototype.execute=function(context){var newSource=context.newSource,newTarget=context.newTarget,connection=context.connection,dockingOrPoints=context.dockingOrPoints;if(!newSource&&!newTarget)throw new Error("newSource or newTarget required");return(0,_minDash.isArray)(dockingOrPoints)&&(context.oldWaypoints=connection.waypoints,connection.waypoints=dockingOrPoints),newSource&&(context.oldSource=connection.source,connection.source=newSource),newTarget&&(context.oldTarget=connection.target,connection.target=newTarget),connection},ReconnectConnectionHandler.prototype.postExecute=function(context){var connection=context.connection,newSource=context.newSource,newTarget=context.newTarget,dockingOrPoints=context.dockingOrPoints,hints=context.hints||{},layoutConnectionHints={};hints.connectionStart&&(layoutConnectionHints.connectionStart=hints.connectionStart),hints.connectionEnd&&(layoutConnectionHints.connectionEnd=hints.connectionEnd),!1!==hints.layoutConnection&&(!newSource||newTarget&&"source"!==hints.docking||(layoutConnectionHints.connectionStart=layoutConnectionHints.connectionStart||getDocking((0,_minDash.isArray)(dockingOrPoints)?dockingOrPoints[0]:dockingOrPoints)),!newTarget||newSource&&"target"!==hints.docking||(layoutConnectionHints.connectionEnd=layoutConnectionHints.connectionEnd||getDocking((0,_minDash.isArray)(dockingOrPoints)?dockingOrPoints[dockingOrPoints.length-1]:dockingOrPoints)),hints.newWaypoints&&(layoutConnectionHints.waypoints=hints.newWaypoints),this._modeling.layoutConnection(connection,layoutConnectionHints))},ReconnectConnectionHandler.prototype.revert=function(context){var oldSource=context.oldSource,oldTarget=context.oldTarget,oldWaypoints=context.oldWaypoints,connection=context.connection;return oldSource&&(connection.source=oldSource),oldTarget&&(connection.target=oldTarget),oldWaypoints&&(connection.waypoints=oldWaypoints),connection}},{"min-dash":594}],274:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ReplaceShapeHandler;var _minDash=require("min-dash"),_AnchorsHelper=require("./helper/AnchorsHelper");function ReplaceShapeHandler(modeling,rules){this._modeling=modeling,this._rules=rules}ReplaceShapeHandler.$inject=["modeling","rules"],ReplaceShapeHandler.prototype.preExecute=function(context){var self=this,modeling=this._modeling,rules=this._rules,oldShape=context.oldShape,newData=context.newData,hints=context.hints||{};function canReconnect(source,target,connection){return rules.allowed("connection.reconnect",{connection:connection,source:source,target:target})}var children,position={x:newData.x,y:newData.y},oldBounds={x:oldShape.x,y:oldShape.y,width:oldShape.width,height:oldShape.height},newShape=context.newShape=context.newShape||self.createShape(newData,position,oldShape.parent,hints);oldShape.host&&modeling.updateAttachment(newShape,oldShape.host),!1!==hints.moveChildren&&(children=oldShape.children.slice(),modeling.moveElements(children,{x:0,y:0},newShape,hints));var incoming=oldShape.incoming.slice(),outgoing=oldShape.outgoing.slice();(0,_minDash.forEach)(incoming,function(connection){canReconnect(connection.source,newShape,connection)&&self.reconnectEnd(connection,newShape,(0,_AnchorsHelper.getResizedTargetAnchor)(connection,newShape,oldBounds),hints)}),(0,_minDash.forEach)(outgoing,function(connection){var target=connection.target;canReconnect(newShape,target,connection)&&self.reconnectStart(connection,newShape,(0,_AnchorsHelper.getResizedSourceAnchor)(connection,newShape,oldBounds),hints)})},ReplaceShapeHandler.prototype.postExecute=function(context){var oldShape=context.oldShape;this._modeling.removeShape(oldShape)},ReplaceShapeHandler.prototype.execute=function(context){},ReplaceShapeHandler.prototype.revert=function(context){},ReplaceShapeHandler.prototype.createShape=function(shape,position,target,hints){return this._modeling.createShape(shape,position,target,hints)},ReplaceShapeHandler.prototype.reconnectStart=function(connection,newSource,dockingPoint,hints){this._modeling.reconnectStart(connection,newSource,dockingPoint,hints)},ReplaceShapeHandler.prototype.reconnectEnd=function(connection,newTarget,dockingPoint,hints){this._modeling.reconnectEnd(connection,newTarget,dockingPoint,hints)}},{"./helper/AnchorsHelper":280,"min-dash":594}],275:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ResizeShapeHandler;var _minDash=require("min-dash"),_AnchorsHelper=require("./helper/AnchorsHelper");function ResizeShapeHandler(modeling){this._modeling=modeling}ResizeShapeHandler.$inject=["modeling"],ResizeShapeHandler.prototype.execute=function(context){var shape=context.shape,newBounds=context.newBounds,minBounds=context.minBounds;if(void 0===newBounds.x||void 0===newBounds.y||void 0===newBounds.width||void 0===newBounds.height)throw new Error("newBounds must have {x, y, width, height} properties");if(minBounds&&(newBounds.width<minBounds.width||newBounds.height<minBounds.height))throw new Error("width and height cannot be less than minimum height and width");if(!minBounds&&newBounds.width<10||newBounds.height<10)throw new Error("width and height cannot be less than 10px");return context.oldBounds={width:shape.width,height:shape.height,x:shape.x,y:shape.y},(0,_minDash.assign)(shape,{width:newBounds.width,height:newBounds.height,x:newBounds.x,y:newBounds.y}),shape},ResizeShapeHandler.prototype.postExecute=function(context){var modeling=this._modeling,shape=context.shape,oldBounds=context.oldBounds;!1!==(context.hints||{}).layout&&((0,_minDash.forEach)(shape.incoming,function(c){modeling.layoutConnection(c,{connectionEnd:(0,_AnchorsHelper.getResizedTargetAnchor)(c,shape,oldBounds)})}),(0,_minDash.forEach)(shape.outgoing,function(c){modeling.layoutConnection(c,{connectionStart:(0,_AnchorsHelper.getResizedSourceAnchor)(c,shape,oldBounds)})}))},ResizeShapeHandler.prototype.revert=function(context){var shape=context.shape,oldBounds=context.oldBounds;return(0,_minDash.assign)(shape,{width:oldBounds.width,height:oldBounds.height,x:oldBounds.x,y:oldBounds.y}),shape}},{"./helper/AnchorsHelper":280,"min-dash":594}],276:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=SpaceToolHandler;var _minDash=require("min-dash"),_SpaceUtil=require("../../space-tool/SpaceUtil"),_AnchorsHelper=require("./helper/AnchorsHelper");function SpaceToolHandler(modeling){this._modeling=modeling}function copyWaypoint(waypoint){return(0,_minDash.assign)({},waypoint)}function getAxisFromDirection(direction){switch(direction){case"n":return"y";case"w":return"x";case"s":return"y";case"e":return"x"}}function shouldMoveWaypoint(waypoint,start,direction){var relevantAxis=getAxisFromDirection(direction);return/e|s/.test(direction)?waypoint[relevantAxis]>start:/n|w/.test(direction)&&waypoint[relevantAxis]<start}function includes(array,item){return-1!==array.indexOf(item)}SpaceToolHandler.$inject=["modeling"],SpaceToolHandler.prototype.preExecute=function(context){var delta=context.delta,direction=context.direction,movingShapes=context.movingShapes,resizingShapes=context.resizingShapes,start=context.start,oldBounds={};this.moveShapes(movingShapes,delta),(0,_minDash.forEach)(resizingShapes,function(shape){oldBounds[shape.id]=function(shape){return{x:shape.x,y:shape.y,height:shape.height,width:shape.width}}(shape)}),this.resizeShapes(resizingShapes,delta,direction),this.updateConnectionWaypoints((0,_SpaceUtil.getWaypointsUpdatingConnections)(movingShapes,resizingShapes),delta,direction,start,movingShapes,resizingShapes,oldBounds)},SpaceToolHandler.prototype.execute=function(){},SpaceToolHandler.prototype.revert=function(){},SpaceToolHandler.prototype.moveShapes=function(shapes,delta){var self=this;(0,_minDash.forEach)(shapes,function(element){self._modeling.moveShape(element,delta,null,{autoResize:!1,layout:!1,recurse:!1})})},SpaceToolHandler.prototype.resizeShapes=function(shapes,delta,direction){var self=this;(0,_minDash.forEach)(shapes,function(shape){var newBounds=(0,_SpaceUtil.resizeBounds)(shape,direction,delta);self._modeling.resizeShape(shape,newBounds,null,{attachSupport:!1,autoResize:!1,layout:!1})})},SpaceToolHandler.prototype.updateConnectionWaypoints=function(connections,delta,direction,start,movingShapes,resizingShapes,oldBounds){var self=this,affectedShapes=movingShapes.concat(resizingShapes);(0,_minDash.forEach)(connections,function(connection){var source=connection.source,target=connection.target,waypoints=function(connection){return(0,_minDash.map)(connection.waypoints,function(waypoint){return(waypoint=copyWaypoint(waypoint)).original&&(waypoint.original=copyWaypoint(waypoint.original)),waypoint})}(connection),axis=getAxisFromDirection(direction),layoutHints={labelBehavior:!1};includes(affectedShapes,source)&&includes(affectedShapes,target)?(waypoints=(0,_minDash.map)(waypoints,function(waypoint){return shouldMoveWaypoint(waypoint,start,direction)&&(waypoint[axis]=waypoint[axis]+delta[axis]),waypoint.original&&shouldMoveWaypoint(waypoint.original,start,direction)&&(waypoint.original[axis]=waypoint.original[axis]+delta[axis]),waypoint}),self._modeling.updateWaypoints(connection,waypoints,{labelBehavior:!1})):(includes(affectedShapes,source)||includes(affectedShapes,target))&&(includes(movingShapes,source)?layoutHints.connectionStart=(0,_AnchorsHelper.getMovedSourceAnchor)(connection,source,delta):includes(movingShapes,target)?layoutHints.connectionEnd=(0,_AnchorsHelper.getMovedTargetAnchor)(connection,target,delta):includes(resizingShapes,source)?layoutHints.connectionStart=(0,_AnchorsHelper.getResizedSourceAnchor)(connection,source,oldBounds[source.id]):includes(resizingShapes,target)&&(layoutHints.connectionEnd=(0,_AnchorsHelper.getResizedTargetAnchor)(connection,target,oldBounds[target.id])),self._modeling.layoutConnection(connection,layoutHints))})}},{"../../space-tool/SpaceUtil":323,"./helper/AnchorsHelper":280,"min-dash":594}],277:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ToggleShapeCollapseHandler;var _minDash=require("min-dash");function ToggleShapeCollapseHandler(modeling){this._modeling=modeling}ToggleShapeCollapseHandler.$inject=["modeling"],ToggleShapeCollapseHandler.prototype.execute=function(context){var shape=context.shape,children=shape.children;context.oldChildrenVisibility=function getElementsVisibilityRecursive(elements){var result={};(0,_minDash.forEach)(elements,function(element){result[element.id]=element.hidden,element.children&&(result=(0,_minDash.assign)({},result,getElementsVisibilityRecursive(element.children)))});return result}(children),shape.collapsed=!shape.collapsed;var result=function setHiddenRecursive(elements,newHidden){var result=[];(0,_minDash.forEach)(elements,function(element){element.hidden=newHidden,result=result.concat(element),element.children&&(result=result.concat(setHiddenRecursive(element.children,element.collapsed||newHidden)))});return result}(children,shape.collapsed);return[shape].concat(result)},ToggleShapeCollapseHandler.prototype.revert=function(context){var shape=context.shape,oldChildrenVisibility=context.oldChildrenVisibility,result=function restoreVisibilityRecursive(elements,lastState){var result=[];(0,_minDash.forEach)(elements,function(element){element.hidden=lastState[element.id],result=result.concat(element),element.children&&(result=result.concat(restoreVisibilityRecursive(element.children,lastState)))});return result}(shape.children,oldChildrenVisibility);return shape.collapsed=!shape.collapsed,[shape].concat(result)}},{"min-dash":594}],278:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=UpdateAttachmentHandler;var _Collections=require("../../../util/Collections");function UpdateAttachmentHandler(modeling){this._modeling=modeling}function removeAttacher(host,attacher){return(0,_Collections.remove)(host&&host.attachers,attacher)}function addAttacher(host,attacher,idx){var attachers;host&&((attachers=host.attachers)||(host.attachers=attachers=[]),(0,_Collections.add)(attachers,attacher,idx))}UpdateAttachmentHandler.$inject=["modeling"],UpdateAttachmentHandler.prototype.execute=function(context){var shape=context.shape,newHost=context.newHost,oldHost=shape.host;return context.oldHost=oldHost,context.attacherIdx=removeAttacher(oldHost,shape),addAttacher(newHost,shape),shape.host=newHost,shape},UpdateAttachmentHandler.prototype.revert=function(context){var shape=context.shape,newHost=context.newHost,oldHost=context.oldHost,attacherIdx=context.attacherIdx;return shape.host=oldHost,removeAttacher(newHost,shape),addAttacher(oldHost,shape,attacherIdx),shape}},{"../../../util/Collections":349}],279:[function(require,module,exports){"use strict";function UpdateWaypointsHandler(){}Object.defineProperty(exports,"__esModule",{value:!0}),(exports.default=UpdateWaypointsHandler).prototype.execute=function(context){var connection=context.connection,newWaypoints=context.newWaypoints;return context.oldWaypoints=connection.waypoints,connection.waypoints=newWaypoints,connection},UpdateWaypointsHandler.prototype.revert=function(context){var connection=context.connection,oldWaypoints=context.oldWaypoints;return connection.waypoints=oldWaypoints,connection}},{}],280:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getResizedSourceAnchor=function(connection,shape,oldBounds){var waypoints=safeGetWaypoints(connection),waypointsInsideNewBounds=getWaypointsInsideBounds(waypoints,shape),oldAnchor=waypoints[0];if(waypointsInsideNewBounds.length)return waypointsInsideNewBounds[waypointsInsideNewBounds.length-1];return(0,_AttachUtil.getNewAttachPoint)(oldAnchor.original||oldAnchor,oldBounds,shape)},exports.getResizedTargetAnchor=function(connection,shape,oldBounds){var waypoints=safeGetWaypoints(connection),waypointsInsideNewBounds=getWaypointsInsideBounds(waypoints,shape),oldAnchor=waypoints[waypoints.length-1];if(waypointsInsideNewBounds.length)return waypointsInsideNewBounds[0];return(0,_AttachUtil.getNewAttachPoint)(oldAnchor.original||oldAnchor,oldBounds,shape)},exports.getMovedSourceAnchor=function(connection,source,moveDelta){var waypoints=safeGetWaypoints(connection),oldBounds=subtract(source,moveDelta),oldAnchor=waypoints[0];return(0,_AttachUtil.getNewAttachPoint)(oldAnchor.original||oldAnchor,oldBounds,source)},exports.getMovedTargetAnchor=function(connection,target,moveDelta){var waypoints=safeGetWaypoints(connection),oldBounds=subtract(target,moveDelta),oldAnchor=waypoints[waypoints.length-1];return(0,_AttachUtil.getNewAttachPoint)(oldAnchor.original||oldAnchor,oldBounds,target)};var _AttachUtil=require("../../../../util/AttachUtil"),_LayoutUtil=require("../../../../layout/LayoutUtil"),_minDash=require("min-dash");function subtract(bounds,delta){return{x:bounds.x-delta.x,y:bounds.y-delta.y,width:bounds.width,height:bounds.height}}function safeGetWaypoints(connection){var waypoints=connection.waypoints;if(!waypoints.length)throw new Error("connection#"+connection.id+": no waypoints");return waypoints}function getWaypointsInsideBounds(waypoints,bounds){var originalWaypoints=(0,_minDash.map)(waypoints,getOriginal);return(0,_minDash.filter)(originalWaypoints,function(waypoint){return function(point,bounds){return"intersect"===(0,_LayoutUtil.getOrientation)(bounds,point,1)}(waypoint,bounds)})}function getOriginal(point){return point.original||point}},{"../../../../layout/LayoutUtil":336,"../../../../util/AttachUtil":347,"min-dash":594}],281:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=MoveClosure;var _minDash=require("min-dash"),_Elements=require("../../../../util/Elements");function MoveClosure(){this.allShapes={},this.allConnections={},this.enclosedElements={},this.enclosedConnections={},this.topLevel={}}MoveClosure.prototype.add=function(element,isTopLevel){return this.addAll([element],isTopLevel)},MoveClosure.prototype.addAll=function(elements,isTopLevel){var newClosure=(0,_Elements.getClosure)(elements,!!isTopLevel,this);return(0,_minDash.assign)(this,newClosure),this}},{"../../../../util/Elements":351,"min-dash":594}],282:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=MoveHelper;var obj,_minDash=require("min-dash"),_AnchorsHelper=require("./AnchorsHelper"),_MoveClosure=require("./MoveClosure"),_MoveClosure2=(obj=_MoveClosure)&&obj.__esModule?obj:{default:obj};function MoveHelper(modeling){this._modeling=modeling}MoveHelper.prototype.moveRecursive=function(elements,delta,newParent){return elements?this.moveClosure(this.getClosure(elements),delta,newParent):[]},MoveHelper.prototype.moveClosure=function(closure,delta,newParent,newHost,primaryShape){var modeling=this._modeling,allShapes=closure.allShapes,allConnections=closure.allConnections,enclosedConnections=closure.enclosedConnections,topLevel=closure.topLevel,keepParent=!1;primaryShape&&primaryShape.parent===newParent&&(keepParent=!0),(0,_minDash.forEach)(allShapes,function(shape){modeling.moveShape(shape,delta,topLevel[shape.id]&&!keepParent&&newParent,{recurse:!1,layout:!1})}),(0,_minDash.forEach)(allConnections,function(c){var sourceMoved=!!allShapes[c.source.id],targetMoved=!!allShapes[c.target.id];enclosedConnections[c.id]&&sourceMoved&&targetMoved?modeling.moveConnection(c,delta,topLevel[c.id]&&!keepParent&&newParent):modeling.layoutConnection(c,{connectionStart:sourceMoved&&(0,_AnchorsHelper.getMovedSourceAnchor)(c,c.source,delta),connectionEnd:targetMoved&&(0,_AnchorsHelper.getMovedTargetAnchor)(c,c.target,delta)})})},MoveHelper.prototype.getClosure=function(elements){return(new _MoveClosure2.default).addAll(elements,!0)}},{"./AnchorsHelper":280,"./MoveClosure":281,"min-dash":594}],283:[function(require,module,exports){"use strict";function Mouse(eventBus){var self=this;function setLastMoveEvent(mousemoveEvent){self._lastMoveEvent=mousemoveEvent}this._lastMoveEvent=null,eventBus.on("canvas.init",function(context){(self._svg=context.svg).addEventListener("mousemove",setLastMoveEvent)}),eventBus.on("canvas.destroy",function(){self._lastMouseEvent=null,self._svg.removeEventListener("mousemove",setLastMoveEvent)})}function createMoveEvent(x,y){var event=document.createEvent("MouseEvent");return event.initMouseEvent&&event.initMouseEvent("mousemove",!0,!0,window,0,x,y,x,y,!1,!1,!1,!1,0,null),event}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=Mouse,exports.createMoveEvent=createMoveEvent,Mouse.$inject=["eventBus"],Mouse.prototype.getLastMoveEvent=function(){return this._lastMoveEvent||createMoveEvent(0,0)}},{}],284:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_Mouse=require("./Mouse"),_Mouse2=(obj=_Mouse)&&obj.__esModule?obj:{default:obj};exports.default={__init__:["mouse"],mouse:["type",_Mouse2.default]}},{"./Mouse":283}],285:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=MoveEvents;var _minDash=require("min-dash"),_Event=require("../../util/Event"),LOW_PRIORITY=500,MEDIUM_PRIORITY=1250,HIGH_PRIORITY=1500,round=Math.round;function MoveEvents(eventBus,dragging,modeling,selection,rules){function canMove(shapes,delta,position,target){return rules.allowed("elements.move",{shapes:shapes,delta:delta,position:position,target:target})}function start(event,element,activate,context){if((0,_minDash.isObject)(activate)&&(context=activate,activate=!1),!element.waypoints&&element.parent){var referencePoint=function(element){return{x:element.x+round(element.width/2),y:element.y+round(element.height/2)}}(element);return dragging.init(event,referencePoint,"shape.move",{cursor:"grabbing",autoActivate:activate,data:{shape:element,context:context||{}}}),!0}}eventBus.on("shape.move.start",HIGH_PRIORITY,function(event){var elements,ids,context=event.context,shape=event.shape,shapes=selection.get().slice();-1===shapes.indexOf(shape)&&(shapes=[shape]),elements=shapes,ids=(0,_minDash.groupBy)(elements,"id"),shapes=(0,_minDash.filter)(elements,function(element){for(;element=element.parent;)if(ids[element.id])return!1;return!0}),(0,_minDash.assign)(context,{shapes:shapes,validatedShapes:shapes,shape:shape})}),eventBus.on("shape.move.start",MEDIUM_PRIORITY,function(event){var context=event.context,validatedShapes=context.validatedShapes;if(!(context.canExecute=canMove(validatedShapes)))return!1}),eventBus.on("shape.move.move",LOW_PRIORITY,function(event){var context=event.context,validatedShapes=context.validatedShapes,hover=event.hover,delta={x:event.dx,y:event.dy},canExecute=canMove(validatedShapes,delta,{x:event.x,y:event.y},hover);context.delta=delta,null!==(context.canExecute=canExecute)?context.target=hover:context.target=null}),eventBus.on("shape.move.end",function(event){var context=event.context,delta=context.delta,canExecute=context.canExecute,isAttach="attach"===canExecute,shapes=context.shapes;if(!1===canExecute)return!1;delta.x=round(delta.x),delta.y=round(delta.y),0===delta.x&&0===delta.y||modeling.moveElements(shapes,delta,context.target,{primaryShape:context.shape,attach:isAttach})}),eventBus.on("element.mousedown",function(event){var originalEvent=(0,_Event.getOriginal)(event);if(!originalEvent)throw new Error("must supply DOM mousedown event");return start(originalEvent,event.element)}),this.start=start}MoveEvents.$inject=["eventBus","dragging","modeling","selection","rules"]},{"../../util/Event":353,"min-dash":594}],286:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=MovePreview;var _minDash=require("min-dash"),_Elements=require("../../util/Elements"),_tinySvg=require("tiny-svg"),_SvgTransformUtil=require("../../util/SvgTransformUtil"),LOW_PRIORITY=499,MARKER_DRAGGING="djs-dragging",MARKER_OK="drop-ok",MARKER_NOT_OK="drop-not-ok",MARKER_NEW_PARENT="new-parent",MARKER_ATTACH="attach-ok";function MovePreview(eventBus,canvas,styles,previewSupport){function getVisualDragShapes(shapes){return function(elements){return(0,_minDash.filter)(elements,function(element){return!element.waypoints||(0,_minDash.find)(elements,(0,_minDash.matchPattern)({id:element.source.id}))&&(0,_minDash.find)(elements,(0,_minDash.matchPattern)({id:element.target.id}))})}(getAllDraggedElements(shapes))}function getAllDraggedElements(shapes){var allShapes=(0,_Elements.selfAndAllChildren)(shapes,!0),allConnections=(0,_minDash.map)(allShapes,function(shape){return(shape.incoming||[]).concat(shape.outgoing||[])});return(0,_minDash.flatten)(allShapes.concat(allConnections))}function setMarker(element,marker){[MARKER_ATTACH,MARKER_OK,MARKER_NOT_OK,MARKER_NEW_PARENT].forEach(function(m){m===marker?canvas.addMarker(element,m):canvas.removeMarker(element,m)})}eventBus.on("shape.move.start",LOW_PRIORITY,function(event){var dragGroup,defaultLayer,elements,context=event.context,dragShapes=context.shapes,allDraggedElements=context.allDraggedElements,visuallyDraggedShapes=getVisualDragShapes(dragShapes);context.dragGroup||(dragGroup=(0,_tinySvg.create)("g"),(0,_tinySvg.attr)(dragGroup,styles.cls("djs-drag-group",["no-events"])),defaultLayer=canvas.getDefaultLayer(),(0,_tinySvg.append)(defaultLayer,dragGroup),context.dragGroup=dragGroup),visuallyDraggedShapes.forEach(function(shape){previewSupport.addDragger(shape,context.dragGroup)}),allDraggedElements=allDraggedElements?(0,_minDash.flatten)([allDraggedElements,getAllDraggedElements(dragShapes)]):getAllDraggedElements(dragShapes),(0,_minDash.forEach)(allDraggedElements,function(e){canvas.addMarker(e,MARKER_DRAGGING)}),context.allDraggedElements=allDraggedElements,context.differentParents=(elements=dragShapes,1!==(0,_minDash.size)((0,_minDash.groupBy)(elements,function(e){return e.parent&&e.parent.id})))}),eventBus.on("shape.move.move",LOW_PRIORITY,function(event){var context=event.context,dragGroup=context.dragGroup,target=context.target,parent=context.shape.parent,canExecute=context.canExecute;target&&("attach"===canExecute?setMarker(target,MARKER_ATTACH):context.canExecute&&target&&target.id!==parent.id?setMarker(target,MARKER_NEW_PARENT):setMarker(target,context.canExecute?MARKER_OK:MARKER_NOT_OK)),(0,_SvgTransformUtil.translate)(dragGroup,event.dx,event.dy)}),eventBus.on(["shape.move.out","shape.move.cleanup"],function(event){var target=event.context.target;target&&setMarker(target,null)}),eventBus.on("shape.move.cleanup",function(event){var context=event.context,allDraggedElements=context.allDraggedElements,dragGroup=context.dragGroup;(0,_minDash.forEach)(allDraggedElements,function(e){canvas.removeMarker(e,MARKER_DRAGGING)}),dragGroup&&(0,_tinySvg.remove)(dragGroup)}),this.makeDraggable=function(context,element,addMarker){previewSupport.addDragger(element,context.dragGroup),addMarker&&canvas.addMarker(element,MARKER_DRAGGING),context.allDraggedElements?context.allDraggedElements.push(element):context.allDraggedElements=[element]}}MovePreview.$inject=["eventBus","canvas","styles","previewSupport"]},{"../../util/Elements":351,"../../util/SvgTransformUtil":364,"min-dash":594,"tiny-svg":606}],287:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _interactionEvents2=_interopRequireDefault(require("../interaction-events")),_selection2=_interopRequireDefault(require("../selection")),_outline2=_interopRequireDefault(require("../outline")),_rules2=_interopRequireDefault(require("../rules")),_dragging2=_interopRequireDefault(require("../dragging")),_previewSupport2=_interopRequireDefault(require("../preview-support")),_Move2=_interopRequireDefault(require("./Move")),_MovePreview2=_interopRequireDefault(require("./MovePreview"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_interactionEvents2.default,_selection2.default,_outline2.default,_rules2.default,_dragging2.default,_previewSupport2.default],__init__:["move","movePreview"],move:["type",_Move2.default],movePreview:["type",_MovePreview2.default]}},{"../dragging":233,"../interaction-events":247,"../outline":290,"../preview-support":298,"../rules":308,"../selection":314,"./Move":285,"./MovePreview":286}],288:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=OrderingProvider;var _inherits2=_interopRequireDefault(require("inherits")),_CommandInterceptor2=_interopRequireDefault(require("../../command/CommandInterceptor"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function OrderingProvider(eventBus){_CommandInterceptor2.default.call(this,eventBus);var self=this;this.preExecute(["shape.create","connection.create"],function(event){var context=event.context,element=context.shape||context.connection,parent=context.parent,ordering=self.getOrdering(element,parent);ordering&&(void 0!==ordering.parent&&(context.parent=ordering.parent),context.parentIndex=ordering.index)}),this.preExecute(["shape.move","connection.move"],function(event){var context=event.context,element=context.shape||context.connection,parent=context.newParent||element.parent,ordering=self.getOrdering(element,parent);ordering&&(void 0!==ordering.parent&&(context.newParent=ordering.parent),context.newParentIndex=ordering.index)})}OrderingProvider.prototype.getOrdering=function(element,newParent){return null},(0,_inherits2.default)(OrderingProvider,_CommandInterceptor2.default)},{"../../command/CommandInterceptor":181,inherits:385}],289:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=Outline;var _Elements=require("../../util/Elements"),_tinySvg=require("tiny-svg"),_minDom=require("min-dom"),_minDash=require("min-dash"),LOW_PRIORITY=500;function Outline(eventBus,styles,elementRegistry){this.offset=6;var OUTLINE_STYLE=styles.cls("djs-outline",["no-fill"]),self=this;function createOutline(gfx){var outline=(0,_tinySvg.create)("rect");return(0,_tinySvg.attr)(outline,(0,_minDash.assign)({x:10,y:10,width:100,height:100},OUTLINE_STYLE)),(0,_tinySvg.append)(gfx,outline),outline}eventBus.on(["shape.added","shape.changed"],LOW_PRIORITY,function(event){var element=event.element,gfx=event.gfx,outline=(outline=(0,_minDom.query)(".djs-outline",gfx))||createOutline(gfx);self.updateShapeOutline(outline,element)}),eventBus.on(["connection.added","connection.changed"],function(event){var element=event.element,gfx=event.gfx,outline=(outline=(0,_minDom.query)(".djs-outline",gfx))||createOutline(gfx);self.updateConnectionOutline(outline,element)})}Outline.prototype.updateShapeOutline=function(outline,element){(0,_tinySvg.attr)(outline,{x:-this.offset,y:-this.offset,width:element.width+2*this.offset,height:element.height+2*this.offset})},Outline.prototype.updateConnectionOutline=function(outline,connection){var bbox=(0,_Elements.getBBox)(connection);(0,_tinySvg.attr)(outline,{x:bbox.x-this.offset,y:bbox.y-this.offset,width:bbox.width+2*this.offset,height:bbox.height+2*this.offset})},Outline.$inject=["eventBus","styles","elementRegistry"]},{"../../util/Elements":351,"min-dash":594,"min-dom":595,"tiny-svg":606}],290:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_Outline=require("./Outline"),_Outline2=(obj=_Outline)&&obj.__esModule?obj:{default:obj};exports.default={__init__:["outline"],outline:["type",_Outline2.default]}},{"./Outline":289}],291:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=Overlays;var obj,_minDash=require("min-dash"),_minDom=require("min-dom"),_Elements=require("../../util/Elements"),_IdGenerator=require("../../util/IdGenerator");var ids=new((obj=_IdGenerator)&&obj.__esModule?obj:{default:obj}).default("ov");function Overlays(config,eventBus,canvas,elementRegistry){var parentNode,root;this._eventBus=eventBus,this._canvas=canvas,this._elementRegistry=elementRegistry,this._ids=ids,this._overlayDefaults=(0,_minDash.assign)({show:null,scale:!0},config&&config.defaults),this._overlays={},this._overlayContainers=[],this._overlayRoot=(parentNode=canvas.getContainer(),root=(0,_minDom.domify)('<div class="djs-overlay-container" style="position: absolute; width: 0; height: 0;" />'),parentNode.insertBefore(root,parentNode.firstChild),root),this._init()}function setPosition(el,x,y){(0,_minDash.assign)(el.style,{left:x+"px",top:y+"px"})}function setVisible(el,visible){el.style.display=!1===visible?"none":""}function setTransform(el,transform){el.style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach(function(prefix){el.style[prefix+"transform"]=transform})}Overlays.$inject=["config.overlays","eventBus","canvas","elementRegistry"],Overlays.prototype.get=function(search){if((0,_minDash.isString)(search)&&(search={id:search}),(0,_minDash.isString)(search.element)&&(search.element=this._elementRegistry.get(search.element)),search.element){var container=this._getOverlayContainer(search.element,!0);return container?search.type?(0,_minDash.filter)(container.overlays,(0,_minDash.matchPattern)({type:search.type})):container.overlays.slice():[]}return search.type?(0,_minDash.filter)(this._overlays,(0,_minDash.matchPattern)({type:search.type})):search.id?this._overlays[search.id]:null},Overlays.prototype.add=function(element,type,overlay){if((0,_minDash.isObject)(type)&&(overlay=type,type=null),element.id||(element=this._elementRegistry.get(element)),!overlay.position)throw new Error("must specifiy overlay position");if(!overlay.html)throw new Error("must specifiy overlay html");if(!element)throw new Error("invalid element specified");var id=this._ids.next();return overlay=(0,_minDash.assign)({},this._overlayDefaults,overlay,{id:id,type:type,element:element,html:overlay.html}),this._addOverlay(overlay),id},Overlays.prototype.remove=function(filter){var overlays=this.get(filter)||[];(0,_minDash.isArray)(overlays)||(overlays=[overlays]);var self=this;(0,_minDash.forEach)(overlays,function(overlay){var idx,container=self._getOverlayContainer(overlay.element,!0);overlay&&((0,_minDom.remove)(overlay.html),(0,_minDom.remove)(overlay.htmlContainer),delete overlay.htmlContainer,delete overlay.element,delete self._overlays[overlay.id]),!container||-1!==(idx=container.overlays.indexOf(overlay))&&container.overlays.splice(idx,1)})},Overlays.prototype.show=function(){setVisible(this._overlayRoot)},Overlays.prototype.hide=function(){setVisible(this._overlayRoot,!1)},Overlays.prototype.clear=function(){this._overlays={},this._overlayContainers=[],(0,_minDom.clear)(this._overlayRoot)},Overlays.prototype._updateOverlayContainer=function(container){var bbox,element=container.element,html=container.html,x=element.x,y=element.y;element.waypoints&&(x=(bbox=(0,_Elements.getBBox)(element)).x,y=bbox.y),setPosition(html,x,y),(0,_minDom.attr)(container.html,"data-container-id",element.id)},Overlays.prototype._updateOverlay=function(overlay){var width,height,position=overlay.position,htmlContainer=overlay.htmlContainer,element=overlay.element,left=position.left,top=position.top;void 0!==position.right&&(width=element.waypoints?(0,_Elements.getBBox)(element).width:element.width,left=-1*position.right+width),void 0!==position.bottom&&(height=element.waypoints?(0,_Elements.getBBox)(element).height:element.height,top=-1*position.bottom+height),setPosition(htmlContainer,left||0,top||0)},Overlays.prototype._createOverlayContainer=function(element){var html=(0,_minDom.domify)('<div class="djs-overlays" style="position: absolute" />');this._overlayRoot.appendChild(html);var container={html:html,element:element,overlays:[]};return this._updateOverlayContainer(container),this._overlayContainers.push(container),container},Overlays.prototype._updateRoot=function(viewbox){var scale=viewbox.scale||1,matrix="matrix("+[scale,0,0,scale,-1*viewbox.x*scale,-1*viewbox.y*scale].join(",")+")";setTransform(this._overlayRoot,matrix)},Overlays.prototype._getOverlayContainer=function(element,raw){var container=(0,_minDash.find)(this._overlayContainers,function(c){return c.element===element});return container||raw?container:this._createOverlayContainer(element)},Overlays.prototype._addOverlay=function(overlay){var htmlContainer,overlayContainer,id=overlay.id,element=overlay.element,html=overlay.html;html.get&&html.constructor.prototype.jquery&&(html=html.get(0)),(0,_minDash.isString)(html)&&(html=(0,_minDom.domify)(html)),overlayContainer=this._getOverlayContainer(element),(htmlContainer=(0,_minDom.domify)('<div class="djs-overlay" data-overlay-id="'+id+'" style="position: absolute">')).appendChild(html),overlay.type&&(0,_minDom.classes)(htmlContainer).add("djs-overlay-"+overlay.type),overlay.htmlContainer=htmlContainer,overlayContainer.overlays.push(overlay),overlayContainer.html.appendChild(htmlContainer),this._overlays[id]=overlay,this._updateOverlay(overlay),this._updateOverlayVisibilty(overlay,this._canvas.viewbox())},Overlays.prototype._updateOverlayVisibilty=function(overlay,viewbox){var show=overlay.show,minZoom=show&&show.minZoom,maxZoom=show&&show.maxZoom,htmlContainer=overlay.htmlContainer,visible=!0;show&&(((0,_minDash.isDefined)(minZoom)&&minZoom>viewbox.scale||(0,_minDash.isDefined)(maxZoom)&&maxZoom<viewbox.scale)&&(visible=!1),setVisible(htmlContainer,visible)),this._updateOverlayScale(overlay,viewbox)},Overlays.prototype._updateOverlayScale=function(overlay,viewbox){var minScale,maxScale,scale,shouldScale=overlay.scale,htmlContainer=overlay.htmlContainer,transform="";!0!==shouldScale&&(maxScale=!1===shouldScale?minScale=1:(minScale=shouldScale.min,shouldScale.max),(0,_minDash.isDefined)(minScale)&&viewbox.scale<minScale&&(scale=(1/viewbox.scale||1)*minScale),(0,_minDash.isDefined)(maxScale)&&viewbox.scale>maxScale&&(scale=(1/viewbox.scale||1)*maxScale)),(0,_minDash.isDefined)(scale)&&(transform="scale("+scale+","+scale+")"),setTransform(htmlContainer,transform)},Overlays.prototype._updateOverlaysVisibilty=function(viewbox){var self=this;(0,_minDash.forEach)(this._overlays,function(overlay){self._updateOverlayVisibilty(overlay,viewbox)})},Overlays.prototype._init=function(){var eventBus=this._eventBus,self=this;eventBus.on("canvas.viewbox.changing",function(event){self.hide()}),eventBus.on("canvas.viewbox.changed",function(event){var viewbox;viewbox=event.viewbox,self._updateRoot(viewbox),self._updateOverlaysVisibilty(viewbox),self.show()}),eventBus.on(["shape.remove","connection.remove"],function(e){var element=e.element,overlays=self.get({element:element});(0,_minDash.forEach)(overlays,function(o){self.remove(o.id)});var i,container=self._getOverlayContainer(element);container&&((0,_minDom.remove)(container.html),-1!==(i=self._overlayContainers.indexOf(container))&&self._overlayContainers.splice(i,1))}),eventBus.on("element.changed",500,function(e){var element=e.element,container=self._getOverlayContainer(element,!0);container&&((0,_minDash.forEach)(container.overlays,function(overlay){self._updateOverlay(overlay)}),self._updateOverlayContainer(container))}),eventBus.on("element.marker.update",function(e){var container=self._getOverlayContainer(e.element,!0);container&&(0,_minDom.classes)(container.html)[e.add?"add":"remove"](e.marker)}),eventBus.on("diagram.clear",this.clear,this)}},{"../../util/Elements":351,"../../util/IdGenerator":356,"min-dash":594,"min-dom":595}],292:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_Overlays=require("./Overlays"),_Overlays2=(obj=_Overlays)&&obj.__esModule?obj:{default:obj};exports.default={__init__:["overlays"],overlays:["type",_Overlays2.default]}},{"./Overlays":291}],293:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=Palette;var _minDash=require("min-dash"),_minDom=require("min-dom");function Palette(eventBus,canvas){this._eventBus=eventBus,this._canvas=canvas;var self=this;eventBus.on("tool-manager.update",function(event){var tool=event.tool;self.updateToolHighlight(tool)}),eventBus.on("i18n.changed",function(){self._update()}),eventBus.on("diagram.init",function(){self._diagramInitialized=!0,self._rebuild()})}function addPaletteEntries(entries,provider){var entriesOrUpdater=provider.getPaletteEntries();return(0,_minDash.isFunction)(entriesOrUpdater)?entriesOrUpdater(entries):((0,_minDash.forEach)(entriesOrUpdater,function(entry,id){entries[id]=entry}),entries)}Palette.$inject=["eventBus","canvas"],Palette.prototype.registerProvider=function(priority,provider){provider||(provider=priority,priority=1e3),this._eventBus.on("palette.getProviders",priority,function(event){event.providers.push(provider)}),this._rebuild()},Palette.prototype.getEntries=function(){return this._getProviders().reduce(addPaletteEntries,{})},Palette.prototype._rebuild=function(){this._diagramInitialized&&this._getProviders().length&&(this._container||this._init(),this._update())},Palette.prototype._init=function(){var self=this,eventBus=this._eventBus,parentContainer=this._getParentContainer(),container=this._container=(0,_minDom.domify)(Palette.HTML_MARKUP);parentContainer.appendChild(container),_minDom.delegate.bind(container,".djs-palette-toggle, .entry","click",function(event){var target=event.delegateTarget;if((0,_minDom.matches)(target,".djs-palette-toggle"))return self.toggle();self.trigger("click",event)}),_minDom.event.bind(container,"mousedown",function(event){event.stopPropagation()}),_minDom.delegate.bind(container,".entry","dragstart",function(event){self.trigger("dragstart",event)}),eventBus.on("canvas.resized",this._layoutChanged,this),eventBus.fire("palette.create",{container:container})},Palette.prototype._getProviders=function(id){var event=this._eventBus.createEvent({type:"palette.getProviders",providers:[]});return this._eventBus.fire(event),event.providers},Palette.prototype._toggleState=function(state){state=state||{};var parent=this._getParentContainer(),container=this._container,eventBus=this._eventBus,cls=(0,_minDom.classes)(container),twoColumn="twoColumn"in state?state.twoColumn:this._needsCollapse(parent.clientHeight,this._entries||{});cls.toggle("two-column",twoColumn),"open"in state&&cls.toggle("open",state.open),eventBus.fire("palette.changed",{twoColumn:twoColumn,open:this.isOpen()})},Palette.prototype._update=function(){var entriesContainer=(0,_minDom.query)(".djs-palette-entries",this._container),entries=this._entries=this.getEntries();(0,_minDom.clear)(entriesContainer),(0,_minDash.forEach)(entries,function(entry,id){var grouping=entry.group||"default",container=(0,_minDom.query)("[data-group="+grouping+"]",entriesContainer);container||(container=(0,_minDom.domify)('<div class="group" data-group="'+grouping+'"></div>'),entriesContainer.appendChild(container));var element,classNames,classes,html=entry.html||(entry.separator?'<hr class="separator" />':'<div class="entry" draggable="true"></div>'),control=(0,_minDom.domify)(html);container.appendChild(control),entry.separator||((0,_minDom.attr)(control,"data-action",id),entry.title&&(0,_minDom.attr)(control,"title",entry.title),entry.className&&(element=control,classNames=entry.className,classes=(0,_minDom.classes)(element),((0,_minDash.isArray)(classNames)?classNames:classNames.split(/\s+/g)).forEach(function(cls){classes.add(cls)})),entry.imageUrl&&control.appendChild((0,_minDom.domify)('<img src="'+entry.imageUrl+'">')))}),this.open()},Palette.prototype.trigger=function(action,event,autoActivate){var entry,handler,originalEvent,entries=this._entries,button=event.delegateTarget||event.target;if(!button)return event.preventDefault();(entry=entries[(0,_minDom.attr)(button,"data-action")])&&(handler=entry.action,originalEvent=event.originalEvent||event,(0,_minDash.isFunction)(handler)?"click"===action&&handler(originalEvent,autoActivate):handler[action]&&handler[action](originalEvent,autoActivate),event.preventDefault())},Palette.prototype._layoutChanged=function(){this._toggleState({})},Palette.prototype._needsCollapse=function(availableHeight,entries){return availableHeight<50+46*Object.keys(entries).length},Palette.prototype.close=function(){this._toggleState({open:!1,twoColumn:!1})},Palette.prototype.open=function(){this._toggleState({open:!0})},Palette.prototype.toggle=function(open){this.isOpen()?this.close():this.open()},Palette.prototype.isActiveTool=function(tool){return tool&&this._activeTool===tool},Palette.prototype.updateToolHighlight=function(name){var entriesContainer,toolsContainer;this._toolsContainer||(entriesContainer=(0,_minDom.query)(".djs-palette-entries",this._container),this._toolsContainer=(0,_minDom.query)("[data-group=tools]",entriesContainer)),toolsContainer=this._toolsContainer,(0,_minDash.forEach)(toolsContainer.children,function(tool){var toolClasses,actionName=tool.getAttribute("data-action");actionName&&(toolClasses=(0,_minDom.classes)(tool),actionName=actionName.replace("-tool",""),toolClasses.contains("entry")&&actionName===name?toolClasses.add("highlighted-entry"):toolClasses.remove("highlighted-entry"))})},Palette.prototype.isOpen=function(){return(0,_minDom.classes)(this._container).has("open")},Palette.prototype._getParentContainer=function(){return this._canvas.getContainer()},Palette.HTML_MARKUP='<div class="djs-palette"><div class="djs-palette-entries"></div><div class="djs-palette-toggle"></div></div>'},{"min-dash":594,"min-dom":595}],294:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_Palette=require("./Palette"),_Palette2=(obj=_Palette)&&obj.__esModule?obj:{default:obj};exports.default={__init__:["palette"],palette:["type",_Palette2.default]}},{"./Palette":293}],295:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=PopupMenu;var _minDash=require("min-dash"),_minDom=require("min-dom"),CLOSE_EVENTS=["contextPad.close","canvas.viewbox.changing","commandStack.changed"];function PopupMenu(config,eventBus,canvas){var scale=(0,_minDash.isDefined)(config&&config.scale)?config.scale:{min:1,max:1.5};this._config={scale:scale},this._eventBus=eventBus,this._canvas=canvas,this._providers={},this._current={}}PopupMenu.$inject=["config.popupMenu","eventBus","canvas"],PopupMenu.prototype.registerProvider=function(id,priority,provider){provider||(provider=priority,priority=1e3),this._eventBus.on("popupMenu.getProviders."+id,priority,function(event){event.providers.push(provider)})},PopupMenu.prototype.isEmpty=function(element,providerId){if(!element)throw new Error("element parameter is missing");if(!providerId)throw new Error("providerId parameter is missing");var providers=this._getProviders(providerId);if(!providers)return!0;var entries=this._getEntries(element,providers),headerEntries=this._getHeaderEntries(element,providers),hasEntries=0<(0,_minDash.size)(entries),hasHeaderEntries=headerEntries&&0<(0,_minDash.size)(headerEntries);return!hasEntries&&!hasHeaderEntries},PopupMenu.prototype.open=function(element,id,position){var providers=this._getProviders(id);if(!element)throw new Error("Element is missing");if(!providers||!providers.length)throw new Error("No registered providers for: "+id);if(!position)throw new Error("the position argument is missing");this.isOpen()&&this.close(),this._emit("open");var current=this._current={className:id,element:element,position:position},entries=this._getEntries(element,providers),headerEntries=this._getHeaderEntries(element,providers);current.entries=(0,_minDash.assign)({},entries,headerEntries),current.container=this._createContainer(),(0,_minDash.size)(headerEntries)&&current.container.appendChild(this._createEntries(headerEntries,"djs-popup-header")),(0,_minDash.size)(entries)&&current.container.appendChild(this._createEntries(entries,"djs-popup-body"));var parent=this._canvas.getContainer();this._attachContainer(current.container,parent,position.cursor),this._bindAutoClose()},PopupMenu.prototype.close=function(){this.isOpen()&&(this._emit("close"),this._unbindAutoClose(),(0,_minDom.remove)(this._current.container),this._current.container=null)},PopupMenu.prototype.isOpen=function(){return!!this._current.container},PopupMenu.prototype.trigger=function(event){event.preventDefault();var element=event.delegateTarget||event.target,entryId=(0,_minDom.attr)(element,"data-id"),entry=this._getEntry(entryId);if(entry.action)return entry.action.call(null,event,entry)},PopupMenu.prototype._getProviders=function(id){var event=this._eventBus.createEvent({type:"popupMenu.getProviders."+id,providers:[]});return this._eventBus.fire(event),event.providers},PopupMenu.prototype._getEntries=function(element,providers){var entries={};return(0,_minDash.forEach)(providers,function(provider){var entriesOrUpdater;provider.getPopupMenuEntries?(entriesOrUpdater=provider.getPopupMenuEntries(element),(0,_minDash.isFunction)(entriesOrUpdater)?entries=entriesOrUpdater(entries):(0,_minDash.forEach)(entriesOrUpdater,function(entry,id){entries[id]=entry})):(0,_minDash.forEach)(provider.getEntries(element),function(entry){var id=entry.id;if(!id)throw new Error("every entry must have the id property set");entries[id]=(0,_minDash.omit)(entry,["id"])})}),entries},PopupMenu.prototype._getHeaderEntries=function(element,providers){var entries={};return(0,_minDash.forEach)(providers,function(provider){if(provider.getPopupMenuHeaderEntries){var entriesOrUpdater=provider.getPopupMenuHeaderEntries(element);(0,_minDash.isFunction)(entriesOrUpdater)?entries=entriesOrUpdater(entries):(0,_minDash.forEach)(entriesOrUpdater,function(entry,id){entries[id]=entry})}else{if(!provider.getHeaderEntries)return;(0,_minDash.forEach)(provider.getHeaderEntries(element),function(entry){var id=entry.id;if(!id)throw new Error("every entry must have the id property set");entries[id]=(0,_minDash.omit)(entry,["id"])})}}),entries},PopupMenu.prototype._getEntry=function(entryId){var entry=this._current.entries[entryId];if(!entry)throw new Error("entry not found");return entry},PopupMenu.prototype._emit=function(eventName){this._eventBus.fire("popupMenu."+eventName)},PopupMenu.prototype._createContainer=function(){var container=(0,_minDom.domify)('<div class="djs-popup">'),position=this._current.position,className=this._current.className;return(0,_minDash.assign)(container.style,{position:"absolute",left:position.x+"px",top:position.y+"px",visibility:"hidden"}),(0,_minDom.classes)(container).add(className),container},PopupMenu.prototype._attachContainer=function(container,parent,cursor){var self=this;_minDom.delegate.bind(container,".entry","click",function(event){self.trigger(event)}),this._updateScale(container),parent.appendChild(container),cursor&&this._assureIsInbounds(container,cursor)},PopupMenu.prototype._updateScale=function(container){var minScale,maxScale,element,transform,zoom=this._canvas.zoom(),scaleConfig=this._config.scale,scale=zoom;!0!==scaleConfig&&(maxScale=!1===scaleConfig?minScale=1:(minScale=scaleConfig.min,scaleConfig.max),(0,_minDash.isDefined)(minScale)&&zoom<minScale&&(scale=minScale),(0,_minDash.isDefined)(maxScale)&&maxScale<zoom&&(scale=maxScale)),transform="scale("+scale+")",(element=container).style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach(function(prefix){element.style[prefix+"transform"]=transform})},PopupMenu.prototype._assureIsInbounds=function(container,cursor){var left,top,clientRect=this._canvas._container.getBoundingClientRect(),containerX=container.offsetLeft,containerY=container.offsetTop,containerWidth=container.scrollWidth,containerHeight=container.scrollHeight,overAxis={},cursorPosition_x=cursor.x-clientRect.left,cursorPosition_y=cursor.y-clientRect.top;containerX+containerWidth>clientRect.width&&(overAxis.x=!0),containerY+containerHeight>clientRect.height&&(overAxis.y=!0),overAxis.x&&overAxis.y?(left=cursorPosition_x-containerWidth+"px",top=cursorPosition_y-containerHeight+"px"):overAxis.x?(left=cursorPosition_x-containerWidth+"px",top=cursorPosition_y+"px"):overAxis.y&&cursorPosition_y<containerHeight?(left=cursorPosition_x+"px",top="10px"):overAxis.y&&(left=cursorPosition_x+"px",top=cursorPosition_y-containerHeight+"px"),(0,_minDash.assign)(container.style,{left:left,top:top},{visibility:"visible","z-index":1e3})},PopupMenu.prototype._createEntries=function(entries,className){var entriesContainer=(0,_minDom.domify)("<div>"),self=this;return(0,_minDom.classes)(entriesContainer).add(className),(0,_minDash.forEach)(entries,function(entry,id){var entryContainer=self._createEntry(entry,id);entriesContainer.appendChild(entryContainer)}),entriesContainer},PopupMenu.prototype._createEntry=function(entry,id){var label,entryContainer=(0,_minDom.domify)("<div>"),entryClasses=(0,_minDom.classes)(entryContainer);return entryClasses.add("entry"),entry.className&&entry.className.split(" ").forEach(function(className){entryClasses.add(className)}),(0,_minDom.attr)(entryContainer,"data-id",id),entry.label&&((label=(0,_minDom.domify)("<span>")).textContent=entry.label,entryContainer.appendChild(label)),entry.imageUrl&&entryContainer.appendChild((0,_minDom.domify)('<img src="'+entry.imageUrl+'" />')),!0===entry.active&&entryClasses.add("active"),!0===entry.disabled&&entryClasses.add("disabled"),entry.title&&(entryContainer.title=entry.title),entryContainer},PopupMenu.prototype._bindAutoClose=function(){this._eventBus.once(CLOSE_EVENTS,this.close,this)},PopupMenu.prototype._unbindAutoClose=function(){this._eventBus.off(CLOSE_EVENTS,this.close,this)}},{"min-dash":594,"min-dom":595}],296:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_PopupMenu=require("./PopupMenu"),_PopupMenu2=(obj=_PopupMenu)&&obj.__esModule?obj:{default:obj};exports.default={__init__:["popupMenu"],popupMenu:["type",_PopupMenu2.default]}},{"./PopupMenu":295}],297:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=PreviewSupport;var _minDash=require("min-dash"),_tinySvg=require("tiny-svg"),_minDom=require("min-dom"),_GraphicsUtil=require("../../util/GraphicsUtil"),MARKER_TYPES=["marker-start","marker-mid","marker-end"],NODES_CAN_HAVE_MARKER=["circle","ellipse","line","path","polygon","polyline","rect"];function PreviewSupport(elementRegistry,eventBus,canvas,styles){this._elementRegistry=elementRegistry,this._canvas=canvas,this._styles=styles,this._clonedMarkers={};var self=this;eventBus.on("drag.cleanup",function(){(0,_minDash.forEach)(self._clonedMarkers,function(clonedMarker){(0,_tinySvg.remove)(clonedMarker)}),self._clonedMarkers={}})}PreviewSupport.$inject=["elementRegistry","eventBus","canvas","styles"],PreviewSupport.prototype.getGfx=function(element){return this._elementRegistry.getGraphics(element)},PreviewSupport.prototype.addDragger=function(element,group,gfx){gfx=gfx||this.getGfx(element);var dragger=(0,_tinySvg.clone)(gfx),bbox=gfx.getBoundingClientRect();return this._cloneMarkers((0,_GraphicsUtil.getVisual)(dragger)),(0,_tinySvg.attr)(dragger,this._styles.cls("djs-dragger",[],{x:bbox.top,y:bbox.left})),(0,_tinySvg.append)(group,dragger),dragger},PreviewSupport.prototype.addFrame=function(shape,group){var frame=(0,_tinySvg.create)("rect",{class:"djs-resize-overlay",width:shape.width,height:shape.height,x:shape.x,y:shape.y});return(0,_tinySvg.append)(group,frame),frame},PreviewSupport.prototype._cloneMarkers=function(gfx){var node,self=this;if(gfx.childNodes)for(var i=0;i<gfx.childNodes.length;i++)self._cloneMarkers(gfx.childNodes[i]);node=gfx,-1!==NODES_CAN_HAVE_MARKER.indexOf(node.nodeName)&&MARKER_TYPES.forEach(function(markerType){var marker;(0,_tinySvg.attr)(gfx,markerType)&&(marker=function(node,markerType,parentNode){var id=(0,_tinySvg.attr)(node,markerType).match(/url\(['"]?#([^'"]*)['"]?\)/)[1];return(0,_minDom.query)("marker#"+id,parentNode||document)}(gfx,markerType,self._canvas.getContainer()),self._cloneMarker(gfx,marker,markerType))})},PreviewSupport.prototype._cloneMarker=function(gfx,marker,markerType){var clonedMarkerId,defs,markerId=marker.id,clonedMarker=this._clonedMarkers[markerId];clonedMarker||(clonedMarkerId=markerId+"-clone",(clonedMarker=(0,_tinySvg.clone)(marker)).id=clonedMarkerId,(0,_tinySvg.classes)(clonedMarker).add("djs-dragger").add("djs-dragger-marker"),this._clonedMarkers[markerId]=clonedMarker,(defs=(0,_minDom.query)("defs",this._canvas._svg))||(defs=(0,_tinySvg.create)("defs"),(0,_tinySvg.append)(this._canvas._svg,defs)),(0,_tinySvg.append)(defs,clonedMarker));var reference="url(#"+this._clonedMarkers[markerId].id+")";(0,_tinySvg.attr)(gfx,markerType,reference)}},{"../../util/GraphicsUtil":355,"min-dash":594,"min-dom":595,"tiny-svg":606}],298:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_PreviewSupport=require("./PreviewSupport"),_PreviewSupport2=(obj=_PreviewSupport)&&obj.__esModule?obj:{default:obj};exports.default={__init__:["previewSupport"],previewSupport:["type",_PreviewSupport2.default]}},{"./PreviewSupport":297}],299:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=Replace;var _minDash=require("min-dash"),round=Math.round;function Replace(modeling){this._modeling=modeling}Replace.$inject=["modeling"],Replace.prototype.replaceElement=function(oldElement,newElementData,options){if(oldElement.waypoints)return null;var modeling=this._modeling,width=newElementData.width||oldElement.width,height=newElementData.height||oldElement.height,x=newElementData.x||oldElement.x,y=newElementData.y||oldElement.y,centerX=round(x+width/2),centerY=round(y+height/2);return modeling.replaceShape(oldElement,(0,_minDash.assign)({},newElementData,{x:centerX,y:centerY,width:width,height:height}),options)}},{"min-dash":594}],300:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_Replace=require("./Replace"),_Replace2=(obj=_Replace)&&obj.__esModule?obj:{default:obj};exports.default={__init__:["replace"],replace:["type",_Replace2.default]}},{"./Replace":299}],301:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=Resize,exports.getReferencePoint=getReferencePoint;var _minDash=require("min-dash"),_ResizeUtil=require("./ResizeUtil"),_LayoutUtil=require("../../layout/LayoutUtil");function Resize(eventBus,rules,modeling,dragging){this._dragging=dragging,this._rules=rules;var self=this;eventBus.on("resize.start",function(event){var context,resizeConstraints,minBounds;context=event.context,resizeConstraints=context.resizeConstraints,minBounds=context.minBounds,void 0===resizeConstraints&&(void 0===minBounds&&(minBounds=self.computeMinResizeBox(context)),context.resizeConstraints={min:(0,_LayoutUtil.asTRBL)(minBounds)})}),eventBus.on("resize.move",function(event){var delta={x:event.dx,y:event.dy};!function(context,delta){var newBounds,shape=context.shape,direction=context.direction,resizeConstraints=context.resizeConstraints;context.delta=delta,newBounds=(0,_ResizeUtil.resizeBounds)(shape,direction,delta),context.newBounds=(0,_ResizeUtil.ensureConstraints)(newBounds,resizeConstraints),context.canExecute=self.canResize(context)}(event.context,delta)}),eventBus.on("resize.end",function(event){!function(context){var shape=context.shape,canExecute=context.canExecute,newBounds=context.newBounds;if(canExecute){if(!function(shape,newBounds){return shape.x!==newBounds.x||shape.y!==newBounds.y||shape.width!==newBounds.width||shape.height!==newBounds.height}(shape,newBounds=(0,_LayoutUtil.roundBounds)(newBounds)))return;modeling.resizeShape(shape,newBounds)}}(event.context)})}function getReferencePoint(shape,direction){var mid=(0,_LayoutUtil.getMid)(shape),trbl=(0,_LayoutUtil.asTRBL)(shape),referencePoint={x:mid.x,y:mid.y};return-1!==direction.indexOf("n")?referencePoint.y=trbl.top:-1!==direction.indexOf("s")&&(referencePoint.y=trbl.bottom),-1!==direction.indexOf("e")?referencePoint.x=trbl.right:-1!==direction.indexOf("w")&&(referencePoint.x=trbl.left),referencePoint}Resize.prototype.canResize=function(context){var rules=this._rules,ctx=(0,_minDash.pick)(context,["newBounds","shape","delta","direction"]);return rules.allowed("shape.resize",ctx)},Resize.prototype.activate=function(event,shape,contextOrDirection){var context,direction,dragging=this._dragging;if("string"==typeof contextOrDirection&&(contextOrDirection={direction:contextOrDirection}),!(direction=(context=(0,_minDash.assign)({shape:shape},contextOrDirection)).direction))throw new Error("must provide a direction (n|w|s|e|nw|se|ne|sw)");dragging.init(event,getReferencePoint(shape,direction),"resize",{autoActivate:!0,cursor:function(direction){return"n"===direction||"s"===direction?"resize-ns":"e"===direction||"w"===direction?"resize-ew":"nw"===direction||"se"===direction?"resize-nwse":"resize-nesw"}(direction),data:{shape:shape,context:context}})},Resize.prototype.computeMinResizeBox=function(context){var shape=context.shape,direction=context.direction,minDimensions=context.minDimensions||{width:10,height:10},childrenBounds=(0,_ResizeUtil.computeChildrenBBox)(shape,context.childrenBoxPadding);return(0,_ResizeUtil.getMinResizeBounds)(direction,shape,minDimensions,childrenBounds)},Resize.$inject=["eventBus","rules","modeling","dragging"]},{"../../layout/LayoutUtil":336,"./ResizeUtil":304,"min-dash":594}],302:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ResizeHandles;var _minDash=require("min-dash"),_tinySvg=require("tiny-svg"),_minDom=require("min-dom"),_Mouse=require("../../util/Mouse"),_SvgTransformUtil=require("../../util/SvgTransformUtil"),_Resize=require("./Resize"),directions=["n","w","s","e","nw","ne","se","sw"];function ResizeHandles(eventBus,canvas,selection,resize){this._resize=resize,this._canvas=canvas;var self=this;eventBus.on("selection.changed",function(e){var newSelection=e.newSelection;self.removeResizers(),1===newSelection.length&&(0,_minDash.forEach)(newSelection,(0,_minDash.bind)(self.addResizer,self))}),eventBus.on("shape.changed",function(e){var shape=e.element;selection.isSelected(shape)&&(self.removeResizers(),self.addResizer(shape))})}ResizeHandles.prototype.makeDraggable=function(element,gfx,direction){var resize=this._resize;function startResize(event){(0,_Mouse.isPrimaryButton)(event)&&resize.activate(event,element,direction)}_minDom.event.bind(gfx,"mousedown",startResize),_minDom.event.bind(gfx,"touchstart",startResize)},ResizeHandles.prototype._createResizer=function(element,x,y,direction){var resizersParent=this._getResizersParent(),offset=function(direction){var offset={x:0,y:0};-1!==direction.indexOf("e")?offset.x=6:-1!==direction.indexOf("w")&&(offset.x=-6);-1!==direction.indexOf("s")?offset.y=6:-1!==direction.indexOf("n")&&(offset.y=-6);return offset}(direction),group=(0,_tinySvg.create)("g");(0,_tinySvg.classes)(group).add("djs-resizer"),(0,_tinySvg.classes)(group).add("djs-resizer-"+element.id),(0,_tinySvg.classes)(group).add("djs-resizer-"+direction),(0,_tinySvg.append)(resizersParent,group);var visual=(0,_tinySvg.create)("rect");(0,_tinySvg.attr)(visual,{x:-2+offset.x,y:-2+offset.y,width:4,height:4}),(0,_tinySvg.classes)(visual).add("djs-resizer-visual"),(0,_tinySvg.append)(group,visual);var hit=(0,_tinySvg.create)("rect");return(0,_tinySvg.attr)(hit,{x:-10+offset.x,y:-10+offset.y,width:20,height:20}),(0,_tinySvg.classes)(hit).add("djs-resizer-hit"),(0,_tinySvg.append)(group,hit),(0,_SvgTransformUtil.transform)(group,x,y),group},ResizeHandles.prototype.createResizer=function(element,direction){var point=(0,_Resize.getReferencePoint)(element,direction),resizer=this._createResizer(element,point.x,point.y,direction);this.makeDraggable(element,resizer,direction)},ResizeHandles.prototype.addResizer=function(shape){var self=this;this._resize.canResize({shape:shape})&&(0,_minDash.forEach)(directions,function(direction){self.createResizer(shape,direction)})},ResizeHandles.prototype.removeResizers=function(){var resizersParent=this._getResizersParent();(0,_tinySvg.clear)(resizersParent)},ResizeHandles.prototype._getResizersParent=function(){return this._canvas.getLayer("resizers")},ResizeHandles.$inject=["eventBus","canvas","selection","resize"]},{"../../util/Mouse":359,"../../util/SvgTransformUtil":364,"./Resize":301,"min-dash":594,"min-dom":595,"tiny-svg":606}],303:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ResizePreview;var _tinySvg=require("tiny-svg"),MARKER_RESIZING="djs-resizing",MARKER_RESIZE_NOT_OK="resize-not-ok",LOW_PRIORITY=500;function ResizePreview(eventBus,canvas,previewSupport){eventBus.on("resize.move",LOW_PRIORITY,function(event){var context,shape,bounds,frame;context=event.context,shape=context.shape,bounds=context.newBounds,(frame=context.frame)||(frame=context.frame=previewSupport.addFrame(shape,canvas.getDefaultLayer()),canvas.addMarker(shape,MARKER_RESIZING)),5<bounds.width&&(0,_tinySvg.attr)(frame,{x:bounds.x,width:bounds.width}),5<bounds.height&&(0,_tinySvg.attr)(frame,{y:bounds.y,height:bounds.height}),context.canExecute?(0,_tinySvg.classes)(frame).remove(MARKER_RESIZE_NOT_OK):(0,_tinySvg.classes)(frame).add(MARKER_RESIZE_NOT_OK)}),eventBus.on("resize.cleanup",function(event){var context,shape;context=event.context,shape=context.shape,context.frame&&(0,_tinySvg.remove)(context.frame),canvas.removeMarker(shape,MARKER_RESIZING)})}ResizePreview.$inject=["eventBus","canvas","previewSupport"]},{"tiny-svg":606}],304:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};exports.substractTRBL=function(trblA,trblB){return{top:trblA.top-trblB.top,right:trblA.right-trblB.right,bottom:trblA.bottom-trblB.bottom,left:trblA.left-trblB.left}},exports.resizeBounds=function(bounds,direction,delta){var dx=delta.x,dy=delta.y,newBounds={x:bounds.x,y:bounds.y,width:bounds.width,height:bounds.height};-1!==direction.indexOf("n")?(newBounds.y=bounds.y+dy,newBounds.height=bounds.height-dy):-1!==direction.indexOf("s")&&(newBounds.height=bounds.height+dy);-1!==direction.indexOf("e")?newBounds.width=bounds.width+dx:-1!==direction.indexOf("w")&&(newBounds.x=bounds.x+dx,newBounds.width=bounds.width-dx);return newBounds},exports.resizeTRBL=function(bounds,resize){return{x:bounds.x+(resize.left||0),y:bounds.y+(resize.top||0),width:bounds.width-(resize.left||0)+(resize.right||0),height:bounds.height-(resize.top||0)+(resize.bottom||0)}},exports.reattachPoint=function(bounds,newBounds,point){var sx=bounds.width/newBounds.width,sy=bounds.height/newBounds.height;return{x:Math.round(newBounds.x+newBounds.width/2)-Math.floor((bounds.x+bounds.width/2-point.x)/sx),y:Math.round(newBounds.y+newBounds.height/2)-Math.floor((bounds.y+bounds.height/2-point.y)/sy)}},exports.ensureConstraints=function(currentBounds,resizeConstraints){if(!resizeConstraints)return currentBounds;var currentTrbl=(0,_LayoutUtil.asTRBL)(currentBounds);return(0,_LayoutUtil.asBounds)({top:applyConstraints("top",currentTrbl,resizeConstraints),right:applyConstraints("right",currentTrbl,resizeConstraints),bottom:applyConstraints("bottom",currentTrbl,resizeConstraints),left:applyConstraints("left",currentTrbl,resizeConstraints)})},exports.getMinResizeBounds=function(direction,currentBounds,minDimensions,childrenBounds){var currentBox=(0,_LayoutUtil.asTRBL)(currentBounds),minBox={top:/n/.test(direction)?currentBox.bottom-minDimensions.height:currentBox.top,left:/w/.test(direction)?currentBox.right-minDimensions.width:currentBox.left,bottom:/s/.test(direction)?currentBox.top+minDimensions.height:currentBox.bottom,right:/e/.test(direction)?currentBox.left+minDimensions.width:currentBox.right},childrenBox=childrenBounds?(0,_LayoutUtil.asTRBL)(childrenBounds):minBox,combinedBox={top:min(minBox.top,childrenBox.top),left:min(minBox.left,childrenBox.left),bottom:max(minBox.bottom,childrenBox.bottom),right:max(minBox.right,childrenBox.right)};return(0,_LayoutUtil.asBounds)(combinedBox)},exports.addPadding=addPadding,exports.computeChildrenBBox=function(shapeOrChildren,padding){var elements;elements=void 0===shapeOrChildren.length?(0,_minDash.filter)(shapeOrChildren.children,isBBoxChild):shapeOrChildren;if(elements.length)return addPadding((0,_Elements.getBBox)(elements),padding)};var _minDash=require("min-dash"),_Elements=require("../../util/Elements"),_LayoutUtil=require("../../layout/LayoutUtil"),max=Math.max,min=Math.min,DEFAULT_CHILD_BOX_PADDING=20;function applyConstraints(attr,trbl,resizeConstraints){var value=trbl[attr],minValue=resizeConstraints.min&&resizeConstraints.min[attr],maxValue=resizeConstraints.max&&resizeConstraints.max[attr];return(0,_minDash.isNumber)(minValue)&&(value=(/top|left/.test(attr)?min:max)(value,minValue)),(0,_minDash.isNumber)(maxValue)&&(value=(/top|left/.test(attr)?max:min)(value,maxValue)),value}function asPadding(mayBePadding){return void 0!==mayBePadding?mayBePadding:DEFAULT_CHILD_BOX_PADDING}function addPadding(bbox,padding){var left,right,top,bottom;return"object"===(void 0===padding?"undefined":_typeof(padding))?(left=asPadding(padding.left),right=asPadding(padding.right),top=asPadding(padding.top),bottom=asPadding(padding.bottom)):left=right=top=bottom=asPadding(padding),{x:bbox.x-left,y:bbox.y-top,width:bbox.width+left+right,height:bbox.height+top+bottom}}function isBBoxChild(element){return!element.waypoints&&"label"!==element.type}},{"../../layout/LayoutUtil":336,"../../util/Elements":351,"min-dash":594}],305:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _rules2=_interopRequireDefault(require("../rules")),_dragging2=_interopRequireDefault(require("../dragging")),_previewSupport2=_interopRequireDefault(require("../preview-support")),_Resize2=_interopRequireDefault(require("./Resize")),_ResizePreview2=_interopRequireDefault(require("./ResizePreview")),_ResizeHandles2=_interopRequireDefault(require("./ResizeHandles"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_rules2.default,_dragging2.default,_previewSupport2.default],__init__:["resize","resizePreview","resizeHandles"],resize:["type",_Resize2.default],resizePreview:["type",_ResizePreview2.default],resizeHandles:["type",_ResizeHandles2.default]}},{"../dragging":233,"../preview-support":298,"../rules":308,"./Resize":301,"./ResizeHandles":302,"./ResizePreview":303}],306:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=RuleProvider;var _inherits2=_interopRequireDefault(require("inherits")),_CommandInterceptor2=_interopRequireDefault(require("../../command/CommandInterceptor"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function RuleProvider(eventBus){_CommandInterceptor2.default.call(this,eventBus),this.init()}RuleProvider.$inject=["eventBus"],(0,_inherits2.default)(RuleProvider,_CommandInterceptor2.default),RuleProvider.prototype.addRule=function(actions,priority,fn){var self=this;"string"==typeof actions&&(actions=[actions]),actions.forEach(function(action){self.canExecute(action,priority,function(context,action,event){return fn(context)},!0)})},RuleProvider.prototype.init=function(){}},{"../../command/CommandInterceptor":181,inherits:385}],307:[function(require,module,exports){"use strict";function Rules(injector){this._commandStack=injector.get("commandStack",!1)}Object.defineProperty(exports,"__esModule",{value:!0}),(exports.default=Rules).$inject=["injector"],Rules.prototype.allowed=function(action,context){var allowed=!0,commandStack=this._commandStack;return commandStack&&(allowed=commandStack.canExecute(action,context)),void 0===allowed||allowed}},{}],308:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_Rules=require("./Rules"),_Rules2=(obj=_Rules)&&obj.__esModule?obj:{default:obj};exports.default={__init__:["rules"],rules:["type",_Rules2.default]}},{"./Rules":307}],309:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=SearchPad;var _minDom=require("min-dom"),_Elements=require("../../util/Elements"),_EscapeUtil=require("../../util/EscapeUtil");function SearchPad(canvas,eventBus,overlays,selection){this._open=!1,this._results=[],this._eventMaps=[],this._canvas=canvas,this._eventBus=eventBus,this._overlays=overlays,this._selection=selection,this._container=(0,_minDom.domify)(SearchPad.BOX_HTML),this._searchInput=(0,_minDom.query)(SearchPad.INPUT_SELECTOR,this._container),this._resultsContainer=(0,_minDom.query)(SearchPad.RESULTS_CONTAINER_SELECTOR,this._container),this._canvas.getContainer().appendChild(this._container),eventBus.on(["canvas.destroy","diagram.destroy"],this.close,this)}function createInnerTextNode(parentNode,tokens,template){var text=function(tokens){var htmlText="";return tokens.forEach(function(t){t.matched?htmlText+='<strong class="'+SearchPad.RESULT_HIGHLIGHT_CLASS+'">'+(0,_EscapeUtil.escapeHTML)(t.matched)+"</strong>":htmlText+=(0,_EscapeUtil.escapeHTML)(t.normal)}),""!==htmlText?htmlText:null}(tokens),childNode=(0,_minDom.domify)(template);childNode.innerHTML=text,parentNode.appendChild(childNode)}SearchPad.$inject=["canvas","eventBus","overlays","selection"],SearchPad.prototype._bindEvents=function(){var self=this;function listen(el,selector,type,fn){self._eventMaps.push({el:el,type:type,listener:_minDom.delegate.bind(el,selector,type,fn)})}listen(document,"html","click",function(e){self.close()}),listen(this._container,SearchPad.INPUT_SELECTOR,"click",function(e){e.stopPropagation(),e.delegateTarget.focus()}),listen(this._container,SearchPad.RESULT_SELECTOR,"mouseover",function(e){e.stopPropagation(),self._scrollToNode(e.delegateTarget),self._preselect(e.delegateTarget)}),listen(this._container,SearchPad.RESULT_SELECTOR,"click",function(e){e.stopPropagation(),self._select(e.delegateTarget)}),listen(this._container,SearchPad.INPUT_SELECTOR,"keydown",function(e){38===e.keyCode&&e.preventDefault(),40===e.keyCode&&e.preventDefault()}),listen(this._container,SearchPad.INPUT_SELECTOR,"keyup",function(e){if(27===e.keyCode)return self.close();if(13!==e.keyCode)return 38===e.keyCode?self._scrollToDirection(!0):40===e.keyCode?self._scrollToDirection():void(37!==e.keyCode&&39!==e.keyCode&&self._search(e.delegateTarget.value));var selected=self._getCurrentResult();return selected?self._select(selected):self.close()})},SearchPad.prototype._unbindEvents=function(){this._eventMaps.forEach(function(m){_minDom.delegate.unbind(m.el,m.type,m.listener)})},SearchPad.prototype._search=function(pattern){var searchResults,node,self=this;this._clearResults(),!pattern||""===pattern||(searchResults=this._searchProvider.find(pattern)).length&&(searchResults.forEach(function(result){var id=result.element.id,node=self._createResultNode(result,id);self._results[id]={element:result.element,node:node}}),node=(0,_minDom.query)(SearchPad.RESULT_SELECTOR,this._resultsContainer),this._scrollToNode(node),this._preselect(node))},SearchPad.prototype._scrollToDirection=function(previous){var node,selected=this._getCurrentResult();!selected||(node=previous?selected.previousElementSibling:selected.nextElementSibling)&&(this._scrollToNode(node),this._preselect(node))},SearchPad.prototype._scrollToNode=function(node){var nodeOffset,containerScroll,bottomScroll;node&&node!==this._getCurrentResult()&&(nodeOffset=node.offsetTop,containerScroll=this._resultsContainer.scrollTop,bottomScroll=nodeOffset-this._resultsContainer.clientHeight+node.clientHeight,nodeOffset<containerScroll?this._resultsContainer.scrollTop=nodeOffset:containerScroll<bottomScroll&&(this._resultsContainer.scrollTop=bottomScroll))},SearchPad.prototype._clearResults=function(){(0,_minDom.clear)(this._resultsContainer),this._results=[],this._resetOverlay(),this._eventBus.fire("searchPad.cleared")},SearchPad.prototype._getCurrentResult=function(){return(0,_minDom.query)(SearchPad.RESULT_SELECTED_SELECTOR,this._resultsContainer)},SearchPad.prototype._createResultNode=function(result,id){var node=(0,_minDom.domify)(SearchPad.RESULT_HTML);return 0<result.primaryTokens.length&&createInnerTextNode(node,result.primaryTokens,SearchPad.RESULT_PRIMARY_HTML),createInnerTextNode(node,result.secondaryTokens,SearchPad.RESULT_SECONDARY_HTML),(0,_minDom.attr)(node,SearchPad.RESULT_ID_ATTRIBUTE,id),this._resultsContainer.appendChild(node),node},SearchPad.prototype.registerProvider=function(provider){this._searchProvider=provider},SearchPad.prototype.open=function(){if(!this._searchProvider)throw new Error("no search provider registered");this.isOpen()||(this._bindEvents(),this._open=!0,(0,_minDom.classes)(this._container).add("open"),this._searchInput.focus(),this._eventBus.fire("searchPad.opened"))},SearchPad.prototype.close=function(){this.isOpen()&&(this._unbindEvents(),(this._open=!1,_minDom.classes)(this._container).remove("open"),this._clearResults(),this._searchInput.value="",this._searchInput.blur(),this._resetOverlay(),this._eventBus.fire("searchPad.closed"))},SearchPad.prototype.toggle=function(){this.isOpen()?this.close():this.open()},SearchPad.prototype.isOpen=function(){return this._open},SearchPad.prototype._preselect=function(node){var id,element,selectedNode=this._getCurrentResult();node!==selectedNode&&(selectedNode&&(0,_minDom.classes)(selectedNode).remove(SearchPad.RESULT_SELECTED_CLASS),id=(0,_minDom.attr)(node,SearchPad.RESULT_ID_ATTRIBUTE),element=this._results[id].element,(0,_minDom.classes)(node).add(SearchPad.RESULT_SELECTED_CLASS),this._resetOverlay(element),this._centerViewbox(element),this._selection.select(element),this._eventBus.fire("searchPad.preselected",element))},SearchPad.prototype._select=function(node){var id=(0,_minDom.attr)(node,SearchPad.RESULT_ID_ATTRIBUTE),element=this._results[id].element;this.close(),this._resetOverlay(),this._centerViewbox(element),this._selection.select(element),this._eventBus.fire("searchPad.selected",element)},SearchPad.prototype._centerViewbox=function(element){var viewbox=this._canvas.viewbox(),box=(0,_Elements.getBBox)(element),newViewbox={x:box.x+box.width/2-viewbox.outer.width/2,y:box.y+box.height/2-viewbox.outer.height/2,width:viewbox.outer.width,height:viewbox.outer.height};this._canvas.viewbox(newViewbox),this._canvas.zoom(viewbox.scale)},SearchPad.prototype._resetOverlay=function(element){var overlay;this._overlayId&&this._overlays.remove(this._overlayId),element&&(overlay=function(box){var w=box.width+12,h=box.height+12,styles=["width: "+w+"px","height: "+h+"px"].join("; ");return{position:{bottom:h-6,right:w-6},show:!0,html:'<div style="'+styles+'" class="'+SearchPad.OVERLAY_CLASS+'"></div>'}}((0,_Elements.getBBox)(element)),this._overlayId=this._overlays.add(element,overlay))},SearchPad.CONTAINER_SELECTOR=".djs-search-container",SearchPad.INPUT_SELECTOR=".djs-search-input input",SearchPad.RESULTS_CONTAINER_SELECTOR=".djs-search-results",SearchPad.RESULT_SELECTOR=".djs-search-result",SearchPad.RESULT_SELECTED_SELECTOR="."+(SearchPad.RESULT_SELECTED_CLASS="djs-search-result-selected"),SearchPad.RESULT_ID_ATTRIBUTE="data-result-id",SearchPad.RESULT_HIGHLIGHT_CLASS="djs-search-highlight",SearchPad.OVERLAY_CLASS="djs-search-overlay",SearchPad.BOX_HTML='<div class="djs-search-container djs-draggable djs-scrollable"><div class="djs-search-input"><input type="text"/></div><div class="djs-search-results"></div></div>',SearchPad.RESULT_HTML='<div class="djs-search-result"></div>',SearchPad.RESULT_PRIMARY_HTML='<div class="djs-search-result-primary"></div>',SearchPad.RESULT_SECONDARY_HTML='<p class="djs-search-result-secondary"></p>'},{"../../util/Elements":351,"../../util/EscapeUtil":352,"min-dom":595}],310:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _overlays2=_interopRequireDefault(require("../overlays")),_selection2=_interopRequireDefault(require("../selection")),_SearchPad2=_interopRequireDefault(require("./SearchPad"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_overlays2.default,_selection2.default],searchPad:["type",_SearchPad2.default]}},{"../overlays":292,"../selection":314,"./SearchPad":309}],311:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=Selection;var _minDash=require("min-dash");function Selection(eventBus){this._eventBus=eventBus,this._selectedElements=[];var self=this;eventBus.on(["shape.remove","connection.remove"],function(e){var element=e.element;self.deselect(element)}),eventBus.on(["diagram.clear"],function(e){self.select(null)})}Selection.$inject=["eventBus"],Selection.prototype.deselect=function(element){var oldSelection,selectedElements=this._selectedElements,idx=selectedElements.indexOf(element);-1!==idx&&(oldSelection=selectedElements.slice(),selectedElements.splice(idx,1),this._eventBus.fire("selection.changed",{oldSelection:oldSelection,newSelection:selectedElements}))},Selection.prototype.get=function(){return this._selectedElements},Selection.prototype.isSelected=function(element){return-1!==this._selectedElements.indexOf(element)},Selection.prototype.select=function(elements,add){var selectedElements=this._selectedElements,oldSelection=selectedElements.slice();(0,_minDash.isArray)(elements)||(elements=elements?[elements]:[]),add?(0,_minDash.forEach)(elements,function(element){-1===selectedElements.indexOf(element)&&selectedElements.push(element)}):this._selectedElements=selectedElements=elements.slice(),this._eventBus.fire("selection.changed",{oldSelection:oldSelection,newSelection:selectedElements})}},{"min-dash":594}],312:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=SelectionBehavior;var _Mouse=require("../../util/Mouse"),_minDash=require("min-dash");function SelectionBehavior(eventBus,selection,canvas,elementRegistry){eventBus.on("create.end",500,function(event){var context=event.context,canExecute=context.canExecute,elements=context.elements,autoSelect=(context.hints||{}).autoSelect;if(canExecute){if(!1===autoSelect)return;(0,_minDash.isArray)(autoSelect)?selection.select(autoSelect):selection.select(elements.filter(isShown))}}),eventBus.on("connect.end",500,function(event){var context=event.context,canExecute=context.canExecute,hover=context.hover;canExecute&&hover&&selection.select(hover)}),eventBus.on("shape.move.end",500,function(event){var previousSelection=event.previousSelection||[],shape=elementRegistry.get(event.context.shape.id);(0,_minDash.find)(previousSelection,function(selectedShape){return shape.id===selectedShape.id})||selection.select(shape)}),eventBus.on("element.click",function(event){var element=event.element;element===canvas.getRootElement()&&(element=null);var isSelected=selection.isSelected(element),isMultiSelect=1<selection.get().length,add=(0,_Mouse.hasPrimaryModifier)(event)||(0,_Mouse.hasSecondaryModifier)(event);if(isSelected&&isMultiSelect)return add?selection.deselect(element):selection.select(element);isSelected?selection.deselect(element):selection.select(element,add)})}function isShown(element){return!element.hidden}SelectionBehavior.$inject=["eventBus","selection","canvas","elementRegistry"]},{"../../util/Mouse":359,"min-dash":594}],313:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=SelectionVisuals;var _minDash=require("min-dash"),MARKER_HOVER="hover",MARKER_SELECTED="selected";function SelectionVisuals(events,canvas,selection,styles){function addMarker(e,cls){canvas.addMarker(e,cls)}function removeMarker(e,cls){canvas.removeMarker(e,cls)}this._multiSelectionBox=null,events.on("element.hover",function(event){addMarker(event.element,MARKER_HOVER)}),events.on("element.out",function(event){removeMarker(event.element,MARKER_HOVER)}),events.on("selection.changed",function(event){var oldSelection=event.oldSelection,newSelection=event.newSelection;(0,_minDash.forEach)(oldSelection,function(e){-1===newSelection.indexOf(e)&&removeMarker(e,MARKER_SELECTED)}),(0,_minDash.forEach)(newSelection,function(e){-1===oldSelection.indexOf(e)&&addMarker(e,MARKER_SELECTED)})})}SelectionVisuals.$inject=["eventBus","canvas","selection","styles"]},{"min-dash":594}],314:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _interactionEvents2=_interopRequireDefault(require("../interaction-events")),_outline2=_interopRequireDefault(require("../outline")),_Selection2=_interopRequireDefault(require("./Selection")),_SelectionVisuals2=_interopRequireDefault(require("./SelectionVisuals")),_SelectionBehavior2=_interopRequireDefault(require("./SelectionBehavior"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__init__:["selectionVisuals","selectionBehavior"],__depends__:[_interactionEvents2.default,_outline2.default],selection:["type",_Selection2.default],selectionVisuals:["type",_SelectionVisuals2.default],selectionBehavior:["type",_SelectionBehavior2.default]}},{"../interaction-events":247,"../outline":290,"./Selection":311,"./SelectionBehavior":312,"./SelectionVisuals":313}],315:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=CreateMoveSnapping;var obj,_SnapContext=require("./SnapContext"),_SnapContext2=(obj=_SnapContext)&&obj.__esModule?obj:{default:obj},_SnapUtil=require("./SnapUtil"),_KeyboardUtil=require("../keyboard/KeyboardUtil"),_minDash=require("min-dash");var HIGHER_PRIORITY=1250;function CreateMoveSnapping(elementRegistry,eventBus,snapping){var self=this;this._elementRegistry=elementRegistry,eventBus.on(["create.start","shape.move.start"],function(event){self.initSnap(event)}),eventBus.on(["create.move","create.end","shape.move.move","shape.move.end"],HIGHER_PRIORITY,function(event){var snapPoints,context=event.context,shape=context.shape,snapContext=context.snapContext,target=context.target;event.originalEvent&&(0,_KeyboardUtil.isCmd)(event.originalEvent)||!(0,_SnapUtil.isSnapped)(event)&&target&&((snapPoints=snapContext.pointsForTarget(target)).initialized||((snapPoints=self.addSnapTargetPoints(snapPoints,shape,target)).initialized=!0),snapping.snap(event,snapPoints))}),eventBus.on(["create.cleanup","shape.move.cleanup"],function(){snapping.hide()})}function isLabel(element){return element.labelTarget}CreateMoveSnapping.$inject=["elementRegistry","eventBus","snapping"],CreateMoveSnapping.prototype.initSnap=function(event){var elementRegistry=this._elementRegistry,context=event.context,shape=context.shape,snapContext=(snapContext=context.snapContext)||(context.snapContext=new _SnapContext2.default),shapeMid=elementRegistry.get(shape.id)?(0,_SnapUtil.mid)(shape,event):{x:event.x+(0,_SnapUtil.mid)(shape).x,y:event.y+(0,_SnapUtil.mid)(shape).y},shapeTopLeft_x=shapeMid.x-shape.width/2,shapeTopLeft_y=shapeMid.y-shape.height/2,shapeBottomRight_x=shapeMid.x+shape.width/2,shapeBottomRight_y=shapeMid.y+shape.height/2;return snapContext.setSnapOrigin("mid",{x:shapeMid.x-event.x,y:shapeMid.y-event.y}),isLabel(shape)||(snapContext.setSnapOrigin("top-left",{x:shapeTopLeft_x-event.x,y:shapeTopLeft_y-event.y}),snapContext.setSnapOrigin("bottom-right",{x:shapeBottomRight_x-event.x,y:shapeBottomRight_y-event.y})),snapContext},CreateMoveSnapping.prototype.addSnapTargetPoints=function(snapPoints,shape,target){var snapTargets=this.getSnapTargets(shape,target);return(0,_minDash.forEach)(snapTargets,function(snapTarget){if(isLabel(snapTarget))isLabel(shape)&&snapPoints.add("mid",(0,_SnapUtil.mid)(snapTarget));else if(snapTarget.waypoints){if(snapTarget.waypoints.length<3)return;var waypoints=snapTarget.waypoints.slice(1,-1);(0,_minDash.forEach)(waypoints,function(waypoint){snapPoints.add("mid",waypoint)})}else snapPoints.add("mid",(0,_SnapUtil.mid)(snapTarget))}),(0,_minDash.isNumber)(shape.x)&&(0,_minDash.isNumber)(shape.y)&&this._elementRegistry.get(shape.id)&&snapPoints.add("mid",(0,_SnapUtil.mid)(shape)),snapPoints},CreateMoveSnapping.prototype.getSnapTargets=function(shape,target){return(0,_SnapUtil.getChildren)(target).filter(function(child){return!child.hidden})}},{"../keyboard/KeyboardUtil":252,"./SnapContext":317,"./SnapUtil":318,"min-dash":594}],316:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ResizeSnapping;var obj,_SnapContext=require("./SnapContext"),_SnapContext2=(obj=_SnapContext)&&obj.__esModule?obj:{default:obj},_SnapUtil=require("./SnapUtil"),_KeyboardUtil=require("../keyboard/KeyboardUtil"),_LayoutUtil=require("../../layout/LayoutUtil"),_minDash=require("min-dash");var HIGHER_PRIORITY=1250;function ResizeSnapping(eventBus,snapping){var self=this;eventBus.on(["resize.start"],function(event){self.initSnap(event)}),eventBus.on(["resize.move","resize.end"],HIGHER_PRIORITY,function(event){var snapPoints,context=event.context,shape=context.shape,parent=shape.parent,direction=context.direction,snapContext=context.snapContext;event.originalEvent&&(0,_KeyboardUtil.isCmd)(event.originalEvent)||(0,_SnapUtil.isSnapped)(event)||((snapPoints=snapContext.pointsForTarget(parent)).initialized||((snapPoints=self.addSnapTargetPoints(snapPoints,shape,parent,direction)).initialized=!0),function(direction){return"n"===direction||"s"===direction}(direction)&&(0,_SnapUtil.setSnapped)(event,"x",event.x),function(direction){return"e"===direction||"w"===direction}(direction)&&(0,_SnapUtil.setSnapped)(event,"y",event.y),snapping.snap(event,snapPoints))}),eventBus.on(["resize.cleanup"],function(){snapping.hide()})}function getSnapOrigin(shape,direction){var mid=(0,_LayoutUtil.getMid)(shape),trbl=(0,_LayoutUtil.asTRBL)(shape),snapOrigin={x:mid.x,y:mid.y};return-1!==direction.indexOf("n")?snapOrigin.y=trbl.top:-1!==direction.indexOf("s")&&(snapOrigin.y=trbl.bottom),-1!==direction.indexOf("e")?snapOrigin.x=trbl.right:-1!==direction.indexOf("w")&&(snapOrigin.x=trbl.left),snapOrigin}ResizeSnapping.prototype.initSnap=function(event){var context=event.context,shape=context.shape,direction=context.direction,snapContext=(snapContext=context.snapContext)||(context.snapContext=new _SnapContext2.default),snapOrigin=getSnapOrigin(shape,direction);return snapContext.setSnapOrigin("corner",{x:snapOrigin.x-event.x,y:snapOrigin.y-event.y}),snapContext},ResizeSnapping.prototype.addSnapTargetPoints=function(snapPoints,shape,target,direction){var snapTargets=this.getSnapTargets(shape,target);return(0,_minDash.forEach)(snapTargets,function(snapTarget){snapPoints.add("corner",(0,_SnapUtil.bottomRight)(snapTarget)),snapPoints.add("corner",(0,_SnapUtil.topLeft)(snapTarget))}),snapPoints.add("corner",getSnapOrigin(shape,direction)),snapPoints},ResizeSnapping.$inject=["eventBus","snapping"],ResizeSnapping.prototype.getSnapTargets=function(shape,target){return(0,_SnapUtil.getChildren)(target).filter(function(child){return host=shape,!(child.host===host||child.waypoints||child.hidden||child.labelTarget);var host})}},{"../../layout/LayoutUtil":336,"../keyboard/KeyboardUtil":252,"./SnapContext":317,"./SnapUtil":318,"min-dash":594}],317:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=SnapContext,exports.SnapPoints=SnapPoints;var _minDash=require("min-dash"),_SnapUtil=require("./SnapUtil");function SnapContext(){this._targets={},this._snapOrigins={},this._snapLocations=[],this._defaultSnaps={}}function SnapPoints(defaultSnaps){this._snapValues={}}SnapContext.prototype.getSnapOrigin=function(snapLocation){return this._snapOrigins[snapLocation]},SnapContext.prototype.setSnapOrigin=function(snapLocation,initialValue){this._snapOrigins[snapLocation]=initialValue,-1===this._snapLocations.indexOf(snapLocation)&&this._snapLocations.push(snapLocation)},SnapContext.prototype.addDefaultSnap=function(type,point){(this._defaultSnaps[type]||(this._defaultSnaps[type]=[])).push(point)},SnapContext.prototype.getSnapLocations=function(){return this._snapLocations},SnapContext.prototype.setSnapLocations=function(snapLocations){this._snapLocations=snapLocations},SnapContext.prototype.pointsForTarget=function(target){var targetId=target.id||target,snapPoints=this._targets[targetId];return snapPoints||(snapPoints=this._targets[targetId]=new SnapPoints).initDefaults(this._defaultSnaps),snapPoints},SnapPoints.prototype.add=function(snapLocation,point){var snapValues=this._snapValues[snapLocation];-1===(snapValues=snapValues||(this._snapValues[snapLocation]={x:[],y:[]})).x.indexOf(point.x)&&snapValues.x.push(point.x),-1===snapValues.y.indexOf(point.y)&&snapValues.y.push(point.y)},SnapPoints.prototype.snap=function(point,snapLocation,axis,tolerance){var snappingValues=this._snapValues[snapLocation];return snappingValues&&(0,_SnapUtil.snapTo)(point[axis],snappingValues[axis],tolerance)},SnapPoints.prototype.initDefaults=function(defaultSnaps){var self=this;(0,_minDash.forEach)(defaultSnaps||{},function(snapPoints,snapLocation){(0,_minDash.forEach)(snapPoints,function(point){self.add(snapLocation,point)})})}},{"./SnapUtil":318,"min-dash":594}],318:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.snapTo=function(value,values,tolerance){var idx,snapValue;for(tolerance=void 0===tolerance?10:tolerance,idx=0;idx<values.length;idx++)if(snapValue=values[idx],abs(snapValue-value)<=tolerance)return snapValue},exports.topLeft=function(bounds){return{x:bounds.x,y:bounds.y}},exports.topRight=function(bounds){return{x:bounds.x+bounds.width,y:bounds.y}},exports.bottomLeft=function(bounds){return{x:bounds.x,y:bounds.y+bounds.height}},exports.bottomRight=function(bounds){return{x:bounds.x+bounds.width,y:bounds.y+bounds.height}},exports.mid=function(bounds,defaultValue){if(!bounds||isNaN(bounds.x)||isNaN(bounds.y))return defaultValue;return{x:round(bounds.x+bounds.width/2),y:round(bounds.y+bounds.height/2)}},exports.isSnapped=function(event,axis){var snapped=event.snapped;return!!snapped&&("string"!=typeof axis?snapped.x&&snapped.y:snapped[axis])},exports.setSnapped=function(event,axis,value){if("string"!=typeof axis)throw new Error("axis must be in [x, y]");if("number"!=typeof value&&!1!==value)throw new Error("value must be Number or false");var delta,previousValue=event[axis],snapped=event.snapped=event.snapped||{};!1===value?snapped[axis]=!1:(snapped[axis]=!0,delta=value-previousValue,event[axis]+=delta,event["d"+axis]+=delta);return previousValue},exports.getChildren=function(parent){return parent.children||[]};var abs=Math.abs,round=Math.round},{}],319:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SNAP_LINE_HIDE_DELAY=void 0,exports.default=Snapping;var _minDash=require("min-dash"),_SnapUtil=require("./SnapUtil"),_tinySvg=require("tiny-svg"),SNAP_LINE_HIDE_DELAY=exports.SNAP_LINE_HIDE_DELAY=1e3;function Snapping(canvas){this._canvas=canvas,this._asyncHide=(0,_minDash.debounce)((0,_minDash.bind)(this.hide,this),SNAP_LINE_HIDE_DELAY)}Snapping.$inject=["canvas"],Snapping.prototype.snap=function(event,snapPoints){var snapContext=event.context.snapContext,snapLocations=snapContext.getSnapLocations(),snapping={x:(0,_SnapUtil.isSnapped)(event,"x"),y:(0,_SnapUtil.isSnapped)(event,"y")};(0,_minDash.forEach)(snapLocations,function(location){var snapOrigin=snapContext.getSnapOrigin(location),snapCurrent={x:event.x+snapOrigin.x,y:event.y+snapOrigin.y};if((0,_minDash.forEach)(["x","y"],function(axis){var locationSnapping;snapping[axis]||void 0!==(locationSnapping=snapPoints.snap(snapCurrent,location,axis,7))&&(snapping[axis]={value:locationSnapping,originValue:locationSnapping-snapOrigin[axis]})}),snapping.x&&snapping.y)return!1}),this.showSnapLine("vertical",snapping.x&&snapping.x.value),this.showSnapLine("horizontal",snapping.y&&snapping.y.value),(0,_minDash.forEach)(["x","y"],function(axis){var axisSnapping=snapping[axis];(0,_minDash.isObject)(axisSnapping)&&(0,_SnapUtil.setSnapped)(event,axis,axisSnapping.originValue)})},Snapping.prototype._createLine=function(orientation){var root=this._canvas.getLayer("snap"),line=(0,_tinySvg.create)("path");return(0,_tinySvg.attr)(line,{d:"M0,0 L0,0"}),(0,_tinySvg.classes)(line).add("djs-snap-line"),(0,_tinySvg.append)(root,line),{update:function(position){(0,_minDash.isNumber)(position)?"horizontal"===orientation?(0,_tinySvg.attr)(line,{d:"M-100000,"+position+" L+100000,"+position,display:""}):(0,_tinySvg.attr)(line,{d:"M "+position+",-100000 L "+position+", +100000",display:""}):(0,_tinySvg.attr)(line,{display:"none"})}}},Snapping.prototype._createSnapLines=function(){this._snapLines={horizontal:this._createLine("horizontal"),vertical:this._createLine("vertical")}},Snapping.prototype.showSnapLine=function(orientation,position){var line=this.getSnapLine(orientation);line&&line.update(position),this._asyncHide()},Snapping.prototype.getSnapLine=function(orientation){return this._snapLines||this._createSnapLines(),this._snapLines[orientation]},Snapping.prototype.hide=function(){(0,_minDash.forEach)(this._snapLines,function(snapLine){snapLine.update()})}},{"./SnapUtil":318,"min-dash":594,"tiny-svg":606}],320:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _CreateMoveSnapping2=_interopRequireDefault(require("./CreateMoveSnapping")),_ResizeSnapping2=_interopRequireDefault(require("./ResizeSnapping")),_Snapping2=_interopRequireDefault(require("./Snapping"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__init__:["createMoveSnapping","resizeSnapping","snapping"],createMoveSnapping:["type",_CreateMoveSnapping2.default],resizeSnapping:["type",_ResizeSnapping2.default],snapping:["type",_Snapping2.default]}},{"./CreateMoveSnapping":315,"./ResizeSnapping":316,"./Snapping":319}],321:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=SpaceTool;var _minDash=require("min-dash"),_LayoutUtil=require("../../layout/LayoutUtil"),_Elements=require("../../util/Elements"),_SpaceUtil=require("./SpaceUtil"),_Mouse=require("../../util/Mouse"),_Cursor=require("../../util/Cursor"),abs=Math.abs,round=Math.round,AXIS_TO_DIMENSION={x:"width",y:"height"},DIRECTION_TO_TRBL={n:"top",w:"left",s:"bottom",e:"right"},HIGH_PRIORITY=1500,DIRECTION_TO_OPPOSITE={n:"s",w:"e",s:"n",e:"w"},PADDING=20;function SpaceTool(canvas,dragging,eventBus,modeling,rules,toolManager){this._canvas=canvas,this._dragging=dragging,this._eventBus=eventBus,this._modeling=modeling,this._rules=rules,this._toolManager=toolManager;var self=this;toolManager.registerTool("space",{tool:"spaceTool.selection",dragging:"spaceTool"}),eventBus.on("spaceTool.selection.end",function(event){eventBus.once("spaceTool.selection.ended",function(){self.activateMakeSpace(event.originalEvent)})}),eventBus.on("spaceTool.move",HIGH_PRIORITY,function(event){var context=event.context;(context.initialized||(context.initialized=self.init(event,context)))&&ensureConstraints(event)}),eventBus.on("spaceTool.end",function(event){var delta,context=event.context,axis=context.axis,direction=context.direction,movingShapes=context.movingShapes,resizingShapes=context.resizingShapes,start=context.start;context.initialized&&(ensureConstraints(event),(delta={x:0,y:0})[axis]=round(event["d"+axis]),self.makeSpace(movingShapes,resizingShapes,delta,direction,start),eventBus.once("spaceTool.ended",function(event){self.activateSelection(event.originalEvent,!0,!0)}))})}function addPadding(trbl){return{top:trbl.top-PADDING,right:trbl.right+PADDING,bottom:trbl.bottom+PADDING,left:trbl.left-PADDING}}function ensureConstraints(event){var x,y,spaceToolConstraints=event.context.spaceToolConstraints;spaceToolConstraints&&((0,_minDash.isNumber)(spaceToolConstraints.left)&&(x=Math.max(event.x,spaceToolConstraints.left),event.dx=event.dx+x-event.x,event.x=x),(0,_minDash.isNumber)(spaceToolConstraints.right)&&(x=Math.min(event.x,spaceToolConstraints.right),event.dx=event.dx+x-event.x,event.x=x),(0,_minDash.isNumber)(spaceToolConstraints.top)&&(y=Math.max(event.y,spaceToolConstraints.top),event.dy=event.dy+y-event.y,event.y=y),(0,_minDash.isNumber)(spaceToolConstraints.bottom)&&(y=Math.min(event.y,spaceToolConstraints.bottom),event.dy=event.dy+y-event.y,event.y=y))}function includes(array,item){return-1!==array.indexOf(item)}function isLabel(element){return element.labelTarget}SpaceTool.$inject=["canvas","dragging","eventBus","modeling","rules","toolManager"],SpaceTool.prototype.activateSelection=function(event,autoActivate,reactivate){this._dragging.init(event,"spaceTool.selection",{autoActivate:autoActivate,cursor:"crosshair",data:{context:{reactivate:reactivate}},trapClick:!1})},SpaceTool.prototype.activateMakeSpace=function(event){this._dragging.init(event,"spaceTool",{autoActivate:!0,cursor:"crosshair",data:{context:{}}})},SpaceTool.prototype.makeSpace=function(movingShapes,resizingShapes,delta,direction,start){return this._modeling.createSpace(movingShapes,resizingShapes,delta,direction,start)},SpaceTool.prototype.init=function(event,context){var axis=abs(event.dx)>abs(event.dy)?"x":"y",delta=event["d"+axis],start=event[axis]-delta;if(abs(delta)<5)return!1;delta<0&&(delta*=-1),(0,_Mouse.hasPrimaryModifier)(event)&&(delta*=-1);var direction=(0,_SpaceUtil.getDirection)(axis,delta),root=this._canvas.getRootElement(),children=(0,_Elements.selfAndAllChildren)(root,!0),elements=this.calculateAdjustments(children,axis,delta,start),spaceToolConstraints=function(elements,axis,direction,start,minDimensions){var movingShapes=elements.movingShapes,resizingShapes=elements.resizingShapes;if(!resizingShapes.length)return;var min,max,spaceToolConstraints={};return(0,_minDash.forEach)(resizingShapes,function(resizingShape){var minOrMax,nonMovingResizingChildrenBBox,movingChildrenBBox,resizingShapeBBox=(0,_LayoutUtil.asTRBL)(resizingShape),nonMovingResizingChildren=(0,_minDash.filter)(resizingShape.children,function(child){return!(child.waypoints||isLabel(child)||includes(movingShapes,child)||includes(resizingShapes,child))}),movingChildren=(0,_minDash.filter)(resizingShape.children,function(child){return!child.waypoints&&!isLabel(child)&&includes(movingShapes,child)});nonMovingResizingChildren.length&&(nonMovingResizingChildrenBBox=addPadding((0,_LayoutUtil.asTRBL)((0,_Elements.getBBox)(nonMovingResizingChildren))),minOrMax=start-resizingShapeBBox[DIRECTION_TO_TRBL[direction]]+nonMovingResizingChildrenBBox[DIRECTION_TO_TRBL[direction]],"n"===direction?spaceToolConstraints.bottom=max=(0,_minDash.isNumber)(max)?Math.min(max,minOrMax):minOrMax:"w"===direction?spaceToolConstraints.right=max=(0,_minDash.isNumber)(max)?Math.min(max,minOrMax):minOrMax:"s"===direction?spaceToolConstraints.top=min=(0,_minDash.isNumber)(min)?Math.max(min,minOrMax):minOrMax:"e"===direction&&(spaceToolConstraints.left=min=(0,_minDash.isNumber)(min)?Math.max(min,minOrMax):minOrMax)),movingChildren.length&&(movingChildrenBBox=addPadding((0,_LayoutUtil.asTRBL)((0,_Elements.getBBox)(movingChildren))),minOrMax=start-movingChildrenBBox[DIRECTION_TO_TRBL[DIRECTION_TO_OPPOSITE[direction]]]+resizingShapeBBox[DIRECTION_TO_TRBL[DIRECTION_TO_OPPOSITE[direction]]],"n"===direction?spaceToolConstraints.bottom=max=(0,_minDash.isNumber)(max)?Math.min(max,minOrMax):minOrMax:"w"===direction?spaceToolConstraints.right=max=(0,_minDash.isNumber)(max)?Math.min(max,minOrMax):minOrMax:"s"===direction?spaceToolConstraints.top=min=(0,_minDash.isNumber)(min)?Math.max(min,minOrMax):minOrMax:"e"===direction&&(spaceToolConstraints.left=min=(0,_minDash.isNumber)(min)?Math.max(min,minOrMax):minOrMax));var resizingShapeMinDimensions=minDimensions&&minDimensions[resizingShape.id];resizingShapeMinDimensions&&("n"===direction?(minOrMax=start+resizingShape[AXIS_TO_DIMENSION[axis]]-resizingShapeMinDimensions[AXIS_TO_DIMENSION[axis]],spaceToolConstraints.bottom=max=(0,_minDash.isNumber)(max)?Math.min(max,minOrMax):minOrMax):"w"===direction?(minOrMax=start+resizingShape[AXIS_TO_DIMENSION[axis]]-resizingShapeMinDimensions[AXIS_TO_DIMENSION[axis]],spaceToolConstraints.right=max=(0,_minDash.isNumber)(max)?Math.min(max,minOrMax):minOrMax):"s"===direction?(minOrMax=start-resizingShape[AXIS_TO_DIMENSION[axis]]+resizingShapeMinDimensions[AXIS_TO_DIMENSION[axis]],spaceToolConstraints.top=min=(0,_minDash.isNumber)(min)?Math.max(min,minOrMax):minOrMax):"e"===direction&&(minOrMax=start-resizingShape[AXIS_TO_DIMENSION[axis]]+resizingShapeMinDimensions[AXIS_TO_DIMENSION[axis]],spaceToolConstraints.left=min=(0,_minDash.isNumber)(min)?Math.max(min,minOrMax):minOrMax))}),spaceToolConstraints}(elements,axis,direction,start,this._eventBus.fire("spaceTool.getMinDimensions",{axis:axis,direction:direction,shapes:elements.resizingShapes,start:start}));return(0,_minDash.assign)(context,elements,{axis:axis,direction:direction,spaceToolConstraints:spaceToolConstraints,start:start}),(0,_Cursor.set)("resize-"+("x"==axis?"ew":"ns")),!0},SpaceTool.prototype.calculateAdjustments=function(elements,axis,delta,start){var rules=this._rules,movingShapes=[],resizingShapes=[];return(0,_minDash.forEach)(elements,function(element){if(element.parent&&!element.waypoints){var shapeStart=element[axis],shapeEnd=shapeStart+element[AXIS_TO_DIMENSION[axis]];return 0<delta&&start<shapeStart||delta<0&&shapeEnd<start?movingShapes.push(element):shapeStart<start&&start<shapeEnd&&rules.allowed("shape.resize",{shape:element})?resizingShapes.push(element):void 0}}),{movingShapes:movingShapes,resizingShapes:resizingShapes}},SpaceTool.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.activateSelection()},SpaceTool.prototype.isActive=function(){var context=this._dragging.context();return context&&/^spaceTool/.test(context.prefix)}},{"../../layout/LayoutUtil":336,"../../util/Cursor":350,"../../util/Elements":351,"../../util/Mouse":359,"./SpaceUtil":323,"min-dash":594}],322:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=SpaceToolPreview;var _minDash=require("min-dash"),_tinySvg=require("tiny-svg"),_SvgTransformUtil=require("../../util/SvgTransformUtil"),MARKER_DRAGGING="djs-dragging",MARKER_RESIZING="djs-resizing",LOW_PRIORITY=250,max=Math.max;function SpaceToolPreview(eventBus,elementRegistry,canvas,styles,previewSupport){function addPreviewGfx(collection,dragGroup){(0,_minDash.forEach)(collection,function(element){previewSupport.addDragger(element,dragGroup),canvas.addMarker(element,MARKER_DRAGGING)})}eventBus.on("spaceTool.selection.start",function(event){var space=canvas.getLayer("space"),context=event.context,orientation_x="M 0,-10000 L 0,10000",orientation_y="M -10000,0 L 10000,0",crosshairGroup=(0,_tinySvg.create)("g");(0,_tinySvg.attr)(crosshairGroup,styles.cls("djs-crosshair-group",["no-events"])),(0,_tinySvg.append)(space,crosshairGroup);var pathX=(0,_tinySvg.create)("path");(0,_tinySvg.attr)(pathX,"d",orientation_x),(0,_tinySvg.classes)(pathX).add("djs-crosshair"),(0,_tinySvg.append)(crosshairGroup,pathX);var pathY=(0,_tinySvg.create)("path");(0,_tinySvg.attr)(pathY,"d",orientation_y),(0,_tinySvg.classes)(pathY).add("djs-crosshair"),(0,_tinySvg.append)(crosshairGroup,pathY),context.crosshairGroup=crosshairGroup}),eventBus.on("spaceTool.selection.move",function(event){var crosshairGroup=event.context.crosshairGroup;(0,_SvgTransformUtil.translate)(crosshairGroup,event.x,event.y)}),eventBus.on("spaceTool.selection.cleanup",function(event){var crosshairGroup=event.context.crosshairGroup;crosshairGroup&&(0,_tinySvg.remove)(crosshairGroup)}),eventBus.on("spaceTool.move",LOW_PRIORITY,function(event){var spaceLayer,dragGroup,frameGroup,frames,orientation,delta,context=event.context,line=context.line,axis=context.axis,movingShapes=context.movingShapes,resizingShapes=context.resizingShapes;context.initialized&&(context.dragGroup||(spaceLayer=canvas.getLayer("space"),line=(0,_tinySvg.create)("path"),(0,_tinySvg.attr)(line,"d","M0,0 L0,0"),(0,_tinySvg.classes)(line).add("djs-crosshair"),(0,_tinySvg.append)(spaceLayer,line),context.line=line,dragGroup=(0,_tinySvg.create)("g"),(0,_tinySvg.attr)(dragGroup,styles.cls("djs-drag-group",["no-events"])),(0,_tinySvg.append)(canvas.getDefaultLayer(),dragGroup),addPreviewGfx(movingShapes,dragGroup),addPreviewGfx(context.movingConnections=elementRegistry.filter(function(element){var sourceIsMoving=!1;(0,_minDash.forEach)(movingShapes,function(shape){(0,_minDash.forEach)(shape.outgoing,function(connection){element===connection&&(sourceIsMoving=!0)})});var targetIsMoving=!1;(0,_minDash.forEach)(movingShapes,function(shape){(0,_minDash.forEach)(shape.incoming,function(connection){element===connection&&(targetIsMoving=!0)})});var sourceIsResizing=!1;(0,_minDash.forEach)(resizingShapes,function(shape){(0,_minDash.forEach)(shape.outgoing,function(connection){element===connection&&(sourceIsResizing=!0)})});var targetIsResizing=!1;return(0,_minDash.forEach)(resizingShapes,function(shape){(0,_minDash.forEach)(shape.incoming,function(connection){element===connection&&(targetIsResizing=!0)})}),element.waypoints&&(sourceIsMoving||sourceIsResizing)&&(targetIsMoving||targetIsResizing)}),dragGroup),context.dragGroup=dragGroup),context.frameGroup||(frameGroup=(0,_tinySvg.create)("g"),(0,_tinySvg.attr)(frameGroup,styles.cls("djs-frame-group",["no-events"])),(0,_tinySvg.append)(canvas.getDefaultLayer(),frameGroup),frames=[],(0,_minDash.forEach)(resizingShapes,function(shape){var frame=previewSupport.addFrame(shape,frameGroup),initialBounds=frame.getBBox();frames.push({element:frame,initialBounds:initialBounds}),canvas.addMarker(shape,MARKER_RESIZING)}),context.frameGroup=frameGroup,context.frames=frames),orientation={x:"M"+event.x+", -10000 L"+event.x+", 10000",y:"M -10000, "+event.y+" L 10000, "+event.y},(0,_tinySvg.attr)(line,{d:orientation[axis]}),((delta={x:event.dx,y:event.dy})[{x:"y",y:"x"}[context.axis]]=0,_SvgTransformUtil.translate)(context.dragGroup,delta.x,delta.y),(0,_minDash.forEach)(context.frames,function(frame){var width,height,element=frame.element,initialBounds=frame.initialBounds;"e"===context.direction?(0,_tinySvg.attr)(element,{width:max(initialBounds.width+delta.x,5)}):(width=max(initialBounds.width-delta.x,5),(0,_tinySvg.attr)(element,{width:width,x:initialBounds.x+initialBounds.width-width})),"s"===context.direction?(0,_tinySvg.attr)(element,{height:max(initialBounds.height+delta.y,5)}):(height=max(initialBounds.height-delta.y,5),(0,_tinySvg.attr)(element,{height:height,y:initialBounds.y+initialBounds.height-height}))}))}),eventBus.on("spaceTool.cleanup",function(event){var context=event.context,movingShapes=context.movingShapes,movingConnections=context.movingConnections,resizingShapes=context.resizingShapes,line=context.line,dragGroup=context.dragGroup,frameGroup=context.frameGroup;(0,_minDash.forEach)(movingShapes,function(shape){canvas.removeMarker(shape,MARKER_DRAGGING)}),(0,_minDash.forEach)(movingConnections,function(connection){canvas.removeMarker(connection,MARKER_DRAGGING)}),dragGroup&&((0,_tinySvg.remove)(line),(0,_tinySvg.remove)(dragGroup)),(0,_minDash.forEach)(resizingShapes,function(shape){canvas.removeMarker(shape,MARKER_RESIZING)}),frameGroup&&(0,_tinySvg.remove)(frameGroup)})}SpaceToolPreview.$inject=["eventBus","elementRegistry","canvas","styles","previewSupport"]},{"../../util/SvgTransformUtil":364,"min-dash":594,"tiny-svg":606}],323:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getDirection=function(axis,delta){if("x"===axis){if(0<delta)return"e";if(delta<0)return"w"}if("y"===axis){if(0<delta)return"s";if(delta<0)return"n"}return null},exports.getWaypointsUpdatingConnections=function(movingShapes,resizingShapes){var waypointsUpdatingConnections=[];return(0,_minDash.forEach)(movingShapes.concat(resizingShapes),function(shape){var incoming=shape.incoming,outgoing=shape.outgoing;(0,_minDash.forEach)(incoming.concat(outgoing),function(connection){var source=connection.source,target=connection.target;(includes(movingShapes,source)||includes(movingShapes,target)||includes(resizingShapes,source)||includes(resizingShapes,target))&&(includes(waypointsUpdatingConnections,connection)||waypointsUpdatingConnections.push(connection))})}),waypointsUpdatingConnections},exports.resizeBounds=function(bounds,direction,delta){var x=bounds.x,y=bounds.y,width=bounds.width,height=bounds.height,dx=delta.x,dy=delta.y;switch(direction){case"n":return{x:x,y:y+dy,width:width,height:height-dy};case"s":return{x:x,y:y,width:width,height:height+dy};case"w":return{x:x+dx,y:y,width:width-dx,height:height};case"e":return{x:x,y:y,width:width+dx,height:height};default:throw new Error("unknown direction: "+direction)}};var _minDash=require("min-dash");function includes(array,item){return-1!==array.indexOf(item)}},{"min-dash":594}],324:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _dragging2=_interopRequireDefault(require("../dragging")),_rules2=_interopRequireDefault(require("../rules")),_toolManager2=_interopRequireDefault(require("../tool-manager")),_previewSupport2=_interopRequireDefault(require("../preview-support")),_SpaceTool2=_interopRequireDefault(require("./SpaceTool")),_SpaceToolPreview2=_interopRequireDefault(require("./SpaceToolPreview"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__init__:["spaceToolPreview"],__depends__:[_dragging2.default,_rules2.default,_toolManager2.default,_previewSupport2.default],spaceTool:["type",_SpaceTool2.default],spaceToolPreview:["type",_SpaceToolPreview2.default]}},{"../dragging":233,"../preview-support":298,"../rules":308,"../tool-manager":326,"./SpaceTool":321,"./SpaceToolPreview":322}],325:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ToolManager;var _minDash=require("min-dash"),_minDom=require("min-dom");function ToolManager(eventBus,dragging){this._eventBus=eventBus,this._dragging=dragging,this._tools=[],this._active=null}ToolManager.$inject=["eventBus","dragging"],ToolManager.prototype.registerTool=function(name,events){var tools=this._tools;if(!events)throw new Error('A tool has to be registered with it\'s "events"');tools.push(name),this.bindEvents(name,events)},ToolManager.prototype.isActive=function(tool){return tool&&this._active===tool},ToolManager.prototype.length=function(tool){return this._tools.length},ToolManager.prototype.setActive=function(tool){var eventBus=this._eventBus;this._active!==tool&&(this._active=tool,eventBus.fire("tool-manager.update",{tool:tool}))},ToolManager.prototype.bindEvents=function(name,events){var eventBus=this._eventBus,dragging=this._dragging,eventsToRegister=[];eventBus.on(events.tool+".init",function(event){return!event.context.reactivate&&this.isActive(name)?(this.setActive(null),void dragging.cancel()):void this.setActive(name)},this),(0,_minDash.forEach)(events,function(event){eventsToRegister.push(event+".ended"),eventsToRegister.push(event+".canceled")}),eventBus.on(eventsToRegister,250,function(event){var originalEvent=event.originalEvent;this._active&&(originalEvent&&(0,_minDom.closest)(originalEvent.target,'.group[data-group="tools"]')||this.setActive(null))},this)}},{"min-dash":594,"min-dom":595}],326:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _dragging2=_interopRequireDefault(require("../dragging")),_ToolManager2=_interopRequireDefault(require("./ToolManager"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_dragging2.default],__init__:["toolManager"],toolManager:["type",_ToolManager2.default]}},{"../dragging":233,"./ToolManager":325}],327:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=Tooltips;var obj,_minDash=require("min-dash"),_minDom=require("min-dom"),_IdGenerator=require("../../util/IdGenerator");var ids=new((obj=_IdGenerator)&&obj.__esModule?obj:{default:obj}).default("tt");function setVisible(el,visible){el.style.display=!1===visible?"none":""}var tooltipSelector=".djs-tooltip";function Tooltips(eventBus,canvas){var parentNode,root;this._eventBus=eventBus,this._canvas=canvas,this._ids=ids,this._tooltipDefaults={show:{minZoom:.7,maxZoom:5}},this._tooltips={},this._tooltipRoot=(parentNode=canvas.getContainer(),root=(0,_minDom.domify)('<div class="djs-tooltip-container" style="position: absolute; width: 0; height: 0;" />'),parentNode.insertBefore(root,parentNode.firstChild),root);var self=this;_minDom.delegate.bind(this._tooltipRoot,tooltipSelector,"mousedown",function(event){event.stopPropagation()}),_minDom.delegate.bind(this._tooltipRoot,tooltipSelector,"mouseover",function(event){self.trigger("mouseover",event)}),_minDom.delegate.bind(this._tooltipRoot,tooltipSelector,"mouseout",function(event){self.trigger("mouseout",event)}),this._init()}Tooltips.$inject=["eventBus","canvas"],Tooltips.prototype.add=function(tooltip){if(!tooltip.position)throw new Error("must specifiy tooltip position");if(!tooltip.html)throw new Error("must specifiy tooltip html");var id=this._ids.next();return tooltip=(0,_minDash.assign)({},this._tooltipDefaults,tooltip,{id:id}),this._addTooltip(tooltip),tooltip.timeout&&this.setTimeout(tooltip),id},Tooltips.prototype.trigger=function(action,event){var node=event.delegateTarget||event.target,tooltip=this.get((0,_minDom.attr)(node,"data-tooltip-id"));tooltip&&("mouseover"===action&&tooltip.timeout&&this.clearTimeout(tooltip),"mouseout"===action&&tooltip.timeout&&(tooltip.timeout=1e3,this.setTimeout(tooltip)))},Tooltips.prototype.get=function(id){return"string"!=typeof id&&(id=id.id),this._tooltips[id]},Tooltips.prototype.clearTimeout=function(tooltip){var removeTimer;!(tooltip=this.get(tooltip))||(removeTimer=tooltip.removeTimer)&&(clearTimeout(removeTimer),tooltip.removeTimer=null)},Tooltips.prototype.setTimeout=function(tooltip){var self;(tooltip=this.get(tooltip))&&(this.clearTimeout(tooltip),self=this,tooltip.removeTimer=setTimeout(function(){self.remove(tooltip)},tooltip.timeout))},Tooltips.prototype.remove=function(id){var tooltip=this.get(id);tooltip&&((0,_minDom.remove)(tooltip.html),(0,_minDom.remove)(tooltip.htmlContainer),delete tooltip.htmlContainer,delete this._tooltips[tooltip.id])},Tooltips.prototype.show=function(){setVisible(this._tooltipRoot)},Tooltips.prototype.hide=function(){setVisible(this._tooltipRoot,!1)},Tooltips.prototype._updateRoot=function(viewbox){var a=viewbox.scale||1,d=viewbox.scale||1,matrix="matrix("+a+",0,0,"+d+","+-1*viewbox.x*a+","+-1*viewbox.y*d+")";this._tooltipRoot.style.transform=matrix,this._tooltipRoot.style["-ms-transform"]=matrix},Tooltips.prototype._addTooltip=function(tooltip){var htmlContainer,id=tooltip.id,html=tooltip.html,tooltipRoot=this._tooltipRoot;html.get&&html.constructor.prototype.jquery&&(html=html.get(0)),(0,_minDash.isString)(html)&&(html=(0,_minDom.domify)(html)),(htmlContainer=(0,_minDom.domify)('<div data-tooltip-id="'+id+'" class="djs-tooltip" style="position: absolute">')).appendChild(html),tooltip.type&&(0,_minDom.classes)(htmlContainer).add("djs-tooltip-"+tooltip.type),tooltip.className&&(0,_minDom.classes)(htmlContainer).add(tooltip.className),tooltip.htmlContainer=htmlContainer,tooltipRoot.appendChild(htmlContainer),this._tooltips[id]=tooltip,this._updateTooltip(tooltip)},Tooltips.prototype._updateTooltip=function(tooltip){var el,x,y,position=tooltip.position,htmlContainer=tooltip.htmlContainer;el=htmlContainer,x=position.x,y=position.y,(0,_minDash.assign)(el.style,{left:x+"px",top:y+"px"})},Tooltips.prototype._updateTooltipVisibilty=function(viewbox){(0,_minDash.forEach)(this._tooltips,function(tooltip){var show=tooltip.show,htmlContainer=tooltip.htmlContainer,visible=!0;show&&((show.minZoom>viewbox.scale||show.maxZoom<viewbox.scale)&&(visible=!1),setVisible(htmlContainer,visible))})},Tooltips.prototype._init=function(){var self=this;this._eventBus.on("canvas.viewbox.changing",function(event){self.hide()}),this._eventBus.on("canvas.viewbox.changed",function(event){var viewbox;viewbox=event.viewbox,self._updateRoot(viewbox),self._updateTooltipVisibilty(viewbox),self.show()})}},{"../../util/IdGenerator":356,"min-dash":594,"min-dom":595}],328:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_Tooltips=require("./Tooltips"),_Tooltips2=(obj=_Tooltips)&&obj.__esModule?obj:{default:obj};exports.default={__init__:["tooltips"],tooltips:["type",_Tooltips2.default]}},{"./Tooltips":327}],329:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=TouchFix;var _tinySvg=require("tiny-svg");function TouchFix(canvas,eventBus){var self=this;eventBus.on("canvas.init",function(e){self.addBBoxMarker(e.svg)})}TouchFix.$inject=["canvas","eventBus"],TouchFix.prototype.addBBoxMarker=function(svg){var markerStyle={fill:"none",class:"outer-bound-marker"},rect1=(0,_tinySvg.create)("rect");(0,_tinySvg.attr)(rect1,{x:-1e4,y:1e4,width:10,height:10}),(0,_tinySvg.attr)(rect1,markerStyle),(0,_tinySvg.append)(svg,rect1);var rect2=(0,_tinySvg.create)("rect");(0,_tinySvg.attr)(rect2,{x:1e4,y:1e4,width:10,height:10}),(0,_tinySvg.attr)(rect2,markerStyle),(0,_tinySvg.append)(svg,rect2)}},{"tiny-svg":606}],330:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=TouchInteractionEvents;var obj,_minDash=require("min-dash"),_minDom=require("min-dom"),_hammerjs=require("hammerjs"),_hammerjs2=(obj=_hammerjs)&&obj.__esModule?obj:{default:obj},_Event=require("../../util/Event");var MIN_ZOOM=.2,MAX_ZOOM=4,mouseEvents=["mousedown","mouseup","mouseover","mouseout","click","dblclick"];function get(service,injector){return injector.get(service,!1)}function stopEvent(event){event.preventDefault(),"function"==typeof event.stopPropagation?event.stopPropagation():event.srcEvent&&"function"==typeof event.srcEvent.stopPropagation&&event.srcEvent.stopPropagation(),"function"==typeof event.stopImmediatePropagation&&event.stopImmediatePropagation()}function createTouchRecognizer(node){function allowMouse(event){setTimeout(function(){(0,_minDash.forEach)(mouseEvents,function(e){_minDom.event.unbind(node,e,stopEvent,!0)})},500)}_minDom.event.bind(node,"touchstart",function(event){(0,_minDash.forEach)(mouseEvents,function(e){_minDom.event.bind(node,e,stopEvent,!0)})},!0),_minDom.event.bind(node,"touchend",allowMouse,!0),_minDom.event.bind(node,"touchcancel",allowMouse,!0);var recognizer=new _hammerjs2.default.Manager(node,{inputClass:_hammerjs2.default.TouchInput,recognizers:[],domEvents:!0}),tap=new _hammerjs2.default.Tap,pan=new _hammerjs2.default.Pan({threshold:10}),press=new _hammerjs2.default.Press,pinch=new _hammerjs2.default.Pinch,doubleTap=new _hammerjs2.default.Tap({event:"doubletap",taps:2});return pinch.requireFailure(pan),pinch.requireFailure(press),recognizer.add([pan,press,pinch,doubleTap,tap]),recognizer.reset=function(force){var recognizers=this.recognizers,session=this.session;session.stopped||(recognizer.stop(force),setTimeout(function(){for(var r,i=0;r=recognizers[i];i++)r.reset(),r.state=8;session.curRecognizer=null},0))},recognizer.on("hammer.input",function(event){event.srcEvent.defaultPrevented&&recognizer.reset(!0)}),recognizer}function TouchInteractionEvents(injector,canvas,eventBus,elementRegistry,interactionEvents){var recognizer,dragging=get("dragging",injector),move=get("move",injector),contextPad=get("contextPad",injector),palette=get("palette",injector);function handler(type){return function(event){interactionEvents.fire(type,event)}}function getGfx(target){return(0,_minDom.closest)(target,"svg, .djs-element",!0)}function initEvents(svg){function startGrab(event){var lx,ly,gfx=getGfx(event.target),element=gfx&&elementRegistry.get(gfx);if(move&&canvas.getRootElement()!==element)return move.start(event,element,!0);function update(e){var dx=e.deltaX-lx,dy=e.deltaY-ly;canvas.scroll({dx:dx,dy:dy}),lx=e.deltaX,ly=e.deltaY}function end(e){recognizer.off("panmove",update),recognizer.off("panend",end),recognizer.off("pancancel",end)}ly=lx=0,recognizer.on("panmove",update),recognizer.on("panend",end),recognizer.on("pancancel",end)}(recognizer=createTouchRecognizer(svg)).on("doubletap",handler("element.dblclick")),recognizer.on("tap",handler("element.click")),recognizer.on("panstart",startGrab),recognizer.on("press",startGrab),recognizer.on("pinchstart",function(e){var zoom=canvas.zoom(),mid=e.center;function update(e){var ratio=1-(1-e.scale)/1.5,newZoom=Math.max(MIN_ZOOM,Math.min(MAX_ZOOM,ratio*zoom));canvas.zoom(newZoom,mid),stopEvent(e)}function end(e){recognizer.off("pinchmove",update),recognizer.off("pinchend",end),recognizer.off("pinchcancel",end),recognizer.reset(!0)}recognizer.on("pinchmove",update),recognizer.on("pinchend",end),recognizer.on("pinchcancel",end)})}dragging&&eventBus.on("drag.move",function(event){var position,gfx,element,originalEvent=event.originalEvent;!originalEvent||originalEvent instanceof MouseEvent||(position=(0,_Event.toPoint)(originalEvent),(element=(gfx=getGfx(document.elementFromPoint(position.x,position.y)))&&elementRegistry.get(gfx))!==event.hover&&(event.hover&&dragging.out(event),element&&(dragging.hover({element:element,gfx:gfx}),event.hover=element,event.hoverGfx=gfx)))}),contextPad&&eventBus.on("contextPad.create",function(event){var padRecognizer=createTouchRecognizer(event.pad.html);padRecognizer.on("panstart",function(event){contextPad.trigger("dragstart",event,!0)}),padRecognizer.on("press",function(event){contextPad.trigger("dragstart",event,!0)}),padRecognizer.on("tap",function(event){contextPad.trigger("click",event)})}),palette&&eventBus.on("palette.create",function(event){var padRecognizer=createTouchRecognizer(event.container);padRecognizer.on("panstart",function(event){palette.trigger("dragstart",event,!0)}),padRecognizer.on("press",function(event){palette.trigger("dragstart",event,!0)}),padRecognizer.on("tap",function(event){palette.trigger("click",event)})}),eventBus.on("canvas.init",function(event){initEvents(event.svg)})}TouchInteractionEvents.$inject=["injector","canvas","eventBus","elementRegistry","interactionEvents","touchFix"]},{"../../util/Event":353,hammerjs:383,"min-dash":594,"min-dom":595}],331:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _interactionEvents2=_interopRequireDefault(require("../interaction-events")),_TouchInteractionEvents2=_interopRequireDefault(require("./TouchInteractionEvents")),_TouchFix2=_interopRequireDefault(require("./TouchFix"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_interactionEvents2.default],__init__:["touchInteractionEvents"],touchInteractionEvents:["type",_TouchInteractionEvents2.default],touchFix:["type",_TouchFix2.default]}},{"../interaction-events":247,"./TouchFix":329,"./TouchInteractionEvents":330}],332:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_translate=require("./translate"),_translate2=(obj=_translate)&&obj.__esModule?obj:{default:obj};exports.default={translate:["value",_translate2.default]}},{"./translate":333}],333:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(template,replacements){return replacements=replacements||{},template.replace(/{([^}]+)}/g,function(_,key){return replacements[key]||"{"+key+"}"})}},{}],334:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=BaseLayouter;var _LayoutUtil=require("./LayoutUtil");function BaseLayouter(){}BaseLayouter.prototype.layoutConnection=function(connection,hints){return[(hints=hints||{}).connectionStart||(0,_LayoutUtil.getMid)(hints.source||connection.source),hints.connectionEnd||(0,_LayoutUtil.getMid)(hints.target||connection.target)]}},{"./LayoutUtil":336}],335:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=CroppingConnectionDocking;var _minDash=require("min-dash"),_LayoutUtil=require("./LayoutUtil");function dockingToPoint(docking){return(0,_minDash.assign)({original:docking.point.original||docking.point},docking.actual)}function CroppingConnectionDocking(elementRegistry,graphicsFactory){this._elementRegistry=elementRegistry,this._graphicsFactory=graphicsFactory}CroppingConnectionDocking.$inject=["elementRegistry","graphicsFactory"],CroppingConnectionDocking.prototype.getCroppedWaypoints=function(connection,source,target){source=source||connection.source,target=target||connection.target;var sourceDocking=this.getDockingPoint(connection,source,!0),targetDocking=this.getDockingPoint(connection,target),croppedWaypoints=connection.waypoints.slice(sourceDocking.idx+1,targetDocking.idx);return croppedWaypoints.unshift(dockingToPoint(sourceDocking)),croppedWaypoints.push(dockingToPoint(targetDocking)),croppedWaypoints},CroppingConnectionDocking.prototype.getDockingPoint=function(connection,shape,dockStart){var waypoints=connection.waypoints,dockingIdx=dockStart?0:waypoints.length-1,dockingPoint=waypoints[dockingIdx];return{point:dockingPoint,actual:this._getIntersection(shape,connection,dockStart)||dockingPoint,idx:dockingIdx}},CroppingConnectionDocking.prototype._getIntersection=function(shape,connection,takeFirst){var shapePath=this._getShapePath(shape),connectionPath=this._getConnectionPath(connection);return(0,_LayoutUtil.getElementLineIntersection)(shapePath,connectionPath,takeFirst)},CroppingConnectionDocking.prototype._getConnectionPath=function(connection){return this._graphicsFactory.getConnectionPath(connection)},CroppingConnectionDocking.prototype._getShapePath=function(shape){return this._graphicsFactory.getShapePath(shape)},CroppingConnectionDocking.prototype._getGfx=function(element){return this._elementRegistry.getGraphics(element)}},{"./LayoutUtil":336,"min-dash":594}],336:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.roundBounds=function(bounds){return{x:Math.round(bounds.x),y:Math.round(bounds.y),width:Math.round(bounds.width),height:Math.round(bounds.height)}},exports.roundPoint=roundPoint,exports.asTRBL=asTRBL,exports.asBounds=function(trbl){return{x:trbl.left,y:trbl.top,width:trbl.right-trbl.left,height:trbl.bottom-trbl.top}},exports.getMid=function(bounds){return roundPoint({x:bounds.x+(bounds.width||0)/2,y:bounds.y+(bounds.height||0)/2})},exports.getOrientation=function(rect,reference,padding){padding=padding||0,(0,_minDash.isObject)(padding)||(padding={x:padding,y:padding});var rectOrientation=asTRBL(rect),referenceOrientation=asTRBL(reference),top=rectOrientation.bottom+padding.y<=referenceOrientation.top,right=rectOrientation.left-padding.x>=referenceOrientation.right,bottom=rectOrientation.top-padding.y>=referenceOrientation.bottom,left=rectOrientation.right+padding.x<=referenceOrientation.left,vertical=top?"top":bottom?"bottom":null,horizontal=left?"left":right?"right":null;return horizontal&&vertical?vertical+"-"+horizontal:horizontal||vertical||"intersect"},exports.getElementLineIntersection=function(elementPath,linePath,cropStart){var intersections=getIntersections(elementPath,linePath);{if(1===intersections.length)return roundPoint(intersections[0]);if(2===intersections.length&&(0,_Geometry.pointDistance)(intersections[0],intersections[1])<1)return roundPoint(intersections[0]);if(1<intersections.length)return roundPoint((intersections=(0,_minDash.sortBy)(intersections,function(i){var distance=Math.floor(100*i.t2)||1;return distance=((distance=100-distance)<10?"0":"")+distance,i.segment2+"#"+distance}))[cropStart?0:intersections.length-1])}return null},exports.getIntersections=getIntersections,exports.filterRedundantWaypoints=function(waypoints){waypoints=waypoints.slice();var point,previousPoint,nextPoint,idx=0;for(;waypoints[idx];)point=waypoints[idx],previousPoint=waypoints[idx-1],nextPoint=waypoints[idx+1],0===(0,_Geometry.pointDistance)(point,nextPoint)||(0,_Geometry.pointsOnLine)(previousPoint,nextPoint,point)?waypoints.splice(idx,1):idx++;return waypoints};var obj,_minDash=require("min-dash"),_Geometry=require("../util/Geometry"),_pathIntersection=require("path-intersection"),_pathIntersection2=(obj=_pathIntersection)&&obj.__esModule?obj:{default:obj};function roundPoint(point){return{x:Math.round(point.x),y:Math.round(point.y)}}function asTRBL(bounds){return{top:bounds.y,right:bounds.x+(bounds.width||0),bottom:bounds.y+(bounds.height||0),left:bounds.x}}function getIntersections(a,b){return(0,_pathIntersection2.default)(a,b)}},{"../util/Geometry":354,"min-dash":594,"path-intersection":602}],337:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.connectPoints=connectPoints,exports.connectRectangles=connectRectangles,exports.repairConnection=function(source,target,start,end,waypoints,hints){(0,_minDash.isArray)(start)&&(waypoints=start,hints=end,start=(0,_LayoutUtil.getMid)(source),end=(0,_LayoutUtil.getMid)(target));hints=(0,_minDash.assign)({preferredLayouts:[]},hints),waypoints=waypoints||[];var repairedWaypoints,preferStraight=-1!==hints.preferredLayouts.indexOf("straight");if(repairedWaypoints=preferStraight&&tryLayoutStraight(source,target,start,end,hints))return repairedWaypoints;if(repairedWaypoints=hints.connectionEnd&&function(moved,other,newDocking,points){var waypoints=points.slice().reverse();return(waypoints=_tryRepairConnectionSide(moved,other,newDocking,waypoints))?waypoints.reverse():null}(target,source,end,waypoints))return repairedWaypoints;if(repairedWaypoints=hints.connectionStart&&_tryRepairConnectionSide(source,target,start,waypoints))return repairedWaypoints;return hints.connectionStart||hints.connectionEnd||!waypoints||!waypoints.length?connectRectangles(source,target,start,end,hints):waypoints},exports.tryLayoutStraight=tryLayoutStraight,exports.withoutRedundantPoints=withoutRedundantPoints;var _minDash=require("min-dash"),_LayoutUtil=require("./LayoutUtil"),_Geometry=require("../util/Geometry"),MIN_SEGMENT_LENGTH=20,POINT_ORIENTATION_PADDING=5,round=Math.round,INTERSECTION_THRESHOLD=20,ORIENTATION_THRESHOLD={"h:h":20,"v:v":20,"h:v":-10,"v:h":-10};function getSegmentBendpoints(a,b,directions){var segmentEnd,segmentDirections,targetOrientation,orientation=(0,_LayoutUtil.getOrientation)(b,a,POINT_ORIENTATION_PADDING),startDirection=directions.split(":")[0],xmid=round((b.x-a.x)/2+a.x),ymid=round((b.y-a.y)/2+a.y),layoutStraight=(targetOrientation=orientation,{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/left|right/,v:/top|bottom/}[startDirection].test(targetOrientation)),layoutHorizontal=/h|r|l/.test(startDirection),turnNextDirections=!1;return layoutStraight?(segmentEnd=layoutHorizontal?{x:xmid,y:a.y}:{x:a.x,y:ymid},segmentDirections=layoutHorizontal?"h:h":"v:v"):(segmentDirections=layoutHorizontal?"h:v":"v:h",segmentEnd=function(orientation,startDirection){return!{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/./,v:/./}[startDirection].test(orientation)}(orientation,startDirection)?layoutHorizontal?(turnNextDirections=ymid===a.y,{x:a.x+MIN_SEGMENT_LENGTH*(/l/.test(startDirection)?-1:1),y:turnNextDirections?ymid+MIN_SEGMENT_LENGTH:ymid}):{x:(turnNextDirections=xmid===a.x)?xmid+MIN_SEGMENT_LENGTH:xmid,y:a.y+MIN_SEGMENT_LENGTH*(/t/.test(startDirection)?-1:1)}:{x:xmid,y:ymid}),{waypoints:getBendpoints(a,segmentEnd,segmentDirections).concat(segmentEnd),directions:segmentDirections,turnNextDirections:turnNextDirections}}function invertDirections(directions){return directions.split(":").reverse().join(":")}function getBendpoints(a,b,directions){if(!function(directions){return directions&&/^h|v|t|r|b|l:h|v|t|r|b|l$/.test(directions)}(directions=directions||"h:h"))throw new Error("unknown directions: <"+directions+">: must be specified as <start>:<end> with start/end in { h,v,t,r,b,l }");if(isExplicitDirections(directions)){var startSegment=getSegmentBendpoints(a,b,directions),endSegment=function(a,b,directions){var invertedSegment=getSegmentBendpoints(b,a,invertDirections(directions));return{waypoints:invertedSegment.waypoints.slice().reverse(),directions:invertDirections(invertedSegment.directions),turnNextDirections:invertedSegment.turnNextDirections}}(a,b,directions),midSegment=function(startSegment,endSegment){var startDirection=startSegment.directions.split(":")[1],endDirection=endSegment.directions.split(":")[0];startSegment.turnNextDirections&&(startDirection="h"==startDirection?"v":"h"),endSegment.turnNextDirections&&(endDirection="h"==endDirection?"v":"h");var directions=startDirection+":"+endDirection;return{waypoints:getBendpoints(startSegment.waypoints[startSegment.waypoints.length-1],endSegment.waypoints[0],directions),directions:directions}}(startSegment,endSegment);return[].concat(startSegment.waypoints,midSegment.waypoints,endSegment.waypoints)}return function(a,b,directions){var xmid=round((b.x-a.x)/2+a.x),ymid=round((b.y-a.y)/2+a.y);if("h:v"===directions)return[{x:b.x,y:a.y}];if("v:h"===directions)return[{x:a.x,y:b.y}];if("h:h"===directions)return[{x:xmid,y:a.y},{x:xmid,y:b.y}];if("v:v"===directions)return[{x:a.x,y:ymid},{x:b.x,y:ymid}];throw new Error("invalid directions: can only handle varians of [hv]:[hv]")}(a,b,directions)}function connectPoints(a,b,directions){var points=getBendpoints(a,b,directions);return points.unshift(a),points.push(b),withoutRedundantPoints(points)}function connectRectangles(source,target,start,end,hints){var preferredLayouts=hints&&hints.preferredLayouts||[],preferredLayout=(0,_minDash.without)(preferredLayouts,"straight")[0]||"h:h",threshold=ORIENTATION_THRESHOLD[preferredLayout]||0,orientation=(0,_LayoutUtil.getOrientation)(source,target,threshold),directions=function(orientation,defaultLayout){if(isExplicitDirections(defaultLayout))return defaultLayout;switch(orientation){case"intersect":return"t:t";case"top":case"bottom":return"v:v";case"left":case"right":return"h:h";default:return defaultLayout}}(orientation,preferredLayout);start=start||(0,_LayoutUtil.getMid)(source),end=end||(0,_LayoutUtil.getMid)(target);var directionSplit=directions.split(":");return connectPoints(getDockingPoint(start,source,directionSplit[0],{top:"bottom",bottom:"top",left:"right",right:"left","top-left":"bottom-right","bottom-right":"top-left","top-right":"bottom-left","bottom-left":"top-right"}[orientation]),getDockingPoint(end,target,directionSplit[1],orientation),directions)}function isInRange(axis,a,b){return function(a,start,end){return start<=a&&a<=end}(a[axis],b[axis],b[axis]+b[{x:"width",y:"height"}[axis]])}function tryLayoutStraight(source,target,start,end,hints){var primaryAxis,axis={},orientation=(0,_LayoutUtil.getOrientation)(source,target);return/^(top|bottom|left|right)$/.test(orientation)?(/top|bottom/.test(orientation)&&(primaryAxis="x"),/left|right/.test(orientation)&&(primaryAxis="y"),"target"===hints.preserveDocking?isInRange(primaryAxis,end,source)?(axis[primaryAxis]=end[primaryAxis],[{x:void 0!==axis.x?axis.x:start.x,y:void 0!==axis.y?axis.y:start.y,original:{x:void 0!==axis.x?axis.x:start.x,y:void 0!==axis.y?axis.y:start.y}},{x:end.x,y:end.y}]):null:isInRange(primaryAxis,start,target)?(axis[primaryAxis]=start[primaryAxis],[{x:start.x,y:start.y},{x:void 0!==axis.x?axis.x:end.x,y:void 0!==axis.y?axis.y:end.y,original:{x:void 0!==axis.x?axis.x:end.x,y:void 0!==axis.y?axis.y:end.y}}]):null):null}function _tryRepairConnectionSide(moved,other,newDocking,points){if(function(points){return points.length<3||!(4<points.length)&&(0,_minDash.find)(points,function(p,idx){var q=points[idx-1];return q&&(0,_Geometry.pointDistance)(p,q)<3})}(points))return null;var slicedPoints,oldDocking=points[0],newPoints=points.slice();return newPoints[0]=newDocking,newPoints[1]=function(candidate,oldPeer,newPeer){switch((0,_Geometry.pointsAligned)(oldPeer,candidate)){case"v":return{x:newPeer.x,y:candidate.y};case"h":return{x:candidate.x,y:newPeer.y}}return{x:candidate.x,y:candidate.y}}(newPoints[1],oldDocking,newDocking),(slicedPoints=function(points,a,b){for(var i=points.length-2;0!==i;i--)if((0,_Geometry.pointInRect)(points[i],a,INTERSECTION_THRESHOLD)||(0,_Geometry.pointInRect)(points[i],b,INTERSECTION_THRESHOLD))return points.slice(i);return points}(newPoints,moved,other))!==newPoints&&(newPoints=_tryRepairConnectionSide(moved,other,newDocking,slicedPoints)),newPoints&&(0,_Geometry.pointsAligned)(newPoints)?null:newPoints}function isExplicitDirections(directions){return directions&&/t|r|b|l/.test(directions)}function getDockingPoint(point,rectangle,dockingDirection,targetOrientation){if("h"===dockingDirection&&(dockingDirection=/left/.test(targetOrientation)?"l":"r"),"v"===dockingDirection&&(dockingDirection=/top/.test(targetOrientation)?"t":"b"),"t"===dockingDirection)return{original:point,x:point.x,y:rectangle.y};if("r"===dockingDirection)return{original:point,x:rectangle.x+rectangle.width,y:point.y};if("b"===dockingDirection)return{original:point,x:point.x,y:rectangle.y+rectangle.height};if("l"===dockingDirection)return{original:point,x:rectangle.x,y:point.y};throw new Error("unexpected dockingDirection: <"+dockingDirection+">")}function withoutRedundantPoints(waypoints){return waypoints.reduce(function(points,p,idx){var previous=points[points.length-1],next=waypoints[idx+1];return(0,_Geometry.pointsOnLine)(previous,next,p,0)||points.push(p),points},[])}},{"../util/Geometry":354,"./LayoutUtil":336,"min-dash":594}],338:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Base=Base,exports.Shape=Shape,exports.Root=Root,exports.Label=Label,exports.Connection=Connection,exports.create=function(type,attrs){var Type=types[type];if(Type)return(0,_minDash.assign)(new Type,attrs);throw new Error("unknown type: <"+type+">")};var _minDash=require("min-dash"),_inherits2=_interopRequireDefault(require("inherits")),_objectRefs2=_interopRequireDefault(require("object-refs"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var parentRefs=new _objectRefs2.default({name:"children",enumerable:!0,collection:!0},{name:"parent"}),labelRefs=new _objectRefs2.default({name:"labels",enumerable:!0,collection:!0},{name:"labelTarget"}),attacherRefs=new _objectRefs2.default({name:"attachers",collection:!0},{name:"host"}),outgoingRefs=new _objectRefs2.default({name:"outgoing",collection:!0},{name:"source"}),incomingRefs=new _objectRefs2.default({name:"incoming",collection:!0},{name:"target"});function Base(){Object.defineProperty(this,"businessObject",{writable:!0}),Object.defineProperty(this,"label",{get:function(){return this.labels[0]},set:function(newLabel){var label=this.label,labels=this.labels;!newLabel&&label?labels.remove(label):labels.add(newLabel,0)}}),parentRefs.bind(this,"parent"),labelRefs.bind(this,"labels"),outgoingRefs.bind(this,"outgoing"),incomingRefs.bind(this,"incoming")}function Shape(){Base.call(this),parentRefs.bind(this,"children"),attacherRefs.bind(this,"host"),attacherRefs.bind(this,"attachers")}function Root(){Shape.call(this)}function Label(){Shape.call(this),labelRefs.bind(this,"labelTarget")}function Connection(){Base.call(this),outgoingRefs.bind(this,"source"),incomingRefs.bind(this,"target")}(0,_inherits2.default)(Shape,Base),(0,_inherits2.default)(Root,Shape),(0,_inherits2.default)(Label,Shape),(0,_inherits2.default)(Connection,Base);var types={connection:Connection,shape:Shape,label:Label,root:Root}},{inherits:385,"min-dash":594,"object-refs":599}],339:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=KeyboardMove;var _minDash=require("min-dash"),DEFAULT_CONFIG={moveSpeed:50,moveSpeedAccelerated:200};function KeyboardMove(config,keyboard,canvas){var self=this;this._config=(0,_minDash.assign)({},DEFAULT_CONFIG,config||{}),keyboard.addListener(function(context){var direction,event=context.keyEvent,config=self._config;if(!keyboard.isCmd(event))return;if(keyboard.isKey(["ArrowLeft","Left","ArrowUp","Up","ArrowDown","Down","ArrowRight","Right"],event)){var speed=keyboard.isShift(event)?config.moveSpeedAccelerated:config.moveSpeed;switch(event.key){case"ArrowLeft":case"Left":direction="left";break;case"ArrowUp":case"Up":direction="up";break;case"ArrowRight":case"Right":direction="right";break;case"ArrowDown":case"Down":direction="down"}return self.moveCanvas({speed:speed,direction:direction}),!0}}),this.moveCanvas=function(opts){var dx=0,dy=0,actualSpeed=opts.speed/Math.min(Math.sqrt(canvas.viewbox().scale),1);switch(opts.direction){case"left":dx=actualSpeed;break;case"up":dy=actualSpeed;break;case"right":dx=-actualSpeed;break;case"down":dy=-actualSpeed}canvas.scroll({dx:dx,dy:dy})}}KeyboardMove.$inject=["config.keyboardMove","keyboard","canvas"]},{"min-dash":594}],340:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _keyboard2=_interopRequireDefault(require("../../features/keyboard")),_KeyboardMove2=_interopRequireDefault(require("./KeyboardMove"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_keyboard2.default],__init__:["keyboardMove"],keyboardMove:["type",_KeyboardMove2.default]}},{"../../features/keyboard":253,"./KeyboardMove":339}],341:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=MoveCanvas;var _Cursor=require("../../util/Cursor"),_ClickTrap=require("../../util/ClickTrap"),_PositionUtil=require("../../util/PositionUtil"),_minDom=require("min-dom"),_Event=require("../../util/Event"),THRESHOLD=15;function MoveCanvas(eventBus,canvas){var context;function handleMove(event){var point,lastPosition,start=context.start,position=(0,_Event.toPoint)(event),delta=(0,_PositionUtil.delta)(position,start);!context.dragging&&(point=delta,Math.sqrt(Math.pow(point.x,2)+Math.pow(point.y,2))>THRESHOLD)&&(context.dragging=!0,(0,_ClickTrap.install)(eventBus),(0,_Cursor.set)("grab")),context.dragging&&(lastPosition=context.last||context.start,delta=(0,_PositionUtil.delta)(position,lastPosition),canvas.scroll({dx:delta.x,dy:delta.y}),context.last=position),event.preventDefault()}function handleEnd(event){_minDom.event.unbind(document,"mousemove",handleMove),_minDom.event.unbind(document,"mouseup",handleEnd),(context=null,_Cursor.unset)()}eventBus.on("element.mousedown",500,function(e){return function(event){if((0,_minDom.closest)(event.target,".djs-draggable"))return;if(event.button||event.ctrlKey||event.shiftKey||event.altKey)return;return context={start:(0,_Event.toPoint)(event)},_minDom.event.bind(document,"mousemove",handleMove),_minDom.event.bind(document,"mouseup",handleEnd),!0}(e.originalEvent)})}MoveCanvas.$inject=["eventBus","canvas"]},{"../../util/ClickTrap":348,"../../util/Cursor":350,"../../util/Event":353,"../../util/PositionUtil":361,"min-dom":595}],342:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_MoveCanvas=require("./MoveCanvas"),_MoveCanvas2=(obj=_MoveCanvas)&&obj.__esModule?obj:{default:obj};exports.default={__init__:["moveCanvas"],moveCanvas:["type",_MoveCanvas2.default]}},{"./MoveCanvas":341}],343:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_touch=require("../../features/touch"),_touch2=(obj=_touch)&&obj.__esModule?obj:{default:obj};exports.default={__depends__:[_touch2.default]}},{"../../features/touch":331}],344:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ZoomScroll;var _minDom=require("min-dom"),_ZoomUtil=require("./ZoomUtil"),_Math=require("../../util/Math"),_minDash=require("min-dash"),sign=Math.sign||function(n){return 0<=n?1:-1},RANGE={min:.2,max:4},DEFAULT_SCALE=.75;function ZoomScroll(config,eventBus,canvas){config=config||{},this._enabled=!1,this._canvas=canvas,this._container=canvas._container,this._handleWheel=(0,_minDash.bind)(this._handleWheel,this),this._totalDelta=0,this._scale=config.scale||DEFAULT_SCALE;var self=this;eventBus.on("canvas.init",function(e){self._init(!1!==config.enabled)})}ZoomScroll.$inject=["config.zoomScroll","eventBus","canvas"],ZoomScroll.prototype.scroll=function(delta){this._canvas.scroll(delta)},ZoomScroll.prototype.reset=function(){this._canvas.zoom("fit-viewport")},ZoomScroll.prototype.zoom=function(delta,position){var stepSize=(0,_ZoomUtil.getStepSize)(RANGE,20);this._totalDelta+=delta,.1<Math.abs(this._totalDelta)&&(this._zoom(delta,position,stepSize),this._totalDelta=0)},ZoomScroll.prototype._handleWheel=function(event){var element,isZoom,isHorizontalScroll,factor,elementRect,offset,delta;(0,_minDom.closest)(event.target,".djs-scrollable",!0)||(element=this._container,event.preventDefault(),isZoom=event.ctrlKey,isHorizontalScroll=event.shiftKey,factor=-1*this._scale,factor*=isZoom?0===event.deltaMode?.02:.32:0===event.deltaMode?1:16,isZoom?(elementRect=element.getBoundingClientRect(),offset={x:event.clientX-elementRect.left,y:event.clientY-elementRect.top},delta=Math.sqrt(Math.pow(event.deltaY,2)+Math.pow(event.deltaX,2))*sign(event.deltaY)*factor,this.zoom(delta,offset)):(delta=isHorizontalScroll?{dx:factor*event.deltaY,dy:0}:{dx:factor*event.deltaX,dy:factor*event.deltaY},this.scroll(delta)))},ZoomScroll.prototype.stepZoom=function(delta,position){var stepSize=(0,_ZoomUtil.getStepSize)(RANGE,10);this._zoom(delta,position,stepSize)},ZoomScroll.prototype._zoom=function(delta,position,stepSize){var canvas=this._canvas,direction=0<delta?1:-1,currentLinearZoomLevel=(0,_Math.log10)(canvas.zoom()),newLinearZoomLevel=Math.round(currentLinearZoomLevel/stepSize)*stepSize;newLinearZoomLevel+=stepSize*direction;var newLogZoomLevel=Math.pow(10,newLinearZoomLevel);canvas.zoom((0,_ZoomUtil.cap)(RANGE,newLogZoomLevel),position)},ZoomScroll.prototype.toggle=function(newEnabled){var element=this._container,handleWheel=this._handleWheel,oldEnabled=this._enabled;return void 0===newEnabled&&(newEnabled=!oldEnabled),oldEnabled!==newEnabled&&_minDom.event[newEnabled?"bind":"unbind"](element,"wheel",handleWheel,!1),this._enabled=newEnabled},ZoomScroll.prototype._init=function(newEnabled){this.toggle(newEnabled)}},{"../../util/Math":358,"./ZoomUtil":345,"min-dash":594,"min-dom":595}],345:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStepSize=function(range,steps){var minLinearRange=(0,_Math.log10)(range.min),maxLinearRange=(0,_Math.log10)(range.max);return(Math.abs(minLinearRange)+Math.abs(maxLinearRange))/steps},exports.cap=function(range,scale){return Math.max(range.min,Math.min(range.max,scale))};var _Math=require("../../util/Math")},{"../../util/Math":358}],346:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_ZoomScroll=require("./ZoomScroll"),_ZoomScroll2=(obj=_ZoomScroll)&&obj.__esModule?obj:{default:obj};exports.default={__init__:["zoomScroll"],zoomScroll:["type",_ZoomScroll2.default]}},{"./ZoomScroll":344}],347:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getNewAttachPoint=function(point,oldBounds,newBounds){var oldCenter=(0,_PositionUtil.center)(oldBounds),newCenter=(0,_PositionUtil.center)(newBounds),oldDelta=(0,_PositionUtil.delta)(point,oldCenter),newDelta_x=oldDelta.x*(newBounds.width/oldBounds.width),newDelta_y=oldDelta.y*(newBounds.height/oldBounds.height);return(0,_LayoutUtil.roundPoint)({x:newCenter.x+newDelta_x,y:newCenter.y+newDelta_y})},exports.getNewAttachShapeDelta=function(shape,oldBounds,newBounds){var shapeCenter=(0,_PositionUtil.center)(shape),oldCenter=(0,_PositionUtil.center)(oldBounds),newCenter=(0,_PositionUtil.center)(newBounds),shapeDelta=(0,_PositionUtil.delta)(shape,shapeCenter),oldCenterDelta=(0,_PositionUtil.delta)(shapeCenter,oldCenter),stickyPositionDelta=function(oldShapeCenter,oldBounds,newBounds){var oldTRBL=(0,_LayoutUtil.asTRBL)(oldBounds),newTRBL=(0,_LayoutUtil.asTRBL)(newBounds);if(function(oldTRBL,newTRBL){return function(oldTRBL,newTRBL){return oldTRBL.right!==newTRBL.right&&oldTRBL.left!==newTRBL.left}(oldTRBL,newTRBL)||function(oldTRBL,newTRBL){return oldTRBL.top!==newTRBL.top&&oldTRBL.bottom!==newTRBL.bottom}(oldTRBL,newTRBL)}(oldTRBL,newTRBL))return null;var stickyPositionDelta,newShapeCenter,oldOrientation=(0,_LayoutUtil.getOrientation)(oldBounds,oldShapeCenter);if("top"===oldOrientation)stickyPositionDelta={x:0,y:newTRBL.bottom-oldTRBL.bottom};else if("bottom"===oldOrientation)stickyPositionDelta={x:0,y:newTRBL.top-oldTRBL.top};else if("right"===oldOrientation)stickyPositionDelta={x:newTRBL.left-oldTRBL.left,y:0};else{if("left"!==oldOrientation)return null;stickyPositionDelta={x:newTRBL.right-oldTRBL.right,y:0}}return newShapeCenter={x:oldShapeCenter.x+stickyPositionDelta.x,y:oldShapeCenter.y+stickyPositionDelta.y},(0,_LayoutUtil.getOrientation)(newBounds,newShapeCenter)===oldOrientation?stickyPositionDelta:null}(shapeCenter,oldBounds,newBounds);if(stickyPositionDelta)return stickyPositionDelta;var newCenterDelta_x=oldCenterDelta.x*(newBounds.width/oldBounds.width),newCenterDelta_y=oldCenterDelta.y*(newBounds.height/oldBounds.height),newShapeCenter_x=newCenter.x+newCenterDelta_x,newShapeCenter_y=newCenter.y+newCenterDelta_y;return(0,_LayoutUtil.roundPoint)({x:newShapeCenter_x+shapeDelta.x-shape.x,y:newShapeCenter_y+shapeDelta.y-shape.y})};var _LayoutUtil=require("../layout/LayoutUtil"),_PositionUtil=require("./PositionUtil")},{"../layout/LayoutUtil":336,"./PositionUtil":361}],348:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.install=function(eventBus,eventName){function trap(){return!1}return eventName=eventName||"element.click",eventBus.once(eventName,TRAP_PRIORITY,trap),function(){eventBus.off(eventName,trap)}};var TRAP_PRIORITY=5e3},{}],349:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.remove=function(collection,element){if(!collection||!element)return-1;var idx=collection.indexOf(element);-1!==idx&&collection.splice(idx,1);return idx},exports.add=function(collection,element,idx){if(!collection||!element)return;"number"!=typeof idx&&(idx=-1);var currentIdx=collection.indexOf(element);if(-1!==currentIdx){if(currentIdx===idx)return;if(-1===idx)return;collection.splice(currentIdx,1)}-1!==idx?collection.splice(idx,0,element):collection.push(element)},exports.indexOf=function(collection,element){return collection&&element?collection.indexOf(element):-1}},{}],350:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.set=set,exports.unset=function(){set(null)},exports.has=function(mode){return(0,_minDom.classes)(document.body).has("djs-cursor-"+mode)};var _minDom=require("min-dom"),CURSOR_CLS_PATTERN=/^djs-cursor-.*$/;function set(mode){var classes=(0,_minDom.classes)(document.body);classes.removeMatching(CURSOR_CLS_PATTERN),mode&&classes.add("djs-cursor-"+mode)}},{"min-dom":595}],351:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getParents=function(elements){return(0,_minDash.filter)(elements,function(element){return!(0,_minDash.find)(elements,function(e){return e!==element&&function getParent(element,parent){if(!parent)return;if(element===parent)return parent;if(!element.parent)return;return getParent(element.parent,parent)}(element,e)})})},exports.add=add,exports.eachElement=eachElement,exports.selfAndChildren=selfAndChildren,exports.selfAndDirectChildren=function(elements,allowDuplicates){return selfAndChildren(elements,!allowDuplicates,1)},exports.selfAndAllChildren=function(elements,allowDuplicates){return selfAndChildren(elements,!allowDuplicates,-1)},exports.getClosure=function(elements,isTopLevel,closure){(0,_minDash.isUndefined)(isTopLevel)&&(isTopLevel=!0);(0,_minDash.isObject)(isTopLevel)&&(closure=isTopLevel,isTopLevel=!0);var allShapes=copyObject((closure=closure||{}).allShapes),allConnections=copyObject(closure.allConnections),enclosedElements=copyObject(closure.enclosedElements),enclosedConnections=copyObject(closure.enclosedConnections),topLevel=copyObject(closure.topLevel,isTopLevel&&(0,_minDash.groupBy)(elements,function(e){return e.id}));function handleConnection(c){topLevel[c.source.id]&&topLevel[c.target.id]&&(topLevel[c.id]=[c]),allShapes[c.source.id]&&allShapes[c.target.id]&&(enclosedConnections[c.id]=enclosedElements[c.id]=c),allConnections[c.id]=c}return eachElement(elements,function(element){{if(!(enclosedElements[element.id]=element).waypoints)return allShapes[element.id]=element,(0,_minDash.forEach)(element.incoming,handleConnection),(0,_minDash.forEach)(element.outgoing,handleConnection),element.children;enclosedConnections[element.id]=allConnections[element.id]=element}}),{allShapes:allShapes,allConnections:allConnections,topLevel:topLevel,enclosedConnections:enclosedConnections,enclosedElements:enclosedElements}},exports.getBBox=getBBox,exports.getEnclosedElements=function(elements,bbox){var filteredElements={};return(0,_minDash.forEach)(elements,function(element){var e=element;e.waypoints&&(e=getBBox(e)),!(0,_minDash.isNumber)(bbox.y)&&e.x>bbox.x&&(filteredElements[element.id]=element),!(0,_minDash.isNumber)(bbox.x)&&e.y>bbox.y&&(filteredElements[element.id]=element),e.x>bbox.x&&e.y>bbox.y&&(!((0,_minDash.isNumber)(bbox.width)&&(0,_minDash.isNumber)(bbox.height)&&e.width+e.x<bbox.width+bbox.x&&e.height+e.y<bbox.height+bbox.y)&&(0,_minDash.isNumber)(bbox.width)&&(0,_minDash.isNumber)(bbox.height)||(filteredElements[element.id]=element))}),filteredElements},exports.getType=function(element){if("waypoints"in element)return"connection";if("x"in element)return"shape";return"root"},exports.isFrameElement=function(element){return!(!element||!element.isFrame)};var _minDash=require("min-dash");function add(elements,e,unique){var canAdd=!unique||-1===elements.indexOf(e);return canAdd&&elements.push(e),canAdd}function eachElement(elements,fn,depth){depth=depth||0,(0,_minDash.isArray)(elements)||(elements=[elements]),(0,_minDash.forEach)(elements,function(s,i){var filter=fn(s,i,depth);(0,_minDash.isArray)(filter)&&filter.length&&eachElement(filter,fn,depth+1)})}function selfAndChildren(elements,unique,maxDepth){var result=[],processedChildren=[];return eachElement(elements,function(element,i,depth){add(result,element,unique);var children=element.children;if((-1===maxDepth||depth<maxDepth)&&children&&add(processedChildren,children,unique))return children}),result}function getBBox(elements,stopRecursion){var minX,minY,maxX,maxY;return stopRecursion=!!stopRecursion,(0,_minDash.isArray)(elements)||(elements=[elements]),(0,_minDash.forEach)(elements,function(element){var bbox=element;element.waypoints&&!stopRecursion&&(bbox=getBBox(element.waypoints,!0));var x=bbox.x,y=bbox.y,height=bbox.height||0,width=bbox.width||0;(x<minX||void 0===minX)&&(minX=x),(y<minY||void 0===minY)&&(minY=y),(maxX<x+width||void 0===maxX)&&(maxX=x+width),(maxY<y+height||void 0===maxY)&&(maxY=y+height)}),{x:minX,y:minY,height:maxY-minY,width:maxX-minX}}function copyObject(src1,src2){return(0,_minDash.assign)({},src1||{},src2||{})}},{"min-dash":594}],352:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _css=require("css.escape");Object.defineProperty(exports,"escapeCSS",{enumerable:!0,get:function(){return((obj=_css)&&obj.__esModule?obj:{default:obj}).default;var obj}}),exports.escapeHTML=function(str){return(str=""+str)&&str.replace(/[&<>"']/g,function(match){return HTML_ESCAPE_MAP[match]})};var HTML_ESCAPE_MAP={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}},{"css.escape":367}],353:[function(require,module,exports){"use strict";function __stopPropagation(event){event&&"function"==typeof event.stopPropagation&&event.stopPropagation()}function getOriginal(event){return event.originalEvent||event.srcEvent}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getOriginal=getOriginal,exports.stopPropagation=function(event,immediate){__stopPropagation(event),__stopPropagation(getOriginal(event))},exports.toPoint=function(event){event.pointers&&event.pointers.length&&(event=event.pointers[0]);event.touches&&event.touches.length&&(event=event.touches[0]);return event?{x:event.clientX,y:event.clientY}:null}},{}],354:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.pointDistance=pointDistance,exports.pointsOnLine=function(p,q,r,accuracy){void 0===accuracy&&(accuracy=5);if(!p||!q||!r)return!1;var val=(q.x-p.x)*(r.y-p.y)-(q.y-p.y)*(r.x-p.x),dist=pointDistance(p,q);return Math.abs(val/dist)<=accuracy},exports.pointsAligned=function(a,b){var points;points=(0,_minDash.isArray)(a)?a:[a,b];if(pointsAlignedHorizontally(points))return"h";if(pointsAlignedVertically(points))return"v";return!1},exports.pointsAlignedHorizontally=pointsAlignedHorizontally,exports.pointsAlignedVertically=pointsAlignedVertically,exports.pointInRect=function(p,rect,tolerance){return tolerance=tolerance||0,p.x>rect.x-tolerance&&p.y>rect.y-tolerance&&p.x<rect.x+rect.width+tolerance&&p.y<rect.y+rect.height+tolerance},exports.getMidPoint=function(p,q){return{x:Math.round(p.x+(q.x-p.x)/2),y:Math.round(p.y+(q.y-p.y)/2)}};var _minDash=require("min-dash");function pointDistance(a,b){return a&&b?Math.sqrt(Math.pow(a.x-b.x,2)+Math.pow(a.y-b.y,2)):-1}var ALIGNED_THRESHOLD=2;function pointsAlignedHorizontally(a,b){var points=(0,_minDash.isArray)(a)?a:[a,b],firstPoint=points.slice().shift();return(0,_minDash.every)(points,function(point){return Math.abs(firstPoint.y-point.y)<=ALIGNED_THRESHOLD})}function pointsAlignedVertically(a,b){var points=(0,_minDash.isArray)(a)?a:[a,b],firstPoint=points.slice().shift();return(0,_minDash.every)(points,function(point){return Math.abs(firstPoint.x-point.x)<=ALIGNED_THRESHOLD})}},{"min-dash":594}],355:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getVisual=function(gfx){return gfx.childNodes[0]},exports.getChildren=function(gfx){return gfx.parentNode.childNodes[1]}},{}],356:[function(require,module,exports){"use strict";function IdGenerator(prefix){this._counter=0,this._prefix=(prefix?prefix+"-":"")+Math.floor(1e9*Math.random())+"-"}Object.defineProperty(exports,"__esModule",{value:!0}),(exports.default=IdGenerator).prototype.next=function(){return this._prefix+ ++this._counter}},{}],357:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getApproxIntersection=function(waypoints,reference){return function(waypoints,reference){var i,w;for(i=0;w=waypoints[i];i++)if((0,_Geometry.pointDistance)(w,reference)<=INTERSECTION_THRESHOLD)return{point:waypoints[i],bendpoint:!0,index:i};return null}(waypoints,reference)||function(waypoints,reference){var idx,intersections=(0,_pathIntersection2.default)(function(center,r){var x=center.x,y=center.y;return[["M",x,y],["m",0,-r],["a",r,r,0,1,1,0,2*r],["a",r,r,0,1,1,0,-2*r],["z"]]}(reference,INTERSECTION_THRESHOLD),function(points){var segments=[];return points.forEach(function(p,idx){segments.push([0===idx?"M":"L",p.x,p.y])}),segments}(waypoints)),a=intersections[0],b=intersections[intersections.length-1];return a?a===b?{point:{x:round(a.x),y:round(a.y)},index:a.segment2}:a.segment2===b.segment2?{point:{x:round(a.x+b.x)/2,y:round(a.y+b.y)/2},index:a.segment2}:(idx=max(a.segment2,b.segment2)-1,{point:waypoints[idx],bendpoint:!0,index:idx}):null}(waypoints,reference)};var obj,_Geometry=require("./Geometry"),_pathIntersection=require("path-intersection"),_pathIntersection2=(obj=_pathIntersection)&&obj.__esModule?obj:{default:obj};var round=Math.round,max=Math.max;var INTERSECTION_THRESHOLD=10},{"./Geometry":354,"path-intersection":602}],358:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.log10=function(x){return Math.log(x)/Math.log(10)};var _PositionUtil=require("./PositionUtil");Object.defineProperty(exports,"substract",{enumerable:!0,get:function(){return _PositionUtil.delta}})},{"./PositionUtil":361}],359:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isMac=void 0;var _Platform=require("./Platform");Object.defineProperty(exports,"isMac",{enumerable:!0,get:function(){return _Platform.isMac}}),exports.isPrimaryButton=isPrimaryButton,exports.hasPrimaryModifier=function(event){var originalEvent=(0,_Event.getOriginal)(event)||event;if(!isPrimaryButton(event))return!1;return(0,_Platform.isMac)()?originalEvent.metaKey:originalEvent.ctrlKey},exports.hasSecondaryModifier=function(event){var originalEvent=(0,_Event.getOriginal)(event)||event;return isPrimaryButton(event)&&originalEvent.shiftKey};var _Event=require("./Event");function isPrimaryButton(event){return!((0,_Event.getOriginal)(event)||event).button}},{"./Event":353,"./Platform":360}],360:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isMac=function(){return/mac/i.test(navigator.platform)}},{}],361:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.center=function(bounds){return{x:bounds.x+bounds.width/2,y:bounds.y+bounds.height/2}},exports.delta=function(a,b){return{x:a.x-b.x,y:a.y-b.y}}},{}],362:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.saveClear=function(collection,removeFn){if("function"!=typeof removeFn)throw new Error("removeFn iterator must be a function");if(!collection)return;var e;for(;e=collection[0];)removeFn(e);return collection}},{}],363:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.componentsToPath=function(elements){return elements.join(",").replace(/,?([A-z]),?/g,"$1")},exports.toSVGPoints=toSVGPoints,exports.createLine=function(points,attrs){var line=(0,_tinySvg.create)("polyline");(0,_tinySvg.attr)(line,{points:toSVGPoints(points)}),attrs&&(0,_tinySvg.attr)(line,attrs);return line},exports.updateLine=function(gfx,points){return(0,_tinySvg.attr)(gfx,{points:toSVGPoints(points)}),gfx};var _tinySvg=require("tiny-svg");function toSVGPoints(points){for(var p,result="",i=0;p=points[i];i++)result+=p.x+","+p.y+" ";return result}},{"tiny-svg":606}],364:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.transform=function(gfx,x,y,angle,amount){var translate=(0,_tinySvg.createTransform)();translate.setTranslate(x,y);var rotate=(0,_tinySvg.createTransform)();rotate.setRotate(angle||0,0,0);var scale=(0,_tinySvg.createTransform)();scale.setScale(amount||1,amount||1),(0,_tinySvg.transform)(gfx,[translate,rotate,scale])},exports.translate=function(gfx,x,y){var translate=(0,_tinySvg.createTransform)();translate.setTranslate(x,y),(0,_tinySvg.transform)(gfx,translate)},exports.rotate=function(gfx,angle){var rotate=(0,_tinySvg.createTransform)();rotate.setRotate(angle,0,0),(0,_tinySvg.transform)(gfx,rotate)},exports.scale=function(gfx,amount){var scale=(0,_tinySvg.createTransform)();scale.setScale(amount,amount),(0,_tinySvg.transform)(gfx,scale)};var _tinySvg=require("tiny-svg")},{"tiny-svg":606}],365:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=Text;var _minDash=require("min-dash"),_tinySvg=require("tiny-svg"),DEFAULT_BOX_PADDING=0,DEFAULT_LABEL_SIZE={width:150,height:50};function layoutNext(lines,maxWidth,fakeText){for(var textBBox,originalLine=lines.shift(),fitLine=originalLine;;){if((textBBox=function(text,fakeText){var textBBox;fakeText.textContent=text;try{var bbox,emptyLine=""===text;return fakeText.textContent=emptyLine?"dummy":text,bbox={width:(textBBox=fakeText.getBBox()).width+2*textBBox.x,height:textBBox.height},emptyLine&&(bbox.width=0),bbox}catch(e){return{width:0,height:0}}}(fitLine,fakeText)).width=fitLine?textBBox.width:0," "===fitLine||""===fitLine||textBBox.width<Math.round(maxWidth)||fitLine.length<2)return function(lines,fitLine,originalLine,textBBox){{var remainder;fitLine.length<originalLine.length&&(remainder=originalLine.slice(fitLine.length).trim(),lines.unshift(remainder))}return{width:textBBox.width,height:textBBox.height,text:fitLine}}(lines,fitLine,originalLine,textBBox);fitLine=function(line,width,maxWidth){var length=Math.max(line.length*(maxWidth/width),1),shortenedLine=function(line,maxLength){var part,parts=line.split(/(\s|-)/g),shortenedParts=[],length=0;if(1<parts.length)for(;part=parts.shift();){if(!(part.length+length<maxLength)){"-"===part&&shortenedParts.pop();break}shortenedParts.push(part),length+=part.length}return shortenedParts.join("")}(line,length);shortenedLine=shortenedLine||line.slice(0,Math.max(Math.round(length-1),1));return shortenedLine}(fitLine,textBBox.width,maxWidth)}}function Text(config){this._config=(0,_minDash.assign)({},{size:DEFAULT_LABEL_SIZE,padding:DEFAULT_BOX_PADDING,style:{},align:"center-top"},config||{})}Text.prototype.createText=function(text,options){return this.layoutText(text,options).element},Text.prototype.getDimensions=function(text,options){return this.layoutText(text,options).dimensions},Text.prototype.layoutText=function(text,options){var box=(0,_minDash.assign)({},this._config.size,options.box),style=(0,_minDash.assign)({},this._config.style,options.style),align=function(align){var parts=align.split("-");return{horizontal:parts[0]||"center",vertical:parts[1]||"top"}}(options.align||this._config.align),padding=function(padding){return(0,_minDash.isObject)(padding)?(0,_minDash.assign)({top:0,left:0,right:0,bottom:0},padding):{top:padding,left:padding,right:padding,bottom:padding}}(void 0!==options.padding?options.padding:this._config.padding),fitBox=options.fitBox||!1,lineHeight=function(style){if("fontSize"in style&&"lineHeight"in style)return style.lineHeight*parseInt(style.fontSize,10)}(style),lines=text.split(/\r?\n/g),layouted=[],maxWidth=box.width-padding.left-padding.right,helperText=(0,_tinySvg.create)("text");(0,_tinySvg.attr)(helperText,{x:0,y:0}),(0,_tinySvg.attr)(helperText,style);var helperSvg=function(){var helperSvg=document.getElementById("helper-svg");return helperSvg||(helperSvg=(0,_tinySvg.create)("svg"),(0,_tinySvg.attr)(helperSvg,{id:"helper-svg",width:0,height:0,style:"visibility: hidden; position: fixed"}),document.body.appendChild(helperSvg)),helperSvg}();for((0,_tinySvg.append)(helperSvg,helperText);lines.length;)layouted.push(layoutNext(lines,maxWidth,helperText));"middle"===align.vertical&&(padding.top=padding.bottom=0);var totalHeight=(0,_minDash.reduce)(layouted,function(sum,line,idx){return sum+(lineHeight||line.height)},0)+padding.top+padding.bottom,maxLineWidth=(0,_minDash.reduce)(layouted,function(sum,line,idx){return line.width>sum?line.width:sum},0),y=padding.top;"middle"===align.vertical&&(y+=(box.height-totalHeight)/2),y-=(lineHeight||layouted[0].height)/4;var textElement=(0,_tinySvg.create)("text");return(0,_tinySvg.attr)(textElement,style),(0,_minDash.forEach)(layouted,function(line){var x;switch(y+=lineHeight||line.height,align.horizontal){case"left":x=padding.left;break;case"right":x=(fitBox?maxLineWidth:maxWidth)-padding.right-line.width;break;default:x=Math.max(((fitBox?maxLineWidth:maxWidth)-line.width)/2+padding.left,0)}var tspan=(0,_tinySvg.create)("tspan");(0,_tinySvg.attr)(tspan,{x:x,y:y}),tspan.textContent=line.text,(0,_tinySvg.append)(textElement,tspan)}),(0,_tinySvg.remove)(helperText),{dimensions:{width:maxLineWidth,height:totalHeight},element:textElement}}},{"min-dash":594,"tiny-svg":606}],366:[function(require,module,exports){"use strict";var minDash=require("min-dash"),moddle=require("moddle"),moddleXml=require("moddle-xml");function BpmnModdle(packages,options){moddle.Moddle.call(this,packages,options)}(BpmnModdle.prototype=Object.create(moddle.Moddle.prototype)).fromXML=function(xmlStr,typeName,options){minDash.isString(typeName)||(options=typeName,typeName="bpmn:Definitions");var reader=new moddleXml.Reader(minDash.assign({model:this,lax:!0},options)),rootHandler=reader.handler(typeName);return reader.fromXML(xmlStr,rootHandler)};var packages={bpmn:{name:"BPMN20",uri:"http://www.omg.org/spec/BPMN/20100524/MODEL",prefix:"bpmn",associations:[],types:[{name:"Interface",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"operations",type:"Operation",isMany:!0},{name:"implementationRef",isAttr:!0,type:"String"}]},{name:"Operation",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"inMessageRef",type:"Message",isReference:!0},{name:"outMessageRef",type:"Message",isReference:!0},{name:"errorRef",type:"Error",isMany:!0,isReference:!0},{name:"implementationRef",isAttr:!0,type:"String"}]},{name:"EndPoint",superClass:["RootElement"]},{name:"Auditing",superClass:["BaseElement"]},{name:"GlobalTask",superClass:["CallableElement"],properties:[{name:"resources",type:"ResourceRole",isMany:!0}]},{name:"Monitoring",superClass:["BaseElement"]},{name:"Performer",superClass:["ResourceRole"]},{name:"Process",superClass:["FlowElementsContainer","CallableElement"],properties:[{name:"processType",type:"ProcessType",isAttr:!0},{name:"isClosed",isAttr:!0,type:"Boolean"},{name:"auditing",type:"Auditing"},{name:"monitoring",type:"Monitoring"},{name:"properties",type:"Property",isMany:!0},{name:"laneSets",isMany:!0,replaces:"FlowElementsContainer#laneSets",type:"LaneSet"},{name:"flowElements",isMany:!0,replaces:"FlowElementsContainer#flowElements",type:"FlowElement"},{name:"artifacts",type:"Artifact",isMany:!0},{name:"resources",type:"ResourceRole",isMany:!0},{name:"correlationSubscriptions",type:"CorrelationSubscription",isMany:!0},{name:"supports",type:"Process",isMany:!0,isReference:!0},{name:"definitionalCollaborationRef",type:"Collaboration",isAttr:!0,isReference:!0},{name:"isExecutable",isAttr:!0,type:"Boolean"}]},{name:"LaneSet",superClass:["BaseElement"],properties:[{name:"lanes",type:"Lane",isMany:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Lane",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"partitionElementRef",type:"BaseElement",isAttr:!0,isReference:!0},{name:"partitionElement",type:"BaseElement"},{name:"flowNodeRef",type:"FlowNode",isMany:!0,isReference:!0},{name:"childLaneSet",type:"LaneSet",xml:{serialize:"xsi:type"}}]},{name:"GlobalManualTask",superClass:["GlobalTask"]},{name:"ManualTask",superClass:["Task"]},{name:"UserTask",superClass:["Task"],properties:[{name:"renderings",type:"Rendering",isMany:!0},{name:"implementation",isAttr:!0,type:"String"}]},{name:"Rendering",superClass:["BaseElement"]},{name:"HumanPerformer",superClass:["Performer"]},{name:"PotentialOwner",superClass:["HumanPerformer"]},{name:"GlobalUserTask",superClass:["GlobalTask"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"renderings",type:"Rendering",isMany:!0}]},{name:"Gateway",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"gatewayDirection",type:"GatewayDirection",default:"Unspecified",isAttr:!0}]},{name:"EventBasedGateway",superClass:["Gateway"],properties:[{name:"instantiate",default:!(BpmnModdle.prototype.toXML=function(element,options){var writer=new moddleXml.Writer(options);return new Promise(function(resolve,reject){try{return resolve({xml:writer.toXML(element)})}catch(err){return reject(err)}})}),isAttr:!0,type:"Boolean"},{name:"eventGatewayType",type:"EventBasedGatewayType",isAttr:!0,default:"Exclusive"}]},{name:"ComplexGateway",superClass:["Gateway"],properties:[{name:"activationCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"ExclusiveGateway",superClass:["Gateway"],properties:[{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"InclusiveGateway",superClass:["Gateway"],properties:[{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"ParallelGateway",superClass:["Gateway"]},{name:"RootElement",isAbstract:!0,superClass:["BaseElement"]},{name:"Relationship",superClass:["BaseElement"],properties:[{name:"type",isAttr:!0,type:"String"},{name:"direction",type:"RelationshipDirection",isAttr:!0},{name:"source",isMany:!0,isReference:!0,type:"Element"},{name:"target",isMany:!0,isReference:!0,type:"Element"}]},{name:"BaseElement",isAbstract:!0,properties:[{name:"id",isAttr:!0,type:"String",isId:!0},{name:"documentation",type:"Documentation",isMany:!0},{name:"extensionDefinitions",type:"ExtensionDefinition",isMany:!0,isReference:!0},{name:"extensionElements",type:"ExtensionElements"}]},{name:"Extension",properties:[{name:"mustUnderstand",default:!1,isAttr:!0,type:"Boolean"},{name:"definition",type:"ExtensionDefinition",isAttr:!0,isReference:!0}]},{name:"ExtensionDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"extensionAttributeDefinitions",type:"ExtensionAttributeDefinition",isMany:!0}]},{name:"ExtensionAttributeDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"type",isAttr:!0,type:"String"},{name:"isReference",default:!1,isAttr:!0,type:"Boolean"},{name:"extensionDefinition",type:"ExtensionDefinition",isAttr:!0,isReference:!0}]},{name:"ExtensionElements",properties:[{name:"valueRef",isAttr:!0,isReference:!0,type:"Element"},{name:"values",type:"Element",isMany:!0},{name:"extensionAttributeDefinition",type:"ExtensionAttributeDefinition",isAttr:!0,isReference:!0}]},{name:"Documentation",superClass:["BaseElement"],properties:[{name:"text",type:"String",isBody:!0},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"Event",isAbstract:!0,superClass:["FlowNode","InteractionNode"],properties:[{name:"properties",type:"Property",isMany:!0}]},{name:"IntermediateCatchEvent",superClass:["CatchEvent"]},{name:"IntermediateThrowEvent",superClass:["ThrowEvent"]},{name:"EndEvent",superClass:["ThrowEvent"]},{name:"StartEvent",superClass:["CatchEvent"],properties:[{name:"isInterrupting",default:!0,isAttr:!0,type:"Boolean"}]},{name:"ThrowEvent",isAbstract:!0,superClass:["Event"],properties:[{name:"dataInputs",type:"DataInput",isMany:!0},{name:"dataInputAssociations",type:"DataInputAssociation",isMany:!0},{name:"inputSet",type:"InputSet"},{name:"eventDefinitions",type:"EventDefinition",isMany:!0},{name:"eventDefinitionRef",type:"EventDefinition",isMany:!0,isReference:!0}]},{name:"CatchEvent",isAbstract:!0,superClass:["Event"],properties:[{name:"parallelMultiple",isAttr:!0,type:"Boolean",default:!1},{name:"dataOutputs",type:"DataOutput",isMany:!0},{name:"dataOutputAssociations",type:"DataOutputAssociation",isMany:!0},{name:"outputSet",type:"OutputSet"},{name:"eventDefinitions",type:"EventDefinition",isMany:!0},{name:"eventDefinitionRef",type:"EventDefinition",isMany:!0,isReference:!0}]},{name:"BoundaryEvent",superClass:["CatchEvent"],properties:[{name:"cancelActivity",default:!0,isAttr:!0,type:"Boolean"},{name:"attachedToRef",type:"Activity",isAttr:!0,isReference:!0}]},{name:"EventDefinition",isAbstract:!0,superClass:["RootElement"]},{name:"CancelEventDefinition",superClass:["EventDefinition"]},{name:"ErrorEventDefinition",superClass:["EventDefinition"],properties:[{name:"errorRef",type:"Error",isAttr:!0,isReference:!0}]},{name:"TerminateEventDefinition",superClass:["EventDefinition"]},{name:"EscalationEventDefinition",superClass:["EventDefinition"],properties:[{name:"escalationRef",type:"Escalation",isAttr:!0,isReference:!0}]},{name:"Escalation",properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"escalationCode",isAttr:!0,type:"String"}],superClass:["RootElement"]},{name:"CompensateEventDefinition",superClass:["EventDefinition"],properties:[{name:"waitForCompletion",isAttr:!0,type:"Boolean",default:!0},{name:"activityRef",type:"Activity",isAttr:!0,isReference:!0}]},{name:"TimerEventDefinition",superClass:["EventDefinition"],properties:[{name:"timeDate",type:"Expression",xml:{serialize:"xsi:type"}},{name:"timeCycle",type:"Expression",xml:{serialize:"xsi:type"}},{name:"timeDuration",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"LinkEventDefinition",superClass:["EventDefinition"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"target",type:"LinkEventDefinition",isAttr:!0,isReference:!0},{name:"source",type:"LinkEventDefinition",isMany:!0,isReference:!0}]},{name:"MessageEventDefinition",superClass:["EventDefinition"],properties:[{name:"messageRef",type:"Message",isAttr:!0,isReference:!0},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"ConditionalEventDefinition",superClass:["EventDefinition"],properties:[{name:"condition",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"SignalEventDefinition",superClass:["EventDefinition"],properties:[{name:"signalRef",type:"Signal",isAttr:!0,isReference:!0}]},{name:"Signal",superClass:["RootElement"],properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"ImplicitThrowEvent",superClass:["ThrowEvent"]},{name:"DataState",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"ItemAwareElement",superClass:["BaseElement"],properties:[{name:"itemSubjectRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"dataState",type:"DataState"}]},{name:"DataAssociation",superClass:["BaseElement"],properties:[{name:"sourceRef",type:"ItemAwareElement",isMany:!0,isReference:!0},{name:"targetRef",type:"ItemAwareElement",isReference:!0},{name:"transformation",type:"FormalExpression",xml:{serialize:"property"}},{name:"assignment",type:"Assignment",isMany:!0}]},{name:"DataInput",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"inputSetRef",type:"InputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"inputSetWithOptional",type:"InputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"inputSetWithWhileExecuting",type:"InputSet",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"DataOutput",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"outputSetRef",type:"OutputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"outputSetWithOptional",type:"OutputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"outputSetWithWhileExecuting",type:"OutputSet",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"InputSet",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"dataInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"optionalInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"whileExecutingInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"outputSetRefs",type:"OutputSet",isMany:!0,isReference:!0}]},{name:"OutputSet",superClass:["BaseElement"],properties:[{name:"dataOutputRefs",type:"DataOutput",isMany:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"inputSetRefs",type:"InputSet",isMany:!0,isReference:!0},{name:"optionalOutputRefs",type:"DataOutput",isMany:!0,isReference:!0},{name:"whileExecutingOutputRefs",type:"DataOutput",isMany:!0,isReference:!0}]},{name:"Property",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"DataInputAssociation",superClass:["DataAssociation"]},{name:"DataOutputAssociation",superClass:["DataAssociation"]},{name:"InputOutputSpecification",superClass:["BaseElement"],properties:[{name:"dataInputs",type:"DataInput",isMany:!0},{name:"dataOutputs",type:"DataOutput",isMany:!0},{name:"inputSets",type:"InputSet",isMany:!0},{name:"outputSets",type:"OutputSet",isMany:!0}]},{name:"DataObject",superClass:["FlowElement","ItemAwareElement"],properties:[{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"}]},{name:"InputOutputBinding",properties:[{name:"inputDataRef",type:"InputSet",isAttr:!0,isReference:!0},{name:"outputDataRef",type:"OutputSet",isAttr:!0,isReference:!0},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"Assignment",superClass:["BaseElement"],properties:[{name:"from",type:"Expression",xml:{serialize:"xsi:type"}},{name:"to",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"DataStore",superClass:["RootElement","ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"capacity",isAttr:!0,type:"Integer"},{name:"isUnlimited",default:!0,isAttr:!0,type:"Boolean"}]},{name:"DataStoreReference",superClass:["ItemAwareElement","FlowElement"],properties:[{name:"dataStoreRef",type:"DataStore",isAttr:!0,isReference:!0}]},{name:"DataObjectReference",superClass:["ItemAwareElement","FlowElement"],properties:[{name:"dataObjectRef",type:"DataObject",isAttr:!0,isReference:!0}]},{name:"ConversationLink",superClass:["BaseElement"],properties:[{name:"sourceRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"ConversationAssociation",superClass:["BaseElement"],properties:[{name:"innerConversationNodeRef",type:"ConversationNode",isAttr:!0,isReference:!0},{name:"outerConversationNodeRef",type:"ConversationNode",isAttr:!0,isReference:!0}]},{name:"CallConversation",superClass:["ConversationNode"],properties:[{name:"calledCollaborationRef",type:"Collaboration",isAttr:!0,isReference:!0},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0}]},{name:"Conversation",superClass:["ConversationNode"]},{name:"SubConversation",superClass:["ConversationNode"],properties:[{name:"conversationNodes",type:"ConversationNode",isMany:!0}]},{name:"ConversationNode",isAbstract:!0,superClass:["InteractionNode","BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0},{name:"messageFlowRefs",type:"MessageFlow",isMany:!0,isReference:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0}]},{name:"GlobalConversation",superClass:["Collaboration"]},{name:"PartnerEntity",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0}]},{name:"PartnerRole",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0}]},{name:"CorrelationProperty",superClass:["RootElement"],properties:[{name:"correlationPropertyRetrievalExpression",type:"CorrelationPropertyRetrievalExpression",isMany:!0},{name:"name",isAttr:!0,type:"String"},{name:"type",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"Error",superClass:["RootElement"],properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"errorCode",isAttr:!0,type:"String"}]},{name:"CorrelationKey",superClass:["BaseElement"],properties:[{name:"correlationPropertyRef",type:"CorrelationProperty",isMany:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Expression",superClass:["BaseElement"],isAbstract:!1,properties:[{name:"body",isBody:!0,type:"String"}]},{name:"FormalExpression",superClass:["Expression"],properties:[{name:"language",isAttr:!0,type:"String"},{name:"evaluatesToTypeRef",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"Message",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"itemRef",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"ItemDefinition",superClass:["RootElement"],properties:[{name:"itemKind",type:"ItemKind",isAttr:!0},{name:"structureRef",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"import",type:"Import",isAttr:!0,isReference:!0}]},{name:"FlowElement",isAbstract:!0,superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"auditing",type:"Auditing"},{name:"monitoring",type:"Monitoring"},{name:"categoryValueRef",type:"CategoryValue",isMany:!0,isReference:!0}]},{name:"SequenceFlow",superClass:["FlowElement"],properties:[{name:"isImmediate",isAttr:!0,type:"Boolean"},{name:"conditionExpression",type:"Expression",xml:{serialize:"xsi:type"}},{name:"sourceRef",type:"FlowNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"FlowNode",isAttr:!0,isReference:!0}]},{name:"FlowElementsContainer",isAbstract:!0,superClass:["BaseElement"],properties:[{name:"laneSets",type:"LaneSet",isMany:!0},{name:"flowElements",type:"FlowElement",isMany:!0}]},{name:"CallableElement",isAbstract:!0,superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"ioSpecification",type:"InputOutputSpecification",xml:{serialize:"property"}},{name:"supportedInterfaceRef",type:"Interface",isMany:!0,isReference:!0},{name:"ioBinding",type:"InputOutputBinding",isMany:!0,xml:{serialize:"property"}}]},{name:"FlowNode",isAbstract:!0,superClass:["FlowElement"],properties:[{name:"incoming",type:"SequenceFlow",isMany:!0,isReference:!0},{name:"outgoing",type:"SequenceFlow",isMany:!0,isReference:!0},{name:"lanes",type:"Lane",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"CorrelationPropertyRetrievalExpression",superClass:["BaseElement"],properties:[{name:"messagePath",type:"FormalExpression"},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"CorrelationPropertyBinding",superClass:["BaseElement"],properties:[{name:"dataPath",type:"FormalExpression"},{name:"correlationPropertyRef",type:"CorrelationProperty",isAttr:!0,isReference:!0}]},{name:"Resource",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"resourceParameters",type:"ResourceParameter",isMany:!0}]},{name:"ResourceParameter",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isRequired",isAttr:!0,type:"Boolean"},{name:"type",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"CorrelationSubscription",superClass:["BaseElement"],properties:[{name:"correlationKeyRef",type:"CorrelationKey",isAttr:!0,isReference:!0},{name:"correlationPropertyBinding",type:"CorrelationPropertyBinding",isMany:!0}]},{name:"MessageFlow",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"sourceRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"MessageFlowAssociation",superClass:["BaseElement"],properties:[{name:"innerMessageFlowRef",type:"MessageFlow",isAttr:!0,isReference:!0},{name:"outerMessageFlowRef",type:"MessageFlow",isAttr:!0,isReference:!0}]},{name:"InteractionNode",isAbstract:!0,properties:[{name:"incomingConversationLinks",type:"ConversationLink",isMany:!0,isVirtual:!0,isReference:!0},{name:"outgoingConversationLinks",type:"ConversationLink",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"Participant",superClass:["InteractionNode","BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"interfaceRef",type:"Interface",isMany:!0,isReference:!0},{name:"participantMultiplicity",type:"ParticipantMultiplicity"},{name:"endPointRefs",type:"EndPoint",isMany:!0,isReference:!0},{name:"processRef",type:"Process",isAttr:!0,isReference:!0}]},{name:"ParticipantAssociation",superClass:["BaseElement"],properties:[{name:"innerParticipantRef",type:"Participant",isAttr:!0,isReference:!0},{name:"outerParticipantRef",type:"Participant",isAttr:!0,isReference:!0}]},{name:"ParticipantMultiplicity",properties:[{name:"minimum",default:0,isAttr:!0,type:"Integer"},{name:"maximum",default:1,isAttr:!0,type:"Integer"}],superClass:["BaseElement"]},{name:"Collaboration",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isClosed",isAttr:!0,type:"Boolean"},{name:"participants",type:"Participant",isMany:!0},{name:"messageFlows",type:"MessageFlow",isMany:!0},{name:"artifacts",type:"Artifact",isMany:!0},{name:"conversations",type:"ConversationNode",isMany:!0},{name:"conversationAssociations",type:"ConversationAssociation"},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0},{name:"messageFlowAssociations",type:"MessageFlowAssociation",isMany:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0},{name:"choreographyRef",type:"Choreography",isMany:!0,isReference:!0},{name:"conversationLinks",type:"ConversationLink",isMany:!0}]},{name:"ChoreographyActivity",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"participantRef",type:"Participant",isMany:!0,isReference:!0},{name:"initiatingParticipantRef",type:"Participant",isAttr:!0,isReference:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0},{name:"loopType",type:"ChoreographyLoopType",default:"None",isAttr:!0}]},{name:"CallChoreography",superClass:["ChoreographyActivity"],properties:[{name:"calledChoreographyRef",type:"Choreography",isAttr:!0,isReference:!0},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0}]},{name:"SubChoreography",superClass:["ChoreographyActivity","FlowElementsContainer"],properties:[{name:"artifacts",type:"Artifact",isMany:!0}]},{name:"ChoreographyTask",superClass:["ChoreographyActivity"],properties:[{name:"messageFlowRef",type:"MessageFlow",isMany:!0,isReference:!0}]},{name:"Choreography",superClass:["Collaboration","FlowElementsContainer"]},{name:"GlobalChoreographyTask",superClass:["Choreography"],properties:[{name:"initiatingParticipantRef",type:"Participant",isAttr:!0,isReference:!0}]},{name:"TextAnnotation",superClass:["Artifact"],properties:[{name:"text",type:"String"},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"Group",superClass:["Artifact"],properties:[{name:"categoryValueRef",type:"CategoryValue",isAttr:!0,isReference:!0}]},{name:"Association",superClass:["Artifact"],properties:[{name:"associationDirection",type:"AssociationDirection",isAttr:!0},{name:"sourceRef",type:"BaseElement",isAttr:!0,isReference:!0},{name:"targetRef",type:"BaseElement",isAttr:!0,isReference:!0}]},{name:"Category",superClass:["RootElement"],properties:[{name:"categoryValue",type:"CategoryValue",isMany:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Artifact",isAbstract:!0,superClass:["BaseElement"]},{name:"CategoryValue",superClass:["BaseElement"],properties:[{name:"categorizedFlowElements",type:"FlowElement",isMany:!0,isVirtual:!0,isReference:!0},{name:"value",isAttr:!0,type:"String"}]},{name:"Activity",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"isForCompensation",default:!1,isAttr:!0,type:"Boolean"},{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0},{name:"ioSpecification",type:"InputOutputSpecification",xml:{serialize:"property"}},{name:"boundaryEventRefs",type:"BoundaryEvent",isMany:!0,isReference:!0},{name:"properties",type:"Property",isMany:!0},{name:"dataInputAssociations",type:"DataInputAssociation",isMany:!0},{name:"dataOutputAssociations",type:"DataOutputAssociation",isMany:!0},{name:"startQuantity",default:1,isAttr:!0,type:"Integer"},{name:"resources",type:"ResourceRole",isMany:!0},{name:"completionQuantity",default:1,isAttr:!0,type:"Integer"},{name:"loopCharacteristics",type:"LoopCharacteristics"}]},{name:"ServiceTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"SubProcess",superClass:["Activity","FlowElementsContainer","InteractionNode"],properties:[{name:"triggeredByEvent",default:!1,isAttr:!0,type:"Boolean"},{name:"artifacts",type:"Artifact",isMany:!0}]},{name:"LoopCharacteristics",isAbstract:!0,superClass:["BaseElement"]},{name:"MultiInstanceLoopCharacteristics",superClass:["LoopCharacteristics"],properties:[{name:"isSequential",default:!1,isAttr:!0,type:"Boolean"},{name:"behavior",type:"MultiInstanceBehavior",default:"All",isAttr:!0},{name:"loopCardinality",type:"Expression",xml:{serialize:"xsi:type"}},{name:"loopDataInputRef",type:"ItemAwareElement",isReference:!0},{name:"loopDataOutputRef",type:"ItemAwareElement",isReference:!0},{name:"inputDataItem",type:"DataInput",xml:{serialize:"property"}},{name:"outputDataItem",type:"DataOutput",xml:{serialize:"property"}},{name:"complexBehaviorDefinition",type:"ComplexBehaviorDefinition",isMany:!0},{name:"completionCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"oneBehaviorEventRef",type:"EventDefinition",isAttr:!0,isReference:!0},{name:"noneBehaviorEventRef",type:"EventDefinition",isAttr:!0,isReference:!0}]},{name:"StandardLoopCharacteristics",superClass:["LoopCharacteristics"],properties:[{name:"testBefore",default:!1,isAttr:!0,type:"Boolean"},{name:"loopCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"loopMaximum",type:"Integer",isAttr:!0}]},{name:"CallActivity",superClass:["Activity"],properties:[{name:"calledElement",type:"String",isAttr:!0}]},{name:"Task",superClass:["Activity","InteractionNode"]},{name:"SendTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"ReceiveTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"instantiate",default:!1,isAttr:!0,type:"Boolean"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"ScriptTask",superClass:["Task"],properties:[{name:"scriptFormat",isAttr:!0,type:"String"},{name:"script",type:"String"}]},{name:"BusinessRuleTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"}]},{name:"AdHocSubProcess",superClass:["SubProcess"],properties:[{name:"completionCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"ordering",type:"AdHocOrdering",isAttr:!0},{name:"cancelRemainingInstances",default:!0,isAttr:!0,type:"Boolean"}]},{name:"Transaction",superClass:["SubProcess"],properties:[{name:"protocol",isAttr:!0,type:"String"},{name:"method",isAttr:!0,type:"String"}]},{name:"GlobalScriptTask",superClass:["GlobalTask"],properties:[{name:"scriptLanguage",isAttr:!0,type:"String"},{name:"script",isAttr:!0,type:"String"}]},{name:"GlobalBusinessRuleTask",superClass:["GlobalTask"],properties:[{name:"implementation",isAttr:!0,type:"String"}]},{name:"ComplexBehaviorDefinition",superClass:["BaseElement"],properties:[{name:"condition",type:"FormalExpression"},{name:"event",type:"ImplicitThrowEvent"}]},{name:"ResourceRole",superClass:["BaseElement"],properties:[{name:"resourceRef",type:"Resource",isReference:!0},{name:"resourceParameterBindings",type:"ResourceParameterBinding",isMany:!0},{name:"resourceAssignmentExpression",type:"ResourceAssignmentExpression"},{name:"name",isAttr:!0,type:"String"}]},{name:"ResourceParameterBinding",properties:[{name:"expression",type:"Expression",xml:{serialize:"xsi:type"}},{name:"parameterRef",type:"ResourceParameter",isAttr:!0,isReference:!0}],superClass:["BaseElement"]},{name:"ResourceAssignmentExpression",properties:[{name:"expression",type:"Expression",xml:{serialize:"xsi:type"}}],superClass:["BaseElement"]},{name:"Import",properties:[{name:"importType",isAttr:!0,type:"String"},{name:"location",isAttr:!0,type:"String"},{name:"namespace",isAttr:!0,type:"String"}]},{name:"Definitions",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"targetNamespace",isAttr:!0,type:"String"},{name:"expressionLanguage",default:"http://www.w3.org/1999/XPath",isAttr:!0,type:"String"},{name:"typeLanguage",default:"http://www.w3.org/2001/XMLSchema",isAttr:!0,type:"String"},{name:"imports",type:"Import",isMany:!0},{name:"extensions",type:"Extension",isMany:!0},{name:"rootElements",type:"RootElement",isMany:!0},{name:"diagrams",isMany:!0,type:"bpmndi:BPMNDiagram"},{name:"exporter",isAttr:!0,type:"String"},{name:"relationships",type:"Relationship",isMany:!0},{name:"exporterVersion",isAttr:!0,type:"String"}]}],enumerations:[{name:"ProcessType",literalValues:[{name:"None"},{name:"Public"},{name:"Private"}]},{name:"GatewayDirection",literalValues:[{name:"Unspecified"},{name:"Converging"},{name:"Diverging"},{name:"Mixed"}]},{name:"EventBasedGatewayType",literalValues:[{name:"Parallel"},{name:"Exclusive"}]},{name:"RelationshipDirection",literalValues:[{name:"None"},{name:"Forward"},{name:"Backward"},{name:"Both"}]},{name:"ItemKind",literalValues:[{name:"Physical"},{name:"Information"}]},{name:"ChoreographyLoopType",literalValues:[{name:"None"},{name:"Standard"},{name:"MultiInstanceSequential"},{name:"MultiInstanceParallel"}]},{name:"AssociationDirection",literalValues:[{name:"None"},{name:"One"},{name:"Both"}]},{name:"MultiInstanceBehavior",literalValues:[{name:"None"},{name:"One"},{name:"All"},{name:"Complex"}]},{name:"AdHocOrdering",literalValues:[{name:"Parallel"},{name:"Sequential"}]}],xml:{tagAlias:"lowerCase",typePrefix:"t"}},bpmndi:{name:"BPMNDI",uri:"http://www.omg.org/spec/BPMN/20100524/DI",prefix:"bpmndi",types:[{name:"BPMNDiagram",properties:[{name:"plane",type:"BPMNPlane",redefines:"di:Diagram#rootElement"},{name:"labelStyle",type:"BPMNLabelStyle",isMany:!0}],superClass:["di:Diagram"]},{name:"BPMNPlane",properties:[{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"}],superClass:["di:Plane"]},{name:"BPMNShape",properties:[{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"},{name:"isHorizontal",isAttr:!0,type:"Boolean"},{name:"isExpanded",isAttr:!0,type:"Boolean"},{name:"isMarkerVisible",isAttr:!0,type:"Boolean"},{name:"label",type:"BPMNLabel"},{name:"isMessageVisible",isAttr:!0,type:"Boolean"},{name:"participantBandKind",type:"ParticipantBandKind",isAttr:!0},{name:"choreographyActivityShape",type:"BPMNShape",isAttr:!0,isReference:!0}],superClass:["di:LabeledShape"]},{name:"BPMNEdge",properties:[{name:"label",type:"BPMNLabel"},{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"},{name:"sourceElement",isAttr:!0,isReference:!0,type:"di:DiagramElement",redefines:"di:Edge#source"},{name:"targetElement",isAttr:!0,isReference:!0,type:"di:DiagramElement",redefines:"di:Edge#target"},{name:"messageVisibleKind",type:"MessageVisibleKind",isAttr:!0,default:"initiating"}],superClass:["di:LabeledEdge"]},{name:"BPMNLabel",properties:[{name:"labelStyle",type:"BPMNLabelStyle",isAttr:!0,isReference:!0,redefines:"di:DiagramElement#style"}],superClass:["di:Label"]},{name:"BPMNLabelStyle",properties:[{name:"font",type:"dc:Font"}],superClass:["di:Style"]}],enumerations:[{name:"ParticipantBandKind",literalValues:[{name:"top_initiating"},{name:"middle_initiating"},{name:"bottom_initiating"},{name:"top_non_initiating"},{name:"middle_non_initiating"},{name:"bottom_non_initiating"}]},{name:"MessageVisibleKind",literalValues:[{name:"initiating"},{name:"non_initiating"}]}],associations:[]},dc:{name:"DC",uri:"http://www.omg.org/spec/DD/20100524/DC",prefix:"dc",types:[{name:"Boolean"},{name:"Integer"},{name:"Real"},{name:"String"},{name:"Font",properties:[{name:"name",type:"String",isAttr:!0},{name:"size",type:"Real",isAttr:!0},{name:"isBold",type:"Boolean",isAttr:!0},{name:"isItalic",type:"Boolean",isAttr:!0},{name:"isUnderline",type:"Boolean",isAttr:!0},{name:"isStrikeThrough",type:"Boolean",isAttr:!0}]},{name:"Point",properties:[{name:"x",type:"Real",default:"0",isAttr:!0},{name:"y",type:"Real",default:"0",isAttr:!0}]},{name:"Bounds",properties:[{name:"x",type:"Real",default:"0",isAttr:!0},{name:"y",type:"Real",default:"0",isAttr:!0},{name:"width",type:"Real",isAttr:!0},{name:"height",type:"Real",isAttr:!0}]}],associations:[]},di:{name:"DI",uri:"http://www.omg.org/spec/DD/20100524/DI",prefix:"di",types:[{name:"DiagramElement",isAbstract:!0,properties:[{name:"id",isAttr:!0,isId:!0,type:"String"},{name:"extension",type:"Extension"},{name:"owningDiagram",type:"Diagram",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"owningElement",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"modelElement",isReadOnly:!0,isVirtual:!0,isReference:!0,type:"Element"},{name:"style",type:"Style",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"ownedElement",type:"DiagramElement",isReadOnly:!0,isMany:!0,isVirtual:!0}]},{name:"Node",isAbstract:!0,superClass:["DiagramElement"]},{name:"Edge",isAbstract:!0,superClass:["DiagramElement"],properties:[{name:"source",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"target",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"waypoint",isUnique:!1,isMany:!0,type:"dc:Point",xml:{serialize:"xsi:type"}}]},{name:"Diagram",isAbstract:!0,properties:[{name:"id",isAttr:!0,isId:!0,type:"String"},{name:"rootElement",type:"DiagramElement",isReadOnly:!0,isVirtual:!0},{name:"name",isAttr:!0,type:"String"},{name:"documentation",isAttr:!0,type:"String"},{name:"resolution",isAttr:!0,type:"Real"},{name:"ownedStyle",type:"Style",isReadOnly:!0,isMany:!0,isVirtual:!0}]},{name:"Shape",isAbstract:!0,superClass:["Node"],properties:[{name:"bounds",type:"dc:Bounds"}]},{name:"Plane",isAbstract:!0,superClass:["Node"],properties:[{name:"planeElement",type:"DiagramElement",subsettedProperty:"DiagramElement-ownedElement",isMany:!0}]},{name:"LabeledEdge",isAbstract:!0,superClass:["Edge"],properties:[{name:"ownedLabel",type:"Label",isReadOnly:!0,subsettedProperty:"DiagramElement-ownedElement",isMany:!0,isVirtual:!0}]},{name:"LabeledShape",isAbstract:!0,superClass:["Shape"],properties:[{name:"ownedLabel",type:"Label",isReadOnly:!0,subsettedProperty:"DiagramElement-ownedElement",isMany:!0,isVirtual:!0}]},{name:"Label",isAbstract:!0,superClass:["Node"],properties:[{name:"bounds",type:"dc:Bounds"}]},{name:"Style",isAbstract:!0,properties:[{name:"id",isAttr:!0,isId:!0,type:"String"}]},{name:"Extension",properties:[{name:"values",isMany:!0,type:"Element"}]}],associations:[],xml:{tagAlias:"lowerCase"}},bioc:{name:"bpmn.io colors for BPMN",uri:"http://bpmn.io/schema/bpmn/biocolor/1.0",prefix:"bioc",types:[{name:"ColoredShape",extends:["bpmndi:BPMNShape"],properties:[{name:"stroke",isAttr:!0,type:"String"},{name:"fill",isAttr:!0,type:"String"}]},{name:"ColoredEdge",extends:["bpmndi:BPMNEdge"],properties:[{name:"stroke",isAttr:!0,type:"String"},{name:"fill",isAttr:!0,type:"String"}]}],enumerations:[],associations:[]}};module.exports=function(additionalPackages,options){return new BpmnModdle(minDash.assign({},packages,additionalPackages),options)}},{"min-dash":594,moddle:598,"moddle-xml":597}],367:[function(require,module,exports){(function(global){"use strict";var root,factory,_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};root=void 0!==global?global:void 0,factory=function(root){if(root.CSS&&root.CSS.escape)return root.CSS.escape;var cssEscape=function(value){if(0==arguments.length)throw new TypeError("`CSS.escape` requires an argument.");for(var codeUnit,string=String(value),length=string.length,index=-1,result="",firstCodeUnit=string.charCodeAt(0);++index<length;)0!=(codeUnit=string.charCodeAt(index))?result+=1<=codeUnit&&codeUnit<=31||127==codeUnit||0==index&&48<=codeUnit&&codeUnit<=57||1==index&&48<=codeUnit&&codeUnit<=57&&45==firstCodeUnit?"\\"+codeUnit.toString(16)+" ":(0!=index||1!=length||45!=codeUnit)&&(128<=codeUnit||45==codeUnit||95==codeUnit||48<=codeUnit&&codeUnit<=57||65<=codeUnit&&codeUnit<=90||97<=codeUnit&&codeUnit<=122)?string.charAt(index):"\\"+string.charAt(index):result+="";return result};return root.CSS||(root.CSS={}),root.CSS.escape=cssEscape},"object"==(void 0===exports?"undefined":_typeof(exports))?module.exports=factory(root):"function"==typeof define&&define.amd?define([],factory.bind(root,root)):factory(root)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],368:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _interactionEvents2=_interopRequireDefault(require("diagram-js/lib/features/interaction-events")),_DirectEditing2=_interopRequireDefault(require("./lib/DirectEditing"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={__depends__:[_interactionEvents2.default],__init__:["directEditing"],directEditing:["type",_DirectEditing2.default]}},{"./lib/DirectEditing":369,"diagram-js/lib/features/interaction-events":374}],369:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=DirectEditing;var obj,_minDash=require("min-dash"),_TextBox=require("./TextBox"),_TextBox2=(obj=_TextBox)&&obj.__esModule?obj:{default:obj};function DirectEditing(eventBus,canvas){this._eventBus=eventBus,this._providers=[],this._textbox=new _TextBox2.default({container:canvas.getContainer(),keyHandler:(0,_minDash.bind)(this._handleKey,this),resizeHandler:(0,_minDash.bind)(this._handleResize,this)})}DirectEditing.$inject=["eventBus","canvas"],DirectEditing.prototype.registerProvider=function(provider){this._providers.push(provider)},DirectEditing.prototype.isActive=function(){return!!this._active},DirectEditing.prototype.cancel=function(){this._active&&(this._fire("cancel"),this.close())},DirectEditing.prototype._fire=function(event,context){this._eventBus.fire("directEditing."+event,context||{active:this._active})},DirectEditing.prototype.close=function(){this._textbox.destroy(),this._fire("deactivate"),this._active=null,this.resizable=void 0},DirectEditing.prototype.complete=function(){var containerBounds,previousBounds,newBounds,newText,active=this._active;active&&(previousBounds=active.context.bounds,newBounds=this.$textbox.getBoundingClientRect(),(newText=this.getValue())===active.context.text&&newBounds.height===previousBounds.height&&newBounds.width===previousBounds.width||(containerBounds=this._textbox.container.getBoundingClientRect(),active.provider.update(active.element,newText,active.context.text,{x:newBounds.left-containerBounds.left,y:newBounds.top-containerBounds.top,width:newBounds.width,height:newBounds.height})),this._fire("complete"),this.close())},DirectEditing.prototype.getValue=function(){return this._textbox.getValue()},DirectEditing.prototype._handleKey=function(e){e.stopPropagation();var key=e.keyCode||e.charCode;return 27===key?(e.preventDefault(),this.cancel()):13!==key||e.shiftKey?void 0:(e.preventDefault(),this.complete())},DirectEditing.prototype._handleResize=function(event){this._fire("resize",event)},DirectEditing.prototype.activate=function(element){var context;this.isActive()&&this.cancel();var provider=(0,_minDash.find)(this._providers,function(p){return(context=p.activate(element))?p:null});return context&&(this.$textbox=this._textbox.create(context.bounds,context.style,context.text,context.options),this._active={element:element,context:context,provider:provider},context.options&&context.options.resizable&&(this.resizable=!0),this._fire("activate")),!!context}},{"./TextBox":370,"min-dash":594}],370:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=TextBox;var _minDash=require("min-dash"),_minDom=require("min-dom"),min=Math.min,max=Math.max;function preventDefault(e){e.preventDefault()}function stopPropagation(e){e.stopPropagation()}function TextBox(options){this.container=options.container,this.parent=(0,_minDom.domify)('<div class="djs-direct-editing-parent"><div class="djs-direct-editing-content" contenteditable="true"></div></div>'),this.content=(0,_minDom.query)("[contenteditable]",this.parent),this.keyHandler=options.keyHandler||function(){},this.resizeHandler=options.resizeHandler||function(){},this.autoResize=(0,_minDash.bind)(this.autoResize,this),this.handlePaste=(0,_minDash.bind)(this.handlePaste,this)}TextBox.prototype.create=function(bounds,style,value,options){var parent=this.parent,content=this.content,container=this.container;options=this.options=options||{},style=this.style=style||{};var parentStyle=(0,_minDash.pick)(style,["width","height","maxWidth","maxHeight","minWidth","minHeight","left","top","backgroundColor","position","overflow","border","wordWrap","textAlign","outline","transform"]);(0,_minDash.assign)(parent.style,{width:bounds.width+"px",height:bounds.height+"px",maxWidth:bounds.maxWidth+"px",maxHeight:bounds.maxHeight+"px",minWidth:bounds.minWidth+"px",minHeight:bounds.minHeight+"px",left:bounds.x+"px",top:bounds.y+"px",backgroundColor:"#ffffff",position:"absolute",overflow:"visible",border:"1px solid #ccc",boxSizing:"border-box",wordWrap:"normal",textAlign:"center",outline:"none"},parentStyle);var contentStyle=(0,_minDash.pick)(style,["fontFamily","fontSize","fontWeight","lineHeight","padding","paddingTop","paddingRight","paddingBottom","paddingLeft"]);return(0,_minDash.assign)(content.style,{boxSizing:"border-box",width:"100%",outline:"none",wordWrap:"break-word"},contentStyle),options.centerVertically&&(0,_minDash.assign)(content.style,{position:"absolute",top:"50%",transform:"translate(0, -50%)"},contentStyle),content.innerText=value,_minDom.event.bind(content,"keydown",this.keyHandler),_minDom.event.bind(content,"mousedown",stopPropagation),_minDom.event.bind(content,"paste",this.handlePaste),options.autoResize&&_minDom.event.bind(content,"input",this.autoResize),options.resizable&&this.resizable(style),container.appendChild(parent),this.setSelection(content.lastChild,content.lastChild&&content.lastChild.length),parent},TextBox.prototype.handlePaste=function(e){var text,hasResized,options=this.options,style=this.style;e.preventDefault(),text=e.clipboardData?e.clipboardData.getData("text/plain"):window.clipboardData.getData("Text"),this.insertText(text),!options.autoResize||(hasResized=this.autoResize(style))&&this.resizeHandler(hasResized)},TextBox.prototype.insertText=function(text){document.execCommand("insertText",!1,text)||this._insertTextIE(text)},TextBox.prototype._insertTextIE=function(text){var nodeList,container,containerTextContent,textNode,startContainerChildIndex,endContainerChildIndex,range=this.getSelection(),startContainer=range.startContainer,endContainer=range.endContainer,startOffset=range.startOffset,endOffset=range.endOffset,commonAncestorContainer=range.commonAncestorContainer,childNodesArray=(nodeList=commonAncestorContainer.childNodes,[].slice.call(nodeList)),offset=commonAncestorContainer.nodeType===Node.TEXT_NODE?(containerTextContent=startContainer.textContent,startContainer.textContent=containerTextContent.substring(0,startOffset)+text+containerTextContent.substring(endOffset),container=startContainer,startOffset+text.length):startContainer===this.content&&endContainer===this.content?(textNode=document.createTextNode(text),this.content.insertBefore(textNode,childNodesArray[startOffset]),(container=textNode).textContent.length):(startContainerChildIndex=childNodesArray.indexOf(startContainer),endContainerChildIndex=childNodesArray.indexOf(endContainer),childNodesArray.forEach(function(childNode,index){index===startContainerChildIndex?childNode.textContent=startContainer.textContent.substring(0,startOffset)+text+endContainer.textContent.substring(endOffset):startContainerChildIndex<index&&index<=endContainerChildIndex&&(0,_minDom.remove)(childNode)}),container=startContainer,startOffset+text.length);container&&void 0!==offset&&setTimeout(function(){self.setSelection(container,offset)})},TextBox.prototype.autoResize=function(){var bounds,height,parent=this.parent,content=this.content,fontSize=parseInt(this.style.fontSize)||12;(content.scrollHeight>parent.offsetHeight||content.scrollHeight<parent.offsetHeight-fontSize)&&(bounds=parent.getBoundingClientRect(),height=content.scrollHeight,parent.style.height=height+"px",this.resizeHandler({width:bounds.width,height:bounds.height,dx:0,dy:height-bounds.height}))},TextBox.prototype.resizable=function(){var startX,startY,startWidth,startHeight,onMouseMove,onMouseUp,self=this,parent=this.parent,resizeHandle=this.resizeHandle,minWidth=parseInt(this.style.minWidth)||0,minHeight=parseInt(this.style.minHeight)||0,maxWidth=parseInt(this.style.maxWidth)||1/0,maxHeight=parseInt(this.style.maxHeight)||1/0;resizeHandle||(resizeHandle=this.resizeHandle=(0,_minDom.domify)('<div class="djs-direct-editing-resize-handle"></div>'),onMouseMove=function(e){preventDefault(e),stopPropagation(e);var newWidth=min(max(startWidth+e.clientX-startX,minWidth),maxWidth),newHeight=min(max(startHeight+e.clientY-startY,minHeight),maxHeight);parent.style.width=newWidth+"px",parent.style.height=newHeight+"px",self.resizeHandler({width:startWidth,height:startHeight,dx:e.clientX-startX,dy:e.clientY-startY})},onMouseUp=function onMouseUp(e){preventDefault(e),stopPropagation(e),_minDom.event.unbind(document,"mousemove",onMouseMove,!1),_minDom.event.unbind(document,"mouseup",onMouseUp,!1)},_minDom.event.bind(resizeHandle,"mousedown",function(e){preventDefault(e),stopPropagation(e),startX=e.clientX,startY=e.clientY;var bounds=parent.getBoundingClientRect();startWidth=bounds.width,startHeight=bounds.height,_minDom.event.bind(document,"mousemove",onMouseMove),_minDom.event.bind(document,"mouseup",onMouseUp)})),(0,_minDash.assign)(resizeHandle.style,{position:"absolute",bottom:"0px",right:"0px",cursor:"nwse-resize",width:"0",height:"0",borderTop:(parseInt(this.style.fontSize)/4||3)+"px solid transparent",borderRight:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderBottom:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderLeft:(parseInt(this.style.fontSize)/4||3)+"px solid transparent"}),parent.appendChild(resizeHandle)},TextBox.prototype.destroy=function(){var parent=this.parent,content=this.content,resizeHandle=this.resizeHandle;content.innerText="",parent.removeAttribute("style"),content.removeAttribute("style"),_minDom.event.unbind(content,"keydown",this.keyHandler),_minDom.event.unbind(content,"mousedown",stopPropagation),_minDom.event.unbind(content,"input",this.autoResize),_minDom.event.unbind(content,"paste",this.handlePaste),resizeHandle&&(resizeHandle.removeAttribute("style"),(0,_minDom.remove)(resizeHandle)),(0,_minDom.remove)(parent)},TextBox.prototype.getValue=function(){return this.content.innerText.trim()},TextBox.prototype.getSelection=function(){return window.getSelection().getRangeAt(0)},TextBox.prototype.setSelection=function(container,offset){var range=document.createRange();null===container?range.selectNodeContents(this.content):(range.setStart(container,offset),range.setEnd(container,offset));var selection=window.getSelection();selection.removeAllRanges(),selection.addRange(range)}},{"min-dash":594,"min-dom":595}],371:[function(require,module,exports){arguments[4][186][0].apply(exports,arguments)},{dup:186,"tiny-svg":606}],372:[function(require,module,exports){arguments[4][187][0].apply(exports,arguments)},{dup:187,"min-dash":594}],373:[function(require,module,exports){arguments[4][246][0].apply(exports,arguments)},{"../../util/Mouse":379,"../../util/RenderUtil":381,dup:246,"min-dash":594,"min-dom":595,"tiny-svg":606}],374:[function(require,module,exports){arguments[4][247][0].apply(exports,arguments)},{"./InteractionEvents":373,dup:247}],375:[function(require,module,exports){arguments[4][332][0].apply(exports,arguments)},{"./translate":376,dup:332}],376:[function(require,module,exports){arguments[4][333][0].apply(exports,arguments)},{dup:333}],377:[function(require,module,exports){arguments[4][349][0].apply(exports,arguments)},{dup:349}],378:[function(require,module,exports){arguments[4][353][0].apply(exports,arguments)},{dup:353}],379:[function(require,module,exports){arguments[4][359][0].apply(exports,arguments)},{"./Event":378,"./Platform":380,dup:359}],380:[function(require,module,exports){arguments[4][360][0].apply(exports,arguments)},{dup:360}],381:[function(require,module,exports){arguments[4][363][0].apply(exports,arguments)},{dup:363,"tiny-svg":606}],382:[function(require,module,exports){"use strict";var _typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};Object.defineProperty(exports,"__esModule",{value:!0});var CLASS_PATTERN=/^class /;function isArray(obj){return"[object Array]"===Object.prototype.toString.call(obj)}function annotate(){var args=Array.prototype.slice.call(arguments);1===args.length&&isArray(args[0])&&(args=args[0]);var fn=args.pop();return fn.$inject=args,fn}var CONSTRUCTOR_ARGS=/constructor\s*[^(]*\(\s*([^)]*)\)/m,FN_ARGS=/^function\s*[^(]*\(\s*([^)]*)\)/m,FN_ARG=/\/\*([^*]*)\*\//m;function parse(fn){if("function"!=typeof fn)throw new Error('Cannot annotate "'+fn+'". Expected a function!');var match=fn.toString().match(function(fn){return CLASS_PATTERN.test(fn.toString())}(fn)?CONSTRUCTOR_ARGS:FN_ARGS);return match&&match[1]&&match[1].split(",").map(function(arg){return(match=arg.match(FN_ARG))?match[1].trim():arg.trim()})||[]}function Module(){var providers=[];this.factory=function(name,factory){return providers.push([name,"factory",factory]),this},this.value=function(name,value){return providers.push([name,"value",value]),this},this.type=function(name,type){return providers.push([name,"type",type]),this},this.forEach=function(iterator){providers.forEach(iterator)}}var _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return void 0===obj?"undefined":_typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":void 0===obj?"undefined":_typeof2(obj)};function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}function hasProp(obj,prop){return Object.hasOwnProperty.call(obj,prop)}exports.annotate=annotate,exports.Module=Module,exports.Injector=function Injector(modules,parent){parent=parent||{get:function(name,strict){if(currentlyResolving.push(name),!1===strict)return null;throw error('No provider for "'+name+'"!')}};function get(name,strict){if(!providers[name]&&-1!==name.indexOf(".")){for(var parts=name.split("."),pivot=get(parts.shift());parts.length;)pivot=pivot[parts.shift()];return pivot}if(hasProp(instances,name))return instances[name];if(hasProp(providers,name)){if(-1!==currentlyResolving.indexOf(name))throw currentlyResolving.push(name),error("Cannot resolve circular dependency!");return currentlyResolving.push(name),instances[name]=providers[name][0](providers[name][1]),currentlyResolving.pop(),instances[name]}return parent.get(name,strict)}var currentlyResolving=[],providers=this._providers=Object.create(parent._providers||null),instances=this._instances=Object.create(null),self=instances.injector=this,error=function(msg){var stack=currentlyResolving.join(" -> ");return currentlyResolving.length=0,new Error(stack?msg+" (Resolving: "+stack+")":msg)},fnDef=function(fn,argument_1){var locals=1<arguments.length&&void 0!==argument_1?argument_1:{};if("function"!=typeof fn){if(!isArray(fn))throw new Error('Cannot invoke "'+fn+'". Expected a function!');fn=annotate(fn.slice())}return{fn:fn,dependencies:(fn.$inject||parse(fn)).map(function(dep){return hasProp(locals,dep)?locals[dep]:get(dep)})}},instantiate=function(Type){var _fnDef=fnDef(Type),dependencies=_fnDef.dependencies,fn=_fnDef.fn;return new(Function.prototype.bind.apply(fn,[null].concat(_toConsumableArray(dependencies))))},invoke=function(func,context,locals){var _fnDef2=fnDef(func,locals),dependencies=_fnDef2.dependencies,fn=_fnDef2.fn;return fn.call.apply(fn,[context].concat(_toConsumableArray(dependencies)))},factoryMap={factory:invoke,type:instantiate,value:function(_value){return _value}};modules.forEach(function(module){function arrayUnwrap(type,value){return"value"!==type&&isArray(value)&&(value=annotate(value.slice())),value}var clonedModule,privateInjector,getFromPrivateInjector;module instanceof Module?module.forEach(function(provider){var name=provider[0],type=provider[1],value=provider[2];providers[name]=[factoryMap[type],arrayUnwrap(type,value),type]}):"object"===(void 0===module?"undefined":_typeof(module))&&(module.__exports__?(clonedModule=Object.keys(module).reduce(function(m,key){return"__"!==key.substring(0,2)&&(m[key]=module[key]),m},Object.create(null)),privateInjector=new Injector((module.__modules__||[]).concat([clonedModule]),self),getFromPrivateInjector=annotate(function(key){return privateInjector.get(key)}),module.__exports__.forEach(function(key){providers[key]=[getFromPrivateInjector,key,"private",privateInjector]})):Object.keys(module).forEach(function(name){var type,value;"private"!==module[name][2]?(type=module[name][0],value=module[name][1],providers[name]=[factoryMap[type],arrayUnwrap(type,value),type]):providers[name]=module[name]}))}),this.get=get,this.invoke=invoke,this.instantiate=instantiate,this.createChild=function(modules,forceNewInstances){if(forceNewInstances&&forceNewInstances.length){var provider,cacheIdx,privateChildInjector,privateChildInjectorFactory,fromParentModule=Object.create(null),matchedScopes=Object.create(null),privateInjectorsCache=[],privateChildInjectors=[],privateChildFactories=[];for(var name in providers)provider=providers[name],-1!==forceNewInstances.indexOf(name)&&("private"===provider[2]?-1===(cacheIdx=privateInjectorsCache.indexOf(provider[3]))?(privateChildInjectorFactory=function(privateChildInjector){return annotate(function(key){return privateChildInjector.get(key)})}(privateChildInjector=provider[3].createChild([],forceNewInstances)),privateInjectorsCache.push(provider[3]),privateChildInjectors.push(privateChildInjector),privateChildFactories.push(privateChildInjectorFactory),fromParentModule[name]=[privateChildInjectorFactory,name,"private",privateChildInjector]):fromParentModule[name]=[privateChildFactories[cacheIdx],name,"private",privateChildInjectors[cacheIdx]]:fromParentModule[name]=[provider[2],provider[1]],matchedScopes[name]=!0),"factory"!==provider[2]&&"type"!==provider[2]||!provider[1].$scope||forceNewInstances.forEach(function(scope){-1!==provider[1].$scope.indexOf(scope)&&(fromParentModule[name]=[provider[2],provider[1]],matchedScopes[scope]=!0)});forceNewInstances.forEach(function(scope){if(!matchedScopes[scope])throw new Error('No provider for "'+scope+'". Cannot use provider from the parent!')}),modules.unshift(fromParentModule)}return new Injector(modules,self)}}},{}],383:[function(require,module,exports){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};!function(window,document,undefined){var assign,VENDOR_PREFIXES=["","webkit","Moz","MS","ms","o"],TEST_ELEMENT=document.createElement("div"),TYPE_FUNCTION="function",round=Math.round,abs=Math.abs,now=Date.now;function setTimeoutContext(fn,timeout,context){return setTimeout(bindFn(fn,context),timeout)}function invokeArrayArg(arg,fn,context){return Array.isArray(arg)&&(each(arg,context[fn],context),1)}function each(obj,iterator,context){var i;if(obj)if(obj.forEach)obj.forEach(iterator,context);else if(obj.length!==undefined)for(i=0;i<obj.length;)iterator.call(context,obj[i],i,obj),i++;else for(i in obj)obj.hasOwnProperty(i)&&iterator.call(context,obj[i],i,obj)}function deprecate(method,name,message){var deprecationMessage="DEPRECATED METHOD: "+name+"\n"+message+" AT \n";return function(){var e=new Error("get-stack-trace"),stack=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",log=window.console&&(window.console.warn||window.console.log);return log&&log.call(window.console,deprecationMessage,stack),method.apply(this,arguments)}}assign="function"!=typeof Object.assign?function(target){if(target===undefined||null===target)throw new TypeError("Cannot convert undefined or null to object");for(var output=Object(target),index=1;index<arguments.length;index++){var source=arguments[index];if(source!==undefined&&null!==source)for(var nextKey in source)source.hasOwnProperty(nextKey)&&(output[nextKey]=source[nextKey])}return output}:Object.assign;var extend=deprecate(function(dest,src,merge){for(var keys=Object.keys(src),i=0;i<keys.length;)(!merge||merge&&dest[keys[i]]===undefined)&&(dest[keys[i]]=src[keys[i]]),i++;return dest},"extend","Use `assign`."),merge=deprecate(function(dest,src){return extend(dest,src,!0)},"merge","Use `assign`.");function inherit(child,base,properties){var baseP=base.prototype,childP=child.prototype=Object.create(baseP);childP.constructor=child,childP._super=baseP,properties&&assign(childP,properties)}function bindFn(fn,context){return function(){return fn.apply(context,arguments)}}function boolOrFn(val,args){return(void 0===val?"undefined":_typeof(val))==TYPE_FUNCTION?val.apply(args&&args[0]||undefined,args):val}function ifUndefined(val1,val2){return val1===undefined?val2:val1}function addEventListeners(target,types,handler){each(splitStr(types),function(type){target.addEventListener(type,handler,!1)})}function removeEventListeners(target,types,handler){each(splitStr(types),function(type){target.removeEventListener(type,handler,!1)})}function hasParent(node,parent){for(;node;){if(node==parent)return!0;node=node.parentNode}return!1}function inStr(str,find){return-1<str.indexOf(find)}function splitStr(str){return str.trim().split(/\s+/g)}function inArray(src,find,findByKey){if(src.indexOf&&!findByKey)return src.indexOf(find);for(var i=0;i<src.length;){if(findByKey&&src[i][findByKey]==find||!findByKey&&src[i]===find)return i;i++}return-1}function toArray(obj){return Array.prototype.slice.call(obj,0)}function uniqueArray(src,key,sort){for(var results=[],values=[],i=0;i<src.length;){var val=key?src[i][key]:src[i];inArray(values,val)<0&&results.push(src[i]),values[i]=val,i++}return sort&&(results=key?results.sort(function(a,b){return a[key]>b[key]}):results.sort()),results}function prefixed(obj,property){for(var prefix,prop,camelProp=property[0].toUpperCase()+property.slice(1),i=0;i<VENDOR_PREFIXES.length;){if((prop=(prefix=VENDOR_PREFIXES[i])?prefix+camelProp:property)in obj)return prop;i++}return undefined}var _uniqueId=1;function getWindowForElement(element){var doc=element.ownerDocument||element;return doc.defaultView||doc.parentWindow||window}var SUPPORT_TOUCH="ontouchstart"in window,SUPPORT_POINTER_EVENTS=prefixed(window,"PointerEvent")!==undefined,SUPPORT_ONLY_TOUCH=SUPPORT_TOUCH&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),COMPUTE_INTERVAL=25,INPUT_START=1,INPUT_END=4,INPUT_CANCEL=8,DIRECTION_NONE=1,DIRECTION_LEFT=2,DIRECTION_RIGHT=4,DIRECTION_UP=8,DIRECTION_DOWN=16,DIRECTION_HORIZONTAL=DIRECTION_LEFT|DIRECTION_RIGHT,DIRECTION_VERTICAL=DIRECTION_UP|DIRECTION_DOWN,DIRECTION_ALL=DIRECTION_HORIZONTAL|DIRECTION_VERTICAL,PROPS_XY=["x","y"],PROPS_CLIENT_XY=["clientX","clientY"];function Input(manager,callback){var self=this;this.manager=manager,this.callback=callback,this.element=manager.element,this.target=manager.options.inputTarget,this.domHandler=function(ev){boolOrFn(manager.options.enable,[manager])&&self.handler(ev)},this.init()}function inputHandler(manager,eventType,input){var pointersLen=input.pointers.length,changedPointersLen=input.changedPointers.length,isFirst=eventType&INPUT_START&&pointersLen-changedPointersLen==0,isFinal=eventType&(INPUT_END|INPUT_CANCEL)&&pointersLen-changedPointersLen==0;input.isFirst=!!isFirst,input.isFinal=!!isFinal,isFirst&&(manager.session={}),input.eventType=eventType,function(manager,input){var session=manager.session,pointers=input.pointers,pointersLength=pointers.length;session.firstInput||(session.firstInput=simpleCloneInputData(input));1<pointersLength&&!session.firstMultiple?session.firstMultiple=simpleCloneInputData(input):1===pointersLength&&(session.firstMultiple=!1);var firstInput=session.firstInput,firstMultiple=session.firstMultiple,offsetCenter=firstMultiple?firstMultiple.center:firstInput.center,center=input.center=getCenter(pointers);input.timeStamp=now(),input.deltaTime=input.timeStamp-firstInput.timeStamp,input.angle=getAngle(offsetCenter,center),input.distance=getDistance(offsetCenter,center),function(session,input){var center=input.center,offset=session.offsetDelta||{},prevDelta=session.prevDelta||{},prevInput=session.prevInput||{};input.eventType!==INPUT_START&&prevInput.eventType!==INPUT_END||(prevDelta=session.prevDelta={x:prevInput.deltaX||0,y:prevInput.deltaY||0},offset=session.offsetDelta={x:center.x,y:center.y});input.deltaX=prevDelta.x+(center.x-offset.x),input.deltaY=prevDelta.y+(center.y-offset.y)}(session,input),input.offsetDirection=getDirection(input.deltaX,input.deltaY);var overallVelocity=getVelocity(input.deltaTime,input.deltaX,input.deltaY);input.overallVelocityX=overallVelocity.x,input.overallVelocityY=overallVelocity.y,input.overallVelocity=abs(overallVelocity.x)>abs(overallVelocity.y)?overallVelocity.x:overallVelocity.y,input.scale=firstMultiple?function(start,end){return getDistance(end[0],end[1],PROPS_CLIENT_XY)/getDistance(start[0],start[1],PROPS_CLIENT_XY)}(firstMultiple.pointers,pointers):1,input.rotation=firstMultiple?function(start,end){return getAngle(end[1],end[0],PROPS_CLIENT_XY)+getAngle(start[1],start[0],PROPS_CLIENT_XY)}(firstMultiple.pointers,pointers):0,input.maxPointers=!session.prevInput||input.pointers.length>session.prevInput.maxPointers?input.pointers.length:session.prevInput.maxPointers,function(session,input){var velocity,velocityX,velocityY,direction,last=session.lastInterval||input,deltaTime=input.timeStamp-last.timeStamp;{var deltaX,deltaY,v;input.eventType!=INPUT_CANCEL&&(COMPUTE_INTERVAL<deltaTime||last.velocity===undefined)?(deltaX=input.deltaX-last.deltaX,deltaY=input.deltaY-last.deltaY,v=getVelocity(deltaTime,deltaX,deltaY),velocityX=v.x,velocityY=v.y,velocity=abs(v.x)>abs(v.y)?v.x:v.y,direction=getDirection(deltaX,deltaY),session.lastInterval=input):(velocity=last.velocity,velocityX=last.velocityX,velocityY=last.velocityY,direction=last.direction)}input.velocity=velocity,input.velocityX=velocityX,input.velocityY=velocityY,input.direction=direction}(session,input);var target=manager.element;hasParent(input.srcEvent.target,target)&&(target=input.srcEvent.target);input.target=target}(manager,input),manager.emit("hammer.input",input),manager.recognize(input),manager.session.prevInput=input}function simpleCloneInputData(input){for(var pointers=[],i=0;i<input.pointers.length;)pointers[i]={clientX:round(input.pointers[i].clientX),clientY:round(input.pointers[i].clientY)},i++;return{timeStamp:now(),pointers:pointers,center:getCenter(pointers),deltaX:input.deltaX,deltaY:input.deltaY}}function getCenter(pointers){var pointersLength=pointers.length;if(1===pointersLength)return{x:round(pointers[0].clientX),y:round(pointers[0].clientY)};for(var x=0,y=0,i=0;i<pointersLength;)x+=pointers[i].clientX,y+=pointers[i].clientY,i++;return{x:round(x/pointersLength),y:round(y/pointersLength)}}function getVelocity(deltaTime,x,y){return{x:x/deltaTime||0,y:y/deltaTime||0}}function getDirection(x,y){return x===y?DIRECTION_NONE:abs(x)>=abs(y)?x<0?DIRECTION_LEFT:DIRECTION_RIGHT:y<0?DIRECTION_UP:DIRECTION_DOWN}function getDistance(p1,p2,props){var x=p2[(props=props||PROPS_XY)[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return Math.sqrt(x*x+y*y)}function getAngle(p1,p2,props){var x=p2[(props=props||PROPS_XY)[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return 180*Math.atan2(y,x)/Math.PI}Input.prototype={handler:function(){},init:function(){this.evEl&&addEventListeners(this.element,this.evEl,this.domHandler),this.evTarget&&addEventListeners(this.target,this.evTarget,this.domHandler),this.evWin&&addEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&removeEventListeners(this.element,this.evEl,this.domHandler),this.evTarget&&removeEventListeners(this.target,this.evTarget,this.domHandler),this.evWin&&removeEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler)}};var MOUSE_INPUT_MAP={mousedown:INPUT_START,mousemove:2,mouseup:INPUT_END},MOUSE_ELEMENT_EVENTS="mousedown",MOUSE_WINDOW_EVENTS="mousemove mouseup";function MouseInput(){this.evEl=MOUSE_ELEMENT_EVENTS,this.evWin=MOUSE_WINDOW_EVENTS,this.pressed=!1,Input.apply(this,arguments)}inherit(MouseInput,Input,{handler:function(ev){var eventType=MOUSE_INPUT_MAP[ev.type];eventType&INPUT_START&&0===ev.button&&(this.pressed=!0),2&eventType&&1!==ev.which&&(eventType=INPUT_END),this.pressed&&(eventType&INPUT_END&&(this.pressed=!1),this.callback(this.manager,eventType,{pointers:[ev],changedPointers:[ev],pointerType:"mouse",srcEvent:ev}))}});var POINTER_INPUT_MAP={pointerdown:INPUT_START,pointermove:2,pointerup:INPUT_END,pointercancel:INPUT_CANCEL,pointerout:INPUT_CANCEL},IE10_POINTER_TYPE_ENUM={2:"touch",3:"pen",4:"mouse",5:"kinect"},POINTER_ELEMENT_EVENTS="pointerdown",POINTER_WINDOW_EVENTS="pointermove pointerup pointercancel";function PointerEventInput(){this.evEl=POINTER_ELEMENT_EVENTS,this.evWin=POINTER_WINDOW_EVENTS,Input.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}window.MSPointerEvent&&!window.PointerEvent&&(POINTER_ELEMENT_EVENTS="MSPointerDown",POINTER_WINDOW_EVENTS="MSPointerMove MSPointerUp MSPointerCancel"),inherit(PointerEventInput,Input,{handler:function(ev){var store=this.store,removePointer=!1,eventTypeNormalized=ev.type.toLowerCase().replace("ms",""),eventType=POINTER_INPUT_MAP[eventTypeNormalized],pointerType=IE10_POINTER_TYPE_ENUM[ev.pointerType]||ev.pointerType,isTouch="touch"==pointerType,storeIndex=inArray(store,ev.pointerId,"pointerId");eventType&INPUT_START&&(0===ev.button||isTouch)?storeIndex<0&&(store.push(ev),storeIndex=store.length-1):eventType&(INPUT_END|INPUT_CANCEL)&&(removePointer=!0),storeIndex<0||(store[storeIndex]=ev,this.callback(this.manager,eventType,{pointers:store,changedPointers:[ev],pointerType:pointerType,srcEvent:ev}),removePointer&&store.splice(storeIndex,1))}});var SINGLE_TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:2,touchend:INPUT_END,touchcancel:INPUT_CANCEL};function SingleTouchInput(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,Input.apply(this,arguments)}inherit(SingleTouchInput,Input,{handler:function(ev){var touches,type=SINGLE_TOUCH_INPUT_MAP[ev.type];type===INPUT_START&&(this.started=!0),this.started&&(touches=function(ev,type){var all=toArray(ev.touches),changed=toArray(ev.changedTouches);type&(INPUT_END|INPUT_CANCEL)&&(all=uniqueArray(all.concat(changed),"identifier",!0));return[all,changed]}.call(this,ev,type),type&(INPUT_END|INPUT_CANCEL)&&touches[0].length-touches[1].length==0&&(this.started=!1),this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:"touch",srcEvent:ev}))}});var TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:2,touchend:INPUT_END,touchcancel:INPUT_CANCEL},TOUCH_TARGET_EVENTS="touchstart touchmove touchend touchcancel";function TouchInput(){this.evTarget=TOUCH_TARGET_EVENTS,this.targetIds={},Input.apply(this,arguments)}inherit(TouchInput,Input,{handler:function(ev){var type=TOUCH_INPUT_MAP[ev.type],touches=function(ev,type){var allTouches=toArray(ev.touches),targetIds=this.targetIds;if(type&(2|INPUT_START)&&1===allTouches.length)return targetIds[allTouches[0].identifier]=!0,[allTouches,allTouches];var i,targetTouches,changedTouches=toArray(ev.changedTouches),changedTargetTouches=[],target=this.target;if(targetTouches=allTouches.filter(function(touch){return hasParent(touch.target,target)}),type===INPUT_START)for(i=0;i<targetTouches.length;)targetIds[targetTouches[i].identifier]=!0,i++;i=0;for(;i<changedTouches.length;)targetIds[changedTouches[i].identifier]&&changedTargetTouches.push(changedTouches[i]),type&(INPUT_END|INPUT_CANCEL)&&delete targetIds[changedTouches[i].identifier],i++;return changedTargetTouches.length?[uniqueArray(targetTouches.concat(changedTargetTouches),"identifier",!0),changedTargetTouches]:void 0}.call(this,ev,type);touches&&this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:"touch",srcEvent:ev})}});var DEDUP_TIMEOUT=2500;function TouchMouseInput(){Input.apply(this,arguments);var handler=bindFn(this.handler,this);this.touch=new TouchInput(this.manager,handler),this.mouse=new MouseInput(this.manager,handler),this.primaryTouch=null,this.lastTouches=[]}function setLastTouch(eventData){var lastTouch,lts,touch=eventData.changedPointers[0];touch.identifier===this.primaryTouch&&(lastTouch={x:touch.clientX,y:touch.clientY},this.lastTouches.push(lastTouch),lts=this.lastTouches,setTimeout(function(){var i=lts.indexOf(lastTouch);-1<i&&lts.splice(i,1)},DEDUP_TIMEOUT))}inherit(TouchMouseInput,Input,{handler:function(manager,inputEvent,inputData){var isTouch="touch"==inputData.pointerType,isMouse="mouse"==inputData.pointerType;if(!(isMouse&&inputData.sourceCapabilities&&inputData.sourceCapabilities.firesTouchEvents)){if(isTouch)(function(eventType,eventData){eventType&INPUT_START?(this.primaryTouch=eventData.changedPointers[0].identifier,setLastTouch.call(this,eventData)):eventType&(INPUT_END|INPUT_CANCEL)&&setLastTouch.call(this,eventData)}).call(this,inputEvent,inputData);else if(isMouse&&function(eventData){for(var x=eventData.srcEvent.clientX,y=eventData.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var t=this.lastTouches[i],dx=Math.abs(x-t.x),dy=Math.abs(y-t.y);if(dx<=25&&dy<=25)return!0}return!1}.call(this,inputData))return;this.callback(manager,inputEvent,inputData)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var PREFIXED_TOUCH_ACTION=prefixed(TEST_ELEMENT.style,"touchAction"),NATIVE_TOUCH_ACTION=PREFIXED_TOUCH_ACTION!==undefined,TOUCH_ACTION_MAP=function(){if(!NATIVE_TOUCH_ACTION)return!1;var touchMap={},cssSupports=window.CSS&&window.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(val){touchMap[val]=!cssSupports||window.CSS.supports("touch-action",val)}),touchMap}();function TouchAction(manager,value){this.manager=manager,this.set(value)}TouchAction.prototype={set:function(value){"compute"==value&&(value=this.compute()),NATIVE_TOUCH_ACTION&&this.manager.element.style&&TOUCH_ACTION_MAP[value]&&(this.manager.element.style[PREFIXED_TOUCH_ACTION]=value),this.actions=value.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var actions=[];return each(this.manager.recognizers,function(recognizer){boolOrFn(recognizer.options.enable,[recognizer])&&(actions=actions.concat(recognizer.getTouchAction()))}),function(actions){if(inStr(actions,"none"))return"none";var hasPanX=inStr(actions,"pan-x"),hasPanY=inStr(actions,"pan-y");if(hasPanX&&hasPanY)return"none";if(hasPanX||hasPanY)return hasPanX?"pan-x":"pan-y";if(inStr(actions,"manipulation"))return"manipulation";return"auto"}(actions.join(" "))},preventDefaults:function(input){var srcEvent=input.srcEvent,direction=input.offsetDirection;if(this.manager.session.prevented)srcEvent.preventDefault();else{var actions=this.actions,hasNone=inStr(actions,"none")&&!TOUCH_ACTION_MAP.none,hasPanY=inStr(actions,"pan-y")&&!TOUCH_ACTION_MAP["pan-y"],hasPanX=inStr(actions,"pan-x")&&!TOUCH_ACTION_MAP["pan-x"];if(hasNone){var isTapPointer=1===input.pointers.length,isTapMovement=input.distance<2,isTapTouchTime=input.deltaTime<250;if(isTapPointer&&isTapMovement&&isTapTouchTime)return}if(!hasPanX||!hasPanY)return hasNone||hasPanY&&direction&DIRECTION_HORIZONTAL||hasPanX&&direction&DIRECTION_VERTICAL?this.preventSrc(srcEvent):void 0}},preventSrc:function(srcEvent){this.manager.session.prevented=!0,srcEvent.preventDefault()}};var STATE_POSSIBLE=1;function Recognizer(options){this.options=assign({},this.defaults,options||{}),this.id=_uniqueId++,this.manager=null,this.options.enable=ifUndefined(this.options.enable,!0),this.state=STATE_POSSIBLE,this.simultaneous={},this.requireFail=[]}function stateStr(state){return 16&state?"cancel":8&state?"end":4&state?"move":2&state?"start":""}function directionStr(direction){return direction==DIRECTION_DOWN?"down":direction==DIRECTION_UP?"up":direction==DIRECTION_LEFT?"left":direction==DIRECTION_RIGHT?"right":""}function getRecognizerByNameIfManager(otherRecognizer,recognizer){var manager=recognizer.manager;return manager?manager.get(otherRecognizer):otherRecognizer}function AttrRecognizer(){Recognizer.apply(this,arguments)}function PanRecognizer(){AttrRecognizer.apply(this,arguments),this.pX=null,this.pY=null}function PinchRecognizer(){AttrRecognizer.apply(this,arguments)}function PressRecognizer(){Recognizer.apply(this,arguments),this._timer=null,this._input=null}function RotateRecognizer(){AttrRecognizer.apply(this,arguments)}function SwipeRecognizer(){AttrRecognizer.apply(this,arguments)}function TapRecognizer(){Recognizer.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Hammer(element,options){return(options=options||{}).recognizers=ifUndefined(options.recognizers,Hammer.defaults.preset),new Manager(element,options)}Recognizer.prototype={defaults:{},set:function(options){return assign(this.options,options),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"recognizeWith",this))return this;var simultaneous=this.simultaneous;return simultaneous[(otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this)).id]||(simultaneous[otherRecognizer.id]=otherRecognizer).recognizeWith(this),this},dropRecognizeWith:function(otherRecognizer){return invokeArrayArg(otherRecognizer,"dropRecognizeWith",this)||(otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this),delete this.simultaneous[otherRecognizer.id]),this},requireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"requireFailure",this))return this;var requireFail=this.requireFail;return-1===inArray(requireFail,otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this))&&(requireFail.push(otherRecognizer),otherRecognizer.requireFailure(this)),this},dropRequireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"dropRequireFailure",this))return this;otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);var index=inArray(this.requireFail,otherRecognizer);return-1<index&&this.requireFail.splice(index,1),this},hasRequireFailures:function(){return 0<this.requireFail.length},canRecognizeWith:function(otherRecognizer){return!!this.simultaneous[otherRecognizer.id]},emit:function(input){var self=this,state=this.state;function emit(event){self.manager.emit(event,input)}state<8&&emit(self.options.event+stateStr(state)),emit(self.options.event),input.additionalEvent&&emit(input.additionalEvent),8<=state&&emit(self.options.event+stateStr(state))},tryEmit:function(input){if(this.canEmit())return this.emit(input);this.state=32},canEmit:function(){for(var i=0;i<this.requireFail.length;){if(!(this.requireFail[i].state&(32|STATE_POSSIBLE)))return!1;i++}return!0},recognize:function(inputData){var inputDataClone=assign({},inputData);if(!boolOrFn(this.options.enable,[this,inputDataClone]))return this.reset(),void(this.state=32);56&this.state&&(this.state=STATE_POSSIBLE),this.state=this.process(inputDataClone),30&this.state&&this.tryEmit(inputDataClone)},process:function(){},getTouchAction:function(){},reset:function(){}},inherit(AttrRecognizer,Recognizer,{defaults:{pointers:1},attrTest:function(input){var optionPointers=this.options.pointers;return 0===optionPointers||input.pointers.length===optionPointers},process:function(input){var state=this.state,eventType=input.eventType,isRecognized=6&state,isValid=this.attrTest(input);return isRecognized&&(eventType&INPUT_CANCEL||!isValid)?16|state:isRecognized||isValid?eventType&INPUT_END?8|state:2&state?4|state:2:32}}),inherit(PanRecognizer,AttrRecognizer,{defaults:{event:"pan",threshold:10,pointers:1,direction:DIRECTION_ALL},getTouchAction:function(){var direction=this.options.direction,actions=[];return direction&DIRECTION_HORIZONTAL&&actions.push("pan-y"),direction&DIRECTION_VERTICAL&&actions.push("pan-x"),actions},directionTest:function(input){var options=this.options,hasMoved=!0,distance=input.distance,direction=input.direction,x=input.deltaX,y=input.deltaY;return direction&options.direction||(distance=options.direction&DIRECTION_HORIZONTAL?(direction=0===x?DIRECTION_NONE:x<0?DIRECTION_LEFT:DIRECTION_RIGHT,hasMoved=x!=this.pX,Math.abs(input.deltaX)):(direction=0===y?DIRECTION_NONE:y<0?DIRECTION_UP:DIRECTION_DOWN,hasMoved=y!=this.pY,Math.abs(input.deltaY))),input.direction=direction,hasMoved&&distance>options.threshold&&direction&options.direction},attrTest:function(input){return AttrRecognizer.prototype.attrTest.call(this,input)&&(2&this.state||!(2&this.state)&&this.directionTest(input))},emit:function(input){this.pX=input.deltaX,this.pY=input.deltaY;var direction=directionStr(input.direction);direction&&(input.additionalEvent=this.options.event+direction),this._super.emit.call(this,input)}}),inherit(PinchRecognizer,AttrRecognizer,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.scale-1)>this.options.threshold||2&this.state)},emit:function(input){var inOut;1!==input.scale&&(inOut=input.scale<1?"in":"out",input.additionalEvent=this.options.event+inOut),this._super.emit.call(this,input)}}),inherit(PressRecognizer,Recognizer,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(input){var options=this.options,validPointers=input.pointers.length===options.pointers,validMovement=input.distance<options.threshold,validTime=input.deltaTime>options.time;if(this._input=input,!validMovement||!validPointers||input.eventType&(INPUT_END|INPUT_CANCEL)&&!validTime)this.reset();else if(input.eventType&INPUT_START)this.reset(),this._timer=setTimeoutContext(function(){this.state=8,this.tryEmit()},options.time,this);else if(input.eventType&INPUT_END)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(input){8===this.state&&(input&&input.eventType&INPUT_END?this.manager.emit(this.options.event+"up",input):(this._input.timeStamp=now(),this.manager.emit(this.options.event,this._input)))}}),inherit(RotateRecognizer,AttrRecognizer,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.rotation)>this.options.threshold||2&this.state)}}),inherit(SwipeRecognizer,AttrRecognizer,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:DIRECTION_HORIZONTAL|DIRECTION_VERTICAL,pointers:1},getTouchAction:function(){return PanRecognizer.prototype.getTouchAction.call(this)},attrTest:function(input){var velocity,direction=this.options.direction;return direction&(DIRECTION_HORIZONTAL|DIRECTION_VERTICAL)?velocity=input.overallVelocity:direction&DIRECTION_HORIZONTAL?velocity=input.overallVelocityX:direction&DIRECTION_VERTICAL&&(velocity=input.overallVelocityY),this._super.attrTest.call(this,input)&&direction&input.offsetDirection&&input.distance>this.options.threshold&&input.maxPointers==this.options.pointers&&abs(velocity)>this.options.velocity&&input.eventType&INPUT_END},emit:function(input){var direction=directionStr(input.offsetDirection);direction&&this.manager.emit(this.options.event+direction,input),this.manager.emit(this.options.event,input)}}),inherit(TapRecognizer,Recognizer,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return["manipulation"]},process:function(input){var options=this.options,validPointers=input.pointers.length===options.pointers,validMovement=input.distance<options.threshold,validTouchTime=input.deltaTime<options.time;if(this.reset(),input.eventType&INPUT_START&&0===this.count)return this.failTimeout();if(validMovement&&validTouchTime&&validPointers){if(input.eventType!=INPUT_END)return this.failTimeout();var validInterval=!this.pTime||input.timeStamp-this.pTime<options.interval,validMultiTap=!this.pCenter||getDistance(this.pCenter,input.center)<options.posThreshold;if(this.pTime=input.timeStamp,this.pCenter=input.center,validMultiTap&&validInterval?this.count+=1:this.count=1,this._input=input,0==this.count%options.taps)return this.hasRequireFailures()?(this._timer=setTimeoutContext(function(){this.state=8,this.tryEmit()},options.interval,this),2):8}return 32},failTimeout:function(){return this._timer=setTimeoutContext(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Hammer.VERSION="2.0.7",Hammer.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[RotateRecognizer,{enable:!1}],[PinchRecognizer,{enable:!1},["rotate"]],[SwipeRecognizer,{direction:DIRECTION_HORIZONTAL}],[PanRecognizer,{direction:DIRECTION_HORIZONTAL},["swipe"]],[TapRecognizer],[TapRecognizer,{event:"doubletap",taps:2},["tap"]],[PressRecognizer]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function Manager(element,options){var manager,inputClass;this.options=assign({},Hammer.defaults,options||{}),this.options.inputTarget=this.options.inputTarget||element,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=element,this.input=(inputClass=(manager=this).options.inputClass,new(inputClass||(SUPPORT_POINTER_EVENTS?PointerEventInput:SUPPORT_ONLY_TOUCH?TouchInput:SUPPORT_TOUCH?TouchMouseInput:MouseInput))(manager,inputHandler)),this.touchAction=new TouchAction(this,this.options.touchAction),toggleCssProps(this,!0),each(this.options.recognizers,function(item){var recognizer=this.add(new item[0](item[1]));item[2]&&recognizer.recognizeWith(item[2]),item[3]&&recognizer.requireFailure(item[3])},this)}function toggleCssProps(manager,add){var prop,element=manager.element;element.style&&(each(manager.options.cssProps,function(value,name){prop=prefixed(element.style,name),add?(manager.oldCssProps[prop]=element.style[prop],element.style[prop]=value):element.style[prop]=manager.oldCssProps[prop]||""}),add||(manager.oldCssProps={}))}Manager.prototype={set:function(options){return assign(this.options,options),options.touchAction&&this.touchAction.update(),options.inputTarget&&(this.input.destroy(),this.input.target=options.inputTarget,this.input.init()),this},stop:function(force){this.session.stopped=force?2:1},recognize:function(inputData){var recognizer,session=this.session;if(!session.stopped){this.touchAction.preventDefaults(inputData);var recognizers=this.recognizers,curRecognizer=session.curRecognizer;(!curRecognizer||curRecognizer&&8&curRecognizer.state)&&(curRecognizer=session.curRecognizer=null);for(var i=0;i<recognizers.length;)recognizer=recognizers[i],2===session.stopped||curRecognizer&&recognizer!=curRecognizer&&!recognizer.canRecognizeWith(curRecognizer)?recognizer.reset():recognizer.recognize(inputData),!curRecognizer&&14&recognizer.state&&(curRecognizer=session.curRecognizer=recognizer),i++}},get:function(recognizer){if(recognizer instanceof Recognizer)return recognizer;for(var recognizers=this.recognizers,i=0;i<recognizers.length;i++)if(recognizers[i].options.event==recognizer)return recognizers[i];return null},add:function(recognizer){if(invokeArrayArg(recognizer,"add",this))return this;var existing=this.get(recognizer.options.event);return existing&&this.remove(existing),this.recognizers.push(recognizer),(recognizer.manager=this).touchAction.update(),recognizer},remove:function(recognizer){return invokeArrayArg(recognizer,"remove",this)||!(recognizer=this.get(recognizer))||-1!==(index=inArray(recognizers=this.recognizers,recognizer))&&(recognizers.splice(index,1),this.touchAction.update()),this;var recognizers,index},on:function(events,handler){if(events!==undefined&&handler!==undefined){var handlers=this.handlers;return each(splitStr(events),function(event){handlers[event]=handlers[event]||[],handlers[event].push(handler)}),this}},off:function(events,handler){if(events!==undefined){var handlers=this.handlers;return each(splitStr(events),function(event){handler?handlers[event]&&handlers[event].splice(inArray(handlers[event],handler),1):delete handlers[event]}),this}},emit:function(event,data){this.options.domEvents&&function(event,data){var gestureEvent=document.createEvent("Event");gestureEvent.initEvent(event,!0,!0),(gestureEvent.gesture=data).target.dispatchEvent(gestureEvent)}(event,data);var handlers=this.handlers[event]&&this.handlers[event].slice();if(handlers&&handlers.length){data.type=event,data.preventDefault=function(){data.srcEvent.preventDefault()};for(var i=0;i<handlers.length;)handlers[i](data),i++}},destroy:function(){this.element&&toggleCssProps(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},assign(Hammer,{INPUT_START:INPUT_START,INPUT_MOVE:2,INPUT_END:INPUT_END,INPUT_CANCEL:INPUT_CANCEL,STATE_POSSIBLE:STATE_POSSIBLE,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:DIRECTION_NONE,DIRECTION_LEFT:DIRECTION_LEFT,DIRECTION_RIGHT:DIRECTION_RIGHT,DIRECTION_UP:DIRECTION_UP,DIRECTION_DOWN:DIRECTION_DOWN,DIRECTION_HORIZONTAL:DIRECTION_HORIZONTAL,DIRECTION_VERTICAL:DIRECTION_VERTICAL,DIRECTION_ALL:DIRECTION_ALL,Manager:Manager,Input:Input,TouchAction:TouchAction,TouchInput:TouchInput,MouseInput:MouseInput,PointerEventInput:PointerEventInput,TouchMouseInput:TouchMouseInput,SingleTouchInput:SingleTouchInput,Recognizer:Recognizer,AttrRecognizer:AttrRecognizer,Tap:TapRecognizer,Pan:PanRecognizer,Swipe:SwipeRecognizer,Pinch:PinchRecognizer,Rotate:RotateRecognizer,Press:PressRecognizer,on:addEventListeners,off:removeEventListeners,each:each,merge:merge,extend:extend,assign:assign,inherit:inherit,bindFn:bindFn,prefixed:prefixed}),(void 0!==window?window:"undefined"!=typeof self?self:{}).Hammer=Hammer,"function"==typeof define&&define.amd?define(function(){return Hammer}):void 0!==module&&module.exports?module.exports=Hammer:window.Hammer=Hammer}(window,document)},{}],384:[function(require,module,exports){"use strict";var hat_1=function(fn,module){return fn(module={exports:{}},module.exports),module.exports}(function(module){var hat=module.exports=function(bits,base){if(base=base||16,void 0===bits&&(bits=128),bits<=0)return"0";for(var digits=Math.log(Math.pow(2,bits))/Math.log(base),i=2;digits===1/0;i*=2)digits=Math.log(Math.pow(2,bits/i))/Math.log(base)*i;for(var b,rem=digits-Math.floor(digits),res="",i=0;i<Math.floor(digits);i++)res=Math.floor(Math.random()*base).toString(base)+res;rem&&(b=Math.pow(base,rem),res=Math.floor(Math.random()*b).toString(base)+res);var parsed=parseInt(res,base);return parsed!==1/0&&parsed>=Math.pow(2,bits)?hat(bits,base):res};hat.rack=function(bits,base,expandBy){var fn=function(data){var iters=0;do{if(10<iters++){if(!expandBy)throw new Error("too many ID collisions, use more bits");bits+=expandBy}var id=hat(bits,base)}while(Object.hasOwnProperty.call(hats,id));return hats[id]=data,id},hats=fn.hats={};return fn.get=function(id){return fn.hats[id]},fn.set=function(id,value){return fn.hats[id]=value,fn},fn.bits=bits||128,fn.base=base||16,fn}});function Ids(seed){if(!(this instanceof Ids))return new Ids(seed);seed=seed||[128,36,1],this._seed=seed.length?hat_1.rack(seed[0],seed[1],seed[2]):seed}Ids.prototype.next=function(element){return this._seed(element||!0)},Ids.prototype.nextPrefixed=function(prefix,element){for(var id;id=prefix+this.next(!0),this.assigned(id););return this.claim(id,element),id},Ids.prototype.claim=function(id,element){this._seed.set(id,element||!0)},Ids.prototype.assigned=function(id){return this._seed.get(id)||!1},Ids.prototype.unclaim=function(id){delete this._seed.hats[id]},Ids.prototype.clear=function(){var id,hats=this._seed.hats;for(id in hats)this.unclaim(id)},module.exports=Ids},{}],385:[function(require,module,exports){"use strict";"function"==typeof Object.create?module.exports=function(ctor,superCtor){superCtor&&(ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}}))}:module.exports=function(ctor,superCtor){var TempCtor;superCtor&&(ctor.super_=superCtor,(TempCtor=function(){}).prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor)}},{}],386:[function(require,module,exports){"use strict";var global,factory,_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};global="undefined"!=typeof window?window:void 0,factory=function(window,noGlobal){var arr=[],getProto=Object.getPrototypeOf,_slice=arr.slice,flat=arr.flat?function(array){return arr.flat.call(array)}:function(array){return arr.concat.apply([],array)},push=arr.push,indexOf=arr.indexOf,class2type={},toString=class2type.toString,hasOwn=class2type.hasOwnProperty,fnToString=hasOwn.toString,ObjectFunctionString=fnToString.call(Object),support={},isFunction=function(obj){return"function"==typeof obj&&"number"!=typeof obj.nodeType},isWindow=function(obj){return null!=obj&&obj===obj.window},document=window.document,preservedScriptAttributes={type:!0,src:!0,nonce:!0,noModule:!0};function DOMEval(code,node,doc){var i,val,script=(doc=doc||document).createElement("script");if(script.text=code,node)for(i in preservedScriptAttributes)(val=node[i]||node.getAttribute&&node.getAttribute(i))&&script.setAttribute(i,val);doc.head.appendChild(script).parentNode.removeChild(script)}function toType(obj){return null==obj?obj+"":"object"===(void 0===obj?"undefined":_typeof(obj))||"function"==typeof obj?class2type[toString.call(obj)]||"object":void 0===obj?"undefined":_typeof(obj)}var jQuery=function jQuery(selector,context){return new jQuery.fn.init(selector,context)};function isArrayLike(obj){var length=!!obj&&"length"in obj&&obj.length,type=toType(obj);return!isFunction(obj)&&!isWindow(obj)&&("array"===type||0===length||"number"==typeof length&&0<length&&length-1 in obj)}jQuery.fn=jQuery.prototype={jquery:"3.5.1",constructor:jQuery,length:0,toArray:function(){return _slice.call(this)},get:function(num){return null==num?_slice.call(this):num<0?this[num+this.length]:this[num]},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);return ret.prevObject=this,ret},each:function(callback){return jQuery.each(this,callback)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(_slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(jQuery.grep(this,function(_elem,i){return(i+1)%2}))},odd:function(){return this.pushStack(jQuery.grep(this,function(_elem,i){return i%2}))},eq:function(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(0<=j&&j<len?[this[j]]:[])},end:function(){return this.prevObject||this.constructor()},push:push,sort:arr.sort,splice:arr.splice},jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[i]||{},i++),"object"===(void 0===target?"undefined":_typeof(target))||isFunction(target)||(target={}),i===length&&(target=this,i--);i<length;i++)if(null!=(options=arguments[i]))for(name in options)copy=options[name],"__proto__"!==name&&target!==copy&&(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=Array.isArray(copy)))?(src=target[name],clone=copyIsArray&&!Array.isArray(src)?[]:copyIsArray||jQuery.isPlainObject(src)?src:{},copyIsArray=!1,target[name]=jQuery.extend(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target},jQuery.extend({expando:"jQuery"+("3.5.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(msg){throw new Error(msg)},noop:function(){},isPlainObject:function(obj){var proto,Ctor;return!(!obj||"[object Object]"!==toString.call(obj))&&(!(proto=getProto(obj))||"function"==typeof(Ctor=hasOwn.call(proto,"constructor")&&proto.constructor)&&fnToString.call(Ctor)===ObjectFunctionString)},isEmptyObject:function(obj){var name;for(name in obj)return!1;return!0},globalEval:function(code,options,doc){DOMEval(code,{nonce:options&&options.nonce},doc)},each:function(obj,callback){var length,i=0;if(isArrayLike(obj))for(length=obj.length;i<length&&!1!==callback.call(obj[i],i,obj[i]);i++);else for(i in obj)if(!1===callback.call(obj[i],i,obj[i]))break;return obj},makeArray:function(arr,results){var ret=results||[];return null!=arr&&(isArrayLike(Object(arr))?jQuery.merge(ret,"string"==typeof arr?[arr]:arr):push.call(ret,arr)),ret},inArray:function(elem,arr,i){return null==arr?-1:indexOf.call(arr,elem,i)},merge:function(first,second){for(var len=+second.length,j=0,i=first.length;j<len;j++)first[i++]=second[j];return first.length=i,first},grep:function(elems,callback,invert){for(var matches=[],i=0,length=elems.length,callbackExpect=!invert;i<length;i++)!callback(elems[i],i)!=callbackExpect&&matches.push(elems[i]);return matches},map:function(elems,callback,arg){var length,value,i=0,ret=[];if(isArrayLike(elems))for(length=elems.length;i<length;i++)null!=(value=callback(elems[i],i,arg))&&ret.push(value);else for(i in elems)null!=(value=callback(elems[i],i,arg))&&ret.push(value);return flat(ret)},guid:1,support:support}),"function"==typeof Symbol&&(jQuery.fn[Symbol.iterator]=arr[Symbol.iterator]),jQuery.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(_i,name){class2type["[object "+name+"]"]=name.toLowerCase()});var Sizzle=function(window){var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+ +new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),nonnativeSelectorCache=createCache(),sortOrder=function(a,b){return a===b&&(hasDuplicate=!0),0},hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,pushNative=arr.push,push=arr.push,slice=arr.slice,indexOf=function(list,elem){for(var i=0,len=list.length;i<len;i++)if(list[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",identifier="(?:\\\\[\\da-fA-F]{1,6}"+whitespace+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",attributes="\\["+whitespace+"*("+identifier+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+identifier+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|.*)\\)|)",rwhitespace=new RegExp(whitespace+"+","g"),rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rdescend=new RegExp(whitespace+"|>"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+identifier+")"),CLASS:new RegExp("^\\.("+identifier+")"),TAG:new RegExp("^("+identifier+"|[*])"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rhtml=/HTML$/i,rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,runescape=new RegExp("\\\\[\\da-fA-F]{1,6}"+whitespace+"?|\\\\([^\\r\\n\\f])","g"),funescape=function(escape,nonHex){var high="0x"+escape.slice(1)-65536;return nonHex||(high<0?String.fromCharCode(65536+high):String.fromCharCode(high>>10|55296,1023&high|56320))},rcssescape=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,fcssescape=function(ch,asCodePoint){return asCodePoint?"\0"===ch?"":ch.slice(0,-1)+"\\"+ch.charCodeAt(ch.length-1).toString(16)+" ":"\\"+ch},unloadHandler=function(){setDocument()},inDisabledFieldset=addCombinator(function(elem){return!0===elem.disabled&&"fieldset"===elem.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){pushNative.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}function Sizzle(selector,context,results,seed){var m,i,elem,nid,match,groups,newSelector,newContext=context&&context.ownerDocument,nodeType=context?context.nodeType:9;if(results=results||[],"string"!=typeof selector||!selector||1!==nodeType&&9!==nodeType&&11!==nodeType)return results;if(!seed&&(setDocument(context),context=context||document,documentIsHTML)){if(11!==nodeType&&(match=rquickExpr.exec(selector)))if(m=match[1]){if(9===nodeType){if(!(elem=context.getElementById(m)))return results;if(elem.id===m)return results.push(elem),results}else if(newContext&&(elem=newContext.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&!nonnativeSelectorCache[selector+" "]&&(!rbuggyQSA||!rbuggyQSA.test(selector))&&(1!==nodeType||"object"!==context.nodeName.toLowerCase())){if(newSelector=selector,newContext=context,1===nodeType&&(rdescend.test(selector)||rcombinators.test(selector))){for((newContext=rsibling.test(selector)&&testContext(context.parentNode)||context)===context&&support.scope||((nid=context.getAttribute("id"))?nid=nid.replace(rcssescape,fcssescape):context.setAttribute("id",nid=expando)),i=(groups=tokenize(selector)).length;i--;)groups[i]=(nid?"#"+nid:":scope")+" "+toSelector(groups[i]);newSelector=groups.join(",")}try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){nonnativeSelectorCache(selector,!0)}finally{nid===expando&&context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){var keys=[];function cache(key,value){return keys.push(key+" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key+" "]=value}return cache}function markFunction(fn){return fn[expando]=!0,fn}function assert(fn){var el=document.createElement("fieldset");try{return!!fn(el)}catch(e){return!1}finally{el.parentNode&&el.parentNode.removeChild(el),el=null}}function addHandle(attrs,handler){for(var arr=attrs.split("|"),i=arr.length;i--;)Expr.attrHandle[arr[i]]=handler}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&a.sourceIndex-b.sourceIndex;if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createDisabledPseudo(disabled){return function(elem){return"form"in elem?elem.parentNode&&!1===elem.disabled?"label"in elem?"label"in elem.parentNode?elem.parentNode.disabled===disabled:elem.disabled===disabled:elem.isDisabled===disabled||elem.isDisabled!==!disabled&&inDisabledFieldset(elem)===disabled:elem.disabled===disabled:"label"in elem&&elem.disabled===disabled}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function testContext(context){return context&&void 0!==context.getElementsByTagName&&context}for(i in support=Sizzle.support={},isXML=Sizzle.isXML=function(elem){var namespace=elem.namespaceURI,docElem=(elem.ownerDocument||elem).documentElement;return!rhtml.test(namespace||docElem&&docElem.nodeName||"HTML")},setDocument=Sizzle.setDocument=function(node){var hasCompare,subWindow,doc=node?node.ownerDocument||node:preferredDoc;return doc!=document&&9===doc.nodeType&&doc.documentElement&&(docElem=(document=doc).documentElement,documentIsHTML=!isXML(document),preferredDoc!=document&&(subWindow=document.defaultView)&&subWindow.top!==subWindow&&(subWindow.addEventListener?subWindow.addEventListener("unload",unloadHandler,!1):subWindow.attachEvent&&subWindow.attachEvent("onunload",unloadHandler)),support.scope=assert(function(el){return docElem.appendChild(el).appendChild(document.createElement("div")),void 0!==el.querySelectorAll&&!el.querySelectorAll(":scope fieldset div").length}),support.attributes=assert(function(el){return el.className="i",!el.getAttribute("className")}),support.getElementsByTagName=assert(function(el){return el.appendChild(document.createComment("")),!el.getElementsByTagName("*").length}),support.getElementsByClassName=rnative.test(document.getElementsByClassName),support.getById=assert(function(el){return docElem.appendChild(el).id=expando,!document.getElementsByName||!document.getElementsByName(expando).length}),support.getById?(Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}},Expr.find.ID=function(id,context){if(void 0!==context.getElementById&&documentIsHTML){var elem=context.getElementById(id);return elem?[elem]:[]}}):(Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=void 0!==elem.getAttributeNode&&elem.getAttributeNode("id");return node&&node.value===attrId}},Expr.find.ID=function(id,context){if(void 0!==context.getElementById&&documentIsHTML){var node,i,elems,elem=context.getElementById(id);if(elem){if((node=elem.getAttributeNode("id"))&&node.value===id)return[elem];for(elems=context.getElementsByName(id),i=0;elem=elems[i++];)if((node=elem.getAttributeNode("id"))&&node.value===id)return[elem]}return[]}}),Expr.find.TAG=support.getElementsByTagName?function(tag,context){return void 0!==context.getElementsByTagName?context.getElementsByTagName(tag):support.qsa?context.querySelectorAll(tag):void 0}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"!==tag)return results;for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){if(void 0!==context.getElementsByClassName&&documentIsHTML)return context.getElementsByClassName(className)},rbuggyMatches=[],rbuggyQSA=[],(support.qsa=rnative.test(document.querySelectorAll))&&(assert(function(el){var input;docElem.appendChild(el).innerHTML="<a id='"+expando+"'></a><select id='"+expando+"-\r\\' msallowcapture=''><option selected=''></option></select>",el.querySelectorAll("[msallowcapture^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")"),el.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")"),el.querySelectorAll("[id~="+expando+"-]").length||rbuggyQSA.push("~="),(input=document.createElement("input")).setAttribute("name",""),el.appendChild(input),el.querySelectorAll("[name='']").length||rbuggyQSA.push("\\["+whitespace+"*name"+whitespace+"*="+whitespace+"*(?:''|\"\")"),el.querySelectorAll(":checked").length||rbuggyQSA.push(":checked"),el.querySelectorAll("a#"+expando+"+*").length||rbuggyQSA.push(".#.+[+~]"),el.querySelectorAll("\\\f"),rbuggyQSA.push("[\\r\\n\\f]")}),assert(function(el){el.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var input=document.createElement("input");input.setAttribute("type","hidden"),el.appendChild(input).setAttribute("name","D"),el.querySelectorAll("[name=d]").length&&rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?="),2!==el.querySelectorAll(":enabled").length&&rbuggyQSA.push(":enabled",":disabled"),docElem.appendChild(el).disabled=!0,2!==el.querySelectorAll(":disabled").length&&rbuggyQSA.push(":enabled",":disabled"),el.querySelectorAll("*,:x"),rbuggyQSA.push(",.*:")})),(support.matchesSelector=rnative.test(matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(el){support.disconnectedMatch=matches.call(el,"*"),matches.call(el,"[s!='']:x"),rbuggyMatches.push("!=",pseudos)}),rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),hasCompare=rnative.test(docElem.compareDocumentPosition),contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=hasCompare?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;return compare||(1&(compare=(a.ownerDocument||a)==(b.ownerDocument||b)?a.compareDocumentPosition(b):1)||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a==document||a.ownerDocument==preferredDoc&&contains(preferredDoc,a)?-1:b==document||b.ownerDocument==preferredDoc&&contains(preferredDoc,b)?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0:4&compare?-1:1)}:function(a,b){if(a===b)return hasDuplicate=!0,0;var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup)return a==document?-1:b==document?1:aup?-1:bup?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]==preferredDoc?-1:bp[i]==preferredDoc?1:0}),document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if(setDocument(elem),support.matchesSelector&&documentIsHTML&&!nonnativeSelectorCache[expr+" "]&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){nonnativeSelectorCache(expr,!0)}return 0<Sizzle(expr,document,null,[elem]).length},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!=document&&setDocument(context),contains(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!=document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):void 0;return void 0!==val?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null},Sizzle.escape=function(sel){return(sel+"").replace(rcssescape,fcssescape)},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return sortInput=null,results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i++];)ret+=getText(node);return ret},(Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]?match[2]=match[4]||match[5]||"":unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||void 0!==elem.getAttribute&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:!operator||(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&-1<result.indexOf(check):"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?-1<(" "+result.replace(rwhitespace," ")+" ").indexOf(check):"|="===operator&&(result===check||result.slice(0,check.length+1)===check+"-"))}},CHILD:function(type,what,_argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,_context,xml){var cache,uniqueCache,outerCache,node,nodeIndex,start,dir=simple!=forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType,diff=!1;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(diff=(nodeIndex=(cache=(uniqueCache=(outerCache=(node=parent)[expando]||(node[expando]={}))[node.uniqueID]||(outerCache[node.uniqueID]={}))[type]||[])[0]===dirruns&&cache[1])&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){uniqueCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(diff=nodeIndex=(cache=(uniqueCache=(outerCache=(node=elem)[expando]||(node[expando]={}))[node.uniqueID]||(outerCache[node.uniqueID]={}))[type]||[])[0]===dirruns&&cache[1]),!1===diff)for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&((uniqueCache=(outerCache=node[expando]||(node[expando]={}))[node.uniqueID]||(outerCache[node.uniqueID]={}))[type]=[dirruns,diff]),node!==elem)););return(diff-=last)===first||diff%first==0&&0<=diff/first}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):1<fn.length?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)seed[idx=indexOf(seed,matched[i])]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,_context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,_context,xml){return input[0]=elem,matcher(input,null,xml,results),input[0]=null,!results.pop()}}),has:markFunction(function(selector){return function(elem){return 0<Sizzle(selector,elem).length}}),contains:markFunction(function(text){return text=text.replace(runescape,funescape),function(elem){return-1<(elem.textContent||getText(elem)).indexOf(text)}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do{if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return(elemLang=elemLang.toLowerCase())===lang||0===elemLang.indexOf(lang+"-")}while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:createDisabledPseudo(!1),disabled:createDisabledPseudo(!0),checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,!0===elem.selected},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeType<6)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||"text"===attr.toLowerCase())},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(_matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(_matchIndexes,length,argument){return[argument<0?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=argument<0?argument+length:length<argument?length:argument;0<=--i;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=argument<0?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}}).pseudos.nth=Expr.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=function(type){return function(elem){return"input"===elem.nodeName.toLowerCase()&&elem.type===type}}(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=function(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}(i);function setFilters(){}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";i<len;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,skip=combinator.next,key=skip||dir,checkNonElements=base&&"parentNode"===key,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml);return!1}:function(elem,context,xml){var oldCache,uniqueCache,outerCache,newCache=[dirruns,doneName];if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)if(uniqueCache=(outerCache=elem[expando]||(elem[expando]={}))[elem.uniqueID]||(outerCache[elem.uniqueID]={}),skip&&skip===elem.nodeName.toLowerCase())elem=elem[dir]||elem;else{if((oldCache=uniqueCache[key])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];if((uniqueCache[key]=newCache)[2]=matcher(elem,context,xml))return!0}return!1}}function elementMatcher(matchers){return 1<matchers.length?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;i<len;i++)(elem=unmatched[i])&&(filter&&!filter(elem,context,xml)||(newUnmatched.push(elem),mapped&&map.push(i)));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||function(selector,contexts,results){for(var i=0,len=contexts.length;i<len;i++)Sizzle(selector,contexts[i],results);return results}(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&-1<(temp=postFinder?indexOf(seed,elem):preMap[i])&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}return setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){for(type in matched&&!(match=rcomma.exec(soFar))||(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length)),Expr.filter)!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)},compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(i=(match=match||tokenize(selector)).length;i--;)(cached=function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return-1<indexOf(checkContext,elem)},implicitRelative,!0),matchers=[function(elem,context,xml){var ret=!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext:matchAnyContext)(elem,context,xml);return checkContext=null,ret}];i<len;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if((matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches))[expando]){for(j=++i;j<len&&!Expr.relative[tokens[j].type];j++);return setMatcher(1<i&&elementMatcher(matchers),1<i&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens(tokens=tokens.slice(j)),j<len&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}(match[i]))[expando]?setMatchers.push(cached):elementMatchers.push(cached);(cached=compilerCache(selector,function(elementMatchers,setMatchers){var bySet=0<setMatchers.length,byElement=0<elementMatchers.length,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1,len=elems.length;for(outermost&&(outermostContext=context==document||context||outermost);i!==len&&null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0,context||elem.ownerDocument==document||(setDocument(elem),xml=!documentIsHTML);matcher=elementMatchers[j++];)if(matcher(elem,context||document,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(0<matchedCount)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&0<setMatched.length&&1<matchedCount+setMatchers.length&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}(elementMatchers,setMatchers))).selector=selector}return cached},select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled="function"==typeof selector&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);if(results=results||[],1===match.length){if(2<(tokens=match[0]=match[0].slice(0)).length&&"ID"===(token=tokens[0]).type&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(!(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0]))return results;compiled&&(context=context.parentNode),selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){if(tokens.splice(i,1),!(selector=seed.length&&toSelector(tokens)))return push.apply(results,seed),results;break}}return(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,!context||rsibling.test(selector)&&testContext(context.parentNode)||context),results},support.sortStable=expando.split("").sort(sortOrder).join("")===expando,support.detectDuplicates=!!hasDuplicate,setDocument(),support.sortDetached=assert(function(el){return 1&el.compareDocumentPosition(document.createElement("fieldset"))}),assert(function(el){return el.innerHTML="<a href='#'></a>","#"===el.firstChild.getAttribute("href")})||addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML)return elem.getAttribute(name,"type"===name.toLowerCase()?1:2)}),support.attributes&&assert(function(el){return el.innerHTML="<input/>",el.firstChild.setAttribute("value",""),""===el.firstChild.getAttribute("value")})||addHandle("value",function(elem,_name,isXML){if(!isXML&&"input"===elem.nodeName.toLowerCase())return elem.defaultValue}),assert(function(el){return null==el.getAttribute("disabled")})||addHandle(booleans,function(elem,name,isXML){var val;if(!isXML)return!0===elem[name]?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}),Sizzle}(window);jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.uniqueSort=jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains,jQuery.escapeSelector=Sizzle.escape;var dir=function(elem,_dir,until){for(var matched=[],truncate=void 0!==until;(elem=elem[_dir])&&9!==elem.nodeType;)if(1===elem.nodeType){if(truncate&&jQuery(elem).is(until))break;matched.push(elem)}return matched},_siblings=function(n,elem){for(var matched=[];n;n=n.nextSibling)1===n.nodeType&&n!==elem&&matched.push(n);return matched},rneedsContext=jQuery.expr.match.needsContext;function nodeName(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()}var rsingleTag=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function winnow(elements,qualifier,not){return isFunction(qualifier)?jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not}):qualifier.nodeType?jQuery.grep(elements,function(elem){return elem===qualifier!==not}):"string"!=typeof qualifier?jQuery.grep(elements,function(elem){return-1<indexOf.call(qualifier,elem)!==not}):jQuery.filter(qualifier,elements,not)}jQuery.filter=function(expr,elems,not){var elem=elems[0];return not&&(expr=":not("+expr+")"),1===elems.length&&1===elem.nodeType?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return 1===elem.nodeType}))},jQuery.fn.extend({find:function(selector){var i,ret,len=this.length,self=this;if("string"!=typeof selector)return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++)if(jQuery.contains(self[i],this))return!0}));for(ret=this.pushStack([]),i=0;i<len;i++)jQuery.find(selector,self[i],ret);return 1<len?jQuery.uniqueSort(ret):ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],!1))},not:function(selector){return this.pushStack(winnow(this,selector||[],!0))},is:function(selector){return!!winnow(this,"string"==typeof selector&&rneedsContext.test(selector)?jQuery(selector):selector||[],!1).length}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(jQuery.fn.init=function(selector,context,root){var match,elem;if(!selector)return this;if(root=root||rootjQuery,"string"!=typeof selector)return selector.nodeType?(this[0]=selector,this.length=1,this):isFunction(selector)?void 0!==root.ready?root.ready(selector):selector(jQuery):jQuery.makeArray(selector,this);if(!(match="<"===selector[0]&&">"===selector[selector.length-1]&&3<=selector.length?[null,selector,null]:rquickExpr.exec(selector))||!match[1]&&context)return!context||context.jquery?(context||root).find(selector):this.constructor(context).find(selector);if(match[1]){if(context=context instanceof jQuery?context[0]:context,jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0)),rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)isFunction(this[match])?this[match](context[match]):this.attr(match,context[match]);return this}return(elem=document.getElementById(match[2]))&&(this[0]=elem,this.length=1),this}).prototype=jQuery.fn,rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};function sibling(cur,dir){for(;(cur=cur[dir])&&1!==cur.nodeType;);return cur}jQuery.fn.extend({has:function(target){var targets=jQuery(target,this),l=targets.length;return this.filter(function(){for(var i=0;i<l;i++)if(jQuery.contains(this,targets[i]))return!0})},closest:function(selectors,context){var cur,i=0,l=this.length,matched=[],targets="string"!=typeof selectors&&jQuery(selectors);if(!rneedsContext.test(selectors))for(;i<l;i++)for(cur=this[i];cur&&cur!==context;cur=cur.parentNode)if(cur.nodeType<11&&(targets?-1<targets.index(cur):1===cur.nodeType&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}return this.pushStack(1<matched.length?jQuery.uniqueSort(matched):matched)},index:function(elem){return elem?"string"==typeof elem?indexOf.call(jQuery(elem),this[0]):indexOf.call(this,elem.jquery?elem[0]:elem):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(selector,context){return this.pushStack(jQuery.uniqueSort(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}}),jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(elem){return dir(elem,"parentNode")},parentsUntil:function(elem,_i,until){return dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return dir(elem,"nextSibling")},prevAll:function(elem){return dir(elem,"previousSibling")},nextUntil:function(elem,_i,until){return dir(elem,"nextSibling",until)},prevUntil:function(elem,_i,until){return dir(elem,"previousSibling",until)},siblings:function(elem){return _siblings((elem.parentNode||{}).firstChild,elem)},children:function(elem){return _siblings(elem.firstChild)},contents:function(elem){return null!=elem.contentDocument&&getProto(elem.contentDocument)?elem.contentDocument:(nodeName(elem,"template")&&(elem=elem.content||elem),jQuery.merge([],elem.childNodes))}},function(name,fn){jQuery.fn[name]=function(until,selector){var matched=jQuery.map(this,fn,until);return"Until"!==name.slice(-5)&&(selector=until),selector&&"string"==typeof selector&&(matched=jQuery.filter(selector,matched)),1<this.length&&(guaranteedUnique[name]||jQuery.uniqueSort(matched),rparentsprev.test(name)&&matched.reverse()),this.pushStack(matched)}});var rnothtmlwhite=/[^\x20\t\r\n\f]+/g;function Identity(v){return v}function Thrower(ex){throw ex}function adoptValue(value,resolve,reject,noValue){var method;try{value&&isFunction(method=value.promise)?method.call(value).done(resolve).fail(reject):value&&isFunction(method=value.then)?method.call(value,resolve,reject):resolve.apply(void 0,[value].slice(noValue))}catch(value){reject.apply(void 0,[value])}}jQuery.Callbacks=function(options){options="string"==typeof options?function(options){var object={};return jQuery.each(options.match(rnothtmlwhite)||[],function(_,flag){object[flag]=!0}),object}(options):jQuery.extend({},options);var firing,memory,_fired,_locked,list=[],queue=[],firingIndex=-1,fire=function(){for(_locked=_locked||options.once,_fired=firing=!0;queue.length;firingIndex=-1)for(memory=queue.shift();++firingIndex<list.length;)!1===list[firingIndex].apply(memory[0],memory[1])&&options.stopOnFalse&&(firingIndex=list.length,memory=!1);options.memory||(memory=!1),firing=!1,_locked&&(list=memory?[]:"")},self={add:function(){return list&&(memory&&!firing&&(firingIndex=list.length-1,queue.push(memory)),function add(args){jQuery.each(args,function(_,arg){isFunction(arg)?options.unique&&self.has(arg)||list.push(arg):arg&&arg.length&&"string"!==toType(arg)&&add(arg)})}(arguments),memory&&!firing&&fire()),this},remove:function(){return jQuery.each(arguments,function(_,arg){for(var index;-1<(index=jQuery.inArray(arg,list,index));)list.splice(index,1),index<=firingIndex&&firingIndex--}),this},has:function(fn){return fn?-1<jQuery.inArray(fn,list):0<list.length},empty:function(){return list=list&&[],this},disable:function(){return _locked=queue=[],list=memory="",this},disabled:function(){return!list},lock:function(){return _locked=queue=[],memory||firing||(list=memory=""),this},locked:function(){return!!_locked},fireWith:function(context,args){return _locked||(args=[context,(args=args||[]).slice?args.slice():args],queue.push(args),firing||fire()),this},fire:function(){return self.fireWith(this,arguments),this},fired:function(){return!!_fired}};return self},jQuery.extend({Deferred:function(func){var tuples=[["notify","progress",jQuery.Callbacks("memory"),jQuery.Callbacks("memory"),2],["resolve","done",jQuery.Callbacks("once memory"),jQuery.Callbacks("once memory"),0,"resolved"],["reject","fail",jQuery.Callbacks("once memory"),jQuery.Callbacks("once memory"),1,"rejected"]],_state="pending",_promise={state:function(){return _state},always:function(){return deferred.done(arguments).fail(arguments),this},catch:function(fn){return _promise.then(null,fn)},pipe:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(_i,tuple){var fn=isFunction(fns[tuple[4]])&&fns[tuple[4]];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);returned&&isFunction(returned.promise)?returned.promise().progress(newDefer.notify).done(newDefer.resolve).fail(newDefer.reject):newDefer[tuple[0]+"With"](this,fn?[returned]:arguments)})}),fns=null}).promise()},then:function(onFulfilled,onRejected,onProgress){var maxDepth=0;function resolve(depth,deferred,handler,special){return function(){var that=this,args=arguments,mightThrow=function(){var returned,then;if(!(depth<maxDepth)){if((returned=handler.apply(that,args))===deferred.promise())throw new TypeError("Thenable self-resolution");then=returned&&("object"===(void 0===returned?"undefined":_typeof(returned))||"function"==typeof returned)&&returned.then,isFunction(then)?special?then.call(returned,resolve(maxDepth,deferred,Identity,special),resolve(maxDepth,deferred,Thrower,special)):(maxDepth++,then.call(returned,resolve(maxDepth,deferred,Identity,special),resolve(maxDepth,deferred,Thrower,special),resolve(maxDepth,deferred,Identity,deferred.notifyWith))):(handler!==Identity&&(that=void 0,args=[returned]),(special||deferred.resolveWith)(that,args))}},process=special?mightThrow:function(){try{mightThrow()}catch(e){jQuery.Deferred.exceptionHook&&jQuery.Deferred.exceptionHook(e,process.stackTrace),maxDepth<=depth+1&&(handler!==Thrower&&(that=void 0,args=[e]),deferred.rejectWith(that,args))}};depth?process():(jQuery.Deferred.getStackHook&&(process.stackTrace=jQuery.Deferred.getStackHook()),window.setTimeout(process))}}return jQuery.Deferred(function(newDefer){tuples[0][3].add(resolve(0,newDefer,isFunction(onProgress)?onProgress:Identity,newDefer.notifyWith)),tuples[1][3].add(resolve(0,newDefer,isFunction(onFulfilled)?onFulfilled:Identity)),tuples[2][3].add(resolve(0,newDefer,isFunction(onRejected)?onRejected:Thrower))}).promise()},promise:function(obj){return null!=obj?jQuery.extend(obj,_promise):_promise}},deferred={};return jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[5];_promise[tuple[1]]=list.add,stateString&&list.add(function(){_state=stateString},tuples[3-i][2].disable,tuples[3-i][3].disable,tuples[0][2].lock,tuples[0][3].lock),list.add(tuple[3].fire),deferred[tuple[0]]=function(){return deferred[tuple[0]+"With"](this===deferred?void 0:this,arguments),this},deferred[tuple[0]+"With"]=list.fireWith}),_promise.promise(deferred),func&&func.call(deferred,deferred),deferred},when:function(singleValue){var remaining=arguments.length,i=remaining,resolveContexts=Array(i),resolveValues=_slice.call(arguments),master=jQuery.Deferred(),updateFunc=function(i){return function(value){resolveContexts[i]=this,resolveValues[i]=1<arguments.length?_slice.call(arguments):value,--remaining||master.resolveWith(resolveContexts,resolveValues)}};if(remaining<=1&&(adoptValue(singleValue,master.done(updateFunc(i)).resolve,master.reject,!remaining),"pending"===master.state()||isFunction(resolveValues[i]&&resolveValues[i].then)))return master.then();for(;i--;)adoptValue(resolveValues[i],updateFunc(i),master.reject);return master.promise()}});var rerrorNames=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;jQuery.Deferred.exceptionHook=function(error,stack){window.console&&window.console.warn&&error&&rerrorNames.test(error.name)&&window.console.warn("jQuery.Deferred exception: "+error.message,error.stack,stack)},jQuery.readyException=function(error){window.setTimeout(function(){throw error})};var readyList=jQuery.Deferred();function completed(){document.removeEventListener("DOMContentLoaded",completed),window.removeEventListener("load",completed),jQuery.ready()}jQuery.fn.ready=function(fn){return readyList.then(fn).catch(function(error){jQuery.readyException(error)}),this},jQuery.extend({isReady:!1,readyWait:1,ready:function(wait){(!0===wait?--jQuery.readyWait:jQuery.isReady)||(jQuery.isReady=!0)!==wait&&0<--jQuery.readyWait||readyList.resolveWith(document,[jQuery])}}),jQuery.ready.then=readyList.then,"complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?window.setTimeout(jQuery.ready):(document.addEventListener("DOMContentLoaded",completed),window.addEventListener("load",completed));function access(elems,fn,key,value,chainable,emptyGet,raw){var i=0,len=elems.length,bulk=null==key;if("object"===toType(key))for(i in chainable=!0,key)access(elems,fn,i,key[i],!0,emptyGet,raw);else if(void 0!==value&&(chainable=!0,isFunction(value)||(raw=!0),bulk&&(fn=raw?(fn.call(elems,value),null):(bulk=fn,function(elem,_key,value){return bulk.call(jQuery(elem),value)})),fn))for(;i<len;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));return chainable?elems:bulk?fn.call(elems):len?fn(elems[0],key):emptyGet}var rmsPrefix=/^-ms-/,rdashAlpha=/-([a-z])/g;function fcamelCase(_all,letter){return letter.toUpperCase()}function camelCase(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)}var acceptData=function(owner){return 1===owner.nodeType||9===owner.nodeType||!+owner.nodeType};function Data(){this.expando=jQuery.expando+Data.uid++}Data.uid=1,Data.prototype={cache:function(owner){var value=owner[this.expando];return value||(value={},acceptData(owner)&&(owner.nodeType?owner[this.expando]=value:Object.defineProperty(owner,this.expando,{value:value,configurable:!0}))),value},set:function(owner,data,value){var prop,cache=this.cache(owner);if("string"==typeof data)cache[camelCase(data)]=value;else for(prop in data)cache[camelCase(prop)]=data[prop];return cache},get:function(owner,key){return void 0===key?this.cache(owner):owner[this.expando]&&owner[this.expando][camelCase(key)]},access:function(owner,key,value){return void 0===key||key&&"string"==typeof key&&void 0===value?this.get(owner,key):(this.set(owner,key,value),void 0!==value?value:key)},remove:function(owner,key){var i,cache=owner[this.expando];if(void 0!==cache){if(void 0!==key){i=(key=Array.isArray(key)?key.map(camelCase):(key=camelCase(key))in cache?[key]:key.match(rnothtmlwhite)||[]).length;for(;i--;)delete cache[key[i]]}void 0!==key&&!jQuery.isEmptyObject(cache)||(owner.nodeType?owner[this.expando]=void 0:delete owner[this.expando])}},hasData:function(owner){var cache=owner[this.expando];return void 0!==cache&&!jQuery.isEmptyObject(cache)}};var dataPriv=new Data,dataUser=new Data,rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/[A-Z]/g;function dataAttr(elem,key,data){var name;if(void 0===data&&1===elem.nodeType)if(name="data-"+key.replace(rmultiDash,"-$&").toLowerCase(),"string"==typeof(data=elem.getAttribute(name))){try{data=function(data){return"true"===data||"false"!==data&&("null"===data?null:data===+data+""?+data:rbrace.test(data)?JSON.parse(data):data)}(data)}catch(e){}dataUser.set(elem,key,data)}else data=void 0;return data}jQuery.extend({hasData:function(elem){return dataUser.hasData(elem)||dataPriv.hasData(elem)},data:function(elem,name,_data){return dataUser.access(elem,name,_data)},removeData:function(elem,name){dataUser.remove(elem,name)},_data:function(elem,name,data){return dataPriv.access(elem,name,data)},_removeData:function(elem,name){dataPriv.remove(elem,name)}}),jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(void 0!==key)return"object"===(void 0===key?"undefined":_typeof(key))?this.each(function(){dataUser.set(this,key)}):access(this,function(value){var data;return elem&&void 0===value?void 0!==(data=dataUser.get(elem,key))||void 0!==(data=dataAttr(elem,key))?data:void 0:void this.each(function(){dataUser.set(this,key,value)})},null,value,1<arguments.length,null,!0);if(this.length&&(data=dataUser.get(elem),1===elem.nodeType&&!dataPriv.get(elem,"hasDataAttrs"))){for(i=attrs.length;i--;)attrs[i]&&0===(name=attrs[i].name).indexOf("data-")&&(name=camelCase(name.slice(5)),dataAttr(elem,name,data[name]));dataPriv.set(elem,"hasDataAttrs",!0)}return data},removeData:function(key){return this.each(function(){dataUser.remove(this,key)})}}),jQuery.extend({queue:function(elem,type,data){var queue;if(elem)return type=(type||"fx")+"queue",queue=dataPriv.get(elem,type),data&&(!queue||Array.isArray(data)?queue=dataPriv.access(elem,type,jQuery.makeArray(data)):queue.push(data)),queue||[]},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type);"inprogress"===fn&&(fn=queue.shift(),startLength--),fn&&("fx"===type&&queue.unshift("inprogress"),delete hooks.stop,fn.call(elem,function(){jQuery.dequeue(elem,type)},hooks)),!startLength&&hooks&&hooks.empty.fire()},_queueHooks:function(elem,type){var key=type+"queueHooks";return dataPriv.get(elem,key)||dataPriv.access(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){dataPriv.remove(elem,[type+"queue",key])})})}}),jQuery.fn.extend({queue:function(type,data){var setter=2;return"string"!=typeof type&&(data=type,type="fx",setter--),arguments.length<setter?jQuery.queue(this[0],type):void 0===data?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type),"fx"===type&&"inprogress"!==queue[0]&&jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){--count||defer.resolveWith(elements,[elements])};for("string"!=typeof type&&(obj=type,type=void 0),type=type||"fx";i--;)(tmp=dataPriv.get(elements[i],type+"queueHooks"))&&tmp.empty&&(count++,tmp.empty.add(resolve));return resolve(),defer.promise(obj)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,rcssNum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),cssExpand=["Top","Right","Bottom","Left"],documentElement=document.documentElement,isAttached=function(elem){return jQuery.contains(elem.ownerDocument,elem)},composed={composed:!0};documentElement.getRootNode&&(isAttached=function(elem){return jQuery.contains(elem.ownerDocument,elem)||elem.getRootNode(composed)===elem.ownerDocument});var isHiddenWithinTree=function(elem,el){return"none"===(elem=el||elem).style.display||""===elem.style.display&&isAttached(elem)&&"none"===jQuery.css(elem,"display")};function adjustCSS(elem,prop,valueParts,tween){var adjusted,scale,maxIterations=20,currentValue=tween?function(){return tween.cur()}:function(){return jQuery.css(elem,prop,"")},initial=currentValue(),unit=valueParts&&valueParts[3]||(jQuery.cssNumber[prop]?"":"px"),initialInUnit=elem.nodeType&&(jQuery.cssNumber[prop]||"px"!==unit&&+initial)&&rcssNum.exec(jQuery.css(elem,prop));if(initialInUnit&&initialInUnit[3]!==unit){for(initial/=2,unit=unit||initialInUnit[3],initialInUnit=+initial||1;maxIterations--;)jQuery.style(elem,prop,initialInUnit+unit),(1-scale)*(1-(scale=currentValue()/initial||.5))<=0&&(maxIterations=0),initialInUnit/=scale;initialInUnit*=2,jQuery.style(elem,prop,initialInUnit+unit),valueParts=valueParts||[]}return valueParts&&(initialInUnit=+initialInUnit||+initial||0,adjusted=valueParts[1]?initialInUnit+(valueParts[1]+1)*valueParts[2]:+valueParts[2],tween&&(tween.unit=unit,tween.start=initialInUnit,tween.end=adjusted)),adjusted}var defaultDisplayMap={};function showHide(elements,show){for(var display,elem,values=[],index=0,length=elements.length;index<length;index++)(elem=elements[index]).style&&(display=elem.style.display,show?("none"===display&&(values[index]=dataPriv.get(elem,"display")||null,values[index]||(elem.style.display="")),""===elem.style.display&&isHiddenWithinTree(elem)&&(values[index]=function(elem){var temp,doc=elem.ownerDocument,nodeName=elem.nodeName,display=defaultDisplayMap[nodeName];return display||(temp=doc.body.appendChild(doc.createElement(nodeName)),display=jQuery.css(temp,"display"),temp.parentNode.removeChild(temp),"none"===display&&(display="block"),defaultDisplayMap[nodeName]=display)}(elem))):"none"!==display&&(values[index]="none",dataPriv.set(elem,"display",display)));for(index=0;index<length;index++)null!=values[index]&&(elements[index].style.display=values[index]);return elements}jQuery.fn.extend({show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(state){return"boolean"==typeof state?state?this.show():this.hide():this.each(function(){isHiddenWithinTree(this)?jQuery(this).show():jQuery(this).hide()})}});var div,input,rcheckableType=/^(?:checkbox|radio)$/i,rtagName=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,rscriptType=/^$|^module$|\/(?:java|ecma)script/i;div=document.createDocumentFragment().appendChild(document.createElement("div")),(input=document.createElement("input")).setAttribute("type","radio"),input.setAttribute("checked","checked"),input.setAttribute("name","t"),div.appendChild(input),support.checkClone=div.cloneNode(!0).cloneNode(!0).lastChild.checked,div.innerHTML="<textarea>x</textarea>",support.noCloneChecked=!!div.cloneNode(!0).lastChild.defaultValue,div.innerHTML="<option></option>",support.option=!!div.lastChild;var wrapMap={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function getAll(context,tag){var ret=void 0!==context.getElementsByTagName?context.getElementsByTagName(tag||"*"):void 0!==context.querySelectorAll?context.querySelectorAll(tag||"*"):[];return void 0===tag||tag&&nodeName(context,tag)?jQuery.merge([context],ret):ret}function setGlobalEval(elems,refElements){for(var i=0,l=elems.length;i<l;i++)dataPriv.set(elems[i],"globalEval",!refElements||dataPriv.get(refElements[i],"globalEval"))}wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td,support.option||(wrapMap.optgroup=wrapMap.option=[1,"<select multiple='multiple'>","</select>"]);var rhtml=/<|&#?\w+;/;function buildFragment(elems,context,scripts,selection,ignored){for(var elem,tmp,tag,wrap,attached,j,fragment=context.createDocumentFragment(),nodes=[],i=0,l=elems.length;i<l;i++)if((elem=elems[i])||0===elem)if("object"===toType(elem))jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(rhtml.test(elem)){for(tmp=tmp||fragment.appendChild(context.createElement("div")),tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+jQuery.htmlPrefilter(elem)+wrap[2],j=wrap[0];j--;)tmp=tmp.lastChild;jQuery.merge(nodes,tmp.childNodes),(tmp=fragment.firstChild).textContent=""}else nodes.push(context.createTextNode(elem));for(fragment.textContent="",i=0;elem=nodes[i++];)if(selection&&-1<jQuery.inArray(elem,selection))ignored&&ignored.push(elem);else if(attached=isAttached(elem),tmp=getAll(fragment.appendChild(elem),"script"),attached&&setGlobalEval(tmp),scripts)for(j=0;elem=tmp[j++];)rscriptType.test(elem.type||"")&&scripts.push(elem);return fragment}var rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,rtypenamespace=/^([^.]*)(?:\.(.+)|)/;function returnTrue(){return!0}function returnFalse(){return!1}function expectSync(elem,type){return elem===function(){try{return document.activeElement}catch(err){}}()==("focus"===type)}function _on(elem,types,selector,data,fn,one){var origFn,type;if("object"===(void 0===types?"undefined":_typeof(types))){for(type in"string"!=typeof selector&&(data=data||selector,selector=void 0),types)_on(elem,type,selector,data,types[type],one);return elem}if(null==data&&null==fn?(fn=selector,data=selector=void 0):null==fn&&("string"==typeof selector?(fn=data,data=void 0):(fn=data,data=selector,selector=void 0)),!1===fn)fn=returnFalse;else if(!fn)return elem;return 1===one&&(origFn=fn,(fn=function(event){return jQuery().off(event),origFn.apply(this,arguments)}).guid=origFn.guid||(origFn.guid=jQuery.guid++)),elem.each(function(){jQuery.event.add(this,types,fn,data,selector)})}function leverageNative(el,type,expectSync){expectSync?(dataPriv.set(el,type,!1),jQuery.event.add(el,type,{namespace:!1,handler:function(event){var notAsync,result,saved=dataPriv.get(this,type);if(1&event.isTrigger&&this[type]){if(saved.length)(jQuery.event.special[type]||{}).delegateType&&event.stopPropagation();else if(saved=_slice.call(arguments),dataPriv.set(this,type,saved),notAsync=expectSync(this,type),this[type](),saved!==(result=dataPriv.get(this,type))||notAsync?dataPriv.set(this,type,!1):result={},saved!==result)return event.stopImmediatePropagation(),event.preventDefault(),result.value}else saved.length&&(dataPriv.set(this,type,{value:jQuery.event.trigger(jQuery.extend(saved[0],jQuery.Event.prototype),saved.slice(1),this)}),event.stopImmediatePropagation())}})):void 0===dataPriv.get(el,type)&&jQuery.event.add(el,type,returnTrue)}jQuery.event={global:{},add:function(elem,types,handler,data,selector){var handleObjIn,eventHandle,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.get(elem);if(acceptData(elem))for(handler.handler&&(handler=(handleObjIn=handler).handler,selector=handleObjIn.selector),selector&&jQuery.find.matchesSelector(documentElement,selector),handler.guid||(handler.guid=jQuery.guid++),(events=elemData.events)||(events=elemData.events=Object.create(null)),(eventHandle=elemData.handle)||(eventHandle=elemData.handle=function(e){return void 0!==jQuery&&jQuery.event.triggered!==e.type?jQuery.event.dispatch.apply(elem,arguments):void 0}),t=(types=(types||"").match(rnothtmlwhite)||[""]).length;t--;)type=origType=(tmp=rtypenamespace.exec(types[t])||[])[1],namespaces=(tmp[2]||"").split(".").sort(),type&&(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,special=jQuery.event.special[type]||{},handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn),(handlers=events[type])||((handlers=events[type]=[]).delegateCount=0,special.setup&&!1!==special.setup.call(elem,data,namespaces,eventHandle)||elem.addEventListener&&elem.addEventListener(type,eventHandle)),special.add&&(special.add.call(elem,handleObj),handleObj.handler.guid||(handleObj.handler.guid=handler.guid)),selector?handlers.splice(handlers.delegateCount++,0,handleObj):handlers.push(handleObj),jQuery.event.global[type]=!0)},remove:function(elem,types,handler,selector,mappedTypes){var j,origCount,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.hasData(elem)&&dataPriv.get(elem);if(elemData&&(events=elemData.events)){for(t=(types=(types||"").match(rnothtmlwhite)||[""]).length;t--;)if(type=origType=(tmp=rtypenamespace.exec(types[t])||[])[1],namespaces=(tmp[2]||"").split(".").sort(),type){for(special=jQuery.event.special[type]||{},handlers=events[type=(selector?special.delegateType:special.bindType)||type]||[],tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"),origCount=j=handlers.length;j--;)handleObj=handlers[j],!mappedTypes&&origType!==handleObj.origType||handler&&handler.guid!==handleObj.guid||tmp&&!tmp.test(handleObj.namespace)||selector&&selector!==handleObj.selector&&("**"!==selector||!handleObj.selector)||(handlers.splice(j,1),handleObj.selector&&handlers.delegateCount--,special.remove&&special.remove.call(elem,handleObj));origCount&&!handlers.length&&(special.teardown&&!1!==special.teardown.call(elem,namespaces,elemData.handle)||jQuery.removeEvent(elem,type,elemData.handle),delete events[type])}else for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,!0);jQuery.isEmptyObject(events)&&dataPriv.remove(elem,"handle events")}},dispatch:function(nativeEvent){var i,j,ret,matched,handleObj,handlerQueue,args=new Array(arguments.length),event=jQuery.event.fix(nativeEvent),handlers=(dataPriv.get(this,"events")||Object.create(null))[event.type]||[],special=jQuery.event.special[event.type]||{};for(args[0]=event,i=1;i<arguments.length;i++)args[i]=arguments[i];if(event.delegateTarget=this,!special.preDispatch||!1!==special.preDispatch.call(this,event)){for(handlerQueue=jQuery.event.handlers.call(this,event,handlers),i=0;(matched=handlerQueue[i++])&&!event.isPropagationStopped();)for(event.currentTarget=matched.elem,j=0;(handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped();)event.rnamespace&&!1!==handleObj.namespace&&!event.rnamespace.test(handleObj.namespace)||(event.handleObj=handleObj,event.data=handleObj.data,void 0!==(ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args))&&!1===(event.result=ret)&&(event.preventDefault(),event.stopPropagation()));return special.postDispatch&&special.postDispatch.call(this,event),event.result}},handlers:function(event,_handlers){var i,handleObj,sel,matchedHandlers,matchedSelectors,handlerQueue=[],delegateCount=_handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&!("click"===event.type&&1<=event.button))for(;cur!==this;cur=cur.parentNode||this)if(1===cur.nodeType&&("click"!==event.type||!0!==cur.disabled)){for(matchedHandlers=[],matchedSelectors={},i=0;i<delegateCount;i++)void 0===matchedSelectors[sel=(handleObj=_handlers[i]).selector+" "]&&(matchedSelectors[sel]=handleObj.needsContext?-1<jQuery(sel,this).index(cur):jQuery.find(sel,this,null,[cur]).length),matchedSelectors[sel]&&matchedHandlers.push(handleObj);matchedHandlers.length&&handlerQueue.push({elem:cur,handlers:matchedHandlers})}return cur=this,delegateCount<_handlers.length&&handlerQueue.push({elem:cur,handlers:_handlers.slice(delegateCount)}),handlerQueue},addProp:function(name,hook){Object.defineProperty(jQuery.Event.prototype,name,{enumerable:!0,configurable:!0,get:isFunction(hook)?function(){if(this.originalEvent)return hook(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[name]},set:function(value){Object.defineProperty(this,name,{enumerable:!0,configurable:!0,writable:!0,value:value})}})},fix:function(originalEvent){return originalEvent[jQuery.expando]?originalEvent:new jQuery.Event(originalEvent)},special:{load:{noBubble:!0},click:{setup:function(data){var el=this||data;return rcheckableType.test(el.type)&&el.click&&nodeName(el,"input")&&leverageNative(el,"click",returnTrue),!1},trigger:function(data){var el=this||data;return rcheckableType.test(el.type)&&el.click&&nodeName(el,"input")&&leverageNative(el,"click"),!0},_default:function(event){var target=event.target;return rcheckableType.test(target.type)&&target.click&&nodeName(target,"input")&&dataPriv.get(target,"click")||nodeName(target,"a")}},beforeunload:{postDispatch:function(event){void 0!==event.result&&event.originalEvent&&(event.originalEvent.returnValue=event.result)}}}},jQuery.removeEvent=function(elem,type,handle){elem.removeEventListener&&elem.removeEventListener(type,handle)},jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event))return new jQuery.Event(src,props);src&&src.type?(this.originalEvent=src,this.type=src.type,this.isDefaultPrevented=src.defaultPrevented||void 0===src.defaultPrevented&&!1===src.returnValue?returnTrue:returnFalse,this.target=src.target&&3===src.target.nodeType?src.target.parentNode:src.target,this.currentTarget=src.currentTarget,this.relatedTarget=src.relatedTarget):this.type=src,props&&jQuery.extend(this,props),this.timeStamp=src&&src.timeStamp||Date.now(),this[jQuery.expando]=!0},jQuery.Event.prototype={constructor:jQuery.Event,isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},jQuery.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(event){var button=event.button;return null==event.which&&rkeyEvent.test(event.type)?null!=event.charCode?event.charCode:event.keyCode:!event.which&&void 0!==button&&rmouseEvent.test(event.type)?1&button?1:2&button?3:4&button?2:0:event.which}},jQuery.event.addProp),jQuery.each({focus:"focusin",blur:"focusout"},function(type,delegateType){jQuery.event.special[type]={setup:function(){return leverageNative(this,type,expectSync),!1},trigger:function(){return leverageNative(this,type),!0},delegateType:delegateType}}),jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,related=event.relatedTarget,handleObj=event.handleObj;return related&&(related===this||jQuery.contains(this,related))||(event.type=handleObj.origType,ret=handleObj.handler.apply(this,arguments),event.type=fix),ret}}}),jQuery.fn.extend({on:function(types,selector,data,fn){return _on(this,types,selector,data,fn)},one:function(types,selector,data,fn){return _on(this,types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj)return handleObj=types.handleObj,jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler),this;if("object"!==(void 0===types?"undefined":_typeof(types)))return!1!==selector&&"function"!=typeof selector||(fn=selector,selector=void 0),!1===fn&&(fn=returnFalse),this.each(function(){jQuery.event.remove(this,types,fn,selector)});for(type in types)this.off(type,selector,types[type]);return this}});var rnoInnerhtml=/<script|<style|<link/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function manipulationTarget(elem,content){return nodeName(elem,"table")&&nodeName(11!==content.nodeType?content:content.firstChild,"tr")&&jQuery(elem).children("tbody")[0]||elem}function disableScript(elem){return elem.type=(null!==elem.getAttribute("type"))+"/"+elem.type,elem}function restoreScript(elem){return"true/"===(elem.type||"").slice(0,5)?elem.type=elem.type.slice(5):elem.removeAttribute("type"),elem}function cloneCopyEvent(src,dest){var i,l,type,udataOld,udataCur,events;if(1===dest.nodeType){if(dataPriv.hasData(src)&&(events=dataPriv.get(src).events))for(type in dataPriv.remove(dest,"handle events"),events)for(i=0,l=events[type].length;i<l;i++)jQuery.event.add(dest,type,events[type][i]);dataUser.hasData(src)&&(udataOld=dataUser.access(src),udataCur=jQuery.extend({},udataOld),dataUser.set(dest,udataCur))}}function domManip(collection,args,callback,ignored){args=flat(args);var fragment,first,scripts,hasScripts,node,doc,i=0,l=collection.length,iNoClone=l-1,value=args[0],valueIsFunction=isFunction(value);if(valueIsFunction||1<l&&"string"==typeof value&&!support.checkClone&&rchecked.test(value))return collection.each(function(index){var self=collection.eq(index);valueIsFunction&&(args[0]=value.call(this,index,self.html())),domManip(self,args,callback,ignored)});if(l&&(first=(fragment=buildFragment(args,collection[0].ownerDocument,!1,collection,ignored)).firstChild,1===fragment.childNodes.length&&(fragment=first),first||ignored)){for(hasScripts=(scripts=jQuery.map(getAll(fragment,"script"),disableScript)).length;i<l;i++)node=fragment,i!==iNoClone&&(node=jQuery.clone(node,!0,!0),hasScripts&&jQuery.merge(scripts,getAll(node,"script"))),callback.call(collection[i],node,i);if(hasScripts)for(doc=scripts[scripts.length-1].ownerDocument,jQuery.map(scripts,restoreScript),i=0;i<hasScripts;i++)node=scripts[i],rscriptType.test(node.type||"")&&!dataPriv.access(node,"globalEval")&&jQuery.contains(doc,node)&&(node.src&&"module"!==(node.type||"").toLowerCase()?jQuery._evalUrl&&!node.noModule&&jQuery._evalUrl(node.src,{nonce:node.nonce||node.getAttribute("nonce")},doc):DOMEval(node.textContent.replace(rcleanScript,""),node,doc))}return collection}function _remove(elem,selector,keepData){for(var node,nodes=selector?jQuery.filter(selector,elem):elem,i=0;null!=(node=nodes[i]);i++)keepData||1!==node.nodeType||jQuery.cleanData(getAll(node)),node.parentNode&&(keepData&&isAttached(node)&&setGlobalEval(getAll(node,"script")),node.parentNode.removeChild(node));return elem}jQuery.extend({htmlPrefilter:function(html){return html},clone:function(elem,dataAndEvents,deepDataAndEvents){var i,l,srcElements,destElements,src,dest,nodeName,clone=elem.cloneNode(!0),inPage=isAttached(elem);if(!(support.noCloneChecked||1!==elem.nodeType&&11!==elem.nodeType||jQuery.isXMLDoc(elem)))for(destElements=getAll(clone),i=0,l=(srcElements=getAll(elem)).length;i<l;i++)src=srcElements[i],dest=destElements[i],nodeName=void 0,"input"===(nodeName=dest.nodeName.toLowerCase())&&rcheckableType.test(src.type)?dest.checked=src.checked:"input"!==nodeName&&"textarea"!==nodeName||(dest.defaultValue=src.defaultValue);if(dataAndEvents)if(deepDataAndEvents)for(srcElements=srcElements||getAll(elem),destElements=destElements||getAll(clone),i=0,l=srcElements.length;i<l;i++)cloneCopyEvent(srcElements[i],destElements[i]);else cloneCopyEvent(elem,clone);return 0<(destElements=getAll(clone,"script")).length&&setGlobalEval(destElements,!inPage&&getAll(elem,"script")),clone},cleanData:function(elems){for(var data,elem,type,special=jQuery.event.special,i=0;void 0!==(elem=elems[i]);i++)if(acceptData(elem)){if(data=elem[dataPriv.expando]){if(data.events)for(type in data.events)special[type]?jQuery.event.remove(elem,type):jQuery.removeEvent(elem,type,data.handle);elem[dataPriv.expando]=void 0}elem[dataUser.expando]&&(elem[dataUser.expando]=void 0)}}}),jQuery.fn.extend({detach:function(selector){return _remove(this,selector,!0)},remove:function(selector){return _remove(this,selector)},text:function(value){return access(this,function(value){return void 0===value?jQuery.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=value)})},null,value,arguments.length)},append:function(){return domManip(this,arguments,function(elem){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||manipulationTarget(this,elem).appendChild(elem)})},prepend:function(){return domManip(this,arguments,function(elem){var target;1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(target=manipulationTarget(this,elem)).insertBefore(elem,target.firstChild)})},before:function(){return domManip(this,arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this)})},after:function(){return domManip(this,arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this.nextSibling)})},empty:function(){for(var elem,i=0;null!=(elem=this[i]);i++)1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.textContent="");return this},clone:function(dataAndEvents,deepDataAndEvents){return dataAndEvents=null!=dataAndEvents&&dataAndEvents,deepDataAndEvents=null==deepDataAndEvents?dataAndEvents:deepDataAndEvents,this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(void 0===value&&1===elem.nodeType)return elem.innerHTML;if("string"==typeof value&&!rnoInnerhtml.test(value)&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=jQuery.htmlPrefilter(value);try{for(;i<l;i++)1===(elem=this[i]||{}).nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.innerHTML=value);elem=0}catch(e){}}elem&&this.empty().append(value)},null,value,arguments.length)},replaceWith:function(){var ignored=[];return domManip(this,arguments,function(elem){var parent=this.parentNode;jQuery.inArray(this,ignored)<0&&(jQuery.cleanData(getAll(this)),parent&&parent.replaceChild(elem,this))},ignored)}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){for(var elems,ret=[],insert=jQuery(selector),last=insert.length-1,i=0;i<=last;i++)elems=i===last?this:this.clone(!0),jQuery(insert[i])[original](elems),push.apply(ret,elems.get());return this.pushStack(ret)}});var rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i"),getStyles=function(elem){var view=elem.ownerDocument.defaultView;return view&&view.opener||(view=window),view.getComputedStyle(elem)},swap=function(elem,options,callback){var ret,name,old={};for(name in options)old[name]=elem.style[name],elem.style[name]=options[name];for(name in ret=callback.call(elem),options)elem.style[name]=old[name];return ret},rboxStyle=new RegExp(cssExpand.join("|"),"i");function curCSS(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;return(computed=computed||getStyles(elem))&&(""!==(ret=computed.getPropertyValue(name)||computed[name])||isAttached(elem)||(ret=jQuery.style(elem,name)),!support.pixelBoxStyles()&&rnumnonpx.test(ret)&&rboxStyle.test(name)&&(width=style.width,minWidth=style.minWidth,maxWidth=style.maxWidth,style.minWidth=style.maxWidth=style.width=ret,ret=computed.width,style.width=width,style.minWidth=minWidth,style.maxWidth=maxWidth)),void 0!==ret?ret+"":ret}function addGetHookIf(conditionFn,hookFn){return{get:function(){if(!conditionFn())return(this.get=hookFn).apply(this,arguments);delete this.get}}}!function(){function computeStyleTests(){var divStyle;div&&(container.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",div.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",documentElement.appendChild(container).appendChild(div),divStyle=window.getComputedStyle(div),pixelPositionVal="1%"!==divStyle.top,reliableMarginLeftVal=12===roundPixelMeasures(divStyle.marginLeft),div.style.right="60%",pixelBoxStylesVal=36===roundPixelMeasures(divStyle.right),boxSizingReliableVal=36===roundPixelMeasures(divStyle.width),div.style.position="absolute",scrollboxSizeVal=12===roundPixelMeasures(div.offsetWidth/3),documentElement.removeChild(container),div=null)}function roundPixelMeasures(measure){return Math.round(parseFloat(measure))}var pixelPositionVal,boxSizingReliableVal,scrollboxSizeVal,pixelBoxStylesVal,reliableTrDimensionsVal,reliableMarginLeftVal,container=document.createElement("div"),div=document.createElement("div");div.style&&(div.style.backgroundClip="content-box",div.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===div.style.backgroundClip,jQuery.extend(support,{boxSizingReliable:function(){return computeStyleTests(),boxSizingReliableVal},pixelBoxStyles:function(){return computeStyleTests(),pixelBoxStylesVal},pixelPosition:function(){return computeStyleTests(),pixelPositionVal},reliableMarginLeft:function(){return computeStyleTests(),reliableMarginLeftVal},scrollboxSize:function(){return computeStyleTests(),scrollboxSizeVal},reliableTrDimensions:function(){var table,tr,trChild,trStyle;return null==reliableTrDimensionsVal&&(table=document.createElement("table"),tr=document.createElement("tr"),trChild=document.createElement("div"),table.style.cssText="position:absolute;left:-11111px",tr.style.height="1px",trChild.style.height="9px",documentElement.appendChild(table).appendChild(tr).appendChild(trChild),trStyle=window.getComputedStyle(tr),reliableTrDimensionsVal=3<parseInt(trStyle.height),documentElement.removeChild(table)),reliableTrDimensionsVal}}))}();var cssPrefixes=["Webkit","Moz","ms"],emptyStyle=document.createElement("div").style,vendorProps={};function finalPropName(name){var final=jQuery.cssProps[name]||vendorProps[name];return final||(name in emptyStyle?name:vendorProps[name]=function(name){for(var capName=name[0].toUpperCase()+name.slice(1),i=cssPrefixes.length;i--;)if((name=cssPrefixes[i]+capName)in emptyStyle)return name}(name)||name)}var rdisplayswap=/^(none|table(?!-c[ea]).+)/,rcustomProp=/^--/,cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"};function setPositiveNumber(_elem,value,subtract){var matches=rcssNum.exec(value);return matches?Math.max(0,matches[2]-(subtract||0))+(matches[3]||"px"):value}function boxModelAdjustment(elem,dimension,box,isBorderBox,styles,computedVal){var i="width"===dimension?1:0,extra=0,delta=0;if(box===(isBorderBox?"border":"content"))return 0;for(;i<4;i+=2)"margin"===box&&(delta+=jQuery.css(elem,box+cssExpand[i],!0,styles)),isBorderBox?("content"===box&&(delta-=jQuery.css(elem,"padding"+cssExpand[i],!0,styles)),"margin"!==box&&(delta-=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles))):(delta+=jQuery.css(elem,"padding"+cssExpand[i],!0,styles),"padding"!==box?delta+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles):extra+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles));return!isBorderBox&&0<=computedVal&&(delta+=Math.max(0,Math.ceil(elem["offset"+dimension[0].toUpperCase()+dimension.slice(1)]-computedVal-delta-extra-.5))||0),delta}function getWidthOrHeight(elem,dimension,extra){var styles=getStyles(elem),isBorderBox=(!support.boxSizingReliable()||extra)&&"border-box"===jQuery.css(elem,"boxSizing",!1,styles),valueIsBorderBox=isBorderBox,val=curCSS(elem,dimension,styles),offsetProp="offset"+dimension[0].toUpperCase()+dimension.slice(1);if(rnumnonpx.test(val)){if(!extra)return val;val="auto"}return(!support.boxSizingReliable()&&isBorderBox||!support.reliableTrDimensions()&&nodeName(elem,"tr")||"auto"===val||!parseFloat(val)&&"inline"===jQuery.css(elem,"display",!1,styles))&&elem.getClientRects().length&&(isBorderBox="border-box"===jQuery.css(elem,"boxSizing",!1,styles),(valueIsBorderBox=offsetProp in elem)&&(val=elem[offsetProp])),(val=parseFloat(val)||0)+boxModelAdjustment(elem,dimension,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles,val)+"px"}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return""===ret?"1":ret}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(elem,name,value,extra){if(elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style){var ret,type,hooks,origName=camelCase(name),isCustomProp=rcustomProp.test(name),style=elem.style;if(isCustomProp||(name=finalPropName(origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],void 0===value)return hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,!1,extra))?ret:style[name];"string"===(type=void 0===value?"undefined":_typeof(value))&&(ret=rcssNum.exec(value))&&ret[1]&&(value=adjustCSS(elem,name,ret),type="number"),null!=value&&value==value&&("number"!==type||isCustomProp||(value+=ret&&ret[3]||(jQuery.cssNumber[origName]?"":"px")),support.clearCloneStyle||""!==value||0!==name.indexOf("background")||(style[name]="inherit"),hooks&&"set"in hooks&&void 0===(value=hooks.set(elem,value,extra))||(isCustomProp?style.setProperty(name,value):style[name]=value))}},css:function(elem,name,extra,styles){var val,num,hooks,origName=camelCase(name);return rcustomProp.test(name)||(name=finalPropName(origName)),(hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName])&&"get"in hooks&&(val=hooks.get(elem,!0,extra)),void 0===val&&(val=curCSS(elem,name,styles)),"normal"===val&&name in cssNormalTransform&&(val=cssNormalTransform[name]),""===extra||extra?(num=parseFloat(val),!0===extra||isFinite(num)?num||0:val):val}}),jQuery.each(["height","width"],function(_i,dimension){jQuery.cssHooks[dimension]={get:function(elem,computed,extra){if(computed)return!rdisplayswap.test(jQuery.css(elem,"display"))||elem.getClientRects().length&&elem.getBoundingClientRect().width?getWidthOrHeight(elem,dimension,extra):swap(elem,cssShow,function(){return getWidthOrHeight(elem,dimension,extra)})},set:function(elem,value,extra){var matches,styles=getStyles(elem),scrollboxSizeBuggy=!support.scrollboxSize()&&"absolute"===styles.position,isBorderBox=(scrollboxSizeBuggy||extra)&&"border-box"===jQuery.css(elem,"boxSizing",!1,styles),subtract=extra?boxModelAdjustment(elem,dimension,extra,isBorderBox,styles):0;return isBorderBox&&scrollboxSizeBuggy&&(subtract-=Math.ceil(elem["offset"+dimension[0].toUpperCase()+dimension.slice(1)]-parseFloat(styles[dimension])-boxModelAdjustment(elem,dimension,"border",!1,styles)-.5)),subtract&&(matches=rcssNum.exec(value))&&"px"!==(matches[3]||"px")&&(elem.style[dimension]=value,value=jQuery.css(elem,dimension)),setPositiveNumber(0,value,subtract)}}}),jQuery.cssHooks.marginLeft=addGetHookIf(support.reliableMarginLeft,function(elem,computed){if(computed)return(parseFloat(curCSS(elem,"marginLeft"))||elem.getBoundingClientRect().left-swap(elem,{marginLeft:0},function(){return elem.getBoundingClientRect().left}))+"px"}),jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){for(var i=0,expanded={},parts="string"==typeof value?value.split(" "):[value];i<4;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded}},"margin"!==prefix&&(jQuery.cssHooks[prefix+suffix].set=setPositiveNumber)}),jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(Array.isArray(name)){for(styles=getStyles(elem),len=name.length;i<len;i++)map[name[i]]=jQuery.css(elem,name[i],!1,styles);return map}return void 0!==value?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,1<arguments.length)}}),(jQuery.Tween=Tween).prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem,this.prop=prop,this.easing=easing||jQuery.easing._default,this.options=options,this.start=this.now=this.cur(),this.end=end,this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];return this.options.duration?this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration):this.pos=eased=percent,this.now=(this.end-this.start)*eased+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),hooks&&hooks.set?hooks.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(tween){var result;return 1!==tween.elem.nodeType||null!=tween.elem[tween.prop]&&null==tween.elem.style[tween.prop]?tween.elem[tween.prop]:(result=jQuery.css(tween.elem,tween.prop,""))&&"auto"!==result?result:0},set:function(tween){jQuery.fx.step[tween.prop]?jQuery.fx.step[tween.prop](tween):1!==tween.elem.nodeType||!jQuery.cssHooks[tween.prop]&&null==tween.elem.style[finalPropName(tween.prop)]?tween.elem[tween.prop]=tween.now:jQuery.style(tween.elem,tween.prop,tween.now+tween.unit)}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){tween.elem.nodeType&&tween.elem.parentNode&&(tween.elem[tween.prop]=tween.now)}},jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2},_default:"swing"},jQuery.fx=Tween.prototype.init,jQuery.fx.step={};var fxNow,inProgress,rfxtypes=/^(?:toggle|show|hide)$/,rrun=/queueHooks$/;function schedule(){inProgress&&(!1===document.hidden&&window.requestAnimationFrame?window.requestAnimationFrame(schedule):window.setTimeout(schedule,jQuery.fx.interval),jQuery.fx.tick())}function createFxNow(){return window.setTimeout(function(){fxNow=void 0}),fxNow=Date.now()}function genFx(type,includeWidth){var which,i=0,attrs={height:type};for(includeWidth=includeWidth?1:0;i<4;i+=2-includeWidth)attrs["margin"+(which=cssExpand[i])]=attrs["padding"+which]=type;return includeWidth&&(attrs.opacity=attrs.width=type),attrs}function createTween(value,prop,animation){for(var tween,collection=(Animation.tweeners[prop]||[]).concat(Animation.tweeners["*"]),index=0,length=collection.length;index<length;index++)if(tween=collection[index].call(animation,prop,value))return tween}function Animation(elem,properties,options){var result,stopped,index=0,length=Animation.prefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped)return!1;for(var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),percent=1-(remaining/animation.duration||0),index=0,length=animation.tweens.length;index<length;index++)animation.tweens[index].run(percent);return deferred.notifyWith(elem,[animation,percent,remaining]),percent<1&&length?remaining:(length||deferred.notifyWith(elem,[animation,1,0]),deferred.resolveWith(elem,[animation]),!1)},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{},easing:jQuery.easing._default},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);return animation.tweens.push(tween),tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;for(stopped=!0;index<length;index++)animation.tweens[index].run(1);return gotoEnd?(deferred.notifyWith(elem,[animation,1,0]),deferred.resolveWith(elem,[animation,gotoEnd])):deferred.rejectWith(elem,[animation,gotoEnd]),this}}),props=animation.props;for(!function(props,specialEasing){var index,name,easing,value,hooks;for(index in props)if(easing=specialEasing[name=camelCase(index)],value=props[index],Array.isArray(value)&&(easing=value[1],value=props[index]=value[0]),index!==name&&(props[name]=value,delete props[index]),(hooks=jQuery.cssHooks[name])&&"expand"in hooks)for(index in value=hooks.expand(value),delete props[name],value)index in props||(props[index]=value[index],specialEasing[index]=easing);else specialEasing[name]=easing}(props,animation.opts.specialEasing);index<length;index++)if(result=Animation.prefilters[index].call(animation,elem,props,animation.opts))return isFunction(result.stop)&&(jQuery._queueHooks(animation.elem,animation.opts.queue).stop=result.stop.bind(result)),result;return jQuery.map(props,createTween,animation),isFunction(animation.opts.start)&&animation.opts.start.call(elem,animation),animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always),jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue})),animation}jQuery.Animation=jQuery.extend(Animation,{tweeners:{"*":[function(prop,value){var tween=this.createTween(prop,value);return adjustCSS(tween.elem,prop,rcssNum.exec(value),tween),tween}]},tweener:function(props,callback){for(var prop,index=0,length=(props=isFunction(props)?(callback=props,["*"]):props.match(rnothtmlwhite)).length;index<length;index++)prop=props[index],Animation.tweeners[prop]=Animation.tweeners[prop]||[],Animation.tweeners[prop].unshift(callback)},prefilters:[function(elem,props,opts){var prop,value,toggle,hooks,oldfire,propTween,restoreDisplay,display,isBox="width"in props||"height"in props,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHiddenWithinTree(elem),dataShow=dataPriv.get(elem,"fxshow");for(prop in opts.queue||(null==(hooks=jQuery._queueHooks(elem,"fx")).unqueued&&(hooks.unqueued=0,oldfire=hooks.empty.fire,hooks.empty.fire=function(){hooks.unqueued||oldfire()}),hooks.unqueued++,anim.always(function(){anim.always(function(){hooks.unqueued--,jQuery.queue(elem,"fx").length||hooks.empty.fire()})})),props)if(value=props[prop],rfxtypes.test(value)){if(delete props[prop],toggle=toggle||"toggle"===value,value===(hidden?"hide":"show")){if("show"!==value||!dataShow||void 0===dataShow[prop])continue;hidden=!0}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}if((propTween=!jQuery.isEmptyObject(props))||!jQuery.isEmptyObject(orig))for(prop in isBox&&1===elem.nodeType&&(opts.overflow=[style.overflow,style.overflowX,style.overflowY],null==(restoreDisplay=dataShow&&dataShow.display)&&(restoreDisplay=dataPriv.get(elem,"display")),"none"===(display=jQuery.css(elem,"display"))&&(restoreDisplay?display=restoreDisplay:(showHide([elem],!0),restoreDisplay=elem.style.display||restoreDisplay,display=jQuery.css(elem,"display"),showHide([elem]))),("inline"===display||"inline-block"===display&&null!=restoreDisplay)&&"none"===jQuery.css(elem,"float")&&(propTween||(anim.done(function(){style.display=restoreDisplay}),null==restoreDisplay&&(display=style.display,restoreDisplay="none"===display?"":display)),style.display="inline-block")),opts.overflow&&(style.overflow="hidden",anim.always(function(){style.overflow=opts.overflow[0],style.overflowX=opts.overflow[1],style.overflowY=opts.overflow[2]})),propTween=!1,orig)propTween||(dataShow?"hidden"in dataShow&&(hidden=dataShow.hidden):dataShow=dataPriv.access(elem,"fxshow",{display:restoreDisplay}),toggle&&(dataShow.hidden=!hidden),hidden&&showHide([elem],!0),anim.done(function(){for(prop in hidden||showHide([elem]),dataPriv.remove(elem,"fxshow"),orig)jQuery.style(elem,prop,orig[prop])})),propTween=createTween(hidden?dataShow[prop]:0,prop,anim),prop in dataShow||(dataShow[prop]=propTween.start,hidden&&(propTween.end=propTween.start,propTween.start=0))}],prefilter:function(callback,prepend){prepend?Animation.prefilters.unshift(callback):Animation.prefilters.push(callback)}}),jQuery.speed=function(speed,easing,fn){var opt=speed&&"object"===(void 0===speed?"undefined":_typeof(speed))?jQuery.extend({},speed):{complete:fn||!fn&&easing||isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!isFunction(easing)&&easing};return jQuery.fx.off?opt.duration=0:"number"!=typeof opt.duration&&(opt.duration in jQuery.fx.speeds?opt.duration=jQuery.fx.speeds[opt.duration]:opt.duration=jQuery.fx.speeds._default),null!=opt.queue&&!0!==opt.queue||(opt.queue="fx"),opt.old=opt.complete,opt.complete=function(){isFunction(opt.old)&&opt.old.call(this),opt.queue&&jQuery.dequeue(this,opt.queue)},opt},jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHiddenWithinTree).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);(empty||dataPriv.get(this,"finish"))&&anim.stop(!0)};return doAnimation.finish=doAnimation,empty||!1===optall.queue?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop,stop(gotoEnd)};return"string"!=typeof type&&(gotoEnd=clearQueue,clearQueue=type,type=void 0),clearQueue&&this.queue(type||"fx",[]),this.each(function(){var dequeue=!0,index=null!=type&&type+"queueHooks",timers=jQuery.timers,data=dataPriv.get(this);if(index)data[index]&&data[index].stop&&stopQueue(data[index]);else for(index in data)data[index]&&data[index].stop&&rrun.test(index)&&stopQueue(data[index]);for(index=timers.length;index--;)timers[index].elem!==this||null!=type&&timers[index].queue!==type||(timers[index].anim.stop(gotoEnd),dequeue=!1,timers.splice(index,1));!dequeue&&gotoEnd||jQuery.dequeue(this,type)})},finish:function(type){return!1!==type&&(type=type||"fx"),this.each(function(){var index,data=dataPriv.get(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;for(data.finish=!0,jQuery.queue(this,type,[]),hooks&&hooks.stop&&hooks.stop.call(this,!0),index=timers.length;index--;)timers[index].elem===this&&timers[index].queue===type&&(timers[index].anim.stop(!0),timers.splice(index,1));for(index=0;index<length;index++)queue[index]&&queue[index].finish&&queue[index].finish.call(this);delete data.finish})}}),jQuery.each(["toggle","show","hide"],function(_i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return null==speed||"boolean"==typeof speed?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback)}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}}),jQuery.timers=[],jQuery.fx.tick=function(){var timer,i=0,timers=jQuery.timers;for(fxNow=Date.now();i<timers.length;i++)(timer=timers[i])()||timers[i]!==timer||timers.splice(i--,1);timers.length||jQuery.fx.stop(),fxNow=void 0},jQuery.fx.timer=function(timer){jQuery.timers.push(timer),jQuery.fx.start()},jQuery.fx.interval=13,jQuery.fx.start=function(){inProgress||(inProgress=!0,schedule())},jQuery.fx.stop=function(){inProgress=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fn.delay=function(time,type){return time=jQuery.fx&&jQuery.fx.speeds[time]||time,type=type||"fx",this.queue(type,function(next,hooks){var timeout=window.setTimeout(next,time);hooks.stop=function(){window.clearTimeout(timeout)}})},function(){var input=document.createElement("input"),opt=document.createElement("select").appendChild(document.createElement("option"));input.type="checkbox",support.checkOn=""!==input.value,support.optSelected=opt.selected,(input=document.createElement("input")).value="t",input.type="radio",support.radioValue="t"===input.value}();var boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,1<arguments.length)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}}),jQuery.extend({attr:function(elem,name,value){var ret,hooks,nType=elem.nodeType;if(3!==nType&&8!==nType&&2!==nType)return void 0===elem.getAttribute?jQuery.prop(elem,name,value):(1===nType&&jQuery.isXMLDoc(elem)||(hooks=jQuery.attrHooks[name.toLowerCase()]||(jQuery.expr.match.bool.test(name)?boolHook:void 0)),void 0!==value?null===value?void jQuery.removeAttr(elem,name):hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:(elem.setAttribute(name,value+""),value):!(hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name)))&&null==(ret=jQuery.find.attr(elem,name))?void 0:ret)},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&"radio"===value&&nodeName(elem,"input")){var val=elem.value;return elem.setAttribute("type",value),val&&(elem.value=val),value}}}},removeAttr:function(elem,value){var name,i=0,attrNames=value&&value.match(rnothtmlwhite);if(attrNames&&1===elem.nodeType)for(;name=attrNames[i++];)elem.removeAttribute(name)}}),boolHook={set:function(elem,value,name){return!1===value?jQuery.removeAttr(elem,name):elem.setAttribute(name,name),name}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(_i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=function(elem,name,isXML){var ret,handle,lowercaseName=name.toLowerCase();return isXML||(handle=attrHandle[lowercaseName],attrHandle[lowercaseName]=ret,ret=null!=getter(elem,name,isXML)?lowercaseName:null,attrHandle[lowercaseName]=handle),ret}});var rfocusable=/^(?:input|select|textarea|button)$/i,rclickable=/^(?:a|area)$/i;function stripAndCollapse(value){return(value.match(rnothtmlwhite)||[]).join(" ")}function getClass(elem){return elem.getAttribute&&elem.getAttribute("class")||""}function classesToArray(value){return Array.isArray(value)?value:"string"==typeof value&&value.match(rnothtmlwhite)||[]}jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,1<arguments.length)},removeProp:function(name){return this.each(function(){delete this[jQuery.propFix[name]||name]})}}),jQuery.extend({prop:function(elem,name,value){var ret,hooks,nType=elem.nodeType;if(3!==nType&&8!==nType&&2!==nType)return 1===nType&&jQuery.isXMLDoc(elem)||(name=jQuery.propFix[name]||name,hooks=jQuery.propHooks[name]),void 0!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:elem[name]=value:hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:elem[name]},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),support.optSelected||(jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;return parent&&parent.parentNode&&parent.parentNode.selectedIndex,null},set:function(elem){var parent=elem.parentNode;parent&&(parent.selectedIndex,parent.parentNode&&parent.parentNode.selectedIndex)}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this}),jQuery.fn.extend({addClass:function(value){var classes,elem,cur,curValue,clazz,j,finalValue,i=0;if(isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,getClass(this)))});if((classes=classesToArray(value)).length)for(;elem=this[i++];)if(curValue=getClass(elem),cur=1===elem.nodeType&&" "+stripAndCollapse(curValue)+" "){for(j=0;clazz=classes[j++];)cur.indexOf(" "+clazz+" ")<0&&(cur+=clazz+" ");curValue!==(finalValue=stripAndCollapse(cur))&&elem.setAttribute("class",finalValue)}return this},removeClass:function(value){var classes,elem,cur,curValue,clazz,j,finalValue,i=0;if(isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,getClass(this)))});if(!arguments.length)return this.attr("class","");if((classes=classesToArray(value)).length)for(;elem=this[i++];)if(curValue=getClass(elem),cur=1===elem.nodeType&&" "+stripAndCollapse(curValue)+" "){for(j=0;clazz=classes[j++];)for(;-1<cur.indexOf(" "+clazz+" ");)cur=cur.replace(" "+clazz+" "," ");curValue!==(finalValue=stripAndCollapse(cur))&&elem.setAttribute("class",finalValue)}return this},toggleClass:function(value,stateVal){var type=void 0===value?"undefined":_typeof(value),isValidValue="string"===type||Array.isArray(value);return"boolean"==typeof stateVal&&isValidValue?stateVal?this.addClass(value):this.removeClass(value):isFunction(value)?this.each(function(i){jQuery(this).toggleClass(value.call(this,i,getClass(this),stateVal),stateVal)}):this.each(function(){var className,i,self,classNames;if(isValidValue)for(i=0,self=jQuery(this),classNames=classesToArray(value);className=classNames[i++];)self.hasClass(className)?self.removeClass(className):self.addClass(className);else void 0!==value&&"boolean"!==type||((className=getClass(this))&&dataPriv.set(this,"__className__",className),this.setAttribute&&this.setAttribute("class",!className&&!1!==value&&dataPriv.get(this,"__className__")||""))})},hasClass:function(selector){for(var elem,i=0,className=" "+selector+" ";elem=this[i++];)if(1===elem.nodeType&&-1<(" "+stripAndCollapse(getClass(elem))+" ").indexOf(className))return!0;return!1}});var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,valueIsFunction,elem=this[0];return arguments.length?(valueIsFunction=isFunction(value),this.each(function(i){var val;1===this.nodeType&&(null==(val=valueIsFunction?value.call(this,i,jQuery(this).val()):value)?val="":"number"==typeof val?val+="":Array.isArray(val)&&(val=jQuery.map(val,function(value){return null==value?"":value+""})),(hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()])&&"set"in hooks&&void 0!==hooks.set(this,val,"value")||(this.value=val))})):elem?(hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()])&&"get"in hooks&&void 0!==(ret=hooks.get(elem,"value"))?ret:"string"==typeof(ret=elem.value)?ret.replace(rreturn,""):null==ret?"":ret:void 0}}),jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return null!=val?val:stripAndCollapse(jQuery.text(elem))}},select:{get:function(elem){for(var value,option,options=elem.options,index=elem.selectedIndex,one="select-one"===elem.type,values=one?null:[],max=one?index+1:options.length,i=index<0?max:one?index:0;i<max;i++)if(((option=options[i]).selected||i===index)&&!option.disabled&&(!option.parentNode.disabled||!nodeName(option.parentNode,"optgroup"))){if(value=jQuery(option).val(),one)return value;values.push(value)}return values},set:function(elem,value){for(var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;i--;)((option=options[i]).selected=-1<jQuery.inArray(jQuery.valHooks.option.get(option),values))&&(optionSet=!0);return optionSet||(elem.selectedIndex=-1),values}}}}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(Array.isArray(value))return elem.checked=-1<jQuery.inArray(jQuery(elem).val(),value)}},support.checkOn||(jQuery.valHooks[this].get=function(elem){return null===elem.getAttribute("value")?"on":elem.value})}),support.focusin="onfocusin"in window;var rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,stopPropagationCallback=function(e){e.stopPropagation()};jQuery.extend(jQuery.event,{trigger:function(event,data,elem,onlyHandlers){var i,tmp,bubbleType,ontype,handle,special,lastElement,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[],cur=lastElement=tmp=elem=elem||document;if(3!==elem.nodeType&&8!==elem.nodeType&&!rfocusMorph.test(type+jQuery.event.triggered)&&(-1<type.indexOf(".")&&(type=(namespaces=type.split(".")).shift(),namespaces.sort()),ontype=type.indexOf(":")<0&&"on"+type,(event=event[jQuery.expando]?event:new jQuery.Event(type,"object"===(void 0===event?"undefined":_typeof(event))&&event)).isTrigger=onlyHandlers?2:3,event.namespace=namespaces.join("."),event.rnamespace=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,event.result=void 0,event.target||(event.target=elem),data=null==data?[event]:jQuery.makeArray(data,[event]),special=jQuery.event.special[type]||{},onlyHandlers||!special.trigger||!1!==special.trigger.apply(elem,data))){if(!onlyHandlers&&!special.noBubble&&!isWindow(elem)){for(bubbleType=special.delegateType||type,rfocusMorph.test(bubbleType+type)||(cur=cur.parentNode);cur;cur=cur.parentNode)eventPath.push(cur),tmp=cur;tmp===(elem.ownerDocument||document)&&eventPath.push(tmp.defaultView||tmp.parentWindow||window)}for(i=0;(cur=eventPath[i++])&&!event.isPropagationStopped();)lastElement=cur,event.type=1<i?bubbleType:special.bindType||type,(handle=(dataPriv.get(cur,"events")||Object.create(null))[event.type]&&dataPriv.get(cur,"handle"))&&handle.apply(cur,data),(handle=ontype&&cur[ontype])&&handle.apply&&acceptData(cur)&&(event.result=handle.apply(cur,data),!1===event.result&&event.preventDefault());return event.type=type,onlyHandlers||event.isDefaultPrevented()||special._default&&!1!==special._default.apply(eventPath.pop(),data)||!acceptData(elem)||ontype&&isFunction(elem[type])&&!isWindow(elem)&&((tmp=elem[ontype])&&(elem[ontype]=null),jQuery.event.triggered=type,event.isPropagationStopped()&&lastElement.addEventListener(type,stopPropagationCallback),elem[type](),event.isPropagationStopped()&&lastElement.removeEventListener(type,stopPropagationCallback),jQuery.event.triggered=void 0,tmp&&(elem[ontype]=tmp)),event.result}},simulate:function(type,elem,event){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:!0});jQuery.event.trigger(e,null,elem)}}),jQuery.fn.extend({trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];if(elem)return jQuery.event.trigger(type,data,elem,!0)}}),support.focusin||jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event))};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this.document||this,attaches=dataPriv.access(doc,fix);attaches||doc.addEventListener(orig,handler,!0),dataPriv.access(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this.document||this,attaches=dataPriv.access(doc,fix)-1;attaches?dataPriv.access(doc,fix,attaches):(doc.removeEventListener(orig,handler,!0),dataPriv.remove(doc,fix))}}});var location=window.location,nonce={guid:Date.now()},rquery=/\?/;jQuery.parseXML=function(data){var xml;if(!data||"string"!=typeof data)return null;try{xml=(new window.DOMParser).parseFromString(data,"text/xml")}catch(e){xml=void 0}return xml&&!xml.getElementsByTagName("parsererror").length||jQuery.error("Invalid XML: "+data),xml};var rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,valueOrFunction){var value=isFunction(valueOrFunction)?valueOrFunction():valueOrFunction;s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(null==value?"":value)};if(null==a)return"";if(Array.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(prefix in a)!function buildParams(prefix,obj,traditional,add){var name;if(Array.isArray(obj))jQuery.each(obj,function(i,v){traditional||rbracket.test(prefix)?add(prefix,v):buildParams(prefix+"["+("object"===(void 0===v?"undefined":_typeof(v))&&null!=v?i:"")+"]",v,traditional,add)});else if(traditional||"object"!==toType(obj))add(prefix,obj);else for(name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add)}(prefix,a[prefix],traditional,add);return s.join("&")},jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(_i,elem){var val=jQuery(this).val();return null==val?null:Array.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}});var r20=/%20/g,rhash=/#.*$/,rantiCache=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/gm,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,prefilters={},transports={},allTypes="*/".concat("*"),originAnchor=document.createElement("a");function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){"string"!=typeof dataTypeExpression&&(func=dataTypeExpression,dataTypeExpression="*");var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnothtmlwhite)||[];if(isFunction(func))for(;dataType=dataTypes[i++];)"+"===dataType[0]?(dataType=dataType.slice(1)||"*",(structure[dataType]=structure[dataType]||[]).unshift(func)):(structure[dataType]=structure[dataType]||[]).push(func)}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){var inspected={},seekingTransport=structure===transports;function inspect(dataType){var selected;return inspected[dataType]=!0,jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);return"string"!=typeof dataTypeOrTransport||seekingTransport||inspected[dataTypeOrTransport]?seekingTransport?!(selected=dataTypeOrTransport):void 0:(options.dataTypes.unshift(dataTypeOrTransport),inspect(dataTypeOrTransport),!1)}),selected}return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)void 0!==src[key]&&((flatOptions[key]?target:deep=deep||{})[key]=src[key]);return deep&&jQuery.extend(!0,target,deep),target}originAnchor.href=location.href,jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:location.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(location.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){"object"===(void 0===url?"undefined":_typeof(url))&&(options=url,url=void 0),options=options||{};var transport,cacheURL,responseHeadersString,responseHeaders,timeoutTimer,urlAnchor,completed,fireGlobals,i,uncached,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),_statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(completed){if(!responseHeaders)for(responseHeaders={};match=rheaders.exec(responseHeadersString);)responseHeaders[match[1].toLowerCase()+" "]=(responseHeaders[match[1].toLowerCase()+" "]||[]).concat(match[2]);match=responseHeaders[key.toLowerCase()+" "]}return null==match?null:match.join(", ")},getAllResponseHeaders:function(){return completed?responseHeadersString:null},setRequestHeader:function(name,value){return null==completed&&(name=requestHeadersNames[name.toLowerCase()]=requestHeadersNames[name.toLowerCase()]||name,requestHeaders[name]=value),this},overrideMimeType:function(type){return null==completed&&(s.mimeType=type),this},statusCode:function(map){var code;if(map)if(completed)jqXHR.always(map[jqXHR.status]);else for(code in map)_statusCode[code]=[_statusCode[code],map[code]];return this},abort:function(statusText){var finalText=statusText||strAbort;return transport&&transport.abort(finalText),done(0,finalText),this}};if(deferred.promise(jqXHR),s.url=((url||s.url||location.href)+"").replace(rprotocol,location.protocol+"//"),s.type=options.method||options.type||s.method||s.type,s.dataTypes=(s.dataType||"*").toLowerCase().match(rnothtmlwhite)||[""],null==s.crossDomain){urlAnchor=document.createElement("a");try{urlAnchor.href=s.url,urlAnchor.href=urlAnchor.href,s.crossDomain=originAnchor.protocol+"//"+originAnchor.host!=urlAnchor.protocol+"//"+urlAnchor.host}catch(e){s.crossDomain=!0}}if(s.data&&s.processData&&"string"!=typeof s.data&&(s.data=jQuery.param(s.data,s.traditional)),inspectPrefiltersOrTransports(prefilters,s,options,jqXHR),completed)return jqXHR;for(i in(fireGlobals=jQuery.event&&s.global)&&0==jQuery.active++&&jQuery.event.trigger("ajaxStart"),s.type=s.type.toUpperCase(),s.hasContent=!rnoContent.test(s.type),cacheURL=s.url.replace(rhash,""),s.hasContent?s.data&&s.processData&&0===(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&(s.data=s.data.replace(r20,"+")):(uncached=s.url.slice(cacheURL.length),s.data&&(s.processData||"string"==typeof s.data)&&(cacheURL+=(rquery.test(cacheURL)?"&":"?")+s.data,delete s.data),!1===s.cache&&(cacheURL=cacheURL.replace(rantiCache,"$1"),uncached=(rquery.test(cacheURL)?"&":"?")+"_="+nonce.guid+++uncached),s.url=cacheURL+uncached),s.ifModified&&(jQuery.lastModified[cacheURL]&&jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]),jQuery.etag[cacheURL]&&jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])),(s.data&&s.hasContent&&!1!==s.contentType||options.contentType)&&jqXHR.setRequestHeader("Content-Type",s.contentType),jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"!==s.dataTypes[0]?", "+allTypes+"; q=0.01":""):s.accepts["*"]),s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(!1===s.beforeSend.call(callbackContext,jqXHR,s)||completed))return jqXHR.abort();if(strAbort="abort",completeDeferred.add(s.complete),jqXHR.done(s.success),jqXHR.fail(s.error),transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR)){if(jqXHR.readyState=1,fireGlobals&&globalEventContext.trigger("ajaxSend",[jqXHR,s]),completed)return jqXHR;s.async&&0<s.timeout&&(timeoutTimer=window.setTimeout(function(){jqXHR.abort("timeout")},s.timeout));try{completed=!1,transport.send(requestHeaders,done)}catch(e){if(completed)throw e;done(-1,e)}}else done(-1,"No Transport");function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;completed||(completed=!0,timeoutTimer&&window.clearTimeout(timeoutTimer),transport=void 0,responseHeadersString=headers||"",jqXHR.readyState=0<status?4:0,isSuccess=200<=status&&status<300||304===status,responses&&(response=function(s,jqXHR,responses){for(var ct,type,finalDataType,firstDataType,contents=s.contents,dataTypes=s.dataTypes;"*"===dataTypes[0];)dataTypes.shift(),void 0===ct&&(ct=s.mimeType||jqXHR.getResponseHeader("Content-Type"));if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}firstDataType=firstDataType||type}finalDataType=finalDataType||firstDataType}if(finalDataType)return finalDataType!==dataTypes[0]&&dataTypes.unshift(finalDataType),responses[finalDataType]}(s,jqXHR,responses)),!isSuccess&&-1<jQuery.inArray("script",s.dataTypes)&&(s.converters["text script"]=function(){}),response=function(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];for(current=dataTypes.shift();current;)if(s.responseFields[current]&&(jqXHR[s.responseFields[current]]=response),!prev&&isSuccess&&s.dataFilter&&(response=s.dataFilter(response,s.dataType)),prev=current,current=dataTypes.shift())if("*"===current)current=prev;else if("*"!==prev&&prev!==current){if(!(conv=converters[prev+" "+current]||converters["* "+current]))for(conv2 in converters)if((tmp=conv2.split(" "))[1]===current&&(conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]])){!0===conv?conv=converters[conv2]:!0!==converters[conv2]&&(current=tmp[0],dataTypes.unshift(tmp[1]));break}if(!0!==conv)if(conv&&s.throws)response=conv(response);else try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}return{state:"success",data:response}}(s,response,jqXHR,isSuccess),isSuccess?(s.ifModified&&((modified=jqXHR.getResponseHeader("Last-Modified"))&&(jQuery.lastModified[cacheURL]=modified),(modified=jqXHR.getResponseHeader("etag"))&&(jQuery.etag[cacheURL]=modified)),204===status||"HEAD"===s.type?statusText="nocontent":304===status?statusText="notmodified":(statusText=response.state,success=response.data,isSuccess=!(error=response.error))):(error=statusText,!status&&statusText||(statusText="error",status<0&&(status=0))),jqXHR.status=status,jqXHR.statusText=(nativeStatusText||statusText)+"",isSuccess?deferred.resolveWith(callbackContext,[success,statusText,jqXHR]):deferred.rejectWith(callbackContext,[jqXHR,statusText,error]),jqXHR.statusCode(_statusCode),_statusCode=void 0,fireGlobals&&globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]),completeDeferred.fireWith(callbackContext,[jqXHR,statusText]),fireGlobals&&(globalEventContext.trigger("ajaxComplete",[jqXHR,s]),--jQuery.active||jQuery.event.trigger("ajaxStop")))}return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,void 0,callback,"script")}}),jQuery.each(["get","post"],function(_i,method){jQuery[method]=function(url,data,callback,type){return isFunction(data)&&(type=type||callback,callback=data,data=void 0),jQuery.ajax(jQuery.extend({url:url,type:method,dataType:type,data:data,success:callback},jQuery.isPlainObject(url)&&url))}}),jQuery.ajaxPrefilter(function(s){var i;for(i in s.headers)"content-type"===i.toLowerCase()&&(s.contentType=s.headers[i]||"")}),jQuery._evalUrl=function(url,options,doc){return jQuery.ajax({url:url,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(response){jQuery.globalEval(response,options,doc)}})},jQuery.fn.extend({wrapAll:function(html){var wrap;return this[0]&&(isFunction(html)&&(html=html.call(this[0])),wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&wrap.insertBefore(this[0]),wrap.map(function(){for(var elem=this;elem.firstElementChild;)elem=elem.firstElementChild;return elem}).append(this)),this},wrapInner:function(html){return isFunction(html)?this.each(function(i){jQuery(this).wrapInner(html.call(this,i))}):this.each(function(){var self=jQuery(this),contents=self.contents();contents.length?contents.wrapAll(html):self.append(html)})},wrap:function(html){var htmlIsFunction=isFunction(html);return this.each(function(i){jQuery(this).wrapAll(htmlIsFunction?html.call(this,i):html)})},unwrap:function(selector){return this.parent(selector).not("body").each(function(){jQuery(this).replaceWith(this.childNodes)}),this}}),jQuery.expr.pseudos.hidden=function(elem){return!jQuery.expr.pseudos.visible(elem)},jQuery.expr.pseudos.visible=function(elem){return!!(elem.offsetWidth||elem.offsetHeight||elem.getClientRects().length)},jQuery.ajaxSettings.xhr=function(){try{return new window.XMLHttpRequest}catch(e){}};var xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,support.ajax=xhrSupported=!!xhrSupported,jQuery.ajaxTransport(function(options){var _callback,errorCallback;if(support.cors||xhrSupported&&!options.crossDomain)return{send:function(headers,complete){var i,xhr=options.xhr();if(xhr.open(options.type,options.url,options.async,options.username,options.password),options.xhrFields)for(i in options.xhrFields)xhr[i]=options.xhrFields[i];for(i in options.mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(options.mimeType),options.crossDomain||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest"),headers)xhr.setRequestHeader(i,headers[i]);_callback=function(type){return function(){_callback&&(_callback=errorCallback=xhr.onload=xhr.onerror=xhr.onabort=xhr.ontimeout=xhr.onreadystatechange=null,"abort"===type?xhr.abort():"error"===type?"number"!=typeof xhr.status?complete(0,"error"):complete(xhr.status,xhr.statusText):complete(xhrSuccessStatus[xhr.status]||xhr.status,xhr.statusText,"text"!==(xhr.responseType||"text")||"string"!=typeof xhr.responseText?{binary:xhr.response}:{text:xhr.responseText},xhr.getAllResponseHeaders()))}},xhr.onload=_callback(),errorCallback=xhr.onerror=xhr.ontimeout=_callback("error"),void 0!==xhr.onabort?xhr.onabort=errorCallback:xhr.onreadystatechange=function(){4===xhr.readyState&&window.setTimeout(function(){_callback&&errorCallback()})},_callback=_callback("abort");try{xhr.send(options.hasContent&&options.data||null)}catch(e){if(_callback)throw e}},abort:function(){_callback&&_callback()}}}),jQuery.ajaxPrefilter(function(s){s.crossDomain&&(s.contents.script=!1)}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(text){return jQuery.globalEval(text),text}}}),jQuery.ajaxPrefilter("script",function(s){void 0===s.cache&&(s.cache=!1),s.crossDomain&&(s.type="GET")}),jQuery.ajaxTransport("script",function(s){var script,_callback2;if(s.crossDomain||s.scriptAttrs)return{send:function(_,complete){script=jQuery("<script>").attr(s.scriptAttrs||{}).prop({charset:s.scriptCharset,src:s.url}).on("load error",_callback2=function(evt){script.remove(),_callback2=null,evt&&complete("error"===evt.type?404:200,evt.type)}),document.head.appendChild(script[0])},abort:function(){_callback2&&_callback2()}}});var body,oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce.guid++;return this[callback]=!0,callback}}),jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=!1!==s.jsonp&&(rjsonp.test(s.url)?"url":"string"==typeof s.data&&0===(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");if(jsonProp||"jsonp"===s.dataTypes[0])return callbackName=s.jsonpCallback=isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,jsonProp?s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName):!1!==s.jsonp&&(s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName),s.converters["script json"]=function(){return responseContainer||jQuery.error(callbackName+" was not called"),responseContainer[0]},s.dataTypes[0]="json",overwritten=window[callbackName],window[callbackName]=function(){responseContainer=arguments},jqXHR.always(function(){void 0===overwritten?jQuery(window).removeProp(callbackName):window[callbackName]=overwritten,s[callbackName]&&(s.jsonpCallback=originalSettings.jsonpCallback,oldCallbacks.push(callbackName)),responseContainer&&isFunction(overwritten)&&overwritten(responseContainer[0]),responseContainer=overwritten=void 0}),"script"}),support.createHTMLDocument=((body=document.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===body.childNodes.length),jQuery.parseHTML=function(data,context,keepScripts){return"string"!=typeof data?[]:("boolean"==typeof context&&(keepScripts=context,context=!1),context||(support.createHTMLDocument?((base=(context=document.implementation.createHTMLDocument("")).createElement("base")).href=document.location.href,context.head.appendChild(base)):context=document),scripts=!keepScripts&&[],(parsed=rsingleTag.exec(data))?[context.createElement(parsed[1])]:(parsed=buildFragment([data],context,scripts),scripts&&scripts.length&&jQuery(scripts).remove(),jQuery.merge([],parsed.childNodes)));var base,parsed,scripts},jQuery.fn.load=function(url,params,callback){var selector,type,response,self=this,off=url.indexOf(" ");return-1<off&&(selector=stripAndCollapse(url.slice(off)),url=url.slice(0,off)),isFunction(params)?(callback=params,params=void 0):params&&"object"===(void 0===params?"undefined":_typeof(params))&&(type="POST"),0<self.length&&jQuery.ajax({url:url,type:type||"GET",dataType:"html",data:params}).done(function(responseText){response=arguments,self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).always(callback&&function(jqXHR,status){self.each(function(){callback.apply(this,response||[jqXHR.responseText,status,jqXHR])})}),this},jQuery.expr.pseudos.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length},jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};"static"===position&&(elem.style.position="relative"),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),curLeft=("absolute"===position||"fixed"===position)&&-1<(curCSSTop+curCSSLeft).indexOf("auto")?(curTop=(curPosition=curElem.position()).top,curPosition.left):(curTop=parseFloat(curCSSTop)||0,parseFloat(curCSSLeft)||0),isFunction(options)&&(options=options.call(elem,i,jQuery.extend({},curOffset))),null!=options.top&&(props.top=options.top-curOffset.top+curTop),null!=options.left&&(props.left=options.left-curOffset.left+curLeft),"using"in options?options.using.call(elem,props):("number"==typeof props.top&&(props.top+="px"),"number"==typeof props.left&&(props.left+="px"),curElem.css(props))}},jQuery.fn.extend({offset:function(options){if(arguments.length)return void 0===options?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)});var rect,win,elem=this[0];return elem?elem.getClientRects().length?(rect=elem.getBoundingClientRect(),win=elem.ownerDocument.defaultView,{top:rect.top+win.pageYOffset,left:rect.left+win.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var offsetParent,offset,doc,elem=this[0],parentOffset={top:0,left:0};if("fixed"===jQuery.css(elem,"position"))offset=elem.getBoundingClientRect();else{for(offset=this.offset(),doc=elem.ownerDocument,offsetParent=elem.offsetParent||doc.documentElement;offsetParent&&(offsetParent===doc.body||offsetParent===doc.documentElement)&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.parentNode;offsetParent&&offsetParent!==elem&&1===offsetParent.nodeType&&((parentOffset=jQuery(offsetParent).offset()).top+=jQuery.css(offsetParent,"borderTopWidth",!0),parentOffset.left+=jQuery.css(offsetParent,"borderLeftWidth",!0))}return{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var offsetParent=this.offsetParent;offsetParent&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||documentElement})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top="pageYOffset"===prop;jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win;return isWindow(elem)?win=elem:9===elem.nodeType&&(win=elem.defaultView),void 0===val?win?win[prop]:elem[method]:void(win?win.scrollTo(top?win.pageXOffset:val,top?val:win.pageYOffset):elem[method]=val)},method,val,arguments.length)}}),jQuery.each(["top","left"],function(_i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){if(computed)return computed=curCSS(elem,prop),rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed})}),jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||"boolean"!=typeof margin),extra=defaultExtra||(!0===margin||!0===value?"margin":"border");return access(this,function(elem,type,value){var doc;return isWindow(elem)?0===funcName.indexOf("outer")?elem["inner"+name]:elem.document.documentElement["client"+name]:9===elem.nodeType?(doc=elem.documentElement,Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])):void 0===value?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:void 0,chainable)}})}),jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(_i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}}),jQuery.fn.extend({bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return 1===arguments.length?this.off(selector,"**"):this.off(types,selector||"**",fn)},hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)}}),jQuery.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(_i,name){jQuery.fn[name]=function(data,fn){return 0<arguments.length?this.on(name,null,data,fn):this.trigger(name)}});var rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;jQuery.proxy=function(fn,context){var tmp,args,proxy;if("string"==typeof context&&(tmp=fn[context],context=fn,fn=tmp),isFunction(fn))return args=_slice.call(arguments,2),(proxy=function(){return fn.apply(context||this,args.concat(_slice.call(arguments)))}).guid=fn.guid=fn.guid||jQuery.guid++,proxy},jQuery.holdReady=function(hold){hold?jQuery.readyWait++:jQuery.ready(!0)},jQuery.isArray=Array.isArray,jQuery.parseJSON=JSON.parse,jQuery.nodeName=nodeName,jQuery.isFunction=isFunction,jQuery.isWindow=isWindow,jQuery.camelCase=camelCase,jQuery.type=toType,jQuery.now=Date.now,jQuery.isNumeric=function(obj){var type=jQuery.type(obj);return("number"===type||"string"===type)&&!isNaN(obj-parseFloat(obj))},jQuery.trim=function(text){return null==text?"":(text+"").replace(rtrim,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return jQuery});var _jQuery=window.jQuery,_$=window.$;return jQuery.noConflict=function(deep){return window.$===jQuery&&(window.$=_$),deep&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},void 0===noGlobal&&(window.jQuery=window.$=jQuery),jQuery},"object"===(void 0===module?"undefined":_typeof(module))&&"object"===_typeof(module.exports)?module.exports=global.document?factory(global,!0):function(w){if(!w.document)throw new Error("jQuery requires a window with a document");return factory(w)}:factory(global)},{}],387:[function(require,module,exports){"use strict";var DataView=require("./_getNative")(require("./_root"),"DataView");module.exports=DataView},{"./_getNative":486,"./_root":533}],388:[function(require,module,exports){"use strict";var hashClear=require("./_hashClear"),hashDelete=require("./_hashDelete"),hashGet=require("./_hashGet"),hashHas=require("./_hashHas"),hashSet=require("./_hashSet");function Hash(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet,module.exports=Hash},{"./_hashClear":494,"./_hashDelete":495,"./_hashGet":496,"./_hashHas":497,"./_hashSet":498}],389:[function(require,module,exports){"use strict";var baseCreate=require("./_baseCreate"),baseLodash=require("./_baseLodash");function LazyWrapper(value){this.__wrapped__=value,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}(LazyWrapper.prototype=baseCreate(baseLodash.prototype)).constructor=LazyWrapper,module.exports=LazyWrapper},{"./_baseCreate":416,"./_baseLodash":438}],390:[function(require,module,exports){"use strict";var listCacheClear=require("./_listCacheClear"),listCacheDelete=require("./_listCacheDelete"),listCacheGet=require("./_listCacheGet"),listCacheHas=require("./_listCacheHas"),listCacheSet=require("./_listCacheSet");function ListCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet,module.exports=ListCache},{"./_listCacheClear":509,"./_listCacheDelete":510,"./_listCacheGet":511,"./_listCacheHas":512,"./_listCacheSet":513}],391:[function(require,module,exports){"use strict";var baseCreate=require("./_baseCreate"),baseLodash=require("./_baseLodash");function LodashWrapper(value,chainAll){this.__wrapped__=value,this.__actions__=[],this.__chain__=!!chainAll,this.__index__=0,this.__values__=void 0}(LodashWrapper.prototype=baseCreate(baseLodash.prototype)).constructor=LodashWrapper,module.exports=LodashWrapper},{"./_baseCreate":416,"./_baseLodash":438}],392:[function(require,module,exports){"use strict";var Map=require("./_getNative")(require("./_root"),"Map");module.exports=Map},{"./_getNative":486,"./_root":533}],393:[function(require,module,exports){"use strict";var mapCacheClear=require("./_mapCacheClear"),mapCacheDelete=require("./_mapCacheDelete"),mapCacheGet=require("./_mapCacheGet"),mapCacheHas=require("./_mapCacheHas"),mapCacheSet=require("./_mapCacheSet");function MapCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet,module.exports=MapCache},{"./_mapCacheClear":514,"./_mapCacheDelete":515,"./_mapCacheGet":516,"./_mapCacheHas":517,"./_mapCacheSet":518}],394:[function(require,module,exports){"use strict";var Promise=require("./_getNative")(require("./_root"),"Promise");module.exports=Promise},{"./_getNative":486,"./_root":533}],395:[function(require,module,exports){"use strict";var Set=require("./_getNative")(require("./_root"),"Set");module.exports=Set},{"./_getNative":486,"./_root":533}],396:[function(require,module,exports){"use strict";var MapCache=require("./_MapCache"),setCacheAdd=require("./_setCacheAdd"),setCacheHas=require("./_setCacheHas");function SetCache(values){var index=-1,length=null==values?0:values.length;for(this.__data__=new MapCache;++index<length;)this.add(values[index])}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd,SetCache.prototype.has=setCacheHas,module.exports=SetCache},{"./_MapCache":393,"./_setCacheAdd":534,"./_setCacheHas":535}],397:[function(require,module,exports){"use strict";var ListCache=require("./_ListCache"),stackClear=require("./_stackClear"),stackDelete=require("./_stackDelete"),stackGet=require("./_stackGet"),stackHas=require("./_stackHas"),stackSet=require("./_stackSet");function Stack(entries){var data=this.__data__=new ListCache(entries);this.size=data.size}Stack.prototype.clear=stackClear,Stack.prototype.delete=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet,module.exports=Stack},{"./_ListCache":390,"./_stackClear":541,"./_stackDelete":542,"./_stackGet":543,"./_stackHas":544,"./_stackSet":545}],398:[function(require,module,exports){"use strict";var _Symbol=require("./_root").Symbol;module.exports=_Symbol},{"./_root":533}],399:[function(require,module,exports){"use strict";var Uint8Array=require("./_root").Uint8Array;module.exports=Uint8Array},{"./_root":533}],400:[function(require,module,exports){"use strict";var WeakMap=require("./_getNative")(require("./_root"),"WeakMap");module.exports=WeakMap},{"./_getNative":486,"./_root":533}],401:[function(require,module,exports){"use strict";module.exports=function(func,thisArg,args){switch(args.length){case 0:return func.call(thisArg);case 1:return func.call(thisArg,args[0]);case 2:return func.call(thisArg,args[0],args[1]);case 3:return func.call(thisArg,args[0],args[1],args[2])}return func.apply(thisArg,args)}},{}],402:[function(require,module,exports){"use strict";module.exports=function(array,setter,iteratee,accumulator){for(var index=-1,length=null==array?0:array.length;++index<length;){var value=array[index];setter(accumulator,value,iteratee(value),array)}return accumulator}},{}],403:[function(require,module,exports){"use strict";module.exports=function(array,iteratee){for(var index=-1,length=null==array?0:array.length;++index<length&&!1!==iteratee(array[index],index,array););return array}},{}],404:[function(require,module,exports){"use strict";module.exports=function(array,predicate){for(var index=-1,length=null==array?0:array.length,resIndex=0,result=[];++index<length;){var value=array[index];predicate(value,index,array)&&(result[resIndex++]=value)}return result}},{}],405:[function(require,module,exports){"use strict";var baseIndexOf=require("./_baseIndexOf");module.exports=function(array,value){return!!(null==array?0:array.length)&&-1<baseIndexOf(array,value,0)}},{"./_baseIndexOf":428}],406:[function(require,module,exports){"use strict";module.exports=function(array,value,comparator){for(var index=-1,length=null==array?0:array.length;++index<length;)if(comparator(value,array[index]))return!0;return!1}},{}],407:[function(require,module,exports){"use strict";var baseTimes=require("./_baseTimes"),isArguments=require("./isArguments"),isArray=require("./isArray"),isBuffer=require("./isBuffer"),isIndex=require("./_isIndex"),isTypedArray=require("./isTypedArray"),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(value,inherited){var isArr=isArray(value),isArg=!isArr&&isArguments(value),isBuff=!isArr&&!isArg&&isBuffer(value),isType=!isArr&&!isArg&&!isBuff&&isTypedArray(value),skipIndexes=isArr||isArg||isBuff||isType,result=skipIndexes?baseTimes(value.length,String):[],length=result.length;for(var key in value)!inherited&&!hasOwnProperty.call(value,key)||skipIndexes&&("length"==key||isBuff&&("offset"==key||"parent"==key)||isType&&("buffer"==key||"byteLength"==key||"byteOffset"==key)||isIndex(key,length))||result.push(key);return result}},{"./_baseTimes":448,"./_isIndex":501,"./isArguments":565,"./isArray":566,"./isBuffer":569,"./isTypedArray":576}],408:[function(require,module,exports){"use strict";module.exports=function(array,iteratee){for(var index=-1,length=null==array?0:array.length,result=Array(length);++index<length;)result[index]=iteratee(array[index],index,array);return result}},{}],409:[function(require,module,exports){"use strict";module.exports=function(array,values){for(var index=-1,length=values.length,offset=array.length;++index<length;)array[offset+index]=values[index];return array}},{}],410:[function(require,module,exports){"use strict";module.exports=function(array,iteratee,accumulator,initAccum){var index=-1,length=null==array?0:array.length;for(initAccum&&length&&(accumulator=array[++index]);++index<length;)accumulator=iteratee(accumulator,array[index],index,array);return accumulator}},{}],411:[function(require,module,exports){"use strict";module.exports=function(array,predicate){for(var index=-1,length=null==array?0:array.length;++index<length;)if(predicate(array[index],index,array))return!0;return!1}},{}],412:[function(require,module,exports){"use strict";var baseAssignValue=require("./_baseAssignValue"),eq=require("./eq"),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object,key,value){var objValue=object[key];hasOwnProperty.call(object,key)&&eq(objValue,value)&&(void 0!==value||key in object)||baseAssignValue(object,key,value)}},{"./_baseAssignValue":415,"./eq":556}],413:[function(require,module,exports){"use strict";var eq=require("./eq");module.exports=function(array,key){for(var length=array.length;length--;)if(eq(array[length][0],key))return length;return-1}},{"./eq":556}],414:[function(require,module,exports){"use strict";var baseEach=require("./_baseEach");module.exports=function(collection,setter,iteratee,accumulator){return baseEach(collection,function(value,key,collection){setter(accumulator,value,iteratee(value),collection)}),accumulator}},{"./_baseEach":418}],415:[function(require,module,exports){"use strict";var defineProperty=require("./_defineProperty");module.exports=function(object,key,value){"__proto__"==key&&defineProperty?defineProperty(object,key,{configurable:!0,enumerable:!0,value:value,writable:!0}):object[key]=value}},{"./_defineProperty":475}],416:[function(require,module,exports){"use strict";function baseCreate(proto){if(!isObject(proto))return{};if(objectCreate)return objectCreate(proto);object.prototype=proto;var result=new object;return object.prototype=void 0,result}var isObject=require("./isObject"),objectCreate=Object.create;function object(){}module.exports=baseCreate},{"./isObject":573}],417:[function(require,module,exports){"use strict";var SetCache=require("./_SetCache"),arrayIncludes=require("./_arrayIncludes"),arrayIncludesWith=require("./_arrayIncludesWith"),arrayMap=require("./_arrayMap"),baseUnary=require("./_baseUnary"),cacheHas=require("./_cacheHas");module.exports=function(array,values,iteratee,comparator){var index=-1,includes=arrayIncludes,isCommon=!0,length=array.length,result=[],valuesLength=values.length;if(!length)return result;iteratee&&(values=arrayMap(values,baseUnary(iteratee))),comparator?(includes=arrayIncludesWith,isCommon=!1):200<=values.length&&(includes=cacheHas,isCommon=!1,values=new SetCache(values));outer:for(;++index<length;){var value=array[index],computed=null==iteratee?value:iteratee(value),value=comparator||0!==value?value:0;if(isCommon&&computed==computed){for(var valuesIndex=valuesLength;valuesIndex--;)if(values[valuesIndex]===computed)continue outer;result.push(value)}else includes(values,computed,comparator)||result.push(value)}return result}},{"./_SetCache":396,"./_arrayIncludes":405,"./_arrayIncludesWith":406,"./_arrayMap":408,"./_baseUnary":450,"./_cacheHas":453}],418:[function(require,module,exports){"use strict";var baseForOwn=require("./_baseForOwn"),baseEach=require("./_createBaseEach")(baseForOwn);module.exports=baseEach},{"./_baseForOwn":423,"./_createBaseEach":464}],419:[function(require,module,exports){"use strict";var baseEach=require("./_baseEach");module.exports=function(collection,predicate){var result=[];return baseEach(collection,function(value,index,collection){predicate(value,index,collection)&&result.push(value)}),result}},{"./_baseEach":418}],420:[function(require,module,exports){"use strict";module.exports=function(array,predicate,fromIndex,fromRight){for(var length=array.length,index=fromIndex+(fromRight?1:-1);fromRight?index--:++index<length;)if(predicate(array[index],index,array))return index;return-1}},{}],421:[function(require,module,exports){"use strict";var arrayPush=require("./_arrayPush"),isFlattenable=require("./_isFlattenable");module.exports=function baseFlatten(array,depth,predicate,isStrict,result){var index=-1,length=array.length;for(predicate=predicate||isFlattenable,result=result||[];++index<length;){var value=array[index];0<depth&&predicate(value)?1<depth?baseFlatten(value,depth-1,predicate,isStrict,result):arrayPush(result,value):isStrict||(result[result.length]=value)}return result}},{"./_arrayPush":409,"./_isFlattenable":500}],422:[function(require,module,exports){"use strict";var baseFor=require("./_createBaseFor")();module.exports=baseFor},{"./_createBaseFor":465}],423:[function(require,module,exports){"use strict";var baseFor=require("./_baseFor"),keys=require("./keys");module.exports=function(object,iteratee){return object&&baseFor(object,iteratee,keys)}},{"./_baseFor":422,"./keys":578}],424:[function(require,module,exports){"use strict";var castPath=require("./_castPath"),toKey=require("./_toKey");module.exports=function(object,path){for(var index=0,length=(path=castPath(path,object)).length;null!=object&&index<length;)object=object[toKey(path[index++])];return index&&index==length?object:void 0}},{"./_castPath":455,"./_toKey":548}],425:[function(require,module,exports){"use strict";var arrayPush=require("./_arrayPush"),isArray=require("./isArray");module.exports=function(object,keysFunc,symbolsFunc){var result=keysFunc(object);return isArray(object)?result:arrayPush(result,symbolsFunc(object))}},{"./_arrayPush":409,"./isArray":566}],426:[function(require,module,exports){"use strict";var _Symbol=require("./_Symbol"),getRawTag=require("./_getRawTag"),objectToString=require("./_objectToString"),symToStringTag=_Symbol?_Symbol.toStringTag:void 0;module.exports=function(value){return null==value?void 0===value?"[object Undefined]":"[object Null]":(symToStringTag&&symToStringTag in Object(value)?getRawTag:objectToString)(value)}},{"./_Symbol":398,"./_getRawTag":488,"./_objectToString":527}],427:[function(require,module,exports){"use strict";module.exports=function(object,key){return null!=object&&key in Object(object)}},{}],428:[function(require,module,exports){"use strict";var baseFindIndex=require("./_baseFindIndex"),baseIsNaN=require("./_baseIsNaN"),strictIndexOf=require("./_strictIndexOf");module.exports=function(array,value,fromIndex){return value==value?strictIndexOf(array,value,fromIndex):baseFindIndex(array,baseIsNaN,fromIndex)}},{"./_baseFindIndex":420,"./_baseIsNaN":433,"./_strictIndexOf":546}],429:[function(require,module,exports){"use strict";var baseGetTag=require("./_baseGetTag"),isObjectLike=require("./isObjectLike");module.exports=function(value){return isObjectLike(value)&&"[object Arguments]"==baseGetTag(value)}},{"./_baseGetTag":426,"./isObjectLike":574}],430:[function(require,module,exports){"use strict";var baseIsEqualDeep=require("./_baseIsEqualDeep"),isObjectLike=require("./isObjectLike");module.exports=function baseIsEqual(value,other,bitmask,customizer,stack){return value===other||(null==value||null==other||!isObjectLike(value)&&!isObjectLike(other)?value!=value&&other!=other:baseIsEqualDeep(value,other,bitmask,customizer,baseIsEqual,stack))}},{"./_baseIsEqualDeep":431,"./isObjectLike":574}],431:[function(require,module,exports){"use strict";var Stack=require("./_Stack"),equalArrays=require("./_equalArrays"),equalByTag=require("./_equalByTag"),equalObjects=require("./_equalObjects"),getTag=require("./_getTag"),isArray=require("./isArray"),isBuffer=require("./isBuffer"),isTypedArray=require("./isTypedArray"),objectTag="[object Object]",hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object,other,bitmask,customizer,equalFunc,stack){var objIsArr=isArray(object),othIsArr=isArray(other),objTag=objIsArr?"[object Array]":getTag(object),othTag=othIsArr?"[object Array]":getTag(other),objIsObj=(objTag="[object Arguments]"==objTag?objectTag:objTag)==objectTag,othIsObj=(othTag="[object Arguments]"==othTag?objectTag:othTag)==objectTag,isSameTag=objTag==othTag;if(isSameTag&&isBuffer(object)){if(!isBuffer(other))return!1;objIsObj=!(objIsArr=!0)}if(isSameTag&&!objIsObj)return stack=stack||new Stack,objIsArr||isTypedArray(object)?equalArrays(object,other,bitmask,customizer,equalFunc,stack):equalByTag(object,other,objTag,bitmask,customizer,equalFunc,stack);if(!(1&bitmask)){var objIsWrapped=objIsObj&&hasOwnProperty.call(object,"__wrapped__"),othIsWrapped=othIsObj&&hasOwnProperty.call(other,"__wrapped__");if(objIsWrapped||othIsWrapped)return equalFunc(objIsWrapped?object.value():object,othIsWrapped?other.value():other,bitmask,customizer,stack=stack||new Stack)}return isSameTag&&(stack=stack||new Stack,equalObjects(object,other,bitmask,customizer,equalFunc,stack))}},{"./_Stack":397,"./_equalArrays":476,"./_equalByTag":477,"./_equalObjects":478,"./_getTag":490,"./isArray":566,"./isBuffer":569,"./isTypedArray":576}],432:[function(require,module,exports){"use strict";var Stack=require("./_Stack"),baseIsEqual=require("./_baseIsEqual");module.exports=function(object,source,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(null==object)return!length;for(object=Object(object);index--;){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object))return!1}for(;++index<length;){var key=(data=matchData[index])[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(void 0===objValue&&!(key in object))return!1}else{var result,stack=new Stack;if(customizer&&(result=customizer(objValue,srcValue,key,object,source,stack)),!(void 0===result?baseIsEqual(srcValue,objValue,3,customizer,stack):result))return!1}}return!0}},{"./_Stack":397,"./_baseIsEqual":430}],433:[function(require,module,exports){"use strict";module.exports=function(value){return value!=value}},{}],434:[function(require,module,exports){"use strict";var isFunction=require("./isFunction"),isMasked=require("./_isMasked"),isObject=require("./isObject"),toSource=require("./_toSource"),reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto=Function.prototype,objectProto=Object.prototype,funcToString=funcProto.toString,hasOwnProperty=objectProto.hasOwnProperty,reIsNative=RegExp("^"+funcToString.call(hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");module.exports=function(value){return!(!isObject(value)||isMasked(value))&&(isFunction(value)?reIsNative:reIsHostCtor).test(toSource(value))}},{"./_isMasked":506,"./_toSource":549,"./isFunction":571,"./isObject":573}],435:[function(require,module,exports){"use strict";var baseGetTag=require("./_baseGetTag"),isLength=require("./isLength"),isObjectLike=require("./isObjectLike"),typedArrayTags={};typedArrayTags["[object Float32Array]"]=typedArrayTags["[object Float64Array]"]=typedArrayTags["[object Int8Array]"]=typedArrayTags["[object Int16Array]"]=typedArrayTags["[object Int32Array]"]=typedArrayTags["[object Uint8Array]"]=typedArrayTags["[object Uint8ClampedArray]"]=typedArrayTags["[object Uint16Array]"]=typedArrayTags["[object Uint32Array]"]=!0,typedArrayTags["[object Arguments]"]=typedArrayTags["[object Array]"]=typedArrayTags["[object ArrayBuffer]"]=typedArrayTags["[object Boolean]"]=typedArrayTags["[object DataView]"]=typedArrayTags["[object Date]"]=typedArrayTags["[object Error]"]=typedArrayTags["[object Function]"]=typedArrayTags["[object Map]"]=typedArrayTags["[object Number]"]=typedArrayTags["[object Object]"]=typedArrayTags["[object RegExp]"]=typedArrayTags["[object Set]"]=typedArrayTags["[object String]"]=typedArrayTags["[object WeakMap]"]=!1,module.exports=function(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[baseGetTag(value)]}},{"./_baseGetTag":426,"./isLength":572,"./isObjectLike":574}],436:[function(require,module,exports){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},baseMatches=require("./_baseMatches"),baseMatchesProperty=require("./_baseMatchesProperty"),identity=require("./identity"),isArray=require("./isArray"),property=require("./property");module.exports=function(value){return"function"==typeof value?value:null==value?identity:"object"==(void 0===value?"undefined":_typeof(value))?isArray(value)?baseMatchesProperty(value[0],value[1]):baseMatches(value):property(value)}},{"./_baseMatches":440,"./_baseMatchesProperty":441,"./identity":564,"./isArray":566,"./property":583}],437:[function(require,module,exports){"use strict";var isPrototype=require("./_isPrototype"),nativeKeys=require("./_nativeKeys"),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object){if(!isPrototype(object))return nativeKeys(object);var result=[];for(var key in Object(object))hasOwnProperty.call(object,key)&&"constructor"!=key&&result.push(key);return result}},{"./_isPrototype":507,"./_nativeKeys":525}],438:[function(require,module,exports){"use strict";module.exports=function(){}},{}],439:[function(require,module,exports){"use strict";var baseEach=require("./_baseEach"),isArrayLike=require("./isArrayLike");module.exports=function(collection,iteratee){var index=-1,result=isArrayLike(collection)?Array(collection.length):[];return baseEach(collection,function(value,key,collection){result[++index]=iteratee(value,key,collection)}),result}},{"./_baseEach":418,"./isArrayLike":567}],440:[function(require,module,exports){"use strict";var baseIsMatch=require("./_baseIsMatch"),getMatchData=require("./_getMatchData"),matchesStrictComparable=require("./_matchesStrictComparable");module.exports=function(source){var matchData=getMatchData(source);return 1==matchData.length&&matchData[0][2]?matchesStrictComparable(matchData[0][0],matchData[0][1]):function(object){return object===source||baseIsMatch(object,source,matchData)}}},{"./_baseIsMatch":432,"./_getMatchData":485,"./_matchesStrictComparable":520}],441:[function(require,module,exports){"use strict";var baseIsEqual=require("./_baseIsEqual"),get=require("./get"),hasIn=require("./hasIn"),isKey=require("./_isKey"),isStrictComparable=require("./_isStrictComparable"),matchesStrictComparable=require("./_matchesStrictComparable"),toKey=require("./_toKey");module.exports=function(path,srcValue){return isKey(path)&&isStrictComparable(srcValue)?matchesStrictComparable(toKey(path),srcValue):function(object){var objValue=get(object,path);return void 0===objValue&&objValue===srcValue?hasIn(object,path):baseIsEqual(srcValue,objValue,3)}}},{"./_baseIsEqual":430,"./_isKey":503,"./_isStrictComparable":508,"./_matchesStrictComparable":520,"./_toKey":548,"./get":562,"./hasIn":563}],442:[function(require,module,exports){"use strict";module.exports=function(key){return function(object){return null==object?void 0:object[key]}}},{}],443:[function(require,module,exports){"use strict";var baseGet=require("./_baseGet");module.exports=function(path){return function(object){return baseGet(object,path)}}},{"./_baseGet":424}],444:[function(require,module,exports){"use strict";module.exports=function(collection,iteratee,accumulator,initAccum,eachFunc){return eachFunc(collection,function(value,index,collection){accumulator=initAccum?(initAccum=!1,value):iteratee(accumulator,value,index,collection)}),accumulator}},{}],445:[function(require,module,exports){"use strict";var identity=require("./identity"),overRest=require("./_overRest"),setToString=require("./_setToString");module.exports=function(func,start){return setToString(overRest(func,start,identity),func+"")}},{"./_overRest":529,"./_setToString":538,"./identity":564}],446:[function(require,module,exports){"use strict";var identity=require("./identity"),metaMap=require("./_metaMap"),baseSetData=metaMap?function(func,data){return metaMap.set(func,data),func}:identity;module.exports=baseSetData},{"./_metaMap":523,"./identity":564}],447:[function(require,module,exports){"use strict";var constant=require("./constant"),defineProperty=require("./_defineProperty"),identity=require("./identity"),baseSetToString=defineProperty?function(func,string){return defineProperty(func,"toString",{configurable:!0,enumerable:!1,value:constant(string),writable:!0})}:identity;module.exports=baseSetToString},{"./_defineProperty":475,"./constant":554,"./identity":564}],448:[function(require,module,exports){"use strict";module.exports=function(n,iteratee){for(var index=-1,result=Array(n);++index<n;)result[index]=iteratee(index);return result}},{}],449:[function(require,module,exports){"use strict";var _Symbol=require("./_Symbol"),arrayMap=require("./_arrayMap"),isArray=require("./isArray"),isSymbol=require("./isSymbol"),INFINITY=1/0,symbolProto=_Symbol?_Symbol.prototype:void 0,symbolToString=symbolProto?symbolProto.toString:void 0;module.exports=function baseToString(value){if("string"==typeof value)return value;if(isArray(value))return arrayMap(value,baseToString)+"";if(isSymbol(value))return symbolToString?symbolToString.call(value):"";var result=value+"";return"0"==result&&1/value==-INFINITY?"-0":result}},{"./_Symbol":398,"./_arrayMap":408,"./isArray":566,"./isSymbol":575}],450:[function(require,module,exports){"use strict";module.exports=function(func){return function(value){return func(value)}}},{}],451:[function(require,module,exports){"use strict";var SetCache=require("./_SetCache"),arrayIncludes=require("./_arrayIncludes"),arrayIncludesWith=require("./_arrayIncludesWith"),cacheHas=require("./_cacheHas"),createSet=require("./_createSet"),setToArray=require("./_setToArray");module.exports=function(array,iteratee,comparator){var index=-1,includes=arrayIncludes,length=array.length,isCommon=!0,result=[],seen=result;if(comparator)isCommon=!1,includes=arrayIncludesWith;else if(200<=length){var set=iteratee?null:createSet(array);if(set)return setToArray(set);isCommon=!1,includes=cacheHas,seen=new SetCache}else seen=iteratee?[]:result;outer:for(;++index<length;){var value=array[index],computed=iteratee?iteratee(value):value,value=comparator||0!==value?value:0;if(isCommon&&computed==computed){for(var seenIndex=seen.length;seenIndex--;)if(seen[seenIndex]===computed)continue outer;iteratee&&seen.push(computed),result.push(value)}else includes(seen,computed,comparator)||(seen!==result&&seen.push(computed),result.push(value))}return result}},{"./_SetCache":396,"./_arrayIncludes":405,"./_arrayIncludesWith":406,"./_cacheHas":453,"./_createSet":473,"./_setToArray":537}],452:[function(require,module,exports){"use strict";var baseDifference=require("./_baseDifference"),baseFlatten=require("./_baseFlatten"),baseUniq=require("./_baseUniq");module.exports=function(arrays,iteratee,comparator){var length=arrays.length;if(length<2)return length?baseUniq(arrays[0]):[];for(var index=-1,result=Array(length);++index<length;)for(var array=arrays[index],othIndex=-1;++othIndex<length;)othIndex!=index&&(result[index]=baseDifference(result[index]||array,arrays[othIndex],iteratee,comparator));return baseUniq(baseFlatten(result,1),iteratee,comparator)}},{"./_baseDifference":417,"./_baseFlatten":421,"./_baseUniq":451}],453:[function(require,module,exports){"use strict";module.exports=function(cache,key){return cache.has(key)}},{}],454:[function(require,module,exports){"use strict";var identity=require("./identity");module.exports=function(value){return"function"==typeof value?value:identity}},{"./identity":564}],455:[function(require,module,exports){"use strict";var isArray=require("./isArray"),isKey=require("./_isKey"),stringToPath=require("./_stringToPath"),toString=require("./toString");module.exports=function(value,object){return isArray(value)?value:isKey(value,object)?[value]:stringToPath(toString(value))}},{"./_isKey":503,"./_stringToPath":547,"./isArray":566,"./toString":590}],456:[function(require,module,exports){"use strict";var nativeMax=Math.max;module.exports=function(args,partials,holders,isCurried){for(var argsIndex=-1,argsLength=args.length,holdersLength=holders.length,leftIndex=-1,leftLength=partials.length,rangeLength=nativeMax(argsLength-holdersLength,0),result=Array(leftLength+rangeLength),isUncurried=!isCurried;++leftIndex<leftLength;)result[leftIndex]=partials[leftIndex];for(;++argsIndex<holdersLength;)(isUncurried||argsIndex<argsLength)&&(result[holders[argsIndex]]=args[argsIndex]);for(;rangeLength--;)result[leftIndex++]=args[argsIndex++];return result}},{}],457:[function(require,module,exports){"use strict";var nativeMax=Math.max;module.exports=function(args,partials,holders,isCurried){for(var argsIndex=-1,argsLength=args.length,holdersIndex=-1,holdersLength=holders.length,rightIndex=-1,rightLength=partials.length,rangeLength=nativeMax(argsLength-holdersLength,0),result=Array(rangeLength+rightLength),isUncurried=!isCurried;++argsIndex<rangeLength;)result[argsIndex]=args[argsIndex];for(var offset=argsIndex;++rightIndex<rightLength;)result[offset+rightIndex]=partials[rightIndex];for(;++holdersIndex<holdersLength;)(isUncurried||argsIndex<argsLength)&&(result[offset+holders[holdersIndex]]=args[argsIndex++]);return result}},{}],458:[function(require,module,exports){"use strict";module.exports=function(source,array){var index=-1,length=source.length;for(array=array||Array(length);++index<length;)array[index]=source[index];return array}},{}],459:[function(require,module,exports){"use strict";var assignValue=require("./_assignValue"),baseAssignValue=require("./_baseAssignValue");module.exports=function(source,props,object,customizer){var isNew=!object;object=object||{};for(var index=-1,length=props.length;++index<length;){var key=props[index],newValue=customizer?customizer(object[key],source[key],key,object,source):void 0;void 0===newValue&&(newValue=source[key]),(isNew?baseAssignValue:assignValue)(object,key,newValue)}return object}},{"./_assignValue":412,"./_baseAssignValue":415}],460:[function(require,module,exports){"use strict";var coreJsData=require("./_root")["__core-js_shared__"];module.exports=coreJsData},{"./_root":533}],461:[function(require,module,exports){"use strict";module.exports=function(array,placeholder){for(var length=array.length,result=0;length--;)array[length]===placeholder&&++result;return result}},{}],462:[function(require,module,exports){"use strict";var arrayAggregator=require("./_arrayAggregator"),baseAggregator=require("./_baseAggregator"),baseIteratee=require("./_baseIteratee"),isArray=require("./isArray");module.exports=function(setter,initializer){return function(collection,iteratee){var func=isArray(collection)?arrayAggregator:baseAggregator,accumulator=initializer?initializer():{};return func(collection,setter,baseIteratee(iteratee,2),accumulator)}}},{"./_arrayAggregator":402,"./_baseAggregator":414,"./_baseIteratee":436,"./isArray":566}],463:[function(require,module,exports){"use strict";var baseRest=require("./_baseRest"),isIterateeCall=require("./_isIterateeCall");module.exports=function(assigner){return baseRest(function(object,sources){var index=-1,length=sources.length,customizer=1<length?sources[length-1]:void 0,guard=2<length?sources[2]:void 0,customizer=3<assigner.length&&"function"==typeof customizer?(length--,customizer):void 0;for(guard&&isIterateeCall(sources[0],sources[1],guard)&&(customizer=length<3?void 0:customizer,length=1),object=Object(object);++index<length;){var source=sources[index];source&&assigner(object,source,index,customizer)}return object})}},{"./_baseRest":445,"./_isIterateeCall":502}],464:[function(require,module,exports){"use strict";var isArrayLike=require("./isArrayLike");module.exports=function(eachFunc,fromRight){return function(collection,iteratee){if(null==collection)return collection;if(!isArrayLike(collection))return eachFunc(collection,iteratee);for(var length=collection.length,index=fromRight?length:-1,iterable=Object(collection);(fromRight?index--:++index<length)&&!1!==iteratee(iterable[index],index,iterable););return collection}}},{"./isArrayLike":567}],465:[function(require,module,exports){"use strict";module.exports=function(fromRight){return function(object,iteratee,keysFunc){for(var index=-1,iterable=Object(object),props=keysFunc(object),length=props.length;length--;){var key=props[fromRight?length:++index];if(!1===iteratee(iterable[key],key,iterable))break}return object}}},{}],466:[function(require,module,exports){"use strict";var createCtor=require("./_createCtor"),root=require("./_root");module.exports=function(func,bitmask,thisArg){var isBind=1&bitmask,Ctor=createCtor(func);return function wrapper(){return(this&&this!==root&&this instanceof wrapper?Ctor:func).apply(isBind?thisArg:this,arguments)}}},{"./_createCtor":467,"./_root":533}],467:[function(require,module,exports){"use strict";var baseCreate=require("./_baseCreate"),isObject=require("./isObject");module.exports=function(Ctor){return function(){var args=arguments;switch(args.length){case 0:return new Ctor;case 1:return new Ctor(args[0]);case 2:return new Ctor(args[0],args[1]);case 3:return new Ctor(args[0],args[1],args[2]);case 4:return new Ctor(args[0],args[1],args[2],args[3]);case 5:return new Ctor(args[0],args[1],args[2],args[3],args[4]);case 6:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5]);case 7:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5],args[6])}var thisBinding=baseCreate(Ctor.prototype),result=Ctor.apply(thisBinding,args);return isObject(result)?result:thisBinding}}},{"./_baseCreate":416,"./isObject":573}],468:[function(require,module,exports){"use strict";var apply=require("./_apply"),createCtor=require("./_createCtor"),createHybrid=require("./_createHybrid"),createRecurry=require("./_createRecurry"),getHolder=require("./_getHolder"),replaceHolders=require("./_replaceHolders"),root=require("./_root");module.exports=function(func,bitmask,arity){var Ctor=createCtor(func);return function wrapper(){for(var length=arguments.length,args=Array(length),index=length,placeholder=getHolder(wrapper);index--;)args[index]=arguments[index];var holders=length<3&&args[0]!==placeholder&&args[length-1]!==placeholder?[]:replaceHolders(args,placeholder);return(length-=holders.length)<arity?createRecurry(func,bitmask,createHybrid,wrapper.placeholder,void 0,args,holders,void 0,void 0,arity-length):apply(this&&this!==root&&this instanceof wrapper?Ctor:func,this,args)}}},{"./_apply":401,"./_createCtor":467,"./_createHybrid":470,"./_createRecurry":472,"./_getHolder":483,"./_replaceHolders":532,"./_root":533}],469:[function(require,module,exports){"use strict";var baseIteratee=require("./_baseIteratee"),isArrayLike=require("./isArrayLike"),keys=require("./keys");module.exports=function(findIndexFunc){return function(collection,predicate,fromIndex){var iteratee,iterable=Object(collection);isArrayLike(collection)||(iteratee=baseIteratee(predicate,3),collection=keys(collection),predicate=function(key){return iteratee(iterable[key],key,iterable)});var index=findIndexFunc(collection,predicate,fromIndex);return-1<index?iterable[iteratee?collection[index]:index]:void 0}}},{"./_baseIteratee":436,"./isArrayLike":567,"./keys":578}],470:[function(require,module,exports){"use strict";var composeArgs=require("./_composeArgs"),composeArgsRight=require("./_composeArgsRight"),countHolders=require("./_countHolders"),createCtor=require("./_createCtor"),createRecurry=require("./_createRecurry"),getHolder=require("./_getHolder"),reorder=require("./_reorder"),replaceHolders=require("./_replaceHolders"),root=require("./_root"),WRAP_BIND_FLAG=1,WRAP_BIND_KEY_FLAG=2,WRAP_CURRY_FLAG=8,WRAP_CURRY_RIGHT_FLAG=16,WRAP_ARY_FLAG=128,WRAP_FLIP_FLAG=512;function createHybrid(func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity){var isAry=bitmask&WRAP_ARY_FLAG,isBind=bitmask&WRAP_BIND_FLAG,isBindKey=bitmask&WRAP_BIND_KEY_FLAG,isCurried=bitmask&(WRAP_CURRY_FLAG|WRAP_CURRY_RIGHT_FLAG),isFlip=bitmask&WRAP_FLIP_FLAG,Ctor=isBindKey?void 0:createCtor(func);return function wrapper(){for(var placeholder,holdersCount,length=arguments.length,args=Array(length),index=length;index--;)args[index]=arguments[index];if(isCurried&&(placeholder=getHolder(wrapper),holdersCount=countHolders(args,placeholder)),partials&&(args=composeArgs(args,partials,holders,isCurried)),partialsRight&&(args=composeArgsRight(args,partialsRight,holdersRight,isCurried)),length-=holdersCount,isCurried&&length<arity){var newHolders=replaceHolders(args,placeholder);return createRecurry(func,bitmask,createHybrid,wrapper.placeholder,thisArg,args,newHolders,argPos,ary,arity-length)}var thisBinding=isBind?thisArg:this,fn=isBindKey?thisBinding[func]:func,length=args.length;return argPos?args=reorder(args,argPos):isFlip&&1<length&&args.reverse(),isAry&&ary<length&&(args.length=ary),this&&this!==root&&this instanceof wrapper&&(fn=Ctor||createCtor(fn)),fn.apply(thisBinding,args)}}module.exports=createHybrid},{"./_composeArgs":456,"./_composeArgsRight":457,"./_countHolders":461,"./_createCtor":467,"./_createRecurry":472,"./_getHolder":483,"./_reorder":531,"./_replaceHolders":532,"./_root":533}],471:[function(require,module,exports){"use strict";var apply=require("./_apply"),createCtor=require("./_createCtor"),root=require("./_root");module.exports=function(func,bitmask,thisArg,partials){var isBind=1&bitmask,Ctor=createCtor(func);return function wrapper(){for(var argsIndex=-1,argsLength=arguments.length,leftIndex=-1,leftLength=partials.length,args=Array(leftLength+argsLength),fn=this&&this!==root&&this instanceof wrapper?Ctor:func;++leftIndex<leftLength;)args[leftIndex]=partials[leftIndex];for(;argsLength--;)args[leftIndex++]=arguments[++argsIndex];return apply(fn,isBind?thisArg:this,args)}}},{"./_apply":401,"./_createCtor":467,"./_root":533}],472:[function(require,module,exports){"use strict";var isLaziable=require("./_isLaziable"),setData=require("./_setData"),setWrapToString=require("./_setWrapToString");module.exports=function(func,bitmask,wrapFunc,placeholder,thisArg,partials,holders,argPos,ary,arity){var isCurry=8&bitmask;bitmask|=isCurry?32:64,4&(bitmask&=~(isCurry?64:32))||(bitmask&=-4);var newData=[func,bitmask,thisArg,isCurry?partials:void 0,isCurry?holders:void 0,isCurry?void 0:partials,isCurry?void 0:holders,argPos,ary,arity],result=wrapFunc.apply(void 0,newData);return isLaziable(func)&&setData(result,newData),result.placeholder=placeholder,setWrapToString(result,func,bitmask)}},{"./_isLaziable":505,"./_setData":536,"./_setWrapToString":539}],473:[function(require,module,exports){"use strict";var Set=require("./_Set"),noop=require("./noop"),setToArray=require("./_setToArray"),createSet=Set&&1/setToArray(new Set([,-0]))[1]==1/0?function(values){return new Set(values)}:noop;module.exports=createSet},{"./_Set":395,"./_setToArray":537,"./noop":581}],474:[function(require,module,exports){"use strict";var baseSetData=require("./_baseSetData"),createBind=require("./_createBind"),createCurry=require("./_createCurry"),createHybrid=require("./_createHybrid"),createPartial=require("./_createPartial"),getData=require("./_getData"),mergeData=require("./_mergeData"),setData=require("./_setData"),setWrapToString=require("./_setWrapToString"),toInteger=require("./toInteger"),nativeMax=Math.max;module.exports=function(func,bitmask,thisArg,partials,holders,argPos,ary,arity){var isBindKey=2&bitmask;if(!isBindKey&&"function"!=typeof func)throw new TypeError("Expected a function");var partialsRight,holdersRight,length=partials?partials.length:0;length||(bitmask&=-97,partials=holders=void 0),ary=void 0===ary?ary:nativeMax(toInteger(ary),0),arity=void 0===arity?arity:toInteger(arity),length-=holders?holders.length:0,64&bitmask&&(partialsRight=partials,holdersRight=holders,partials=holders=void 0);var result,data=isBindKey?void 0:getData(func),newData=[func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity];return data&&mergeData(newData,data),func=newData[0],bitmask=newData[1],thisArg=newData[2],partials=newData[3],holders=newData[4],!(arity=newData[9]=void 0===newData[9]?isBindKey?0:func.length:nativeMax(newData[9]-length,0))&&24&bitmask&&(bitmask&=-25),result=bitmask&&1!=bitmask?8==bitmask||16==bitmask?createCurry(func,bitmask,arity):32!=bitmask&&33!=bitmask||holders.length?createHybrid.apply(void 0,newData):createPartial(func,bitmask,thisArg,partials):createBind(func,bitmask,thisArg),setWrapToString((data?baseSetData:setData)(result,newData),func,bitmask)}},{"./_baseSetData":446,"./_createBind":466,"./_createCurry":468,"./_createHybrid":470,"./_createPartial":471,"./_getData":481,"./_mergeData":522,"./_setData":536,"./_setWrapToString":539,"./toInteger":588}],475:[function(require,module,exports){"use strict";var getNative=require("./_getNative"),defineProperty=function(){try{var func=getNative(Object,"defineProperty");return func({},"",{}),func}catch(e){}}();module.exports=defineProperty},{"./_getNative":486}],476:[function(require,module,exports){"use strict";var SetCache=require("./_SetCache"),arraySome=require("./_arraySome"),cacheHas=require("./_cacheHas");module.exports=function(array,other,bitmask,customizer,equalFunc,stack){var isPartial=1&bitmask,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isPartial&&arrLength<othLength))return!1;var arrStacked=stack.get(array),othStacked=stack.get(other);if(arrStacked&&othStacked)return arrStacked==other&&othStacked==array;var index=-1,result=!0,seen=2&bitmask?new SetCache:void 0;for(stack.set(array,other),stack.set(other,array);++index<arrLength;){var compared,arrValue=array[index],othValue=other[index];if(customizer&&(compared=isPartial?customizer(othValue,arrValue,index,other,array,stack):customizer(arrValue,othValue,index,array,other,stack)),void 0!==compared){if(compared)continue;result=!1;break}if(seen){if(!arraySome(other,function(othValue,othIndex){if(!cacheHas(seen,othIndex)&&(arrValue===othValue||equalFunc(arrValue,othValue,bitmask,customizer,stack)))return seen.push(othIndex)})){result=!1;break}}else if(arrValue!==othValue&&!equalFunc(arrValue,othValue,bitmask,customizer,stack)){result=!1;break}}return stack.delete(array),stack.delete(other),result}},{"./_SetCache":396,"./_arraySome":411,"./_cacheHas":453}],477:[function(require,module,exports){"use strict";var _Symbol=require("./_Symbol"),Uint8Array=require("./_Uint8Array"),eq=require("./eq"),equalArrays=require("./_equalArrays"),mapToArray=require("./_mapToArray"),setToArray=require("./_setToArray"),symbolProto=_Symbol?_Symbol.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;module.exports=function(object,other,tag,bitmask,customizer,equalFunc,stack){switch(tag){case"[object DataView]":if(object.byteLength!=other.byteLength||object.byteOffset!=other.byteOffset)return!1;object=object.buffer,other=other.buffer;case"[object ArrayBuffer]":return object.byteLength==other.byteLength&&equalFunc(new Uint8Array(object),new Uint8Array(other))?!0:!1;case"[object Boolean]":case"[object Date]":case"[object Number]":return eq(+object,+other);case"[object Error]":return object.name==other.name&&object.message==other.message;case"[object RegExp]":case"[object String]":return object==other+"";case"[object Map]":var convert=mapToArray;case"[object Set]":var isPartial=1&bitmask,convert=convert||setToArray;if(object.size!=other.size&&!isPartial)return!1;var stacked=stack.get(object);if(stacked)return stacked==other;bitmask|=2,stack.set(object,other);var result=equalArrays(convert(object),convert(other),bitmask,customizer,equalFunc,stack);return stack.delete(object),result;case"[object Symbol]":if(symbolValueOf)return symbolValueOf.call(object)==symbolValueOf.call(other)}return!1}},{"./_Symbol":398,"./_Uint8Array":399,"./_equalArrays":476,"./_mapToArray":519,"./_setToArray":537,"./eq":556}],478:[function(require,module,exports){"use strict";var getAllKeys=require("./_getAllKeys"),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object,other,bitmask,customizer,equalFunc,stack){var isPartial=1&bitmask,objProps=getAllKeys(object),objLength=objProps.length;if(objLength!=getAllKeys(other).length&&!isPartial)return!1;for(var index=objLength;index--;){var key=objProps[index];if(!(isPartial?key in other:hasOwnProperty.call(other,key)))return!1}var objStacked=stack.get(object),othStacked=stack.get(other);if(objStacked&&othStacked)return objStacked==other&&othStacked==object;var result=!0;stack.set(object,other),stack.set(other,object);for(var objCtor,othCtor,skipCtor=isPartial;++index<objLength;){var compared,objValue=object[key=objProps[index]],othValue=other[key];if(customizer&&(compared=isPartial?customizer(othValue,objValue,key,other,object,stack):customizer(objValue,othValue,key,object,other,stack)),!(void 0===compared?objValue===othValue||equalFunc(objValue,othValue,bitmask,customizer,stack):compared)){result=!1;break}skipCtor=skipCtor||"constructor"==key}return!result||skipCtor||(objCtor=object.constructor)!=(othCtor=other.constructor)&&"constructor"in object&&"constructor"in other&&!("function"==typeof objCtor&&objCtor instanceof objCtor&&"function"==typeof othCtor&&othCtor instanceof othCtor)&&(result=!1),stack.delete(object),stack.delete(other),result}},{"./_getAllKeys":480}],479:[function(require,module,exports){(function(global){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},freeGlobal="object"==(void 0===global?"undefined":_typeof(global))&&global&&global.Object===Object&&global;module.exports=freeGlobal}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],480:[function(require,module,exports){"use strict";var baseGetAllKeys=require("./_baseGetAllKeys"),getSymbols=require("./_getSymbols"),keys=require("./keys");module.exports=function(object){return baseGetAllKeys(object,keys,getSymbols)}},{"./_baseGetAllKeys":425,"./_getSymbols":489,"./keys":578}],481:[function(require,module,exports){"use strict";var metaMap=require("./_metaMap"),noop=require("./noop"),getData=metaMap?function(func){return metaMap.get(func)}:noop;module.exports=getData},{"./_metaMap":523,"./noop":581}],482:[function(require,module,exports){"use strict";var realNames=require("./_realNames"),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(func){for(var result=func.name+"",array=realNames[result],length=hasOwnProperty.call(realNames,result)?array.length:0;length--;){var data=array[length],otherFunc=data.func;if(null==otherFunc||otherFunc==func)return data.name}return result}},{"./_realNames":530}],483:[function(require,module,exports){"use strict";module.exports=function(func){return func.placeholder}},{}],484:[function(require,module,exports){"use strict";var isKeyable=require("./_isKeyable");module.exports=function(map,key){var data=map.__data__;return isKeyable(key)?data["string"==typeof key?"string":"hash"]:data.map}},{"./_isKeyable":504}],485:[function(require,module,exports){"use strict";var isStrictComparable=require("./_isStrictComparable"),keys=require("./keys");module.exports=function(object){for(var result=keys(object),length=result.length;length--;){var key=result[length],value=object[key];result[length]=[key,value,isStrictComparable(value)]}return result}},{"./_isStrictComparable":508,"./keys":578}],486:[function(require,module,exports){"use strict";var baseIsNative=require("./_baseIsNative"),getValue=require("./_getValue");module.exports=function(object,key){var value=getValue(object,key);return baseIsNative(value)?value:void 0}},{"./_baseIsNative":434,"./_getValue":491}],487:[function(require,module,exports){"use strict";var getPrototype=require("./_overArg")(Object.getPrototypeOf,Object);module.exports=getPrototype},{"./_overArg":528}],488:[function(require,module,exports){"use strict";var _Symbol=require("./_Symbol"),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,nativeObjectToString=objectProto.toString,symToStringTag=_Symbol?_Symbol.toStringTag:void 0;module.exports=function(value){var isOwn=hasOwnProperty.call(value,symToStringTag),tag=value[symToStringTag];try{var unmasked=!(value[symToStringTag]=void 0)}catch(e){}var result=nativeObjectToString.call(value);return unmasked&&(isOwn?value[symToStringTag]=tag:delete value[symToStringTag]),result}},{"./_Symbol":398}],489:[function(require,module,exports){"use strict";var arrayFilter=require("./_arrayFilter"),stubArray=require("./stubArray"),propertyIsEnumerable=Object.prototype.propertyIsEnumerable,nativeGetSymbols=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols?function(object){return null==object?[]:(object=Object(object),arrayFilter(nativeGetSymbols(object),function(symbol){return propertyIsEnumerable.call(object,symbol)}))}:stubArray;module.exports=getSymbols},{"./_arrayFilter":404,"./stubArray":585}],490:[function(require,module,exports){"use strict";var DataView=require("./_DataView"),Map=require("./_Map"),Promise=require("./_Promise"),Set=require("./_Set"),WeakMap=require("./_WeakMap"),baseGetTag=require("./_baseGetTag"),toSource=require("./_toSource"),dataViewCtorString=toSource(DataView),mapCtorString=toSource(Map),promiseCtorString=toSource(Promise),setCtorString=toSource(Set),weakMapCtorString=toSource(WeakMap),getTag=baseGetTag;(DataView&&"[object DataView]"!=getTag(new DataView(new ArrayBuffer(1)))||Map&&"[object Map]"!=getTag(new Map)||Promise&&"[object Promise]"!=getTag(Promise.resolve())||Set&&"[object Set]"!=getTag(new Set)||WeakMap&&"[object WeakMap]"!=getTag(new WeakMap))&&(getTag=function(value){var result=baseGetTag(value),Ctor="[object Object]"==result?value.constructor:void 0,ctorString=Ctor?toSource(Ctor):"";if(ctorString)switch(ctorString){case dataViewCtorString:return"[object DataView]";case mapCtorString:return"[object Map]";case promiseCtorString:return"[object Promise]";case setCtorString:return"[object Set]";case weakMapCtorString:return"[object WeakMap]"}return result}),module.exports=getTag},{"./_DataView":387,"./_Map":392,"./_Promise":394,"./_Set":395,"./_WeakMap":400,"./_baseGetTag":426,"./_toSource":549}],491:[function(require,module,exports){"use strict";module.exports=function(object,key){return null==object?void 0:object[key]}},{}],492:[function(require,module,exports){"use strict";var reWrapDetails=/\{\n\/\* \[wrapped with (.+)\] \*/,reSplitDetails=/,? & /;module.exports=function(source){var match=source.match(reWrapDetails);return match?match[1].split(reSplitDetails):[]}},{}],493:[function(require,module,exports){"use strict";var castPath=require("./_castPath"),isArguments=require("./isArguments"),isArray=require("./isArray"),isIndex=require("./_isIndex"),isLength=require("./isLength"),toKey=require("./_toKey");module.exports=function(object,path,hasFunc){for(var index=-1,length=(path=castPath(path,object)).length,result=!1;++index<length;){var key=toKey(path[index]);if(!(result=null!=object&&hasFunc(object,key)))break;object=object[key]}return result||++index!=length?result:!!(length=null==object?0:object.length)&&isLength(length)&&isIndex(key,length)&&(isArray(object)||isArguments(object))}},{"./_castPath":455,"./_isIndex":501,"./_toKey":548,"./isArguments":565,"./isArray":566,"./isLength":572}],494:[function(require,module,exports){"use strict";var nativeCreate=require("./_nativeCreate");module.exports=function(){this.__data__=nativeCreate?nativeCreate(null):{},this.size=0}},{"./_nativeCreate":524}],495:[function(require,module,exports){"use strict";module.exports=function(key){var result=this.has(key)&&delete this.__data__[key];return this.size-=result?1:0,result}},{}],496:[function(require,module,exports){"use strict";var nativeCreate=require("./_nativeCreate"),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(key){var data=this.__data__;if(nativeCreate){var result=data[key];return"__lodash_hash_undefined__"===result?void 0:result}return hasOwnProperty.call(data,key)?data[key]:void 0}},{"./_nativeCreate":524}],497:[function(require,module,exports){"use strict";var nativeCreate=require("./_nativeCreate"),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(key){var data=this.__data__;return nativeCreate?void 0!==data[key]:hasOwnProperty.call(data,key)}},{"./_nativeCreate":524}],498:[function(require,module,exports){"use strict";var nativeCreate=require("./_nativeCreate");module.exports=function(key,value){var data=this.__data__;return this.size+=this.has(key)?0:1,data[key]=nativeCreate&&void 0===value?"__lodash_hash_undefined__":value,this}},{"./_nativeCreate":524}],499:[function(require,module,exports){"use strict";var reWrapComment=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;module.exports=function(source,details){var length=details.length;if(!length)return source;var lastIndex=length-1;return details[lastIndex]=(1<length?"& ":"")+details[lastIndex],details=details.join(2<length?", ":" "),source.replace(reWrapComment,"{\n/* [wrapped with "+details+"] */\n")}},{}],500:[function(require,module,exports){"use strict";var _Symbol=require("./_Symbol"),isArguments=require("./isArguments"),isArray=require("./isArray"),spreadableSymbol=_Symbol?_Symbol.isConcatSpreadable:void 0;module.exports=function(value){return isArray(value)||isArguments(value)||!!(spreadableSymbol&&value&&value[spreadableSymbol])}},{"./_Symbol":398,"./isArguments":565,"./isArray":566}],501:[function(require,module,exports){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},reIsUint=/^(?:0|[1-9]\d*)$/;module.exports=function(value,length){var type=void 0===value?"undefined":_typeof(value);return!!(length=null==length?9007199254740991:length)&&("number"==type||"symbol"!=type&&reIsUint.test(value))&&-1<value&&value%1==0&&value<length}},{}],502:[function(require,module,exports){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},eq=require("./eq"),isArrayLike=require("./isArrayLike"),isIndex=require("./_isIndex"),isObject=require("./isObject");module.exports=function(value,index,object){if(!isObject(object))return!1;var type=void 0===index?"undefined":_typeof(index);return!!("number"==type?isArrayLike(object)&&isIndex(index,object.length):"string"==type&&index in object)&&eq(object[index],value)}},{"./_isIndex":501,"./eq":556,"./isArrayLike":567,"./isObject":573}],503:[function(require,module,exports){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},isArray=require("./isArray"),isSymbol=require("./isSymbol"),reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;module.exports=function(value,object){if(isArray(value))return!1;var type=void 0===value?"undefined":_typeof(value);return!("number"!=type&&"symbol"!=type&&"boolean"!=type&&null!=value&&!isSymbol(value))||(reIsPlainProp.test(value)||!reIsDeepProp.test(value)||null!=object&&value in Object(object))}},{"./isArray":566,"./isSymbol":575}],504:[function(require,module,exports){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};module.exports=function(value){var type=void 0===value?"undefined":_typeof(value);return"string"==type||"number"==type||"symbol"==type||"boolean"==type?"__proto__"!==value:null===value}},{}],505:[function(require,module,exports){"use strict";var LazyWrapper=require("./_LazyWrapper"),getData=require("./_getData"),getFuncName=require("./_getFuncName"),lodash=require("./wrapperLodash");module.exports=function(func){var funcName=getFuncName(func),other=lodash[funcName];if("function"!=typeof other||!(funcName in LazyWrapper.prototype))return!1;if(func===other)return!0;var data=getData(other);return!!data&&func===data[0]}},{"./_LazyWrapper":389,"./_getData":481,"./_getFuncName":482,"./wrapperLodash":592}],506:[function(require,module,exports){"use strict";var uid,coreJsData=require("./_coreJsData"),maskSrcKey=(uid=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||""))?"Symbol(src)_1."+uid:"";module.exports=function(func){return!!maskSrcKey&&maskSrcKey in func}},{"./_coreJsData":460}],507:[function(require,module,exports){"use strict";var objectProto=Object.prototype;module.exports=function(value){var Ctor=value&&value.constructor;return value===("function"==typeof Ctor&&Ctor.prototype||objectProto)}},{}],508:[function(require,module,exports){"use strict";var isObject=require("./isObject");module.exports=function(value){return value==value&&!isObject(value)}},{"./isObject":573}],509:[function(require,module,exports){"use strict";module.exports=function(){this.__data__=[],this.size=0}},{}],510:[function(require,module,exports){"use strict";var assocIndexOf=require("./_assocIndexOf"),splice=Array.prototype.splice;module.exports=function(key){var data=this.__data__,index=assocIndexOf(data,key);return!(index<0)&&(index==data.length-1?data.pop():splice.call(data,index,1),--this.size,!0)}},{"./_assocIndexOf":413}],511:[function(require,module,exports){"use strict";var assocIndexOf=require("./_assocIndexOf");module.exports=function(key){var data=this.__data__,index=assocIndexOf(data,key);return index<0?void 0:data[index][1]}},{"./_assocIndexOf":413}],512:[function(require,module,exports){"use strict";var assocIndexOf=require("./_assocIndexOf");module.exports=function(key){return-1<assocIndexOf(this.__data__,key)}},{"./_assocIndexOf":413}],513:[function(require,module,exports){"use strict";var assocIndexOf=require("./_assocIndexOf");module.exports=function(key,value){var data=this.__data__,index=assocIndexOf(data,key);return index<0?(++this.size,data.push([key,value])):data[index][1]=value,this}},{"./_assocIndexOf":413}],514:[function(require,module,exports){"use strict";var Hash=require("./_Hash"),ListCache=require("./_ListCache"),Map=require("./_Map");module.exports=function(){this.size=0,this.__data__={hash:new Hash,map:new(Map||ListCache),string:new Hash}}},{"./_Hash":388,"./_ListCache":390,"./_Map":392}],515:[function(require,module,exports){"use strict";var getMapData=require("./_getMapData");module.exports=function(key){var result=getMapData(this,key).delete(key);return this.size-=result?1:0,result}},{"./_getMapData":484}],516:[function(require,module,exports){"use strict";var getMapData=require("./_getMapData");module.exports=function(key){return getMapData(this,key).get(key)}},{"./_getMapData":484}],517:[function(require,module,exports){"use strict";var getMapData=require("./_getMapData");module.exports=function(key){return getMapData(this,key).has(key)}},{"./_getMapData":484}],518:[function(require,module,exports){"use strict";var getMapData=require("./_getMapData");module.exports=function(key,value){var data=getMapData(this,key),size=data.size;return data.set(key,value),this.size+=data.size==size?0:1,this}},{"./_getMapData":484}],519:[function(require,module,exports){"use strict";module.exports=function(map){var index=-1,result=Array(map.size);return map.forEach(function(value,key){result[++index]=[key,value]}),result}},{}],520:[function(require,module,exports){"use strict";module.exports=function(key,srcValue){return function(object){return null!=object&&(object[key]===srcValue&&(void 0!==srcValue||key in Object(object)))}}},{}],521:[function(require,module,exports){"use strict";var memoize=require("./memoize");module.exports=function(func){var result=memoize(func,function(key){return 500===cache.size&&cache.clear(),key}),cache=result.cache;return result}},{"./memoize":580}],522:[function(require,module,exports){"use strict";var composeArgs=require("./_composeArgs"),composeArgsRight=require("./_composeArgsRight"),replaceHolders=require("./_replaceHolders"),nativeMin=Math.min;module.exports=function(data,source){var bitmask=data[1],srcBitmask=source[1],newBitmask=bitmask|srcBitmask,isCommon=newBitmask<131,isCombo=128==srcBitmask&&8==bitmask||128==srcBitmask&&256==bitmask&&data[7].length<=source[8]||384==srcBitmask&&source[7].length<=source[8]&&8==bitmask;if(!isCommon&&!isCombo)return data;1&srcBitmask&&(data[2]=source[2],newBitmask|=1&bitmask?0:4);var partials,value=source[3];return value&&(partials=data[3],data[3]=partials?composeArgs(partials,value,source[4]):value,data[4]=partials?replaceHolders(data[3],"__lodash_placeholder__"):source[4]),(value=source[5])&&(partials=data[5],data[5]=partials?composeArgsRight(partials,value,source[6]):value,data[6]=partials?replaceHolders(data[5],"__lodash_placeholder__"):source[6]),(value=source[7])&&(data[7]=value),128&srcBitmask&&(data[8]=null==data[8]?source[8]:nativeMin(data[8],source[8])),null==data[9]&&(data[9]=source[9]),data[0]=source[0],data[1]=newBitmask,data}},{"./_composeArgs":456,"./_composeArgsRight":457,"./_replaceHolders":532}],523:[function(require,module,exports){"use strict";var WeakMap=require("./_WeakMap"),metaMap=WeakMap&&new WeakMap;module.exports=metaMap},{"./_WeakMap":400}],524:[function(require,module,exports){"use strict";var nativeCreate=require("./_getNative")(Object,"create");module.exports=nativeCreate},{"./_getNative":486}],525:[function(require,module,exports){"use strict";var nativeKeys=require("./_overArg")(Object.keys,Object);module.exports=nativeKeys},{"./_overArg":528}],526:[function(require,module,exports){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},freeGlobal=require("./_freeGlobal"),freeExports="object"==(void 0===exports?"undefined":_typeof(exports))&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==(void 0===module?"undefined":_typeof(module))&&module&&!module.nodeType&&module,freeProcess=freeModule&&freeModule.exports===freeExports&&freeGlobal.process,nodeUtil=function(){try{var types=freeModule&&freeModule.require&&freeModule.require("util").types;return types?types:freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}();module.exports=nodeUtil},{"./_freeGlobal":479}],527:[function(require,module,exports){"use strict";var nativeObjectToString=Object.prototype.toString;module.exports=function(value){return nativeObjectToString.call(value)}},{}],528:[function(require,module,exports){"use strict";module.exports=function(func,transform){return function(arg){return func(transform(arg))}}},{}],529:[function(require,module,exports){"use strict";var apply=require("./_apply"),nativeMax=Math.max;module.exports=function(func,start,transform){return start=nativeMax(void 0===start?func.length-1:start,0),function(){for(var args=arguments,index=-1,length=nativeMax(args.length-start,0),array=Array(length);++index<length;)array[index]=args[start+index];index=-1;for(var otherArgs=Array(start+1);++index<start;)otherArgs[index]=args[index];return otherArgs[start]=transform(array),apply(func,this,otherArgs)}}},{"./_apply":401}],530:[function(require,module,exports){"use strict";module.exports={}},{}],531:[function(require,module,exports){"use strict";var copyArray=require("./_copyArray"),isIndex=require("./_isIndex"),nativeMin=Math.min;module.exports=function(array,indexes){for(var arrLength=array.length,length=nativeMin(indexes.length,arrLength),oldArray=copyArray(array);length--;){var index=indexes[length];array[length]=isIndex(index,arrLength)?oldArray[index]:void 0}return array}},{"./_copyArray":458,"./_isIndex":501}],532:[function(require,module,exports){"use strict";module.exports=function(array,placeholder){for(var index=-1,length=array.length,resIndex=0,result=[];++index<length;){var value=array[index];value!==placeholder&&"__lodash_placeholder__"!==value||(array[index]="__lodash_placeholder__",result[resIndex++]=index)}return result}},{}],533:[function(require,module,exports){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},freeGlobal=require("./_freeGlobal"),freeSelf="object"==("undefined"==typeof self?"undefined":_typeof(self))&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")();module.exports=root},{"./_freeGlobal":479}],534:[function(require,module,exports){"use strict";module.exports=function(value){return this.__data__.set(value,"__lodash_hash_undefined__"),this}},{}],535:[function(require,module,exports){"use strict";module.exports=function(value){return this.__data__.has(value)}},{}],536:[function(require,module,exports){"use strict";var baseSetData=require("./_baseSetData"),setData=require("./_shortOut")(baseSetData);module.exports=setData},{"./_baseSetData":446,"./_shortOut":540}],537:[function(require,module,exports){"use strict";module.exports=function(set){var index=-1,result=Array(set.size);return set.forEach(function(value){result[++index]=value}),result}},{}],538:[function(require,module,exports){"use strict";var baseSetToString=require("./_baseSetToString"),setToString=require("./_shortOut")(baseSetToString);module.exports=setToString},{"./_baseSetToString":447,"./_shortOut":540}],539:[function(require,module,exports){"use strict";var getWrapDetails=require("./_getWrapDetails"),insertWrapDetails=require("./_insertWrapDetails"),setToString=require("./_setToString"),updateWrapDetails=require("./_updateWrapDetails");module.exports=function(wrapper,reference,bitmask){var source=reference+"";return setToString(wrapper,insertWrapDetails(source,updateWrapDetails(getWrapDetails(source),bitmask)))}},{"./_getWrapDetails":492,"./_insertWrapDetails":499,"./_setToString":538,"./_updateWrapDetails":550}],540:[function(require,module,exports){"use strict";var nativeNow=Date.now;module.exports=function(func){var count=0,lastCalled=0;return function(){var stamp=nativeNow(),remaining=16-(stamp-lastCalled);if(lastCalled=stamp,0<remaining){if(800<=++count)return arguments[0]}else count=0;return func.apply(void 0,arguments)}}},{}],541:[function(require,module,exports){"use strict";var ListCache=require("./_ListCache");module.exports=function(){this.__data__=new ListCache,this.size=0}},{"./_ListCache":390}],542:[function(require,module,exports){"use strict";module.exports=function(key){var data=this.__data__,result=data.delete(key);return this.size=data.size,result}},{}],543:[function(require,module,exports){"use strict";module.exports=function(key){return this.__data__.get(key)}},{}],544:[function(require,module,exports){"use strict";module.exports=function(key){return this.__data__.has(key)}},{}],545:[function(require,module,exports){"use strict";var ListCache=require("./_ListCache"),Map=require("./_Map"),MapCache=require("./_MapCache");module.exports=function(key,value){var data=this.__data__;if(data instanceof ListCache){var pairs=data.__data__;if(!Map||pairs.length<199)return pairs.push([key,value]),this.size=++data.size,this;data=this.__data__=new MapCache(pairs)}return data.set(key,value),this.size=data.size,this}},{"./_ListCache":390,"./_Map":392,"./_MapCache":393}],546:[function(require,module,exports){"use strict";module.exports=function(array,value,fromIndex){for(var index=fromIndex-1,length=array.length;++index<length;)if(array[index]===value)return index;return-1}},{}],547:[function(require,module,exports){"use strict";var memoizeCapped=require("./_memoizeCapped"),rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped(function(string){var result=[];return 46===string.charCodeAt(0)&&result.push(""),string.replace(rePropName,function(match,number,quote,subString){result.push(quote?subString.replace(reEscapeChar,"$1"):number||match)}),result});module.exports=stringToPath},{"./_memoizeCapped":521}],548:[function(require,module,exports){"use strict";var isSymbol=require("./isSymbol");module.exports=function(value){if("string"==typeof value||isSymbol(value))return value;var result=value+"";return"0"==result&&1/value==-1/0?"-0":result}},{"./isSymbol":575}],549:[function(require,module,exports){"use strict";var funcToString=Function.prototype.toString;module.exports=function(func){if(null!=func){try{return funcToString.call(func)}catch(e){}try{return func+""}catch(e){}}return""}},{}],550:[function(require,module,exports){"use strict";var arrayEach=require("./_arrayEach"),arrayIncludes=require("./_arrayIncludes"),wrapFlags=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];module.exports=function(details,bitmask){return arrayEach(wrapFlags,function(pair){var value="_."+pair[0];bitmask&pair[1]&&!arrayIncludes(details,value)&&details.push(value)}),details.sort()}},{"./_arrayEach":403,"./_arrayIncludes":405}],551:[function(require,module,exports){"use strict";var LazyWrapper=require("./_LazyWrapper"),LodashWrapper=require("./_LodashWrapper"),copyArray=require("./_copyArray");module.exports=function(wrapper){if(wrapper instanceof LazyWrapper)return wrapper.clone();var result=new LodashWrapper(wrapper.__wrapped__,wrapper.__chain__);return result.__actions__=copyArray(wrapper.__actions__),result.__index__=wrapper.__index__,result.__values__=wrapper.__values__,result}},{"./_LazyWrapper":389,"./_LodashWrapper":391,"./_copyArray":458}],552:[function(require,module,exports){"use strict";var assignValue=require("./_assignValue"),copyObject=require("./_copyObject"),createAssigner=require("./_createAssigner"),isArrayLike=require("./isArrayLike"),isPrototype=require("./_isPrototype"),keys=require("./keys"),hasOwnProperty=Object.prototype.hasOwnProperty,assign=createAssigner(function(object,source){if(isPrototype(source)||isArrayLike(source))copyObject(source,keys(source),object);else for(var key in source)hasOwnProperty.call(source,key)&&assignValue(object,key,source[key])});module.exports=assign},{"./_assignValue":412,"./_copyObject":459,"./_createAssigner":463,"./_isPrototype":507,"./isArrayLike":567,"./keys":578}],553:[function(require,module,exports){"use strict";var baseRest=require("./_baseRest"),createWrap=require("./_createWrap"),getHolder=require("./_getHolder"),replaceHolders=require("./_replaceHolders"),bind=baseRest(function(func,thisArg,partials){var holders,bitmask=1;return partials.length&&(holders=replaceHolders(partials,getHolder(bind)),bitmask|=32),createWrap(func,bitmask,thisArg,partials,holders)});bind.placeholder={},module.exports=bind},{"./_baseRest":445,"./_createWrap":474,"./_getHolder":483,"./_replaceHolders":532}],554:[function(require,module,exports){"use strict";module.exports=function(value){return function(){return value}}},{}],555:[function(require,module,exports){"use strict";var isObject=require("./isObject"),now=require("./now"),toNumber=require("./toNumber"),nativeMax=Math.max,nativeMin=Math.min;module.exports=function(func,wait,options){var lastArgs,lastThis,maxWait,result,timerId,lastCallTime,lastInvokeTime=0,leading=!1,maxing=!1,trailing=!0;if("function"!=typeof func)throw new TypeError("Expected a function");function invokeFunc(time){var args=lastArgs,thisArg=lastThis;return lastArgs=lastThis=void 0,lastInvokeTime=time,result=func.apply(thisArg,args)}function shouldInvoke(time){var timeSinceLastCall=time-lastCallTime;return void 0===lastCallTime||wait<=timeSinceLastCall||timeSinceLastCall<0||maxing&&maxWait<=time-lastInvokeTime}function timerExpired(){var time=now();if(shouldInvoke(time))return trailingEdge(time);timerId=setTimeout(timerExpired,function(time){var timeWaiting=wait-(time-lastCallTime);return maxing?nativeMin(timeWaiting,maxWait-(time-lastInvokeTime)):timeWaiting}(time))}function trailingEdge(time){return timerId=void 0,trailing&&lastArgs?invokeFunc(time):(lastArgs=lastThis=void 0,result)}function debounced(){var time=now(),isInvoking=shouldInvoke(time);if(lastArgs=arguments,lastThis=this,lastCallTime=time,isInvoking){if(void 0===timerId)return function(time){return lastInvokeTime=time,timerId=setTimeout(timerExpired,wait),leading?invokeFunc(time):result}(lastCallTime);if(maxing)return clearTimeout(timerId),timerId=setTimeout(timerExpired,wait),invokeFunc(lastCallTime)}return void 0===timerId&&(timerId=setTimeout(timerExpired,wait)),result}return wait=toNumber(wait)||0,isObject(options)&&(leading=!!options.leading,maxing="maxWait"in options,maxWait=maxing?nativeMax(toNumber(options.maxWait)||0,wait):maxWait,trailing="trailing"in options?!!options.trailing:trailing),debounced.cancel=function(){void 0!==timerId&&clearTimeout(timerId),lastArgs=lastCallTime=lastThis=timerId=void(lastInvokeTime=0)},debounced.flush=function(){return void 0===timerId?result:trailingEdge(now())},debounced}},{"./isObject":573,"./now":582,"./toNumber":589}],556:[function(require,module,exports){"use strict";module.exports=function(value,other){return value===other||value!=value&&other!=other}},{}],557:[function(require,module,exports){"use strict";var arrayFilter=require("./_arrayFilter"),baseFilter=require("./_baseFilter"),baseIteratee=require("./_baseIteratee"),isArray=require("./isArray");module.exports=function(collection,predicate){return(isArray(collection)?arrayFilter:baseFilter)(collection,baseIteratee(predicate,3))}},{"./_arrayFilter":404,"./_baseFilter":419,"./_baseIteratee":436,"./isArray":566}],558:[function(require,module,exports){"use strict";var find=require("./_createFind")(require("./findIndex"));module.exports=find},{"./_createFind":469,"./findIndex":559}],559:[function(require,module,exports){"use strict";var baseFindIndex=require("./_baseFindIndex"),baseIteratee=require("./_baseIteratee"),toInteger=require("./toInteger"),nativeMax=Math.max;module.exports=function(array,predicate,fromIndex){var length=null==array?0:array.length;if(!length)return-1;var index=null==fromIndex?0:toInteger(fromIndex);return index<0&&(index=nativeMax(length+index,0)),baseFindIndex(array,baseIteratee(predicate,3),index)}},{"./_baseFindIndex":420,"./_baseIteratee":436,"./toInteger":588}],560:[function(require,module,exports){"use strict";var baseFlatten=require("./_baseFlatten");module.exports=function(array){return(null==array?0:array.length)?baseFlatten(array,1/0):[]}},{"./_baseFlatten":421}],561:[function(require,module,exports){"use strict";var arrayEach=require("./_arrayEach"),baseEach=require("./_baseEach"),castFunction=require("./_castFunction"),isArray=require("./isArray");module.exports=function(collection,iteratee){return(isArray(collection)?arrayEach:baseEach)(collection,castFunction(iteratee))}},{"./_arrayEach":403,"./_baseEach":418,"./_castFunction":454,"./isArray":566}],562:[function(require,module,exports){"use strict";var baseGet=require("./_baseGet");module.exports=function(object,path,defaultValue){var result=null==object?void 0:baseGet(object,path);return void 0===result?defaultValue:result}},{"./_baseGet":424}],563:[function(require,module,exports){"use strict";var baseHasIn=require("./_baseHasIn"),hasPath=require("./_hasPath");module.exports=function(object,path){return null!=object&&hasPath(object,path,baseHasIn)}},{"./_baseHasIn":427,"./_hasPath":493}],564:[function(require,module,exports){"use strict";module.exports=function(value){return value}},{}],565:[function(require,module,exports){"use strict";var baseIsArguments=require("./_baseIsArguments"),isObjectLike=require("./isObjectLike"),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,propertyIsEnumerable=objectProto.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(value){return isObjectLike(value)&&hasOwnProperty.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")};module.exports=isArguments},{"./_baseIsArguments":429,"./isObjectLike":574}],566:[function(require,module,exports){"use strict";var isArray=Array.isArray;module.exports=isArray},{}],567:[function(require,module,exports){"use strict";var isFunction=require("./isFunction"),isLength=require("./isLength");module.exports=function(value){return null!=value&&isLength(value.length)&&!isFunction(value)}},{"./isFunction":571,"./isLength":572}],568:[function(require,module,exports){"use strict";var isArrayLike=require("./isArrayLike"),isObjectLike=require("./isObjectLike");module.exports=function(value){return isObjectLike(value)&&isArrayLike(value)}},{"./isArrayLike":567,"./isObjectLike":574}],569:[function(require,module,exports){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},root=require("./_root"),stubFalse=require("./stubFalse"),freeExports="object"==(void 0===exports?"undefined":_typeof(exports))&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==(void 0===module?"undefined":_typeof(module))&&module&&!module.nodeType&&module,Buffer=freeModule&&freeModule.exports===freeExports?root.Buffer:void 0,isBuffer=(Buffer?Buffer.isBuffer:void 0)||stubFalse;module.exports=isBuffer},{"./_root":533,"./stubFalse":586}],570:[function(require,module,exports){"use strict";var baseKeys=require("./_baseKeys"),getTag=require("./_getTag"),isArguments=require("./isArguments"),isArray=require("./isArray"),isArrayLike=require("./isArrayLike"),isBuffer=require("./isBuffer"),isPrototype=require("./_isPrototype"),isTypedArray=require("./isTypedArray"),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(value){if(null==value)return!0;if(isArrayLike(value)&&(isArray(value)||"string"==typeof value||"function"==typeof value.splice||isBuffer(value)||isTypedArray(value)||isArguments(value)))return!value.length;var tag=getTag(value);if("[object Map]"==tag||"[object Set]"==tag)return!value.size;if(isPrototype(value))return!baseKeys(value).length;for(var key in value)if(hasOwnProperty.call(value,key))return!1;return!0}},{"./_baseKeys":437,"./_getTag":490,"./_isPrototype":507,"./isArguments":565,"./isArray":566,"./isArrayLike":567,"./isBuffer":569,"./isTypedArray":576}],571:[function(require,module,exports){"use strict";var baseGetTag=require("./_baseGetTag"),isObject=require("./isObject");module.exports=function(value){if(!isObject(value))return!1;var tag=baseGetTag(value);return"[object Function]"==tag||"[object GeneratorFunction]"==tag||"[object AsyncFunction]"==tag||"[object Proxy]"==tag}},{"./_baseGetTag":426,"./isObject":573}],572:[function(require,module,exports){"use strict";module.exports=function(value){return"number"==typeof value&&-1<value&&value%1==0&&value<=9007199254740991}},{}],573:[function(require,module,exports){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};module.exports=function(value){var type=void 0===value?"undefined":_typeof(value);return null!=value&&("object"==type||"function"==type)}},{}],574:[function(require,module,exports){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};module.exports=function(value){return null!=value&&"object"==(void 0===value?"undefined":_typeof(value))}},{}],575:[function(require,module,exports){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},baseGetTag=require("./_baseGetTag"),isObjectLike=require("./isObjectLike");module.exports=function(value){return"symbol"==(void 0===value?"undefined":_typeof(value))||isObjectLike(value)&&"[object Symbol]"==baseGetTag(value)}},{"./_baseGetTag":426,"./isObjectLike":574}],576:[function(require,module,exports){"use strict";var baseIsTypedArray=require("./_baseIsTypedArray"),baseUnary=require("./_baseUnary"),nodeUtil=require("./_nodeUtil"),nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray;module.exports=isTypedArray},{"./_baseIsTypedArray":435,"./_baseUnary":450,"./_nodeUtil":526}],577:[function(require,module,exports){"use strict";var baseAssignValue=require("./_baseAssignValue"),keyBy=require("./_createAggregator")(function(result,value,key){baseAssignValue(result,key,value)});module.exports=keyBy},{"./_baseAssignValue":415,"./_createAggregator":462}],578:[function(require,module,exports){"use strict";var arrayLikeKeys=require("./_arrayLikeKeys"),baseKeys=require("./_baseKeys"),isArrayLike=require("./isArrayLike");module.exports=function(object){return(isArrayLike(object)?arrayLikeKeys:baseKeys)(object)}},{"./_arrayLikeKeys":407,"./_baseKeys":437,"./isArrayLike":567}],579:[function(require,module,exports){"use strict";var arrayMap=require("./_arrayMap"),baseIteratee=require("./_baseIteratee"),baseMap=require("./_baseMap"),isArray=require("./isArray");module.exports=function(collection,iteratee){return(isArray(collection)?arrayMap:baseMap)(collection,baseIteratee(iteratee,3))}},{"./_arrayMap":408,"./_baseIteratee":436,"./_baseMap":439,"./isArray":566}],580:[function(require,module,exports){"use strict";var MapCache=require("./_MapCache"),FUNC_ERROR_TEXT="Expected a function";function memoize(func,resolver){if("function"!=typeof func||null!=resolver&&"function"!=typeof resolver)throw new TypeError(FUNC_ERROR_TEXT);function memoized(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key))return cache.get(key);var result=func.apply(this,args);return memoized.cache=cache.set(key,result)||cache,result}return memoized.cache=new(memoize.Cache||MapCache),memoized}memoize.Cache=MapCache,module.exports=memoize},{"./_MapCache":393}],581:[function(require,module,exports){"use strict";module.exports=function(){}},{}],582:[function(require,module,exports){"use strict";var root=require("./_root");module.exports=function(){return root.Date.now()}},{"./_root":533}],583:[function(require,module,exports){"use strict";var baseProperty=require("./_baseProperty"),basePropertyDeep=require("./_basePropertyDeep"),isKey=require("./_isKey"),toKey=require("./_toKey");module.exports=function(path){return isKey(path)?baseProperty(toKey(path)):basePropertyDeep(path)}},{"./_baseProperty":442,"./_basePropertyDeep":443,"./_isKey":503,"./_toKey":548}],584:[function(require,module,exports){"use strict";var arrayReduce=require("./_arrayReduce"),baseEach=require("./_baseEach"),baseIteratee=require("./_baseIteratee"),baseReduce=require("./_baseReduce"),isArray=require("./isArray");module.exports=function(collection,iteratee,accumulator){var func=isArray(collection)?arrayReduce:baseReduce,initAccum=arguments.length<3;return func(collection,baseIteratee(iteratee,4),accumulator,initAccum,baseEach)}},{"./_arrayReduce":410,"./_baseEach":418,"./_baseIteratee":436,"./_baseReduce":444,"./isArray":566}],585:[function(require,module,exports){"use strict";module.exports=function(){return[]}},{}],586:[function(require,module,exports){"use strict";module.exports=function(){return!1}},{}],587:[function(require,module,exports){"use strict";var toNumber=require("./toNumber");module.exports=function(value){return value?(value=toNumber(value))!==1/0&&value!==-1/0?value==value?value:0:17976931348623157e292*(value<0?-1:1):0===value?value:0}},{"./toNumber":589}],588:[function(require,module,exports){"use strict";var toFinite=require("./toFinite");module.exports=function(value){var result=toFinite(value),remainder=result%1;return result==result?remainder?result-remainder:result:0}},{"./toFinite":587}],589:[function(require,module,exports){"use strict";var isObject=require("./isObject"),isSymbol=require("./isSymbol"),reTrim=/^\s+|\s+$/g,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;module.exports=function(value){if("number"==typeof value)return value;if(isSymbol(value))return NaN;var other;if(isObject(value)&&(other="function"==typeof value.valueOf?value.valueOf():value,value=isObject(other)?other+"":other),"string"!=typeof value)return 0===value?value:+value;value=value.replace(reTrim,"");var isBinary=reIsBinary.test(value);return isBinary||reIsOctal.test(value)?freeParseInt(value.slice(2),isBinary?2:8):reIsBadHex.test(value)?NaN:+value}},{"./isObject":573,"./isSymbol":575}],590:[function(require,module,exports){"use strict";var baseToString=require("./_baseToString");module.exports=function(value){return null==value?"":baseToString(value)}},{"./_baseToString":449}],591:[function(require,module,exports){"use strict";var arrayEach=require("./_arrayEach"),baseCreate=require("./_baseCreate"),baseForOwn=require("./_baseForOwn"),baseIteratee=require("./_baseIteratee"),getPrototype=require("./_getPrototype"),isArray=require("./isArray"),isBuffer=require("./isBuffer"),isFunction=require("./isFunction"),isObject=require("./isObject"),isTypedArray=require("./isTypedArray");module.exports=function(object,iteratee,accumulator){var Ctor,isArr=isArray(object),isArrLike=isArr||isBuffer(object)||isTypedArray(object);return iteratee=baseIteratee(iteratee,4),null==accumulator&&(Ctor=object&&object.constructor,accumulator=isArrLike?isArr?new Ctor:[]:isObject(object)&&isFunction(Ctor)?baseCreate(getPrototype(object)):{}),(isArrLike?arrayEach:baseForOwn)(object,function(value,index,object){return iteratee(accumulator,value,index,object)}),accumulator}},{"./_arrayEach":403,"./_baseCreate":416,"./_baseForOwn":423,"./_baseIteratee":436,"./_getPrototype":487,"./isArray":566,"./isBuffer":569,"./isFunction":571,"./isObject":573,"./isTypedArray":576}],592:[function(require,module,exports){"use strict";var LazyWrapper=require("./_LazyWrapper"),LodashWrapper=require("./_LodashWrapper"),baseLodash=require("./_baseLodash"),isArray=require("./isArray"),isObjectLike=require("./isObjectLike"),wrapperClone=require("./_wrapperClone"),hasOwnProperty=Object.prototype.hasOwnProperty;function lodash(value){if(isObjectLike(value)&&!isArray(value)&&!(value instanceof LazyWrapper)){if(value instanceof LodashWrapper)return value;if(hasOwnProperty.call(value,"__wrapped__"))return wrapperClone(value)}return new LodashWrapper(value)}(lodash.prototype=baseLodash.prototype).constructor=lodash,module.exports=lodash},{"./_LazyWrapper":389,"./_LodashWrapper":391,"./_baseLodash":438,"./_wrapperClone":551,"./isArray":566,"./isObjectLike":574}],593:[function(require,module,exports){"use strict";var arrayFilter=require("./_arrayFilter"),baseRest=require("./_baseRest"),baseXor=require("./_baseXor"),isArrayLikeObject=require("./isArrayLikeObject"),xor=baseRest(function(arrays){return baseXor(arrayFilter(arrays,isArrayLikeObject))});module.exports=xor},{"./_arrayFilter":404,"./_baseRest":445,"./_baseXor":452,"./isArrayLikeObject":568}],594:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var nativeToString=Object.prototype.toString,nativeHasOwnProperty=Object.prototype.hasOwnProperty;function isUndefined(obj){return void 0===obj}function isArray(obj){return"[object Array]"===nativeToString.call(obj)}function isObject(obj){return"[object Object]"===nativeToString.call(obj)}function isFunction(obj){var tag=nativeToString.call(obj);return"[object Function]"===tag||"[object AsyncFunction]"===tag||"[object GeneratorFunction]"===tag||"[object AsyncGeneratorFunction]"===tag||"[object Proxy]"===tag}function ensureArray(obj){if(!isArray(obj))throw new Error("must supply array")}function has(target,key){return nativeHasOwnProperty.call(target,key)}function find(collection,matcher){var match;return matcher=toMatcher(matcher),forEach(collection,function(val,key){if(matcher(val,key))return match=val,!1}),match}function forEach(collection,iterator){var val;if(void 0!==collection){var convertKey=isArray(collection)?toNum:identity;for(var key in collection)if(has(collection,key)&&!1===iterator(val=collection[key],convertKey(key)))return val}}function reduce(collection,iterator,result){return forEach(collection,function(value,idx){result=iterator(result,value,idx)}),result}function every(collection,matcher){return!!reduce(collection,function(matches,val,key){return matches&&matcher(val,key)},!0)}function map(collection,fn){var result=[];return forEach(collection,function(val,key){result.push(fn(val,key))}),result}function keys(collection){return collection&&Object.keys(collection)||[]}function groupBy(collection,extractor){var grouped=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return extractor=toExtractor(extractor),forEach(collection,function(val){var discriminator=extractor(val)||"_";(grouped[discriminator]||(grouped[discriminator]=[])).push(val)}),grouped}function uniqueBy(extractor){extractor=toExtractor(extractor);for(var grouped={},_len=arguments.length,collections=new Array(1<_len?_len-1:0),_key=1;_key<_len;_key++)collections[_key-1]=arguments[_key];return forEach(collections,function(c){return groupBy(c,extractor,grouped)}),map(grouped,function(val,key){return val[0]})}var unionBy=uniqueBy;function toExtractor(extractor){return isFunction(extractor)?extractor:function(e){return e[extractor]}}function toMatcher(matcher){return isFunction(matcher)?matcher:function(e){return e===matcher}}function identity(arg){return arg}function toNum(arg){return Number(arg)}function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}exports.flatten=function(arr){return Array.prototype.concat.apply([],arr)},exports.find=find,exports.findIndex=function(collection,matcher){matcher=toMatcher(matcher);var idx=isArray(collection)?-1:void 0;return forEach(collection,function(val,key){if(matcher(val,key))return idx=key,!1}),idx},exports.filter=function(collection,matcher){var result=[];return forEach(collection,function(val,key){matcher(val,key)&&result.push(val)}),result},exports.forEach=forEach,exports.without=function(arr,matcher){return void 0===arr?[]:(ensureArray(arr),matcher=toMatcher(matcher),arr.filter(function(el,idx){return!matcher(el,idx)}))},exports.reduce=reduce,exports.every=every,exports.some=function(collection,matcher){return!!find(collection,matcher)},exports.map=map,exports.keys=keys,exports.size=function(collection){return keys(collection).length},exports.values=function(collection){return map(collection,function(val){return val})},exports.groupBy=groupBy,exports.uniqueBy=uniqueBy,exports.unionBy=unionBy,exports.sortBy=function(collection,extractor){extractor=toExtractor(extractor);var sorted=[];return forEach(collection,function(value,key){for(var disc=extractor(value,key),entry={d:disc,v:value},idx=0;idx<sorted.length;idx++){if(disc<sorted[idx].d)return void sorted.splice(idx,0,entry)}sorted.push(entry)}),map(sorted,function(e){return e.v})},exports.matchPattern=function(pattern){return function(el){return every(pattern,function(val,key){return el[key]===val})}},exports.debounce=function(fn,timeout){var timer,lastArgs,lastThis,lastNow;function fire(){var now=Date.now(),scheduledDiff=lastNow+timeout-now;if(0<scheduledDiff)return schedule(scheduledDiff);fn.apply(lastThis,lastArgs),timer=lastNow=lastArgs=lastThis=void 0}function schedule(timeout){timer=setTimeout(fire,timeout)}return function(){lastNow=Date.now();for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];lastArgs=args,lastThis=this,timer||schedule(timeout)}},exports.throttle=function(fn,interval){var throttling=!1;return function(){throttling||(fn.apply(void 0,arguments),throttling=!0,setTimeout(function(){throttling=!1},interval))}},exports.bind=function(fn,target){return fn.bind(target)},exports.isUndefined=isUndefined,exports.isDefined=function(obj){return void 0!==obj},exports.isNil=function(obj){return null==obj},exports.isArray=isArray,exports.isObject=isObject,exports.isNumber=function(obj){return"[object Number]"===nativeToString.call(obj)},exports.isFunction=isFunction,exports.isString=function(obj){return"[object String]"===nativeToString.call(obj)},exports.ensureArray=ensureArray,exports.has=has,exports.assign=function(target){for(var _len=arguments.length,others=new Array(1<_len?_len-1:0),_key=1;_key<_len;_key++)others[_key-1]=arguments[_key];return _extends.apply(void 0,[target].concat(others))},exports.pick=function(target,properties){var result={},obj=Object(target);return forEach(properties,function(prop){prop in obj&&(result[prop]=target[prop])}),result},exports.omit=function(target,properties){var result={};return forEach(Object(target),function(prop,key){-1===properties.indexOf(key)&&(result[key]=prop)}),result},exports.merge=function merge(target){for(var _len2=arguments.length,sources=new Array(1<_len2?_len2-1:0),_key2=1;_key2<_len2;_key2++)sources[_key2-1]=arguments[_key2];return sources.length&&forEach(sources,function(source){source&&isObject(source)&&forEach(source,function(sourceVal,key){var targetVal;"__proto__"!==key&&(targetVal=target[key],isObject(sourceVal)?(isObject(targetVal)||(targetVal={}),target[key]=merge(targetVal,sourceVal)):target[key]=sourceVal)})}),target}},{}],595:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var indexOf=[].indexOf,indexof=function(arr,obj){if(indexOf)return arr.indexOf(obj);for(var i=0;i<arr.length;++i)if(arr[i]===obj)return i;return-1},re=/\s+/,toString=Object.prototype.toString;function ClassList(el){if(!el||!el.nodeType)throw new Error("A DOM element reference is required");this.el=el,this.list=el.classList}ClassList.prototype.add=function(name){if(this.list)return this.list.add(name),this;var arr=this.array();return~indexof(arr,name)||arr.push(name),this.el.className=arr.join(" "),this},ClassList.prototype.remove=function(name){if("[object RegExp]"==toString.call(name))return this.removeMatching(name);if(this.list)return this.list.remove(name),this;var arr=this.array(),i=indexof(arr,name);return~i&&arr.splice(i,1),this.el.className=arr.join(" "),this},ClassList.prototype.removeMatching=function(re){for(var arr=this.array(),i=0;i<arr.length;i++)re.test(arr[i])&&this.remove(arr[i]);return this},ClassList.prototype.toggle=function(name,force){return this.list?void 0!==force&&force===this.list.toggle(name,force)||this.list.toggle(name):void 0!==force?force?this.add(name):this.remove(name):this.has(name)?this.remove(name):this.add(name),this},ClassList.prototype.array=function(){var arr=(this.el.getAttribute("class")||"").replace(/^\s+|\s+$/g,"").split(re);return""===arr[0]&&arr.shift(),arr},ClassList.prototype.has=ClassList.prototype.contains=function(name){return this.list?this.list.contains(name):!!~indexof(this.array(),name)};var proto="undefined"!=typeof Element?Element.prototype:{},vendor=proto.matches||proto.matchesSelector||proto.webkitMatchesSelector||proto.mozMatchesSelector||proto.msMatchesSelector||proto.oMatchesSelector,matchesSelector=function(el,selector){if(!el||1!==el.nodeType)return!1;if(vendor)return vendor.call(el,selector);for(var nodes=el.parentNode.querySelectorAll(selector),i=0;i<nodes.length;i++)if(nodes[i]==el)return!0;return!1};var proto$1=Element.prototype,vendor$1=proto$1.matchesSelector||proto$1.webkitMatchesSelector||proto$1.mozMatchesSelector||proto$1.msMatchesSelector||proto$1.oMatchesSelector,matchesSelector$1=function(el,selector){if(vendor$1)return vendor$1.call(el,selector);for(var nodes=el.parentNode.querySelectorAll(selector),i=0;i<nodes.length;++i)if(nodes[i]==el)return!0;return!1};function domify(html,doc){if("string"!=typeof html)throw new TypeError("String expected");doc=doc||document;var m=/<([\w:]+)/.exec(html);if(!m)return doc.createTextNode(html);html=html.replace(/^\s+|\s+$/g,"");var tag=m[1];if("body"==tag){return(el=doc.createElement("html")).innerHTML=html,el.removeChild(el.lastChild)}var el,wrap=map[tag]||map._default,depth=wrap[0],prefix=wrap[1],suffix=wrap[2];for((el=doc.createElement("div")).innerHTML=prefix+html+suffix;depth--;)el=el.lastChild;if(el.firstChild==el.lastChild)return el.removeChild(el.firstChild);for(var fragment=doc.createDocumentFragment();el.firstChild;)fragment.appendChild(el.removeChild(el.firstChild));return fragment}var bugTestDiv,bind=window.addEventListener?"addEventListener":"attachEvent",unbind=window.removeEventListener?"removeEventListener":"detachEvent",prefix="addEventListener"!=bind?"on":"",componentEvent={bind:function(el,type,fn,capture){return el[bind](prefix+type,fn,capture||!1),fn},unbind:function(el,type,fn,capture){return el[unbind](prefix+type,fn,capture||!1),fn}},forceCaptureEvents=["focus","blur"],delegateEvents={bind:function(el,selector,type,fn,capture){return-1!==forceCaptureEvents.indexOf(type)&&(capture=!0),componentEvent.bind(el,type,function(e){var target=e.target||e.srcElement;e.delegateTarget=function(element,selector,checkYoSelf){for(var parent=checkYoSelf?element:element.parentNode;parent&&parent!==document;){if(matchesSelector$1(parent,selector))return parent;parent=parent.parentNode}}(target,selector,!0),e.delegateTarget&&fn.call(el,e)},capture)},unbind:function(el,type,fn,capture){-1!==forceCaptureEvents.indexOf(type)&&(capture=!0),componentEvent.unbind(el,type,fn,capture)}},innerHTMLBug=!1;"undefined"!=typeof document&&((bugTestDiv=document.createElement("div")).innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',innerHTMLBug=!bugTestDiv.getElementsByTagName("link").length,bugTestDiv=void 0);var map={legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:innerHTMLBug?[1,"X<div>","</div>"]:[0,"",""]};map.td=map.th=[3,"<table><tbody><tr>","</tr></tbody></table>"],map.option=map.optgroup=[1,'<select multiple="multiple">',"</select>"],map.thead=map.tbody=map.colgroup=map.caption=map.tfoot=[1,"<table>","</table>"],map.polyline=map.ellipse=map.polygon=map.circle=map.text=map.line=map.path=map.rect=map.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"],exports.attr=function(el,name,val){return 2==arguments.length?el.getAttribute(name):null===val?el.removeAttribute(name):(el.setAttribute(name,val),el)},exports.classes=function(el){return new ClassList(el)},exports.clear=function(el){for(var c;el.childNodes.length;)c=el.childNodes[0],el.removeChild(c);return el},exports.closest=function(element,selector,checkYourSelf){for(var currentElem=checkYourSelf?element:element.parentNode;currentElem&&currentElem.nodeType!==document.DOCUMENT_NODE&&currentElem.nodeType!==document.DOCUMENT_FRAGMENT_NODE;){if(matchesSelector(currentElem,selector))return currentElem;currentElem=currentElem.parentNode}return matchesSelector(currentElem,selector)?currentElem:null},exports.delegate=delegateEvents,exports.domify=domify,exports.event=componentEvent,exports.matches=matchesSelector,exports.query=function(selector,el){return(el=el||document).querySelector(selector)},exports.queryAll=function(selector,el){return(el=el||document).querySelectorAll(selector)},exports.remove=function(el){el.parentNode&&el.parentNode.removeChild(el)}},{}],596:[function(require,module,exports){"use strict";module.exports=function(n){return n=n||Object.create(null),{on:function(c,e){(n[c]||(n[c]=[])).push(e)},off:function(c,e){n[c]&&n[c].splice(n[c].indexOf(e)>>>0,1)},emit:function(c,e){(n[c]||[]).slice().map(function(n){n(e)}),(n["*"]||[]).slice().map(function(n){n(c,e)})}}}},{}],597:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var minDash=require("min-dash"),saxen=require("saxen"),moddle=require("moddle");function hasLowerCaseAlias(pkg){return pkg.xml&&"lowerCase"===pkg.xml.tagAlias}var DEFAULT_NS_MAP={xsi:"http://www.w3.org/2001/XMLSchema-instance",xml:"http://www.w3.org/XML/1998/namespace"};function serializeFormat(element){return element.xml&&element.xml.serialize}function serializeAsType(element){return"xsi:type"===serializeFormat(element)}function aliasToName(aliasNs,pkg){return hasLowerCaseAlias(pkg)?aliasNs.prefix+":"+((str=aliasNs.localName).charAt(0).toUpperCase()+str.slice(1)):aliasNs.name;var str}function normalizeXsiTypeName(name,model){var nameNs=moddle.parseNameNS(name);return function(nameNs,pkg){var name=nameNs.name,localName=nameNs.localName,typePrefix=pkg.xml&&pkg.xml.typePrefix;return typePrefix&&0===localName.indexOf(typePrefix)?nameNs.prefix+":"+localName.slice(typePrefix.length):name}(nameNs,model.getPackage(nameNs.prefix))}function error(message){return new Error(message)}function Context(options){minDash.assign(this,options),this.elementsById={},this.references=[],this.warnings=[],this.addReference=function(reference){this.references.push(reference)},this.addElement=function(element){if(!element)throw error("expected element");var id,elementsById=this.elementsById,idProperty=element.$descriptor.idProperty;if(idProperty&&(id=element.get(idProperty.name))){if(!/^([a-z][\w-.]*:)?[a-z_][\w-.]*$/i.test(id))throw new Error("illegal ID <"+id+">");if(elementsById[id])throw error("duplicate ID <"+id+">");elementsById[id]=element}},this.addWarning=function(warning){this.warnings.push(warning)}}function BaseHandler(){}function NoopHandler(){}function BodyHandler(){}function ReferenceHandler(property,context){this.property=property,this.context=context}function ValueHandler(propertyDesc,element){this.element=element,this.propertyDesc=propertyDesc}function BaseElementHandler(){}function ElementHandler(model,typeName,context){this.model=model,this.type=model.getType(typeName),this.context=context}function RootElementHandler(model,typeName,context){ElementHandler.call(this,model,typeName,context)}function GenericElementHandler(model,typeName,context){this.model=model,this.context=context}function Reader(options){options instanceof moddle.Moddle&&(options={model:options}),minDash.assign(this,{lax:!1},options)}BaseHandler.prototype.handleEnd=function(){},BaseHandler.prototype.handleText=function(){},BaseHandler.prototype.handleNode=function(){},(NoopHandler.prototype=Object.create(BaseHandler.prototype)).handleNode=function(){return this},(BodyHandler.prototype=Object.create(BaseHandler.prototype)).handleText=function(text){this.body=(this.body||"")+text},(ReferenceHandler.prototype=Object.create(BodyHandler.prototype)).handleNode=function(node){if(this.element)throw error("expected no sub nodes");return this.element=this.createReference(node),this},ReferenceHandler.prototype.handleEnd=function(){this.element.id=this.body},ReferenceHandler.prototype.createReference=function(node){return{property:this.property.ns.name,id:""}},(ValueHandler.prototype=Object.create(BodyHandler.prototype)).handleEnd=function(){var value=this.body||"",element=this.element,propertyDesc=this.propertyDesc,value=moddle.coerceType(propertyDesc.type,value);propertyDesc.isMany?element.get(propertyDesc.name).push(value):element.set(propertyDesc.name,value)},(BaseElementHandler.prototype=Object.create(BodyHandler.prototype)).handleNode=function(node){var parser=this,element=this.element;return element?parser=this.handleChild(node):(element=this.element=this.createElement(node),this.context.addElement(element)),parser},(ElementHandler.prototype=Object.create(BaseElementHandler.prototype)).addReference=function(reference){this.context.addReference(reference)},ElementHandler.prototype.handleText=function(text){if(!this.element.$descriptor.bodyProperty)throw error("unexpected body text <"+text+">");BodyHandler.prototype.handleText.call(this,text)},ElementHandler.prototype.handleEnd=function(){var value=this.body,element=this.element,bodyProperty=element.$descriptor.bodyProperty;bodyProperty&&void 0!==value&&(value=moddle.coerceType(bodyProperty.type,value),element.set(bodyProperty.name,value))},ElementHandler.prototype.createElement=function(node){var propNameNs,attributes=node.attributes,Type=this.type,descriptor=Type.$descriptor,context=this.context,instance=new Type({}),model=this.model;return minDash.forEach(attributes,function(value,name){var values,prop=descriptor.propertiesByName[name];prop&&prop.isReference?prop.isMany?(values=value.split(" "),minDash.forEach(values,function(v){context.addReference({element:instance,property:prop.ns.name,id:v})})):context.addReference({element:instance,property:prop.ns.name,id:value}):(prop?value=moddle.coerceType(prop.type,value):"xmlns"!==name&&(propNameNs=moddle.parseNameNS(name,descriptor.ns.prefix),model.getPackage(propNameNs.prefix)&&context.addWarning({message:"unknown attribute <"+name+">",element:instance,property:name,value:value})),instance.set(name,value))}),instance},ElementHandler.prototype.getPropertyForNode=function(node){var elementTypeName,elementType,name=node.name,nameNs=moddle.parseNameNS(name),type=this.type,model=this.model,descriptor=type.$descriptor,propertyName=nameNs.name,property=descriptor.propertiesByName[propertyName];if(property&&!property.isAttr)return serializeAsType(property)&&(elementTypeName=node.attributes["xsi:type"])?(elementTypeName=normalizeXsiTypeName(elementTypeName,model),elementType=model.getType(elementTypeName),minDash.assign({},property,{effectiveType:elementType.$descriptor.name})):property;var pkg=model.getPackage(nameNs.prefix);if(pkg){if(elementTypeName=aliasToName(nameNs,pkg),elementType=model.getType(elementTypeName),property=minDash.find(descriptor.properties,function(p){return!p.isVirtual&&!p.isReference&&!p.isAttribute&&elementType.hasType(p.type)}))return minDash.assign({},property,{effectiveType:elementType.$descriptor.name})}else if(property=minDash.find(descriptor.properties,function(p){return!p.isReference&&!p.isAttribute&&"Element"===p.type}))return property;throw error("unrecognized element <"+nameNs.name+">")},ElementHandler.prototype.toString=function(){return"ElementDescriptor["+this.type.$descriptor.name+"]"},ElementHandler.prototype.valueHandler=function(propertyDesc,element){return new ValueHandler(propertyDesc,element)},ElementHandler.prototype.referenceHandler=function(propertyDesc){return new ReferenceHandler(propertyDesc,this.context)},ElementHandler.prototype.handler=function(type){return new("Element"===type?GenericElementHandler:ElementHandler)(this.model,type,this.context)},ElementHandler.prototype.handleChild=function(node){var childHandler,propertyDesc=this.getPropertyForNode(node),element=this.element,type=propertyDesc.effectiveType||propertyDesc.type;if(moddle.isSimpleType(type))return this.valueHandler(propertyDesc,element);var newElement=(childHandler=propertyDesc.isReference?this.referenceHandler(propertyDesc).handleNode(node):this.handler(type).handleNode(node)).element;return void 0!==newElement&&(propertyDesc.isMany?element.get(propertyDesc.name).push(newElement):element.set(propertyDesc.name,newElement),propertyDesc.isReference?(minDash.assign(newElement,{element:element}),this.context.addReference(newElement)):newElement.$parent=element),childHandler},(RootElementHandler.prototype=Object.create(ElementHandler.prototype)).createElement=function(node){var name=node.name,nameNs=moddle.parseNameNS(name),model=this.model,type=this.type,pkg=model.getPackage(nameNs.prefix),typeName=pkg&&aliasToName(nameNs,pkg)||name;if(!type.hasType(typeName))throw error("unexpected element <"+node.originalName+">");return ElementHandler.prototype.createElement.call(this,node)},(GenericElementHandler.prototype=Object.create(BaseElementHandler.prototype)).createElement=function(node){var name=node.name,prefix=moddle.parseNameNS(name).prefix,uri=node.ns[prefix+"$uri"],attributes=node.attributes;return this.model.createAny(name,uri,attributes)},GenericElementHandler.prototype.handleChild=function(node){var handler=new GenericElementHandler(this.model,0,this.context).handleNode(node),element=this.element,newElement=handler.element;return void 0!==newElement&&((element.$children=element.$children||[]).push(newElement),newElement.$parent=element),handler},GenericElementHandler.prototype.handleEnd=function(){this.body&&(this.element.$body=this.body)},Reader.prototype.fromXML=function(xml,options,done){var rootHandler=options.rootHandler;options instanceof ElementHandler?(rootHandler=options,options={}):"string"==typeof options?(rootHandler=this.handler(options),options={}):"string"==typeof rootHandler&&(rootHandler=this.handler(rootHandler));var model=this.model,lax=this.lax,context=new Context(minDash.assign({},options,{rootHandler:rootHandler})),parser=new saxen.Parser({proxy:!0}),stack=function(){var stack=[];return Object.defineProperty(stack,"peek",{value:function(){return this[this.length-1]}}),stack}();function handleError(err,getContext,lax){var ctx=getContext(),line=ctx.line,column=ctx.column,data=ctx.data;"<"===data.charAt(0)&&-1!==data.indexOf(" ")&&(data=data.slice(0,data.indexOf(" "))+">");var message="unparsable content "+(data?data+" ":"")+"detected\n\tline: "+line+"\n\tcolumn: "+column+"\n\tnested error: "+err.message;if(lax)return context.addWarning({message:message,error:err}),!0;throw error(message)}function handleWarning(err,getContext){return handleError(err,getContext,!0)}rootHandler.context=context,stack.push(rootHandler);var PREAMBLE_START_PATTERN=/^<\?xml /i,ENCODING_PATTERN=/ encoding="([^"]+)"/i,UTF_8_PATTERN=/^utf-8$/i;function handleCData(text,getContext){try{stack.peek().handleText(text)}catch(err){handleWarning(err,getContext)}}var uriMap=model.getPackages().reduce(function(uriMap,p){return uriMap[p.uri]=p.prefix,uriMap},{"http://www.w3.org/XML/1998/namespace":"xml"});return parser.ns(uriMap).on("openTag",function(obj,decodeStr,selfClosing,getContext){var attrs=obj.attrs||{},decodedAttrs=Object.keys(attrs).reduce(function(d,key){var value=decodeStr(attrs[key]);return d[key]=value,d},{});!function(node,getContext){var handler=stack.peek();try{stack.push(handler.handleNode(node))}catch(err){handleError(err,getContext,lax)&&stack.push(new NoopHandler)}}({name:obj.name,originalName:obj.originalName,attributes:decodedAttrs,ns:obj.ns},getContext)}).on("question",function(question){var match,encoding;!PREAMBLE_START_PATTERN.test(question)||(encoding=(match=ENCODING_PATTERN.exec(question))&&match[1])&&!UTF_8_PATTERN.test(encoding)&&context.addWarning({message:"unsupported document encoding <"+encoding+">, falling back to UTF-8"})}).on("closeTag",function(){stack.pop().handleEnd()}).on("cdata",handleCData).on("text",function(text,decodeEntities,getContext){!function(text,getContext){(text=text.trim())&&handleCData(text,getContext)}(decodeEntities(text),getContext)}).on("error",handleError).on("warn",handleWarning),new Promise(function(resolve,reject){var err;try{parser.parse(xml),function(){for(var r,elementsById=context.elementsById,references=context.references,i=0;r=references[i];i++){var collection,idx,element=r.element,reference=elementsById[r.id],property=element.$descriptor.propertiesByName[r.property];reference||context.addWarning({message:"unresolved reference <"+r.id+">",element:r.element,property:r.property,value:r.id}),property.isMany?(-1===(idx=(collection=element.get(property.name)).indexOf(r))&&(idx=collection.length),reference?collection[idx]=reference:collection.splice(idx,1)):element.set(property.name,reference)}}()}catch(e){err=e}var rootElement=rootHandler.element;err||rootElement||(err=error("failed to parse document as <"+rootHandler.type.$descriptor.name+">"));var warnings=context.warnings,references=context.references,elementsById=context.elementsById;return err?(err.warnings=warnings,reject(err)):resolve({rootElement:rootElement,elementsById:elementsById,references:references,warnings:warnings})})},Reader.prototype.handler=function(name){return new RootElementHandler(this.model,name)};var ESCAPE_ATTR_CHARS=/<|>|'|"|&|\n\r|\n/g,ESCAPE_CHARS=/<|>|&/g;function Namespaces(parent){var prefixMap={},uriMap={},used={},wellknown=[],custom=[];this.byUri=function(uri){return uriMap[uri]||parent&&parent.byUri(uri)},this.add=function(ns,isWellknown){uriMap[ns.uri]=ns,isWellknown?wellknown.push(ns):custom.push(ns),this.mapPrefix(ns.prefix,ns.uri)},this.uriByPrefix=function(prefix){return prefixMap[prefix||"xmlns"]},this.mapPrefix=function(prefix,uri){prefixMap[prefix||"xmlns"]=uri},this.getNSKey=function(ns){return void 0!==ns.prefix?ns.uri+"|"+ns.prefix:ns.uri},this.logUsed=function(ns){var uri=ns.uri,nsKey=this.getNSKey(ns);used[nsKey]=this.byUri(uri),parent&&parent.logUsed(ns)},this.getUsed=function(ns){var self=this;return[].concat(wellknown,custom).filter(function(ns){var nsKey=self.getNSKey(ns);return used[nsKey]})}}function inherits(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}function nsName(ns){return minDash.isString(ns)?ns:(ns.prefix?ns.prefix+":":"")+ns.localName}function getElementNs(ns,descriptor){return descriptor.isGeneric?minDash.assign({localName:descriptor.ns.localName},ns):minDash.assign({localName:(name=descriptor.ns.localName,hasLowerCaseAlias(descriptor.$pkg)?(string=name).charAt(0).toLowerCase()+string.slice(1):name)},ns);var name,string}var ESCAPE_ATTR_MAP={"\n":"#10","\n\r":"#10",'"':"#34","'":"#39","<":"#60",">":"#62","&":"#38"},ESCAPE_MAP={"<":"lt",">":"gt","&":"amp"};function escape(str,charPattern,replaceMap){return(str=minDash.isString(str)?str:""+str).replace(charPattern,function(s){return"&"+replaceMap[s]+";"})}function ReferenceSerializer(tagName){this.tagName=tagName}function BodySerializer(){}function ValueSerializer(tagName){this.tagName=tagName}function ElementSerializer(parent,propertyDescriptor){this.body=[],this.attrs=[],this.parent=parent,this.propertyDescriptor=propertyDescriptor}function TypeSerializer(parent,propertyDescriptor){ElementSerializer.call(this,parent,propertyDescriptor)}function SavingWriter(){this.value="",this.write=function(str){this.value+=str}}function FormatingWriter(out,format){var indent=[""];this.append=function(str){return out.write(str),this},this.appendNewLine=function(){return format&&out.write("\n"),this},this.appendIndent=function(){return format&&out.write(indent.join("  ")),this},this.indent=function(){return indent.push(""),this},this.unindent=function(){return indent.pop(),this}}ReferenceSerializer.prototype.build=function(element){return this.element=element,this},ReferenceSerializer.prototype.serializeTo=function(writer){writer.appendIndent().append("<"+this.tagName+">"+this.element.id+"</"+this.tagName+">").appendNewLine()},BodySerializer.prototype.serializeValue=BodySerializer.prototype.serializeTo=function(writer){writer.append(this.escape?escape(this.value,ESCAPE_CHARS,ESCAPE_MAP):this.value)},BodySerializer.prototype.build=function(prop,value){return this.value=value,"String"===prop.type&&-1!==value.search(ESCAPE_CHARS)&&(this.escape=!0),this},inherits(ValueSerializer,BodySerializer),ValueSerializer.prototype.serializeTo=function(writer){writer.appendIndent().append("<"+this.tagName+">"),this.serializeValue(writer),writer.append("</"+this.tagName+">").appendNewLine()},ElementSerializer.prototype.build=function(element){var properties,props,elementDescriptor=(this.element=element).$descriptor,propertyDescriptor=this.propertyDescriptor,isGeneric=elementDescriptor.isGeneric,otherAttrs=isGeneric?this.parseGeneric(element):this.parseNsAttributes(element);return this.ns=propertyDescriptor?this.nsPropertyTagName(propertyDescriptor):this.nsTagName(elementDescriptor),this.tagName=this.addTagName(this.ns),isGeneric||(properties=function(element){var descriptor=element.$descriptor;return minDash.filter(descriptor.properties,function(p){var name=p.name;if(p.isVirtual)return!1;if(!element.hasOwnProperty(name))return!1;var value=element[name];return value!==p.default&&(null!==value&&(!p.isMany||value.length))})}(element),this.parseAttributes((props=properties,minDash.filter(props,function(p){return p.isAttr}))),this.parseContainments(function(props){return minDash.filter(props,function(p){return!p.isAttr})}(properties))),this.parseGenericAttributes(element,otherAttrs),this},ElementSerializer.prototype.nsTagName=function(descriptor){return getElementNs(this.logNamespaceUsed(descriptor.ns),descriptor)},ElementSerializer.prototype.nsPropertyTagName=function(descriptor){return function(ns,descriptor){return minDash.assign({localName:descriptor.ns.localName},ns)}(this.logNamespaceUsed(descriptor.ns),descriptor)},ElementSerializer.prototype.isLocalNs=function(ns){return ns.uri===this.ns.uri},ElementSerializer.prototype.nsAttributeName=function(element){var ns=minDash.isString(element)?moddle.parseNameNS(element):element.ns;if(element.inherited)return{localName:ns.localName};var effectiveNs=this.logNamespaceUsed(ns);return this.getNamespaces().logUsed(effectiveNs),this.isLocalNs(effectiveNs)?{localName:ns.localName}:minDash.assign({localName:ns.localName},effectiveNs)},ElementSerializer.prototype.parseGeneric=function(element){var self=this,body=this.body,attributes=[];return minDash.forEach(element,function(val,key){"$body"===key?body.push((new BodySerializer).build({type:"String"},val)):"$children"===key?minDash.forEach(val,function(child){body.push(new ElementSerializer(self).build(child))}):0!==key.indexOf("$")&&self.parseNsAttribute(element,key,val)&&attributes.push({name:key,value:val})}),attributes},ElementSerializer.prototype.parseNsAttribute=function(element,name,value){var ns,actualNs,model=element.$model,nameNs=moddle.parseNameNS(name);if("xmlns"===nameNs.prefix&&(ns={prefix:nameNs.localName,uri:value}),nameNs.prefix||"xmlns"!==nameNs.localName||(ns={uri:value}),!ns)return{name:name,value:value};model&&model.getPackage(value)?this.logNamespace(ns,!0,!0):(actualNs=this.logNamespaceUsed(ns,!0),this.getNamespaces().logUsed(actualNs))},ElementSerializer.prototype.parseNsAttributes=function(element,attrs){var self=this,genericAttrs=element.$attrs,attributes=[];return minDash.forEach(genericAttrs,function(value,name){var nonNsAttr=self.parseNsAttribute(element,name,value);nonNsAttr&&attributes.push(nonNsAttr)}),attributes},ElementSerializer.prototype.parseGenericAttributes=function(element,attributes){var self=this;minDash.forEach(attributes,function(attr){if("xsi:type"!==attr.name)try{self.addAttribute(self.nsAttributeName(attr.name),attr.value)}catch(e){console.warn("missing namespace information for ",attr.name,"=",attr.value,"on",element,e)}})},ElementSerializer.prototype.parseContainments=function(properties){var self=this,body=this.body,element=this.element;minDash.forEach(properties,function(p){var asType,asProperty,value=element.get(p.name),isReference=p.isReference;p.isMany||(value=[value]),p.isBody?body.push((new BodySerializer).build(p,value[0])):moddle.isSimpleType(p.type)?minDash.forEach(value,function(v){body.push(new ValueSerializer(self.addTagName(self.nsPropertyTagName(p))).build(p,v))}):isReference?minDash.forEach(value,function(v){body.push(new ReferenceSerializer(self.addTagName(self.nsPropertyTagName(p))).build(v))}):(asType=serializeAsType(p),asProperty=function(element){return"property"===serializeFormat(element)}(p),minDash.forEach(value,function(v){var serializer=asType?new TypeSerializer(self,p):asProperty?new ElementSerializer(self,p):new ElementSerializer(self);body.push(serializer.build(v))}))})},ElementSerializer.prototype.getNamespaces=function(local){var parentNamespaces,namespaces=this.namespaces,parent=this.parent;return namespaces||(parentNamespaces=parent&&parent.getNamespaces(),local||!parentNamespaces?this.namespaces=namespaces=new Namespaces(parentNamespaces):namespaces=parentNamespaces),namespaces},ElementSerializer.prototype.logNamespace=function(ns,wellknown,local){var namespaces=this.getNamespaces(local),nsUri=ns.uri,nsPrefix=ns.prefix,existing=namespaces.byUri(nsUri);return"xml"===nsPrefix||existing&&!local||namespaces.add(ns,wellknown),namespaces.mapPrefix(nsPrefix,nsUri),ns},ElementSerializer.prototype.logNamespaceUsed=function(ns,local){var newPrefix,idx,wellknownUri,model=this.element.$model,namespaces=this.getNamespaces(local),prefix=ns.prefix,uri=ns.uri;if(!prefix&&!uri)return{localName:ns.localName};if(wellknownUri=DEFAULT_NS_MAP[prefix]||model&&(model.getPackage(prefix)||{}).uri,!(uri=uri||wellknownUri||namespaces.uriByPrefix(prefix)))throw new Error("no namespace uri given for prefix <"+prefix+">");if(!(ns=namespaces.byUri(uri))){for(newPrefix=prefix,idx=1;namespaces.uriByPrefix(newPrefix);)newPrefix=prefix+"_"+idx++;ns=this.logNamespace({prefix:newPrefix,uri:uri},wellknownUri===uri)}return prefix&&namespaces.mapPrefix(prefix,uri),ns},ElementSerializer.prototype.parseAttributes=function(properties){var self=this,element=this.element;minDash.forEach(properties,function(p){var values,value=element.get(p.name);p.isReference&&(value=p.isMany?(values=[],minDash.forEach(value,function(v){values.push(v.id)}),values.join(" ")):value.id),self.addAttribute(self.nsAttributeName(p),value)})},ElementSerializer.prototype.addTagName=function(nsTagName){var actualNs=this.logNamespaceUsed(nsTagName);return this.getNamespaces().logUsed(actualNs),nsName(nsTagName)},ElementSerializer.prototype.addAttribute=function(name,value){var attrs=this.attrs;minDash.isString(value)&&(value=escape(value,ESCAPE_ATTR_CHARS,ESCAPE_ATTR_MAP)),attrs.push({name:name,value:value})},ElementSerializer.prototype.serializeAttributes=function(writer){var attrs=this.attrs,namespaces=this.namespaces;namespaces&&(attrs=function(namespaces){return minDash.map(namespaces.getUsed(),function(ns){return{name:"xmlns"+(ns.prefix?":"+ns.prefix:""),value:ns.uri}})}(namespaces).concat(attrs)),minDash.forEach(attrs,function(a){writer.append(" ").append(nsName(a.name)).append('="').append(a.value).append('"')})},ElementSerializer.prototype.serializeTo=function(writer){var firstBody=this.body[0],indent=firstBody&&firstBody.constructor!==BodySerializer;writer.appendIndent().append("<"+this.tagName),this.serializeAttributes(writer),writer.append(firstBody?">":" />"),firstBody&&(indent&&writer.appendNewLine().indent(),minDash.forEach(this.body,function(b){b.serializeTo(writer)}),indent&&writer.unindent().appendIndent(),writer.append("</"+this.tagName+">")),writer.appendNewLine()},inherits(TypeSerializer,ElementSerializer),TypeSerializer.prototype.parseNsAttributes=function(element){var attributes=ElementSerializer.prototype.parseNsAttributes.call(this,element),descriptor=element.$descriptor;if(descriptor.name===this.propertyDescriptor.type)return attributes;var typeNs=this.typeNs=this.nsTagName(descriptor);this.getNamespaces().logUsed(this.typeNs);var pkg=element.$model.getPackage(typeNs.uri),typePrefix=pkg.xml&&pkg.xml.typePrefix||"";return this.addAttribute(this.nsAttributeName("xsi:type"),(typeNs.prefix?typeNs.prefix+":":"")+typePrefix+descriptor.ns.localName),attributes},TypeSerializer.prototype.isLocalNs=function(ns){return ns.uri===(this.typeNs||this.ns).uri},exports.Reader=Reader,exports.Writer=function(options){return options=minDash.assign({format:!1,preamble:!0},options||{}),{toXML:function(tree,writer){var internalWriter=writer||new SavingWriter,formatingWriter=new FormatingWriter(internalWriter,options.format);if(options.preamble&&formatingWriter.append('<?xml version="1.0" encoding="UTF-8"?>\n'),(new ElementSerializer).build(tree).serializeTo(formatingWriter),!writer)return internalWriter.value}}}},{"min-dash":594,moddle:598,saxen:603}],598:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var minDash=require("min-dash");function Base(){}function Factory(model,properties){this.model=model,this.properties=properties}Base.prototype.get=function(name){return this.$model.properties.get(this,name)},Base.prototype.set=function(name,value){this.$model.properties.set(this,name,value)},Factory.prototype.createType=function(descriptor){var model=this.model,props=this.properties,prototype=Object.create(Base.prototype);minDash.forEach(descriptor.properties,function(p){p.isMany||void 0===p.default||(prototype[p.name]=p.default)}),props.defineModel(prototype,model),props.defineDescriptor(prototype,descriptor);var name=descriptor.ns.name;function ModdleElement(attrs){props.define(this,"$type",{value:name,enumerable:!0}),props.define(this,"$attrs",{value:{}}),props.define(this,"$parent",{writable:!0}),minDash.forEach(attrs,minDash.bind(function(val,key){this.set(key,val)},this))}return ModdleElement.prototype=prototype,ModdleElement.hasType=prototype.$instanceOf=this.model.hasType,props.defineModel(ModdleElement,model),props.defineDescriptor(ModdleElement,descriptor),ModdleElement};var BUILTINS={String:!0,Boolean:!0,Integer:!0,Real:!0,Element:!0},TYPE_CONVERTERS={String:function(s){return s},Boolean:function(s){return"true"===s},Integer:function(s){return parseInt(s,10)},Real:function(s){return parseFloat(s,10)}};function isBuiltIn(type){return!!BUILTINS[type]}function parseName(name,defaultPrefix){var localName,prefix,parts=name.split(/:/);if(1===parts.length)localName=name,prefix=defaultPrefix;else{if(2!==parts.length)throw new Error("expected <prefix:localName> or <localName>, got "+name);localName=parts[1],prefix=parts[0]}return{name:name=(prefix?prefix+":":"")+localName,prefix:prefix,localName:localName}}function DescriptorBuilder(nameNs){this.ns=nameNs,this.name=nameNs.name,this.allTypes=[],this.allTypesByName={},this.properties=[],this.propertiesByName={}}function Registry(packages,properties){this.packageMap={},this.typeMap={},this.packages=[],this.properties=properties,minDash.forEach(packages,minDash.bind(this.registerPackage,this))}function ensureAvailable(packageMap,pkg,identifierKey){var value=pkg[identifierKey];if(value in packageMap)throw new Error("package with "+identifierKey+" <"+value+"> already defined")}function Properties(model){this.model=model}function defineProperty(target,property,value){Object.defineProperty(target,property.name,{enumerable:!property.isReference,writable:!0,value:value,configurable:!0})}function Moddle(packages){this.properties=new Properties(this),this.factory=new Factory(this,this.properties),this.registry=new Registry(packages,this.properties),this.typeCache={}}DescriptorBuilder.prototype.build=function(){return minDash.pick(this,["ns","name","allTypes","allTypesByName","properties","propertiesByName","bodyProperty","idProperty"])},DescriptorBuilder.prototype.addProperty=function(p,idx,validate){"boolean"==typeof idx&&(validate=idx,idx=void 0),this.addNamedProperty(p,!1!==validate);var properties=this.properties;void 0!==idx?properties.splice(idx,0,p):properties.push(p)},DescriptorBuilder.prototype.replaceProperty=function(oldProperty,newProperty,replace){var oldNameNs=oldProperty.ns,props=this.properties,propertiesByName=this.propertiesByName,rename=oldProperty.name!==newProperty.name;if(oldProperty.isId){if(!newProperty.isId)throw new Error("property <"+newProperty.ns.name+"> must be id property to refine <"+oldProperty.ns.name+">");this.setIdProperty(newProperty,!1)}if(oldProperty.isBody){if(!newProperty.isBody)throw new Error("property <"+newProperty.ns.name+"> must be body property to refine <"+oldProperty.ns.name+">");this.setBodyProperty(newProperty,!1)}var idx=props.indexOf(oldProperty);if(-1===idx)throw new Error("property <"+oldNameNs.name+"> not found in property list");props.splice(idx,1),this.addProperty(newProperty,replace?void 0:idx,rename),propertiesByName[oldNameNs.name]=propertiesByName[oldNameNs.localName]=newProperty},DescriptorBuilder.prototype.redefineProperty=function(p,targetPropertyName,replace){var nsPrefix=p.ns.prefix,parts=targetPropertyName.split("#"),name=parseName(parts[0],nsPrefix),attrName=parseName(parts[1],name.prefix).name,redefinedProperty=this.propertiesByName[attrName];if(!redefinedProperty)throw new Error("refined property <"+attrName+"> not found");this.replaceProperty(redefinedProperty,p,replace),delete p.redefines},DescriptorBuilder.prototype.addNamedProperty=function(p,validate){var ns=p.ns,propsByName=this.propertiesByName;validate&&(this.assertNotDefined(p,ns.name),this.assertNotDefined(p,ns.localName)),propsByName[ns.name]=propsByName[ns.localName]=p},DescriptorBuilder.prototype.removeNamedProperty=function(p){var ns=p.ns,propsByName=this.propertiesByName;delete propsByName[ns.name],delete propsByName[ns.localName]},DescriptorBuilder.prototype.setBodyProperty=function(p,validate){if(validate&&this.bodyProperty)throw new Error("body property defined multiple times (<"+this.bodyProperty.ns.name+">, <"+p.ns.name+">)");this.bodyProperty=p},DescriptorBuilder.prototype.setIdProperty=function(p,validate){if(validate&&this.idProperty)throw new Error("id property defined multiple times (<"+this.idProperty.ns.name+">, <"+p.ns.name+">)");this.idProperty=p},DescriptorBuilder.prototype.assertNotDefined=function(p,name){var propertyName=p.name,definedProperty=this.propertiesByName[propertyName];if(definedProperty)throw new Error("property <"+propertyName+"> already defined; override of <"+definedProperty.definedBy.ns.name+"#"+definedProperty.ns.name+"> by <"+p.definedBy.ns.name+"#"+p.ns.name+"> not allowed without redefines")},DescriptorBuilder.prototype.hasProperty=function(name){return this.propertiesByName[name]},DescriptorBuilder.prototype.addTrait=function(t,inherited){var typesByName=this.allTypesByName,types=this.allTypes,typeName=t.name;typeName in typesByName||(minDash.forEach(t.properties,minDash.bind(function(p){p=minDash.assign({},p,{name:p.ns.localName,inherited:inherited}),Object.defineProperty(p,"definedBy",{value:t});var replaces=p.replaces,redefines=p.redefines;replaces||redefines?this.redefineProperty(p,replaces||redefines,replaces):(p.isBody&&this.setBodyProperty(p),p.isId&&this.setIdProperty(p),this.addProperty(p))},this)),types.push(t),typesByName[typeName]=t)},Registry.prototype.getPackage=function(uriOrPrefix){return this.packageMap[uriOrPrefix]},Registry.prototype.getPackages=function(){return this.packages},Registry.prototype.registerPackage=function(pkg){pkg=minDash.assign({},pkg);var pkgMap=this.packageMap;ensureAvailable(pkgMap,pkg,"prefix"),ensureAvailable(pkgMap,pkg,"uri"),minDash.forEach(pkg.types,minDash.bind(function(descriptor){this.registerType(descriptor,pkg)},this)),pkgMap[pkg.uri]=pkgMap[pkg.prefix]=pkg,this.packages.push(pkg)},Registry.prototype.registerType=function(type,pkg){var ns=parseName((type=minDash.assign({},type,{superClass:(type.superClass||[]).slice(),extends:(type.extends||[]).slice(),properties:(type.properties||[]).slice(),meta:minDash.assign(type.meta||{})})).name,pkg.prefix),name=ns.name,propertiesByName={};minDash.forEach(type.properties,minDash.bind(function(p){var propertyNs=parseName(p.name,ns.prefix),propertyName=propertyNs.name;isBuiltIn(p.type)||(p.type=parseName(p.type,propertyNs.prefix).name),minDash.assign(p,{ns:propertyNs,name:propertyName}),propertiesByName[propertyName]=p},this)),minDash.assign(type,{ns:ns,name:name,propertiesByName:propertiesByName}),minDash.forEach(type.extends,minDash.bind(function(extendsName){var extended=this.typeMap[extendsName];extended.traits=extended.traits||[],extended.traits.push(name)},this)),this.definePackage(type,pkg),this.typeMap[name]=type},Registry.prototype.mapTypes=function(nsName,iterator,trait){var type=isBuiltIn(nsName.name)?{name:nsName.name}:this.typeMap[nsName.name],self=this;function traverseTrait(cls){return traverseSuper(cls,!0)}function traverseSuper(cls,trait){var parentNs=parseName(cls,isBuiltIn(cls)?"":nsName.prefix);self.mapTypes(parentNs,iterator,trait)}if(!type)throw new Error("unknown type <"+nsName.name+">");minDash.forEach(type.superClass,trait?traverseTrait:traverseSuper),iterator(type,!trait),minDash.forEach(type.traits,traverseTrait)},Registry.prototype.getEffectiveDescriptor=function(name){var nsName=parseName(name),builder=new DescriptorBuilder(nsName);this.mapTypes(nsName,function(type,inherited){builder.addTrait(type,inherited)});var descriptor=builder.build();return this.definePackage(descriptor,descriptor.allTypes[descriptor.allTypes.length-1].$pkg),descriptor},Registry.prototype.definePackage=function(target,pkg){this.properties.define(target,"$pkg",{value:pkg})},Properties.prototype.set=function(target,name,value){var property=this.model.getPropertyDescriptor(target,name),propertyName=property&&property.name;void 0===value?property?delete target[propertyName]:delete target.$attrs[name]:property?propertyName in target?target[propertyName]=value:defineProperty(target,property,value):target.$attrs[name]=value},Properties.prototype.get=function(target,name){var property=this.model.getPropertyDescriptor(target,name);if(!property)return target.$attrs[name];var propertyName=property.name;return!target[propertyName]&&property.isMany&&defineProperty(target,property,[]),target[propertyName]},Properties.prototype.define=function(target,name,options){Object.defineProperty(target,name,options)},Properties.prototype.defineDescriptor=function(target,descriptor){this.define(target,"$descriptor",{value:descriptor})},Properties.prototype.defineModel=function(target,model){this.define(target,"$model",{value:model})},Moddle.prototype.create=function(descriptor,attrs){var Type=this.getType(descriptor);if(!Type)throw new Error("unknown type <"+descriptor+">");return new Type(attrs)},Moddle.prototype.getType=function(descriptor){var cache=this.typeCache,name=minDash.isString(descriptor)?descriptor:descriptor.ns.name,type=cache[name];return type||(descriptor=this.registry.getEffectiveDescriptor(name),type=cache[name]=this.factory.createType(descriptor)),type},Moddle.prototype.createAny=function(name,nsUri,properties){var nameNs=parseName(name),element={$type:name,$instanceOf:function(type){return type===this.$type}},descriptor={name:name,isGeneric:!0,ns:{prefix:nameNs.prefix,localName:nameNs.localName,uri:nsUri}};return this.properties.defineDescriptor(element,descriptor),this.properties.defineModel(element,this),this.properties.define(element,"$parent",{enumerable:!1,writable:!0}),minDash.forEach(properties,function(a,key){minDash.isObject(a)&&void 0!==a.value?element[a.name]=a.value:element[key]=a}),element},Moddle.prototype.getPackage=function(uriOrPrefix){return this.registry.getPackage(uriOrPrefix)},Moddle.prototype.getPackages=function(){return this.registry.getPackages()},Moddle.prototype.getElementDescriptor=function(element){return element.$descriptor},Moddle.prototype.hasType=function(element,type){return void 0===type&&(type=element,element=this),type in element.$model.getElementDescriptor(element).allTypesByName},Moddle.prototype.getPropertyDescriptor=function(element,property){return this.getElementDescriptor(element).propertiesByName[property]},Moddle.prototype.getTypeDescriptor=function(type){return this.registry.typeMap[type]},exports.Moddle=Moddle,exports.coerceType=function(type,value){var converter=TYPE_CONVERTERS[type];return converter?converter(value):value},exports.isBuiltInType=isBuiltIn,exports.isSimpleType=function(type){return!!TYPE_CONVERTERS[type]},exports.parseNameNS=parseName},{"min-dash":594}],599:[function(require,module,exports){"use strict";module.exports=require("./lib/refs"),module.exports.Collection=require("./lib/collection")},{"./lib/collection":600,"./lib/refs":601}],600:[function(require,module,exports){"use strict";module.exports.extend=function(collection,refs,property,target){var inverseProperty=property.inverse;return Object.defineProperty(collection,"remove",{value:function(element){var idx=this.indexOf(element);return-1!==idx&&(this.splice(idx,1),refs.unset(element,inverseProperty,target)),element}}),Object.defineProperty(collection,"contains",{value:function(element){return-1!==this.indexOf(element)}}),Object.defineProperty(collection,"add",{value:function(element,idx){var currentIdx=this.indexOf(element);if(void 0===idx){if(-1!==currentIdx)return;idx=this.length}-1!==currentIdx&&this.splice(currentIdx,1),this.splice(idx,0,element),-1===currentIdx&&refs.set(element,inverseProperty,target)}}),Object.defineProperty(collection,"__refs_collection",{value:!0}),collection},module.exports.isExtended=function(collection){return!0===collection.__refs_collection}},{}],601:[function(require,module,exports){"use strict";var Collection=require("./collection");function defineCollectionProperty(ref,property,target){var collection=Collection.extend(target[property.name]||[],ref,property,target);Object.defineProperty(target,property.name,{enumerable:property.enumerable,value:collection}),collection.length&&collection.forEach(function(o){ref.set(o,property.inverse,target)})}function Refs(a,b){if(!(this instanceof Refs))return new Refs(a,b);(a.inverse=b).inverse=a,this.props={},this.props[a.name]=a,this.props[b.name]=b}Refs.prototype.bind=function(target,property){if("string"==typeof property){if(!this.props[property])throw new Error("no property <"+property+"> in ref");property=this.props[property]}(property.collection?defineCollectionProperty:function(ref,property,target){var inverseProperty=property.inverse,_value=target[property.name];Object.defineProperty(target,property.name,{configurable:property.configurable,enumerable:property.enumerable,get:function(){return _value},set:function(value){var old;value!==_value&&(old=_value,_value=null,old&&ref.unset(old,inverseProperty,target),_value=value,ref.set(_value,inverseProperty,target))}})})(this,property,target)},Refs.prototype.ensureRefsCollection=function(target,property){var collection=target[property.name];return Collection.isExtended(collection)||defineCollectionProperty(this,property,target),collection},Refs.prototype.ensureBound=function(target,property){!function(e,property){return Object.prototype.hasOwnProperty.call(e,property.name||property)}(target,property)&&this.bind(target,property)},Refs.prototype.unset=function(target,property,value){target&&(this.ensureBound(target,property),property.collection?this.ensureRefsCollection(target,property).remove(value):target[property.name]=void 0)},Refs.prototype.set=function(target,property,value){target&&(this.ensureBound(target,property),property.collection?this.ensureRefsCollection(target,property).add(value):target[property.name]=value)},module.exports=Refs},{"./collection":600}],602:[function(require,module,exports){"use strict";var p2s=/,?([a-z]),?/gi,toFloat=parseFloat,math=Math,PI=math.PI,mmin=math.min,mmax=math.max,pow=math.pow,abs=math.abs,pathCommand=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?[\s]*,?[\s]*)+)/gi,pathValues=/(-?\d*\.?\d*(?:e[-+]?\\d+)?)[\s]*,?[\s]*/gi,isArray=Array.isArray||function(o){return o instanceof Array};function hasProperty(obj,property){return Object.prototype.hasOwnProperty.call(obj,property)}function clone(obj){if("function"==typeof obj||Object(obj)!==obj)return obj;var res=new obj.constructor;for(var key in obj)hasProperty(obj,key)&&(res[key]=clone(obj[key]));return res}function cacher(f){function newf(){var arg=Array.prototype.slice.call(arguments,0),args=arg.join(""),cache=newf.cache=newf.cache||{},count=newf.count=newf.count||[];return hasProperty(cache,args)?function(array,item){for(var i=0,ii=array.length;i<ii;i++)if(array[i]===item)return array.push(array.splice(i,1)[0])}(count,args):(1e3<=count.length&&delete cache[count.shift()],count.push(args),cache[args]=f.apply(0,arg)),cache[args]}return newf}function paths(ps){var p=paths.ps=paths.ps||{};return p[ps]?p[ps].sleep=100:p[ps]={sleep:100},setTimeout(function(){for(var key in p)hasProperty(p,key)&&key!=ps&&(p[key].sleep--,p[key].sleep||delete p[key])}),p[ps]}function rectBBox(x,y,width,height){return 1===arguments.length&&(y=x.y,width=x.width,height=x.height,x=x.x),{x:x,y:y,width:width,height:height,x2:x+width,y2:y+height}}function pathToString(){return this.join(",").replace(p2s,"$1")}function pathClone(pathArray){var res=clone(pathArray);return res.toString=pathToString,res}function findDotsAtSegment(p1x,p1y,c1x,c1y,c2x,c2y,p2x,p2y,t){var t1=1-t,t13=pow(t1,3),t12=pow(t1,2),t3=t*t*t,y=t13*p1y+3*t12*t*c1y+3*t1*t*t*c2y+t3*p2y;return{x:fixError(t13*p1x+3*t12*t*c1x+3*t1*t*t*c2x+t3*p2x),y:fixError(y)}}function bezierBBox(points){var bbox=function(x0,y0,x1,y1,x2,y2,x3,y3){for(var a,b,c,t,t1,t2,b2ac,sqrtb2ac,tvalues=[],bounds=[[],[]],i=0;i<2;++i)if(c=0==i?(b=6*x0-12*x1+6*x2,a=-3*x0+9*x1-9*x2+3*x3,3*x1-3*x0):(b=6*y0-12*y1+6*y2,a=-3*y0+9*y1-9*y2+3*y3,3*y1-3*y0),abs(a)<1e-12){if(abs(b)<1e-12)continue;0<(t=-c/b)&&t<1&&tvalues.push(t)}else b2ac=b*b-4*c*a,sqrtb2ac=math.sqrt(b2ac),b2ac<0||(0<(t1=(-b+sqrtb2ac)/(2*a))&&t1<1&&tvalues.push(t1),0<(t2=(-b-sqrtb2ac)/(2*a))&&t2<1&&tvalues.push(t2));var mt,j=tvalues.length,jlen=j;for(;j--;)t=tvalues[j],mt=1-t,bounds[0][j]=mt*mt*mt*x0+3*mt*mt*t*x1+3*mt*t*t*x2+t*t*t*x3,bounds[1][j]=mt*mt*mt*y0+3*mt*mt*t*y1+3*mt*t*t*y2+t*t*t*y3;return bounds[0][jlen]=x0,bounds[1][jlen]=y0,bounds[0][jlen+1]=x3,bounds[1][jlen+1]=y3,bounds[0].length=bounds[1].length=jlen+2,{x0:mmin.apply(0,bounds[0]),y0:mmin.apply(0,bounds[1]),x1:mmax.apply(0,bounds[0]),y1:mmax.apply(0,bounds[1])}}.apply(null,points);return rectBBox(bbox.x0,bbox.y0,bbox.x1-bbox.x0,bbox.y1-bbox.y0)}function isPointInsideBBox(bbox,x,y){return x>=bbox.x&&x<=bbox.x+bbox.width&&y>=bbox.y&&y<=bbox.y+bbox.height}function base3(t,p1,p2,p3,p4){return t*(t*(-3*p1+9*p2-9*p3+3*p4)+6*p1-12*p2+6*p3)-3*p1+3*p2}function bezlen(x1,y1,x2,y2,x3,y3,x4,y4,z){null==z&&(z=1);for(var z2=(z=1<z?1:z<0?0:z)/2,Tvalues=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],Cvalues=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],sum=0,i=0;i<12;i++){var ct=z2*Tvalues[i]+z2,xbase=base3(ct,x1,x2,x3,x4),ybase=base3(ct,y1,y2,y3,y4),comb=xbase*xbase+ybase*ybase;sum+=Cvalues[i]*math.sqrt(comb)}return z2*sum}function fixError(number){return Math.round(1e11*number)/1e11}function findBezierIntersections(bez1,bez2,justCount){if(!function(bbox1,bbox2){return bbox1=rectBBox(bbox1),isPointInsideBBox(bbox2=rectBBox(bbox2),bbox1.x,bbox1.y)||isPointInsideBBox(bbox2,bbox1.x2,bbox1.y)||isPointInsideBBox(bbox2,bbox1.x,bbox1.y2)||isPointInsideBBox(bbox2,bbox1.x2,bbox1.y2)||isPointInsideBBox(bbox1,bbox2.x,bbox2.y)||isPointInsideBBox(bbox1,bbox2.x2,bbox2.y)||isPointInsideBBox(bbox1,bbox2.x,bbox2.y2)||isPointInsideBBox(bbox1,bbox2.x2,bbox2.y2)||(bbox1.x<bbox2.x2&&bbox1.x>bbox2.x||bbox2.x<bbox1.x2&&bbox2.x>bbox1.x)&&(bbox1.y<bbox2.y2&&bbox1.y>bbox2.y||bbox2.y<bbox1.y2&&bbox2.y>bbox1.y)}(bezierBBox(bez1),bezierBBox(bez2)))return justCount?0:[];for(var l1=bezlen.apply(0,bez1),l2=bezlen.apply(0,bez2),n1=!isLine(bez1)&&~~(l1/5)||1,n2=!isLine(bez2)&&~~(l2/5)||1,dots1=[],dots2=[],xy={},res=justCount?0:[],i=0;i<n1+1;i++){var p=findDotsAtSegment.apply(0,bez1.concat(i/n1));dots1.push({x:p.x,y:p.y,t:i/n1})}for(i=0;i<n2+1;i++)p=findDotsAtSegment.apply(0,bez2.concat(i/n2)),dots2.push({x:p.x,y:p.y,t:i/n2});for(i=0;i<n1;i++)for(var j=0;j<n2;j++){var key,di=dots1[i],di1=dots1[i+1],dj=dots2[j],dj1=dots2[j+1],ci=abs(di1.x-di.x)<.01?"y":"x",cj=abs(dj1.x-dj.x)<.01?"y":"x",is=function(x1,y1,x2,y2,x3,y3,x4,y4){if(!(mmax(x1,x2)<mmin(x3,x4)||mmin(x1,x2)>mmax(x3,x4)||mmax(y1,y2)<mmin(y3,y4)||mmin(y1,y2)>mmax(y3,y4))){var ny=(x1*y2-y1*x2)*(y3-y4)-(y1-y2)*(x3*y4-y3*x4),denominator=(x1-x2)*(y3-y4)-(y1-y2)*(x3-x4);if(denominator){var px=fixError(((x1*y2-y1*x2)*(x3-x4)-(x1-x2)*(x3*y4-y3*x4))/denominator),py=fixError(ny/denominator),px2=+px.toFixed(2),py2=+py.toFixed(2);if(!(px2<+mmin(x1,x2).toFixed(2)||px2>+mmax(x1,x2).toFixed(2)||px2<+mmin(x3,x4).toFixed(2)||px2>+mmax(x3,x4).toFixed(2)||py2<+mmin(y1,y2).toFixed(2)||py2>+mmax(y1,y2).toFixed(2)||py2<+mmin(y3,y4).toFixed(2)||py2>+mmax(y3,y4).toFixed(2)))return{x:px,y:py}}}}(di.x,di.y,di1.x,di1.y,dj.x,dj.y,dj1.x,dj1.y);if(is){if(xy[key=is.x.toFixed(9)+"#"+is.y.toFixed(9)])continue;xy[key]=!0;var t1=di.t+abs((is[ci]-di[ci])/(di1[ci]-di[ci]))*(di1.t-di.t),t2=dj.t+abs((is[cj]-dj[cj])/(dj1[cj]-dj[cj]))*(dj1.t-dj.t);0<=t1&&t1<=1&&0<=t2&&t2<=1&&(justCount?res++:res.push({x:is.x,y:is.y,t1:t1,t2:t2}))}}return res}function pathToAbsolute(pathArray){var pth=paths(pathArray);if(pth.abs)return pathClone(pth.abs);if(isArray(pathArray)&&isArray(pathArray&&pathArray[0])||(pathArray=function(pathString){if(!pathString)return null;var pth=paths(pathString);if(pth.arr)return clone(pth.arr);var paramCounts={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},data=[];return isArray(pathString)&&isArray(pathString[0])&&(data=clone(pathString)),data.length||String(pathString).replace(pathCommand,function(a,b,c){var params=[],name=b.toLowerCase();for(c.replace(pathValues,function(a,b){b&&params.push(+b)}),"m"==name&&2<params.length&&(data.push([b].concat(params.splice(0,2))),name="l",b="m"==b?"l":"L");params.length>=paramCounts[name]&&(data.push([b].concat(params.splice(0,paramCounts[name]))),paramCounts[name]););}),data.toString=paths.toString,pth.arr=clone(data),data}(pathArray)),!pathArray||!pathArray.length)return[["M",0,0]];var pa0,res=[],x=0,y=0,mx=0,my=0,start=0;"M"==pathArray[0][0]&&(mx=x=+pathArray[0][1],my=y=+pathArray[0][2],start++,res[0]=["M",x,y]);for(var r,pa,i=start,ii=pathArray.length;i<ii;i++){if(res.push(r=[]),(pa0=(pa=pathArray[i])[0])!=pa0.toUpperCase())switch(r[0]=pa0.toUpperCase(),r[0]){case"A":r[1]=pa[1],r[2]=pa[2],r[3]=pa[3],r[4]=pa[4],r[5]=pa[5],r[6]=+pa[6]+x,r[7]=+pa[7]+y;break;case"V":r[1]=+pa[1]+y;break;case"H":r[1]=+pa[1]+x;break;case"M":mx=+pa[1]+x,my=+pa[2]+y;default:for(var j=1,jj=pa.length;j<jj;j++)r[j]=+pa[j]+(j%2?x:y)}else for(var k=0,kk=pa.length;k<kk;k++)r[k]=pa[k];switch(pa0=pa0.toUpperCase(),r[0]){case"Z":x=+mx,y=+my;break;case"H":x=r[1];break;case"V":y=r[1];break;case"M":mx=r[r.length-2],my=r[r.length-1];default:x=r[r.length-2],y=r[r.length-1]}}return res.toString=pathToString,pth.abs=pathClone(res),res}function isLine(bez){return bez[0]===bez[2]&&bez[1]===bez[3]&&bez[4]===bez[6]&&bez[5]===bez[7]}function lineToCurve(x1,y1,x2,y2){return[x1,y1,x2,y2,x2,y2]}function qubicToCurve(x1,y1,ax,ay,x2,y2){return[1/3*x1+2/3*ax,1/3*y1+2/3*ay,1/3*x2+2/3*ax,1/3*y2+2/3*ay,x2,y2]}function pathToCurve(path){var pth=paths(path);if(pth.curve)return pathClone(pth.curve);for(var curvedPath=pathToAbsolute(path),attrs={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},processPath=function(path,d,pathCommand){var nx,ny;if(!path)return["C",d.x,d.y,d.x,d.y,d.x,d.y];switch(path[0]in{T:1,Q:1}||(d.qx=d.qy=null),path[0]){case"M":d.X=path[1],d.Y=path[2];break;case"A":path=["C"].concat(function arcToCurve(x1,y1,rx,ry,angle,large_arc_flag,sweep_flag,x2,y2,recursive){var xy,x,y,h,rx2,ry2,k,cx,cy,f1,f2,_120=120*PI/180,rad=PI/180*(+angle||0),res=[],rotate=cacher(function(x,y,rad){return{x:x*math.cos(rad)-y*math.sin(rad),y:x*math.sin(rad)+y*math.cos(rad)}});recursive?(f1=recursive[0],f2=recursive[1],cx=recursive[2],cy=recursive[3]):(x1=(xy=rotate(x1,y1,-rad)).x,y1=xy.y,1<(h=(x=(x1-(x2=(xy=rotate(x2,y2,-rad)).x))/2)*x/(rx*rx)+(y=(y1-(y2=xy.y))/2)*y/(ry*ry))&&(rx*=h=math.sqrt(h),ry*=h),rx2=rx*rx,ry2=ry*ry,cx=(k=(large_arc_flag==sweep_flag?-1:1)*math.sqrt(abs((rx2*ry2-rx2*y*y-ry2*x*x)/(rx2*y*y+ry2*x*x))))*rx*y/ry+(x1+x2)/2,cy=k*-ry*x/rx+(y1+y2)/2,f1=math.asin(((y1-cy)/ry).toFixed(9)),f2=math.asin(((y2-cy)/ry).toFixed(9)),(f1=x1<cx?PI-f1:f1)<0&&(f1=2*PI+f1),(f2=x2<cx?PI-f2:f2)<0&&(f2=2*PI+f2),sweep_flag&&f2<f1&&(f1-=2*PI),!sweep_flag&&f1<f2&&(f2-=2*PI));var f2old,x2old,y2old,df=f2-f1;abs(df)>_120&&(f2old=f2,x2old=x2,y2old=y2,f2=f1+_120*(sweep_flag&&f1<f2?1:-1),res=arcToCurve(x2=cx+rx*math.cos(f2),y2=cy+ry*math.sin(f2),rx,ry,angle,0,sweep_flag,x2old,y2old,[f2,f2old,cx,cy])),df=f2-f1;var c1=math.cos(f1),s1=math.sin(f1),c2=math.cos(f2),s2=math.sin(f2),t=math.tan(df/4),hx=4/3*rx*t,hy=4/3*ry*t,m1=[x1,y1],m2=[x1+hx*s1,y1-hy*c1],m3=[x2+hx*s2,y2-hy*c2],m4=[x2,y2];if(m2[0]=2*m1[0]-m2[0],m2[1]=2*m1[1]-m2[1],recursive)return[m2,m3,m4].concat(res);for(var newres=[],i=0,ii=(res=[m2,m3,m4].concat(res).join().split(",")).length;i<ii;i++)newres[i]=i%2?rotate(res[i-1],res[i],rad).y:rotate(res[i],res[i+1],rad).x;return newres}.apply(0,[d.x,d.y].concat(path.slice(1))));break;case"S":ny="C"==pathCommand||"S"==pathCommand?(nx=2*d.x-d.bx,2*d.y-d.by):(nx=d.x,d.y),path=["C",nx,ny].concat(path.slice(1));break;case"T":"Q"==pathCommand||"T"==pathCommand?(d.qx=2*d.x-d.qx,d.qy=2*d.y-d.qy):(d.qx=d.x,d.qy=d.y),path=["C"].concat(qubicToCurve(d.x,d.y,d.qx,d.qy,path[1],path[2]));break;case"Q":d.qx=path[1],d.qy=path[2],path=["C"].concat(qubicToCurve(d.x,d.y,path[1],path[2],path[3],path[4]));break;case"L":path=["C"].concat(lineToCurve(d.x,d.y,path[1],path[2]));break;case"H":path=["C"].concat(lineToCurve(d.x,d.y,path[1],d.y));break;case"V":path=["C"].concat(lineToCurve(d.x,d.y,d.x,path[1]));break;case"Z":path=["C"].concat(lineToCurve(d.x,d.y,d.X,d.Y))}return path},pathCommands=[],pfirst="",pathCommand="",i=0,ii=curvedPath.length;i<ii;i++){curvedPath[i]&&(pfirst=curvedPath[i][0]),"C"!=pfirst&&(pathCommands[i]=pfirst,i&&(pathCommand=pathCommands[i-1])),curvedPath[i]=processPath(curvedPath[i],attrs,pathCommand),"A"!=pathCommands[i]&&"C"==pfirst&&(pathCommands[i]="C"),function(pp,i){if(7<pp[i].length){pp[i].shift();for(var pi=pp[i];pi.length;)pathCommands[i]="A",pp.splice(i++,0,["C"].concat(pi.splice(0,6)));pp.splice(i,1),ii=curvedPath.length}}(curvedPath,i);var seg=curvedPath[i],seglen=seg.length;attrs.x=seg[seglen-2],attrs.y=seg[seglen-1],attrs.bx=toFloat(seg[seglen-4])||attrs.x,attrs.by=toFloat(seg[seglen-3])||attrs.y}return pth.curve=pathClone(curvedPath),curvedPath}module.exports=function(path1,path2,justCount){path1=pathToCurve(path1),path2=pathToCurve(path2);for(var x1,y1,x2,y2,x1m,y1m,x2m,y2m,bez1,bez2,res=justCount?0:[],i=0,ii=path1.length;i<ii;i++){var pi=path1[i];if("M"==pi[0])x1=x1m=pi[1],y1=y1m=pi[2];else{y1="C"==pi[0]?(x1=(bez1=[x1,y1].concat(pi.slice(1)))[6],bez1[7]):(bez1=[x1,y1,x1,y1,x1m,y1m,x1m,y1m],x1=x1m,y1m);for(var j=0,jj=path2.length;j<jj;j++){var pj=path2[j];if("M"==pj[0])x2=x2m=pj[1],y2=y2m=pj[2];else{y2="C"==pj[0]?(x2=(bez2=[x2,y2].concat(pj.slice(1)))[6],bez2[7]):(bez2=[x2,y2,x2,y2,x2m,y2m,x2m,y2m],x2=x2m,y2m);var intr=findBezierIntersections(bez1,bez2,justCount);if(justCount)res+=intr;else{for(var k=0,kk=intr.length;k<kk;k++)intr[k].segment1=i,intr[k].segment2=j,intr[k].bez1=bez1,intr[k].bez2=bez2;res=res.concat(intr)}}}}}return res}},{}],603:[function(require,module,exports){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};Object.defineProperty(exports,"__esModule",{value:!0});var fromCharCode=String.fromCharCode,hasOwnProperty=Object.prototype.hasOwnProperty,ENTITY_PATTERN=/&#(\d+);|&#x([0-9a-f]+);|&(\w+);/gi,ENTITY_MAPPING={amp:"&",apos:"'",gt:">",lt:"<",quot:'"'};function replaceEntities(_,d,x,z){return z?hasOwnProperty.call(ENTITY_MAPPING,z)?ENTITY_MAPPING[z]:"&"+z+";":fromCharCode(d||parseInt(x,16))}function decodeEntities(s){return 3<s.length&&-1!==s.indexOf("&")?s.replace(ENTITY_PATTERN,replaceEntities):s}Object.keys(ENTITY_MAPPING).forEach(function(k){ENTITY_MAPPING[k.toUpperCase()]=ENTITY_MAPPING[k]});var XSI_URI="http://www.w3.org/2001/XMLSchema-instance",XSI_PREFIX="xsi",XSI_TYPE="xsi:type",NON_WHITESPACE_OUTSIDE_ROOT_NODE="non-whitespace outside of root node";function error(msg){return new Error(msg)}function missingNamespaceForPrefix(prefix){return"missing namespace for prefix <"+prefix+">"}function getter(getFn){return{get:getFn,enumerable:!0}}function noopGetContext(){return{line:0,column:0}}function throwFunc(err){throw err}exports.Parser=function Parser(options){if(!this)return new Parser(options);var onText,onOpenTag,onCloseTag,onCDATA,onWarning,onComment,onQuestion,onAttention,nsUriToPrefix,proxy=options&&options.proxy,onError=throwFunc,getContext=noopGetContext,maybeNS=!1,isNamespace=!1,returnError=null,parseStop=!1;function handleError(err){err instanceof Error||(err=error(err)),onError(returnError=err,getContext)}function handleWarning(err){onWarning&&(err instanceof Error||(err=error(err)),onWarning(err,getContext))}this.on=function(name,cb){if("function"!=typeof cb)throw error("required args <name, cb>");switch(name){case"openTag":onOpenTag=cb;break;case"text":onText=cb;break;case"closeTag":onCloseTag=cb;break;case"error":onError=cb;break;case"warn":onWarning=cb;break;case"cdata":onCDATA=cb;break;case"attention":onAttention=cb;break;case"question":onQuestion=cb;break;case"comment":onComment=cb;break;default:throw error("unsupported event: "+name)}return this},this.ns=function(nsMap){if(void 0===nsMap&&(nsMap={}),"object"!==(void 0===nsMap?"undefined":_typeof(nsMap)))throw error("required args <nsMap={}>");var k,_nsUriToPrefix={};for(k in nsMap)_nsUriToPrefix[k]=nsMap[k];return _nsUriToPrefix[XSI_URI]=XSI_PREFIX,isNamespace=!0,nsUriToPrefix=_nsUriToPrefix,this},this.parse=function(xml){if("string"!=typeof xml)throw error("required args <xml=string>");return returnError=null,function(xml){var _nsMatrix,x,y,q,w,v,xmlns,elementName,_elementName,elementProxy,cachedAttrs,nsMatrixStack=isNamespace?[]:null,nsMatrix=isNamespace?function(nsUriToPrefix){var uri,prefix,nsMatrix={};for(uri in nsUriToPrefix)nsMatrix[prefix=nsUriToPrefix[uri]]=prefix,nsMatrix[prefix+"$uri"]=uri;return nsMatrix}(nsUriToPrefix):null,nodeStack=[],anonymousNsCount=0,tagStart=!1,tagEnd=!1,i=0,j=0,attrsString="",attrsStart=0;function getAttrs(){if(null!==cachedAttrs)return cachedAttrs;var nsUri,nsUriPrefix,nsName,hasNewMatrix,newalias,value,alias,name,skipAttr,w,j,defaultAlias=isNamespace&&nsMatrix.xmlns,attrList=isNamespace&&maybeNS?[]:null,i=attrsStart,s=attrsString,l=s.length,attrs={},seenAttrs={};parseAttr:for(;i<l;i++)if(skipAttr=!1,!(32===(w=s.charCodeAt(i))||w<14&&8<w)){for((w<65||122<w||90<w&&w<97)&&95!==w&&58!==w&&(handleWarning("illegal first char attribute name"),skipAttr=!0),j=i+1;j<l;j++)if(!(96<(w=s.charCodeAt(j))&&w<123||64<w&&w<91||47<w&&w<59||46===w||45===w||95===w)){if(32===w||w<14&&8<w){handleWarning("missing attribute value"),i=j;continue parseAttr}if(61===w)break;handleWarning("illegal attribute name char"),skipAttr=!0}if("xmlns:xmlns"===(name=s.substring(i,j))&&(handleWarning("illegal declaration of xmlns"),skipAttr=!0),34===(w=s.charCodeAt(j+1)))-1===(j=s.indexOf('"',i=j+2))&&-1!==(j=s.indexOf("'",i))&&(handleWarning("attribute value quote missmatch"),skipAttr=!0);else if(39===w)-1===(j=s.indexOf("'",i=j+2))&&-1!==(j=s.indexOf('"',i))&&(handleWarning("attribute value quote missmatch"),skipAttr=!0);else for(handleWarning("missing attribute value quotes"),skipAttr=!0,j+=1;j<l&&!(32===(w=s.charCodeAt(j+1))||w<14&&8<w);j++);for(-1===j&&(handleWarning("missing closing quotes"),j=l,skipAttr=!0),skipAttr||(value=s.substring(i,j)),i=j;j+1<l&&!(32===(w=s.charCodeAt(j+1))||w<14&&8<w);j++)i===j&&(handleWarning("illegal character after attribute end"),skipAttr=!0);if(i=j+1,!skipAttr)if(name in seenAttrs)handleWarning("attribute <"+name+"> already defined");else if(seenAttrs[name]=!0,isNamespace)if(maybeNS){if(null!==(newalias="xmlns"===name?"xmlns":120===name.charCodeAt(0)&&"xmlns:"===name.substr(0,6)?name.substr(6):null)){if(nsUri=decodeEntities(value),nsUriPrefix=newalias+"$uri",!(alias=nsUriToPrefix[nsUri])){if("xmlns"===newalias||nsUriPrefix in nsMatrix&&nsMatrix[nsUriPrefix]!==nsUri)for(;alias="ns"+anonymousNsCount++,void 0!==nsMatrix[alias];);else alias=newalias;nsUriToPrefix[nsUri]=alias}nsMatrix[newalias]!==alias&&(hasNewMatrix||(nsMatrix=function(nsMatrix){var key,clone={};for(key in nsMatrix)clone[key]=nsMatrix[key];return clone}(nsMatrix),hasNewMatrix=!0),nsMatrix[newalias]=alias,"xmlns"===newalias&&(nsMatrix[alias+"$uri"]=nsUri,defaultAlias=alias),nsMatrix[nsUriPrefix]=nsUri),attrs[name]=value;continue}attrList.push(name,value)}else-1!==(w=name.indexOf(":"))?(nsName=nsMatrix[name.substring(0,w)])?((name=defaultAlias===nsName?name.substr(w+1):nsName+name.substr(w))===XSI_TYPE&&(value=-1!==(w=value.indexOf(":"))?(nsName=value.substring(0,w),(nsName=nsMatrix[nsName]||nsName)+value.substring(w)):defaultAlias+":"+value),attrs[name]=value):handleWarning(missingNamespaceForPrefix(name.substring(0,w))):attrs[name]=value;else attrs[name]=value}if(maybeNS)for(i=0,l=attrList.length;i<l;i++){if(name=attrList[i++],value=attrList[i],-1!==(w=name.indexOf(":"))){if(!(nsName=nsMatrix[name.substring(0,w)])){handleWarning(missingNamespaceForPrefix(name.substring(0,w)));continue}(name=defaultAlias===nsName?name.substr(w+1):nsName+name.substr(w))===XSI_TYPE&&(value=-1!==(w=value.indexOf(":"))?(nsName=value.substring(0,w),(nsName=nsMatrix[nsName]||nsName)+value.substring(w)):defaultAlias+":"+value)}attrs[name]=value}return cachedAttrs=attrs}for(getContext=function(){for(var match,splitsRe=/(\r\n|\r|\n)/g,line=0,column=0,startOfLine=0,endOfLine=j;startOfLine<=i&&(match=splitsRe.exec(xml))&&(endOfLine=match[0].length+match.index,!(i<endOfLine));)line+=1,startOfLine=endOfLine;return{data:-1==i?(column=endOfLine,xml.substring(j)):0===j?xml.substring(j,i):(column=i-startOfLine,-1==j?xml.substring(i):xml.substring(i,j+1)),line:line,column:column}},proxy&&(elementProxy=Object.create({},{name:getter(function(){return elementName}),originalName:getter(function(){return _elementName}),attrs:getter(getAttrs),ns:getter(function(){return nsMatrix})}));-1!==j;){if(-1===(i=60===xml.charCodeAt(j)?j:xml.indexOf("<",j)))return nodeStack.length?handleError("unexpected end of file"):0===j?handleError("missing start tag"):j<xml.length&&xml.substring(j).trim()&&handleWarning(NON_WHITESPACE_OUTSIDE_ROOT_NODE);if(j!==i)if(nodeStack.length){if(onText&&(onText(xml.substring(j,i),decodeEntities,getContext),parseStop))return}else if(xml.substring(j,i).trim()&&(handleWarning(NON_WHITESPACE_OUTSIDE_ROOT_NODE),parseStop))return;if(33===(w=xml.charCodeAt(i+1))){if(91===(q=xml.charCodeAt(i+2))&&"CDATA["===xml.substr(i+3,6)){if(-1===(j=xml.indexOf("]]>",i)))return handleError("unclosed cdata");if(onCDATA&&(onCDATA(xml.substring(i+9,j),getContext),parseStop))return;j+=3;continue}if(45===q&&45===xml.charCodeAt(i+3)){if(-1===(j=xml.indexOf("--\x3e",i)))return handleError("unclosed comment");if(onComment&&(onComment(xml.substring(i+4,j),decodeEntities,getContext),parseStop))return;j+=3;continue}}if(63!==w){for(x=i+1;;x++){if(v=xml.charCodeAt(x),isNaN(v))return j=-1,handleError("unclosed tag");if(34===v)q=xml.indexOf('"',x+1),x=-1!==q?q:x;else if(39===v)q=xml.indexOf("'",x+1),x=-1!==q?q:x;else if(62===v){j=x;break}}if(33!==w){if(cachedAttrs={},47===w){if(tagEnd=!(tagStart=!1),!nodeStack.length)return handleError("missing open tag");if(x=elementName=nodeStack.pop(),q=i+2+x.length,xml.substring(i+2,q)!==x)return handleError("closing tag mismatch");for(;q<j;q++)if(!(32===(w=xml.charCodeAt(q))||8<w&&w<14))return handleError("close tag")}else{if(tagEnd=47===xml.charCodeAt(j-1)?(x=elementName=xml.substring(i+1,j-1),tagStart=!0):(x=elementName=xml.substring(i+1,j),!(tagStart=!0)),!(96<w&&w<123||64<w&&w<91||95===w||58===w))return handleError("illegal first char nodeName");for(q=1,y=x.length;q<y;q++)if(!(96<(w=x.charCodeAt(q))&&w<123||64<w&&w<91||47<w&&w<59||45===w||95===w||46==w)){if(32===w||w<14&&8<w){elementName=x.substring(0,q),cachedAttrs=null;break}return handleError("invalid nodeName")}tagEnd||nodeStack.push(elementName)}if(isNamespace){if(_nsMatrix=nsMatrix,tagStart&&(tagEnd||nsMatrixStack.push(_nsMatrix),null===cachedAttrs&&(maybeNS=-1!==x.indexOf("xmlns",q))&&(attrsStart=q,attrsString=x,getAttrs(),maybeNS=!1)),-1!==(w=(_elementName=elementName).indexOf(":"))){if(!(xmlns=nsMatrix[elementName.substring(0,w)]))return handleError("missing namespace on <"+_elementName+">");elementName=elementName.substr(w+1)}else xmlns=nsMatrix.xmlns;xmlns&&(elementName=xmlns+":"+elementName)}if(tagStart&&(attrsStart=q,attrsString=x,onOpenTag&&(proxy?onOpenTag(elementProxy,decodeEntities,tagEnd,getContext):onOpenTag(elementName,getAttrs,decodeEntities,tagEnd,getContext),parseStop)))return;if(tagEnd){if(onCloseTag&&(onCloseTag(proxy?elementProxy:elementName,decodeEntities,tagStart,getContext),parseStop))return;isNamespace&&(nsMatrix=tagStart?_nsMatrix:nsMatrixStack.pop())}j+=1}else{if(onAttention&&(onAttention(xml.substring(i,j+1),decodeEntities,getContext),parseStop))return;j+=1}}else{if(-1===(j=xml.indexOf("?>",i)))return handleError("unclosed question");if(onQuestion&&(onQuestion(xml.substring(i,j+2),getContext),parseStop))return;j+=2}}}(xml),getContext=noopGetContext,parseStop=!1,returnError},this.stop=function(){parseStop=!0}},exports.decode=decodeEntities},{}],604:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=create;var obj,_minDom=require("min-dom"),_minDash=require("min-dash"),_mitt=require("mitt"),_mitt2=(obj=_mitt)&&obj.__esModule?obj:{default:obj};var DEFAULT_OPTIONS={scrollSymbolLeft:"",scrollSymbolRight:""};function ScrollTabs($el,options){(0,_minDash.assign)(this,(0,_mitt2.default)()),this.options=options=(0,_minDash.assign)({},DEFAULT_OPTIONS,options),this.container=$el,this._createScrollButtons($el,options),this._bindEvents($el)}function create($el,options){var scrollTabs=get($el);return scrollTabs||(scrollTabs=new ScrollTabs($el,options),$el.__scrollTabs=scrollTabs),scrollTabs}function get($el){return $el.__scrollTabs}ScrollTabs.prototype._createButton=function(parentNode,options){var className=options.className,direction=options.direction,button=(0,_minDom.query)("."+className,parentNode);return button||(button=(0,_minDom.domify)('<span class="scroll-tabs-button '+className+'">'+options.label+"</span>"),parentNode.insertBefore(button,parentNode.childNodes[0])),(0,_minDom.attr)(button,"data-direction",direction),button},ScrollTabs.prototype._createScrollButtons=function(parentNode,options){this._createButton(parentNode,{className:"scroll-tabs-left",label:options.scrollSymbolLeft,direction:-1}),this._createButton(parentNode,{className:"scroll-tabs-right",label:options.scrollSymbolRight,direction:1})},ScrollTabs.prototype.getActiveTabNode=function(){return(0,_minDom.query)(this.options.selectors.active,this.container)},ScrollTabs.prototype.getTabsContainerNode=function(){return(0,_minDom.query)(this.options.selectors.tabsContainer,this.container)},ScrollTabs.prototype.getAllTabNodes=function(){return(0,_minDom.queryAll)(this.options.selectors.tab,this.container)},ScrollTabs.prototype.getVisibleTabs=function(){var allTabs=this.getAllTabNodes(),ignore=this.options.selectors.ignore;return(0,_minDash.filter)(allTabs,function(tabNode){return!(0,_minDom.matches)(tabNode,ignore)})},ScrollTabs.prototype.getAdjacentTab=function(referenceTabNode,n){var visibleTabs=this.getVisibleTabs(),index=visibleTabs.indexOf(referenceTabNode);return visibleTabs[index+n]},ScrollTabs.prototype._bindEvents=function(node){this._bindWheelEvent(node),this._bindTabClickEvents(node),this._bindScrollButtonEvents(node)},ScrollTabs.prototype._bindTabClickEvents=function(node){var selector=this.options.selectors.tab,self=this;_minDom.delegate.bind(node,selector,"click",function(event){self.scrollToTabNode(event.delegateTarget)})},ScrollTabs.prototype._bindWheelEvent=function(node){var self=this;_minDom.event.bind(node,"wheel",function(e){var direction=Math.sign(e.deltaY),oldActiveTab=self.getActiveTabNode(),newActiveTab=self.getAdjacentTab(oldActiveTab,direction);newActiveTab&&(self.scrollToTabNode(newActiveTab),self.emit("scroll",newActiveTab,oldActiveTab,direction)),e.preventDefault()})},ScrollTabs.prototype._bindScrollButtonEvents=function(node){var self=this;_minDom.delegate.bind(node,".scroll-tabs-button","click",function(event){var target=event.delegateTarget,direction=parseInt((0,_minDom.attr)(target,"data-direction"),10),oldActiveTabNode=self.getActiveTabNode(),newActiveTabNode=self.getAdjacentTab(oldActiveTabNode,direction);newActiveTabNode&&(self.scrollToTabNode(newActiveTabNode),self.emit("scroll",newActiveTabNode,oldActiveTabNode,direction)),event.preventDefault()})},ScrollTabs.prototype.scrollToTabNode=function(tabNode){var tabsContainerNode,tabWidth,tabOffsetLeft,tabOffsetRight,containerWidth;tabNode&&(tabsContainerNode=tabNode.parentNode,tabWidth=tabNode.offsetWidth,tabOffsetRight=(tabOffsetLeft=tabNode.offsetLeft)+tabWidth,containerWidth=tabsContainerNode.offsetWidth,tabOffsetLeft<tabsContainerNode.scrollLeft?tabsContainerNode.scrollLeft=0:containerWidth<tabOffsetRight&&(tabsContainerNode.scrollLeft=tabOffsetRight-containerWidth))},ScrollTabs.prototype.update=function(){var tabsContainerNode=this.getTabsContainerNode(),overflow=tabsContainerNode.scrollWidth>tabsContainerNode.offsetWidth;(0,_minDom.classes)(this.container).toggle("scroll-tabs-overflow",overflow),overflow&&this.scrollToTabNode(this.getActiveTabNode())},create.get=get},{"min-dash":594,"min-dom":595,mitt:596}],605:[function(require,module,exports){"use strict";function range(start,end){return{start:start,end:void 0===end?start:end}}module.exports=function(currentSelection,currentValue,newValue){var currentCursor=currentSelection.start,newCursor=currentCursor,diff=newValue.length-currentValue.length,currentTail=(newValue.length,currentValue.length,currentValue.substring(currentCursor));return newValue.lastIndexOf(currentTail)===newValue.length-currentTail.length&&(currentValue=currentValue.substring(0,currentValue.length-currentTail.length),newValue=newValue.substring(0,newValue.length-currentTail.length)),(diff=function(currentValue,newValue){var insert,l_str,l_char,s_str,s_char,l_idx=0,s_idx=0;s_str=newValue.length>currentValue.length?(l_str=newValue,currentValue):(l_str=currentValue,newValue);for(;l_idx<l_str.length;)l_char=l_str.charAt(l_idx),s_char=s_str.charAt(s_idx),l_char!==s_char?insert=insert||{l_start:l_idx,s_start:s_idx}:(insert&&!insert.complete&&(insert.l_end=l_idx,insert.s_end=s_idx,insert.complete=!0),s_idx++),l_idx++;insert&&!insert.complete&&(insert.complete=!0,insert.s_end=s_str.length,insert.l_end=l_str.length);if(!insert)return;return newValue.length>currentValue.length?{newStart:insert.l_start,newEnd:insert.l_end,type:"add"}:{newStart:insert.s_start,newEnd:insert.s_end,type:newValue.length<currentValue.length?"remove":"replace"}}(currentValue,newValue))&&(newCursor="remove"===diff.type?diff.newStart:diff.newEnd),range(newCursor)},module.exports.range=range},{}],606:[function(require,module,exports){"use strict";function ensureImported(element,target){if(element.ownerDocument!==target.ownerDocument)try{return target.ownerDocument.importNode(element,!0)}catch(e){}return element}function appendTo(element,target){return target.appendChild(ensureImported(element,target))}Object.defineProperty(exports,"__esModule",{value:!0});var LENGTH_ATTR=2,CSS_PROPERTIES={"alignment-baseline":1,"baseline-shift":1,clip:1,"clip-path":1,"clip-rule":1,color:1,"color-interpolation":1,"color-interpolation-filters":1,"color-profile":1,"color-rendering":1,cursor:1,direction:1,display:1,"dominant-baseline":1,"enable-background":1,fill:1,"fill-opacity":1,"fill-rule":1,filter:1,"flood-color":1,"flood-opacity":1,font:1,"font-family":1,"font-size":LENGTH_ATTR,"font-size-adjust":1,"font-stretch":1,"font-style":1,"font-variant":1,"font-weight":1,"glyph-orientation-horizontal":1,"glyph-orientation-vertical":1,"image-rendering":1,kerning:1,"letter-spacing":1,"lighting-color":1,marker:1,"marker-end":1,"marker-mid":1,"marker-start":1,mask:1,opacity:1,overflow:1,"pointer-events":1,"shape-rendering":1,"stop-color":1,"stop-opacity":1,stroke:1,"stroke-dasharray":1,"stroke-dashoffset":1,"stroke-linecap":1,"stroke-linejoin":1,"stroke-miterlimit":1,"stroke-opacity":1,"stroke-width":LENGTH_ATTR,"text-anchor":1,"text-decoration":1,"text-rendering":1,"unicode-bidi":1,visibility:1,"word-spacing":1,"writing-mode":1};function setAttribute(node,name,value){var hyphenated=name.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),type=CSS_PROPERTIES[hyphenated];type?(type===LENGTH_ATTR&&"number"==typeof value&&(value=String(value)+"px"),node.style[hyphenated]=value):node.setAttributeNS(null,name,value)}function attr(node,name,value){if("string"==typeof name){if(void 0===value)return function(node,name){return CSS_PROPERTIES[name]?node.style[name]:node.getAttributeNS(null,name)}(node,name);setAttribute(node,name,value)}else!function(node,attrs){for(var name,names=Object.keys(attrs),i=0;name=names[i];i++)setAttribute(node,name,attrs[name])}(node,name);return node}function index(arr,obj){if(arr.indexOf)return arr.indexOf(obj);for(var i=0;i<arr.length;++i)if(arr[i]===obj)return i;return-1}var re=/\s+/,toString=Object.prototype.toString;function defined(o){return void 0!==o}function ClassList(el){if(!el||!el.nodeType)throw new Error("A DOM element reference is required");this.el=el,this.list=el.classList}function remove(element){var parent=element.parentNode;return parent&&parent.removeChild(element),element}function clear(element){for(var child;child=element.firstChild;)remove(child);return element}ClassList.prototype.add=function(name){if(this.list)return this.list.add(name),this;var arr=this.array();return~index(arr,name)||arr.push(name),defined(this.el.className.baseVal)?this.el.className.baseVal=arr.join(" "):this.el.className=arr.join(" "),this},ClassList.prototype.remove=function(name){if("[object RegExp]"===toString.call(name))return this.removeMatching(name);if(this.list)return this.list.remove(name),this;var arr=this.array(),i=index(arr,name);return~i&&arr.splice(i,1),this.el.className.baseVal=arr.join(" "),this},ClassList.prototype.removeMatching=function(re){for(var arr=this.array(),i=0;i<arr.length;i++)re.test(arr[i])&&this.remove(arr[i]);return this},ClassList.prototype.toggle=function(name,force){return this.list?defined(force)&&force===this.list.toggle(name,force)||this.list.toggle(name):defined(force)?force?this.add(name):this.remove(name):this.has(name)?this.remove(name):this.add(name),this},ClassList.prototype.array=function(){var arr=(this.el.getAttribute("class")||"").replace(/^\s+|\s+$/g,"").split(re);return""===arr[0]&&arr.shift(),arr},ClassList.prototype.has=ClassList.prototype.contains=function(name){return this.list?this.list.contains(name):!!~index(this.array(),name)};var ns={svg:"http://www.w3.org/2000/svg"},SVG_START='<svg xmlns="'+ns.svg+'"';function parse(svg){var unwrap=!1;"<svg"===svg.substring(0,4)?-1===svg.indexOf(ns.svg)&&(svg=SVG_START+svg.substring(4)):(svg=SVG_START+">"+svg+"</svg>",unwrap=!0);var parsed=function(svg){var parser;return(parser=new DOMParser).async=!1,parser.parseFromString(svg,"text/xml")}(svg);if(!unwrap)return parsed;for(var fragment=document.createDocumentFragment(),parent=parsed.firstChild;parent.firstChild;)fragment.appendChild(parent.firstChild);return fragment}function create(name,attrs){var element="<"===name.charAt(0)?(element=parse(name).firstChild,document.importNode(element,!0)):document.createElementNS(ns.svg,name);return attrs&&attr(element,attrs),element}var node=create("svg");function extend(object,props){for(var k,keys=Object.keys(props),i=0;k=keys[i];i++)object[k]=props[k];return object}var TEXT_ENTITIES=/([&<>]{1})/g,ATTR_ENTITIES=/([\n\r"]{1})/g,ENTITY_REPLACEMENT={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"'"};function escape(str,pattern){return str.replace(pattern,function(match,entity){return ENTITY_REPLACEMENT[entity]||entity})}function set(element,svg){var parsed=parse(svg);if(clear(element),svg){"#document-fragment"!==parsed.nodeName&&(parsed=parsed.documentElement);for(var arr,nodes=(arr=parsed.childNodes,Array.prototype.slice.call(arr)),i=0;i<nodes.length;i++)appendTo(nodes[i],element)}}function get(element){for(var child=element.firstChild,output=[];child;)!function serialize(node,output){var i,len,attrMap,attrNode,childNodes;switch(node.nodeType){case 3:output.push(escape(node.textContent,TEXT_ENTITIES));break;case 1:if(output.push("<",node.tagName),node.hasAttributes())for(i=0,len=(attrMap=node.attributes).length;i<len;++i)attrNode=attrMap.item(i),output.push(" ",attrNode.name,'="',escape(attrNode.value,ATTR_ENTITIES),'"');if(node.hasChildNodes()){for(output.push(">"),i=0,len=(childNodes=node.childNodes).length;i<len;++i)serialize(childNodes.item(i),output);output.push("</",node.tagName,">")}else output.push("/>");break;case 8:output.push("\x3c!--",escape(node.nodeValue,TEXT_ENTITIES),"--\x3e");break;case 4:output.push("<![CDATA[",node.nodeValue,"]]>");break;default:throw new Error("unable to handle node "+node.nodeType)}return output}(child,output),child=child.nextSibling;return output.join("")}function prependTo(node,target){return target.insertBefore(ensureImported(node,target),target.firstChild||null)}function setTransforms(transformList,transforms){var i,t;for(transformList.clear(),i=0;t=transforms[i];i++)transformList.appendItem(function(transformList,transform){return transform instanceof SVGMatrix?transformList.createSVGTransformFromMatrix(transform):transform}(transformList,t))}exports.append=function(target,node){return appendTo(node,target),target},exports.appendTo=appendTo,exports.attr=attr,exports.classes=function(el){return new ClassList(el)},exports.clear=clear,exports.clone=function(element){return element.cloneNode(!0)},exports.create=create,exports.innerSVG=function(element,svg){if(void 0===svg)return get(element);try{set(element,svg)}catch(e){throw new Error("error parsing SVG: "+e.message)}return element},exports.prepend=function(target,node){return prependTo(node,target),target},exports.prependTo=prependTo,exports.remove=remove,exports.replace=function(element,replacement){return element.parentNode.replaceChild(ensureImported(replacement,element),element),replacement},exports.transform=function(node,transforms){var transformList=node.transform.baseVal;return transforms&&(Array.isArray(transforms)||(transforms=[transforms]),setTransforms(transformList,transforms)),transformList.consolidate()},exports.on=function(node,event,listener,useCapture){node.addEventListener(event,listener,useCapture)},exports.off=function(node,event,listener,useCapture){node.removeEventListener(event,listener,useCapture)},exports.createPoint=function(x,y){var point=node.createSVGPoint();switch(arguments.length){case 0:return point;case 2:x={x:x,y:y}}return extend(point,x)},exports.createMatrix=function(a,b,c,d,e,f){var matrix=node.createSVGMatrix();switch(arguments.length){case 0:return matrix;case 1:return extend(matrix,a);case 6:return extend(matrix,{a:a,b:b,c:c,d:d,e:e,f:f})}},exports.createTransform=function(matrix){return matrix?node.createSVGTransformFromMatrix(matrix):node.createSVGTransform()},exports.select=function(node,selector){return node.querySelector(selector)},exports.selectAll=function(node,selector){var nodes=node.querySelectorAll(selector);return[].map.call(nodes,function(element){return element})}},{}],607:[function(require,module,exports){module.exports='<?xml version="1.0" encoding="UTF-8"?>\n<bpmn2:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn2="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" id="sample-diagram" targetNamespace="http://bpmn.io/schema/bpmn" xsi:schemaLocation="http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd">\n  <bpmn2:process id="Process_1" isExecutable="false">\n    <bpmn2:startEvent id="StartEvent_1">\n      <bpmn2:outgoing>SequenceFlow_1x7qbp4</bpmn2:outgoing>\n    </bpmn2:startEvent>\n    <bpmn2:task id="Task_0i1d0ke">\n      <bpmn2:incoming>SequenceFlow_1x7qbp4</bpmn2:incoming>\n    </bpmn2:task>\n    <bpmn2:sequenceFlow id="SequenceFlow_1x7qbp4" sourceRef="StartEvent_1" targetRef="Task_0i1d0ke" />\n  </bpmn2:process>\n  <bpmndi:BPMNDiagram id="BPMNDiagram_1">\n    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1">\n      <bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1">\n        <dc:Bounds x="412" y="240" width="36" height="36" />\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id="Task_0i1d0ke_di" bpmnElement="Task_0i1d0ke">\n        <dc:Bounds x="498" y="218" width="100" height="80" />\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNEdge id="SequenceFlow_1x7qbp4_di" bpmnElement="SequenceFlow_1x7qbp4">\n        <di:waypoint x="448" y="258" />\n        <di:waypoint x="498" y="258" />\n        <bpmndi:BPMNLabel>\n          <dc:Bounds x="473" y="236" width="0" height="13" />\n        </bpmndi:BPMNLabel>\n      </bpmndi:BPMNEdge>\n    </bpmndi:BPMNPlane>\n  </bpmndi:BPMNDiagram>\n</bpmn2:definitions>\n'},{}],608:[function(require,module,exports){module.exports={name:"Kitodo Template",prefix:"template",uri:"http://www.kitodo.org/template",xml:{tagAlias:"lowerCase"},associations:[],types:[{name:"TemplateTaskEvent",extends:["bpmn:Task"],properties:[{name:"correction",isAttr:!0,type:"Boolean"},{name:"editType",isAttr:!0,type:"Integer"},{name:"processingStatus",isAttr:!0,type:"Integer"},{name:"permittedUserRole",isAttr:!0,type:"String "},{name:"typeMetadata",isAttr:!0,type:"Boolean"},{name:"separateStructure",isAttr:!0,type:"Boolean"},{name:"typeAutomatic",isAttr:!0,type:"Boolean"},{name:"typeImagesRead",isAttr:!0,type:"Boolean"},{name:"typeImagesWrite",isAttr:!0,type:"Boolean"},{name:"typeGenerateImages",isAttr:!0,type:"Boolean"},{name:"typeValidateImages",isAttr:!0,type:"Boolean"},{name:"typeExportDMS",isAttr:!0,type:"Boolean"},{name:"typeAcceptClose",isAttr:!0,type:"Boolean"},{name:"typeCloseVerify",isAttr:!0,type:"Boolean"},{name:"batchStep",isAttr:!0,type:"Boolean"},{name:"concurrent",isAttr:!0,type:"Boolean"},{name:"kitodoConditionType",isAttr:!0,type:"String"},{name:"kitodoConditionValue",isAttr:!0,type:"String"}]},{name:"TemplateScriptTaskEvent",extends:["bpmn:ScriptTask"],properties:[{name:"scriptName",isAttr:!0,type:"String"},{name:"scriptPath",isAttr:!0,type:"String"}]}]}},{}],609:[function(require,module,exports){"use strict";var _jquery2=_interopRequireDefault(require("jquery")),_Modeler2=_interopRequireDefault(require("bpmn-js/lib/Modeler")),_bpmnJsPropertiesPanel2=_interopRequireDefault(require("bpmn-js-properties-panel")),_template2=_interopRequireDefault(require("./provider/template")),_template4=_interopRequireDefault(require("./descriptors/template")),_initialDiagram2=(require("min-dash"),_interopRequireDefault(require("../resources/initialDiagram.bpmn")));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var container=(0,_jquery2.default)("#js-drop-zone"),bpmnModeler=new _Modeler2.default({container:"#js-canvas",propertiesPanel:{parent:"#js-properties-panel"},additionalModules:[_bpmnJsPropertiesPanel2.default,_template2.default],moddleExtensions:{template:_template4.default}});function openDiagram(xml){bpmnModeler.importXML(xml,function(err){err?(container.removeClass("with-diagram").addClass("with-error"),container.find(".error pre").text(err.message),console.error(err)):container.removeClass("with-error").addClass("with-diagram")})}saveDiagramFunctionCall=function(){var xmlParam="",svgParam="";bpmnModeler.saveXML({format:!0},function(err,xml){err?alert("diagram xml save failed",err):xmlParam=xml}),bpmnModeler.saveSVG({format:!0},function(err,svg){err?alert("diagram svg save failed",err):svgParam=svg}),document.getElementById("editForm:workflowTabView:xmlDiagram").value=xmlParam+"kitodo-diagram-separator"+svgParam};var modelerActions={"modeler.toggleFullscreen":function(){var element,elem=document.querySelector("#js-drop-zone");element=elem,document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():element.requestFullscreen?element.requestFullscreen():element.msRequestFullscreen?element.msRequestFullscreen():element.mozRequestFullScreen?element.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&element.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)},"modeler.zoomReset":function(){bpmnModeler.get("zoomScroll").reset()},"modeler.zoomIn":function(){bpmnModeler.get("zoomScroll").stepZoom(1)},"modeler.zoomOut":function(){bpmnModeler.get("zoomScroll").stepZoom(-1)}};(0,_jquery2.default)(function(){function actionListener(event){var name=parseActionAttr((0,_jquery2.default)(this)).name,action=modelerActions[name];if(!action)throw new Error("no action <"+name+"> defined");event.preventDefault(),action(event)}var delegates={};function parseActionAttr(element){var match=(0,_jquery2.default)(element).attr("jsaction").split(/:(.+$)/,2);return{event:match[0],name:match[1]}}(0,_jquery2.default)("[jsaction]").each(function(){var jsaction=parseActionAttr((0,_jquery2.default)(this)),event=jsaction.event;delegates[event]||((0,_jquery2.default)(document.body).on(event,"[jsaction]",actionListener),delegates[event]=!0);var name=jsaction.name;if(!modelerActions[name])throw new Error("no action <"+name+"> defined")}),(0,_jquery2.default)("#editForm\\:workflowTabView\\:js-create-diagram").click(function(e){e.stopPropagation(),e.preventDefault(),openDiagram(_initialDiagram2.default)}),(0,_jquery2.default)("#editForm\\:workflowTabView\\:btnReadXmlDiagram").click(function(e){var placeholderForDiagram;e.stopPropagation(),e.preventDefault(),(placeholderForDiagram=document.getElementById("editForm:workflowTabView:xmlDiagram"))?openDiagram(placeholderForDiagram.value):alert("diagram is empty!")})})},{"../resources/initialDiagram.bpmn":607,"./descriptors/template":608,"./provider/template":611,"bpmn-js-properties-panel":1,"bpmn-js/lib/Modeler":51,jquery:386,"min-dash":594}],610:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=TemplatePropertiesProvider;var _inherits2=_interopRequireDefault(require("inherits")),_PropertiesActivator2=_interopRequireDefault(require("bpmn-js-properties-panel/lib/PropertiesActivator")),_ProcessProps2=_interopRequireDefault(require("bpmn-js-properties-panel/lib/provider/bpmn/parts/ProcessProps")),_EventProps2=_interopRequireDefault(require("bpmn-js-properties-panel/lib/provider/bpmn/parts/EventProps")),_LinkProps2=_interopRequireDefault(require("bpmn-js-properties-panel/lib/provider/bpmn/parts/LinkProps")),_IdProps2=_interopRequireDefault(require("bpmn-js-properties-panel/lib/provider/bpmn/parts/IdProps")),_ConditionalProps2=(_interopRequireDefault(require("bpmn-js-properties-panel/lib/provider/bpmn/parts/NameProps")),_interopRequireDefault(require("bpmn-js-properties-panel/lib/provider/camunda/parts/ConditionalProps"))),_ScriptTaskProperties2=_interopRequireDefault(require("./parts/ScriptTaskProperties")),_TaskProperties2=_interopRequireDefault(require("./parts/TaskProperties")),_PermissionProperties2=_interopRequireDefault(require("./parts/PermissionProperties")),_ConditionProperties2=_interopRequireDefault(require("./parts/ConditionProperties")),_KitodoNameProps2=_interopRequireDefault(require("./parts/KitodoNameProps"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var is=require("bpmn-js/lib/util/ModelUtil").is;function TemplatePropertiesProvider(eventBus,bpmnFactory,elementRegistry,translate){_PropertiesActivator2.default.call(this,eventBus),this.getTabs=function(element){return[{id:"general",label:getLocalizedStringForKey("propertiesLabel"),groups:function(element,bpmnFactory,elementRegistry,translate){var title="";(is(element,"bpmn:Task")||is(element,"bpmn:StartEvent")||is(element,"bpmn:EndEvent"))&&(title=getLocalizedStringForKey("generalGroupLabel"));var generalGroup={id:"general",label:title,entries:[]};(0,_IdProps2.default)(generalGroup,element,translate),(0,_KitodoNameProps2.default)(generalGroup,element,translate),(0,_ProcessProps2.default)(generalGroup,element,translate);var detailsGroup={id:"details",label:getLocalizedStringForKey("detailsGroupLabel"),entries:[]};(0,_LinkProps2.default)(detailsGroup,element,translate),(0,_EventProps2.default)(detailsGroup,element,bpmnFactory,elementRegistry,translate),(0,_ConditionalProps2.default)(detailsGroup,element,bpmnFactory,translate);var taskGroup={id:"task",label:getLocalizedStringForKey("taskGroupLabel"),entries:[]};(0,_TaskProperties2.default)(taskGroup,element,translate);var scriptTaskGroup={id:"scriptTask",label:getLocalizedStringForKey("scriptGroupLabel"),entries:[]};return(0,_ScriptTaskProperties2.default)(scriptTaskGroup,element),[generalGroup,taskGroup,scriptTaskGroup]}(element,bpmnFactory,elementRegistry,translate)},{id:"permissions",label:getLocalizedStringForKey("permissionsLabel"),groups:function(element){var permissionGroup={id:"permission",label:"",entries:[]};return(0,_PermissionProperties2.default)(permissionGroup,element),[permissionGroup]}(element)},{id:"conditions",label:getLocalizedStringForKey("conditionLabel"),groups:function(element,translate){var conditionGroup={id:"condition",label:"",entries:[]};return(0,_ConditionProperties2.default)(conditionGroup,element,translate),[conditionGroup]}(element,translate)}]}}(0,_inherits2.default)(TemplatePropertiesProvider,_PropertiesActivator2.default)},{"./parts/ConditionProperties":612,"./parts/KitodoNameProps":613,"./parts/PermissionProperties":614,"./parts/ScriptTaskProperties":615,"./parts/TaskProperties":616,"bpmn-js-properties-panel/lib/PropertiesActivator":2,"bpmn-js-properties-panel/lib/provider/bpmn/parts/EventProps":31,"bpmn-js-properties-panel/lib/provider/bpmn/parts/IdProps":32,"bpmn-js-properties-panel/lib/provider/bpmn/parts/LinkProps":33,"bpmn-js-properties-panel/lib/provider/bpmn/parts/NameProps":34,"bpmn-js-properties-panel/lib/provider/bpmn/parts/ProcessProps":35,"bpmn-js-properties-panel/lib/provider/camunda/parts/ConditionalProps":46,"bpmn-js/lib/util/ModelUtil":177,inherits:385}],611:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_TemplatePropertiesProvider=require("./TemplatePropertiesProvider"),_TemplatePropertiesProvider2=(obj=_TemplatePropertiesProvider)&&obj.__esModule?obj:{default:obj};exports.default={__init__:["propertiesProvider"],propertiesProvider:["type",_TemplatePropertiesProvider2.default]}},{"./TemplatePropertiesProvider":610}],612:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(group,element,translate){(0,_ModelUtil.is)(element,"bpmn:Task")&&(group.entries.push(_EntryFactory2.default.selectBox(translate,{id:"conditionType",description:getLocalizedStringForKey("kitodoConditionTypeDescription"),label:getLocalizedStringForKey("kitodoConditionType"),selectOptions:[{name:getLocalizedStringForKey("kitodoConditionTypeNone"),value:"none"},{name:getLocalizedStringForKey("kitodoConditionTypeScript"),value:"script"},{name:getLocalizedStringForKey("kitodoConditionTypeXPath"),value:"xpath"}],modelProperty:"kitodoConditionType"})),group.entries.push(_EntryFactory2.default.textBox(translate,{id:"conditionValue",description:getLocalizedStringForKey("kitodoConditionValueDescription"),label:getLocalizedStringForKey("kitodoConditionValue"),modelProperty:"kitodoConditionValue"})))};var obj,_EntryFactory=require("bpmn-js-properties-panel/lib/factory/EntryFactory"),_EntryFactory2=(obj=_EntryFactory)&&obj.__esModule?obj:{default:obj},_ModelUtil=require("bpmn-js/lib/util/ModelUtil")},{"bpmn-js-properties-panel/lib/factory/EntryFactory":15,"bpmn-js/lib/util/ModelUtil":177}],613:[function(require,module,exports){"use strict";var obj,_EntryFactory=require("bpmn-js-properties-panel/lib/factory/EntryFactory"),_EntryFactory2=(obj=_EntryFactory)&&obj.__esModule?obj:{default:obj};var is=require("bpmn-js/lib/util/ModelUtil").is,getBusinessObject=require("bpmn-js/lib/util/ModelUtil").getBusinessObject,cmdHelper=require("bpmn-js-properties-panel/lib/helper/CmdHelper");require("diagram-js/lib/core/ElementRegistry").get,require("diagram-js/lib/core/EventBus");module.exports=function(group,element,translate){var options,nameEntryTextBox;is(element,"bpmn:Collaboration")||(is(element,"bpmn:TextAnnotation")&&(options={modelProperty:"text"}),options={id:"name",label:"Name",modelProperty:"name",get:function(){var res={},assignedName=getBusinessObject(element).get(options.modelProperty);return null==assignedName?is(element,"bpmn:Task")?res[options.modelProperty]=getLocalizedStringForKey("taskDefaultName"):is(element,"bpmn:StartEvent")?res[options.modelProperty]=getLocalizedStringForKey("startEventDefaultName"):is(element,"bpmn:EndEvent")&&(res[options.modelProperty]=getLocalizedStringForKey("endEventDefaultName")):res[options.modelProperty]=assignedName,cmdHelper.updateProperties(element,res),res}},nameEntryTextBox=_EntryFactory2.default.textBox(translate,options),is(element,"bpmn:Task")||is(element,"bpmn:StartEvent")||is(element,"bpmn:EndEvent")||(nameEntryTextBox.cssClasses=["hidden"]),group.entries=group.entries.concat(nameEntryTextBox))}},{"bpmn-js-properties-panel/lib/factory/EntryFactory":15,"bpmn-js-properties-panel/lib/helper/CmdHelper":26,"bpmn-js/lib/util/ModelUtil":177,"diagram-js/lib/core/ElementRegistry":371,"diagram-js/lib/core/EventBus":372}],614:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(group,element,translate){(0,_ModelUtil.is)(element,"bpmn:Task")&&$.each(availableUserRoles,function(index,value){var permissionCheckbox=_EntryFactory2.default.checkbox(translate,{id:"permittedUserRole_"+value.value,description:"",label:value.name,modelProperty:"permittedUserRole_"+index});permissionCheckbox.get=function(element){var res={},assignedRoles=getBusinessObject(element).get("permittedUserRole");if(null==assignedRoles)return res["permittedUserRole_"+index]=!1,res;var isSet=assignedRoles.split(",").indexOf(value.value);return res["permittedUserRole_"+index]=-1!==isSet,res},permissionCheckbox.set=function(element,values){var position,res={},assignedRoles=getBusinessObject(element).get("permittedUserRole"),rolesArray=null==assignedRoles?(assignedRoles="",[]):assignedRoles.split(","),checkboxValue=values["permittedUserRole_"+index];null==checkboxValue&&(position=rolesArray.indexOf(value.value),rolesArray.splice(position,1)),1==checkboxValue&&rolesArray.push(value.value);var propertyString=rolesArray.join(",");return","==propertyString.charAt(0)&&(propertyString=propertyString.substr(1)),res.permittedUserRole=propertyString,cmdHelper.updateProperties(element,res)},group.entries.push(permissionCheckbox)})};var obj,_EntryFactory=require("bpmn-js-properties-panel/lib/factory/EntryFactory"),_EntryFactory2=(obj=_EntryFactory)&&obj.__esModule?obj:{default:obj},_ModelUtil=require("bpmn-js/lib/util/ModelUtil");var getBusinessObject=require("bpmn-js/lib/util/ModelUtil").getBusinessObject,cmdHelper=require("bpmn-js-properties-panel/lib/helper/CmdHelper")},{"bpmn-js-properties-panel/lib/factory/EntryFactory":15,"bpmn-js-properties-panel/lib/helper/CmdHelper":26,"bpmn-js/lib/util/ModelUtil":177}],615:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(group,element,translate){(0,_ModelUtil.is)(element,"bpmn:ScriptTask")&&(group.entries.push(_EntryFactory2.default.textBox(translate,{id:"scriptName",description:getLocalizedStringForKey("scriptNameDescription"),label:getLocalizedStringForKey("scriptName"),modelProperty:"scriptName"})),group.entries.push(_EntryFactory2.default.textField(translate,{id:"scriptPath",description:getLocalizedStringForKey("scriptPathDescription"),label:getLocalizedStringForKey("scriptPath"),modelProperty:"scriptPath"})))};var obj,_EntryFactory=require("bpmn-js-properties-panel/lib/factory/EntryFactory"),_EntryFactory2=(obj=_EntryFactory)&&obj.__esModule?obj:{default:obj},_ModelUtil=require("bpmn-js/lib/util/ModelUtil")},{"bpmn-js-properties-panel/lib/factory/EntryFactory":15,"bpmn-js/lib/util/ModelUtil":177}],616:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(group,element,translate){(0,_ModelUtil.is)(element,"bpmn:Task")&&(group.entries.push(_EntryFactory2.default.checkbox(translate,{id:"correction",description:getLocalizedStringForKey("correctionDescription"),label:getLocalizedStringForKey("correction"),modelProperty:"correction"})),group.entries.push(_EntryFactory2.default.selectBox(translate,{id:"processingStatus",description:getLocalizedStringForKey("processingstatusDescription"),label:getLocalizedStringForKey("processingstatus"),selectOptions:[{name:getLocalizedStringForKey("locked"),value:0},{name:getLocalizedStringForKey("closed"),value:3}],modelProperty:"processingStatus"})),group.entries.push(_EntryFactory2.default.checkbox(translate,{id:"typeMetadata",description:getLocalizedStringForKey("metadataDescription"),label:getLocalizedStringForKey("metadata"),modelProperty:"typeMetadata"})),group.entries.push(_EntryFactory2.default.checkbox(translate,{id:"separateStructure",description:getLocalizedStringForKey("separateStructureDescription"),label:getLocalizedStringForKey("separateStructure"),modelProperty:"separateStructure"})),group.entries.push(_EntryFactory2.default.checkbox(translate,{id:"typeImagesRead",description:getLocalizedStringForKey("typeImagesReadDescription"),label:getLocalizedStringForKey("typeImagesRead"),modelProperty:"typeImagesRead"})),group.entries.push(_EntryFactory2.default.checkbox(translate,{id:"typeImagesWrite",description:getLocalizedStringForKey("typeImagesWriteDescription"),label:getLocalizedStringForKey("typeImagesWrite"),modelProperty:"typeImagesWrite"})),group.entries.push(_EntryFactory2.default.checkbox(translate,{id:"typeGenerateImages",description:getLocalizedStringForKey("typeGenerateImagesDescription"),label:getLocalizedStringForKey("typeGenerateImages"),modelProperty:"typeGenerateImages"})),group.entries.push(_EntryFactory2.default.checkbox(translate,{id:"typeValidateImages",description:getLocalizedStringForKey("typeValidateImagesDescription"),label:getLocalizedStringForKey("typeValidateImages"),modelProperty:"typeValidateImages"})),group.entries.push(_EntryFactory2.default.checkbox(translate,{id:"typeExportDMS",description:getLocalizedStringForKey("typeExportDMSDescription"),label:getLocalizedStringForKey("typeExportDMS"),modelProperty:"typeExportDMS"})),group.entries.push(_EntryFactory2.default.checkbox(translate,{id:"typeCloseVerify",description:getLocalizedStringForKey("typeCloseVerifyDescription"),label:getLocalizedStringForKey("typeCloseVerify"),modelProperty:"typeCloseVerify"})),group.entries.push(_EntryFactory2.default.checkbox(translate,{id:"typeAcceptClose",description:getLocalizedStringForKey("typeAcceptCloseDescription"),label:getLocalizedStringForKey("typeAcceptClose"),modelProperty:"typeAcceptClose"})),group.entries.push(_EntryFactory2.default.checkbox(translate,{id:"typeAutomatic",description:getLocalizedStringForKey("typeAutomaticDescription"),label:getLocalizedStringForKey("typeAutomatic"),modelProperty:"typeAutomatic"})),group.entries.push(_EntryFactory2.default.checkbox(translate,{id:"batchStep",description:getLocalizedStringForKey("batchStepDescription"),label:getLocalizedStringForKey("batchStep"),modelProperty:"batchStep"})),group.entries.push(_EntryFactory2.default.checkbox(translate,{id:"concurrent",description:getLocalizedStringForKey("concurrentDescription"),label:getLocalizedStringForKey("concurrent"),modelProperty:"concurrent"})))};var obj,_EntryFactory=require("bpmn-js-properties-panel/lib/factory/EntryFactory"),_EntryFactory2=(obj=_EntryFactory)&&obj.__esModule?obj:{default:obj},_ModelUtil=require("bpmn-js/lib/util/ModelUtil")},{"bpmn-js-properties-panel/lib/factory/EntryFactory":15,"bpmn-js/lib/util/ModelUtil":177}]},{},[609,611,612,613,614,615,616,610]),de_DE={generalGroupLabel:"Allgemeine Eigenschaften",taskGroupLabel:"Aufgaben Eigenschaften",scriptGroupLabel:"Skript Eigenschaften",detailsGroupLabel:"Details",propertiesLabel:"Eigenschaften",permissionsLabel:"Berechtigungen",conditionLabel:"Bedingungen",correction:"Korrektur",correctionDescription:" ",processingstatus:"Bearbeitungsstatus",processingstatusDescription:" ",locked:"Gesperrt",closed:"Abgeschlossen",metadata:"Metadaten",metadataDescription:"Metadaten in der Aufgabe bearbeiten?",separateStructure:"Erweiterter Strukturbaum",separateStructureDescription:" ",typeImagesRead:"Bilder lesen",typeImagesReadDescription:" ",typeImagesWrite:"Bilder schreiben",typeImagesWriteDescription:" ",typeGenerateImages:"Bilder generieren",typeGenerateImagesDescription:" ",typeValidateImages:"Bilder validieren",typeValidateImagesDescription:" ",typeExportDMS:"Export DMS",typeExportDMSDescription:" ",typeCloseVerify:"Beim Abschluss validieren",typeCloseVerifyDescription:" ",typeAcceptClose:"Nach dem Annehmen schlieen",typeAcceptCloseDescription:" ",typeAutomatic:"Automatisch",typeAutomaticDescription:"Ist es eine automatische Aufgabe?",batchStep:"Stapelverarbeitung",batchStepDescription:" ",concurrent:"Parallele Aufgabe",concurrentDescription:" ",scriptName:"Skript",scriptNameDescription:"Name des Skripts einfgen",scriptPath:"Skript Pfad",scriptPathDescription:"Pfad zum Skript einfgen",kitodoConditionType:" ",kitodoConditionTypeDescription:" ",kitodoConditionTypeNone:"Keine",kitodoConditionTypeScript:"Script",kitodoConditionTypeXPath:"XPath",kitodoConditionValue:"Wert",kitodoConditionValueDescription:" ",taskDefaultName:"Aufgabe",startEventDefaultName:"Start",endEventDefaultName:"Ende"},en_EN={generalGroupLabel:"General Properties",taskGroupLabel:"Task Properties",scriptGroupLabel:"Script Properties",detailsGroupLabel:"Details",propertiesLabel:"Properties",permissionsLabel:"Permissions",conditionLabel:"Conditions",correction:"Correction",correctionDescription:" ",processingstatus:"Processing status",processingstatusDescription:" ",locked:"Locked",closed:"Closed",metadata:"Metadata",metadataDescription:"Is it task metadata type?",separateStructure:"Extended Structure Tree",separateStructureDescription:" ",typeImagesRead:"Read images",typeImagesReadDescription:" ",typeImagesWrite:"Write Images",typeImagesWriteDescription:" ",typeGenerateImages:"Generate Images",typeGenerateImagesDescription:" ",typeValidateImages:"Validate Images",typeValidateImagesDescription:" ",typeExportDMS:"Export DMS",typeExportDMSDescription:" ",typeCloseVerify:"Validate on Exit",typeCloseVerifyDescription:" ",typeAcceptClose:"Finalise task after accepting",typeAcceptCloseDescription:" ",typeAutomatic:"Automatic Task",typeAutomaticDescription:"Is it task automatic type?",batchStep:"Batch Task",batchStepDescription:" ",concurrent:"Concurrent Task",concurrentDescription:" ",scriptName:"Script Name",scriptNameDescription:"Insert script name",scriptPath:"Script Path",scriptPathDescription:"Insert script path",kitodoConditionType:" ",kitodoConditionTypeDescription:" ",kitodoConditionTypeNone:"None",kitodoConditionTypeScript:"Script",kitodoConditionTypeXPath:"XPath",kitodoConditionValue:"Value",kitodoConditionValueDescription:" ",taskDefaultName:"Task",startEventDefaultName:"Start",endEventDefaultName:"End"};